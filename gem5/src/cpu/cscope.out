cscope 15 $HOME/workspace/CGRA/gem5/src/cpu               0001959321
	@activity.cc

31 
	~<¡ršg
>

33 
	~"ıu/aùiv™y.hh
"

34 
	~"ıu/timebuf.hh
"

35 
	~"debug/Aùiv™y.hh
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
	gAùiv™yRecÜd”
::
	$Aùiv™yRecÜd”
(cÚ¡ 
¡ršg
 &
Çme
, 
num_¡ages
,

40 
lÚge¡_Ï‹ncy
, 
aùiv™y
)

41 : 
	`_Çme
(
Çme
), 
	`aùiv™yBufãr
(
lÚge¡_Ï‹ncy
, 0),

42 
	`lÚge¡L©’cy
(
lÚge¡_Ï‹ncy
), 
	`aùiv™yCouÁ
(
aùiv™y
),

43 
	$numSges
(
num_¡ages
)

45 
¡ageAùive
 = 
Ãw
 
boŞ
[
numSges
];

46 
¡d
::
	`mem£t
(
¡ageAùive
, 0, 
numSges
);

47 
	}
}

49 
	gAùiv™yRecÜd”
::~
	$Aùiv™yRecÜd”
()

51 
d–‘e
[] 
¡ageAùive
;

52 
	}
}

55 
	gAùiv™yRecÜd”
::
	$aùiv™y
()

59 ià(
aùiv™yBufãr
[0]) {

63 
aùiv™yBufãr
[0] = 
Œue
;

65 ++
aùiv™yCouÁ
;

67 
	`DPRINTF
(
Aùiv™y
, "Aùiv™y: %i\n", 
aùiv™yCouÁ
);

68 
	}
}

71 
	gAùiv™yRecÜd”
::
	$advªû
()

75 ià(
aùiv™yBufãr
[-
lÚge¡L©’cy
]) {

76 --
aùiv™yCouÁ
;

78 
	`as£¹
(
aùiv™yCouÁ
 >= 0);

80 
	`DPRINTF
(
Aùiv™y
, "Aùiv™y: %i\n", 
aùiv™yCouÁ
);

82 ià(
aùiv™yCouÁ
 == 0) {

83 
	`DPRINTF
(
Aùiv™y
, "No‡ctivity†eft!\n");

87 
aùiv™yBufãr
.
	`advªû
();

88 
	}
}

91 
	gAùiv™yRecÜd”
::
	$aùiv©eSge
(cÚ¡ 
idx
)

94 ià(!
¡ageAùive
[
idx
]) {

95 ++
aùiv™yCouÁ
;

97 
¡ageAùive
[
idx
] = 
Œue
;

99 
	`DPRINTF
(
Aùiv™y
, "Aùiv™y: %i\n", 
aùiv™yCouÁ
);

101 
	`DPRINTF
(
Aùiv™y
, "Sg%˜®»ady‡ùive.\n", 
idx
);

105 
	}
}

108 
	gAùiv™yRecÜd”
::
	$d—ùiv©eSge
(cÚ¡ 
idx
)

111 ià(
¡ageAùive
[
idx
]) {

112 --
aùiv™yCouÁ
;

114 
¡ageAùive
[
idx
] = 
çl£
;

116 
	`DPRINTF
(
Aùiv™y
, "Aùiv™y: %i\n", 
aùiv™yCouÁ
);

118 
	`DPRINTF
(
Aùiv™y
, "Sg%˜®»ady iÇùive.\n", 
idx
);

121 
	`as£¹
(
aùiv™yCouÁ
 >= 0);

122 
	}
}

125 
	gAùiv™yRecÜd”
::
	$»£t
()

127 
aùiv™yCouÁ
 = 0;

128 
¡d
::
	`mem£t
(
¡ageAùive
, 0, 
numSges
);

129 
i
 = 0; i < 
lÚge¡L©’cy
 + 1; ++i)

130 
aùiv™yBufãr
.
	`advªû
();

131 
	}
}

134 
	gAùiv™yRecÜd”
::
	$dump
()

136 
i
 = 0; i <ğ
lÚge¡L©’cy
; ++i) {

137 
	`ırštf
("[Idx:%˜%i] ", 
i
, 
aùiv™yBufãr
[-i]);

140 
	`ırštf
("\n");

142 
i
 = 0; i < 
numSges
; ++i) {

143 
	`ırštf
("[Sge:%˜%i]\n", 
i
, 
¡ageAùive
[i]);

146 
	`ırštf
("\n");

148 
	`ırštf
("Aùiv™y couÁ: %i\n", 
aùiv™yCouÁ
);

149 
	}
}

152 
	gAùiv™yRecÜd”
::
	$v®id©e
()

154 
couÁ
 = 0;

155 
i
 = 0; i <ğ
lÚge¡L©’cy
; ++i) {

156 ià(
aùiv™yBufãr
[-
i
]) {

157 
couÁ
++;

161 
i
 = 0; i < 
numSges
; ++i) {

162 ià(
¡ageAùive
[
i
]) {

163 
couÁ
++;

167 
	`as£¹
(
couÁ
 =ğ
aùiv™yCouÁ
);

168 
	}
}

	@activity.hh

31 #iâdeà
__CPU_ACTIVITY_HH__


32 
	#__CPU_ACTIVITY_HH__


	)

34 
	~"ba£/Œaû.hh
"

35 
	~"ıu/timebuf.hh
"

52 şas 
	cAùiv™yRecÜd”


54 
	mpublic
:

55 
Aùiv™yRecÜd”
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
, 
num_¡ages
,

56 
lÚge¡_Ï‹ncy
, 
couÁ
);

57 ~
Aùiv™yRecÜd”
();

60 
aùiv™y
();

66 
advªû
();

69 
aùiv©eSge
(cÚ¡ 
idx
);

72 
d—ùiv©eSge
(cÚ¡ 
idx
);

75 
	$g‘Aùiv™yCouÁ
(è{  
aùiv™yCouÁ
; }

80 
	$£tAùiv™yCouÁ
(
couÁ
)

81 { 
aùiv™yCouÁ
 = 
couÁ
; 
	}
}

84 
boŞ
 
	$aùive
(è{  
aùiv™yCouÁ
; 
	}
}

87 
»£t
();

90 
dump
();

95 
v®id©e
();

97 
	g´iv©e
:

99 
¡d
::
¡ršg
 
_Çme
;

100 cÚ¡ 
	g¡d
::
¡ršg
 &
	$Çme
(è{  
_Çme
; 
	}
}

110 
	gTimeBufãr
<
	gboŞ
> 
	gaùiv™yBufãr
;

113 
	glÚge¡L©’cy
;

124 
	gaùiv™yCouÁ
;

127 
	gnumSges
;

130 
boŞ
 *
	g¡ageAùive
;

	@base.cc

48 
	~<io¡»am
>

49 
	~<s¡»am
>

50 
	~<¡ršg
>

52 
	~"¬ch/b.hh
"

53 
	~"ba£/lßd”/symb.hh
"

54 
	~"ba£/ırštf.hh
"

55 
	~"ba£/misc.hh
"

56 
	~"ba£/ouut.hh
"

57 
	~"ba£/Œaû.hh
"

58 
	~"ıu/ba£.hh
"

59 
	~"ıu/check”/ıu.hh
"

60 
	~"ıu/ıuev’t.hh
"

61 
	~"ıu/´ofe.hh
"

62 
	~"ıu/th»ad_cÚ‹xt.hh
"

63 
	~"debug/SysÿÎV”bo£.hh
"

64 
	~"·¿ms/Ba£CPU.hh
"

65 
	~"sim/fuÎ_sy¡em.hh
"

66 
	~"sim/´oûss.hh
"

67 
	~"sim/sim_ev’ts.hh
"

68 
	~"sim/sim_ex™.hh
"

69 
	~"sim/sy¡em.hh
"

72 
	~"sim/¡©_cÚŒŞ.hh
"

74 
usšg
 
Çme¥aû
 
	g¡d
;

76 
	gveùÜ
<
	gBa£CPU
 *> Ba£CPU::
ıuLi¡
;

81 
	gmaxTh»adsP”CPU
 = 1;

83 
	gCPUProg»ssEv’t
::
	$CPUProg»ssEv’t
(
Ba£CPU
 *
_ıu
, 
Tick
 
iv®
)

84 : 
	`Ev’t
(
Ev’t
::
Prog»ss_Ev’t_Pri
), 
	`_š‹rv®
(
iv®
), 
	`Ï¡NumIn¡
(0),

85 
	`ıu
(
_ıu
), 
	$_»³©Ev’t
(
Œue
)

87 ià(
_š‹rv®
)

88 
ıu
->
	`scheduË
(
this
, 
	`curTick
(è+ 
_š‹rv®
);

89 
	}
}

92 
	gCPUProg»ssEv’t
::
	$´oûss
()

94 
CouÁ”
 
‹mp
 = 
ıu
->
	`tÙ®Ops
();

95 #iâdeà
NDEBUG


96 
c
 = (
‹mp
 - 
Ï¡NumIn¡
è/ (
_š‹rv®
 / 
ıu
->
	`şockP”iod
());

98 
	`DPRINTFN
("%s…rogressƒvent,otal committed:%i,…rogress insts committed: "

99 "%Îi, IPC: %0.8d\n", 
ıu
->
	`Çme
(), 
‹mp
,em°- 
Ï¡NumIn¡
,

100 
c
);

101 
c
 = 0.0;

103 
	`ırštf
("%lli: %s…rogressƒvent,otal committed:%i,…rogress insts "

104 "comm™‹d: %Îi\n", 
	`curTick
(), 
ıu
->
	`Çme
(), 
‹mp
,

105 
‹mp
 - 
Ï¡NumIn¡
);

107 
Ï¡NumIn¡
 = 
‹mp
;

109 ià(
_»³©Ev’t
)

110 
ıu
->
	`scheduË
(
this
, 
	`curTick
(è+ 
_š‹rv®
);

111 
	}
}

114 
	gCPUProg»ssEv’t
::
	$desütiÚ
() const

117 
	}
}

119 
	gBa£CPU
::
	$Ba£CPU
(
P¬ams
 *
p
, 
boŞ
 
is_check”
)

120 : 
	`MemObjeù
(
p
), 
	`š¡CÁ
(0), 
	`_ıuId
Õ->
ıu_id
),

121 
	`_š¡Ma¡”Id
(
p
->
sy¡em
->
	`g‘Ma¡”Id
(
	`Çme
() + ".inst")),

122 
	`_d©aMa¡”Id
(
p
->
sy¡em
->
	`g‘Ma¡”Id
(
	`Çme
() + ".data")),

123 
	`_skId
(
CÚ‹xtSw™chTaskId
::
Unknown
), 
	`_pid
(
Reque¡
::
švldPid
),

124 
	`_sw™chedOut
(
p
->
sw™ched_out
), 
	`_ÿcheLšeSize
Õ->
sy¡em
->
	`ÿcheLšeSize
()),

125 
	`š‹¼u±s
(
p
->
š‹¼u±s
), 
	`´ofeEv’t
(
NULL
),

126 
	`numTh»ads
(
p
->
numTh»ads
), 
	`sy¡em
Õ->
sy¡em
)

129 ià(
_ıuId
 == -1 ) {

130 
_ıuId
 = 
ıuLi¡
.
	`size
();

134 
ıuLi¡
.
	`push_back
(
this
);

136 
	`DPRINTF
(
SysÿÎV”bo£
, "CÚ¡ruùšg CPU w™h id %d\n", 
_ıuId
);

138 ià(
numTh»ads
 > 
maxTh»adsP”CPU
)

139 
maxTh»adsP”CPU
 = 
numTh»ads
;

142 
comIn¡Ev’tQueue
 = 
Ãw
 
Ev’tQueue
 *[
numTh»ads
];

143 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid)

144 
comIn¡Ev’tQueue
[
tid
] =

145 
Ãw
 
	`Ev’tQueue
("instruction-basedƒvent queue");

150 ià(
p
->
max_š¡s_ªy_th»ad
 != 0) {

151 cÚ¡ *
ÿu£
 = "ahread„eachedhe max instruction count";

152 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid)

153 
	`scheduËIn¡Stİ
(
tid
, 
p
->
max_š¡s_ªy_th»ad
, 
ÿu£
);

160 ià(!
p
->
simpošt_¡¬t_š¡s
.
	`em±y
()) {

161 cÚ¡ *
ÿu£
 = "simpoint starting…oint found";

162 
size_t
 
i
 = 0; i < 
p
->
simpošt_¡¬t_š¡s
.
	`size
(); ++i)

163 
	`scheduËIn¡Stİ
(0, 
p
->
simpošt_¡¬t_š¡s
[
i
], 
ÿu£
);

166 ià(
p
->
max_š¡s_®l_th»ads
 != 0) {

167 cÚ¡ *
ÿu£
 = "allhreads„eachedhe max instruction count";

172 *
couÁ”
 = 
Ãw
 ;

173 *
couÁ”
 = 
numTh»ads
;

174 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

175 
Ev’t
 *
ev’t
 = 
Ãw
 
	`CouÁedEx™Ev’t
(
ÿu£
, *
couÁ”
);

176 
comIn¡Ev’tQueue
[
tid
]->
	`scheduË
(
ev’t
, 
p
->
max_š¡s_®l_th»ads
);

181 
comLßdEv’tQueue
 = 
Ãw
 
Ev’tQueue
 *[
numTh»ads
];

182 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid)

183 
comLßdEv’tQueue
[
tid
] = 
Ãw
 
	`Ev’tQueue
("load-basedƒvent queue");

188 ià(
p
->
max_lßds_ªy_th»ad
 != 0) {

189 cÚ¡ *
ÿu£
 = "ahread„eachedhe max†oad count";

190 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid)

191 
	`scheduËLßdStİ
(
tid
, 
p
->
max_lßds_ªy_th»ad
, 
ÿu£
);

194 ià(
p
->
max_lßds_®l_th»ads
 != 0) {

195 cÚ¡ *
ÿu£
 = "allhreads„eachedhe max†oad count";

199 *
couÁ”
 = 
Ãw
 ;

200 *
couÁ”
 = 
numTh»ads
;

201 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

202 
Ev’t
 *
ev’t
 = 
Ãw
 
	`CouÁedEx™Ev’t
(
ÿu£
, *
couÁ”
);

203 
comLßdEv’tQueue
[
tid
]->
	`scheduË
(
ev’t
, 
p
->
max_lßds_®l_th»ads
);

207 
funùiÚT¿cšgEÇbËd
 = 
çl£
;

208 ià(
p
->
funùiÚ_Œaû
) {

209 cÚ¡ 
¡ršg
 
âame
 = 
	`c¥rštf
("á¿û.%s", 
	`Çme
());

210 
funùiÚT¿ûSŒ—m
 = 
simout
.
	`fšd
(
âame
);

211 ià(!
funùiÚT¿ûSŒ—m
)

212 
funùiÚT¿ûSŒ—m
 = 
simout
.
	`ü—‹
(
âame
);

214 
cu¼’tFunùiÚS¹
 = 
cu¼’tFunùiÚEnd
 = 0;

215 
funùiÚEÁryTick
 = 
p
->
funùiÚ_Œaû_¡¬t
;

217 ià(
p
->
funùiÚ_Œaû_¡¬t
 == 0) {

218 
funùiÚT¿cšgEÇbËd
 = 
Œue
;

220 
Ev’tW¿µ”
<
	tBa£CPU
, &Ba£CPU::
	t’abËFunùiÚT¿û
> 
	tw¿p
;

221 
Ev’t
 *
ev’t
 = 
Ãw
 
	`w¿p
(
this
, 
Œue
);

222 
	`scheduË
(
ev’t
, 
p
->
funùiÚ_Œaû_¡¬t
);

228 ià(!
	`·¿ms
()->
sw™ched_out
 && !
is_check”
) {

229 ià(
š‹¼u±s
) {

230 
š‹¼u±s
->
	`£tCPU
(
this
);

232 
	`çl
("CPU %s has‚o interrupt controller.\n"

233 "Ensu» c»©eIÁ”ru±CÚŒŞËr(èi ÿÎed.\n", 
	`Çme
());

237 ià(
FuÎSy¡em
) {

238 ià(
	`·¿ms
()->
´ofe
)

239 
´ofeEv’t
 = 
Ãw
 
	`ProfeEv’t
(
this
, 
	`·¿ms
()->
´ofe
);

241 
Œaûr
 = 
	`·¿ms
()->tracer;

243 ià(
	`·¿ms
()->
i§
.
	`size
(è!ğ
numTh»ads
) {

244 
	`çl
("Number of ISAs (%i)‡ssignedohe CPU does‚otƒqual‚umber "

245 "oàth»ad (%i).\n", 
	`·¿ms
()->
i§
.
	`size
(), 
numTh»ads
);

247 
	}
}

250 
	gBa£CPU
::
	$’abËFunùiÚT¿û
()

252 
funùiÚT¿cšgEÇbËd
 = 
Œue
;

253 
	}
}

255 
	gBa£CPU
::~
	$Ba£CPU
()

257 
d–‘e
 
´ofeEv’t
;

258 
d–‘e
[] 
comLßdEv’tQueue
;

259 
d–‘e
[] 
comIn¡Ev’tQueue
;

260 
	}
}

263 
	gBa£CPU
::
	$š™
()

265 ià(!
	`·¿ms
()->
sw™ched_out
) {

266 
	`»gi¡”Th»adCÚ‹xts
();

268 
	`v”ifyMemÜyMode
();

270 
	}
}

273 
	gBa£CPU
::
	$¡¬tup
()

275 ià(
FuÎSy¡em
) {

276 ià(!
	`·¿ms
()->
sw™ched_out
 && 
´ofeEv’t
)

277 
	`scheduË
(
´ofeEv’t
, 
	`curTick
());

280 ià(
	`·¿ms
()->
´og»ss_š‹rv®
) {

281 
Ãw
 
	`CPUProg»ssEv’t
(
this
, 
	`·¿ms
()->
´og»ss_š‹rv®
);

283 
	}
}

287 
	gBa£CPU
::
	$»gSts
()

289 
usšg
 
Çme¥aû
 
Sts
;

291 
numCyşes


292 .
	`Çme
(name() + ".numCycles")

293 .
	`desc
("number of cpu cycles simulated")

296 
numWÜkI‹msS¹ed


297 .
	`Çme
(name() + ".numWorkItemsStarted")

298 .
	`desc
("number of work itemshis cpu started")

301 
numWÜkI‹msCom¶‘ed


302 .
	`Çme
(name() + ".numWorkItemsCompleted")

303 .
	`desc
("number of work itemshis cpu completed")

306 
size
 = 
th»adCÚ‹xts
.
	`size
();

307 ià(
size
 > 1) {

308 
i
 = 0; i < 
size
; ++i) {

309 
¡ršg¡»am
 
Çme¡r
;

310 
	`cırštf
(
Çme¡r
, "%s.ùx%d", 
	`Çme
(), 
i
);

311 
th»adCÚ‹xts
[
i
]->
	`»gSts
(
Çme¡r
.
	`¡r
());

313 } ià(
size
 == 1)

314 
th»adCÚ‹xts
[0]->
	`»gSts
(
	`Çme
());

315 
	}
}

317 
	gBa£Ma¡”PÜt
 &

318 
	gBa£CPU
::
	$g‘Ma¡”PÜt
(cÚ¡ 
¡ršg
 &
if_Çme
, 
PÜtID
 
idx
)

325 ià(
if_Çme
 == "dcache_port")

326  
	`g‘D©aPÜt
();

327 ià(
if_Çme
 == "dcache_port1")

328  
	`g‘D©aPÜt1
();

329 ià(
if_Çme
 == "dcache_port2")

330  
	`g‘D©aPÜt2
();

331 ià(
if_Çme
 == "dcache_port3")

332  
	`g‘D©aPÜt3
();

333 ià(
if_Çme
 == "dcache_port4")

334  
	`g‘D©aPÜt4
();

335 ià(
if_Çme
 == "icache_port")

336  
	`g‘In¡PÜt
();

338  
MemObjeù
::
	`g‘Ma¡”PÜt
(
if_Çme
, 
idx
);

339 
	}
}

342 
	gBa£CPU
::
	$»gi¡”Th»adCÚ‹xts
()

344 
Th»adID
 
size
 = 
th»adCÚ‹xts
.
	`size
();

345 
Th»adID
 
tid
 = 0;id < 
size
; ++tid) {

346 
Th»adCÚ‹xt
 *
tc
 = 
th»adCÚ‹xts
[
tid
];

355 ià(
numTh»ads
 == 1)

356 
tc
->
	`£tCÚ‹xtId
(
sy¡em
->
	`»gi¡”Th»adCÚ‹xt
Ñc, 
_ıuId
));

358 
tc
->
	`£tCÚ‹xtId
(
sy¡em
->
	`»gi¡”Th»adCÚ‹xt
(tc));

360 ià(!
FuÎSy¡em
)

361 
tc
->
	`g‘ProûssPŒ
()->
	`assignTh»adCÚ‹xt
Ñc->
	`cÚ‹xtId
());

363 
	}
}

367 
	gBa£CPU
::
	$fšdCÚ‹xt
(
Th»adCÚ‹xt
 *
tc
)

369 
Th»adID
 
size
 = 
th»adCÚ‹xts
.
	`size
();

370 
Th»adID
 
tid
 = 0;id < 
size
; ++tid) {

371 ià(
tc
 =ğ
th»adCÚ‹xts
[
tid
])

372  
tid
;

375 
	}
}

378 
	gBa£CPU
::
	$sw™chOut
()

380 
	`as£¹
(!
_sw™chedOut
);

381 
_sw™chedOut
 = 
Œue
;

382 ià(
´ofeEv’t
 &&…rofeEv’t->
	`scheduËd
())

383 
	`descheduË
(
´ofeEv’t
);

387 
	`æushTLBs
();

388 
	}
}

391 
	gBa£CPU
::
	$keOv”From
(
Ba£CPU
 *
ŞdCPU
)

393 
	`as£¹
(
th»adCÚ‹xts
.
	`size
(è=ğ
ŞdCPU
->threadContexts.size());

394 
	`as£¹
(
_ıuId
 =ğ
ŞdCPU
->
	`ıuId
());

395 
	`as£¹
(
_sw™chedOut
);

396 
	`as£¹
(
ŞdCPU
 !ğ
this
);

397 
_pid
 = 
ŞdCPU
->
	`g‘Pid
();

398 
_skId
 = 
ŞdCPU
->
	`skId
();

399 
_sw™chedOut
 = 
çl£
;

401 
Th»adID
 
size
 = 
th»adCÚ‹xts
.
	`size
();

402 
Th»adID
 
i
 = 0; i < 
size
; ++i) {

403 
Th»adCÚ‹xt
 *
ÃwTC
 = 
th»adCÚ‹xts
[
i
];

404 
Th»adCÚ‹xt
 *
ŞdTC
 = 
ŞdCPU
->
th»adCÚ‹xts
[
i
];

406 
ÃwTC
->
	`keOv”From
(
ŞdTC
);

408 
CpuEv’t
::
	`»¶aûTh»adCÚ‹xt
(
ŞdTC
, 
ÃwTC
);

410 
	`as£¹
(
ÃwTC
->
	`cÚ‹xtId
(è=ğ
ŞdTC
->contextId());

411 
	`as£¹
(
ÃwTC
->
	`th»adId
(è=ğ
ŞdTC
->threadId());

412 
sy¡em
->
	`»¶aûTh»adCÚ‹xt
(
ÃwTC
,‚ewTC->
	`cÚ‹xtId
());

421 
Ba£Ma¡”PÜt
 *
Şd_™b_pÜt
 = 
ŞdTC
->
	`g‘ITBPŒ
()->
	`g‘Ma¡”PÜt
();

422 
Ba£Ma¡”PÜt
 *
Şd_dtb_pÜt
 = 
ŞdTC
->
	`g‘DTBPŒ
()->
	`g‘Ma¡”PÜt
();

423 
Ba£Ma¡”PÜt
 *
Ãw_™b_pÜt
 = 
ÃwTC
->
	`g‘ITBPŒ
()->
	`g‘Ma¡”PÜt
();

424 
Ba£Ma¡”PÜt
 *
Ãw_dtb_pÜt
 = 
ÃwTC
->
	`g‘DTBPŒ
()->
	`g‘Ma¡”PÜt
();

427 ià(
Ãw_™b_pÜt
) {

428 
	`as£¹
(!
Ãw_™b_pÜt
->
	`isCÚÃùed
());

429 
	`as£¹
(
Şd_™b_pÜt
);

430 
	`as£¹
(
Şd_™b_pÜt
->
	`isCÚÃùed
());

431 
Ba£SÏvePÜt
 &
¦avePÜt
 = 
Şd_™b_pÜt
->
	`g‘SÏvePÜt
();

432 
Şd_™b_pÜt
->
	`unbšd
();

433 
Ãw_™b_pÜt
->
	`bšd
(
¦avePÜt
);

435 ià(
Ãw_dtb_pÜt
) {

436 
	`as£¹
(!
Ãw_dtb_pÜt
->
	`isCÚÃùed
());

437 
	`as£¹
(
Şd_dtb_pÜt
);

438 
	`as£¹
(
Şd_dtb_pÜt
->
	`isCÚÃùed
());

439 
Ba£SÏvePÜt
 &
¦avePÜt
 = 
Şd_dtb_pÜt
->
	`g‘SÏvePÜt
();

440 
Şd_dtb_pÜt
->
	`unbšd
();

441 
Ãw_dtb_pÜt
->
	`bšd
(
¦avePÜt
);

446 
Check”CPU
 *
ŞdCheck”
 = 
ŞdTC
->
	`g‘Check”CpuPŒ
();

447 
Check”CPU
 *
ÃwCheck”
 = 
ÃwTC
->
	`g‘Check”CpuPŒ
();

448 ià(
ŞdCheck”
 && 
ÃwCheck”
) {

449 
Ba£Ma¡”PÜt
 *
Şd_check”_™b_pÜt
 =

450 
ŞdCheck”
->
	`g‘ITBPŒ
()->
	`g‘Ma¡”PÜt
();

451 
Ba£Ma¡”PÜt
 *
Şd_check”_dtb_pÜt
 =

452 
ŞdCheck”
->
	`g‘DTBPŒ
()->
	`g‘Ma¡”PÜt
();

453 
Ba£Ma¡”PÜt
 *
Ãw_check”_™b_pÜt
 =

454 
ÃwCheck”
->
	`g‘ITBPŒ
()->
	`g‘Ma¡”PÜt
();

455 
Ba£Ma¡”PÜt
 *
Ãw_check”_dtb_pÜt
 =

456 
ÃwCheck”
->
	`g‘DTBPŒ
()->
	`g‘Ma¡”PÜt
();

459 ià(
Ãw_check”_™b_pÜt
) {

460 
	`as£¹
(!
Ãw_check”_™b_pÜt
->
	`isCÚÃùed
());

461 
	`as£¹
(
Şd_check”_™b_pÜt
);

462 
	`as£¹
(
Şd_check”_™b_pÜt
->
	`isCÚÃùed
());

463 
Ba£SÏvePÜt
 &
¦avePÜt
 =

464 
Şd_check”_™b_pÜt
->
	`g‘SÏvePÜt
();

465 
Şd_check”_™b_pÜt
->
	`unbšd
();

466 
Ãw_check”_™b_pÜt
->
	`bšd
(
¦avePÜt
);

468 ià(
Ãw_check”_dtb_pÜt
) {

469 
	`as£¹
(!
Ãw_check”_dtb_pÜt
->
	`isCÚÃùed
());

470 
	`as£¹
(
Şd_check”_dtb_pÜt
);

471 
	`as£¹
(
Şd_check”_dtb_pÜt
->
	`isCÚÃùed
());

472 
Ba£SÏvePÜt
 &
¦avePÜt
 =

473 
Şd_check”_dtb_pÜt
->
	`g‘SÏvePÜt
();

474 
Şd_check”_dtb_pÜt
->
	`unbšd
();

475 
Ãw_check”_dtb_pÜt
->
	`bšd
(
¦avePÜt
);

480 
š‹¼u±s
 = 
ŞdCPU
->interrupts;

481 
š‹¼u±s
->
	`£tCPU
(
this
);

482 
ŞdCPU
->
š‹¼u±s
 = 
NULL
;

484 ià(
FuÎSy¡em
) {

485 
Th»adID
 
i
 = 0; i < 
size
; ++i)

486 
th»adCÚ‹xts
[
i
]->
	`´ofeCË¬
();

488 ià(
´ofeEv’t
)

489 
	`scheduË
(
´ofeEv’t
, 
	`curTick
());

496 
	`as£¹
(!
	`g‘In¡PÜt
().
	`isCÚÃùed
());

497 
	`as£¹
(
ŞdCPU
->
	`g‘In¡PÜt
().
	`isCÚÃùed
());

498 
Ba£SÏvePÜt
 &
š¡_³”_pÜt
 = 
ŞdCPU
->
	`g‘In¡PÜt
().
	`g‘SÏvePÜt
();

499 
ŞdCPU
->
	`g‘In¡PÜt
().
	`unbšd
();

500 
	`g‘In¡PÜt
().
	`bšd
(
š¡_³”_pÜt
);

502 
	`as£¹
(!
	`g‘D©aPÜt
().
	`isCÚÃùed
());

503 
	`as£¹
(
ŞdCPU
->
	`g‘D©aPÜt
().
	`isCÚÃùed
());

504 
Ba£SÏvePÜt
 &
d©a_³”_pÜt
 = 
ŞdCPU
->
	`g‘D©aPÜt
().
	`g‘SÏvePÜt
();

505 
ŞdCPU
->
	`g‘D©aPÜt
().
	`unbšd
();

506 
	`g‘D©aPÜt
().
	`bšd
(
d©a_³”_pÜt
);

507 
	}
}

510 
	gBa£CPU
::
	$æushTLBs
()

512 
Th»adID
 
i
 = 0; i < 
th»adCÚ‹xts
.
	`size
(); ++i) {

513 
Th»adCÚ‹xt
 &
	`tc
(*
th»adCÚ‹xts
[
i
]);

514 
Check”CPU
 *
	`check”
(
tc
.
	`g‘Check”CpuPŒ
());

516 
tc
.
	`g‘ITBPŒ
()->
	`æushAÎ
();

517 
tc
.
	`g‘DTBPŒ
()->
	`æushAÎ
();

518 ià(
check”
) {

519 
check”
->
	`g‘ITBPŒ
()->
	`æushAÎ
();

520 
check”
->
	`g‘DTBPŒ
()->
	`æushAÎ
();

523 
	}
}

526 
	gBa£CPU
::
ProfeEv’t
::
	$ProfeEv’t
(
Ba£CPU
 *
_ıu
, 
Tick
 
_š‹rv®
)

527 : 
	`ıu
(
_ıu
), 
	$š‹rv®
(
_š‹rv®
)

528 { 
	}
}

531 
	gBa£CPU
::
ProfeEv’t
::
	$´oûss
()

533 
Th»adID
 
size
 = 
ıu
->
th»adCÚ‹xts
.
	`size
();

534 
Th»adID
 
i
 = 0; i < 
size
; ++i) {

535 
Th»adCÚ‹xt
 *
tc
 = 
ıu
->
th»adCÚ‹xts
[
i
];

536 
tc
->
	`´ofeSam¶e
();

539 
ıu
->
	`scheduË
(
this
, 
	`curTick
(è+ 
š‹rv®
);

540 
	}
}

543 
	gBa£CPU
::
£rŸlize
(
¡d
::
o¡»am
 &
os
)

545 
SERIALIZE_SCALAR
(
š¡CÁ
);

547 ià(!
	g_sw™chedOut
) {

552 
SERIALIZE_SCALAR
(
_pid
);

554 
	gš‹¼u±s
->
£rŸlize
(
os
);

557 
Th»adID
 
	gi
 = 0; i < 
	gnumTh»ads
; ++i) {

558 
ÇmeOut
(
os
, 
c¥rštf
("%s.xc.%i", 
Çme
(), 
i
));

559 
£rŸlizeTh»ad
(
os
, 
i
);

565 
	gBa£CPU
::
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
)

567 
UNSERIALIZE_SCALAR
(
š¡CÁ
);

569 ià(!
	g_sw™chedOut
) {

570 
UNSERIALIZE_SCALAR
(
_pid
);

571 
	gš‹¼u±s
->
un£rŸlize
(
ı
, 
£ùiÚ
);

574 
Th»adID
 
	gi
 = 0; i < 
	gnumTh»ads
; ++i)

575 
un£rŸlizeTh»ad
(
ı
, 
c¥rštf
("%s.xc.%i", 
£ùiÚ
, 
i
), i);

580 
	gBa£CPU
::
	$scheduËIn¡Stİ
(
Th»adID
 
tid
, 
CouÁ”
 
š¡s
, cÚ¡ *
ÿu£
)

582 cÚ¡ 
Tick
 
	`now
(
comIn¡Ev’tQueue
[
tid
]->
	`g‘CurTick
());

583 
Ev’t
 *
	`ev’t
(
Ãw
 
	`LoÿlSimLoİEx™Ev’t
(
ÿu£
, 0));

585 
comIn¡Ev’tQueue
[
tid
]->
	`scheduË
(
ev’t
, 
now
 + 
š¡s
);

586 
	}
}

589 
	gBa£CPU
::
	$scheduËLßdStİ
(
Th»adID
 
tid
, 
CouÁ”
 
lßds
, cÚ¡ *
ÿu£
)

591 cÚ¡ 
Tick
 
	`now
(
comLßdEv’tQueue
[
tid
]->
	`g‘CurTick
());

592 
Ev’t
 *
	`ev’t
(
Ãw
 
	`LoÿlSimLoİEx™Ev’t
(
ÿu£
, 0));

594 
comLßdEv’tQueue
[
tid
]->
	`scheduË
(
ev’t
, 
now
 + 
lßds
);

595 
	}
}

599 
	gBa£CPU
::
	$ŒaûFunùiÚsIÁ”Çl
(
Addr
 
pc
)

601 ià(!
debugSymbŞTabË
)

606 ià(
pc
 < 
cu¼’tFunùiÚS¹
 ||…ø>ğ
cu¼’tFunùiÚEnd
) {

607 
¡ršg
 
sym_¡r
;

608 
boŞ
 
found
 = 
debugSymbŞTabË
->
	`fšdN—»¡SymbŞ
(
pc
, 
sym_¡r
,

609 
cu¼’tFunùiÚS¹
,

610 
cu¼’tFunùiÚEnd
);

612 ià(!
found
) {

614 
sym_¡r
 = 
	`c¥rštf
("0x%x", 
pc
);

615 
cu¼’tFunùiÚS¹
 = 
pc
;

616 
cu¼’tFunùiÚEnd
 = 
pc
 + 1;

619 
	`cırštf
(*
funùiÚT¿ûSŒ—m
, " (%d)\n%d: %s",

620 
	`curTick
(è- 
funùiÚEÁryTick
, curTick(), 
sym_¡r
);

621 
funùiÚEÁryTick
 = 
	`curTick
();

623 
	}
}

	@base.hh

46 #iâdeà
__CPU_BASE_HH__


47 
	#__CPU_BASE_HH__


	)

49 
	~<veùÜ
>

53 
	~"cÚfig/the_i§.hh
"

54 #ià
THE_ISA
 =ğ
NULL_ISA


55 
	~"¬ch/nuÎ/ıu_dummy.hh
"

57 
	~"¬ch/š‹¼u±s.hh
"

58 
	~"¬ch/i§_Œa™s.hh
"

59 
	~"¬ch/miüocode_rom.hh
"

60 
	~"ba£/¡©i¡ics.hh
"

61 
	~"mem/mem_objeù.hh
"

62 
	~"sim/ev’tq.hh
"

63 
	~"sim/fuÎ_sy¡em.hh
"

64 
	~"sim/š¡Œaûr.hh
"

65 
	~"sim/sy¡em.hh
"

67 
	gBa£CPUP¬ams
;

68 
şass
 
	gCheck”CPU
;

69 
şass
 
	gTh»adCÚ‹xt
;

71 şas 
	cCPUProg»ssEv’t
 : 
public
 
Ev’t


73 
´Ùeùed
:

74 
Tick
 
_š‹rv®
;

75 
CouÁ”
 
	mÏ¡NumIn¡
;

76 
Ba£CPU
 *
	mıu
;

77 
boŞ
 
	m_»³©Ev’t
;

79 
	mpublic
:

80 
CPUProg»ssEv’t
(
Ba£CPU
 *
_ıu
, 
Tick
 
iv®
 = 0);

82 
´oûss
();

84 
	$š‹rv®
(
Tick
 
iv®
è{ 
_š‹rv®
 = ival; }

85 
Tick
 
	$š‹rv®
(è{  
_š‹rv®
; 
	}
}

87 
	$»³©Ev’t
(
boŞ
 
»³©
è{ 
_»³©Ev’t
 =„•—t; 
	}
}

89 
vœtu®
 cÚ¡ *
	$desütiÚ
() const;

90 
	}
};

92 şas 
	cBa£CPU
 : 
public
 
MemObjeù


94 
´Ùeùed
:

97 
Tick
 
š¡CÁ
;

102 
	m_ıuId
;

105 
Ma¡”ID
 
	m_š¡Ma¡”Id
;

108 
Ma¡”ID
 
	m_d©aMa¡”Id
;

115 
ušt32_t
 
	m_skId
;

119 
ušt32_t
 
	m_pid
;

122 
boŞ
 
	m_sw™chedOut
;

125 cÚ¡ 
	m_ÿcheLšeSize
;

127 
	mpublic
:

135 
vœtu®
 
Ma¡”PÜt
 &
g‘D©aPÜt
() = 0;

144 
vœtu®
 
	mMa¡”PÜt
 &
	$g‘D©aPÜt1
()

146 
	`çl
("BASE CPU SHOULD NOT CALL THIS");

148 
vœtu®
 
Ma¡”PÜt
 &
	$g‘D©aPÜt2
()

150 
	`çl
("BASE CPU SHOULD NOT CALL THIS");

151 
	}
}

152 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘D©aPÜt3
()

154 
	`çl
("BASE CPU SHOULD NOT CALL THIS");

155 
	}
}

156 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘D©aPÜt4
()

158 
	`çl
("BASE CPU SHOULD NOT CALL THIS");

159 
	}
}

167 
vœtu®
 
	gMa¡”PÜt
 &
g‘In¡PÜt
() = 0;

170 
	$ıuId
(è{  
_ıuId
; 
	}
}

173 
Ma¡”ID
 
	$d©aMa¡”Id
(è{  
_d©aMa¡”Id
; 
	}
}

175 
Ma¡”ID
 
	$š¡Ma¡”Id
(è{  
_š¡Ma¡”Id
; 
	}
}

187 
	gBa£Ma¡”PÜt
 &
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
,

188 
PÜtID
 
idx
 = 
Inv®idPÜtID
);

191 
ušt32_t
 
	$skId
(ècÚ¡ {  
_skId
; 
	}
}

193 
	$skId
(
ušt32_t
 
id
è{ 
_skId
 = id; 
	}
}

195 
ušt32_t
 
	$g‘Pid
(ècÚ¡ {  
_pid
; 
	}
}

196 
	$£tPid
(
ušt32_t
 
pid
è{ 
_pid
 =…id; 
	}
}

198 
šlše
 
	$wÜkI‹mBegš
(è{ 
numWÜkI‹msS¹ed
++; 
	}
}

199 
šlše
 
	$wÜkI‹mEnd
(è{ 
numWÜkI‹msCom¶‘ed
++; 
	}
}

201 
Tick
 
	$š¡CouÁ
(è{  
š¡CÁ
; 
	}
}

203 
	gTheISA
::
MiüocodeRom
 
miüocodeRom
;

205 
	g´Ùeùed
:

206 
TheISA
::
IÁ”ru±s
 *
š‹¼u±s
;

208 
	gpublic
:

209 
TheISA
::
IÁ”ru±s
 *

210 
	$g‘IÁ”ru±CÚŒŞËr
()

212  
š‹¼u±s
;

213 
	}
}

215 
vœtu®
 
wakeup
() = 0;

218 
	$po¡IÁ”ru±
(
št_num
, 
šdex
)

220 
š‹¼u±s
->
	`po¡
(
št_num
, 
šdex
);

221 ià(
FuÎSy¡em
)

222 
	`wakeup
();

223 
	}
}

226 
	$ş—rIÁ”ru±
(
št_num
, 
šdex
)

228 
š‹¼u±s
->
	`ş—r
(
št_num
, 
šdex
);

229 
	}
}

232 
	$ş—rIÁ”ru±s
()

234 
š‹¼u±s
->
	`ş—rAÎ
();

235 
	}
}

237 
boŞ


238 
	$checkIÁ”ru±s
(
Th»adCÚ‹xt
 *
tc
) const

240  
FuÎSy¡em
 && 
š‹¼u±s
->
	`checkIÁ”ru±s
(
tc
);

241 
	}
}

243 şas 
	cProfeEv’t
 : 
public
 
Ev’t


245 
´iv©e
:

246 
Ba£CPU
 *
ıu
;

247 
Tick
 
	gš‹rv®
;

249 
	gpublic
:

250 
ProfeEv’t
(
Ba£CPU
 *
ıu
, 
Tick
 
š‹rv®
);

251 
´oûss
();

253 
ProfeEv’t
 *
	g´ofeEv’t
;

255 
	g´Ùeùed
:

256 
¡d
::
veùÜ
<
Th»adCÚ‹xt
 *> 
th»adCÚ‹xts
;

258 
	gT¿û
::
In¡T¿ûr
 * 
Œaûr
;

260 
	gpublic
:

263 cÚ¡ 
Addr
 
PCMask
 = ~((Addr)(
TheISA
::
MachIn¡
) - 1);

266 
	gT¿û
::
In¡T¿ûr
 * 
	$g‘T¿ûr
(è{  
Œaûr
; 
	}
}

271 
vœtu®
 
	$aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
è{
	}
}

274 
vœtu®
 
	$su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
è{
	}
}

277 
vœtu®
 
	$d—Îoÿ‹CÚ‹xt
(
Th»adID
 
th»ad_num
è{
	}
}

280 
vœtu®
 
	$h®tCÚ‹xt
(
Th»adID
 
th»ad_num
è{
	}
}

283 
fšdCÚ‹xt
(
Th»adCÚ‹xt
 *
tc
);

286 
vœtu®
 
Th»adCÚ‹xt
 *
	$g‘CÚ‹xt
(
Š
è{  
th»adCÚ‹xts
[Š]; 
	}
}

288 
	gpublic
:

289 
Ba£CPUP¬ams
 
	tP¬ams
;

290 cÚ¡ 
P¬ams
 *
	$·¿ms
() const

291 {  
»š‹½»t_ÿ¡
<cÚ¡ 
P¬ams
 *>(
_·¿ms
); 
	}
}

292 
Ba£CPU
(
P¬ams
 *
·¿ms
, 
boŞ
 
is_check”
 = 
çl£
);

293 
	gvœtu®
 ~
Ba£CPU
();

295 
vœtu®
 
š™
();

296 
vœtu®
 
¡¬tup
();

297 
vœtu®
 
»gSts
();

299 
vœtu®
 
	$aùiv©eWh’R—dy
(
Th»adID
 
tid
è{
	}
};

301 
»gi¡”Th»adCÚ‹xts
();

310 
vœtu®
 
sw™chOut
();

323 
vœtu®
 
keOv”From
(
Ba£CPU
 *
ıu
);

334 
æushTLBs
();

341 
boŞ
 
	$sw™chedOut
(ècÚ¡ {  
_sw™chedOut
; 
	}
}

352 
vœtu®
 
	$v”ifyMemÜyMode
(ècÚ¡ { 
	}
};

358 
Th»adID
 
	gnumTh»ads
;

365 
Ev’tQueue
 **
	gcomIn¡Ev’tQueue
;

372 
Ev’tQueue
 **
	gcomLßdEv’tQueue
;

374 
Sy¡em
 *
	gsy¡em
;

379 
šlše
 
	$ÿcheLšeSize
(ècÚ¡ {  
_ÿcheLšeSize
; 
	}
}

391 
vœtu®
 
£rŸlize
(
¡d
::
o¡»am
 &
os
);

404 
vœtu®
 
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
);

412 
vœtu®
 
£rŸlizeTh»ad
(
¡d
::
o¡»am
 &
os
, 
Th»adID
 
tid
) {};

421 
vœtu®
 
un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
,

422 
Th»adID
 
tid
) {};

424 
vœtu®
 
CouÁ”
 
	$tÙ®In¡s
() const = 0;

426 
vœtu®
 
CouÁ”
 
	$tÙ®Ops
() const = 0;

441 
	`scheduËIn¡Stİ
(
Th»adID
 
tid
, 
CouÁ”
 
š¡s
, cÚ¡ *
ÿu£
);

456 
	`scheduËLßdStİ
(
Th»adID
 
tid
, 
CouÁ”
 
lßds
, cÚ¡ *
ÿu£
);

459 
´iv©e
:

460 
boŞ
 
funùiÚT¿cšgEÇbËd
;

461 
¡d
::
o¡»am
 *
funùiÚT¿ûSŒ—m
;

462 
Addr
 
cu¼’tFunùiÚS¹
;

463 
Addr
 
cu¼’tFunùiÚEnd
;

464 
Tick
 
funùiÚEÁryTick
;

465 
	`’abËFunùiÚT¿û
();

466 
	`ŒaûFunùiÚsIÁ”Çl
(
Addr
 
pc
);

468 
´iv©e
:

469 
¡d
::
veùÜ
<
Ba£CPU
 *> 
ıuLi¡
;

471 
public
:

472 
	$ŒaûFunùiÚs
(
Addr
 
pc
)

474 ià(
funùiÚT¿cšgEÇbËd
)

475 
	`ŒaûFunùiÚsIÁ”Çl
(
pc
);

476 
	}
}

478 
	$numSimuÏ‹dCPUs
(è{  
ıuLi¡
.
	`size
(); 
	}
}

479 
CouÁ”
 
	$numSimuÏ‹dIn¡s
()

481 
CouÁ”
 
tÙ®
 = 0;

483 
size
 = 
ıuLi¡
.
	`size
();

484 
i
 = 0; i < 
size
; ++i)

485 
tÙ®
 +ğ
ıuLi¡
[
i
]->
	`tÙ®In¡s
();

487  
tÙ®
;

488 
	}
}

490 
CouÁ”
 
	$numSimuÏ‹dOps
()

492 
CouÁ”
 
tÙ®
 = 0;

494 
size
 = 
ıuLi¡
.
	`size
();

495 
i
 = 0; i < 
size
; ++i)

496 
tÙ®
 +ğ
ıuLi¡
[
i
]->
	`tÙ®Ops
();

498  
tÙ®
;

499 
	}
}

501 
	gpublic
:

503 
Sts
::
SÿÏr
 
numCyşes
;

504 
	gSts
::
SÿÏr
 
numWÜkI‹msS¹ed
;

505 
	gSts
::
SÿÏr
 
numWÜkI‹msCom¶‘ed
;

	@base_dyn_inst.hh

46 #iâdeà
__CPU_BASE_DYN_INST_HH__


47 
	#__CPU_BASE_DYN_INST_HH__


	)

49 
	~<b™£t
>

50 
	~<li¡
>

51 
	~<¡ršg
>

52 
	~<queue
>

54 
	~"¬ch/ut™y.hh
"

55 
	~"ba£/Œaû.hh
"

56 
	~"cÚfig/the_i§.hh
"

57 
	~"ıu/check”/ıu.hh
"

58 
	~"ıu/o3/comm.hh
"

59 
	~"ıu/ex‘¿û.hh
"

60 
	~"ıu/š¡_£q.hh
"

61 
	~"ıu/İ_şass.hh
"

62 
	~"ıu/¡©ic_š¡.hh
"

63 
	~"ıu/Œª¦©iÚ.hh
"

64 
	~"mem/·ck‘.hh
"

65 
	~"sim/by‹sw­.hh
"

66 
	~"sim/çuÉ_fwd.hh
"

67 
	~"sim/sy¡em.hh
"

68 
	~"sim/b.hh
"

75 
	g‹m¶©e
 <
şass
 
	gIm¶
>

76 şas 
	cBa£DynIn¡
 : 
public
 
RefCouÁed


78 
public
:

80 
ty³Çme
 
	tIm¶
::
	tCPUTy³
 
	tIm¶CPU
;

81 
ty³Çme
 
	tIm¶CPU
::
	tIm¶S‹
 ImplState;

84 
	mTheISA
::
	tRegIndex
 RegIndex;

86 
	mTheISA
::
	tIÁReg
 IntReg;

88 
	mTheISA
::
	tFlßtReg
 FloatReg;

91 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

92 
	mRefCouÁšgPŒ
<
	tBa£DynIn¡
<
	tIm¶
> > 
	tBa£DynIn¡PŒ
;

95 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

98 
	mMaxIn¡SrcRegs
 = 
TheISA
::
MaxIn¡SrcRegs
,

99 
	mMaxIn¡De¡Regs
 = 
TheISA
::
MaxIn¡De¡Regs


102 
	uResuÉ
 {

103 
ušt64_t
 
	gš‹g”
;

104 
	gdbl
;

105 
£t
(
ušt64_t
 
i
è{ 
	gš‹g”
 = i; }

106 
£t
(
d
è{ 
	gdbl
 = d; }

107 
g‘
(
ušt64_t
& 
i
è{ 
	gi
 = 
š‹g”
; }

108 
g‘
(& 
d
è{ 
	gd
 = 
dbl
; }

111 
	g´Ùeùed
:

112 
	eStus
 {

113 
IqEÁry
,

114 
	gRobEÁry
,

115 
	gLsqEÁry
,

116 
	gCom¶‘ed
,

117 
	gResuÉR—dy
,

118 
	gCªIssue
,

119 
	gIssued
,

120 
	gExecu‹d
,

121 
	gCªComm™
,

122 
	gAtComm™
,

123 
	gComm™‹d
,

124 
	gSquashed
,

125 
	gSquashedInIQ
,

126 
	gSquashedInLSQ
,

127 
	gSquashedInROB
,

128 
	gRecov”In¡
,

129 
	gBlockšgIn¡
,

130 
	gTh»adsyncWa™
,

131 
	gS”ŸlizeBefÜe
,

133 
	gS”ŸlizeAá”
,

134 
	gS”ŸlizeHªdËd
,

135 
	gNumStus


138 
	eFÏgs
 {

139 
	gT¿n¦©iÚS¹ed
,

140 
	gT¿n¦©iÚCom¶‘ed
,

141 
	gPossibËLßdViŞ©iÚ
,

142 
	gH™Ex‹º®Snoİ
,

143 
	gEffAddrV®id
,

144 
	gRecÜdResuÉ
,

145 
	gP»diÿ‹
,

146 
	gP»dTak’
,

150 
	gEAC®cDÚe
,

151 
	gIsUnÿch—bË
,

152 
	gReqMade
,

153 
	gMemOpDÚe
,

154 
	gMaxFÏgs


157 
	gpublic
:

159 
In¡SeqNum
 
£qNum
;

162 
SticIn¡PŒ
 
	g¡©icIn¡
;

165 
Im¶CPU
 *
	gıu
;

168 
Im¶S‹
 *
	gth»ad
;

171 
FauÉ
 
	gçuÉ
;

174 
	gT¿û
::
In¡RecÜd
 *
ŒaûD©a
;

176 
	g´Ùeùed
:

180 
¡d
::
queue
<
ResuÉ
> 
š¡ResuÉ
;

183 
	gTheISA
::
PCS‹
 
pc
;

186 
	g¡d
::
b™£t
<
MaxFÏgs
> 
š¡FÏgs
;

189 
	g¡d
::
b™£t
<
NumStus
> 
¡©us
;

194 
	g¡d
::
b™£t
<
MaxIn¡SrcRegs
> 
_»adySrcRegIdx
;

196 
	gpublic
:

198 
Th»adID
 
th»adNumb”
;

201 
Li¡It
 
	gš¡Li¡It
;

205 
	gTheISA
::
PCS‹
 
´edPC
;

208 
SticIn¡PŒ
 
	gmaüoİ
;

211 
ušt8_t
 
	g»adyRegs
;

213 
	gpublic
:

216 
Addr
 
effAddr
;

219 
Addr
 
	gphysEffAddr
;

222 
	gmemReqFÏgs
;

225 
	gasid
;

228 
ušt8_t
 
	geffSize
;

231 
ušt8_t
 *
	gmemD©a
;

234 
št16_t
 
	glqIdx
;

237 
št16_t
 
	gsqIdx
;

245 
Reque¡PŒ
 
	g§vedReq
;

246 
Reque¡PŒ
 
	g§vedS»qLow
;

247 
Reque¡PŒ
 
	g§vedS»qHigh
;

251 
Reque¡PŒ
 
	g»qToV”ify
;

253 
	g´iv©e
:

257 
Addr
 
š¡EffAddr
;

259 
	g´Ùeùed
:

263 
TheISA
::
RegIndex
 
_æ©De¡RegIdx
[TheISA::
MaxIn¡De¡Regs
];

268 
PhysRegIndex
 
	g_de¡RegIdx
[
TheISA
::
MaxIn¡De¡Regs
];

273 
PhysRegIndex
 
	g_¤cRegIdx
[
TheISA
::
MaxIn¡SrcRegs
];

278 
PhysRegIndex
 
	g_´evDe¡RegIdx
[
TheISA
::
MaxIn¡De¡Regs
];

281 
	gpublic
:

283 
	$»cÜdResuÉ
(
boŞ
 
f
è{ 
š¡FÏgs
[
RecÜdResuÉ
] = f; 
	}
}

286 
boŞ
 
	$effAddrV®id
(ècÚ¡ {  
š¡FÏgs
[
EffAddrV®id
]; 
	}
}

289 
boŞ
 
	$memOpDÚe
(ècÚ¡ {  
š¡FÏgs
[
MemOpDÚe
]; 
	}
}

290 
	$memOpDÚe
(
boŞ
 
f
è{ 
š¡FÏgs
[
MemOpDÚe
] = f; 
	}
}

299 
	$dem­Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

301 
ıu
->
	`dem­Page
(
vaddr
, 
a¢
);

302 
	}
}

303 
	$dem­In¡Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

305 
ıu
->
	`dem­Page
(
vaddr
, 
a¢
);

306 
	}
}

307 
	$dem­D©aPage
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

309 
ıu
->
	`dem­Page
(
vaddr
, 
a¢
);

310 
	}
}

312 
FauÉ
 
»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
);

314 
FauÉ
 
wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

315 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

318 
¥l™Reque¡
(
Reque¡PŒ
 
»q
, Reque¡PŒ &
¤eqLow
,

319 
Reque¡PŒ
 &
¤eqHigh
);

322 
š™Ÿ‹T¿n¦©iÚ
(
Reque¡PŒ
 
»q
, Reque¡PŒ 
¤eqLow
,

323 
Reque¡PŒ
 
¤eqHigh
, 
ušt64_t
 *
»s
,

324 
Ba£TLB
::
Mode
 
mode
);

327 
fšishT¿n¦©iÚ
(
WhŞeT¿n¦©iÚS‹
 *
¡©e
);

330 
boŞ
 
	$Œª¦©iÚS¹ed
(ècÚ¡ {  
š¡FÏgs
[
T¿n¦©iÚS¹ed
]; 
	}
}

331 
	$Œª¦©iÚS¹ed
(
boŞ
 
f
è{ 
š¡FÏgs
[
T¿n¦©iÚS¹ed
] = f; 
	}
}

334 
boŞ
 
	$Œª¦©iÚCom¶‘ed
(ècÚ¡ {  
š¡FÏgs
[
T¿n¦©iÚCom¶‘ed
]; 
	}
}

335 
	$Œª¦©iÚCom¶‘ed
(
boŞ
 
f
è{ 
š¡FÏgs
[
T¿n¦©iÚCom¶‘ed
] = f; 
	}
}

342 
boŞ
 
	$possibËLßdViŞ©iÚ
(ècÚ¡ {  
š¡FÏgs
[
PossibËLßdViŞ©iÚ
]; 
	}
}

343 
	$possibËLßdViŞ©iÚ
(
boŞ
 
f
è{ 
š¡FÏgs
[
PossibËLßdViŞ©iÚ
] = f; 
	}
}

349 
boŞ
 
	$h™Ex‹º®Snoİ
(ècÚ¡ {  
š¡FÏgs
[
H™Ex‹º®Snoİ
]; 
	}
}

350 
	$h™Ex‹º®Snoİ
(
boŞ
 
f
è{ 
š¡FÏgs
[
H™Ex‹º®Snoİ
] = f; 
	}
}

356 
boŞ
 
	$isT¿n¦©iÚD–ayed
() const

358  (
	`Œª¦©iÚS¹ed
(è&& !
	`Œª¦©iÚCom¶‘ed
());

359 
	}
}

361 
	gpublic
:

362 #ifdeà
DEBUG


363 
dumpSNLi¡
();

369 
PhysRegIndex
 
	$»ÇmedDe¡RegIdx
(
idx
) const

371  
_de¡RegIdx
[
idx
];

372 
	}
}

375 
PhysRegIndex
 
	$»ÇmedSrcRegIdx
(
idx
) const

377 
	`as£¹
(
TheISA
::
MaxIn¡SrcRegs
 > 
idx
);

378  
_¤cRegIdx
[
idx
];

379 
	}
}

384 
	gTheISA
::
RegIndex
 
	$æ©‹ÃdDe¡RegIdx
(
idx
) const

386  
_æ©De¡RegIdx
[
idx
];

387 
	}
}

392 
PhysRegIndex
 
	$´evDe¡RegIdx
(
idx
) const

394  
_´evDe¡RegIdx
[
idx
];

395 
	}
}

400 
	$»ÇmeDe¡Reg
(
idx
,

401 
PhysRegIndex
 
»Çmed_de¡
,

402 
PhysRegIndex
 
´evious_»Çme
)

404 
_de¡RegIdx
[
idx
] = 
»Çmed_de¡
;

405 
_´evDe¡RegIdx
[
idx
] = 
´evious_»Çme
;

406 
	}
}

412 
	$»ÇmeSrcReg
(
idx
, 
PhysRegIndex
 
»Çmed_¤c
)

414 
_¤cRegIdx
[
idx
] = 
»Çmed_¤c
;

415 
	}
}

420 
æ©‹nDe¡Reg
(
idx
, 
TheISA
::
RegIndex
 
æ©‹Ãd_de¡
)

422 
_æ©De¡RegIdx
[
idx
] = 
æ©‹Ãd_de¡
;

431 
Ba£DynIn¡
(
SticIn¡PŒ
 
¡©icIn¡
, SticIn¡PŒ 
maüoİ
,

432 
TheISA
::
PCS‹
 
pc
, TheISA::PCS‹ 
´edPC
,

433 
In¡SeqNum
 
£q_num
, 
Im¶CPU
 *
ıu
);

438 
Ba£DynIn¡
(
SticIn¡PŒ
 
¡©icIn¡
, SticIn¡PŒ 
maüoİ
);

441 ~
Ba£DynIn¡
();

443 
	g´iv©e
:

445 
š™V¬s
();

447 
	gpublic
:

449 
dump
();

452 
dump
(
¡d
::
¡ršg
 &
out¡ršg
);

455 
	$ıuId
(è{  
ıu
->
	`ıuId
(); 
	}
}

458 
Ma¡”ID
 
	$ma¡”Id
(è{  
ıu
->
	`d©aMa¡”Id
(); 
	}
}

461 
	$cÚ‹xtId
(è{  
th»ad
->
	`cÚ‹xtId
(); 
	}
}

464 
FauÉ
 
	$g‘FauÉ
(è{  
çuÉ
; 
	}
}

471 
boŞ
 
	$dÚeT¬gC®c
(è{  
çl£
; 
	}
}

474 
£tP»dT¬g
(cÚ¡ 
TheISA
::
PCS‹
 &
_´edPC
)

476 
´edPC
 = 
_´edPC
;

479 cÚ¡ 
	gTheISA
::
PCS‹
 &
	$»adP»dT¬g
(è{  
´edPC
; 
	}
}

482 
Addr
 
	$´edIn¡Addr
(è{  
´edPC
.
	`š¡Addr
(); 
	}
}

485 
Addr
 
	$´edNextIn¡Addr
(è{  
´edPC
.
	`ÃxtIn¡Addr
(); 
	}
}

488 
Addr
 
	$´edMiüoPC
(è{  
´edPC
.
	`miüoPC
(); 
	}
}

491 
boŞ
 
	$»adP»dTak’
()

493  
š¡FÏgs
[
P»dTak’
];

494 
	}
}

496 
	$£tP»dTak’
(
boŞ
 
´ediùed_k’
)

498 
š¡FÏgs
[
P»dTak’
] = 
´ediùed_k’
;

499 
	}
}

502 
boŞ
 
	$mi¥»diùed
()

504 
TheISA
::
PCS‹
 
‹mpPC
 = 
pc
;

505 
TheISA
::
	`advªûPC
(
‹mpPC
, 
¡©icIn¡
);

506  !(
‹mpPC
 =ğ
´edPC
);

507 
	}
}

512 
boŞ
 
	$isNİ
(ècÚ¡ {  
¡©icIn¡
->
	`isNİ
(); 
	}
}

513 
boŞ
 
	$isMemRef
(ècÚ¡ {  
¡©icIn¡
->
	`isMemRef
(); 
	}
}

514 
boŞ
 
	$isLßd
(ècÚ¡ {  
¡©icIn¡
->
	`isLßd
(); 
	}
}

515 
boŞ
 
	$isStÜe
(ècÚ¡ {  
¡©icIn¡
->
	`isStÜe
(); 
	}
}

516 
boŞ
 
	$isStÜeCÚd™iÚ®
() const

517 {  
¡©icIn¡
->
	`isStÜeCÚd™iÚ®
(); 
	}
}

518 
boŞ
 
	$isIn¡P»ãtch
(ècÚ¡ {  
¡©icIn¡
->
	`isIn¡P»ãtch
(); 
	}
}

519 
boŞ
 
	$isD©aP»ãtch
(ècÚ¡ {  
¡©icIn¡
->
	`isD©aP»ãtch
(); 
	}
}

520 
boŞ
 
	$isIÁeg”
(ècÚ¡ {  
¡©icIn¡
->
	`isIÁeg”
(); 
	}
}

521 
boŞ
 
	$isFlßtšg
(ècÚ¡ {  
¡©icIn¡
->
	`isFlßtšg
(); 
	}
}

522 
boŞ
 
	$isCÚŒŞ
(ècÚ¡ {  
¡©icIn¡
->
	`isCÚŒŞ
(); 
	}
}

523 
boŞ
 
	$isC®l
(ècÚ¡ {  
¡©icIn¡
->
	`isC®l
(); 
	}
}

524 
boŞ
 
	$isR‘uº
(ècÚ¡ {  
¡©icIn¡
->
	`isR‘uº
(); 
	}
}

525 
boŞ
 
	$isDœeùCŒl
(ècÚ¡ {  
¡©icIn¡
->
	`isDœeùCŒl
(); 
	}
}

526 
boŞ
 
	$isIndœeùCŒl
(ècÚ¡ {  
¡©icIn¡
->
	`isIndœeùCŒl
(); 
	}
}

527 
boŞ
 
	$isCÚdCŒl
(ècÚ¡ {  
¡©icIn¡
->
	`isCÚdCŒl
(); 
	}
}

528 
boŞ
 
	$isUncÚdCŒl
(ècÚ¡ {  
¡©icIn¡
->
	`isUncÚdCŒl
(); 
	}
}

529 
boŞ
 
	$isCÚdD–aySlÙ
(ècÚ¡ {  
¡©icIn¡
->
	`isCÚdD–aySlÙ
(); 
	}
}

530 
boŞ
 
	$isTh»adSync
(ècÚ¡ {  
¡©icIn¡
->
	`isTh»adSync
(); 
	}
}

531 
boŞ
 
	$isS”Ÿlizšg
(ècÚ¡ {  
¡©icIn¡
->
	`isS”Ÿlizšg
(); 
	}
}

532 
boŞ
 
	$isS”ŸlizeBefÜe
() const

533 {  
¡©icIn¡
->
	`isS”ŸlizeBefÜe
(è|| 
¡©us
[
S”ŸlizeBefÜe
]; 
	}
}

534 
boŞ
 
	$isS”ŸlizeAá”
() const

535 {  
¡©icIn¡
->
	`isS”ŸlizeAá”
(è|| 
¡©us
[
S”ŸlizeAá”
]; 
	}
}

536 
boŞ
 
	$isSquashAá”
(ècÚ¡ {  
¡©icIn¡
->
	`isSquashAá”
(); 
	}
}

537 
boŞ
 
	$isMemB¬r›r
(ècÚ¡ {  
¡©icIn¡
->
	`isMemB¬r›r
(); 
	}
}

538 
boŞ
 
	$isWr™eB¬r›r
(ècÚ¡ {  
¡©icIn¡
->
	`isWr™eB¬r›r
(); 
	}
}

539 
boŞ
 
	$isNÚS³cuÏtive
(ècÚ¡ {  
¡©icIn¡
->
	`isNÚS³cuÏtive
(); 
	}
}

540 
boŞ
 
	$isQu›sû
(ècÚ¡ {  
¡©icIn¡
->
	`isQu›sû
(); 
	}
}

541 
boŞ
 
	$isI´Acûss
(ècÚ¡ {  
¡©icIn¡
->
	`isI´Acûss
(); 
	}
}

542 
boŞ
 
	$isUnv”ifŸbË
(ècÚ¡ {  
¡©icIn¡
->
	`isUnv”ifŸbË
(); 
	}
}

543 
boŞ
 
	$isSysÿÎ
(ècÚ¡ {  
¡©icIn¡
->
	`isSysÿÎ
(); 
	}
}

544 
boŞ
 
	$isMaüoİ
(ècÚ¡ {  
¡©icIn¡
->
	`isMaüoİ
(); 
	}
}

545 
boŞ
 
	$isMiüoİ
(ècÚ¡ {  
¡©icIn¡
->
	`isMiüoİ
(); 
	}
}

546 
boŞ
 
	$isD–ayedComm™
(ècÚ¡ {  
¡©icIn¡
->
	`isD–ayedComm™
(); 
	}
}

547 
boŞ
 
	$isLa¡Miüoİ
(ècÚ¡ {  
¡©icIn¡
->
	`isLa¡Miüoİ
(); 
	}
}

548 
boŞ
 
	$isFœ¡Miüoİ
(ècÚ¡ {  
¡©icIn¡
->
	`isFœ¡Miüoİ
(); 
	}
}

549 
boŞ
 
	$isMiüoB¿nch
(ècÚ¡ {  
¡©icIn¡
->
	`isMiüoB¿nch
(); 
	}
}

552 
	$£tS”ŸlizeBefÜe
(è{ 
¡©us
.
	`£t
(
S”ŸlizeBefÜe
); 
	}
}

555 
	$ş—rS”ŸlizeBefÜe
(è{ 
¡©us
.
	`»£t
(
S”ŸlizeBefÜe
); 
	}
}

558 
boŞ
 
	$isTempS”ŸlizeBefÜe
(è{  
¡©us
[
S”ŸlizeBefÜe
]; 
	}
}

561 
	$£tS”ŸlizeAá”
(è{ 
¡©us
.
	`£t
(
S”ŸlizeAá”
); 
	}
}

564 
	$ş—rS”ŸlizeAá”
(è{ 
¡©us
.
	`»£t
(
S”ŸlizeAá”
); 
	}
}

567 
boŞ
 
	$isTempS”ŸlizeAá”
(è{  
¡©us
[
S”ŸlizeAá”
]; 
	}
}

570 
	$£tS”ŸlizeHªdËd
(è{ 
¡©us
.
	`£t
(
S”ŸlizeHªdËd
); 
	}
}

577 
boŞ
 
	$isS”ŸlizeHªdËd
(è{  
¡©us
[
S”ŸlizeHªdËd
]; 
	}
}

580 
OpCÏss
 
	$İCÏss
(ècÚ¡ {  
¡©icIn¡
->
	`İCÏss
(); 
	}
}

583 
	gTheISA
::
PCS‹
 
	$b¿nchT¬g‘
() const

584 {  
¡©icIn¡
->
	`b¿nchT¬g‘
(
pc
); 
	}
}

587 
št8_t
 
	$numSrcRegs
(ècÚ¡ {  
¡©icIn¡
->
	`numSrcRegs
(); 
	}
}

590 
št8_t
 
	$numDe¡Regs
(ècÚ¡ {  
¡©icIn¡
->
	`numDe¡Regs
(); 
	}
}

594 
št8_t
 
	$numFPDe¡Regs
(ècÚ¡ {  
¡©icIn¡
->
	`numFPDe¡Regs
(); 
	}
}

595 
št8_t
 
	$numIÁDe¡Regs
(ècÚ¡ {  
¡©icIn¡
->
	`numIÁDe¡Regs
(); 
	}
}

598 
RegIndex
 
	$de¡RegIdx
(
i
ècÚ¡ {  
¡©icIn¡
->
	`de¡RegIdx
(i); 
	}
}

601 
RegIndex
 
	$¤cRegIdx
(
i
ècÚ¡ {  
¡©icIn¡
->
	`¤cRegIdx
(i); 
	}
}

604 
	g‹m¶©e
 <
şass
 
	gT
>

605 
	$pİResuÉ
(
T
& 
t
)

607 ià(!
š¡ResuÉ
.
	`em±y
()) {

608 
š¡ResuÉ
.
	`äÚt
().
	`g‘
(
t
);

609 
š¡ResuÉ
.
	`pİ
();

611 
	}
}

614 
	g‹m¶©e
 <
şass
 
	gT
>

615 
	$»adResuÉ
(
T
& 
t
)

617 
š¡ResuÉ
.
	`back
().
	`g‘
(
t
);

618 
	}
}

621 
	g‹m¶©e
 <
şass
 
	gT
>

622 
	$£tResuÉ
(
T
 
t
)

624 ià(
š¡FÏgs
[
RecÜdResuÉ
]) {

625 
ResuÉ
 
š¡Res
;

626 
š¡Res
.
	`£t
(
t
);

627 
š¡ResuÉ
.
	`push
(
š¡Res
);

629 
	}
}

632 
	$£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

634 
£tResuÉ
<
ušt64_t
>(
v®
);

635 
	}
}

638 
	$£tCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

640 
£tResuÉ
<
ušt64_t
>(
v®
);

641 
	}
}

644 
	$£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
,

645 
width
)

647 ià(
width
 == 32 || width == 64) {

648 
£tResuÉ
<>(
v®
);

650 
	`·nic
("Unsupported width!");

652 
	}
}

655 
	$£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
)

657 
£tResuÉ
<>(
v®
);

658 
	}
}

661 
	$£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
,

662 
width
)

664 
£tResuÉ
<
ušt64_t
>(
v®
);

665 
	}
}

668 
	$£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

670 
£tResuÉ
<
ušt64_t
>(
v®
);

671 
	}
}

674 
m¬kSrcRegR—dy
();

677 
m¬kSrcRegR—dy
(
RegIndex
 
¤c_idx
);

680 
boŞ
 
	$isR—dySrcRegIdx
(
idx
) const

682  
this
->
_»adySrcRegIdx
[
idx
];

683 
	}
}

686 
	$£tCom¶‘ed
(è{ 
¡©us
.
	`£t
(
Com¶‘ed
); 
	}
}

689 
boŞ
 
	$isCom¶‘ed
(ècÚ¡ {  
¡©us
[
Com¶‘ed
]; 
	}
}

692 
	$£tResuÉR—dy
(è{ 
¡©us
.
	`£t
(
ResuÉR—dy
); 
	}
}

695 
boŞ
 
	$isResuÉR—dy
(ècÚ¡ {  
¡©us
[
ResuÉR—dy
]; 
	}
}

698 
	$£tCªIssue
(è{ 
¡©us
.
	`£t
(
CªIssue
); 
	}
}

701 
boŞ
 
	$»adyToIssue
(ècÚ¡ {  
¡©us
[
CªIssue
]; 
	}
}

704 
	$ş—rCªIssue
(è{ 
¡©us
.
	`»£t
(
CªIssue
); 
	}
}

707 
	$£tIssued
(è{ 
¡©us
.
	`£t
(
Issued
); 
	}
}

710 
boŞ
 
	$isIssued
(ècÚ¡ {  
¡©us
[
Issued
]; 
	}
}

713 
	$ş—rIssued
(è{ 
¡©us
.
	`»£t
(
Issued
); 
	}
}

716 
	$£tExecu‹d
(è{ 
¡©us
.
	`£t
(
Execu‹d
); 
	}
}

719 
boŞ
 
	$isExecu‹d
(ècÚ¡ {  
¡©us
[
Execu‹d
]; 
	}
}

722 
	$£tCªComm™
(è{ 
¡©us
.
	`£t
(
CªComm™
); 
	}
}

725 
	$ş—rCªComm™
(è{ 
¡©us
.
	`»£t
(
CªComm™
); 
	}
}

728 
boŞ
 
	$»adyToComm™
(ècÚ¡ {  
¡©us
[
CªComm™
]; 
	}
}

730 
	$£tAtComm™
(è{ 
¡©us
.
	`£t
(
AtComm™
); 
	}
}

732 
boŞ
 
	$isAtComm™
(è{  
¡©us
[
AtComm™
]; 
	}
}

735 
	$£tComm™‹d
(è{ 
¡©us
.
	`£t
(
Comm™‹d
); 
	}
}

738 
boŞ
 
	$isComm™‹d
(ècÚ¡ {  
¡©us
[
Comm™‹d
]; 
	}
}

741 
	$£tSquashed
(è{ 
¡©us
.
	`£t
(
Squashed
); 
	}
}

744 
boŞ
 
	$isSquashed
(ècÚ¡ {  
¡©us
[
Squashed
]; 
	}
}

749 
	$£tInIQ
(è{ 
¡©us
.
	`£t
(
IqEÁry
); 
	}
}

752 
	$ş—rInIQ
(è{ 
¡©us
.
	`»£t
(
IqEÁry
); 
	}
}

755 
boŞ
 
	$isInIQ
(ècÚ¡ {  
¡©us
[
IqEÁry
]; 
	}
}

758 
	$£tSquashedInIQ
(è{ 
¡©us
.
	`£t
(
SquashedInIQ
); stus.£t(
Squashed
);
	}
}

761 
boŞ
 
	$isSquashedInIQ
(ècÚ¡ {  
¡©us
[
SquashedInIQ
]; 
	}
}

767 
	$£tInLSQ
(è{ 
¡©us
.
	`£t
(
LsqEÁry
); 
	}
}

770 
	$»moveInLSQ
(è{ 
¡©us
.
	`»£t
(
LsqEÁry
); 
	}
}

773 
boŞ
 
	$isInLSQ
(ècÚ¡ {  
¡©us
[
LsqEÁry
]; 
	}
}

776 
	$£tSquashedInLSQ
(è{ 
¡©us
.
	`£t
(
SquashedInLSQ
);
	}
}

779 
boŞ
 
	$isSquashedInLSQ
(ècÚ¡ {  
¡©us
[
SquashedInLSQ
]; 
	}
}

785 
	$£tInROB
(è{ 
¡©us
.
	`£t
(
RobEÁry
); 
	}
}

788 
	$ş—rInROB
(è{ 
¡©us
.
	`»£t
(
RobEÁry
); 
	}
}

791 
boŞ
 
	$isInROB
(ècÚ¡ {  
¡©us
[
RobEÁry
]; 
	}
}

794 
	$£tSquashedInROB
(è{ 
¡©us
.
	`£t
(
SquashedInROB
); 
	}
}

797 
boŞ
 
	$isSquashedInROB
(ècÚ¡ {  
¡©us
[
SquashedInROB
]; 
	}
}

800 cÚ¡ 
	gTheISA
::
PCS‹
 
	$pcS‹
(ècÚ¡ {  
pc
; 
	}
}

803 cÚ¡ 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
è{ 
pc
 = val; }

806 cÚ¡ 
Addr
 
	$š¡Addr
(ècÚ¡ {  
pc
.
	`š¡Addr
(); 
	}
}

809 cÚ¡ 
Addr
 
	$ÃxtIn¡Addr
(ècÚ¡ {  
pc
.
	`ÃxtIn¡Addr
(); 
	}
}

812 cÚ¡ 
Addr
 
	$miüoPC
(ècÚ¡ {  
pc
.
	`miüoPC
(); 
	}
}

814 
boŞ
 
	$»adP»diÿ‹
()

816  
š¡FÏgs
[
P»diÿ‹
];

817 
	}
}

819 
	$£tP»diÿ‹
(
boŞ
 
v®
)

821 
š¡FÏgs
[
P»diÿ‹
] = 
v®
;

823 ià(
ŒaûD©a
) {

824 
ŒaûD©a
->
	`£tP»diÿ‹
(
v®
);

826 
	}
}

829 
	$£tASID
(
addr_¥aû_id
è{ 
asid
 =‡ddr_¥aû_id; 
	}
}

832 
	$£tTid
(
Th»adID
 
tid
è{ 
th»adNumb”
 =id; 
	}
}

835 
	$£tTh»adS‹
(
Im¶S‹
 *
¡©e
è{ 
th»ad
 = s‹; 
	}
}

838 
Th»adCÚ‹xt
 *
	$tcBa£
(è{  
th»ad
->
	`g‘TC
(); 
	}
}

840 
	gpublic
:

842 
	$£tEA
(
Addr
 &
—
è{ 
š¡EffAddr
 =ƒa; 
š¡FÏgs
[
EAC®cDÚe
] = 
Œue
; 
	}
}

845 cÚ¡ 
	gAddr
 &
	$g‘EA
(ècÚ¡ {  
š¡EffAddr
; 
	}
}

848 
boŞ
 
	$dÚeEAC®c
(è{  
š¡FÏgs
[
EAC®cDÚe
]; 
	}
}

851 
boŞ
 
—SrcsR—dy
();

854 
boŞ
 
	$unÿch—bË
(è{  
š¡FÏgs
[
IsUnÿch—bË
]; 
	}
}

857 
boŞ
 
	$hasReque¡
(è{  
š¡FÏgs
[
ReqMade
]; 
	}
}

860 
	gLi¡It
 &
	$g‘In¡Li¡It
(è{  
š¡Li¡It
; 
	}
}

863 
	$£tIn¡Li¡It
(
Li¡It
 
_š¡Li¡It
è{ 
š¡Li¡It
 = _š¡Li¡It; 
	}
}

865 
	gpublic
:

867 
	$»adStCÚdFau»s
()

868 {  
th»ad
->
¡ÜeCÚdFau»s
; 
	}
}

871 
	$£tStCÚdFau»s
(
sc_çu»s
)

872 { 
th»ad
->
¡ÜeCÚdFau»s
 = 
sc_çu»s
; 
	}
}

875 
	g‹m¶©e
<
şass
 
	gIm¶
>

876 
FauÉ


877 
	gBa£DynIn¡
<
	gIm¶
>::
	$»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
,

878 
size
, 
æags
)

880 
š¡FÏgs
[
ReqMade
] = 
Œue
;

881 
Reque¡
 *
»q
 = 
NULL
;

882 
Reque¡
 *
¤eqLow
 = 
NULL
;

883 
Reque¡
 *
¤eqHigh
 = 
NULL
;

885 ià(
š¡FÏgs
[
ReqMade
] && 
	`Œª¦©iÚS¹ed
()) {

886 
»q
 = 
§vedReq
;

887 
¤eqLow
 = 
§vedS»qLow
;

888 
¤eqHigh
 = 
§vedS»qHigh
;

890 
»q
 = 
Ãw
 
	`Reque¡
(
asid
, 
addr
, 
size
, 
æags
, 
	`ma¡”Id
(), 
this
->
pc
.
	`š¡Addr
(),

891 
th»ad
->
	`cÚ‹xtId
(), 
th»adNumb”
);

894 ià(
TheISA
::
HasUÇligÃdMemAcc
) {

895 
	`¥l™Reque¡
(
»q
, 
¤eqLow
, 
¤eqHigh
);

897 
	`š™Ÿ‹T¿n¦©iÚ
(
»q
, 
¤eqLow
, 
¤eqHigh
, 
NULL
, 
Ba£TLB
::
R—d
);

900 ià(
	`Œª¦©iÚCom¶‘ed
()) {

901 ià(
çuÉ
 =ğ
NoFauÉ
) {

902 
effAddr
 = 
»q
->
	`g‘Vaddr
();

903 
effSize
 = 
size
;

904 
š¡FÏgs
[
EffAddrV®id
] = 
Œue
;

906 ià(
ıu
->
check”
) {

907 ià(
»qToV”ify
 !ğ
NULL
) {

908 
d–‘e
 
»qToV”ify
;

910 
»qToV”ify
 = 
Ãw
 
	`Reque¡
(*
»q
);

912 
çuÉ
 = 
ıu
->
	`»ad
(
»q
, 
¤eqLow
, 
¤eqHigh
, 
d©a
, 
lqIdx
);

916 
this
->
	`£tExecu‹d
();

919 ià(
çuÉ
 !ğ
NoFauÉ
) {

922 ià(
d©a
)

923 
	`bz”o
(
d©a
, 
size
);

927 ià(
ŒaûD©a
) {

928 
ŒaûD©a
->
	`£tAddr
(
addr
);

931  
çuÉ
;

932 
	}
}

934 
	g‹m¶©e
<
şass
 
	gIm¶
>

935 
FauÉ


936 
	gBa£DynIn¡
<
	gIm¶
>::
	$wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

937 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
)

939 ià(
ŒaûD©a
) {

940 
ŒaûD©a
->
	`£tAddr
(
addr
);

943 
š¡FÏgs
[
ReqMade
] = 
Œue
;

944 
Reque¡
 *
»q
 = 
NULL
;

945 
Reque¡
 *
¤eqLow
 = 
NULL
;

946 
Reque¡
 *
¤eqHigh
 = 
NULL
;

948 ià(
š¡FÏgs
[
ReqMade
] && 
	`Œª¦©iÚS¹ed
()) {

949 
»q
 = 
§vedReq
;

950 
¤eqLow
 = 
§vedS»qLow
;

951 
¤eqHigh
 = 
§vedS»qHigh
;

953 
»q
 = 
Ãw
 
	`Reque¡
(
asid
, 
addr
, 
size
, 
æags
, 
	`ma¡”Id
(), 
this
->
pc
.
	`š¡Addr
(),

954 
th»ad
->
	`cÚ‹xtId
(), 
th»adNumb”
);

957 ià(
TheISA
::
HasUÇligÃdMemAcc
) {

958 
	`¥l™Reque¡
(
»q
, 
¤eqLow
, 
¤eqHigh
);

960 
	`š™Ÿ‹T¿n¦©iÚ
(
»q
, 
¤eqLow
, 
¤eqHigh
, 
»s
, 
Ba£TLB
::
Wr™e
);

963 ià(
çuÉ
 =ğ
NoFauÉ
 && 
	`Œª¦©iÚCom¶‘ed
()) {

964 
effAddr
 = 
»q
->
	`g‘Vaddr
();

965 
effSize
 = 
size
;

966 
š¡FÏgs
[
EffAddrV®id
] = 
Œue
;

968 ià(
ıu
->
check”
) {

969 ià(
»qToV”ify
 !ğ
NULL
) {

970 
d–‘e
 
»qToV”ify
;

972 
»qToV”ify
 = 
Ãw
 
	`Reque¡
(*
»q
);

974 
çuÉ
 = 
ıu
->
	`wr™e
(
»q
, 
¤eqLow
, 
¤eqHigh
, 
d©a
, 
sqIdx
);

977  
çuÉ
;

978 
	}
}

980 
	g‹m¶©e
<
şass
 
	gIm¶
>

981 
šlše
 

982 
	gBa£DynIn¡
<
	gIm¶
>::
	$¥l™Reque¡
(
Reque¡PŒ
 
»q
, Reque¡PŒ &
¤eqLow
,

983 
Reque¡PŒ
 &
¤eqHigh
)

986 
block_size
 = 
ıu
->
	`ÿcheLšeSize
();

987 
Addr
 
addr
 = 
»q
->
	`g‘Vaddr
();

988 
Addr
 
¥l™_addr
 = 
	`roundDown
(
addr
 + 
»q
->
	`g‘Size
(è- 1, 
block_size
);

989 
	`as£¹
(
¥l™_addr
 <ğ
addr
 || s¶™_add¸-‡dd¸< 
block_size
);

992 ià(
¥l™_addr
 > 
addr
) {

993 
»q
->
	`¥l™OnVaddr
(
¥l™_addr
, 
¤eqLow
, 
¤eqHigh
);

995 
	}
}

997 
	g‹m¶©e
<
şass
 
	gIm¶
>

998 
šlše
 

999 
	gBa£DynIn¡
<
	gIm¶
>::
š™Ÿ‹T¿n¦©iÚ
(
Reque¡PŒ
 
»q
, Reque¡PŒ 
¤eqLow
,

1000 
Reque¡PŒ
 
¤eqHigh
, 
ušt64_t
 *
»s
,

1001 
Ba£TLB
::
Mode
 
mode
)

1003 
Œª¦©iÚS¹ed
(
Œue
);

1005 ià(!
	gTheISA
::
HasUÇligÃdMemAcc
 || 
¤eqLow
 =ğ
NULL
) {

1006 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 =

1007 
Ãw
 
WhŞeT¿n¦©iÚS‹
(
»q
, 
NULL
, 
»s
, 
mode
);

1010 
	gD©aT¿n¦©iÚ
<
	gBa£DynIn¡PŒ
> *
	gŒªs
 =

1011 
Ãw
 
D©aT¿n¦©iÚ
<
Ba£DynIn¡PŒ
>(
this
, 
	g¡©e
);

1013 
	gıu
->
	gdtb
->
Œª¦©eTimšg
(
»q
, 
th»ad
->
g‘TC
(), 
Œªs
, 
mode
);

1015 ià(!
Œª¦©iÚCom¶‘ed
()) {

1020 
	gçuÉ
 = 
NoFauÉ
;

1023 
	g§vedReq
 = 
¡©e
->
mašReq
;

1024 
	g§vedS»qLow
 = 
¡©e
->
¤eqLow
;

1025 
	g§vedS»qHigh
 = 
¡©e
->
¤eqHigh
;

1028 
WhŞeT¿n¦©iÚS‹
 *
	g¡©e
 =

1029 
Ãw
 
WhŞeT¿n¦©iÚS‹
(
»q
, 
¤eqLow
, 
¤eqHigh
, 
NULL
, 
»s
, 
mode
);

1032 
	gD©aT¿n¦©iÚ
<
	gBa£DynIn¡PŒ
> *
	g¡¿nsLow
 =

1033 
Ãw
 
D©aT¿n¦©iÚ
<
Ba£DynIn¡PŒ
>(
this
, 
	g¡©e
, 0);

1034 
	gD©aT¿n¦©iÚ
<
	gBa£DynIn¡PŒ
> *
	g¡¿nsHigh
 =

1035 
Ãw
 
D©aT¿n¦©iÚ
<
Ba£DynIn¡PŒ
>(
this
, 
	g¡©e
, 1);

1037 
	gıu
->
	gdtb
->
Œª¦©eTimšg
(
¤eqLow
, 
th»ad
->
g‘TC
(), 
¡¿nsLow
, 
mode
);

1038 
	gıu
->
	gdtb
->
Œª¦©eTimšg
(
¤eqHigh
, 
th»ad
->
g‘TC
(), 
¡¿nsHigh
, 
mode
);

1040 ià(!
Œª¦©iÚCom¶‘ed
()) {

1045 
	gçuÉ
 = 
NoFauÉ
;

1048 
	g§vedReq
 = 
¡©e
->
mašReq
;

1049 
	g§vedS»qLow
 = 
¡©e
->
¤eqLow
;

1050 
	g§vedS»qHigh
 = 
¡©e
->
¤eqHigh
;

1055 
	g‹m¶©e
<
şass
 
	gIm¶
>

1056 
šlše
 

1057 
	gBa£DynIn¡
<
	gIm¶
>::
	$fšishT¿n¦©iÚ
(
WhŞeT¿n¦©iÚS‹
 *
¡©e
)

1059 
çuÉ
 = 
¡©e
->
	`g‘FauÉ
();

1061 
š¡FÏgs
[
IsUnÿch—bË
] = 
¡©e
->
	`isUnÿch—bË
();

1063 ià(
çuÉ
 =ğ
NoFauÉ
) {

1064 
physEffAddr
 = 
¡©e
->
	`g‘Paddr
();

1065 
memReqFÏgs
 = 
¡©e
->
	`g‘FÏgs
();

1067 ià(
¡©e
->
mašReq
->
	`isCÚdSw­
()) {

1068 
	`as£¹
(
¡©e
->
»s
);

1069 
¡©e
->
mašReq
->
	`£tExŒaD©a
(*¡©e->
»s
);

1073 
¡©e
->
	`d–‘eReqs
();

1075 
d–‘e
 
¡©e
;

1077 
	`Œª¦©iÚCom¶‘ed
(
Œue
);

1078 
	}
}

	@base_dyn_inst_impl.hh

43 #iâdeà
__CPU_BASE_DYN_INST_IMPL_HH__


44 
	#__CPU_BASE_DYN_INST_IMPL_HH__


	)

46 
	~<io¡»am
>

47 
	~<£t
>

48 
	~<s¡»am
>

49 
	~<¡ršg
>

51 
	~"ba£/ırštf.hh
"

52 
	~"ba£/Œaû.hh
"

53 
	~"cÚfig/the_i§.hh
"

54 
	~"ıu/ba£_dyn_š¡.hh
"

55 
	~"ıu/ex‘¿û.hh
"

56 
	~"debug/DynIn¡.hh
"

57 
	~"debug/IQ.hh
"

58 
	~"mem/»que¡.hh
"

59 
	~"sim/çuÉs.hh
"

61 
	g‹m¶©e
 <
şass
 
	gIm¶
>

62 
	gBa£DynIn¡
<
	gIm¶
>::
Ba£DynIn¡
(
SticIn¡PŒ
 
_¡©icIn¡
,

63 
SticIn¡PŒ
 
_maüoİ
,

64 
TheISA
::
PCS‹
 
_pc
, TheISA::PCS‹ 
_´edPC
,

65 
In¡SeqNum
 
£q_num
, 
Im¶CPU
 *
ıu
)

66 : 
¡©icIn¡
(
_¡©icIn¡
), 
ıu
(ıu), 
ŒaûD©a
(
NULL
), 
	$maüoİ
(
_maüoİ
)

68 
£qNum
 = 
£q_num
;

70 
pc
 = 
_pc
;

71 
´edPC
 = 
_´edPC
;

73 
	`š™V¬s
();

74 
	}
}

76 
	g‹m¶©e
 <
şass
 
	gIm¶
>

77 
	gBa£DynIn¡
<
	gIm¶
>::
	$Ba£DynIn¡
(
SticIn¡PŒ
 
_¡©icIn¡
,

78 
SticIn¡PŒ
 
_maüoİ
)

79 : 
	`¡©icIn¡
(
_¡©icIn¡
), 
	`ŒaûD©a
(
NULL
), 
	$maüoİ
(
_maüoİ
)

81 
£qNum
 = 0;

82 
	`š™V¬s
();

83 
	}
}

85 
	g‹m¶©e
 <
şass
 
	gIm¶
>

87 
	gBa£DynIn¡
<
	gIm¶
>::
	$š™V¬s
()

89 
memD©a
 = 
NULL
;

90 
effAddr
 = 0;

91 
physEffAddr
 = 0;

92 
»adyRegs
 = 0;

94 
¡©us
.
	`»£t
();

96 
š¡FÏgs
.
	`»£t
();

97 
š¡FÏgs
[
RecÜdResuÉ
] = 
Œue
;

98 
š¡FÏgs
[
P»diÿ‹
] = 
Œue
;

100 
lqIdx
 = -1;

101 
sqIdx
 = -1;

104 
th»adNumb”
 = 0;

107 
asid
 = 0;

110 
çuÉ
 = 
NoFauÉ
;

112 #iâdeà
NDEBUG


113 ++
ıu
->
š¡couÁ
;

115 ià(
ıu
->
š¡couÁ
 > 1500) {

116 #ifdeà
DEBUG


117 
ıu
->
	`dumpIn¡s
();

118 
	`dumpSNLi¡
();

120 
	`as£¹
(
ıu
->
š¡couÁ
 <= 1500);

123 
	`DPRINTF
(
DynIn¡
,

125 
£qNum
, 
ıu
->
	`Çme
(), cpu->
š¡couÁ
);

128 #ifdeà
DEBUG


129 
ıu
->
¢Li¡
.
	`š£¹
(
£qNum
);

132 
»qToV”ify
 = 
NULL
;

133 
	}
}

135 
	g‹m¶©e
 <
şass
 
	gIm¶
>

136 
	gBa£DynIn¡
<
	gIm¶
>::~
	$Ba£DynIn¡
()

138 ià(
memD©a
) {

139 
d–‘e
 [] 
memD©a
;

142 ià(
ŒaûD©a
) {

143 
d–‘e
 
ŒaûD©a
;

146 
çuÉ
 = 
NoFauÉ
;

148 #iâdeà
NDEBUG


149 --
ıu
->
š¡couÁ
;

151 
	`DPRINTF
(
DynIn¡
,

153 
£qNum
, 
ıu
->
	`Çme
(), cpu->
š¡couÁ
);

155 #ifdeà
DEBUG


156 
ıu
->
¢Li¡
.
	`”a£
(
£qNum
);

159 ià(
»qToV”ify
)

160 
d–‘e
 
»qToV”ify
;

161 
	}
}

163 #ifdeà
DEBUG


164 
	g‹m¶©e
 <
şass
 
	gIm¶
>

166 
	gBa£DynIn¡
<
	gIm¶
>::
	$dumpSNLi¡
()

168 
¡d
::
£t
<
In¡SeqNum
>::
™”©Ü
 
¢_™
 = 
ıu
->
¢Li¡
.
	`begš
();

170 
couÁ
 = 0;

171 
¢_™
 !ğ
ıu
->
¢Li¡
.
	`’d
()) {

172 
	`ırštf
("%i: [¢:%Îi]‚Ù de¡royed\n", 
couÁ
, (*
¢_™
));

173 
couÁ
++;

174 
¢_™
++;

176 
	}
}

179 
	g‹m¶©e
 <
şass
 
	gIm¶
>

181 
	gBa£DynIn¡
<
	gIm¶
>::
	$dump
()

183 
	`ırštf
("T%d : %#08d `", 
th»adNumb”
, 
pc
.
	`š¡Addr
());

184 
¡d
::
cout
 << 
¡©icIn¡
->
	`di§s£mbË
(
pc
.
	`š¡Addr
());

185 
	`ırštf
("'\n");

186 
	}
}

188 
	g‹m¶©e
 <
şass
 
	gIm¶
>

190 
	gBa£DynIn¡
<
	gIm¶
>::
dump
(
¡d
::
¡ršg
 &
out¡ršg
)

192 
¡d
::
o¡ršg¡»am
 
s
;

193 
	gs
 << "T" << 
	gth»adNumb”
 << " : 0x" << 
	gpc
.
š¡Addr
() << " "

194 << 
	g¡©icIn¡
->
di§s£mbË
(
pc
.
š¡Addr
());

196 
	gout¡ršg
 = 
s
.
¡r
();

199 
	g‹m¶©e
 <
şass
 
	gIm¶
>

201 
	gBa£DynIn¡
<
	gIm¶
>::
	$m¬kSrcRegR—dy
()

203 
	`DPRINTF
(
IQ
, "[sn:%lli] has %d„eady out of %d sources. RTI %d)\n",

204 
£qNum
, 
»adyRegs
+1, 
	`numSrcRegs
(), 
	`»adyToIssue
());

205 ià(++
»adyRegs
 =ğ
	`numSrcRegs
()) {

206 
	`£tCªIssue
();

208 
	}
}

210 
	g‹m¶©e
 <
şass
 
	gIm¶
>

212 
	gBa£DynIn¡
<
	gIm¶
>::
	$m¬kSrcRegR—dy
(
RegIndex
 
¤c_idx
)

214 
_»adySrcRegIdx
[
¤c_idx
] = 
Œue
;

216 
	`m¬kSrcRegR—dy
();

217 
	}
}

219 
	g‹m¶©e
 <
şass
 
	gIm¶
>

220 
boŞ


221 
	gBa£DynIn¡
<
	gIm¶
>::
	$—SrcsR—dy
()

227 
i
 = 1; i < 
	`numSrcRegs
(); ++i) {

228 ià(!
_»adySrcRegIdx
[
i
])

229  
çl£
;

232  
Œue
;

233 
	}
}

	@checker/cpu.cc

44 
	~<li¡
>

45 
	~<¡ršg
>

47 
	~"¬ch/k”Ãl_¡©s.hh
"

48 
	~"¬ch/vtİhys.hh
"

49 
	~"ıu/check”/ıu.hh
"

50 
	~"ıu/ba£.hh
"

51 
	~"ıu/sim¶e_th»ad.hh
"

52 
	~"ıu/¡©ic_š¡.hh
"

53 
	~"ıu/th»ad_cÚ‹xt.hh
"

54 
	~"·¿ms/Check”CPU.hh
"

55 
	~"sim/fuÎ_sy¡em.hh
"

56 
	~"sim/b.hh
"

58 
usšg
 
Çme¥aû
 
	g¡d
;

59 
usšg
 
Çme¥aû
 
	gTheISA
;

62 
	gCheck”CPU
::
	$š™
()

64 
ma¡”Id
 = 
sy¡emPŒ
->
	`g‘Ma¡”Id
(
	`Çme
());

65 
	}
}

67 
	gCheck”CPU
::
	$Check”CPU
(
P¬ams
 *
p
)

68 : 
	`Ba£CPU
(
p
, 
Œue
), 
	`sy¡emPŒ
(
NULL
), 
	`iÿchePÜt
(NULL), 
	`dÿchePÜt
(NULL),

69 
	`tc
(
NULL
), 
	$th»ad
(
NULL
)

71 
memReq
 = 
NULL
;

72 
curSticIn¡
 = 
NULL
;

73 
curMaüoSticIn¡
 = 
NULL
;

75 
numIn¡
 = 0;

76 
¡¬tNumIn¡
 = 0;

77 
numLßd
 = 0;

78 
¡¬tNumLßd
 = 0;

79 
younge¡SN
 = 0;

81 
chªgedPC
 = 
wlChªgePC
 = 
chªgedNextPC
 = 
çl£
;

83 
ex™OnE¼Ü
 = 
p
->exitOnError;

84 
w¬nOÆyOnLßdE¼Ü
 = 
p
->warnOnlyOnLoadError;

85 
™b
 = 
p
->itb;

86 
dtb
 = 
p
->dtb;

87 
wÜklßd
 = 
p
->workload;

89 
upd©eOnE¼Ü
 = 
Œue
;

90 
	}
}

92 
	gCheck”CPU
::~
	$Check”CPU
()

94 
	}
}

97 
Check”CPU
::
	$£tSy¡em
(
Sy¡em
 *
sy¡em
)

99 cÚ¡ 
P¬ams
 *
	`p
(
dyÇmic_ÿ¡
<cÚ¡ P¬am *>(
_·¿ms
));

101 
sy¡emPŒ
 = 
sy¡em
;

103 ià(
FuÎSy¡em
) {

104 
th»ad
 = 
Ãw
 
	`Sim¶eTh»ad
(
this
, 0, 
sy¡emPŒ
, 
™b
, 
dtb
,

105 
p
->
i§
[0], 
çl£
);

107 
th»ad
 = 
Ãw
 
	`Sim¶eTh»ad
(
this
, 0, 
sy¡emPŒ
,

108 
wÜklßd
.
	`size
(è? wÜklßd[0] : 
NULL
,

109 
™b
, 
dtb
, 
p
->
i§
[0]);

112 
tc
 = 
th»ad
->
	`g‘TC
();

113 
th»adCÚ‹xts
.
	`push_back
(
tc
);

114 
th»ad
->
k”ÃlSts
 = 
NULL
;

116 
	`as£¹
(
th»ad
 !ğ
NULL
);

117 
	}
}

120 
	gCheck”CPU
::
	$£tIÿchePÜt
(
Ma¡”PÜt
 *
iÿche_pÜt
)

122 
iÿchePÜt
 = 
iÿche_pÜt
;

123 
	}
}

126 
	gCheck”CPU
::
	$£tDÿchePÜt
(
Ma¡”PÜt
 *
dÿche_pÜt
)

128 
dÿchePÜt
 = 
dÿche_pÜt
;

129 
	}
}

132 
	gCheck”CPU
::
	$£rŸlize
(
o¡»am
 &
os
)

134 
	}
}

137 
Check”CPU
::
	$un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡ršg
 &
£ùiÚ
)

139 
	}
}

141 
FauÉ


142 
	gCheck”CPU
::
	$»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
)

144 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

145 
fuÎSize
 = 
size
;

146 
Addr
 
£cÚdAddr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
	`ÿcheLšeSize
());

147 
boŞ
 
checked_æags
 = 
çl£
;

148 
boŞ
 
æags_m©ch
 = 
Œue
;

149 
Addr
 
pAddr
 = 0x0;

152 ià(
£cÚdAddr
 > 
addr
)

153 
size
 = 
£cÚdAddr
 - 
addr
;

157 
memReq
 = 
Ãw
 
	`Reque¡
();

158 
memReq
->
	`£tVœt
(0, 
addr
, 
size
, 
æags
, 
ma¡”Id
, 
th»ad
->
	`pcS‹
().
	`š¡Addr
());

161 
çuÉ
 = 
dtb
->
	`Œª¦©eFunùiÚ®
(
memReq
, 
tc
, 
Ba£TLB
::
R—d
);

163 ià(!
checked_æags
 && 
çuÉ
 =ğ
NoFauÉ
 && 
unv”if›dReq
) {

164 
æags_m©ch
 = 
	`checkFÏgs
(
unv”if›dReq
, 
memReq
->
	`g‘Vaddr
(),

165 
memReq
->
	`g‘Paddr
(), memReq->
	`g‘FÏgs
());

166 
pAddr
 = 
memReq
->
	`g‘Paddr
();

167 
checked_æags
 = 
Œue
;

171 ià(
çuÉ
 =ğ
NoFauÉ
 &&

172 !
memReq
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

173 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
memReq
,

174 
memReq
->
	`isLLSC
() ?

175 
MemCmd
::
LßdLockedReq
 :

176 
MemCmd
::
R—dReq
);

178 
pkt
->
	`d©aStic
(
d©a
);

180 ià(!(
memReq
->
	`isUnÿch—bË
(è|| memReq->
	`isMm­³dI´
())) {

182 
dÿchePÜt
->
	`£ndFunùiÚ®
(
pkt
);

185 
	`memıy
(
d©a
, 
unv”if›dMemD©a
, 
size
);

188 
d–‘e
 
memReq
;

189 
memReq
 = 
NULL
;

190 
d–‘e
 
pkt
;

193 ià(
çuÉ
 !ğ
NoFauÉ
) {

194 ià(
memReq
->
	`isP»ãtch
()) {

195 
çuÉ
 = 
NoFauÉ
;

197 
d–‘e
 
memReq
;

198 
memReq
 = 
NULL
;

202 ià(
memReq
 !ğ
NULL
) {

203 
d–‘e
 
memReq
;

207 ià(
£cÚdAddr
 <ğ
addr
)

213 
d©a
 +ğ
size
;

214 
unv”if›dMemD©a
 +ğ
size
;

215 
size
 = 
addr
 + 
fuÎSize
 - 
£cÚdAddr
;

216 
addr
 = 
£cÚdAddr
;

219 ià(!
æags_m©ch
) {

220 
	`w¬n
("%lli: Flags do‚ot match CPU:%#x %#x %#x Checker:%#x %#x %#x\n",

221 
	`curTick
(), 
unv”if›dReq
->
	`g‘Vaddr
(), unv”if›dReq->
	`g‘Paddr
(),

222 
unv”if›dReq
->
	`g‘FÏgs
(), 
addr
, 
pAddr
, 
æags
);

223 
	`hªdËE¼Ü
();

226  
çuÉ
;

227 
	}
}

229 
FauÉ


230 
	gCheck”CPU
::
	$wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

231 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
)

233 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

234 
boŞ
 
checked_æags
 = 
çl£
;

235 
boŞ
 
æags_m©ch
 = 
Œue
;

236 
Addr
 
pAddr
 = 0x0;

238 
fuÎSize
 = 
size
;

240 
Addr
 
£cÚdAddr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
	`ÿcheLšeSize
());

242 ià(
£cÚdAddr
 > 
addr
)

243 
size
 = 
£cÚdAddr
 - 
addr
;

247 
memReq
 = 
Ãw
 
	`Reque¡
();

248 
memReq
->
	`£tVœt
(0, 
addr
, 
size
, 
æags
, 
ma¡”Id
, 
th»ad
->
	`pcS‹
().
	`š¡Addr
());

251 
çuÉ
 = 
dtb
->
	`Œª¦©eFunùiÚ®
(
memReq
, 
tc
, 
Ba£TLB
::
Wr™e
);

253 ià(!
checked_æags
 && 
çuÉ
 =ğ
NoFauÉ
 && 
unv”if›dReq
) {

254 
æags_m©ch
 = 
	`checkFÏgs
(
unv”if›dReq
, 
memReq
->
	`g‘Vaddr
(),

255 
memReq
->
	`g‘Paddr
(), memReq->
	`g‘FÏgs
());

256 
pAddr
 = 
memReq
->
	`g‘Paddr
();

257 
checked_æags
 = 
Œue
;

267 
boŞ
 
was_´eãtch
 = 
memReq
->
	`isP»ãtch
();

269 
d–‘e
 
memReq
;

272 ià(
çuÉ
 !ğ
NoFauÉ
 || 
£cÚdAddr
 <ğ
addr
)

274 ià(
çuÉ
 !ğ
NoFauÉ
 && 
was_´eãtch
) {

275 
çuÉ
 = 
NoFauÉ
;

281 
size
 = 
addr
 + 
fuÎSize
 - 
£cÚdAddr
;

283 
addr
 = 
£cÚdAddr
;

286 ià(!
æags_m©ch
) {

287 
	`w¬n
("%lli: Flags do‚ot match CPU:%#x %#x Checker:%#x %#x %#x\n",

288 
	`curTick
(), 
unv”if›dReq
->
	`g‘Vaddr
(), unv”if›dReq->
	`g‘Paddr
(),

289 
unv”if›dReq
->
	`g‘FÏgs
(), 
addr
, 
pAddr
, 
æags
);

290 
	`hªdËE¼Ü
();

296 ià(
unv”if›dReq
 && 
»s
 && unv”if›dReq->
	`exŒaD©aV®id
())

297 *
»s
 = 
unv”if›dReq
->
	`g‘ExŒaD©a
();

304 
boŞ
 
exŒaD©a
;

305 ià(
unv”if›dReq
) {

306 
exŒaD©a
 = 
unv”if›dReq
->
	`exŒaD©aV®id
() ?

307 
unv”if›dReq
->
	`g‘ExŒaD©a
() : 1;

310 ià(
unv”if›dReq
 && 
unv”if›dMemD©a
 &&

311 
	`memcmp
(
d©a
, 
unv”if›dMemD©a
, 
fuÎSize
è&& 
exŒaD©a
) {

312 
	`w¬n
("%Îi: StÜv®udÛ nÙ m©ch v®u£ÁØmemÜy!\
: %#x in¡_d©a: %#x", 
	`curTick
(), 
d©a
,

314 
unv”if›dMemD©a
);

315 
	`hªdËE¼Ü
();

318  
çuÉ
;

319 
	}
}

321 
Addr


322 
	gCheck”CPU
::
	$dbg_vtİhys
(
Addr
 
addr
)

324  
	`vtİhys
(
tc
, 
addr
);

325 
	}
}

330 
boŞ


331 
	gCheck”CPU
::
	$checkFÏgs
(
Reque¡
 *
unv”if›d_»q
, 
Addr
 
vAddr
,

332 
Addr
 
pAddr
, 
æags
)

334 
Addr
 
unv”if›dVAddr
 = 
unv”if›d_»q
->
	`g‘Vaddr
();

335 
Addr
 
unv”if›dPAddr
 = 
unv”if›d_»q
->
	`g‘Paddr
();

336 
unv”if›dFÏgs
 = 
unv”if›d_»q
->
	`g‘FÏgs
();

338 ià(
unv”if›dVAddr
 !ğ
vAddr
 ||

339 
unv”if›dPAddr
 !ğ
pAddr
 ||

340 
unv”if›dFÏgs
 !ğ
æags
) {

341  
çl£
;

344  
Œue
;

345 
	}
}

348 
	gCheck”CPU
::
	$dumpAndEx™
()

350 
	`w¬n
("%lli: Checker PC:%s",

351 
	`curTick
(), 
th»ad
->
	`pcS‹
());

352 
	`·nic
("Checker found‡nƒrror!");

353 
	}
}

	@checker/cpu.hh

44 #iâdeà
__CPU_CHECKER_CPU_HH__


45 
	#__CPU_CHECKER_CPU_HH__


	)

47 
	~<li¡
>

48 
	~<m­
>

49 
	~<queue
>

51 
	~"¬ch/ty³s.hh
"

52 
	~"ba£/¡©i¡ics.hh
"

53 
	~"ıu/ba£.hh
"

54 
	~"ıu/ba£_dyn_š¡.hh
"

55 
	~"ıu/pc_ev’t.hh
"

56 
	~"ıu/sim¶e_th»ad.hh
"

57 
	~"ıu/¡©ic_š¡.hh
"

58 
	~"debug/Check”.hh
"

59 
	~"·¿ms/Check”CPU.hh
"

60 
	~"sim/ev’tq.hh
"

63 
Çme¥aû
 
	gTheISA


65 
şass
 
	gTLB
;

68 
	g‹m¶©e
 <
	gşass
>

69 
şass
 
	gBa£DynIn¡
;

70 
şass
 
	gTh»adCÚ‹xt
;

71 
şass
 
	gReque¡
;

89 şas 
	cCheck”CPU
 : 
public
 
Ba£CPU


91 
´Ùeùed
:

92 
TheISA
::
	tMachIn¡
 MachInst;

93 
	mTheISA
::
	tFlßtReg
 FloatReg;

94 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

95 
	mTheISA
::
	tMiscReg
 MiscReg;

98 
Ma¡”ID
 
	mma¡”Id
;

99 
	mpublic
:

100 
vœtu®
 
š™
();

102 
Check”CPUP¬ams
 
	tP¬ams
;

103 
Check”CPU
(
P¬ams
 *
p
);

104 
	mvœtu®
 ~
Check”CPU
();

106 
£tSy¡em
(
Sy¡em
 *
sy¡em
);

108 
£tIÿchePÜt
(
Ma¡”PÜt
 *
iÿche_pÜt
);

110 
£tDÿchePÜt
(
Ma¡”PÜt
 *
dÿche_pÜt
);

112 
	mMa¡”PÜt
 &
	$g‘D©aPÜt
()

116 
	`as£¹
(
dÿchePÜt
);

117  *
dÿchePÜt
;

120 
Ma¡”PÜt
 &
	$g‘In¡PÜt
()

124 
	`as£¹
(
iÿchePÜt
);

125  *
iÿchePÜt
;

126 
	}
}

128 
	g´Ùeùed
:

130 
¡d
::
veùÜ
<
Proûss
*> 
wÜklßd
;

132 
Sy¡em
 *
	gsy¡emPŒ
;

134 
Ma¡”PÜt
 *
	giÿchePÜt
;

135 
Ma¡”PÜt
 *
	gdÿchePÜt
;

137 
Th»adCÚ‹xt
 *
	gtc
;

139 
	gTheISA
::
TLB
 *
™b
;

140 
	gTheISA
::
TLB
 *
dtb
;

142 
Addr
 
dbg_vtİhys
(Add¸
addr
);

144 
	uResuÉ
 {

145 
ušt64_t
 
	gš‹g”
;

146 
	gdbl
;

147 
£t
(
ušt64_t
 
i
è{ 
	gš‹g”
 = i; }

148 
£t
(
d
è{ 
	gdbl
 = d; }

149 
g‘
(
ušt64_t
& 
i
è{ 
	gi
 = 
š‹g”
; }

150 
g‘
(& 
d
è{ 
	gd
 = 
dbl
; }

155 
	g¡d
::
queue
<
ResuÉ
> 
»suÉ
;

158 
Reque¡PŒ
 
	gmemReq
;

160 
SticIn¡PŒ
 
	gcurSticIn¡
;

161 
SticIn¡PŒ
 
	gcurMaüoSticIn¡
;

164 
CouÁ”
 
	gnumIn¡
;

165 
CouÁ”
 
	g¡¬tNumIn¡
;

167 
	g¡d
::
queue
<> 
miscRegIdxs
;

169 
	gpublic
:

172 
Sim¶eTh»ad
 *
th»ad
;

174 
	gTheISA
::
TLB
* 
	$g‘ITBPŒ
(è{  
™b
; 
	}
}

175 
	gTheISA
::
TLB
* 
	$g‘DTBPŒ
(è{  
dtb
; 
	}
}

177 
vœtu®
 
CouÁ”
 
	$tÙ®In¡s
() const

180 
	}
}

182 
vœtu®
 
CouÁ”
 
	$tÙ®Ops
() const

185 
	}
}

188 
CouÁ”
 
	gnumLßd
;

189 
CouÁ”
 
	g¡¬tNumLßd
;

191 
vœtu®
 
£rŸlize
(
¡d
::
o¡»am
 &
os
);

192 
vœtu®
 
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
);

196 
	$£tEA
(
Addr
 
EA
è{ 
	`·nic
("Sim¶eCPU::£tEA(ènÙ im¶em’‹d\n"); 
	}
}

197 
Addr
 
	$g‘EA
(è{ 
	`·nic
("Sim¶eCPU::g‘EA(ènÙ im¶em’‹d\n"); 
	}
}

210 
ušt64_t
 
	$»adIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

212  
th»ad
->
	`»adIÁReg
(
si
->
	`¤cRegIdx
(
idx
));

213 
	}
}

215 
FlßtReg
 
	$»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

217 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

218  
th»ad
->
	`»adFlßtReg
(
»g_idx
);

219 
	}
}

221 
FlßtRegB™s
 
	$»adFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

223 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

224  
th»ad
->
	`»adFlßtRegB™s
(
»g_idx
);

225 
	}
}

227 
ušt64_t
 
	$»adCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

229 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
CC_Reg_Ba£
;

230  
th»ad
->
	`»adCCReg
(
»g_idx
);

231 
	}
}

233 
	g‹m¶©e
 <
şass
 
	gT
>

234 
	$£tResuÉ
(
T
 
t
)

236 
ResuÉ
 
š¡Res
;

237 
š¡Res
.
	`£t
(
t
);

238 
»suÉ
.
	`push
(
š¡Res
);

239 
	}
}

241 
	$£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

243 
th»ad
->
	`£tIÁReg
(
si
->
	`de¡RegIdx
(
idx
), 
v®
);

244 
£tResuÉ
<
ušt64_t
>(
v®
);

245 
	}
}

247 
	$£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
)

249 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

250 
th»ad
->
	`£tFlßtReg
(
»g_idx
, 
v®
);

251 
£tResuÉ
<>(
v®
);

252 
	}
}

254 
	$£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

255 
FlßtRegB™s
 
v®
)

257 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

258 
th»ad
->
	`£tFlßtRegB™s
(
»g_idx
, 
v®
);

259 
£tResuÉ
<
ušt64_t
>(
v®
);

260 
	}
}

262 
	$£tCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

264 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
CC_Reg_Ba£
;

265 
th»ad
->
	`£tCCReg
(
»g_idx
, 
v®
);

266 
£tResuÉ
<
ušt64_t
>(
v®
);

267 
	}
}

269 
boŞ
 
	$»adP»diÿ‹
(è{  
th»ad
->
	`»adP»diÿ‹
(); 
	}
}

270 
	$£tP»diÿ‹
(
boŞ
 
v®
)

272 
th»ad
->
	`£tP»diÿ‹
(
v®
);

273 
	}
}

275 
	gTheISA
::
PCS‹
 
	$pcS‹
(è{  
th»ad
->
	`pcS‹
(); 
	}
}

276 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

278 
DPRINTF
(
Check”
, "Changing PCo %s, old PC %s.\n",

279 
v®
, 
th»ad
->
pcS‹
());

280 
	gth»ad
->
pcS‹
(
v®
);

282 
Addr
 
	$š¡Addr
(è{  
th»ad
->
	`š¡Addr
(); 
	}
}

283 
Addr
 
	$ÃxtIn¡Addr
(è{  
th»ad
->
	`ÃxtIn¡Addr
(); 
	}
}

284 
MiüoPC
 
	$miüoPC
(è{  
th»ad
->
	`miüoPC
(); 
	}
}

287 
MiscReg
 
	$»adMiscRegNoEfãù
(
misc_»g
)

289  
th»ad
->
	`»adMiscRegNoEfãù
(
misc_»g
);

290 
	}
}

292 
MiscReg
 
	$»adMiscReg
(
misc_»g
)

294  
th»ad
->
	`»adMiscReg
(
misc_»g
);

295 
	}
}

297 
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

299 
miscRegIdxs
.
	`push
(
misc_»g
);

300  
th»ad
->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
);

301 
	}
}

303 
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

305 
miscRegIdxs
.
	`push
(
misc_»g
);

306  
th»ad
->
	`£tMiscReg
(
misc_»g
, 
v®
);

307 
	}
}

309 
MiscReg
 
	$»adMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

311 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
Misc_Reg_Ba£
;

312  
th»ad
->
	`»adMiscReg
(
»g_idx
);

313 
	}
}

315 
	$£tMiscRegO³¿nd
(

316 cÚ¡ 
SticIn¡
 *
si
, 
idx
, cÚ¡ 
MiscReg
 &
v®
)

318 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
Misc_Reg_Ba£
;

319  
th»ad
->
	`£tMiscReg
(
»g_idx
, 
v®
);

320 
	}
}

322 #ià
THE_ISA
 =ğ
MIPS_ISA


323 
ušt64_t
 
	$»adRegOth”Th»ad
(
misc_»g
)

325 
	`·nic
("MIPS MT‚ot defined for CheckerCPU.\n");

327 
	}
}

329 
£tRegOth”Th»ad
(
misc_»g
, cÚ¡ 
TheISA
::
MiscReg
 &
v®
)

331 
·nic
("MIPS MT‚ot defined for CheckerCPU.\n");

337 
»cÜdPCChªge
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

339 
chªgedPC
 = 
Œue
;

340 
	gÃwPCS‹
 = 
v®
;

343 
	$dem­Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

345 
this
->
™b
->
	`dem­Page
(
vaddr
, 
a¢
);

346 
this
->
dtb
->
	`dem­Page
(
vaddr
, 
a¢
);

347 
	}
}

349 
	$dem­In¡Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

351 
this
->
™b
->
	`dem­Page
(
vaddr
, 
a¢
);

352 
	}
}

354 
	$dem­D©aPage
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

356 
this
->
dtb
->
	`dem­Page
(
vaddr
, 
a¢
);

357 
	}
}

359 
FauÉ
 
»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
);

360 
FauÉ
 
wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

361 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

363 
	$£tStCÚdFau»s
(
sc_çu»s
)

364 {
	}
}

367 
FauÉ
 
	$hw»i
(è{  
th»ad
->
	`hw»i
(); 
	}
}

368 
boŞ
 
	$simP®Check
(
·lFunc
è{  
th»ad
->
	`simP®Check
Õ®Func); 
	}
}

369 
	$wakeup
(è{ 
	}
}

372 
	$sysÿÎ
(
ušt64_t
 
ÿÎnum
è{ 
	}
}

374 
	$hªdËE¼Ü
()

376 ià(
ex™OnE¼Ü
)

377 
	`dumpAndEx™
();

378 
	}
}

380 
boŞ
 
checkFÏgs
(
Reque¡
 *
unv”if›d_»q
, 
Addr
 
vAddr
,

381 
Addr
 
pAddr
, 
æags
);

383 
dumpAndEx™
();

385 
Th»adCÚ‹xt
 *
	$tcBa£
(è{  
tc
; 
	}
}

386 
Sim¶eTh»ad
 *
	$th»adBa£
(è{  
th»ad
; 
	}
}

388 
ResuÉ
 
	gunv”if›dResuÉ
;

389 
Reque¡
 *
	gunv”if›dReq
;

390 
ušt8_t
 *
	gunv”if›dMemD©a
;

392 
boŞ
 
	gchªgedPC
;

393 
boŞ
 
	gwlChªgePC
;

394 
	gTheISA
::
PCS‹
 
ÃwPCS‹
;

395 
boŞ
 
	gchªgedNextPC
;

396 
boŞ
 
	gex™OnE¼Ü
;

397 
boŞ
 
	gupd©eOnE¼Ü
;

398 
boŞ
 
	gw¬nOÆyOnLßdE¼Ü
;

400 
In¡SeqNum
 
	gyounge¡SN
;

409 
	g‹m¶©e
 <
şass
 
	gIm¶
>

410 şas 
	cCheck”
 : 
public
 
Check”CPU


412 
´iv©e
:

413 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

415 
	mpublic
:

416 
	$Check”
(
P¬ams
 *
p
)

417 : 
	`Check”CPU
(
p
), 
	`upd©eThisCyşe
(
çl£
), 
	$unv”if›dIn¡
(
NULL
)

420 
	`sw™chOut
();

421 
	`keOv”From
(
Ba£CPU
 *
ŞdCPU
);

423 
	`advªûPC
(
FauÉ
 
çuÉ
);

425 
	`v”ify
(
DynIn¡PŒ
 &
š¡
);

427 
	`v®id©eIn¡
(
DynIn¡PŒ
 &
š¡
);

428 
	`v®id©eExecutiÚ
(
DynIn¡PŒ
 &
š¡
);

429 
	`v®id©eS‹
();

431 
	`cİyResuÉ
(
DynIn¡PŒ
 &
š¡
, 
ušt64_t
 
mism©ch_v®
, 
¡¬t_idx
);

432 
	`hªdËP’dšgIÁ
();

434 
´iv©e
:

435 
	$hªdËE¼Ü
(
DynIn¡PŒ
 &
š¡
)

437 ià(
ex™OnE¼Ü
) {

438 
	`dumpAndEx™
(
š¡
);

439 } ià(
upd©eOnE¼Ü
) {

440 
upd©eThisCyşe
 = 
Œue
;

442 
	}
}

444 
dumpAndEx™
(
DynIn¡PŒ
 &
š¡
);

446 
boŞ
 
	gupd©eThisCyşe
;

448 
DynIn¡PŒ
 
	gunv”if›dIn¡
;

450 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
;

451 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tIn¡Li¡It
;

452 
dumpIn¡s
();

	@checker/cpu_impl.hh

45 #iâdeà
__CPU_CHECKER_CPU_IMPL_HH__


46 
	#__CPU_CHECKER_CPU_IMPL_HH__


	)

48 
	~<li¡
>

49 
	~<¡ršg
>

51 
	~"¬ch/i§_Œa™s.hh
"

52 
	~"¬ch/vtİhys.hh
"

53 
	~"ba£/»fút.hh
"

54 
	~"cÚfig/the_i§.hh
"

55 
	~"ıu/ba£_dyn_š¡.hh
"

56 
	~"ıu/ex‘¿û.hh
"

57 
	~"ıu/»g_şass.hh
"

58 
	~"ıu/sim¶e_th»ad.hh
"

59 
	~"ıu/¡©ic_š¡.hh
"

60 
	~"ıu/th»ad_cÚ‹xt.hh
"

61 
	~"ıu/check”/ıu.hh
"

62 
	~"debug/Check”.hh
"

63 
	~"sim/fuÎ_sy¡em.hh
"

64 
	~"sim/sim_objeù.hh
"

65 
	~"sim/¡©s.hh
"

67 
usšg
 
Çme¥aû
 
	g¡d
;

68 
usšg
 
Çme¥aû
 
	gTheISA
;

70 
	g‹m¶©e
 <
şass
 
	gIm¶
>

72 
	gCheck”
<
	gIm¶
>::
	$advªûPC
(
FauÉ
 
çuÉ
)

74 ià(
çuÉ
 !ğ
NoFauÉ
) {

75 
curMaüoSticIn¡
 = 
SticIn¡
::
nuÎSticIn¡PŒ
;

76 
çuÉ
->
	`švoke
(
tc
, 
curSticIn¡
);

77 
th»ad
->
decod”
.
	`»£t
();

79 ià(
curSticIn¡
) {

80 ià(
curSticIn¡
->
	`isLa¡Miüoİ
())

81 
curMaüoSticIn¡
 = 
SticIn¡
::
nuÎSticIn¡PŒ
;

82 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

83 
TheISA
::
	`advªûPC
(
pcS‹
, 
curSticIn¡
);

84 
th»ad
->
	`pcS‹
(
pcS‹
);

85 
	`DPRINTF
(
Check”
, "Advªcšg PCØ%s.\n", 
th»ad
->
	`pcS‹
());

88 
	}
}

91 
	g‹m¶©e
 <
şass
 
	gIm¶
>

93 
	gCheck”
<
	gIm¶
>::
	$hªdËP’dšgIÁ
()

95 
	`DPRINTF
(
Check”
, "IRQ detected‡t PC: %s with %d insts in buffer\n",

96 
th»ad
->
	`pcS‹
(), 
š¡Li¡
.
	`size
());

97 
DynIn¡PŒ
 
bound¬yIn¡
 = 
NULL
;

98 ià(!
š¡Li¡
.
	`em±y
()) {

100 
DynIn¡PŒ
 
š¡
;

101 
ty³Çme
 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
™r
;

103 
™r
 = 
š¡Li¡
.
	`begš
(); iŒ !ğš¡Li¡.
	`’d
(); itr++) {

104 (*
™r
)->
	`£tCom¶‘ed
();

107 
š¡
 = 
š¡Li¡
.
	`äÚt
();

108 
bound¬yIn¡
 = 
š¡Li¡
.
	`back
();

109 
	`v”ify
(
š¡
);

110 
š¡
 = 
NULL
;

112 ià((!
bound¬yIn¡
 && 
curMaüoSticIn¡
 &&

113 
curSticIn¡
->
	`isD–ayedComm™
() &&

114 !
curSticIn¡
->
	`isLa¡Miüoİ
()) ||

115 (
bound¬yIn¡
 && bound¬yIn¡->
	`isD–ayedComm™
() &&

116 !
bound¬yIn¡
->
	`isLa¡Miüoİ
())) {

117 
	`·nic
("%lli: Tryingoake‡n interrupt in middle of "

118 "¨nÚ-š‹ru±abË in¡ruùiÚ!", 
	`curTick
());

120 
bound¬yIn¡
 = 
NULL
;

121 
th»ad
->
decod”
.
	`»£t
();

122 
curMaüoSticIn¡
 = 
SticIn¡
::
nuÎSticIn¡PŒ
;

123 
	}
}

125 
	g‹m¶©e
 <
şass
 
	gIm¶
>

127 
	gCheck”
<
	gIm¶
>::
	$v”ify
(
DynIn¡PŒ
 &
com¶‘ed_š¡
)

129 
DynIn¡PŒ
 
š¡
;

134 ià((
com¶‘ed_š¡
->
	`isS”Ÿlizšg
() ||

135 
com¶‘ed_š¡
->
	`isS”ŸlizeBefÜe
()) &&

136 (!
š¡Li¡
.
	`em±y
() ?

137 (
š¡Li¡
.
	`äÚt
()->
£qNum
 !ğ
com¶‘ed_š¡
->seqNum) : 0)) {

138 
	`·nic
("%lli: Instruction sn:%lli‡t PC %s is serializing before but is"

139 "ƒÁ”šg in¡Li¡ w™h oth” in¡ruùiÚs\n", 
	`curTick
(),

140 
com¶‘ed_š¡
->
£qNum
, com¶‘ed_š¡->
	`pcS‹
());

148 ià(!
š¡Li¡
.
	`em±y
()) {

149 ià(
younge¡SN
 < 
com¶‘ed_š¡
->
£qNum
) {

150 
	`DPRINTF
(
Check”
, "Adding instruction [sn:%lli] PC:%so†ist\n",

151 
com¶‘ed_š¡
->
£qNum
, com¶‘ed_š¡->
	`pcS‹
());

152 
š¡Li¡
.
	`push_back
(
com¶‘ed_š¡
);

153 
younge¡SN
 = 
com¶‘ed_š¡
->
£qNum
;

156 ià(!
š¡Li¡
.
	`äÚt
()->
	`isCom¶‘ed
()) {

159 
š¡
 = 
š¡Li¡
.
	`äÚt
();

160 
š¡Li¡
.
	`pİ_äÚt
();

163 ià(!
com¶‘ed_š¡
->
	`isCom¶‘ed
()) {

164 ià(
younge¡SN
 < 
com¶‘ed_š¡
->
£qNum
) {

165 
	`DPRINTF
(
Check”
, "Adding instruction [sn:%lli] PC:%so†ist\n",

166 
com¶‘ed_š¡
->
£qNum
, com¶‘ed_š¡->
	`pcS‹
());

167 
š¡Li¡
.
	`push_back
(
com¶‘ed_š¡
);

168 
younge¡SN
 = 
com¶‘ed_š¡
->
£qNum
;

172 ià(
younge¡SN
 < 
com¶‘ed_š¡
->
£qNum
) {

173 
š¡
 = 
com¶‘ed_š¡
;

174 
younge¡SN
 = 
com¶‘ed_š¡
->
£qNum
;

183 ià(
š¡
->
	`isS”ŸlizeAá”
(è&& !
š¡Li¡
.
	`em±y
()) {

184 
	`·nic
("%lli: Instruction sn:%lli‡t PC %s is serializing‡fter but is"

185 "ƒx™šg in¡Li¡ w™h oth” in¡ruùiÚs\n", 
	`curTick
(),

186 
com¶‘ed_š¡
->
£qNum
, com¶‘ed_š¡->
	`pcS‹
());

188 
unv”if›dIn¡
 = 
š¡
;

189 
š¡
 = 
NULL
;

195 
	`DPRINTF
(
Check”
, "Processing instruction [sn:%lli] PC:%s.\n",

196 
unv”if›dIn¡
->
£qNum
, unv”if›dIn¡->
	`pcS‹
());

197 
unv”if›dReq
 = 
NULL
;

198 
unv”if›dReq
 = 
unv”if›dIn¡
->
»qToV”ify
;

199 
unv”if›dMemD©a
 = 
unv”if›dIn¡
->
memD©a
;

201 !
»suÉ
.
	`em±y
()) {

202 
»suÉ
.
	`pİ
();

204 
numCyşes
++;

206 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

209 
th»ad
->
	`£tIÁReg
(
Z”oReg
, 0);

210 #ià
THE_ISA
 =ğ
ALPHA_ISA


211 
th»ad
->
	`£tFlßtReg
(
Z”oReg
, 0.0);

217 ià(
chªgedPC
) {

218 
	`DPRINTF
(
Check”
, "Changed PC„ecentlyo %s\n",

219 
th»ad
->
	`pcS‹
());

220 ià(
wlChªgePC
) {

221 ià(
ÃwPCS‹
 =ğ
th»ad
->
	`pcS‹
()) {

222 
	`DPRINTF
(
Check”
, "Changed PC matchesƒxpected PC\n");

224 
	`w¬n
("%lli: Changed PC does‚ot matchƒxpected PC, "

226 
	`curTick
(), 
th»ad
->
	`pcS‹
(), 
ÃwPCS‹
);

227 
Check”CPU
::
	`hªdËE¼Ü
();

229 
wlChªgePC
 = 
çl£
;

231 
chªgedPC
 = 
çl£
;

233 ià(
chªgedNextPC
) {

234 
	`DPRINTF
(
Check”
, "Changed NextPC„ecentlyo %#x\n",

235 
th»ad
->
	`ÃxtIn¡Addr
());

236 
chªgedNextPC
 = 
çl£
;

240 
ušt64_t
 
ãtchOff£t
 = 0;

241 
boŞ
 
ãtchDÚe
 = 
çl£
;

243 !
ãtchDÚe
) {

244 
Addr
 
ãtch_PC
 = 
th»ad
->
	`š¡Addr
();

245 
ãtch_PC
 = (ãtch_PC & 
PCMask
è+ 
ãtchOff£t
;

247 
MachIn¡
 
machIn¡
;

250 ià(!
curMaüoSticIn¡
) {

252 
memReq
 = 
Ãw
 
	`Reque¡
(
unv”if›dIn¡
->
th»adNumb”
, 
ãtch_PC
,

253 (
MachIn¡
),

255 
ma¡”Id
,

256 
ãtch_PC
, 
th»ad
->
	`cÚ‹xtId
(),

257 
unv”if›dIn¡
->
th»adNumb”
);

258 
memReq
->
	`£tVœt
(0, 
ãtch_PC
, (
MachIn¡
),

259 
Reque¡
::
INST_FETCH
, 
ma¡”Id
, 
th»ad
->
	`š¡Addr
());

262 
çuÉ
 = 
™b
->
	`Œª¦©eFunùiÚ®
(
memReq
, 
tc
, 
Ba£TLB
::
Execu‹
);

264 ià(
çuÉ
 !ğ
NoFauÉ
) {

265 ià(
unv”if›dIn¡
->
	`g‘FauÉ
(è=ğ
NoFauÉ
) {

271 
	`w¬n
("%lli: Instruction PC %s was‚ot found inhe "

272 "ITB!", 
	`curTick
(), 
th»ad
->
	`pcS‹
());

273 
	`hªdËE¼Ü
(
unv”if›dIn¡
);

276 
	`advªûPC
(
NoFauÉ
);

279 
d–‘e
 
memReq
;

280 
unv”if›dIn¡
 = 
NULL
;

286 
çuÉ
 = 
unv”if›dIn¡
->
	`g‘FauÉ
();

287 
d–‘e
 
memReq
;

291 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
memReq
, 
MemCmd
::
R—dReq
);

293 
pkt
->
	`d©aStic
(&
machIn¡
);

294 
iÿchePÜt
->
	`£ndFunùiÚ®
(
pkt
);

295 
machIn¡
 = 
	`gtoh
(machInst);

297 
d–‘e
 
memReq
;

298 
d–‘e
 
pkt
;

302 ià(
çuÉ
 =ğ
NoFauÉ
) {

303 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

305 ià(
	`isRomMiüoPC
(
pcS‹
.
	`miüoPC
())) {

306 
ãtchDÚe
 = 
Œue
;

307 
curSticIn¡
 =

308 
miüocodeRom
.
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
(), 
NULL
);

309 } ià(!
curMaüoSticIn¡
) {

311 
SticIn¡PŒ
 
š¡PŒ
 = 
NULL
;

315 
Addr
 
ãtchPC
 = (
pcS‹
.
	`š¡Addr
(è& 
PCMask
è+ 
ãtchOff£t
;

316 
th»ad
->
decod”
.
	`mÜeBy‹s
(
pcS‹
, 
ãtchPC
, 
machIn¡
);

321 ià(
th»ad
->
decod”
.
	`š¡R—dy
()) {

322 
ãtchDÚe
 = 
Œue
;

323 
š¡PŒ
 = 
th»ad
->
decod”
.
	`decode
(
pcS‹
);

324 
th»ad
->
	`pcS‹
(
pcS‹
);

326 
ãtchDÚe
 = 
çl£
;

327 
ãtchOff£t
 +ğ(
TheISA
::
MachIn¡
);

332 ià(
š¡PŒ
 && in¡PŒ->
	`isMaüoİ
()) {

333 
curMaüoSticIn¡
 = 
š¡PŒ
;

334 
curSticIn¡
 =

335 
š¡PŒ
->
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
());

337 
curSticIn¡
 = 
š¡PŒ
;

341 
curSticIn¡
 =

342 
curMaüoSticIn¡
->
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
());

343 
ãtchDÚe
 = 
Œue
;

348 
th»ad
->
decod”
.
	`»£t
();

352 
FauÉ
 
unv”if›dFauÉ
;

353 ià(
çuÉ
 =ğ
NoFauÉ
) {

354 
unv”if›dFauÉ
 = 
unv”if›dIn¡
->
	`g‘FauÉ
();

358 
	`v®id©eIn¡
(
unv”if›dIn¡
);

362 
numIn¡
++;

368 ià(
çuÉ
 =ğ
NoFauÉ
) {

370 ià(!
unv”if›dIn¡
->
	`isUnv”ifŸbË
()) {

371 
T¿û
::
In¡RecÜd
 *
ŒaûD©a
 = 
Œaûr
->
	`g‘In¡RecÜd
(
	`curTick
(),

372 
tc
,

373 
curSticIn¡
,

374 
	`pcS‹
(),

375 
curMaüoSticIn¡
);

376 
çuÉ
 = 
curSticIn¡
->
	`execu‹
(
this
, 
ŒaûD©a
);

377 ià(
ŒaûD©a
) {

378 
ŒaûD©a
->
	`dump
();

379 
d–‘e
 
ŒaûD©a
;

383 ià(
çuÉ
 =ğ
NoFauÉ
 && 
unv”if›dFauÉ
 == NoFault) {

384 
th»ad
->
funcExeIn¡
++;

386 
	`v®id©eExecutiÚ
(
unv”if›dIn¡
);

388 ià(
curSticIn¡
->
	`isLßd
()) {

389 ++
numLßd
;

391 } ià(
çuÉ
 !ğ
NoFauÉ
 && 
unv”if›dFauÉ
 == NoFault) {

392 
	`·nic
("%lli: sn: %lli‡t PC: %sook‡ fault in checker "

393 "buˆnÙ iÀdriv” CPU\n", 
	`curTick
(),

394 
unv”if›dIn¡
->
£qNum
, unv”if›dIn¡->
	`pcS‹
());

395 } ià(
çuÉ
 =ğ
NoFauÉ
 && 
unv”if›dFauÉ
 != NoFault) {

396 
	`·nic
("%lli: sn: %lli‡t PC: %sook‡ fault in driver "

397 "CPU buˆnÙ iÀcheck”\n", 
	`curTick
(),

398 
unv”if›dIn¡
->
£qNum
, unv”if›dIn¡->
	`pcS‹
());

403 ià(
çuÉ
 !ğ
NoFauÉ
) {

404 ià(
FuÎSy¡em
) {

405 
çuÉ
->
	`švoke
(
tc
, 
curSticIn¡
);

406 
wlChªgePC
 = 
Œue
;

407 
ÃwPCS‹
 = 
th»ad
->
	`pcS‹
();

408 
	`DPRINTF
(
Check”
, "FauÉ, PC i now %s\n", 
ÃwPCS‹
);

409 
curMaüoSticIn¡
 = 
SticIn¡
::
nuÎSticIn¡PŒ
;

412 
	`advªûPC
(
çuÉ
);

415 ià(
FuÎSy¡em
) {

419 
Addr
 
Şdpc
;

420 
couÁ
 = 0;

422 
Şdpc
 = 
th»ad
->
	`š¡Addr
();

423 
sy¡em
->
pcEv’tQueue
.
	`£rviû
(
tc
);

424 
couÁ
++;

425 } 
Şdpc
 !ğ
th»ad
->
	`š¡Addr
());

426 ià(
couÁ
 > 1) {

427 
wlChªgePC
 = 
Œue
;

428 
ÃwPCS‹
 = 
th»ad
->
	`pcS‹
();

429 
	`DPRINTF
(
Check”
, "PC Ev’t, PC i now %s\n", 
ÃwPCS‹
);

435 
	`v®id©eS‹
();

439 ià(
š¡Li¡
.
	`em±y
()) {

441 } ià(
š¡Li¡
.
	`äÚt
()->
	`isCom¶‘ed
()) {

442 
unv”if›dIn¡
 = 
NULL
;

443 
unv”if›dIn¡
 = 
š¡Li¡
.
	`äÚt
();

444 
š¡Li¡
.
	`pİ_äÚt
();

449 
unv”if›dIn¡
 = 
NULL
;

450 
	}
}

452 
	g‹m¶©e
 <
şass
 
	gIm¶
>

454 
	gCheck”
<
	gIm¶
>::
	$sw™chOut
()

456 
š¡Li¡
.
	`ş—r
();

457 
	}
}

459 
	g‹m¶©e
 <
şass
 
	gIm¶
>

461 
	gCheck”
<
	gIm¶
>::
	$keOv”From
(
Ba£CPU
 *
ŞdCPU
)

463 
	}
}

465 
‹m¶©e
 <
şass
 
Im¶
>

467 
Check”
<
Im¶
>::
	$v®id©eIn¡
(
DynIn¡PŒ
 &
š¡
)

469 ià(
š¡
->
	`š¡Addr
(è!ğ
th»ad
->instAddr()) {

470 
	`w¬n
("%lli: PCs do‚ot match! Inst: %s, checker: %s",

471 
	`curTick
(), 
š¡
->
	`pcS‹
(), 
th»ad
->pcState());

472 ià(
chªgedPC
) {

473 
	`w¬n
("%lli: Changed PCs„ecently, may‚ot be‡nƒrror",

474 
	`curTick
());

476 
	`hªdËE¼Ü
(
š¡
);

480 ià(
curSticIn¡
 !ğ
š¡
->
¡©icIn¡
) {

481 
	`w¬n
("%Îi: SticIn¡PŒ dÚ'ˆm©ch. (%s, %s).\n", 
	`curTick
(),

482 
curSticIn¡
->
	`g‘Name
(), 
š¡
->
¡©icIn¡
->getName());

484 
	}
}

486 
	g‹m¶©e
 <
şass
 
	gIm¶
>

488 
	gCheck”
<
	gIm¶
>::
	$v®id©eExecutiÚ
(
DynIn¡PŒ
 &
š¡
)

490 
ušt64_t
 
check”_v®
;

491 
ušt64_t
 
š¡_v®
;

492 
idx
 = -1;

493 
boŞ
 
»suÉ_mism©ch
 = 
çl£
;

495 ià(
š¡
->
	`isUnv”ifŸbË
()) {

499 
	`cİyResuÉ
(
š¡
, 0, 
idx
);

500 } ià(
š¡
->
	`numDe¡Regs
(è> 0 && !
»suÉ
.
	`em±y
()) {

501 
	`DPRINTF
(
Check”
, "Dest„egs %d,‚umber of checker dest„egs %d\n",

502 
š¡
->
	`numDe¡Regs
(), 
»suÉ
.
	`size
());

503 
i
 = 0; i < 
š¡
->
	`numDe¡Regs
(è&& !
»suÉ
.
	`em±y
(); i++) {

504 
»suÉ
.
	`äÚt
().
	`g‘
(
check”_v®
);

505 
»suÉ
.
	`pİ
();

506 
š¡_v®
 = 0;

507 
š¡
->
‹m¶©e
 
pİResuÉ
<
ušt64_t
>(
š¡_v®
);

508 ià(
check”_v®
 !ğ
š¡_v®
) {

509 
»suÉ_mism©ch
 = 
Œue
;

510 
idx
 = 
i
;

520 ià(
»suÉ_mism©ch
) {

521 
	`w¬n
("%lli: Instruction„esults do‚ot match! (Values may‚ot "

523 
	`curTick
(), 
š¡_v®
, 
check”_v®
);

532 ià(
š¡
->
	`isLßd
(è&& 
w¬nOÆyOnLßdE¼Ü
) {

533 
	`cİyResuÉ
(
š¡
, 
š¡_v®
, 
idx
);

535 
	`hªdËE¼Ü
(
š¡
);

539 ià(
š¡
->
	`ÃxtIn¡Addr
(è!ğ
th»ad
->nextInstAddr()) {

540 
	`w¬n
("%lli: Instruction‚ext PCs do‚ot match! Inst: %#x, "

542 
	`curTick
(), 
š¡
->
	`ÃxtIn¡Addr
(), 
th»ad
->nextInstAddr());

543 
	`hªdËE¼Ü
(
š¡
);

551 !
miscRegIdxs
.
	`em±y
()) {

552 
misc_»g_idx
 = 
miscRegIdxs
.
	`äÚt
();

553 
miscRegIdxs
.
	`pİ
();

555 ià(
š¡
->
	`tcBa£
()->
	`»adMiscRegNoEfãù
(
misc_»g_idx
) !=

556 
th»ad
->
	`»adMiscRegNoEfãù
(
misc_»g_idx
)) {

557 
	`w¬n
("%lli: Misc„eg idx %i (sideƒffect) does‚ot match! "

559 
	`curTick
(), 
misc_»g_idx
,

560 
š¡
->
	`tcBa£
()->
	`»adMiscRegNoEfãù
(
misc_»g_idx
),

561 
th»ad
->
	`»adMiscRegNoEfãù
(
misc_»g_idx
));

562 
	`hªdËE¼Ü
(
š¡
);

565 
	}
}

571 
	g‹m¶©e
 <
şass
 
	gIm¶
>

573 
	gCheck”
<
	gIm¶
>::
	$v®id©eS‹
()

575 ià(
upd©eThisCyşe
) {

577 
	`·nic
("%lli: Instruction PC %#x„esults didn't match up, copying‡ll "

578 "»gi¡” äom maš CPU", 
	`curTick
(), 
unv”if›dIn¡
->
	`š¡Addr
());

581 
boŞ
 
no_squash_äom_TC
 = 
unv”if›dIn¡
->
th»ad
->
noSquashFromTC
;

582 
unv”if›dIn¡
->
th»ad
->
noSquashFromTC
 = 
Œue
;

585 
th»ad
->
	`cİyArchRegs
(
unv”if›dIn¡
->
	`tcBa£
());

586 
unv”if›dIn¡
->
th»ad
->
noSquashFromTC
 = 
no_squash_äom_TC
;

589 
curSticIn¡
 = 
unv”if›dIn¡
->
¡©icIn¡
;

591 
	`advªûPC
(
NoFauÉ
);

592 
upd©eThisCyşe
 = 
çl£
;

594 
	}
}

596 
	g‹m¶©e
 <
şass
 
	gIm¶
>

598 
	gCheck”
<
	gIm¶
>::
	$cİyResuÉ
(
DynIn¡PŒ
 &
š¡
, 
ušt64_t
 
mism©ch_v®
,

599 
¡¬t_idx
)

603 ià(
¡¬t_idx
 >= 0) {

604 
RegIndex
 
idx
 = 
š¡
->
	`de¡RegIdx
(
¡¬t_idx
);

605 
	`»gIdxToCÏss
(
idx
)) {

606 
IÁRegCÏss
:

607 
th»ad
->
	`£tIÁReg
(
idx
, 
mism©ch_v®
);

609 
FlßtRegCÏss
:

610 
th»ad
->
	`£tFlßtRegB™s
(
idx
 - 
TheISA
::
FP_Reg_Ba£
, 
mism©ch_v®
);

612 
CCRegCÏss
:

613 
th»ad
->
	`£tCCReg
(
idx
 - 
TheISA
::
CC_Reg_Ba£
, 
mism©ch_v®
);

615 
MiscRegCÏss
:

616 
th»ad
->
	`£tMiscReg
(
idx
 - 
TheISA
::
Misc_Reg_Ba£
,

617 
mism©ch_v®
);

621 
¡¬t_idx
++;

622 
ušt64_t
 
»s
 = 0;

623 
i
 = 
¡¬t_idx
; i < 
š¡
->
	`numDe¡Regs
(); i++) {

624 
RegIndex
 
idx
 = 
š¡
->
	`de¡RegIdx
(
i
);

625 
š¡
->
‹m¶©e
 
pİResuÉ
<
ušt64_t
>(
»s
);

626 
	`»gIdxToCÏss
(
idx
)) {

627 
IÁRegCÏss
:

628 
th»ad
->
	`£tIÁReg
(
idx
, 
»s
);

630 
FlßtRegCÏss
:

631 
th»ad
->
	`£tFlßtRegB™s
(
idx
 - 
TheISA
::
FP_Reg_Ba£
, 
»s
);

633 
CCRegCÏss
:

634 
th»ad
->
	`£tCCReg
(
idx
 - 
TheISA
::
CC_Reg_Ba£
, 
»s
);

636 
MiscRegCÏss
:

638 
th»ad
->
	`£tMiscReg
(
idx
 - 
TheISA
::
Misc_Reg_Ba£
, 
»s
);

643 
	}
}

645 
	g‹m¶©e
 <
şass
 
	gIm¶
>

647 
	gCheck”
<
	gIm¶
>::
	$dumpAndEx™
(
DynIn¡PŒ
 &
š¡
)

649 
	`ırštf
("Error detected, instruction information:\n");

650 
	`ırštf
("PC:%s,‚extPC:%#x\n[sn:%lli]\n[tid:%i]\n"

652 
š¡
->
	`pcS‹
(),

653 
š¡
->
	`ÃxtIn¡Addr
(),

654 
š¡
->
£qNum
,

655 
š¡
->
th»adNumb”
,

656 
š¡
->
	`isCom¶‘ed
());

657 
š¡
->
	`dump
();

658 
Check”CPU
::
	`dumpAndEx™
();

659 
	}
}

661 
	g‹m¶©e
 <
şass
 
	gIm¶
>

663 
	gCheck”
<
	gIm¶
>::
	$dumpIn¡s
()

665 
num
 = 0;

667 
In¡Li¡It
 
š¡_li¡_™
 = --(
š¡Li¡
.
	`’d
());

669 
	`ırštf
("In¡†i¡ size: %i\n", 
š¡Li¡
.
	`size
());

671 
š¡_li¡_™
 !ğ
š¡Li¡
.
	`’d
())

673 
	`ırštf
("Instruction:%i\n",

674 
num
);

676 
	`ırštf
("PC:%s\n[sn:%lli]\n[tid:%i]\n"

678 (*
š¡_li¡_™
)->
	`pcS‹
(),

679 (*
š¡_li¡_™
)->
£qNum
,

680 (*
š¡_li¡_™
)->
th»adNumb”
,

681 (*
š¡_li¡_™
)->
	`isCom¶‘ed
());

683 
	`ırštf
("\n");

685 
š¡_li¡_™
--;

686 ++
num
;

689 
	}
}

	@checker/thread_context.hh

44 #iâdeà
__CPU_CHECKER_THREAD_CONTEXT_HH__


45 
	#__CPU_CHECKER_THREAD_CONTEXT_HH__


	)

47 
	~"¬ch/ty³s.hh
"

48 
	~"cÚfig/the_i§.hh
"

49 
	~"ıu/check”/ıu.hh
"

50 
	~"ıu/sim¶e_th»ad.hh
"

51 
	~"ıu/th»ad_cÚ‹xt.hh
"

52 
	~"debug/Check”.hh
"

54 
şass
 
	gEndQu›sûEv’t
;

55 
Çme¥aû
 
	gTheISA
 {

56 
Çme¥aû
 
	gK”Ãl
 {

57 
şass
 
	gSti¡ics
;

59 
şass
 
	gDecod”
;

70 
	g‹m¶©e
 <
şass
 
	gTC
>

71 şas 
	cCheck”Th»adCÚ‹xt
 : 
public
 
Th»adCÚ‹xt


73 
public
:

74 
	$Check”Th»adCÚ‹xt
(
TC
 *
aùu®_tc
,

75 
Check”CPU
 *
check”_ıu
)

76 : 
	`aùu®TC
(
aùu®_tc
), 
	`check”TC
(
check”_ıu
->
th»ad
),

77 
	$check”CPU
(
check”_ıu
)

80 
´iv©e
:

83 
TC
 *
aùu®TC
;

87 
Sim¶eTh»ad
 *
check”TC
;

89 
Check”CPU
 *
check”CPU
;

91 
public
:

93 
Ba£CPU
 *
	$g‘CpuPŒ
(è{  
aùu®TC
->
	`g‘CpuPŒ
(); 
	}
}

95 
	$ıuId
(è{  
aùu®TC
->
	`ıuId
(); 
	}
}

97 
	$cÚ‹xtId
(è{  
aùu®TC
->
	`cÚ‹xtId
(); 
	}
}

99 
	$£tCÚ‹xtId
(
id
)

101 
aùu®TC
->
	`£tCÚ‹xtId
(
id
);

102 
check”TC
->
	`£tCÚ‹xtId
(
id
);

103 
	}
}

106 
	$th»adId
(è{  
aùu®TC
->
	`th»adId
(); 
	}
}

107 
	$£tTh»adId
(
id
)

109 
check”TC
->
	`£tTh»adId
(
id
);

110 
aùu®TC
->
	`£tTh»adId
(
id
);

111 
	}
}

113 
	gTheISA
::
TLB
 *
	$g‘ITBPŒ
(è{  
aùu®TC
->
	`g‘ITBPŒ
(); 
	}
}

115 
	gTheISA
::
TLB
 *
	$g‘DTBPŒ
(è{  
aùu®TC
->
	`g‘DTBPŒ
(); 
	}
}

117 
Check”CPU
 *
	$g‘Check”CpuPŒ
()

119  
check”CPU
;

120 
	}
}

122 
	gTheISA
::
Decod”
 *
	$g‘Decod”PŒ
(è{  
aùu®TC
->
	`g‘Decod”PŒ
(); 
	}
}

124 
Sy¡em
 *
	$g‘Sy¡emPŒ
(è{  
aùu®TC
->
	`g‘Sy¡emPŒ
(); 
	}
}

126 
	gTheISA
::
K”Ãl
::
Sti¡ics
 *
	$g‘K”ÃlSts
()

127 {  
aùu®TC
->
	`g‘K”ÃlSts
(); 
	}
}

129 
Proûss
 *
	$g‘ProûssPŒ
(è{  
aùu®TC
->
	`g‘ProûssPŒ
(); 
	}
}

131 
	gPÜtProxy
 &
	$g‘PhysProxy
(è{  
aùu®TC
->
	`g‘PhysProxy
(); 
	}
}

133 
	gFST¿n¦©šgPÜtProxy
 &
	$g‘VœtProxy
()

134 {  
aùu®TC
->
	`g‘VœtProxy
(); 
	}
}

136 
	$š™MemProx›s
(
Th»adCÚ‹xt
 *
tc
)

137 { 
aùu®TC
->
	`š™MemProx›s
(
tc
); 
	}
}

139 
	$cÚÃùMemPÜts
(
Th»adCÚ‹xt
 *
tc
)

141 
aùu®TC
->
	`cÚÃùMemPÜts
(
tc
);

142 
	}
}

144 
	gSET¿n¦©šgPÜtProxy
 &
	$g‘MemProxy
(è{  
aùu®TC
->
	`g‘MemProxy
(); 
	}
}

147 
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

148 {  
aùu®TC
->
	`sysÿÎ
(
ÿÎnum
); 
	}
}

150 
Stus
 
	$¡©us
(ècÚ¡ {  
aùu®TC
->
	`¡©us
(); 
	}
}

152 
	$£tStus
(
Stus
 
Ãw_¡©us
)

154 
aùu®TC
->
	`£tStus
(
Ãw_¡©us
);

155 
check”TC
->
	`£tStus
(
Ãw_¡©us
);

156 
	}
}

160 
aùiv©e
(
Cyşes
 
d–ay
 = 
	$Cyşes
(1))

161 { 
aùu®TC
->
	`aùiv©e
(
d–ay
); 
	}
}

164 
	$su¥’d
(
Cyşes
 
d–ay
è{ 
aùu®TC
->
	`su¥’d
(d–ay); 
	}
}

167 
	$h®t
(
Cyşes
 
d–ay
è{ 
aùu®TC
->
	`h®t
(d–ay); 
	}
}

169 
	$dumpFuncProfe
(è{ 
aùu®TC
->
	`dumpFuncProfe
(); 
	}
}

171 
	$keOv”From
(
Th»adCÚ‹xt
 *
ŞdCÚ‹xt
)

173 
aùu®TC
->
	`keOv”From
(
ŞdCÚ‹xt
);

174 
check”TC
->
	`cİyS‹
(
ŞdCÚ‹xt
);

175 
	}
}

177 
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
)

179 
aùu®TC
->
»gSts
(
Çme
);

180 
	gcheck”TC
->
»gSts
(
Çme
);

183 
£rŸlize
(
¡d
::
o¡»am
 &
os
è{ 
aùu®TC
->serialize(os); }

184 
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
)

185 { 
aùu®TC
->
un£rŸlize
(
ı
, 
£ùiÚ
); }

187 
EndQu›sûEv’t
 *
	$g‘Qu›sûEv’t
(è{  
aùu®TC
->
	`g‘Qu›sûEv’t
(); 
	}
}

189 
Tick
 
	$»adLa¡Aùiv©e
(è{  
aùu®TC
->
	`»adLa¡Aùiv©e
(); 
	}
}

190 
Tick
 
	$»adLa¡Su¥’d
(è{  
aùu®TC
->
	`»adLa¡Su¥’d
(); 
	}
}

192 
	$´ofeCË¬
(è{  
aùu®TC
->
	`´ofeCË¬
(); 
	}
}

193 
	$´ofeSam¶e
(è{  
aùu®TC
->
	`´ofeSam¶e
(); 
	}
}

196 
	$cİyArchRegs
(
Th»adCÚ‹xt
 *
tc
)

198 
aùu®TC
->
	`cİyArchRegs
(
tc
);

199 
check”TC
->
	`cİyArchRegs
(
tc
);

200 
	}
}

202 
	$ş—rArchRegs
()

204 
aùu®TC
->
	`ş—rArchRegs
();

205 
check”TC
->
	`ş—rArchRegs
();

206 
	}
}

211 
ušt64_t
 
	$»adIÁReg
(
»g_idx
)

212 {  
aùu®TC
->
	`»adIÁReg
(
»g_idx
); 
	}
}

214 
FlßtReg
 
	$»adFlßtReg
(
»g_idx
)

215 {  
aùu®TC
->
	`»adFlßtReg
(
»g_idx
); 
	}
}

217 
FlßtRegB™s
 
	$»adFlßtRegB™s
(
»g_idx
)

218 {  
aùu®TC
->
	`»adFlßtRegB™s
(
»g_idx
); 
	}
}

220 
CCReg
 
	$»adCCReg
(
»g_idx
)

221 {  
aùu®TC
->
	`»adCCReg
(
»g_idx
); 
	}
}

223 
	$£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
)

225 
aùu®TC
->
	`£tIÁReg
(
»g_idx
, 
v®
);

226 
check”TC
->
	`£tIÁReg
(
»g_idx
, 
v®
);

227 
	}
}

229 
	$£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
)

231 
aùu®TC
->
	`£tFlßtReg
(
»g_idx
, 
v®
);

232 
check”TC
->
	`£tFlßtReg
(
»g_idx
, 
v®
);

233 
	}
}

235 
	$£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
)

237 
aùu®TC
->
	`£tFlßtRegB™s
(
»g_idx
, 
v®
);

238 
check”TC
->
	`£tFlßtRegB™s
(
»g_idx
, 
v®
);

239 
	}
}

241 
	$£tCCReg
(
»g_idx
, 
CCReg
 
v®
)

243 
aùu®TC
->
	`£tCCReg
(
»g_idx
, 
v®
);

244 
check”TC
->
	`£tCCReg
(
»g_idx
, 
v®
);

245 
	}
}

248 
	gTheISA
::
PCS‹
 
	$pcS‹
()

249 {  
aùu®TC
->
	`pcS‹
(); 
	}
}

252 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

254 
DPRINTF
(
Check”
, "Changing PCo %s, old PC %s\n",

255 
v®
, 
check”TC
->
pcS‹
());

256 
	gcheck”TC
->
pcS‹
(
v®
);

257 
	gcheck”CPU
->
»cÜdPCChªge
(
v®
);

258  
	gaùu®TC
->
pcS‹
(
v®
);

261 
pcS‹NoRecÜd
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

263  
aùu®TC
->
pcS‹
(
v®
);

267 
Addr
 
	$š¡Addr
()

268 {  
aùu®TC
->
	`š¡Addr
(); 
	}
}

271 
Addr
 
	$ÃxtIn¡Addr
()

272 {  
aùu®TC
->
	`ÃxtIn¡Addr
(); 
	}
}

275 
MiüoPC
 
	$miüoPC
()

276 {  
aùu®TC
->
	`miüoPC
(); 
	}
}

278 
MiscReg
 
	$»adMiscRegNoEfãù
(
misc_»g
)

279 {  
aùu®TC
->
	`»adMiscRegNoEfãù
(
misc_»g
); 
	}
}

281 
MiscReg
 
	$»adMiscReg
(
misc_»g
)

282 {  
aùu®TC
->
	`»adMiscReg
(
misc_»g
); 
	}
}

284 
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

286 
	`DPRINTF
(
Check”
, "Setting misc„eg with‚oƒffect: %do both Checker"

287 "‡nd O3..\n", 
misc_»g
);

288 
check”TC
->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
);

289 
aùu®TC
->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
);

290 
	}
}

292 
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

294 
	`DPRINTF
(
Check”
, "Setting misc„eg withƒffect: %do both Checker"

295 "‡nd O3..\n", 
misc_»g
);

296 
check”TC
->
	`£tMiscReg
(
misc_»g
, 
v®
);

297 
aùu®TC
->
	`£tMiscReg
(
misc_»g
, 
v®
);

298 
	}
}

300 
	$æ©‹nIÁIndex
(
»g
è{  
aùu®TC
->
	`æ©‹nIÁIndex
Ôeg); 
	}
}

301 
	$æ©‹nFlßtIndex
(
»g
è{  
aùu®TC
->
	`æ©‹nFlßtIndex
Ôeg); 
	}
}

302 
	$æ©‹nCCIndex
(
»g
è{  
aùu®TC
->
	`æ©‹nCCIndex
Ôeg); 
	}
}

304 
	$»adStCÚdFau»s
()

305 {  
aùu®TC
->
	`»adStCÚdFau»s
(); 
	}
}

307 
	$£tStCÚdFau»s
(
sc_çu»s
)

309 
aùu®TC
->
	`£tStCÚdFau»s
(
sc_çu»s
);

310 
	}
}

313 
boŞ
 
	$mis¥ecuÏtšg
(è{  
aùu®TC
->
	`mis¥ecuÏtšg
(); 
	}
}

315 
CouÁ”
 
	$»adFuncExeIn¡
(è{  
aùu®TC
->
	`»adFuncExeIn¡
(); 
	}
}

317 
ušt64_t
 
	$»adIÁRegFÏt
(
idx
)

318 {  
aùu®TC
->
	`»adIÁRegFÏt
(
idx
); 
	}
}

320 
	$£tIÁRegFÏt
(
idx
, 
ušt64_t
 
v®
)

321 { 
aùu®TC
->
	`£tIÁRegFÏt
(
idx
, 
v®
); 
	}
}

323 
FlßtReg
 
	$»adFlßtRegFÏt
(
idx
)

324 {  
aùu®TC
->
	`»adFlßtRegFÏt
(
idx
); 
	}
}

326 
	$£tFlßtRegFÏt
(
idx
, 
FlßtReg
 
v®
)

327 { 
aùu®TC
->
	`£tFlßtRegFÏt
(
idx
, 
v®
); 
	}
}

329 
FlßtRegB™s
 
	$»adFlßtRegB™sFÏt
(
idx
)

330 {  
aùu®TC
->
	`»adFlßtRegB™sFÏt
(
idx
); 
	}
}

332 
	$£tFlßtRegB™sFÏt
(
idx
, 
FlßtRegB™s
 
v®
)

333 { 
aùu®TC
->
	`£tFlßtRegB™sFÏt
(
idx
, 
v®
); 
	}
}

335 
CCReg
 
	$»adCCRegFÏt
(
idx
)

336 {  
aùu®TC
->
	`»adCCRegFÏt
(
idx
); 
	}
}

338 
	$£tCCRegFÏt
(
idx
, 
CCReg
 
v®
)

339 { 
aùu®TC
->
	`£tCCRegFÏt
(
idx
, 
v®
); 
	}
}

	@cpuevent.cc

31 
	~"ıu/ıuev’t.hh
"

35 
	gCpuEv’t
::
CpuEv’tLi¡
 
CpuEv’t
::
ıuEv’tLi¡
;

37 
	gCpuEv’t
::~
	$CpuEv’t
()

39 
CpuEv’tLi¡
::
™”©Ü
 
i
;

42 
i
 = 
ıuEv’tLi¡
.
	`begš
(); i !ğıuEv’tLi¡.
	`’d
(); ) {

43 ià(*
i
 =ğ
this
)

44 
i
 = 
ıuEv’tLi¡
.
	`”a£
(i);

46 
i
++;

48 
	}
}

51 
	gCpuEv’t
::
	$»¶aûTh»adCÚ‹xt
(
Th»adCÚ‹xt
 *
ŞdTc
, Th»adCÚ‹xˆ*
ÃwTc
)

53 
CpuEv’tLi¡
::
™”©Ü
 
i
;

57 
i
 = 
ıuEv’tLi¡
.
	`begš
(); i !ğıuEv’tLi¡.
	`’d
(); i++) {

58 ià((*
i
)->
tc
 =ğ
ŞdTc
)

59 (*
i
)->
tc
 = 
ÃwTc
;

61 
	}
}

	@cpuevent.hh

31 #iâdeà
__CPU_CPUEVENT_HH__


32 
	#__CPU_CPUEVENT_HH__


	)

34 
	~<veùÜ
>

36 
	~"sim/ev’tq.hh
"

38 
şass
 
	gTh»adCÚ‹xt
;

48 şas 
	cCpuEv’t
 : 
public
 
Ev’t


50 
´Ùeùed
:

52 
¡d
::
	tveùÜ
<
	tCpuEv’t
 *> 
	tCpuEv’tLi¡
;

56 
CpuEv’tLi¡
 
	mıuEv’tLi¡
;

59 
Th»adCÚ‹xt
 *
	mtc
;

61 
	mpublic
:

62 
	$CpuEv’t
(
Th»adCÚ‹xt
 *
_tc
, 
PriÜ™y
 
p
 = 
DeçuÉ_Pri
)

63 : 
	`Ev’t
(
p
), 
	$tc
(
_tc
)

64 { 
ıuEv’tLi¡
.
	`push_back
(
this
); }

67 ~
	`CpuEv’t
();

73 
	`»¶aûTh»adCÚ‹xt
(
Th»adCÚ‹xt
 *
ŞdTc
,

74 
Th»adCÚ‹xt
 *
ÃwTc
);

75 
Th»adCÚ‹xt
* 
	$g‘TC
(è{  
tc
; 
	}
}

78 
	g‹m¶©e
 <
şass
 
	gT
, (T::* 
F
)(
Th»adCÚ‹xt
 *
tc
)>

79 şas 
	cCpuEv’tW¿µ”
 : 
public
 
CpuEv’t


81 
´iv©e
:

82 
T
 *
objeù
;

84 
	mpublic
:

85 
	$CpuEv’tW¿µ”
(
T
 *
obj
, 
Th»adCÚ‹xt
 *
_tc
, 
PriÜ™y
 
p
 = 
DeçuÉ_Pri
)

86 : 
	`CpuEv’t
(
_tc
, 
p
), 
	$objeù
(
obj
)

88 
	$´oûss
(è{ (
objeù
->*
F
)(
tc
); 
	}
}

	@decode_cache.hh

31 #iâdeà
__CPU_DECODE_CACHE_HH__


32 
	#__CPU_DECODE_CACHE_HH__


	)

34 
	~"¬ch/i§_Œa™s.hh
"

35 
	~"¬ch/ty³s.hh
"

36 
	~"ba£/hashm­.hh
"

37 
	~"cÚfig/the_i§.hh
"

38 
	~"ıu/¡©ic_š¡_fwd.hh
"

40 
Çme¥aû
 
	gTheISA


42 
şass
 
	gDecod”
;

45 
Çme¥aû
 
	gDecodeCache


49 
	gm5
::
	thash_m­
<
	tTheISA
::
	tExtMachIn¡
, 
	tSticIn¡PŒ
> 
	tIn¡M­
;

52 
	g‹m¶©e
<
şass
 
	gV®ue
>

53 şas 
	cAddrM­


55 
	g´Ùeùed
:

57 
	sCachePage
 {

58 
V®ue
 
™ems
[
TheISA
::
PageBy‹s
];

61 
ty³Çme
 
	tm5
::
	thash_m­
<
	tAddr
, 
	tCachePage
 *> 
	tPageM­
;

62 
ty³Çme
 
	tPageM­
::
	t™”©Ü
 
	tPageIt
;

64 
PageIt
 
	g»ûÁ
[2];

65 
PageM­
 
	g·geM­
;

70 
upd©e
(
PageIt
 
»ûÁe¡
)

72 
	g»ûÁ
[1] = 
»ûÁ
[0];

73 
	g»ûÁ
[0] = 
»ûÁe¡
;

80 
CachePage
 *

81 
g‘Page
(
Addr
 
addr
)

83 
Addr
 
	g·ge_addr
 = 
addr
 & ~(
TheISA
::
PageBy‹s
 - 1);

86 ià(
	g»ûÁ
[0] !ğ
·geM­
.
’d
()) {

87 ià(
»ûÁ
[0]->
fœ¡
 =ğ
·ge_addr
)

88  
»ûÁ
[0]->
£cÚd
;

89 ià(
	g»ûÁ
[1] !ğ
·geM­
.
’d
() &&

90 
»ûÁ
[1]->
fœ¡
 =ğ
·ge_addr
) {

91 
upd©e
(
»ûÁ
[1]);

93  
	g»ûÁ
[0]->
	g£cÚd
;

98 
PageIt
 
	g™
 = 
·geM­
.
fšd
(
·ge_addr
);

99 ià(
	g™
 !ğ
·geM­
.
’d
()) {

100 
upd©e
(
™
);

101  
	g™
->
	g£cÚd
;

105 
CachePage
 *
	gÃwPage
 = 
Ãw
 CachePage;

106 
	g·ge_addr
 = 
·ge_addr
 & ~(
TheISA
::
PageBy‹s
 - 1);

107 
ty³Çme
 
	gPageM­
::
v®ue_ty³
 
to_š£¹
(
·ge_addr
, 
ÃwPage
);

108 
upd©e
(
·geM­
.
š£¹
(
to_š£¹
).
fœ¡
);

109  
	gÃwPage
;

112 
	gpublic
:

114 
AddrM­
()

116 
»ûÁ
[0] =„eûÁ[1] = 
·geM­
.
’d
();

119 
	gV®ue
 &

120 
lookup
(
Addr
 
addr
)

122 
CachePage
 *
	g·ge
 = 
g‘Page
(
addr
);

123  
	g·ge
->
	g™ems
[
addr
 & (
TheISA
::
PageBy‹s
 - 1)];

	@dummy_checker.cc

40 
	~"ıu/dummy_check”.hh
"

41 
	~"·¿ms/DummyCheck”.hh
"

47 
DummyCheck”
 *

48 
	gDummyCheck”P¬ams
::
	$ü—‹
()

50 
DummyCheck”
::
P¬ams
 *
·¿ms
 = 
Ãw
 DummyCheck”::
	`P¬ams
();

51 
·¿ms
->
Çme
 =‚ame;

52 
·¿ms
->
numTh»ads
 =‚umThreads;

53 
·¿ms
->
max_š¡s_ªy_th»ad
 = 0;

54 
·¿ms
->
max_š¡s_®l_th»ads
 = 0;

55 
·¿ms
->
max_lßds_ªy_th»ad
 = 0;

56 
·¿ms
->
max_lßds_®l_th»ads
 = 0;

57 
·¿ms
->
şk_domaš
 = clk_domain;

60 
CouÁ”
 
‹mp
;

61 
‹mp
 = 
max_š¡s_ªy_th»ad
;

62 
‹mp
 = 
max_š¡s_®l_th»ads
;

63 
‹mp
 = 
max_lßds_ªy_th»ad
;

64 
‹mp
 = 
max_lßds_®l_th»ads
;

65 
‹mp
++;

66 
Tick
 
‹mp2
 = 
´og»ss_š‹rv®
;

67 
·¿ms
->
´og»ss_š‹rv®
 = 0;

68 
‹mp2
++;

70 
·¿ms
->
™b
 = itb;

71 
·¿ms
->
dtb
 = dtb;

72 
·¿ms
->
i§
 = isa;

73 
·¿ms
->
sy¡em
 = system;

74 
·¿ms
->
ıu_id
 = cpu_id;

75 
·¿ms
->
´ofe
 =…rofile;

76 
·¿ms
->
š‹¼u±s
 = 
NULL
;

77 
·¿ms
->
wÜklßd
 = workload;

79 
DummyCheck”
 *
ıu
 = 
Ãw
 
	`DummyCheck”
(
·¿ms
);

80  
ıu
;

81 
	}
}

	@dummy_checker.hh

40 #iâdeà
__CPU_DUMMY_CHECKER_HH__


41 
	#__CPU_DUMMY_CHECKER_HH__


	)

43 
	~"ıu/check”/ıu.hh
"

48 şas 
	cDummyCheck”
 : 
public
 
Check”CPU


50 
public
:

51 
	$DummyCheck”
(
P¬ams
 *
p
)

52 : 
	$Check”CPU
(
p
)

54 
	}
};

	@exec_context.hh

38 şas 
	cExecCÚ‹xt
 {

51 
ušt64_t
 
»adIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
);

54 
FlßtReg
 
»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
);

58 
FlßtRegB™s
 
»adFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
);

61 
£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
);

64 
£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
);

68 
£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

69 
FlßtRegB™s
 
v®
);

72 
ušt64_t
 
»adPC
();

74 
ušt64_t
 
»adNextPC
();

76 
ušt64_t
 
»adNextNPC
();

79 
£tPC
(
ušt64_t
 
v®
);

81 
£tNextPC
(
ušt64_t
 
v®
);

83 
£tNextNPC
(
ušt64_t
 
v®
);

86 
MiscReg
 
»adMiscRegNoEfãù
(
misc_»g
);

90 
MiscReg
 
»adMiscReg
(
misc_»g
);

93 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

97 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

101 
£tEA
(
Addr
 
EA
);

104 
Addr
 
g‘EA
();

107 
Th»adCÚ‹xt
 *
tcBa£
();

109 
FauÉ
 
»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
);

111 
FauÉ
 
wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

112 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

116 
FauÉ
 
hw»i
();

122 
boŞ
 
simP®Check
(
·lFunc
);

125 
sysÿÎ
(
št64_t
 
ÿÎnum
);

128 
fšishT¿n¦©iÚ
(
WhŞeT¿n¦©iÚS‹
 *
¡©e
);

	@exetrace.cc

34 
	~<iomª
>

36 
	~"¬ch/i§_Œa™s.hh
"

37 
	~"¬ch/ut™y.hh
"

38 
	~"ba£/lßd”/symb.hh
"

39 
	~"cÚfig/the_i§.hh
"

40 
	~"ıu/ba£.hh
"

41 
	~"ıu/ex‘¿û.hh
"

42 
	~"ıu/¡©ic_š¡.hh
"

43 
	~"ıu/th»ad_cÚ‹xt.hh
"

44 
	~"debug/ExecAÎ.hh
"

45 
	~"’ums/OpCÏss.hh
"

47 
usšg
 
Çme¥aû
 
	g¡d
;

48 
usšg
 
Çme¥aû
 
	gTheISA
;

50 
Çme¥aû
 
	gT¿û
 {

53 
	gExeT¿ûrRecÜd
::
dumpTicks
(
o¡»am
 &
outs
)

55 
cırštf
(
outs
, "%7d: ", 
wh’
);

59 
	gT¿û
::
ExeT¿ûrRecÜd
::
ŒaûIn¡
(
SticIn¡PŒ
 
š¡
, 
boŞ
 
¿n
)

61 
	go¡»am
 &
	gouts
 = 
T¿û
::
ouut
();

63 ià(!
	gDebug
::
ExecU£r
 || !
Debug
::
ExecK”Ãl
) {

64 
boŞ
 
š_u£r_mode
 = 
TheISA
::
šU£rMode
(
th»ad
);

65 ià(
	gš_u£r_mode
 && !
	gDebug
::
ExecU£r
) ;

66 ià(!
	gš_u£r_mode
 && !
	gDebug
::
ExecK”Ãl
) ;

69 ià(
	gDebug
::
ExecTicks
)

70 
dumpTicks
(
outs
);

72 
	gouts
 << 
	gth»ad
->
g‘CpuPŒ
()->
Çme
() << " ";

74 ià(
	gDebug
::
ExecS³cuÏtive
)

75 
outs
 << (
mis¥ecuÏtšg
 ? "-" : "+") << " ";

77 ià(
	gDebug
::
ExecAsid
)

78 
outs
 << "A" << 
dec
 << 
TheISA
::
g‘ExecutšgAsid
(
th»ad
) << " ";

80 ià(
	gDebug
::
ExecTh»ad
)

81 
outs
 << "T" << 
th»ad
->
th»adId
() << " : ";

83 
	g¡d
::
¡ršg
 
sym_¡r
;

84 
Addr
 
	gsym_addr
;

85 
Addr
 
	gcur_pc
 = 
pc
.
š¡Addr
();

86 ià(
	gdebugSymbŞTabË
 && 
	gDebug
::
ExecSymbŞ
 &&

87 (!
FuÎSy¡em
 || !
šU£rMode
(
th»ad
)) &&

88 
debugSymbŞTabË
->
fšdN—»¡SymbŞ
(
cur_pc
, 
sym_¡r
, 
sym_addr
)) {

89 ià(
	gcur_pc
 !ğ
sym_addr
)

90 
sym_¡r
 +ğ
c¥rštf
("+%d",
cur_pc
 - 
sym_addr
);

91 
	gouts
 << "@" << 
	gsym_¡r
;

93 
	gouts
 << "0x" << 
	ghex
 << 
	gcur_pc
;

96 ià(
	gš¡
->
isMiüoİ
()) {

97 
	gouts
 << "." << 
£tw
(2è<< 
	gdec
 << 
	gpc
.
miüoPC
();

99 
	gouts
 << " ";

102 
	gouts
 << " : ";

108 
	gouts
 << 
£tw
(26è<< 
	gËá
;

109 
	gouts
 << 
	gš¡
->
di§s£mbË
(
cur_pc
, 
debugSymbŞTabË
);

111 ià(
	g¿n
) {

112 
	gouts
 << " : ";

114 ià(
	gDebug
::
ExecOpCÏss
) {

115 
outs
 << 
Enums
::
OpCÏssSŒšgs
[
š¡
->
İCÏss
()] << " : ";

118 ià(
	gDebug
::
ExecResuÉ
 && 
´ediÿ‹
 =ğ
çl£
) {

119 
outs
 << "Predicated False";

122 ià(
	gDebug
::
ExecResuÉ
 && 
d©a_¡©us
 !ğ
D©aInv®id
) {

123 
cırštf
(
outs
, " D=%#018x", 
d©a
.
as_št
);

126 ià(
	gDebug
::
ExecEffAddr
 && 
addr_v®id
)

127 
outs
 << " A=0x" << 
hex
 << 
addr
;

129 ià(
	gDebug
::
ExecF‘chSeq
 && 
ãtch_£q_v®id
)

130 
outs
 << " F‘chSeq=" << 
dec
 << 
ãtch_£q
;

132 ià(
	gDebug
::
ExecCPSeq
 && 
ı_£q_v®id
)

133 
outs
 << " CPSeq=" << 
dec
 << 
ı_£q
;

139 
	gouts
 << 
	g’dl
;

143 
	gT¿û
::
ExeT¿ûrRecÜd
::
dump
()

153 ià(
Debug
::
ExecMaüo
 && 
¡©icIn¡
->
isMiüoİ
() &&

154 ((
Debug
::
ExecMiüo
 &&

155 
maüoSticIn¡
 && 
¡©icIn¡
->
isFœ¡Miüoİ
()) ||

156 (!
Debug
::
ExecMiüo
 &&

157 
maüoSticIn¡
 && 
¡©icIn¡
->
isLa¡Miüoİ
()))) {

158 
ŒaûIn¡
(
maüoSticIn¡
, 
çl£
);

160 ià(
	gDebug
::
ExecMiüo
 || !
¡©icIn¡
->
isMiüoİ
()) {

161 
ŒaûIn¡
(
¡©icIn¡
, 
Œue
);

171 
	gT¿û
::
ExeT¿ûr
 *

172 
ExeT¿ûrP¬ams
::
	$ü—‹
()

174  
Ãw
 
T¿û
::
	`ExeT¿ûr
(
this
);

175 
	}
}

	@exetrace.hh

32 #iâdeà
__CPU_EXETRACE_HH__


33 
	#__CPU_EXETRACE_HH__


	)

35 
	~"ba£/Œaû.hh
"

36 
	~"ba£/ty³s.hh
"

37 
	~"ıu/¡©ic_š¡.hh
"

38 
	~"ıu/th»ad_cÚ‹xt.hh
"

39 
	~"debug/ExecEÇbË.hh
"

40 
	~"debug/ExecS³cuÏtive.hh
"

41 
	~"·¿ms/ExeT¿ûr.hh
"

42 
	~"sim/š¡Œaûr.hh
"

44 
şass
 
	gTh»adCÚ‹xt
;

46 
Çme¥aû
 
	gT¿û
 {

48 şas 
	cExeT¿ûrRecÜd
 : 
public
 
In¡RecÜd


50 
public
:

51 
ExeT¿ûrRecÜd
(
Tick
 
_wh’
, 
Th»adCÚ‹xt
 *
_th»ad
,

52 cÚ¡ 
SticIn¡PŒ
 
_¡©icIn¡
, 
TheISA
::
PCS‹
 
_pc
,

53 
boŞ
 
¥ec
, cÚ¡ 
SticIn¡PŒ
 
_maüoSticIn¡
 = 
NULL
)

54 : 
In¡RecÜd
(
_wh’
, 
_th»ad
, 
_¡©icIn¡
, 
_pc
, 
¥ec
,

55 
_maüoSticIn¡
)

59 
ŒaûIn¡
(
SticIn¡PŒ
 
š¡
, 
boŞ
 
¿n
);

61 
dump
();

62 
vœtu®
 
dumpTicks
(
¡d
::
o¡»am
 &
outs
);

65 şas 
	cExeT¿ûr
 : 
public
 
In¡T¿ûr


67 
public
:

68 
ExeT¿ûrP¬ams
 
	tP¬ams
;

69 
ExeT¿ûr
(cÚ¡ 
P¬ams
 *
·¿ms
è: 
In¡T¿ûr
(params)

72 
In¡RecÜd
 *

73 
g‘In¡RecÜd
(
Tick
 
wh’
, 
Th»adCÚ‹xt
 *
tc
,

74 cÚ¡ 
SticIn¡PŒ
 
¡©icIn¡
, 
TheISA
::
PCS‹
 
pc
,

75 cÚ¡ 
SticIn¡PŒ
 
maüoSticIn¡
 = 
NULL
)

77 ià(!
Debug
::
ExecEÇbË
)

78  
NULL
;

80 ià(!
	gT¿û
::
’abËd
)

81  
NULL
;

83 ià(!
	gDebug
::
ExecS³cuÏtive
 && 
tc
->
mis¥ecuÏtšg
())

84  
NULL
;

86  
Ãw
 
ExeT¿ûrRecÜd
(
wh’
, 
tc
,

87 
¡©icIn¡
, 
pc
, 
tc
->
mis¥ecuÏtšg
(), 
maüoSticIn¡
);

	@func_unit.cc

31 
	~<s¡»am
>

33 
	~"ba£/misc.hh
"

34 
	~"ıu/func_un™.hh
"

36 
usšg
 
Çme¥aû
 
	g¡d
;

43 
	gFuncUn™
::
	$FuncUn™
()

45 
ÿ·b™yLi¡
.
	`»£t
();

46 
	}
}

50 
	gFuncUn™
::
	$FuncUn™
(cÚ¡ 
FuncUn™
 &
fu
)

53 
i
 = 0; i < 
Num_OpCÏs£s
; ++i) {

54 
İL©’c›s
[
i
] = 
fu
.opLatencies[i];

55 
issueL©’c›s
[
i
] = 
fu
.issueLatencies[i];

58 
ÿ·b™yLi¡
 = 
fu
.capabilityList;

59 
	}
}

63 
	gFuncUn™
::
	$addC­ab™y
(
OpCÏss
 
ÿp
, 
İÏt
, 
issu–©
)

65 ià(
issu–©
 =ğ0 || 
İÏt
 == 0)

66 
	`·nic
("FuncUnit: you don't„eally want‡ zero-cycle†atency do you?");

68 
ÿ·b™yLi¡
.
	`£t
(
ÿp
);

70 
İL©’c›s
[
ÿp
] = 
İÏt
;

71 
issueL©’c›s
[
ÿp
] = 
issu–©
;

72 
	}
}

74 
boŞ


75 
	gFuncUn™
::
	$´ovides
(
OpCÏss
 
ÿ·b™y
)

77  
ÿ·b™yLi¡
[
ÿ·b™y
];

78 
	}
}

80 
	gb™£t
<
	gNum_OpCÏs£s
>

81 
	gFuncUn™
::
	$ÿ·b™›s
()

83  
ÿ·b™yLi¡
;

84 
	}
}

87 
	gFuncUn™
::
	$İL©’cy
(
OpCÏss
 
ÿp
)

89  
İL©’c›s
[
ÿp
];

90 
	}
}

93 
	gFuncUn™
::
	$issueL©’cy
(
OpCÏss
 
ÿ·b™y
)

95  
issueL©’c›s
[
ÿ·b™y
];

96 
	}
}

118 
OpDesc
 *

119 
	gOpDescP¬ams
::
	$ü—‹
()

121  
Ãw
 
	`OpDesc
(
this
);

122 
	}
}

127 
FUDesc
 *

128 
	gFUDescP¬ams
::
	$ü—‹
()

130  
Ãw
 
	`FUDesc
(
this
);

131 
	}
}

	@func_unit.hh

31 #iâdeà
__CPU_FUNC_UNIT_HH__


32 
	#__CPU_FUNC_UNIT_HH__


	)

34 
	~<b™£t
>

35 
	~<¡ršg
>

36 
	~<veùÜ
>

38 
	~"ıu/İ_şass.hh
"

39 
	~"·¿ms/FUDesc.hh
"

40 
	~"·¿ms/OpDesc.hh
"

41 
	~"sim/sim_objeù.hh
"

50 şas 
	cOpDesc
 : 
public
 
SimObjeù


52 
public
:

53 
OpCÏss
 
İCÏss
;

54 
Cyşes
 
	mİL©
;

55 
Cyşes
 
	missueL©
;

57 
	$OpDesc
(cÚ¡ 
OpDescP¬ams
 *
p
)

58 : 
	`SimObjeù
(
p
), 
	`İCÏss
Õ->
İCÏss
), 
	`İL©
Õ->
İL©
),

59 
	`issueL©
(
p
->
issueL©
) {};

60 
	}
};

62 şas 
	cFUDesc
 : 
public
 
SimObjeù


64 
public
:

65 
¡d
::
veùÜ
<
OpDesc
 *> 
İDescLi¡
;

66 
	mnumb”
;

68 
	$FUDesc
(cÚ¡ 
FUDescP¬ams
 *
p
)

69 : 
	`SimObjeù
(
p
), 
	`İDescLi¡
Õ->
İLi¡
), 
	`numb”
Õ->
couÁ
) {};

70 
	}
};

72 
	g¡d
::
	tveùÜ
<
	tOpDesc
 *>::
	tcÚ¡_™”©Ü
 
	tOPDD™”©Ü
;

73 
	g¡d
::
	tveùÜ
<
	tFUDesc
 *>::
	tcÚ¡_™”©Ü
 
	tFUDD™”©Ü
;

84 şas 
	cFuncUn™


86 
	m´iv©e
:

87 
İL©’c›s
[
Num_OpCÏs£s
];

88 
	missueL©’c›s
[
Num_OpCÏs£s
];

89 
	m¡d
::
b™£t
<
Num_OpCÏs£s
> 
ÿ·b™yLi¡
;

91 
	mpublic
:

92 
FuncUn™
();

93 
FuncUn™
(cÚ¡ FuncUn™ &
fu
);

95 
	m¡d
::
¡ršg
 
Çme
;

97 
addC­ab™y
(
OpCÏss
 
ÿp
, 
İÏt
, 
issu–©
);

99 
boŞ
 
´ovides
(
OpCÏss
 
ÿ·b™y
);

100 
	m¡d
::
b™£t
<
Num_OpCÏs£s
> 
ÿ·b™›s
();

102 &
İL©’cy
(
OpCÏss
 
ÿ·b™y
);

103 
issueL©’cy
(
OpCÏss
 
ÿ·b™y
);

	@inorder/comm.hh

32 #iâdeà
__CPU_INORDER_COMM_HH__


33 
	#__CPU_INORDER_COMM_HH__


	)

35 
	~<veùÜ
>

37 
	~"¬ch/i§_Œa™s.hh
"

38 
	~"ba£/ty³s.hh
"

39 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

40 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

41 
	~"ıu/š¡_£q.hh
"

45 
	sIÁ”SgeSŒuù
 {

49 
	m¡d
::
veùÜ
<
TheP–še
::
DynIn¡PŒ
> 
š¡s
;

56 
	sTimeSŒuù
 {

57 
	sSgeComm
 {

58 
boŞ
 
	msquash
;

59 
In¡SeqNum
 
	mdÚeSeqNum
;

61 
boŞ
 
	munÿched
;

62 
	mTheP–še
::
DynIn¡PŒ
 
unÿchedLßd
;

64 
SgeComm
()

65 : 
squash
(
çl£
), 
dÚeSeqNum
(0), 
unÿched
(çl£), 
unÿchedLßd
(
NULL
)

69 
SgeComm
 
	m¡ageInfo
[
TheP–še
::
NumSges
][TheP–še::
MaxTh»ads
];

70 
boŞ
 
	m¡ageBlock
[
TheP–še
::
NumSges
][TheP–še::
MaxTh»ads
];

71 
boŞ
 
	m¡ageUnblock
[
TheP–še
::
NumSges
][TheP–še::
MaxTh»ads
];

73 
TimeSŒuù
()

75 
	mi
 = 0; i < 
	mTheP–še
::
NumSges
; i++) {

76 
	mj
 = 0; j < 
	mTheP–še
::
MaxTh»ads
; j++) {

77 
	m¡ageBlock
[
i
][
j
] = 
çl£
;

78 
	m¡ageUnblock
[
i
][
j
] = 
çl£
;

	@inorder/cpu.cc

45 
	~<®gÜ™hm
>

47 
	~"¬ch/ut™y.hh
"

48 
	~"ba£/bigšt.hh
"

49 
	~"cÚfig/the_i§.hh
"

50 
	~"ıu/šÜd”/»sourûs/ÿche_un™.hh
"

51 
	~"ıu/šÜd”/»sourûs/»sourû_li¡.hh
"

52 
	~"ıu/šÜd”/ıu.hh
"

53 
	~"ıu/šÜd”/fœ¡_¡age.hh
"

54 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

55 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

56 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

57 
	~"ıu/šÜd”/th»ad_cÚ‹xt.hh
"

58 
	~"ıu/šÜd”/th»ad_¡©e.hh
"

59 
	~"ıu/aùiv™y.hh
"

60 
	~"ıu/ba£.hh
"

61 
	~"ıu/ex‘¿û.hh
"

62 
	~"ıu/qu›sû_ev’t.hh
"

63 
	~"ıu/»g_şass.hh
"

64 
	~"ıu/sim¶e_th»ad.hh
"

65 
	~"ıu/th»ad_cÚ‹xt.hh
"

66 
	~"debug/Aùiv™y.hh
"

67 
	~"debug/InOrd”CPU.hh
"

68 
	~"debug/InOrd”CachePÜt.hh
"

69 
	~"debug/IÁ”ru±.hh
"

70 
	~"debug/Qu›sû.hh
"

71 
	~"debug/RefCouÁ.hh
"

72 
	~"debug/SkedCache.hh
"

73 
	~"·¿ms/InOrd”CPU.hh
"

74 
	~"sim/fuÎ_sy¡em.hh
"

75 
	~"sim/´oûss.hh
"

76 
	~"sim/¡©_cÚŒŞ.hh
"

77 
	~"sim/sy¡em.hh
"

79 #ià
THE_ISA
 =ğ
ALPHA_ISA


80 
	~"¬ch/®pha/oså®.hh
"

83 
usšg
 
Çme¥aû
 
	g¡d
;

84 
usšg
 
Çme¥aû
 
	gTheISA
;

85 
usšg
 
Çme¥aû
 
	gTheP–še
;

87 
	gInOrd”CPU
::
CachePÜt
::CachePÜt(
CacheUn™
 *
_ÿcheUn™
,

88 cÚ¡ 
¡d
::
¡ršg
& 
Çme
) :

89 
Ma¡”PÜt
(
_ÿcheUn™
->
Çme
(è+‚ame, _ÿcheUn™->
ıu
),

90 
	$ÿcheUn™
(
_ÿcheUn™
)

91 { 
	}
}

93 
boŞ


94 
	gInOrd”CPU
::
CachePÜt
::
	$»cvTimšgRe¥
(
Pack‘
 *
pkt
)

96 ià(
pkt
->
	`isE¼Ü
())

97 
	`DPRINTF
(
InOrd”CachePÜt
, "Gotƒrror…acket back for‡ddress: %x\n",

98 
pkt
->
	`g‘Addr
());

100 
ÿcheUn™
->
	`´oûssCacheCom¶‘iÚ
(
pkt
);

102  
Œue
;

103 
	}
}

106 
	gInOrd”CPU
::
CachePÜt
::
	$»cvR‘ry
()

108 
ÿcheUn™
->
	`»cvR‘ry
();

109 
	}
}

111 
	gInOrd”CPU
::
TickEv’t
::
	$TickEv’t
(
InOrd”CPU
 *
c
)

112 : 
	`Ev’t
(
CPU_Tick_Pri
), 
	$ıu
(
c
)

113 { 
	}
}

117 
	gInOrd”CPU
::
TickEv’t
::
	$´oûss
()

119 
ıu
->
	`tick
();

120 
	}
}

124 
	gInOrd”CPU
::
TickEv’t
::
	$desütiÚ
() const

127 
	}
}

129 
	gInOrd”CPU
::
CPUEv’t
::
	$CPUEv’t
(
InOrd”CPU
 *
_ıu
, 
CPUEv’tTy³
 
e_ty³
,

130 
FauÉ
 
çuÉ
, 
Th»adID
 
_tid
, 
DynIn¡PŒ
 
š¡
,

131 
CPUEv’tPri
 
ev’t_´i
)

132 : 
	`Ev’t
(
ev’t_´i
), 
	$ıu
(
_ıu
)

134 
	`£tEv’t
(
e_ty³
, 
çuÉ
, 
_tid
, 
š¡
);

135 
	}
}

138 
	g¡d
::
¡ršg
 
InOrd”CPU
::
ev’tNames
[
NumCPUEv’ts
] =

152 
	gInOrd”CPU
::
CPUEv’t
::
	$´oûss
()

154 
ıuEv’tTy³
)

156 
Aùiv©eTh»ad
:

157 
ıu
->
	`aùiv©eTh»ad
(
tid
);

158 
ıu
->
»sPoŞ
->
	`aùiv©eTh»ad
(
tid
);

161 
Aùiv©eNextR—dyTh»ad
:

162 
ıu
->
	`aùiv©eNextR—dyTh»ad
();

165 
D—ùiv©eTh»ad
:

166 
ıu
->
	`d—ùiv©eTh»ad
(
tid
);

167 
ıu
->
»sPoŞ
->
	`d—ùiv©eTh»ad
(
tid
);

170 
H®tTh»ad
:

171 
ıu
->
	`h®tTh»ad
(
tid
);

172 
ıu
->
»sPoŞ
->
	`d—ùiv©eTh»ad
(
tid
);

175 
Su¥’dTh»ad
:

176 
ıu
->
	`su¥’dTh»ad
(
tid
);

177 
ıu
->
»sPoŞ
->
	`su¥’dTh»ad
(
tid
);

180 
SquashFromMemSÎ
:

181 
ıu
->
	`squashDueToMemSÎ
(
š¡
->
squashšgSge
, in¡->
£qNum
, 
tid
);

182 
ıu
->
»sPoŞ
->
	`squashDueToMemSÎ
(
š¡
, in¡->
squashšgSge
,

183 
š¡
->
£qNum
, 
tid
);

186 
T¿p
:

187 
	`DPRINTF
(
InOrd”CPU
, "Trapping CPU\n");

188 
ıu
->
	`Œ­
(
çuÉ
, 
tid
, 
š¡
);

189 
ıu
->
»sPoŞ
->
	`Œ­
(
çuÉ
, 
tid
, 
š¡
);

190 
ıu
->
Œ­P’dšg
[
tid
] = 
çl£
;

193 
SysÿÎ
:

194 
ıu
->
	`sysÿÎ
(
š¡
->
sysÿÎNum
, 
tid
);

195 
ıu
->
»sPoŞ
->
	`Œ­
(
çuÉ
, 
tid
, 
š¡
);

199 
	`çl
("UÄecognized Ev’ˆTy³ %s", 
ev’tNames
[
ıuEv’tTy³
]);

202 
ıu
->
ıuEv’tRemoveLi¡
.
	`push
(
this
);

203 
	}
}

208 
	gInOrd”CPU
::
CPUEv’t
::
	$desütiÚ
() const

211 
	}
}

214 
	gInOrd”CPU
::
CPUEv’t
::
	$scheduËEv’t
(
Cyşes
 
d–ay
)

216 
	`as£¹
(!
	`scheduËd
(è|| 
	`squashed
());

217 
ıu
->
	`»scheduË
(
this
, cpu->
	`şockEdge
(
d–ay
), 
Œue
);

218 
	}
}

221 
	gInOrd”CPU
::
CPUEv’t
::
	$unscheduËEv’t
()

223 ià(
	`scheduËd
())

224 
	`squash
();

225 
	}
}

227 
	gInOrd”CPU
::
	$InOrd”CPU
(
P¬ams
 *
·¿ms
)

228 : 
	`Ba£CPU
(
·¿ms
),

229 
	`ıu_id
(
·¿ms
->
ıu_id
),

230 
	`cÜeTy³
("default"),

231 
	`_¡©us
(
IdË
),

232 
	`tickEv’t
(
this
),

233 
	`¡ageWidth
(
·¿ms
->
¡ageWidth
),

234 
	`»sPoŞ
(
Ãw
 
	`ResourûPoŞ
(
this
, 
·¿ms
)),

235 
	`i§
(
numTh»ads
, 
NULL
),

236 
	`timeBufãr
(2 , 2),

237 
	`d©aPÜt
(
»sPoŞ
->
	`g‘D©aUn™
(), ".dcache_port"),

238 
	`š¡PÜt
(
»sPoŞ
->
	`g‘In¡Un™
(), ".icache_port"),

239 
	`»moveIn¡sThisCyşe
(
çl£
),

240 
	`aùiv™yRec
(
·¿ms
->
Çme
, 
NumSges
, 10,…¬ams->
aùiv™y
),

241 
	`sy¡em
(
·¿ms
->
sy¡em
),

242 #ifdeà
DEBUG


243 
	`ıuEv’tNum
(0),

244 
	`»sReqCouÁ
(0),

246 
	`d¿šCouÁ
(0),

247 
	`¡ageT¿cšg
(
·¿ms
->
¡ageT¿cšg
),

248 
	`Ï¡RuÂšgCyşe
(0),

249 
	$š¡sP”Sw™ch
(0)

251 
ıu_·¿ms
 = 
·¿ms
;

254 
th»ad
.
	`»size
(
numTh»ads
);

256 
Th»adID
 
aùive_th»ads
 = 
·¿ms
->
wÜklßd
.
	`size
();

257 ià(
FuÎSy¡em
) {

258 
aùive_th»ads
 = 1;

260 
aùive_th»ads
 = 
·¿ms
->
wÜklßd
.
	`size
();

262 ià(
aùive_th»ads
 > 
MaxTh»ads
) {

263 
	`·nic
("Workload Sizeoo†arge. Increasehe 'MaxThreads'"

269 ià(
aùive_th»ads
 > 1) {

270 
th»adMod–
 = (
InOrd”CPU
::
Th»adMod–
è
·¿ms
->threadModel;

272 ià(
th»adMod–
 =ğ
SMT
) {

273 
	`DPRINTF
(
InOrd”CPU
, "Setting Thread Modelo SMT.\n");

274 } ià(
th»adMod–
 =ğ
Sw™chOnCacheMiss
) {

275 
	`DPRINTF
(
InOrd”CPU
, "Setting Thread Modelo "

280 
th»adMod–
 = 
SšgË
;

284 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

285 
i§
[
tid
] = 
·¿ms
->isa[tid];

286 
pc
[
tid
].
	`£t
(0);

287 
Ï¡Comm™‹dPC
[
tid
].
	`£t
(0);

289 ià(
FuÎSy¡em
) {

291 
	`as£¹
(
numTh»ads
 == 1);

292 
th»ad
[
tid
] = 
Ãw
 
	`Th»ad
(
this
, 0, 
NULL
);

294 ià(
tid
 < (
Th»adID
)
·¿ms
->
wÜklßd
.
	`size
()) {

295 
	`DPRINTF
(
InOrd”CPU
, "Workload[%i]…rocess is %#x\n",

296 
tid
, 
·¿ms
->
wÜklßd
[tid]->
	`´ogName
());

297 
th»ad
[
tid
] =

298 
Ãw
 
	`Th»ad
(
this
, 
tid
, 
·¿ms
->
wÜklßd
[tid]);

302 
Proûss
* 
dummy_´oc
 = 
·¿ms
->
wÜklßd
[0];

303 
th»ad
[
tid
] = 
Ãw
 
	`Th»ad
(
this
,id, 
dummy_´oc
);

307 
asid
[
tid
] =id;

311 
InOrd”Th»adCÚ‹xt
 *
tc
 = 
Ãw
 InOrderThreadContext;

312 
tc
->
ıu
 = 
this
;

313 
tc
->
th»ad
 =h»ad[
tid
];

316 
this
->
th»ad
[
tid
]->
qu›sûEv’t
 = 
Ãw
 
	`EndQu›sûEv’t
(
tc
);

319 
th»ad
[
tid
]->
tc
 =c;

320 
th»ad
[
tid
]->
	`£tFuncExeIn¡
(0);

321 
glob®SeqNum
[
tid
] = 1;

324 
this
->
th»adCÚ‹xts
.
	`push_back
(
tc
);

328 
¡Num
=0; stNum < 
NumSges
 - 1; stNum++) {

329 
¡ageQueue
[
¡Num
] = 
Ãw
 
	`SgeQueue
(
NumSges
, NumStages);

330 
¡ageQueue
[
¡Num
]->
	`id
(stNum);

335 
¡Num
=0; stNum < 
NumSges
; stNum++) {

336 ià(
¡Num
 == 0)

337 
p–šeSge
[
¡Num
] = 
Ãw
 
	`Fœ¡Sge
(
·¿ms
, stNum);

339 
p–šeSge
[
¡Num
] = 
Ãw
 
	`P–šeSge
(
·¿ms
, stNum);

341 
p–šeSge
[
¡Num
]->
	`£tCPU
(
this
);

342 
p–šeSge
[
¡Num
]->
	`£tAùiveTh»ads
(&
aùiveTh»ads
);

343 
p–šeSge
[
¡Num
]->
	`£tTimeBufãr
(&
timeBufãr
);

346 ià(
¡Num
 > 0)

347 
p–šeSge
[
¡Num
]->
	`£tP»vSgeQueue
(
¡ageQueue
[stNum - 1]);

348 ià(
¡Num
 < 
NumSges
 - 1)

349 
p–šeSge
[
¡Num
]->
	`£tNextSgeQueue
(
¡ageQueue
[stNum]);

353 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

354 
¬chRegD•M­
[
tid
].
	`£tCPU
(
this
);

356 
nÚS³cIn¡Aùive
[
tid
] = 
çl£
;

357 
nÚS³cSeqNum
[
tid
] = 0;

359 
squashSeqNum
[
tid
] = 
MaxAddr
;

360 
Ï¡SquashCyşe
[
tid
] = 0;

362 
	`mem£t
(
štRegs
[
tid
], 0, (intRegs[tid]));

363 
	`mem£t
(
æßtRegs
.
i
[
tid
], 0, (floatRegs.i[tid]));

364 #ifdeà
ISA_HAS_CC_REGS


365 
	`mem£t
(
ccRegs
[
tid
], 0, (ccRegs[tid]));

367 
i§
[
tid
]->
	`ş—r
();

370 
dummyIn¡
[
tid
] = 
Ãw
 
	`InOrd”DynIn¡
(
this
,

371 
th»ad
[
tid
],

373 
tid
,

374 
asid
[
tid
]);

376 
dummyReq
[
tid
] = 
Ãw
 
	`ResourûReque¡
(
»sPoŞ
->
	`g‘Resourû
(0));

379 ià(
FuÎSy¡em
) {

382 
dummyT¿pIn¡
[
tid
] = 
Ãw
 
	`InOrd”DynIn¡
(
this
, 
NULL
, 0, 0, 0);

383 
dummyT¿pIn¡
[
tid
]->
£qNum
 = 0;

384 
dummyT¿pIn¡
[
tid
]->
squashSeqNum
 = 0;

385 
dummyT¿pIn¡
[
tid
]->
	`£tTid
(tid);

388 
Œ­P’dšg
[
tid
] = 
çl£
;

393 ià(!
·¿ms
->
sw™ched_out
 && !
š‹¼u±s
) {

394 
	`çl
("InOrderCPU %s has‚o interrupt controller.\n"

395 "Ensu» c»©eIÁ”ru±CÚŒŞËr(èi ÿÎed.\n", 
	`Çme
());

398 
dummyReqIn¡
 = 
Ãw
 
	`InOrd”DynIn¡
(
this
, 
NULL
, 0, 0, 0);

399 
dummyReqIn¡
->
	`£tSquashed
();

400 
dummyReqIn¡
->
	`»£tIn¡CouÁ
();

402 
dummyBufãrIn¡
 = 
Ãw
 
	`InOrd”DynIn¡
(
this
, 
NULL
, 0, 0, 0);

403 
dummyBufãrIn¡
->
	`£tSquashed
();

404 
dummyBufãrIn¡
->
	`»£tIn¡CouÁ
();

406 
’dOfSkedIt
 = 
skedCache
.
	`’d
();

407 
äÚtEndSked
 = 
	`ü—‹FrÚtEndSked
();

408 
çuÉSked
 = 
	`ü—‹FauÉSked
();

410 
Ï¡RuÂšgCyşe
 = 
	`curCyşe
();

412 
lockAddr
 = 0;

413 
lockFÏg
 = 
çl£
;

416 
	`scheduËTickEv’t
(
	`Cyşes
(0));

417 
	}
}

419 
	gInOrd”CPU
::~
	$InOrd”CPU
()

421 
d–‘e
 
»sPoŞ
;

423 
SkedCacheIt
 
sked_™
 = 
skedCache
.
	`begš
();

424 
SkedCacheIt
 
sked_’d
 = 
skedCache
.
	`’d
();

426 
sked_™
 !ğ
sked_’d
) {

427 
	`d–‘e
 (*
sked_™
).
£cÚd
;

428 
sked_™
++;

430 
skedCache
.
	`ş—r
();

431 
	}
}

433 
	gm5
::
hash_m­
<
InOrd”CPU
::
SkedID
, 
	gTheP–še
::
RSkedPŒ
> InOrd”CPU::
skedCache
;

435 
RSkedPŒ


436 
	gInOrd”CPU
::
	$ü—‹FrÚtEndSked
()

438 
RSkedPŒ
 
»s_sked
 = 
Ãw
 
	`ResourûSked
();

439 
¡age_num
 = 0;

440 
SgeScheduËr
 
	`F
(
»s_sked
, 
¡age_num
++);

441 
SgeScheduËr
 
	`D
(
»s_sked
, 
¡age_num
++);

444 
F
.
	`Ãeds
(
F‘chSeq
, 
F‘chSeqUn™
::
AssignNextPC
);

445 
F
.
	`Ãeds
(
ICache
, 
F‘chUn™
::
In™Ÿ‹F‘ch
);

448 
D
.
	`Ãeds
(
ICache
, 
F‘chUn™
::
Com¶‘eF‘ch
);

449 
D
.
	`Ãeds
(
Decode
, 
DecodeUn™
::
DecodeIn¡
);

450 
D
.
	`Ãeds
(
BP»d
, 
B¿nchP»diùÜ
::
P»diùB¿nch
);

451 
D
.
	`Ãeds
(
F‘chSeq
, 
F‘chSeqUn™
::
Upd©eT¬g‘PC
);

454 
	`DPRINTF
(
SkedCache
, "Resource Sked created for instruction Front End\n");

456  
»s_sked
;

457 
	}
}

459 
RSkedPŒ


460 
	gInOrd”CPU
::
	$ü—‹FauÉSked
()

462 
RSkedPŒ
 
»s_sked
 = 
Ãw
 
	`ResourûSked
();

463 
SgeScheduËr
 
	`W
(
»s_sked
, 
NumSges
 - 1);

464 
W
.
	`Ãeds
(
G¿d
, 
G¿du©iÚUn™
::
CheckFauÉ
);

465 
	`DPRINTF
(
SkedCache
, "Resource Sked created for instruction Faults\n");

466  
»s_sked
;

467 
	}
}

469 
RSkedPŒ


470 
	gInOrd”CPU
::
	$ü—‹BackEndSked
(
DynIn¡PŒ
 
š¡
)

472 
RSkedPŒ
 
»s_sked
 = 
	`lookupSked
(
š¡
);

473 ià(
»s_sked
 !ğ
NULL
) {

474 
	`DPRINTF
(
SkedCache
, "Found %s in sked cache.\n",

475 
š¡
->
	`š¡Name
());

476  
»s_sked
;

478 
»s_sked
 = 
Ãw
 
	`ResourûSked
();

481 
¡age_num
 = 
TheP–še
::
BackEndS¹Sge
;

482 
SgeScheduËr
 
	`X
(
»s_sked
, 
¡age_num
++);

483 
SgeScheduËr
 
	`M
(
»s_sked
, 
¡age_num
++);

484 
SgeScheduËr
 
	`W
(
»s_sked
, 
¡age_num
++);

486 ià(!
š¡
->
¡©icIn¡
) {

487 
	`w¬n_Úû
("Static Instruction Object Not Set. Can't Create"

489  
NULL
;

493 
X
.
	`Ãeds
(
RegMªag”
, 
U£DefUn™
::
M¬kDe¡Regs
);

494 
idx
=0; idx < 
š¡
->
	`numSrcRegs
(); idx++) {

495 ià(!
idx
 || !
š¡
->
	`isStÜe
()) {

496 
X
.
	`Ãeds
(
RegMªag”
, 
U£DefUn™
::
R—dSrcReg
, 
idx
);

502 iàĞ
š¡
->
	`isNÚS³cuÏtive
() ) {

504 } iàĞ
š¡
->
	`isMemRef
() ) {

505 iàĞ
š¡
->
	`isLßd
() ) {

506 
X
.
	`Ãeds
(
AGEN
, 
AGENUn™
::
G’”©eAddr
);

508 } ià(
š¡
->
	`İCÏss
(è=ğ
IÁMuÉOp
 || in¡->İCÏss(è=ğ
IÁDivOp
) {

509 
X
.
	`Ãeds
(
MDU
, 
MuÉDivUn™
::
S¹MuÉDiv
);

511 
X
.
	`Ãeds
(
ExecUn™
, 
ExecutiÚUn™
::
Execu‹In¡
);

515 ià(!
š¡
->
	`isNÚS³cuÏtive
()) {

516 ià(
š¡
->
	`İCÏss
(è=ğ
IÁMuÉOp
 || in¡->İCÏss(è=ğ
IÁDivOp
) {

517 
M
.
	`Ãeds
(
MDU
, 
MuÉDivUn™
::
EndMuÉDiv
);

520 iàĞ
š¡
->
	`isLßd
() ) {

521 
M
.
	`Ãeds
(
DCache
, 
CacheUn™
::
In™Ÿ‹R—dD©a
);

522 ià(
š¡
->
¥l™In¡
)

523 
M
.
	`Ãeds
(
DCache
, 
CacheUn™
::
In™SecÚdS¶™R—d
);

524 } iàĞ
š¡
->
	`isStÜe
() ) {

525 
i
 = 1; i < 
š¡
->
	`numSrcRegs
(); i++ ) {

526 
M
.
	`Ãeds
(
RegMªag”
, 
U£DefUn™
::
R—dSrcReg
, 
i
);

528 
M
.
	`Ãeds
(
AGEN
, 
AGENUn™
::
G’”©eAddr
);

529 
M
.
	`Ãeds
(
DCache
, 
CacheUn™
::
In™Ÿ‹Wr™eD©a
);

530 ià(
š¡
->
¥l™In¡
)

531 
M
.
	`Ãeds
(
DCache
, 
CacheUn™
::
In™SecÚdS¶™Wr™e
);

536 ià(!
š¡
->
	`isNÚS³cuÏtive
()) {

537 iàĞ
š¡
->
	`isLßd
() ) {

538 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
Com¶‘eR—dD©a
);

539 ià(
š¡
->
¥l™In¡
)

540 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
Com¶‘eSecÚdS¶™R—d
);

541 } iàĞ
š¡
->
	`isStÜe
() ) {

542 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
Com¶‘eWr™eD©a
);

543 ià(
š¡
->
¥l™In¡
)

544 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
Com¶‘eSecÚdS¶™Wr™e
);

548 ià(
š¡
->
	`isMemRef
()) {

549 ià(
š¡
->
	`isLßd
()) {

550 
W
.
	`Ãeds
(
AGEN
, 
AGENUn™
::
G’”©eAddr
);

551 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
In™Ÿ‹R—dD©a
);

552 ià(
š¡
->
¥l™In¡
)

553 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
In™SecÚdS¶™R—d
);

554 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
Com¶‘eR—dD©a
);

555 ià(
š¡
->
¥l™In¡
)

556 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
Com¶‘eSecÚdS¶™R—d
);

557 } ià(
š¡
->
	`isStÜe
()) {

558 iàĞ
š¡
->
	`numSrcRegs
() >= 2 ) {

559 
W
.
	`Ãeds
(
RegMªag”
, 
U£DefUn™
::
R—dSrcReg
, 1);

561 
W
.
	`Ãeds
(
AGEN
, 
AGENUn™
::
G’”©eAddr
);

562 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
In™Ÿ‹Wr™eD©a
);

563 ià(
š¡
->
¥l™In¡
)

564 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
In™SecÚdS¶™Wr™e
);

565 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
Com¶‘eWr™eD©a
);

566 ià(
š¡
->
¥l™In¡
)

567 
W
.
	`Ãeds
(
DCache
, 
CacheUn™
::
Com¶‘eSecÚdS¶™Wr™e
);

570 
W
.
	`Ãeds
(
ExecUn™
, 
ExecutiÚUn™
::
Execu‹In¡
);

574 
W
.
	`Ãeds
(
G¿d
, 
G¿du©iÚUn™
::
CheckFauÉ
);

576 
idx
=0; idx < 
š¡
->
	`numDe¡Regs
(); idx++) {

577 
W
.
	`Ãeds
(
RegMªag”
, 
U£DefUn™
::
Wr™eDe¡Reg
, 
idx
);

580 ià(
š¡
->
	`isCÚŒŞ
())

581 
W
.
	`Ãeds
(
BP»d
, 
B¿nchP»diùÜ
::
Upd©eP»diùÜ
);

583 
W
.
	`Ãeds
(
G¿d
, 
G¿du©iÚUn™
::
G¿du©eIn¡
);

587 
	`addToSkedCache
(
š¡
, 
»s_sked
);

589 
	`DPRINTF
(
SkedCache
, "Back End Sked Created for instruction: %s (%08p)\n",

590 
š¡
->
	`š¡Name
(), in¡->
	`g‘MachIn¡
());

591 
»s_sked
->
	`´št
();

593  
»s_sked
;

594 
	}
}

597 
	gInOrd”CPU
::
	$»gSts
()

600 
»sPoŞ
->
	`»gSts
();

603 
¡age_num
=0; sge_num < 
TheP–še
::
NumSges
; stage_num++) {

604 
p–šeSge
[
¡age_num
]->
	`»gSts
();

608 
š¡sP”CtxtSw™ch


609 .
	`Çme
(name() + ".instsPerContextSwitch")

610 .
	`desc
("Instructions Committed Per Context Switch")

611 .
	`´”eq
(
š¡sP”CtxtSw™ch
);

613 
numCtxtSw™ches


614 .
	`Çme
(name() + ".contextSwitches")

615 .
	`desc
("Number of context switches");

617 
comLßds


618 .
	`Çme
(name() + ".comLoads")

619 .
	`desc
("Number of Load instructions committed");

621 
comStÜes


622 .
	`Çme
(name() + ".comStores")

623 .
	`desc
("Number of Store instructions committed");

625 
comB¿nches


626 .
	`Çme
(name() + ".comBranches")

627 .
	`desc
("Number of Branches instructions committed");

629 
comNİs


630 .
	`Çme
(name() + ".comNops")

631 .
	`desc
("Number of Nop instructions committed");

633 
comNÚS³c


634 .
	`Çme
(name() + ".comNonSpec")

635 .
	`desc
("Number of Non-Speculative instructions committed");

637 
comIÁs


638 .
	`Çme
(name() + ".comInts")

639 .
	`desc
("Number of Integer instructions committed");

641 
comFlßts


642 .
	`Çme
(name() + ".comFloats")

643 .
	`desc
("Number of Floating Point instructions committed");

645 
timesIdËd


646 .
	`Çme
(name() + ".timesIdled")

647 .
	`desc
("Number ofimeshatheƒntire CPU went into‡n idle state‡nd"

649 .
	`´”eq
(
timesIdËd
);

651 
idËCyşes


652 .
	`Çme
(name() + ".idleCycles")

653 .
	`desc
("Number of cycles cpu's stages were‚ot…rocessed");

655 
runCyşes


656 .
	`Çme
(name() + ".runCycles")

657 .
	`desc
("Number of cycles cpu stages‡re…rocessed.");

659 
aùiv™y


660 .
	`Çme
(name() + ".activity")

661 .
	`desc
("Percentage of cycles cpu is‡ctive")

662 .
	`´ecisiÚ
(6);

663 
aùiv™y
 = (
runCyşes
 / 
numCyşes
) * 100;

665 
th»adCyşes


666 .
	`š™
(
numTh»ads
)

667 .
	`Çme
(name() + ".threadCycles")

668 .
	`desc
("Total Number of Cycles A Thread Was Active in CPU (Per-Thread)");

670 
smtCyşes


671 .
	`Çme
(name() + ".smtCycles")

672 .
	`desc
("Total‚umber of cycleshathe CPU was in SMT-mode");

674 
comm™‹dIn¡s


675 .
	`š™
(
numTh»ads
)

676 .
	`Çme
(name() + ".committedInsts")

677 .
	`desc
("Number of Instructions committed (Per-Thread)");

679 
comm™‹dOps


680 .
	`š™
(
numTh»ads
)

681 .
	`Çme
(name() + ".committedOps")

682 .
	`desc
("Number of Ops committed (Per-Thread)");

684 
smtComm™‹dIn¡s


685 .
	`š™
(
numTh»ads
)

686 .
	`Çme
(name() + ".smtCommittedInsts")

687 .
	`desc
("Number of SMT Instructions committed (Per-Thread)");

689 
tÙ®Comm™‹dIn¡s


690 .
	`Çme
(name() + ".committedInsts_total")

691 .
	`desc
("Number of Instructions committed (Total)");

693 
ıi


694 .
	`Çme
(name() + ".cpi")

695 .
	`desc
("CPI: Cycles Per Instruction (Per-Thread)")

696 .
	`´ecisiÚ
(6);

697 
ıi
 = 
numCyşes
 / 
comm™‹dIn¡s
;

699 
smtCpi


700 .
	`Çme
(name() + ".smt_cpi")

701 .
	`desc
("CPI: Total SMT-CPI")

702 .
	`´ecisiÚ
(6);

703 
smtCpi
 = 
smtCyşes
 / 
smtComm™‹dIn¡s
;

705 
tÙ®Cpi


706 .
	`Çme
(name() + ".cpi_total")

707 .
	`desc
("CPI: Total CPI of All Threads")

708 .
	`´ecisiÚ
(6);

709 
tÙ®Cpi
 = 
numCyşes
 / 
tÙ®Comm™‹dIn¡s
;

711 
c


712 .
	`Çme
(name() + ".ipc")

713 .
	`desc
("IPC: Instructions Per Cycle (Per-Thread)")

714 .
	`´ecisiÚ
(6);

715 
c
 = 
comm™‹dIn¡s
 / 
numCyşes
;

717 
smtIpc


718 .
	`Çme
(name() + ".smt_ipc")

719 .
	`desc
("IPC: Total SMT-IPC")

720 .
	`´ecisiÚ
(6);

721 
smtIpc
 = 
smtComm™‹dIn¡s
 / 
smtCyşes
;

723 
tÙ®Ipc


724 .
	`Çme
(name() + ".ipc_total")

725 .
	`desc
("IPC: Total IPC of All Threads")

726 .
	`´ecisiÚ
(6);

727 
tÙ®Ipc
 = 
tÙ®Comm™‹dIn¡s
 / 
numCyşes
;

729 
Ba£CPU
::
	`»gSts
();

730 
	}
}

734 
	gInOrd”CPU
::
	$tick
()

736 
	`DPRINTF
(
InOrd”CPU
, "\n\nInOrderCPU: Ticking main, InOrderCPU.\n");

738 ++
numCyşes
;

740 
	`checkFÜIÁ”ru±s
();

742 
boŞ
 
pes_idË
 = 
Œue
;

744 
¡Num
=
NumSges
 - 1; stNum >= 0 ; stNum--) {

745 
p–šeSge
[
¡Num
]->
	`tick
();

747 
pes_idË
 =…es_idË && 
p–šeSge
[
¡Num
]->
idË
;

750 ià(
pes_idË
)

751 
idËCyşes
++;

753 
runCyşes
++;

756 
timeBufãr
.
	`advªû
();

757 
sqNum
=0; sqNum < 
NumSges
 - 1; sqNum++) {

758 
¡ageQueue
[
sqNum
]->
	`advªû
();

760 
aùiv™yRec
.
	`advªû
();

763 
	`ş—nUpRemovedEv’ts
();

764 
	`ş—nUpRemovedIn¡s
();

767 ià(!
tickEv’t
.
	`scheduËd
()) {

768 ià(
_¡©us
 =ğ
Sw™chedOut
) {

770 
Ï¡RuÂšgCyşe
 = 
	`curCyşe
();

771 } ià(!
aùiv™yRec
.
	`aùive
()) {

772 
	`DPRINTF
(
InOrd”CPU
, "sleeping CPU.\n");

773 
Ï¡RuÂšgCyşe
 = 
	`curCyşe
();

774 
timesIdËd
++;

778 
	`scheduË
(&
tickEv’t
, 
	`şockEdge
(
	`Cyşes
(1)));

779 
	`DPRINTF
(
InOrd”CPU
, "Scheduled CPU for‚extick @ %i.\n",

780 
	`şockEdge
(
	`Cyşes
(1)));

784 
	`tickTh»adSts
();

785 
	`upd©eTh»adPriÜ™y
();

786 
	}
}

790 
	gInOrd”CPU
::
	$š™
()

792 
Ba£CPU
::
	`š™
();

794 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

797 
th»ad
[
tid
]->
noSquashFromTC
 = 
Œue
;

799 
th»ad
[
tid
]->
	`š™MemProx›s
Ñh»ad[tid]->
	`g‘TC
());

802 ià(
FuÎSy¡em
 && !
	`·¿ms
()->
sw™ched_out
) {

803 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

804 
Th»adCÚ‹xt
 *
¤c_tc
 = 
th»adCÚ‹xts
[
tid
];

805 
TheISA
::
	`š™CPU
(
¤c_tc
, src_tc->
	`cÚ‹xtId
());

810 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid)

811 
th»ad
[
tid
]->
noSquashFromTC
 = 
çl£
;

814 
»sPoŞ
->
	`š™
();

815 
	}
}

818 
	gInOrd”CPU
::
	$v”ifyMemÜyMode
() const

820 ià(!
sy¡em
->
	`isTimšgMode
()) {

821 
	`çl
("The in-order CPU„equireshe memory systemo be in "

824 
	}
}

826 
FauÉ


827 
	gInOrd”CPU
::
	$hw»i
(
Th»adID
 
tid
)

829 #ià
THE_ISA
 =ğ
ALPHA_ISA


831 
	`£tMiscRegNoEfãù
(
AÍhaISA
::
MISCREG_LOCKFLAG
, 
çl£
, 
tid
);

833 
th»ad
[
tid
]->
k”ÃlSts
->
	`hw»i
();

837  
NoFauÉ
;

838 
	}
}

841 
boŞ


842 
	gInOrd”CPU
::
	$simP®Check
(
·lFunc
, 
Th»adID
 
tid
)

844 #ià
THE_ISA
 =ğ
ALPHA_ISA


845 ià(
this
->
th»ad
[
tid
]->
k”ÃlSts
)

846 
this
->
th»ad
[
tid
]->
k”ÃlSts
->
	`ÿÎ·l
(
·lFunc
,

847 
this
->
th»adCÚ‹xts
[
tid
]);

849 
·lFunc
) {

850 
PAL
::
h®t
:

851 
	`h®t
();

852 ià(--
Sy¡em
::
numSy¡emsRuÂšg
 == 0)

853 
	`ex™SimLoİ
("all cpus halted");

856 
PAL
::
b±
:

857 
PAL
::
bugchk
:

858 ià(
this
->
sy¡em
->
	`b»akpošt
())

859  
çl£
;

863  
Œue
;

864 
	}
}

867 
	gInOrd”CPU
::
	$checkFÜIÁ”ru±s
()

869 
i
 = 0; i < 
th»adCÚ‹xts
.
	`size
(); i++) {

870 
Th»adCÚ‹xt
 *
tc
 = 
th»adCÚ‹xts
[
i
];

872 ià(
š‹¼u±s
->
	`checkIÁ”ru±s
(
tc
)) {

873 
FauÉ
 
š‹¼u±
 = 
š‹¼u±s
->
	`g‘IÁ”ru±
(
tc
);

875 ià(
š‹¼u±
 !ğ
NoFauÉ
) {

876 
	`DPRINTF
(
IÁ”ru±
, "Processing Intterupt for [tid:%i].\n",

877 
tc
->
	`th»adId
());

879 
Th»adID
 
tid
 = 
tc
->
	`th»adId
();

880 
š‹¼u±s
->
	`upd©eIÁrInfo
(
tc
);

883 
Ï¡_¡age
 = 
NumSges
 - 1;

884 
dummyT¿pIn¡
[
tid
]->
squashšgSge
 = 
Ï¡_¡age
;

885 
p–šeSge
[
Ï¡_¡age
]->
	`£tupSquash
(
dummyT¿pIn¡
[
tid
],

886 
tid
);

889 
p–šeSge
[
BackEndS¹Sge
 - 1]->
	`£tupSquash
(
dummyT¿pIn¡
[
tid
],

890 
tid
);

893 
»sPoŞ
->
	`scheduËEv’t
(

894 (
InOrd”CPU
::
CPUEv’tTy³
)
ResourûPoŞ
::
SquashAÎ
,

895 
dummyT¿pIn¡
[
tid
], 
	`Cyşes
(0));

898 
	`Œ­CÚ‹xt
(
š‹¼u±
, 
tid
, 
dummyT¿pIn¡
[tid]);

902 
	}
}

904 
FauÉ


905 
	gInOrd”CPU
::
	$g‘IÁ”ru±s
()

908  
š‹¼u±s
->
	`g‘IÁ”ru±
(
th»adCÚ‹xts
[0]);

909 
	}
}

912 
	gInOrd”CPU
::
	$´oûssIÁ”ru±s
(
FauÉ
 
š‹¼u±
)

920 
	`as£¹
(
š‹¼u±
 !ğ
NoFauÉ
);

921 
š‹¼u±s
->
	`upd©eIÁrInfo
(
th»adCÚ‹xts
[0]);

923 
	`DPRINTF
(
InOrd”CPU
, "IÁ”ru± % bešg hªdËd\n", 
š‹¼u±
->
	`Çme
());

926 
	`Œ­
(
š‹¼u±
, 
th»adCÚ‹xts
[0]->
	`cÚ‹xtId
(), 
dummyBufãrIn¡
);

927 
	}
}

930 
	gInOrd”CPU
::
	$Œ­CÚ‹xt
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
,

931 
Cyşes
 
d–ay
)

933 
	`scheduËCpuEv’t
(
T¿p
, 
çuÉ
, 
tid
, 
š¡
, 
d–ay
);

934 
Œ­P’dšg
[
tid
] = 
Œue
;

935 
	}
}

938 
	gInOrd”CPU
::
	$Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
)

940 
çuÉ
->
	`švoke
(
	`tcBa£
(
tid
), 
š¡
->
¡©icIn¡
);

941 
	`»moveP–šeSÎs
(
tid
);

942 
	}
}

945 
	gInOrd”CPU
::
	$squashFromMemSÎ
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
,

946 
Cyşes
 
d–ay
)

948 
	`scheduËCpuEv’t
(
SquashFromMemSÎ
, 
NoFauÉ
, 
tid
, 
š¡
, 
d–ay
);

949 
	}
}

953 
	gInOrd”CPU
::
	$squashDueToMemSÎ
(
¡age_num
, 
In¡SeqNum
 
£q_num
,

954 
Th»adID
 
tid
)

956 
	`DPRINTF
(
InOrd”CPU
, "Squashing Pipeline Stages Dueo Memory Stall...\n");

964 
In¡SeqNum
 
squash_£q_num
 = 
£q_num
 - 1;

966 
¡Num
=
¡age_num
; stNum >= 0 ; stNum--) {

967 
p–šeSge
[
¡Num
]->
	`squashDueToMemSÎ
(
squash_£q_num
, 
tid
);

969 
	}
}

972 
	gInOrd”CPU
::
	$scheduËCpuEv’t
(
CPUEv’tTy³
 
c_ev’t
, 
FauÉ
 
çuÉ
,

973 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
,

974 
Cyşes
 
d–ay
, 
CPUEv’tPri
 
ev’t_´i
)

976 
CPUEv’t
 *
ıu_ev’t
 = 
Ãw
 
	`CPUEv’t
(
this
, 
c_ev’t
, 
çuÉ
, 
tid
, 
š¡
,

977 
ev’t_´i
);

979 
Tick
 
sked_tick
 = 
	`şockEdge
(
d–ay
);

980 
	`DPRINTF
(
InOrd”CPU
, "Scheduling CPU Event (%s) for cycle %i, [tid:%i].\n",

981 
ev’tNames
[
c_ev’t
], 
	`curTick
(è+ 
d–ay
, 
tid
);

982 
	`scheduË
(
ıu_ev’t
, 
sked_tick
);

986 
š¡
->
	`£tTid
(
tid
);

988 
»sPoŞ
->
	`scheduËEv’t
(
c_ev’t
, 
š¡
, 
	`Cyşes
(0), 0, 
tid
);

989 
	}
}

991 
boŞ


992 
	gInOrd”CPU
::
	$isTh»adAùive
(
Th»adID
 
tid
)

994 
li¡
<
Th»adID
>::
™”©Ü
 
isAùive
 =

995 
¡d
::
	`fšd
(
aùiveTh»ads
.
	`begš
(),‡ùiveTh»ads.
	`’d
(), 
tid
);

997  (
isAùive
 !ğ
aùiveTh»ads
.
	`’d
());

998 
	}
}

1000 
boŞ


1001 
	gInOrd”CPU
::
	$isTh»adR—dy
(
Th»adID
 
tid
)

1003 
li¡
<
Th»adID
>::
™”©Ü
 
isR—dy
 =

1004 
¡d
::
	`fšd
(
»adyTh»ads
.
	`begš
(),„—dyTh»ads.
	`’d
(), 
tid
);

1006  (
isR—dy
 !ğ
»adyTh»ads
.
	`’d
());

1007 
	}
}

1009 
boŞ


1010 
	gInOrd”CPU
::
	$isTh»adSu¥’ded
(
Th»adID
 
tid
)

1012 
li¡
<
Th»adID
>::
™”©Ü
 
isSu¥’ded
 =

1013 
¡d
::
	`fšd
(
su¥’dedTh»ads
.
	`begš
(), su¥’dedTh»ads.
	`’d
(), 
tid
);

1015  (
isSu¥’ded
 !ğ
su¥’dedTh»ads
.
	`’d
());

1016 
	}
}

1019 
	gInOrd”CPU
::
	$aùiv©eNextR—dyTh»ad
()

1021 ià(
»adyTh»ads
.
	`size
() >= 1) {

1022 
Th»adID
 
»ady_tid
 = 
»adyTh»ads
.
	`äÚt
();

1025 
	`aùiv©eTh»ad
(
»ady_tid
);

1028 
»sPoŞ
->
	`aùiv©eTh»ad
(
»ady_tid
);

1030 
li¡
<
Th»adID
>::
™”©Ü
 
»ady_™
 =

1031 
¡d
::
	`fšd
(
»adyTh»ads
.
	`begš
(),„—dyTh»ads.
	`’d
(), 
»ady_tid
);

1032 
»adyTh»ads
.
	`”a£
(
»ady_™
);

1034 
	`DPRINTF
(
InOrd”CPU
,

1037 
	`DPRINTF
(
InOrd”CPU
,

1040 
	}
}

1043 
	gInOrd”CPU
::
	$aùiv©eTh»ad
(
Th»adID
 
tid
)

1045 ià(
	`isTh»adSu¥’ded
(
tid
)) {

1046 
	`DPRINTF
(
InOrd”CPU
,

1047 "Removšg [tid:%i] from su¥’dedh»ad li¡.\n", 
tid
);

1049 
li¡
<
Th»adID
>::
™”©Ü
 
su¥_™
 =

1050 
¡d
::
	`fšd
(
su¥’dedTh»ads
.
	`begš
(), su¥’dedTh»ads.
	`’d
(),

1051 
tid
);

1052 
su¥’dedTh»ads
.
	`”a£
(
su¥_™
);

1055 ià(
th»adMod–
 =ğ
Sw™chOnCacheMiss
 &&

1056 
	`numAùiveTh»ads
() == 1) {

1057 
	`DPRINTF
(
InOrd”CPU
,

1059 "®»ady„uÂšg.\n", 
tid
, 
	`aùiveTh»adId
());

1061 
	`DPRINTF
(
InOrd”CPU
,"Placing [tid:%i] on„eadyhreads†ist\n",

1062 
tid
);

1064 
»adyTh»ads
.
	`push_back
(
tid
);

1066 } ià(!
	`isTh»adAùive
(
tid
)) {

1067 
	`DPRINTF
(
InOrd”CPU
,

1068 "Addšg [tid:%i]Øaùivth»ad li¡.\n", 
tid
);

1069 
aùiveTh»ads
.
	`push_back
(
tid
);

1071 
	`aùiv©eTh»adInP–še
(
tid
);

1073 
th»ad
[
tid
]->
Ï¡Aùiv©e
 = 
	`curTick
();

1075 
	`tcBa£
(
tid
)->
	`£tStus
(
Th»adCÚ‹xt
::
Aùive
);

1077 
	`wakeCPU
();

1079 
numCtxtSw™ches
++;

1081 
	}
}

1084 
	gInOrd”CPU
::
	$aùiv©eTh»adInP–še
(
Th»adID
 
tid
)

1086 
¡Num
=0; stNum < 
NumSges
; stNum++) {

1087 
p–šeSge
[
¡Num
]->
	`aùiv©eTh»ad
(
tid
);

1089 
	}
}

1092 
	gInOrd”CPU
::
	$d—ùiv©eCÚ‹xt
(
Th»adID
 
tid
, 
Cyşes
 
d–ay
)

1094 
	`DPRINTF
(
InOrd”CPU
,"[tid:%i]: D—ùiv©šg ...\n", 
tid
);

1096 
	`scheduËCpuEv’t
(
D—ùiv©eTh»ad
, 
NoFauÉ
, 
tid
, 
dummyIn¡
[tid], 
d–ay
);

1100 
aùiv™yRec
.
	`aùiv™y
();

1102 
_¡©us
 = 
RuÂšg
;

1103 
	}
}

1106 
	gInOrd”CPU
::
	$d—ùiv©eTh»ad
(
Th»adID
 
tid
)

1108 
	`DPRINTF
(
InOrd”CPU
, "[tid:%i]: C®lšg d—ùiv©th»ad.\n", 
tid
);

1110 ià(
	`isTh»adAùive
(
tid
)) {

1111 
	`DPRINTF
(
InOrd”CPU
,"[tid:%i]: Removing from‡ctivehreads†ist\n",

1112 
tid
);

1113 
li¡
<
Th»adID
>::
™”©Ü
 
th»ad_™
 =

1114 
¡d
::
	`fšd
(
aùiveTh»ads
.
	`begš
(),‡ùiveTh»ads.
	`’d
(), 
tid
);

1116 
	`»moveP–šeSÎs
(*
th»ad_™
);

1118 
aùiveTh»ads
.
	`”a£
(
th»ad_™
);

1122 
	`tcBa£
(
tid
)->
	`£tStus
(
Th»adCÚ‹xt
::
Su¥’ded
);

1125 
	`as£¹
(!
	`isTh»adAùive
(
tid
));

1126 
	}
}

1129 
	gInOrd”CPU
::
	$»moveP–šeSÎs
(
Th»adID
 
tid
)

1131 
	`DPRINTF
(
InOrd”CPU
,"[tid:%i]: Removing‡ll…ipeline stalls\n",

1132 
tid
);

1134 
¡Num
 = 0; stNum < 
NumSges
 ; stNum++) {

1135 
p–šeSge
[
¡Num
]->
	`»moveSÎs
(
tid
);

1138 
	}
}

1141 
	gInOrd”CPU
::
	$upd©eTh»adPriÜ™y
()

1143 ià(
aùiveTh»ads
.
	`size
() > 1)

1147 
li¡
<
Th»adID
>::
™”©Ü
 
li¡_begš
 = 
aùiveTh»ads
.
	`begš
();

1149 
high_th»ad
 = *
li¡_begš
;

1151 
aùiveTh»ads
.
	`”a£
(
li¡_begš
);

1153 
aùiveTh»ads
.
	`push_back
(
high_th»ad
);

1155 
	}
}

1157 
šlše
 

1158 
	gInOrd”CPU
::
	$tickTh»adSts
()

1161 
li¡
<
Th»adID
>::
™”©Ü
 
th»ad_™
 = 
aùiveTh»ads
.
	`begš
();

1162 
th»ad_™
 !ğ
aùiveTh»ads
.
	`’d
()) {

1163 
th»adCyşes
[*
th»ad_™
]++;

1164 
th»ad_™
++;

1168 ià(
aùiveTh»ads
.
	`size
() > 1) {

1169 
smtCyşes
++;

1171 
	}
}

1174 
	gInOrd”CPU
::
	$aùiv©eCÚ‹xt
(
Th»adID
 
tid
, 
Cyşes
 
d–ay
)

1176 
	`DPRINTF
(
InOrd”CPU
,"[tid:%i]: Aùiv©šg ...\n", 
tid
);

1179 
	`scheduËCpuEv’t
(
Aùiv©eTh»ad
, 
NoFauÉ
, 
tid
, 
dummyIn¡
[tid], 
d–ay
);

1183 
aùiv™yRec
.
	`aùiv™y
();

1185 
_¡©us
 = 
RuÂšg
;

1186 
	}
}

1189 
	gInOrd”CPU
::
	$aùiv©eNextR—dyCÚ‹xt
(
Cyşes
 
d–ay
)

1191 
	`DPRINTF
(
InOrd”CPU
,"Activating‚ext„eadyhread\n");

1193 
	`scheduËCpuEv’t
(
Aùiv©eNextR—dyTh»ad
, 
NoFauÉ
, 0 , 
dummyIn¡
[0],

1194 
d–ay
, 
Aùiv©eNextR—dyTh»ad_Pri
);

1198 
aùiv™yRec
.
	`aùiv™y
();

1200 
_¡©us
 = 
RuÂšg
;

1201 
	}
}

1204 
	gInOrd”CPU
::
	$h®tCÚ‹xt
(
Th»adID
 
tid
)

1206 
	`DPRINTF
(
InOrd”CPU
, "[tid:%i]: C®lšg H®ˆCÚ‹xt...\n", 
tid
);

1208 
	`scheduËCpuEv’t
(
H®tTh»ad
, 
NoFauÉ
, 
tid
, 
dummyIn¡
[tid]);

1210 
aùiv™yRec
.
	`aùiv™y
();

1211 
	}
}

1214 
	gInOrd”CPU
::
	$h®tTh»ad
(
Th»adID
 
tid
)

1216 
	`DPRINTF
(
InOrd”CPU
, "[tid:%i]: PÏcšg oÀH®‹d Th»ad Li¡...\n", 
tid
);

1217 
	`d—ùiv©eTh»ad
(
tid
);

1218 
	`squashTh»adInP–še
(
tid
);

1219 
h®‹dTh»ads
.
	`push_back
(
tid
);

1221 
	`tcBa£
(
tid
)->
	`£tStus
(
Th»adCÚ‹xt
::
H®‹d
);

1223 ià(
th»adMod–
 =ğ
Sw™chOnCacheMiss
) {

1224 
	`aùiv©eNextR—dyCÚ‹xt
();

1226 
	}
}

1229 
	gInOrd”CPU
::
	$su¥’dCÚ‹xt
(
Th»adID
 
tid
)

1231 
	`scheduËCpuEv’t
(
Su¥’dTh»ad
, 
NoFauÉ
, 
tid
, 
dummyIn¡
[tid]);

1232 
	}
}

1235 
	gInOrd”CPU
::
	$su¥’dTh»ad
(
Th»adID
 
tid
)

1237 
	`DPRINTF
(
InOrd”CPU
, "[tid:%i]: Placing on Suspended Threads List...\n",

1238 
tid
);

1239 
	`d—ùiv©eTh»ad
(
tid
);

1240 
su¥’dedTh»ads
.
	`push_back
(
tid
);

1241 
th»ad
[
tid
]->
Ï¡Su¥’d
 = 
	`curTick
();

1243 
	`tcBa£
(
tid
)->
	`£tStus
(
Th»adCÚ‹xt
::
Su¥’ded
);

1244 
	}
}

1247 
	gInOrd”CPU
::
	$squashTh»adInP–še
(
Th»adID
 
tid
)

1250 
¡Num
=
NumSges
 - 1; stNum >= 0 ; stNum--) {

1251 
p–šeSge
[
¡Num
]->
	`squash
(0 , 
tid
);

1253 
	}
}

1255 
P–šeSge
*

1256 
	gInOrd”CPU
::
	$g‘PeSge
(
¡age_num
)

1258  
p–šeSge
[
¡age_num
];

1259 
	}
}

1262 
RegIndex


1263 
	gInOrd”CPU
::
	$æ©‹nRegIdx
(
RegIndex
 
»g_idx
, 
RegCÏss
 &
»g_ty³
, 
Th»adID
 
tid
)

1265 
RegIndex
 
»l_idx
;

1267 
»g_ty³
 = 
	`»gIdxToCÏss
(
»g_idx
, &
»l_idx
);

1269 
»g_ty³
) {

1270 
IÁRegCÏss
:

1271  
i§
[
tid
]->
	`æ©‹nIÁIndex
(
»l_idx
);

1273 
FlßtRegCÏss
:

1274  
i§
[
tid
]->
	`æ©‹nFlßtIndex
(
»l_idx
);

1276 
MiscRegCÏss
:

1277  
»l_idx
;

1280 
	`·nic
("»gi¡” %d ouˆoà¿nge\n", 
»g_idx
);

1282 
	}
}

1284 
ušt64_t


1285 
	gInOrd”CPU
::
	$»adIÁReg
(
RegIndex
 
»g_idx
, 
Th»adID
 
tid
)

1287 
	`DPRINTF
(
IÁRegs
, "[tid:%i]: Reading Int. Reg %i‡s %x\n",

1288 
tid
, 
»g_idx
, 
štRegs
[tid][reg_idx]);

1290  
štRegs
[
tid
][
»g_idx
];

1291 
	}
}

1293 
FlßtReg


1294 
	gInOrd”CPU
::
	$»adFlßtReg
(
RegIndex
 
»g_idx
, 
Th»adID
 
tid
)

1296 
	`DPRINTF
(
FlßtRegs
, "[tid:%i]: Reading Float Reg %i‡s %x, %08f\n",

1297 
tid
, 
»g_idx
, 
æßtRegs
.
i
[tid][»g_idx], flßtRegs.
f
[tid][reg_idx]);

1299  
æßtRegs
.
f
[
tid
][
»g_idx
];

1300 
	}
}

1302 
FlßtRegB™s


1303 
	gInOrd”CPU
::
	$»adFlßtRegB™s
(
RegIndex
 
»g_idx
, 
Th»adID
 
tid
)

1305 
	`DPRINTF
(
FlßtRegs
, "[tid:%i]: Reading Float Reg %i‡s %x, %08f\n",

1306 
tid
, 
»g_idx
, 
æßtRegs
.
i
[tid][»g_idx], flßtRegs.
f
[tid][reg_idx]);

1308  
æßtRegs
.
i
[
tid
][
»g_idx
];

1309 
	}
}

1311 
CCReg


1312 
	gInOrd”CPU
::
	$»adCCReg
(
RegIndex
 
»g_idx
, 
Th»adID
 
tid
)

1314 #ifdeà
ISA_HAS_CC_REGS


1315 
	`DPRINTF
(
CCRegs
, "[tid:%i]: Reading CC. Reg %i‡s %x\n",

1316 
tid
, 
»g_idx
, 
ccRegs
[tid][reg_idx]);

1318  
ccRegs
[
tid
][
»g_idx
];

1320 
	`·nic
("readCCReg: ISA does‚ot have CC„egs\n");

1322 
	}
}

1325 
	gInOrd”CPU
::
	$£tIÁReg
(
RegIndex
 
»g_idx
, 
ušt64_t
 
v®
, 
Th»adID
 
tid
)

1327 ià(
»g_idx
 =ğ
TheISA
::
Z”oReg
) {

1328 
	`DPRINTF
(
IÁRegs
, "[tid:%i]: Ignoring Setting of ISA-ZeroReg "

1329 "(IÁ. Reg %iètØ%x\n", 
tid
, 
»g_idx
, 
v®
);

1332 
	`DPRINTF
(
IÁRegs
, "[tid:%i]: Setting Int. Reg %io %x\n",

1333 
tid
, 
»g_idx
, 
v®
);

1335 
štRegs
[
tid
][
»g_idx
] = 
v®
;

1337 
	}
}

1341 
	gInOrd”CPU
::
	$£tFlßtReg
(
RegIndex
 
»g_idx
, 
FlßtReg
 
v®
, 
Th»adID
 
tid
)

1343 
æßtRegs
.
f
[
tid
][
»g_idx
] = 
v®
;

1344 
	`DPRINTF
(
FlßtRegs
, "[tid:%i]: Setting Float. Reg %i bitso "

1346 
tid
, 
»g_idx
,

1347 
æßtRegs
.
i
[
tid
][
»g_idx
],

1348 
æßtRegs
.
f
[
tid
][
»g_idx
]);

1349 
	}
}

1353 
	gInOrd”CPU
::
	$£tFlßtRegB™s
(
RegIndex
 
»g_idx
, 
FlßtRegB™s
 
v®
, 
Th»adID
 
tid
)

1355 
æßtRegs
.
i
[
tid
][
»g_idx
] = 
v®
;

1356 
	`DPRINTF
(
FlßtRegs
, "[tid:%i]: Setting Float. Reg %i bitso "

1358 
tid
, 
»g_idx
,

1359 
æßtRegs
.
i
[
tid
][
»g_idx
],

1360 
æßtRegs
.
f
[
tid
][
»g_idx
]);

1361 
	}
}

1364 
	gInOrd”CPU
::
	$£tCCReg
(
RegIndex
 
»g_idx
, 
CCReg
 
v®
, 
Th»adID
 
tid
)

1366 #ifdeà
ISA_HAS_CC_REGS


1367 
	`DPRINTF
(
CCRegs
, "[tid:%i]: Setting CC. Reg %io %x\n",

1368 
tid
, 
»g_idx
, 
v®
);

1369 
ccRegs
[
tid
][
»g_idx
] = 
v®
;

1371 
	`·nic
("readCCReg: ISA does‚ot have CC„egs\n");

1373 
	}
}

1375 
ušt64_t


1376 
	gInOrd”CPU
::
	$»adRegOth”Th»ad
(
»g_idx
, 
Th»adID
 
tid
)

1379 ià(
tid
 =ğ
Inv®idTh»adID
) {

1380 
tid
 = 
TheISA
::
	`g‘T¬g‘Th»ad
(
	`tcBa£
(tid));

1383 
RegIndex
 
»l_idx
;

1385 
	`»gIdxToCÏss
(
»g_idx
, &
»l_idx
)) {

1386 
IÁRegCÏss
:

1388  
	`»adIÁReg
(
»l_idx
, 
tid
);

1390 
FlßtRegCÏss
:

1392  
	`»adFlßtRegB™s
(
»l_idx
, 
tid
);

1394 
MiscRegCÏss
:

1395  
	`»adMiscReg
(
»l_idx
, 
tid
);

1398 
	`·nic
("»gi¡” %d ouˆoà¿nge\n", 
»g_idx
);

1400 
	}
}

1403 
	gInOrd”CPU
::
	$£tRegOth”Th»ad
(
»g_idx
, cÚ¡ 
MiscReg
 &
v®
,

1404 
Th»adID
 
tid
)

1407 ià(
tid
 =ğ
Inv®idTh»adID
) {

1408 
tid
 = 
TheISA
::
	`g‘T¬g‘Th»ad
(
	`tcBa£
(tid));

1411 
RegIndex
 
»l_idx
;

1413 
	`»gIdxToCÏss
(
»g_idx
, &
»l_idx
)) {

1414 
IÁRegCÏss
:

1415 
	`£tIÁReg
(
»l_idx
, 
v®
, 
tid
);

1418 
FlßtRegCÏss
:

1419 
	`£tFlßtRegB™s
(
»l_idx
, 
v®
, 
tid
);

1422 
CCRegCÏss
:

1423 
	`£tCCReg
(
»l_idx
, 
v®
, 
tid
);

1426 
MiscRegCÏss
:

1427 
	`£tMiscReg
(
»l_idx
, 
v®
, 
tid
);

1430 
	}
}

1432 
MiscReg


1433 
	gInOrd”CPU
::
	$»adMiscRegNoEfãù
(
misc_»g
, 
Th»adID
 
tid
)

1435  
i§
[
tid
]->
	`»adMiscRegNoEfãù
(
misc_»g
);

1436 
	}
}

1438 
MiscReg


1439 
	gInOrd”CPU
::
	$»adMiscReg
(
misc_»g
, 
Th»adID
 
tid
)

1441  
i§
[
tid
]->
	`»adMiscReg
(
misc_»g
, 
	`tcBa£
(tid));

1442 
	}
}

1445 
	gInOrd”CPU
::
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
, 
Th»adID
 
tid
)

1447 
i§
[
tid
]->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
);

1448 
	}
}

1451 
	gInOrd”CPU
::
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
, 
Th»adID
 
tid
)

1453 
i§
[
tid
]->
	`£tMiscReg
(
misc_»g
, 
v®
, 
	`tcBa£
(tid));

1454 
	}
}

1457 
	gInOrd”CPU
::
Li¡It


1458 
InOrd”CPU
::
	$addIn¡
(
DynIn¡PŒ
 
š¡
)

1460 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

1462 
š¡Li¡
[
tid
].
	`push_back
(
š¡
);

1464  --(
š¡Li¡
[
tid
].
	`’d
());

1465 
	}
}

1467 
	gInOrd”CPU
::
Li¡It


1468 
InOrd”CPU
::
	$fšdIn¡
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
)

1470 
Li¡It
 
™
 = 
š¡Li¡
[
tid
].
	`begš
();

1471 
Li¡It
 
’d
 = 
š¡Li¡
[
tid
].
	`’d
();

1473 
™
 !ğ
’d
) {

1474 ià((*
™
)->
£qNum
 =ğ
£q_num
)

1475  
™
;

1476 ià((*
™
)->
£qNum
 > 
£q_num
)

1479 
™
++;

1482  
š¡Li¡
[
tid
].
	`’d
();

1483 
	}
}

1486 
	gInOrd”CPU
::
	$upd©eCÚ‹xtSw™chSts
()

1489 
š¡sP”CtxtSw™ch
 = 
š¡sP”Sw™ch
;

1490 
š¡sP”Sw™ch
 = 0;

1491 
	}
}

1495 
	gInOrd”CPU
::
	$š¡DÚe
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
)

1503 
TheISA
::
PCS‹
 
comm_pc
 = 
š¡
->
	`pcS‹
();

1504 
Ï¡Comm™‹dPC
[
tid
] = 
comm_pc
;

1505 
TheISA
::
	`advªûPC
(
comm_pc
, 
š¡
->
¡©icIn¡
);

1506 
	`pcS‹
(
comm_pc
, 
tid
);

1509 ià(
š¡
->
	`isCÚŒŞ
()) {

1510 
th»ad
[
tid
]->
Ï¡G¿dIsB¿nch
 = 
Œue
;

1511 
th»ad
[
tid
]->
Ï¡B¿nchPC
 = 
š¡
->
	`pcS‹
();

1512 
TheISA
::
	`advªûPC
(
th»ad
[
tid
]->
Ï¡B¿nchPC
, 
š¡
->
¡©icIn¡
);

1514 
th»ad
[
tid
]->
Ï¡G¿dIsB¿nch
 = 
çl£
;

1519 ià(
š¡
->
ŒaûD©a
) {

1521 
š¡
->
ŒaûD©a
->
	`£tF‘chSeq
(š¡->
£qNum
);

1523 
š¡
->
ŒaûD©a
->
	`dump
();

1524 
d–‘e
 
š¡
->
ŒaûD©a
;

1525 
š¡
->
ŒaûD©a
 = 
NULL
;

1529 
š¡sP”Sw™ch
++;

1532 
th»ad
[
tid
]->
numIn¡
++;

1533 
th»ad
[
tid
]->
numOp
++;

1536 
th»ad
[
tid
]->
numIn¡s
++;

1537 
th»ad
[
tid
]->
numOps
++;

1540 ià(!
š¡
->
	`isMiüoİ
(è|| in¡->
	`isLa¡Miüoİ
()) {

1541 
comm™‹dIn¡s
[
tid
]++;

1544 
tÙ®Comm™‹dIn¡s
++;

1547 
comm™‹dOps
[
tid
]++;

1550 ià(
	`numAùiveTh»ads
() > 1) {

1551 ià(!
š¡
->
	`isMiüoİ
(è|| in¡->
	`isLa¡Miüoİ
())

1552 
smtComm™‹dIn¡s
[
tid
]++;

1556 ià(
š¡
->
	`isLßd
()) {

1557 
comLßds
++;

1558 } ià(
š¡
->
	`isStÜe
()) {

1559 
comStÜes
++;

1560 } ià(
š¡
->
	`isCÚŒŞ
()) {

1561 
comB¿nches
++;

1562 } ià(
š¡
->
	`isNİ
()) {

1563 
comNİs
++;

1564 } ià(
š¡
->
	`isNÚS³cuÏtive
()) {

1565 
comNÚS³c
++;

1566 } ià(
š¡
->
	`isIÁeg”
()) {

1567 
comIÁs
++;

1568 } ià(
š¡
->
	`isFlßtšg
()) {

1569 
comFlßts
++;

1573 
comIn¡Ev’tQueue
[
tid
]->
	`£rviûEv’ts
(
th»ad
[tid]->
numOp
);

1576 
	`»moveIn¡
(
š¡
);

1577 
	}
}

1582 
	gInOrd”CPU
::
	$addToRemoveLi¡
(
DynIn¡PŒ
 
š¡
)

1584 
»moveIn¡sThisCyşe
 = 
Œue
;

1585 ià(!
š¡
->
	`isRemoveLi¡
()) {

1586 
	`DPRINTF
(
InOrd”CPU
, "Pushing instruction [tid:%i] PC %s "

1588 
š¡
->
th»adNumb”
, in¡->
	`pcS‹
(), in¡->
£qNum
);

1589 
š¡
->
	`£tRemoveLi¡
();

1590 
»moveLi¡
.
	`push
(
š¡
->
	`g‘In¡Li¡It
());

1592 
	`DPRINTF
(
InOrd”CPU
, "Ignoring instruction„emoval for [tid:%i] PC %s "

1594 
š¡
->
th»adNumb”
, in¡->
	`pcS‹
(), in¡->
£qNum
);

1597 
	}
}

1600 
	gInOrd”CPU
::
	$»moveIn¡
(
DynIn¡PŒ
 
š¡
)

1602 
	`DPRINTF
(
InOrd”CPU
, "Removing graduated instruction [tid:%i] PC %s "

1604 
š¡
->
th»adNumb”
, in¡->
	`pcS‹
(), in¡->
£qNum
);

1606 
»moveIn¡sThisCyşe
 = 
Œue
;

1609 ià(!
š¡
->
	`isRemoveLi¡
()) {

1610 
	`DPRINTF
(
InOrd”CPU
, "Pushing instruction [tid:%i] PC %s "

1612 
š¡
->
th»adNumb”
, in¡->
	`pcS‹
(), in¡->
£qNum
);

1613 
š¡
->
	`£tRemoveLi¡
();

1614 
»moveLi¡
.
	`push
(
š¡
->
	`g‘In¡Li¡It
());

1616 
	`DPRINTF
(
InOrd”CPU
, "Ignoring instruction„emoval for [tid:%i] PC %s "

1618 
š¡
->
th»adNumb”
, in¡->
	`pcS‹
(), in¡->
£qNum
);

1621 
	}
}

1624 
	gInOrd”CPU
::
	$»moveIn¡sUÁ
(cÚ¡ 
In¡SeqNum
 &
£q_num
, 
Th»adID
 
tid
)

1628 
»moveIn¡sThisCyşe
 = 
Œue
;

1630 
Li¡It
 
š¡_™”
 = 
š¡Li¡
[
tid
].
	`’d
();

1632 
š¡_™”
--;

1634 
	`DPRINTF
(
InOrd”CPU
, "Squashing instructions from CPU instruction "

1636 
tid
, 
£q_num
, (*
š¡_™”
)->
£qNum
);

1638 (*
š¡_™”
)->
£qNum
 > 
£q_num
) {

1640 
boŞ
 
b»ak_loİ
 = (
š¡_™”
 =ğ
š¡Li¡
[
tid
].
	`begš
());

1642 
	`squashIn¡It
(
š¡_™”
, 
tid
);

1644 
š¡_™”
--;

1646 ià(
b»ak_loİ
)

1649 
	}
}

1652 
šlše
 

1653 
	gInOrd”CPU
::
	$squashIn¡It
(cÚ¡ 
Li¡It
 
š¡_™
, 
Th»adID
 
tid
)

1655 
DynIn¡PŒ
 
š¡
 = (*
š¡_™
);

1656 ià(
š¡
->
th»adNumb”
 =ğ
tid
) {

1657 
	`DPRINTF
(
InOrd”CPU
, "Squashing instruction, "

1659 
š¡
->
th»adNumb”
,

1660 
š¡
->
£qNum
,

1661 
š¡
->
	`pcS‹
());

1663 
š¡
->
	`£tSquashed
();

1664 
¬chRegD•M­
[
tid
].
	`»move
(
š¡
);

1666 ià(!
š¡
->
	`isRemoveLi¡
()) {

1667 
	`DPRINTF
(
InOrd”CPU
, "Pushing instruction [tid:%i] PC %s "

1669 
š¡
->
th»adNumb”
, in¡->
	`pcS‹
(),

1670 
š¡
->
£qNum
);

1671 
š¡
->
	`£tRemoveLi¡
();

1672 
»moveLi¡
.
	`push
(
š¡_™
);

1674 
	`DPRINTF
(
InOrd”CPU
, "Ignoring instruction„emoval for [tid:%i]"

1676 
š¡
->
th»adNumb”
, in¡->
	`pcS‹
(),

1677 
š¡
->
£qNum
);

1682 
	}
}

1686 
	gInOrd”CPU
::
	$ş—nUpRemovedIn¡s
()

1688 !
»moveLi¡
.
	`em±y
()) {

1689 
	`DPRINTF
(
InOrd”CPU
, "Removing instruction, "

1691 (*
»moveLi¡
.
	`äÚt
())->
th»adNumb”
,

1692 (*
»moveLi¡
.
	`äÚt
())->
£qNum
,

1693 (*
»moveLi¡
.
	`äÚt
())->
	`pcS‹
());

1695 
DynIn¡PŒ
 
š¡
 = *
»moveLi¡
.
	`äÚt
();

1696 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1702 ià(
š¡
->
¡©icIn¡
 &&

1703 
š¡
->
£qNum
 =ğ
nÚS³cSeqNum
[
tid
] &&

1704 
nÚS³cIn¡Aùive
[
tid
] =ğ
Œue
) {

1705 
nÚS³cIn¡Aùive
[
tid
] = 
çl£
;

1708 
š¡
->
ÚIn¡Li¡
 = 
çl£
;

1710 
š¡Li¡
[
tid
].
	`”a£
(
»moveLi¡
.
	`äÚt
());

1712 
»moveLi¡
.
	`pİ
();

1715 
»moveIn¡sThisCyşe
 = 
çl£
;

1716 
	}
}

1719 
	gInOrd”CPU
::
	$ş—nUpRemovedEv’ts
()

1721 !
ıuEv’tRemoveLi¡
.
	`em±y
()) {

1722 
Ev’t
 *
ıu_ev’t
 = 
ıuEv’tRemoveLi¡
.
	`äÚt
();

1723 
ıuEv’tRemoveLi¡
.
	`pİ
();

1724 
d–‘e
 
ıu_ev’t
;

1726 
	}
}

1730 
	gInOrd”CPU
::
	$dumpIn¡s
()

1732 
num
 = 0;

1734 
Li¡It
 
š¡_li¡_™
 = 
š¡Li¡
[0].
	`begš
();

1736 
	`ırštf
("Dumping Instruction List\n");

1738 
š¡_li¡_™
 !ğ
š¡Li¡
[0].
	`’d
()) {

1739 
	`ırštf
("Instruction:%i\nPC:%s\n[tid:%i]\n[sn:%lli]\nIssued:%i\n"

1741 
num
, (*
š¡_li¡_™
)->
	`pcS‹
(),

1742 (*
š¡_li¡_™
)->
th»adNumb”
,

1743 (*
š¡_li¡_™
)->
£qNum
, (*š¡_li¡_™)->
	`isIssued
(),

1744 (*
š¡_li¡_™
)->
	`isSquashed
());

1745 
š¡_li¡_™
++;

1746 ++
num
;

1748 
	}
}

1751 
	gInOrd”CPU
::
	$wakeCPU
()

1753 iàĞ
tickEv’t
.
	`scheduËd
()) {

1754 
	`DPRINTF
(
Aùiv™y
, "CPU‡lready„unning.\n");

1758 
	`DPRINTF
(
Aùiv™y
, "Waking up CPU\n");

1760 
Tick
 
exŒa_cyşes
 = 
	`curCyşe
(è- 
Ï¡RuÂšgCyşe
;

1761 ià(
exŒa_cyşes
 != 0)

1762 --
exŒa_cyşes
;

1764 
idËCyşes
 +ğ
exŒa_cyşes
;

1765 
¡age_num
 = 0; sge_num < 
NumSges
; stage_num++) {

1766 
p–šeSge
[
¡age_num
]->
idËCyşes
 +ğ
exŒa_cyşes
;

1769 
numCyşes
 +ğ
exŒa_cyşes
;

1771 
	`scheduË
(&
tickEv’t
, 
	`şockEdge
());

1772 
	}
}

1776 
	gInOrd”CPU
::
	$wakeup
()

1778 ià(
th»ad
[0]->
	`¡©us
(è!ğ
Th»adCÚ‹xt
::
Su¥’ded
)

1781 
	`wakeCPU
();

1783 
	`DPRINTF
(
Qu›sû
, "Suspended Processor woken\n");

1784 
th»adCÚ‹xts
[0]->
	`aùiv©e
();

1785 
	}
}

1788 
	gInOrd”CPU
::
	$sysÿÎCÚ‹xt
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
,

1789 
Cyşes
 
d–ay
)

1792 
squash_¡age
 = 
NumSges
 - 1;

1793 
š¡
->
	`£tSquashInfo
(
squash_¡age
);

1796 
p–šeSge
[
squash_¡age
]->
	`£tupSquash
(
š¡
, 
tid
);

1799 
»sPoŞ
->
	`scheduËEv’t
(

1800 (
InOrd”CPU
::
CPUEv’tTy³
)
ResourûPoŞ
::
SquashAÎ
, 
š¡
,

1801 
	`Cyşes
(0));

1802 
	`scheduËCpuEv’t
(
SysÿÎ
, 
çuÉ
, 
tid
, 
š¡
, 
d–ay
, 
SysÿÎ_Pri
);

1803 
	}
}

1806 
	gInOrd”CPU
::
	$sysÿÎ
(
št64_t
 
ÿÎnum
, 
Th»adID
 
tid
)

1808 
	`DPRINTF
(
InOrd”CPU
, "[tid:%i] Executšg sysÿÎ().\n\n", 
tid
);

1810 
	`DPRINTF
(
Aùiv™y
,"Activity: syscall() called.\n");

1814 ++(
this
->
th»ad
[
tid
]->
funcExeIn¡
);

1817 
this
->
th»ad
[
tid
]->
	`sysÿÎ
(
ÿÎnum
);

1821 --(
this
->
th»ad
[
tid
]->
funcExeIn¡
);

1824 
nÚS³cIn¡Aùive
[
tid
] = 
çl£
;

1825 
	}
}

1827 
	gTheISA
::
TLB
*

1828 
InOrd”CPU
::
	$g‘ITBPŒ
()

1830 
CacheUn™
 *
™b_»s
 = 
»sPoŞ
->
	`g‘In¡Un™
();

1831  
™b_»s
->
	`b
();

1832 
	}
}

1835 
	gTheISA
::
TLB
*

1836 
InOrd”CPU
::
	$g‘DTBPŒ
()

1838  
»sPoŞ
->
	`g‘D©aUn™
()->
	`b
();

1839 
	}
}

1841 
	gTheISA
::
Decod”
 *

1842 
InOrd”CPU
::
	$g‘Decod”PŒ
(
tid
)

1844  
»sPoŞ
->
	`g‘In¡Un™
()->
decod”
[
tid
];

1845 
	}
}

1847 
FauÉ


1848 
	gInOrd”CPU
::
	$»ad
(
DynIn¡PŒ
 
š¡
, 
Addr
 
addr
,

1849 
ušt8_t
 *
d©a
, 
size
, 
æags
)

1851  
»sPoŞ
->
	`g‘D©aUn™
()->
	`»ad
(
š¡
, 
addr
, 
d©a
, 
size
, 
æags
);

1852 
	}
}

1854 
FauÉ


1855 
	gInOrd”CPU
::
	$wr™e
(
DynIn¡PŒ
 
š¡
, 
ušt8_t
 *
d©a
, 
size
,

1856 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
wr™e_»s
)

1858  
»sPoŞ
->
	`g‘D©aUn™
()->
	`wr™e
(
š¡
, 
d©a
, 
size
, 
addr
, 
æags
,

1859 
wr™e_»s
);

1860 
	}
}

	@inorder/cpu.hh

45 #iâdeà
__CPU_INORDER_CPU_HH__


46 
	#__CPU_INORDER_CPU_HH__


	)

48 
	~<io¡»am
>

49 
	~<li¡
>

50 
	~<queue
>

51 
	~<£t
>

52 
	~<veùÜ
>

54 
	~"¬ch/i§_Œa™s.hh
"

55 
	~"¬ch/»gi¡”s.hh
"

56 
	~"¬ch/ty³s.hh
"

57 
	~"ba£/¡©i¡ics.hh
"

58 
	~"ba£/ty³s.hh
"

59 
	~"cÚfig/the_i§.hh
"

60 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

61 
	~"ıu/šÜd”/p–še_¡age.hh
"

62 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

63 
	~"ıu/šÜd”/»g_d•_m­.hh
"

64 
	~"ıu/šÜd”/th»ad_¡©e.hh
"

65 
	~"ıu/o3/d•_g¿ph.hh
"

66 
	~"ıu/o3/»Çme_m­.hh
"

67 
	~"ıu/aùiv™y.hh
"

68 
	~"ıu/ba£.hh
"

69 
	~"ıu/»g_şass.hh
"

70 
	~"ıu/sim¶e_th»ad.hh
"

71 
	~"ıu/timebuf.hh
"

72 
	~"mem/·ck‘.hh
"

73 
	~"mem/pÜt.hh
"

74 
	~"mem/»que¡.hh
"

75 
	~"sim/ev’tq.hh
"

76 
	~"sim/´oûss.hh
"

78 
şass
 
	gCacheUn™
;

79 
şass
 
	gTh»adCÚ‹xt
;

80 
şass
 
	gMemIÁ”çû
;

81 
şass
 
	gMemObjeù
;

82 
şass
 
	gProûss
;

83 
şass
 
	gResourûPoŞ
;

85 şas 
	cInOrd”CPU
 : 
public
 
Ba£CPU


88 
´Ùeùed
:

89 
TheP–še
::
	tP¬ams
 Params;

90 
InOrd”Th»adS‹
 
	tTh»ad
;

93 
	mTheISA
::
	tIÁReg
 IntReg;

94 
	mTheISA
::
	tFlßtReg
 FloatReg;

95 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

96 
	mTheISA
::
	tCCReg
 CCReg;

97 
	mTheISA
::
	tMiscReg
 MiscReg;

98 
	mTheISA
::
	tRegIndex
 RegIndex;

101 
	mTheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

102 
	m¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

105 
	mTimeBufãr
<
	tIÁ”SgeSŒuù
> 
	tSgeQueue
;

107 
ä›nd
 
şass
 
	mResourû
;

109 
	mpublic
:

111 
InOrd”CPU
(
P¬ams
 *
·¿ms
);

113 ~
InOrd”CPU
();

115 
	$v”ifyMemÜyMode
() const;

118 
vœtu®
 
Ma¡”PÜt
 &
	$g‘D©aPÜt
(è{  
d©aPÜt
; }

121 
vœtu®
 
Ma¡”PÜt
 &
	$g‘In¡PÜt
(è{  
š¡PÜt
; 
	}
}

124 
	gıu_id
;

127 
Th»adID
 
	gasid
[
TheP–še
::
MaxTh»ads
];

130 
	g¡d
::
¡ršg
 
cÜeTy³
;

133 
	eTh»adMod–
 {

134 
	gSšgË
,

135 
	gSMT
,

136 
	gSw™chOnCacheMiss


139 
Th»adMod–
 
	gth»adMod–
;

141 
	$»adCpuId
(è{  
ıu_id
; 
	}
}

143 
	$£tCpuId
(
v®
è{ 
ıu_id
 = v®; 
	}
}

145 
P¬ams
 *
	gıu_·¿ms
;

147 
	gpublic
:

148 
	eStus
 {

149 
RuÂšg
,

150 
	gIdË
,

151 
	gH®‹d
,

152 
	gBlocked
,

153 
	gSw™chedOut


157 
Stus
 
	g_¡©us
;

158 
	g´iv©e
:

164 şas 
	cCachePÜt
 : 
public
 
Ma¡”PÜt


167 
´iv©e
:

169 
CacheUn™
 *
ÿcheUn™
;

171 
	gpublic
:

173 
CachePÜt
(
CacheUn™
 *
_ÿcheUn™
, cÚ¡ 
¡d
::
¡ršg
& 
Çme
);

175 
	g´Ùeùed
:

178 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

181 
»cvR‘ry
();

184 
»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
) { }

188 şas 
	cTickEv’t
 : 
public
 
Ev’t


190 
´iv©e
:

192 
InOrd”CPU
 *
ıu
;

194 
	gpublic
:

196 
TickEv’t
(
InOrd”CPU
 *
c
);

199 
´oûss
();

202 cÚ¡ *
desütiÚ
() const;

206 
TickEv’t
 
	gtickEv’t
;

209 
	$scheduËTickEv’t
(
Cyşes
 
d–ay
)

211 
	`as£¹
(!
tickEv’t
.
	`scheduËd
(è||ickEv’t.
	`squashed
());

212 
	`»scheduË
(&
tickEv’t
, 
	`şockEdge
(
d–ay
), 
Œue
);

213 
	}
}

216 
	$unscheduËTickEv’t
()

218 ià(
tickEv’t
.
	`scheduËd
())

219 
tickEv’t
.
	`squash
();

220 
	}
}

222 
	gpublic
:

229 
	eCPUEv’tTy³
 {

230 
Aùiv©eTh»ad
,

231 
	gAùiv©eNextR—dyTh»ad
,

232 
	gD—ùiv©eTh»ad
,

233 
	gH®tTh»ad
,

234 
	gSu¥’dTh»ad
,

235 
	gT¿p
,

236 
	gSysÿÎ
,

237 
	gSquashFromMemSÎ
,

238 
	gUpd©ePCs
,

239 
	gNumCPUEv’ts


242 
	g¡d
::
¡ršg
 
ev’tNames
[
NumCPUEv’ts
];

244 
	eCPUEv’tPri
 {

245 
	gInOrd”CPU_Pri
 = 
Ev’t
::
CPU_Tick_Pri
,

246 
	gSysÿÎ_Pri
 = 
Ev’t
::
CPU_Tick_Pri
 + 9,

247 
	gAùiv©eNextR—dyTh»ad_Pri
 = 
Ev’t
::
CPU_Tick_Pri
 + 10

251 şas 
	cCPUEv’t
 : 
public
 
Ev’t


253 
´Ùeùed
:

254 
InOrd”CPU
 *
ıu
;

256 
	gpublic
:

257 
CPUEv’tTy³
 
ıuEv’tTy³
;

258 
Th»adID
 
	gtid
;

259 
DynIn¡PŒ
 
	gš¡
;

260 
FauÉ
 
	gçuÉ
;

261 
	gv³
;

262 
	gsysÿÎ_num
;

264 
	gpublic
:

266 
CPUEv’t
(
InOrd”CPU
 *
_ıu
, 
CPUEv’tTy³
 
e_ty³
, 
FauÉ
 
çuÉ
,

267 
Th»adID
 
_tid
, 
DynIn¡PŒ
 
š¡
, 
CPUEv’tPri
 
ev’t_´i
);

270 
£tEv’t
(
CPUEv’tTy³
 
e_ty³
, 
FauÉ
 
_çuÉ
, 
Th»adID
 
_tid
,

271 
DynIn¡PŒ
 
_š¡
)

273 
	gçuÉ
 = 
_çuÉ
;

274 
	gıuEv’tTy³
 = 
e_ty³
;

275 
	gtid
 = 
_tid
;

276 
	gš¡
 = 
_š¡
;

277 
	gv³
 = 0;

281 
´oûss
();

284 cÚ¡ *
desütiÚ
() const;

287 
scheduËEv’t
(
Cyşes
 
d–ay
);

290 
unscheduËEv’t
();

294 
scheduËCpuEv’t
(
CPUEv’tTy³
 
ıu_ev’t
, 
FauÉ
 
çuÉ
, 
Th»adID
 
tid
,

295 
DynIn¡PŒ
 
š¡
, 
Cyşes
 
d–ay
 = Cycles(0),

296 
CPUEv’tPri
 
ev’t_´i
 = 
InOrd”CPU_Pri
);

298 
	gpublic
:

301 
¡ageWidth
;

304 
ResourûPoŞ
 *
	g»sPoŞ
;

308 
DynIn¡PŒ
 
	gdummyIn¡
[
TheP–še
::
MaxTh»ads
];

309 
DynIn¡PŒ
 
	gdummyBufãrIn¡
;

310 
DynIn¡PŒ
 
	gdummyReqIn¡
;

311 
DynIn¡PŒ
 
	gdummyT¿pIn¡
[
TheP–še
::
MaxTh»ads
];

314 
ResourûReque¡
 *
	gdummyReq
[
TheP–še
::
MaxTh»ads
];

317 
P–šeSge
 *
	gp–šeSge
[
TheP–še
::
NumSges
];

320 
	gTheISA
::
PCS‹
 
pc
[
TheP–še
::
MaxTh»ads
];

323 
	gTheISA
::
PCS‹
 
Ï¡Comm™‹dPC
[
TheP–še
::
MaxTh»ads
];

327 
FlßtReg
 
	gf
[
TheP–še
::
MaxTh»ads
][
TheISA
::
NumFlßtRegs
];

328 
FlßtRegB™s
 
	gi
[
TheP–še
::
MaxTh»ads
][
TheISA
::
NumFlßtRegs
];

329 } 
	gæßtRegs
;

330 
	gTheISA
::
IÁReg
 
štRegs
[
TheP–še
::
MaxTh»ads
][
TheISA
::
NumIÁRegs
];

331 #ifdeà
ISA_HAS_CC_REGS


332 
	gTheISA
::
CCReg
 
ccRegs
[
TheP–še
::
MaxTh»ads
][
TheISA
::
NumCCRegs
];

336 
	g¡d
::
veùÜ
<
TheISA
::
ISA
 *> 
i§
;

339 
RegD•M­
 
	g¬chRegD•M­
[
TheP–še
::
MaxTh»ads
];

342 
	gTimeBufãr
<
	gTimeSŒuù
> 
	gtimeBufãr
;

345 
SgeQueue
 *
	g¡ageQueue
[
TheP–še
::
NumSges
-1];

347 
	gTheISA
::
TLB
 *
g‘ITBPŒ
();

348 
	gTheISA
::
TLB
 *
g‘DTBPŒ
();

350 
	gTheISA
::
Decod”
 *
g‘Decod”PŒ
(
tid
);

353 
ušt32_t
 
	tSkedID
;

356 
	gm5
::
hash_m­
<
SkedID
, 
	gTheP–še
::
RSkedPŒ
> 
skedCache
;

358 
	gm5
::
	thash_m­
<
	tSkedID
, 
	tTheP–še
::
	tRSkedPŒ
>::
	t™”©Ü
 
	tSkedCacheIt
;

363 
SkedCacheIt
 
	g’dOfSkedIt
;

365 
	gTheP–še
::
RSkedPŒ
 
äÚtEndSked
;

366 
	gTheP–še
::
RSkedPŒ
 
çuÉSked
;

369 
addToSkedCache
(
DynIn¡PŒ
 
š¡
, 
TheP–še
::
RSkedPŒ
 
š¡_sked
)

371 
SkedID
 
sked_id
 = 
g’SkedID
(
š¡
);

372 
as£¹
(
skedCache
.
fšd
(
sked_id
è=ğskedCache.
’d
());

373 
	gskedCache
[
sked_id
] = 
š¡_sked
;

378 
	gTheP–še
::
RSkedPŒ
 
	$lookupSked
(
DynIn¡PŒ
 
š¡
)

380 
SkedID
 
sked_id
 = 
	`g’SkedID
(
š¡
);

381 
SkedCacheIt
 
lookup_™
 = 
skedCache
.
	`fšd
(
sked_id
);

383 ià(
lookup_™
 !ğ
’dOfSkedIt
) {

384  (*
lookup_™
).
£cÚd
;

386  
NULL
;

388 
	}
}

390 cÚ¡ 
ušt8_t
 
	gINST_OPCLASS
 = 26;

391 cÚ¡ 
ušt8_t
 
	gINST_LOAD
 = 25;

392 cÚ¡ 
ušt8_t
 
	gINST_STORE
 = 24;

393 cÚ¡ 
ušt8_t
 
	gINST_CONTROL
 = 23;

394 cÚ¡ 
ušt8_t
 
	gINST_NONSPEC
 = 22;

395 cÚ¡ 
ušt8_t
 
	gINST_DEST_REGS
 = 18;

396 cÚ¡ 
ušt8_t
 
	gINST_SRC_REGS
 = 14;

397 cÚ¡ 
ušt8_t
 
	gINST_SPLIT_DATA
 = 13;

399 
šlše
 
SkedID
 
	$g’SkedID
(
DynIn¡PŒ
 
š¡
)

401 
SkedID
 
id
 = 0;

402 
id
 = (
š¡
->
	`İCÏss
(è<< 
INST_OPCLASS
) |

403 (
š¡
->
	`isLßd
(è<< 
INST_LOAD
) |

404 (
š¡
->
	`isStÜe
(è<< 
INST_STORE
) |

405 (
š¡
->
	`isCÚŒŞ
(è<< 
INST_CONTROL
) |

406 (
š¡
->
	`isNÚS³cuÏtive
(è<< 
INST_NONSPEC
) |

407 (
š¡
->
	`numDe¡Regs
(è<< 
INST_DEST_REGS
) |

408 (
š¡
->
	`numSrcRegs
(è<< 
INST_SRC_REGS
) |

409 (
š¡
->
¥l™In¡
 << 
INST_SPLIT_DATA
);

410  
id
;

411 
	}
}

413 
	gTheP–še
::
RSkedPŒ
 
ü—‹FrÚtEndSked
();

414 
	gTheP–še
::
RSkedPŒ
 
ü—‹FauÉSked
();

415 
	gTheP–še
::
RSkedPŒ
 
ü—‹BackEndSked
(
DynIn¡PŒ
 
š¡
);

417 şas 
	cSgeScheduËr
 {

418 
	g´iv©e
:

419 
TheP–še
::
RSkedPŒ
 
rsked
;

420 
	g¡ageNum
;

421 
	gÃxtTaskPriÜ™y
;

423 
	gpublic
:

424 
SgeScheduËr
(
TheP–še
::
RSkedPŒ
 
_rsked
, 
¡age_num
)

425 : 
rsked
(
_rsked
), 
¡ageNum
(
¡age_num
),

426 
ÃxtTaskPriÜ™y
(0)

429 
Ãeds
(
un™
, 
»que¡
) {

430 
	grsked
->
push
(
Ãw
 
ScheduËEÁry
(

431 
¡ageNum
, 
ÃxtTaskPriÜ™y
++, 
un™
, 
»que¡


435 
Ãeds
(
un™
, 
»que¡
, 
·¿m
) {

436 
	grsked
->
push
(
Ãw
 
ScheduËEÁry
(

437 
¡ageNum
, 
ÃxtTaskPriÜ™y
++, 
un™
, 
»que¡
, 
·¿m


442 
	g´iv©e
:

445 
CachePÜt
 
d©aPÜt
;

448 
CachePÜt
 
	gš¡PÜt
;

450 
	gpublic
:

453 
»gSts
();

458 
tick
();

461 
š™
();

464 
FauÉ
 
hw»i
(
Th»adID
 
tid
);

466 
boŞ
 
simP®Check
(
·lFunc
, 
Th»adID
 
tid
);

468 
checkFÜIÁ”ru±s
();

471 
FauÉ
 
g‘IÁ”ru±s
();

474 
´oûssIÁ”ru±s
(
FauÉ
 
š‹¼u±
);

477 
	$h®t
(è{ 
	`·nic
("H®ˆnÙ im¶em’‹d!\n"); 
	}
}

480 
boŞ
 
	$v®idIn¡Addr
(
Addr
 
addr
è{  
Œue
; 
	}
}

483 
boŞ
 
	$v®idD©aAddr
(
Addr
 
addr
è{  
Œue
; 
	}
}

486 
sysÿÎCÚ‹xt
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
,

487 
Cyşes
 
d–ay
 = Cycles(0));

490 
sysÿÎ
(
št64_t
 
ÿÎnum
, 
Th»adID
 
tid
);

493 
Œ­CÚ‹xt
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
,

494 
Cyşes
 
d–ay
 = Cycles(0));

497 
Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
);

500 
aùiv©eCÚ‹xt
(
Th»adID
 
tid
, 
Cyşes
 
d–ay
 = Cycles(0));

503 
aùiv©eTh»ad
(
Th»adID
 
tid
);

506 
aùiv©eTh»adInP–še
(
Th»adID
 
tid
);

509 
aùiv©eNextR—dyCÚ‹xt
(
Cyşes
 
d–ay
 = Cycles(0));

512 
aùiv©eNextR—dyTh»ad
();

515 
d—ùiv©eCÚ‹xt
(
Th»adID
 
tid
, 
Cyşes
 
d–ay
 = Cycles(0));

518 
d—ùiv©eTh»ad
(
Th»adID
 
tid
);

521 
su¥’dCÚ‹xt
(
Th»adID
 
tid
);

524 
su¥’dTh»ad
(
Th»adID
 
tid
);

527 
h®tCÚ‹xt
(
Th»adID
 
tid
);

532 
h®tTh»ad
(
Th»adID
 
tid
);

538 
squashFromMemSÎ
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
,

539 
Cyşes
 
d–ay
 = Cycles(0));

540 
squashDueToMemSÎ
(
¡age_num
, 
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
);

542 
»moveP–šeSÎs
(
Th»adID
 
tid
);

543 
squashTh»adInP–še
(
Th»adID
 
tid
);

544 
squashBehšdMemSÎ
(
¡age_num
, 
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
);

546 
P–šeSge
* 
g‘PeSge
(
¡age_num
);

549 
	$cÚ‹xtId
()

551 
	`hack_Úû
("return‡ bogus context id");

553 
	}
}

556 
upd©eTh»adPriÜ™y
();

559 
	$sw™chToAùive
(
¡age_idx
)

560 { 
	}
}

563 
In¡SeqNum
 
	$g‘AndInüem’tIn¡Seq
(
Th»adID
 
tid
)

564 {  
glob®SeqNum
[
tid
]++; 
	}
}

567 
In¡SeqNum
 
	$ÃxtIn¡SeqNum
(
Th»adID
 
tid
)

568 {  
glob®SeqNum
[
tid
]; 
	}
}

571 
	$šüIn¡SeqNum
(
Th»adID
 
tid
)

572 { 
glob®SeqNum
[
tid
]++; 
	}
}

575 
	$£tIn¡SeqNum
(
Th»adID
 
tid
, 
In¡SeqNum
 
£q_num
)

577 
glob®SeqNum
[
tid
] = 
£q_num
;

578 
	}
}

581 
In¡SeqNum
 
	$g‘NextEv’tNum
()

583 #ifdeà
DEBUG


584  
ıuEv’tNum
++;

588 
	}
}

591 
ušt64_t
 
»adIÁReg
(
RegIndex
 
»g_idx
, 
Th»adID
 
tid
);

593 
FlßtReg
 
»adFlßtReg
(
RegIndex
 
»g_idx
, 
Th»adID
 
tid
);

595 
FlßtRegB™s
 
»adFlßtRegB™s
(
RegIndex
 
»g_idx
, 
Th»adID
 
tid
);

597 
CCReg
 
»adCCReg
(
RegIndex
 
»g_idx
, 
Th»adID
 
tid
);

599 
£tIÁReg
(
RegIndex
 
»g_idx
, 
ušt64_t
 
v®
, 
Th»adID
 
tid
);

601 
£tFlßtReg
(
RegIndex
 
»g_idx
, 
FlßtReg
 
v®
, 
Th»adID
 
tid
);

603 
£tFlßtRegB™s
(
RegIndex
 
»g_idx
, 
FlßtRegB™s
 
v®
, 
Th»adID
 
tid
);

605 
£tCCReg
(
RegIndex
 
»g_idx
, 
CCReg
 
v®
, 
Th»adID
 
tid
);

607 
RegIndex
 
æ©‹nRegIdx
(RegIndex 
»g_idx
, 
RegCÏss
 &
»g_ty³
, 
Th»adID
 
tid
);

610 
MiscReg
 
»adMiscRegNoEfãù
(
misc_»g
, 
Th»adID
 
tid
 = 0);

615 
MiscReg
 
»adMiscReg
(
misc_»g
, 
Th»adID
 
tid
 = 0);

618 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
,

619 
Th»adID
 
tid
 = 0);

624 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
, 
Th»adID
 
tid
 = 0);

629 
ušt64_t
 
»adRegOth”Th»ad
(
misc_»g
,

630 
Th»adID
 
tid
 = 
Inv®idTh»adID
);

635 
£tRegOth”Th»ad
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
,

636 
Th»adID
 
tid
);

639 
	gTheISA
::
PCS‹


640 
	$pcS‹
(
Th»adID
 
tid
)

642  
pc
[
tid
];

643 
	}
}

647 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
ÃwPC
, 
Th»adID
 
tid
)

649 
	gpc
[
tid
] = 
ÃwPC
;

652 
Addr
 
	$š¡Addr
(
Th»adID
 
tid
è{  
pc
[tid].
	`š¡Addr
(); 
	}
}

653 
Addr
 
	$ÃxtIn¡Addr
(
Th»adID
 
tid
è{  
pc
[tid].
	`ÃxtIn¡Addr
(); 
	}
}

654 
MiüoPC
 
	$miüoPC
(
Th»adID
 
tid
è{  
pc
[tid].
	`miüoPC
(); 
	}
}

659 
Li¡It
 
addIn¡
(
DynIn¡PŒ
 
š¡
);

662 
Li¡It
 
fšdIn¡
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
);

665 
š¡DÚe
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
);

668 
addToRemoveLi¡
(
DynIn¡PŒ
 
š¡
);

671 
»moveIn¡
(
DynIn¡PŒ
 
š¡
);

674 
»moveIn¡sUÁ
(cÚ¡ 
In¡SeqNum
 &
£q_num
,
Th»adID
 
tid
);

677 
šlše
 
squashIn¡It
(cÚ¡ 
Li¡It
 
š¡_™
, 
Th»adID
 
tid
);

680 
ş—nUpRemovedIn¡s
();

683 
ş—nUpRemovedEv’ts
();

686 
dumpIn¡s
();

691 
FauÉ
 
»ad
(
DynIn¡PŒ
 
š¡
, 
Addr
 
addr
,

692 
ušt8_t
 *
d©a
, 
size
, 
æags
);

697 
FauÉ
 
wr™e
(
DynIn¡PŒ
 
š¡
, 
ušt8_t
 *
d©a
, 
size
,

698 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
wr™e_»s
 = 
NULL
);

700 
	gpublic
:

702 
¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
[
TheP–še
::
MaxTh»ads
];

707 
	g¡d
::
queue
<
Li¡It
> 
»moveLi¡
;

709 
boŞ
 
	gŒ­P’dšg
[
TheP–še
::
MaxTh»ads
];

714 
	g¡d
::
queue
<
Ev’t
*> 
ıuEv’tRemoveLi¡
;

719 
boŞ
 
	g»moveIn¡sThisCyşe
;

724 
boŞ
 
	gnÚS³cIn¡Aùive
[
TheP–še
::
MaxTh»ads
];

727 
In¡SeqNum
 
	gnÚS³cSeqNum
[
TheP–še
::
MaxTh»ads
];

730 
In¡SeqNum
 
	gsquashSeqNum
[
TheP–še
::
MaxTh»ads
];

733 
Tick
 
	gÏ¡SquashCyşe
[
TheP–še
::
MaxTh»ads
];

735 
	g¡d
::
li¡
<
Th»adID
> 
ãtchPriÜ™yLi¡
;

737 
	g´Ùeùed
:

739 
¡d
::
li¡
<
Th»adID
> 
aùiveTh»ads
;

742 
	g¡d
::
li¡
<
Th»adID
> 
»adyTh»ads
;

745 
	g¡d
::
li¡
<
Th»adID
> 
su¥’dedTh»ads
;

748 
	g¡d
::
li¡
<
Th»adID
> 
h®‹dTh»ads
;

751 
boŞ
 
isTh»adAùive
(
Th»adID
 
tid
);

752 
boŞ
 
isTh»adR—dy
(
Th»adID
 
tid
);

753 
boŞ
 
isTh»adSu¥’ded
(
Th»adID
 
tid
);

755 
	g´iv©e
:

760 
Aùiv™yRecÜd”
 
aùiv™yRec
;

762 
	gpublic
:

764 
Th»adID
 
	$numAùiveTh»ads
(è{  
aùiveTh»ads
.
	`size
(); 
	}
}

770 
Th»adID
 
	$aùiveTh»adId
()

772 ià(
	`numAùiveTh»ads
() > 0)

773  
aùiveTh»ads
.
	`äÚt
();

775  
Inv®idTh»adID
;

776 
	}
}

780 
	$aùiv™yThisCyşe
(è{ 
aùiv™yRec
.
	`aùiv™y
(); 
	}
}

783 
	$aùiv©eSge
(cÚ¡ 
idx
)

784 { 
aùiv™yRec
.
	`aùiv©eSge
(
idx
); 
	}
}

787 
	$d—ùiv©eSge
(cÚ¡ 
idx
)

788 { 
aùiv™yRec
.
	`d—ùiv©eSge
(
idx
); 
	}
}

791 
wakeCPU
();

793 
vœtu®
 
wakeup
();

806 
Th»adCÚ‹xt
 *
	$tcBa£
(
Th»adID
 
tid
 = 0)

808  
th»ad
[
tid
]->
	`g‘TC
();

809 
	}
}

812 
vœtu®
 
CouÁ”
 
	$tÙ®In¡s
() const

814 
CouÁ”
 
	`tÙ®
(0);

816 
Th»adID
 
tid
 = 0;id < (Th»adID)
th»ad
.
	`size
();id++)

817 
tÙ®
 +ğ
th»ad
[
tid
]->
numIn¡
;

819  
tÙ®
;

820 
	}
}

823 
vœtu®
 
CouÁ”
 
	$tÙ®Ops
() const

825 
CouÁ”
 
	`tÙ®
(0);

827 
Th»adID
 
tid
 = 0;id < (Th»adID)
th»ad
.
	`size
();id++)

828 
tÙ®
 +ğ
th»ad
[
tid
]->
numOp
;

830  
tÙ®
;

831 
	}
}

834 
Sy¡em
 *
	gsy¡em
;

837 
In¡SeqNum
 
	gglob®SeqNum
[
TheP–še
::
MaxTh»ads
];

839 #ifdeà
DEBUG


841 
In¡SeqNum
 
	gıuEv’tNum
;

844 
	g»sReqCouÁ
;

847 
Addr
 
	glockAddr
;

850 
boŞ
 
	glockFÏg
;

853 
	gd¿šCouÁ
;

856 
	g¡d
::
veùÜ
<
Th»ad
 *> 
th»ad
;

859 
boŞ
 
	g¡ageT¿cšg
;

862 
Tick
 
	gÏ¡RuÂšgCyşe
;

864 
upd©eCÚ‹xtSw™chSts
();

865 
	gš¡sP”Sw™ch
;

866 
	gSts
::
Av”age
 
š¡sP”CtxtSw™ch
;

867 
	gSts
::
SÿÏr
 
numCtxtSw™ches
;

870 
šlše
 
tickTh»adSts
();

873 
	gSts
::
VeùÜ
 
th»adCyşes
;

876 
	gSts
::
SÿÏr
 
smtCyşes
;

879 
	gSts
::
SÿÏr
 
timesIdËd
;

884 
	gSts
::
SÿÏr
 
idËCyşes
;

887 
	gSts
::
SÿÏr
 
runCyşes
;

890 
	gSts
::
FÜmuÏ
 
aùiv™y
;

893 
	gSts
::
SÿÏr
 
comLßds
;

894 
	gSts
::
SÿÏr
 
comStÜes
;

895 
	gSts
::
SÿÏr
 
comB¿nches
;

896 
	gSts
::
SÿÏr
 
comNİs
;

897 
	gSts
::
SÿÏr
 
comNÚS³c
;

898 
	gSts
::
SÿÏr
 
comIÁs
;

899 
	gSts
::
SÿÏr
 
comFlßts
;

902 
	gSts
::
VeùÜ
 
comm™‹dIn¡s
;

905 
	gSts
::
VeùÜ
 
comm™‹dOps
;

908 
	gSts
::
VeùÜ
 
smtComm™‹dIn¡s
;

911 
	gSts
::
SÿÏr
 
tÙ®Comm™‹dIn¡s
;

914 
	gSts
::
FÜmuÏ
 
ıi
;

917 
	gSts
::
FÜmuÏ
 
smtCpi
;

920 
	gSts
::
FÜmuÏ
 
tÙ®Cpi
;

923 
	gSts
::
FÜmuÏ
 
c
;

926 
	gSts
::
FÜmuÏ
 
smtIpc
;

929 
	gSts
::
FÜmuÏ
 
tÙ®Ipc
;

	@inorder/first_stage.cc

32 
	~"ba£/¡r.hh
"

33 
	~"ıu/šÜd”/»sourûs/»sourû_li¡.hh
"

34 
	~"ıu/šÜd”/ıu.hh
"

35 
	~"ıu/šÜd”/fœ¡_¡age.hh
"

36 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

37 
	~"debug/InOrd”Sge.hh
"

38 
	~"·¿ms/InOrd”T¿û.hh
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

41 
usšg
 
Çme¥aû
 
	gTheP–še
;

43 
	gFœ¡Sge
::
	$Fœ¡Sge
(
P¬ams
 *
·¿ms
, 
¡age_num
)

44 : 
	`P–šeSge
(
·¿ms
, 
¡age_num
), 
	`numF‘chšgTh»ads
(1),

45 
	`ãtchPŞicy
(
Fœ¡Sge
::
RoundRobš
)

47 
Th»adID
 
tid
 = 0;id < 
this
->
numTh»ads
;id++) {

48 
¡ageStus
[
tid
] = 
RuÂšg
;

50 
	}
}

53 
	gFœ¡Sge
::
	$£tCPU
(
InOrd”CPU
 *
ıu_±r
)

55 
ıu
 = 
ıu_±r
;

57 
ãtchPriÜ™yLi¡
 = &
ıu
->fetchPriorityList;

59 
	`DPRINTF
(
InOrd”Sge
, "Set CPU…ointer.\n");

60 
	}
}

64 
	gFœ¡Sge
::
	$squash
(
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

71 
	`DPRINTF
(
InOrd”Sge
, "Removing instructions from stage instruction "

73 !
skidBufãr
[
tid
].
	`em±y
()) {

74 ià(
skidBufãr
[
tid
].
	`äÚt
()->
£qNum
 <ğ
squash_£q_num
) {

75 
	`DPRINTF
(
InOrd”Sge
,"[tid:%i]: Cannot„emove [sn:%i] because "

77 
tid
,

78 
skidBufãr
[
tid
].
	`äÚt
()->
£qNum
,

79 
squash_£q_num
);

81 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Cannot„emove incoming "

83 "Ëá.\n", 
tid
, 
squash_£q_num
,

84 
skidBufãr
[
tid
].
	`size
());

87 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Removing instruction, [sn:%i] "

88 "PC %s.\n", 
tid
, 
skidBufãr
[tid].
	`äÚt
()->
£qNum
,

89 
skidBufãr
[
tid
].
	`äÚt
()->
pc
);

90 
skidBufãr
[
tid
].
	`pİ_äÚt
();

96 
ıu
->
	`»moveIn¡sUÁ
(
squash_£q_num
, 
tid
);

97 
	}
}

100 
	gFœ¡Sge
::
	$squashDueToMemSÎ
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
)

107 
	`squash
(
£q_num
+1, 
tid
);

108 
	}
}

112 
	gFœ¡Sge
::
	$´oûssSge
(
boŞ
 &
¡©us_chªge
)

114 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

117 
th»ads
 !ğ
aùiveTh»ads
->
	`’d
()) {

118 
Th»adID
 
tid
 = *
th»ads
++;

119 
¡©us_chªge
 = 
	`checkSigÇlsAndUpd©e
(
tid
) || status_change;

122 
š¡sProûs£d
 < 
¡ageWidth
) {

123 
Th»adID
 
tid
 = 
	`g‘F‘chšgTh»ad
(
ãtchPŞicy
);

125 ià(
tid
 >= 0) {

126 
	`DPRINTF
(
InOrd”Sge
, "Proûssšg [tid:%i]\n",
tid
);

127 
	`´oûssTh»ad
(
¡©us_chªge
, 
tid
);

128 
	`DPRINTF
(
InOrd”Sge
, "DÚProûssšg [tid:%i]\n",
tid
);

130 
	`DPRINTF
(
InOrd”Sge
, "No morehreadso fetch from.\n");

135 ià(
š¡sProûs£d
 > 0) {

136 ++
runCyşes
;

137 
idË
 = 
çl£
;

139 ++
idËCyşes
;

140 
idË
 = 
Œue
;

143 
	}
}

148 
	gFœ¡Sge
::
	$´oûssIn¡s
(
Th»adID
 
tid
)

150 
boŞ
 
®l_»qs_com¶‘ed
 = 
Œue
;

152 
š¡s_ãtched
 = 
š¡sProûs£d
;

153 
š¡s_ãtched
 < 
¡ageWidth
;

154 
š¡s_ãtched
++) {

156 
DynIn¡PŒ
 
š¡
;

157 
boŞ
 
Ãw_š¡
 = 
çl£
;

159 ià(!
skidBufãr
[
tid
].
	`em±y
()) {

160 
š¡
 = 
skidBufãr
[
tid
].
	`äÚt
();

163 
Ãw_š¡
 = 
Œue
;

165 
š¡
 = 
Ãw
 
	`InOrd”DynIn¡
(
ıu
,

166 
ıu
->
th»ad
[
tid
],

167 
ıu
->
	`ÃxtIn¡SeqNum
(
tid
),

168 
tid
,

169 
tid
);

171 #ià
TRACING_ON


172 
š¡
->
ŒaûD©a
 =

173 
Œaûr
->
	`g‘In¡RecÜd
(
TheP–še
::
NumSges
,

174 
ıu
->
¡ageT¿cšg
,

175 
ıu
->
th»ad
[
tid
]->
	`g‘TC
());

178 
š¡
->
ŒaûD©a
 = 
NULL
;

182 
š¡
->
	`£tIn¡Li¡It
(
ıu
->
	`addIn¡
(inst));

185 
š¡
->
	`£tFrÚtSked
(
ıu
->
äÚtEndSked
);

188 
»qs_´oûs£d
 = 0;

189 
®l_»qs_com¶‘ed
 = 
	`´oûssIn¡ScheduË
(
š¡
, 
»qs_´oûs£d
);

194 ià(
»qs_´oûs£d
 > 0)

195 
š¡sProûs£d
++;

197 ià(!
®l_»qs_com¶‘ed
 || !
	`£ndIn¡ToNextSge
(
š¡
)) {

198 ià(
Ãw_š¡
) {

199 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: [sn:%u] Did‚ot finish‡ll "

201 "li¡.\n", 
tid
, 
š¡
->
£qNum
);

202 
skidBufãr
[
tid
].
	`push_back
(
š¡
);

204 
	`block
(
tid
);

206 } ià(!
skidBufãr
[
tid
].
	`em±y
()){

207 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: [sn:%u] Finished‡ll "

208 "»que¡ fÜhi ¡age.\n", 
tid
, 
š¡
->
£qNum
);

209 
skidBufãr
[
tid
].
	`pİ_äÚt
();

216 ià(
š¡sProûs£d
) {

217 
wrÙeToTimeBufãr
 = 
Œue
;

219 
	}
}

221 
Th»adID


222 
	gFœ¡Sge
::
	$g‘F‘chšgTh»ad
(
F‘chPriÜ™y
 &
ãtch_´iÜ™y
)

224 
Th»adID
 
num_aùive_th»ads
 = 
ıu
->
	`numAùiveTh»ads
();

226 ià(
num_aùive_th»ads
 > 1) {

227 
ãtch_´iÜ™y
) {

228 
SšgËTh»ad
:

229  
ıu
->
	`aùiveTh»adId
();

231 
RoundRobš
:

232  
	`roundRobš
();

235  
Inv®idTh»adID
;

237 } ià(
num_aùive_th»ads
 == 1) {

238 
Th»adID
 
tid
 = *
aùiveTh»ads
->
	`begš
();

240 ià(
¡ageStus
[
tid
] =ğ
RuÂšg
 ||

241 
¡ageStus
[
tid
] =ğ
IdË
 ||

242 
¡ageStus
[
tid
] =ğ
Unblockšg
) {

243  
tid
;

245  
Inv®idTh»adID
;

248  
Inv®idTh»adID
;

250 
	}
}

252 
Th»adID


253 
	gFœ¡Sge
::
	$roundRobš
()

255 
li¡
<
Th»adID
>::
™”©Ü
 
´i_™”
 = 
ãtchPriÜ™yLi¡
->
	`begš
();

256 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
ãtchPriÜ™yLi¡
->
	`’d
();

258 
Th»adID
 
high_´i
;

260 
´i_™”
 !ğ
’d
) {

261 
high_´i
 = *
´i_™”
;

263 
	`as£¹
(
high_´i
 <ğ
numTh»ads
);

265 ià(
¡ageStus
[
high_´i
] =ğ
RuÂšg
 ||

266 
¡ageStus
[
high_´i
] =ğ
IdË
 ||

267 
¡ageStus
[
high_´i
] =ğ
Unblockšg
){

269 
ãtchPriÜ™yLi¡
->
	`”a£
(
´i_™”
);

270 
ãtchPriÜ™yLi¡
->
	`push_back
(
high_´i
);

272  
high_´i
;

275 
´i_™”
++;

278  
Inv®idTh»adID
;

279 
	}
}

	@inorder/first_stage.hh

32 #iâdeà
__CPU_INORDER_FIRST_STAGE_HH__


33 
	#__CPU_INORDER_FIRST_STAGE_HH__


	)

35 
	~<queue
>

36 
	~<veùÜ
>

38 
	~"ba£/¡©i¡ics.hh
"

39 
	~"ıu/šÜd”/comm.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_¡age.hh
"

42 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

43 
	~"ıu/timebuf.hh
"

45 
şass
 
	gInOrd”CPU
;

47 şas 
	cFœ¡Sge
 : 
public
 
P–šeSge
 {

48 
public
:

49 
Fœ¡Sge
(
TheP–še
::
P¬ams
 *
·¿ms
, 
¡age_num
);

52 
£tCPU
(
InOrd”CPU
 *
ıu_±r
);

55 
´oûssSge
(
boŞ
 &
¡©us_chªge
);

58 
´oûssIn¡s
(
Th»adID
 
tid
);

61 
squash
(
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

63 
squashDueToMemSÎ
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
);

68 
	$sÜtIn¡s
() {}

71 
numF‘chšgTh»ads
;

75 
	eF‘chPriÜ™y
 {

76 
SšgËTh»ad
,

77 
RoundRobš


78 
	}
};

81 
F‘chPriÜ™y
 
	gãtchPŞicy
;

84 
	g¡d
::
li¡
<
Th»adID
> *
ãtchPriÜ™yLi¡
;

87 
Th»adID
 
g‘F‘chšgTh»ad
(
F‘chPriÜ™y
 &
ãtch_´iÜ™y
);

90 
Th»adID
 
roundRobš
();

	@inorder/inorder_cpu_builder.cc

32 
	~<¡ršg
>

34 
	~"ıu/šÜd”/ıu.hh
"

35 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

36 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

37 
	~"ıu/ba£.hh
"

38 
	~"ıu/š¡_£q.hh
"

39 
	~"ıu/¡©ic_š¡.hh
"

40 
	~"·¿ms/InOrd”CPU.hh
"

41 
	~"sim/fuÎ_sy¡em.hh
"

43 
InOrd”CPU
 *

44 
	gInOrd”CPUP¬ams
::
	$ü—‹
()

46 
Th»adID
 
aùu®_num_th»ads
;

47 ià(
FuÎSy¡em
) {

49 
aùu®_num_th»ads
 = 1;

51 
aùu®_num_th»ads
 =

52 (
numTh»ads
 >ğ
wÜklßd
.
	`size
()) ?‚umThreads : workload.size();

54 ià(
wÜklßd
.
	`size
() == 0) {

55 
	`çl
("Must specify‡t†east one workload!");

59 
numTh»ads
 = 
aùu®_num_th»ads
;

60  
Ãw
 
	`InOrd”CPU
(
this
);

61 
	}
}

	@inorder/inorder_dyn_inst.cc

33 
	~<io¡»am
>

34 
	~<£t
>

35 
	~<s¡»am
>

36 
	~<¡ršg
>

38 
	~"ba£/bigšt.hh
"

39 
	~"ba£/ı_ªnÙ©e.hh
"

40 
	~"ba£/ırštf.hh
"

41 
	~"ba£/Œaû.hh
"

42 
	~"cÚfig/the_i§.hh
"

43 
	~"ıu/šÜd”/ıu.hh
"

44 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

45 
	~"ıu/ex‘¿û.hh
"

46 
	~"ıu/»g_şass.hh
"

47 
	~"debug/InOrd”DynIn¡.hh
"

48 
	~"mem/»que¡.hh
"

49 
	~"sim/çuÉ_fwd.hh
"

50 
	~"sim/fuÎ_sy¡em.hh
"

52 
usšg
 
Çme¥aû
 
	g¡d
;

53 
usšg
 
Çme¥aû
 
	gTheISA
;

54 
usšg
 
Çme¥aû
 
	gTheP–še
;

56 
	gInOrd”DynIn¡
::
	$InOrd”DynIn¡
(
InOrd”CPU
 *
ıu
,

57 
InOrd”Th»adS‹
 *
¡©e
,

58 
In¡SeqNum
 
£q_num
,

59 
Th»adID
 
tid
,

60 
_asid
)

61 : 
	`£qNum
(
£q_num
), 
	`squashSeqNum
(0), 
	`th»adNumb”
(
tid
), 
	`asid
(
_asid
),

62 
	`vœtProcNumb”
(0), 
	`¡©icIn¡
(
NULL
), 
	`ŒaûD©a
(NULL), 
	`ıu
(
ıu
),

63 
	`th»ad
(
¡©e
), 
	`çuÉ
(
NoFauÉ
), 
	`memD©a
(
NULL
), 
	`lßdD©a
(0),

64 
	`¡ÜeD©a
(0), 
	`effAddr
(0), 
	`physEffAddr
(0), 
	`memReqFÏgs
(0),

65 
	`»adyRegs
(0), 
	`pc
(0), 
	`´edPC
(0), 
	`memAddr
(0), 
	`ÃxtSge
(0),

66 
	`memTime
(0), 
	`¥l™MemD©a
(
NULL
), 
	`¥l™MemReq
(NULL), 
	`tÙ®Size
(0),

67 
	`¥l™2ndSize
(0), 
	`¥l™2ndAddr
(0), 
	`¥l™2ndAcûss
(
çl£
),

68 
	`¥l™2ndD©aPŒ
(
NULL
), 
	`¥l™2ndFÏgs
(0), 
	`¥l™In¡
(
çl£
),

69 
	`¥l™FšishCÁ
(0), 
	`¥l™2ndStÜeD©aPŒ
(
NULL
), 
	`¥l™In¡Sked
(
çl£
),

70 
	`šFrÚtEnd
(
Œue
), 
	`äÚtSked
(
NULL
), 
	`backSked
(NULL),

71 
	`squashšgSge
(0), 
	`´ediùTak’
(
çl£
), 
	`´ocD–aySlÙOnMi¥»d
(false),

72 
	`ãtchMemReq
(
NULL
), 
	`d©aMemReq
(NULL), 
	`š¡EffAddr
(0), 
	`—C®cDÚe
(
çl£
),

73 
	`lqIdx
(0), 
	`sqIdx
(0), 
	$ÚIn¡Li¡
(
çl£
)

75 
i
 = 0; i < 
MaxIn¡SrcRegs
; i++) {

76 
_»adySrcRegIdx
[
i
] = 
çl£
;

77 
_¤cRegIdx
[
i
] = 0;

80 
j
 = 0; j < 
MaxIn¡De¡Regs
; j++) {

81 
_de¡RegIdx
[
j
] = 0;

82 
_´evDe¡RegIdx
[
j
] = 0;

85 ++
š¡couÁ
;

86 
	`DPRINTF
(
InOrd”DynIn¡
, "DynInst: [tid:%i] [sn:%lli] Instruction created."

87 " (aùivš¡s: %i)\n", 
th»adNumb”
, 
£qNum
, 
š¡couÁ
);

89 
	}
}

91 
	gInOrd”DynIn¡
::
š¡couÁ
 = 0;

94 
	gInOrd”DynIn¡
::
	$ıuId
()

96  
ıu
->
	`ıuId
();

97 
	}
}

100 
	gInOrd”DynIn¡
::
	$£tSticIn¡
(
SticIn¡PŒ
 
si
)

102 
¡©icIn¡
 = 
si
;

104 
i
 = 0; i < 
this
->
¡©icIn¡
->
	`numDe¡Regs
(); i++) {

105 
_de¡RegIdx
[
i
] = 
this
->
¡©icIn¡
->
	`de¡RegIdx
(i);

108 
i
 = 0; i < 
this
->
¡©icIn¡
->
	`numSrcRegs
(); i++) {

109 
_¤cRegIdx
[
i
] = 
this
->
¡©icIn¡
->
	`¤cRegIdx
(i);

110 
this
->
_»adySrcRegIdx
[
i
] = 0;

112 
	}
}

115 
	gInOrd”DynIn¡
::
	$š™V¬s
()

117 
šFrÚtEnd
 = 
Œue
;

119 
ãtchMemReq
 = 
NULL
;

120 
d©aMemReq
 = 
NULL
;

121 
¥l™MemD©a
 = 
NULL
;

122 
¥l™2ndAddr
 = 0;

123 
¥l™2ndAcûss
 = 
çl£
;

124 
¥l™In¡
 = 
çl£
;

125 
¥l™In¡Sked
 = 
çl£
;

126 
¥l™FšishCÁ
 = 0;

128 
effAddr
 = 0;

129 
physEffAddr
 = 0;

131 
»adyRegs
 = 0;

133 
ÃxtSge
 = 0;

135 
¡©us
.
	`»£t
();

137 
memAddrR—dy
 = 
çl£
;

138 
—C®cDÚe
 = 
çl£
;

140 
´ediùTak’
 = 
çl£
;

141 
´ocD–aySlÙOnMi¥»d
 = 
çl£
;

143 
lqIdx
 = -1;

144 
sqIdx
 = -1;

147 
asid
 = 0;

149 
vœtProcNumb”
 = 0;

152 
çuÉ
 = 
NoFauÉ
;

157 ià(
this
->
¡©icIn¡
) {

158 
i
 = 0; i < 
this
->
¡©icIn¡
->
	`numDe¡Regs
(); i++) {

159 
_de¡RegIdx
[
i
] = 
this
->
¡©icIn¡
->
	`de¡RegIdx
(i);

162 
i
 = 0; i < 
this
->
¡©icIn¡
->
	`numSrcRegs
(); i++) {

163 
_¤cRegIdx
[
i
] = 
this
->
¡©icIn¡
->
	`¤cRegIdx
(i);

164 
this
->
_»adySrcRegIdx
[
i
] = 0;

169 ià(
š¡couÁ
 > 100) {

170 
	`çl
("Number of Active Instructions in CPU isoo high. "

173 
	}
}

176 
	gInOrd”DynIn¡
::
	$»£tIn¡CouÁ
()

178 
š¡couÁ
 = 0;

179 
	}
}

182 
	gInOrd”DynIn¡
::~
	$InOrd”DynIn¡
()

184 ià(
ŒaûD©a
)

185 
d–‘e
 
ŒaûD©a
;

187 ià(
¥l™MemD©a
)

188 
d–‘e
 [] 
¥l™MemD©a
;

190 
çuÉ
 = 
NoFauÉ
;

192 --
š¡couÁ
;

194 
	`DPRINTF
(
InOrd”DynIn¡
, "DynInst: [tid:%i] [sn:%lli] Instruction destroyed"

195 " (aùivš¡s: %i)\n", 
th»adNumb”
, 
£qNum
, 
š¡couÁ
);

196 
	}
}

199 
	gInOrd”DynIn¡
::
	$£tSticIn¡
(
SticIn¡PŒ
 &
¡©ic_š¡
)

201 
this
->
¡©icIn¡
 = 
¡©ic_š¡
;

206 ià(
this
->
¡©icIn¡
) {

207 
i
 = 0; i < 
this
->
¡©icIn¡
->
	`numDe¡Regs
(); i++) {

208 
_de¡RegIdx
[
i
] = 
this
->
¡©icIn¡
->
	`de¡RegIdx
(i);

211 
i
 = 0; i < 
this
->
¡©icIn¡
->
	`numSrcRegs
(); i++) {

212 
_¤cRegIdx
[
i
] = 
this
->
¡©icIn¡
->
	`¤cRegIdx
(i);

213 
this
->
_»adySrcRegIdx
[
i
] = 0;

216 
	}
}

218 
FauÉ


219 
	gInOrd”DynIn¡
::
	$execu‹
()

225 
boŞ
 
no_squash_äom_TC
 = 
this
->
th»ad
->
noSquashFromTC
;

226 
this
->
th»ad
->
noSquashFromTC
 = 
Œue
;

228 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`execu‹
Ñhis,his->
ŒaûD©a
);

230 
this
->
th»ad
->
noSquashFromTC
 = 
no_squash_äom_TC
;

232  
this
->
çuÉ
;

233 
	}
}

235 
FauÉ


236 
	gInOrd”DynIn¡
::
	$ÿlcEA
()

238 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`—Comp
Ñhis,his->
ŒaûD©a
);

239  
this
->
çuÉ
;

240 
	}
}

242 
FauÉ


243 
	gInOrd”DynIn¡
::
	$š™Ÿ‹Acc
()

249 
boŞ
 
no_squash_äom_TC
 = 
this
->
th»ad
->
noSquashFromTC
;

250 
this
->
th»ad
->
noSquashFromTC
 = 
Œue
;

252 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`š™Ÿ‹Acc
Ñhis,his->
ŒaûD©a
);

254 
this
->
th»ad
->
noSquashFromTC
 = 
no_squash_äom_TC
;

256  
this
->
çuÉ
;

257 
	}
}

260 
FauÉ


261 
	gInOrd”DynIn¡
::
	$com¶‘eAcc
(
Pack‘
 *
pkt
)

263 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`com¶‘eAcc
(
pkt
,his,his->
ŒaûD©a
);

265  
this
->
çuÉ
;

266 
	}
}

268 
FauÉ


269 
	gInOrd”DynIn¡
::
	$memAcûss
()

271  
	`š™Ÿ‹Acc
();

272 
	}
}

275 
FauÉ


276 
	gInOrd”DynIn¡
::
	$hw»i
()

278 #ià
THE_ISA
 =ğ
ALPHA_ISA


280 ià(!(
this
->
	`š¡Addr
() & 0x3))

281  
Ãw
 
AÍhaISA
::
Unim¶em’‹dOpcodeFauÉ
;

284 
AÍhaISA
::
PCS‹
 
pc
 = 
this
->
	`pcS‹
();

285 
pc
.
	`Åc
(
this
->
ıu
->
	`»adMiscRegNoEfãù
(
AÍhaISA
::
IPR_EXC_ADDR
,

286 
this
->
th»adNumb”
));

287 
this
->
	`pcS‹
(
pc
);

288 ià(
CPA
::
	`avaabË
()) {

289 
Th»adCÚ‹xt
 *
tc
 = 
this
->
ıu
->
	`tcBa£
Ñhis->
th»adNumb”
);

290 
CPA
::
	`ıa
()->
	`swAutoBegš
(
tc
, 
this
->
	`ÃxtIn¡Addr
());

294 
this
->
ıu
->
	`hw»i
Ñhis->
th»adNumb”
);

296  
NoFauÉ
;

297 
	}
}

301 
	gInOrd”DynIn¡
::
	$Œ­
(
FauÉ
 
çuÉ
)

303 
this
->
ıu
->
	`Œ­
(
çuÉ
,his->
th»adNumb”
,his);

304 
	}
}

307 
boŞ


308 
	gInOrd”DynIn¡
::
	$simP®Check
(
·lFunc
)

310 #ià
THE_ISA
 !ğ
ALPHA_ISA


311 
	`·nic
("simPalCheck called, but PAL onlyƒxists in Alpha!\n");

313  
this
->
ıu
->
	`simP®Check
(
·lFunc
,his->
th»adNumb”
);

314 
	}
}

317 
	gInOrd”DynIn¡
::
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

319 ià(
FuÎSy¡em
)

320 
	`·nic
("Syscallƒmulation isn't‡vailable in FS mode.\n");

322 
sysÿÎNum
 = 
ÿÎnum
;

323 
ıu
->
	`sysÿÎCÚ‹xt
(
NoFauÉ
, 
this
->
th»adNumb”
,his);

324 
	}
}

327 
	gInOrd”DynIn¡
::
	$£tSquashInfo
(
¡age_num
)

329 
squashšgSge
 = 
¡age_num
;

335 ià(
çuÉ
 !ğ
NoFauÉ
) {

336 
squashSeqNum
 = 
£qNum
 - 1;

339 
squashSeqNum
 = 
£qNum
;

341 #ià
ISA_HAS_DELAY_SLOT


342 ià(
¡©icIn¡
 && 
	`isCÚŒŞ
()) {

343 
TheISA
::
PCS‹
 
ÃxtPC
 = 
pc
;

344 
TheISA
::
	`advªûPC
(
ÃxtPC
, 
¡©icIn¡
);

348 ià(
pc
.
	`ÃxtIn¡Addr
(è=ğpc.
	`š¡Addr
(è+ (
MachIn¡
))

349 
squashSeqNum
 = 
£qNum
 + 1;

351 
squashSeqNum
 = 
£qNum
;

354 
	}
}

357 
	gInOrd”DynIn¡
::
	$»Ëa£Req
(
ResourûReque¡
* 
»q
)

359 
¡d
::
li¡
<
ResourûReque¡
*>::
™”©Ü
 
li¡_™
 = 
»qLi¡
.
	`begš
();

360 
¡d
::
li¡
<
ResourûReque¡
*>::
™”©Ü
 
li¡_’d
 = 
»qLi¡
.
	`’d
();

362 
li¡_™
 !ğ
li¡_’d
) {

363 if((*
li¡_™
)->
	`g‘ResIdx
(è=ğ
»q
->getResIdx() &&

364 (*
li¡_™
)->
	`g‘SlÙ
(è=ğ
»q
->getSlot()) {

365 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%u]: [sn:%i] Done with„equest "

366 "tØ%s.\n", 
th»adNumb”
, 
£qNum
, 
»q
->
»s
->
	`Çme
());

367 
»qLi¡
.
	`”a£
(
li¡_™
);

370 
li¡_™
++;

373 
	`·nic
("Releasing Res. Request That Isnt There!\n");

374 
	}
}

378 
	gInOrd”DynIn¡
::
	$£tIÁSrc
(
idx
, 
ušt64_t
 
v®
)

380 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] [src:%i] Int being set "

381 "tØ%#x.\n", 
th»adNumb”
, 
£qNum
, 
idx
, 
v®
);

382 
š¡Src
[
idx
].
štV®
 = 
v®
;

383 
	}
}

387 
	gInOrd”DynIn¡
::
	$£tFlßtSrc
(
idx
, 
FlßtReg
 
v®
)

389 
š¡Src
[
idx
].
åV®
.
f
 = 
v®
;

390 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] [src:%i] FP being set "

391 "tØ%x, %08f...%08f\n", 
th»adNumb”
, 
£qNum
, 
idx
,

392 
š¡Src
[
idx
].
åV®
.
i
, in¡Src[idx].åV®.
f
, 
v®
);

393 
	}
}

397 
	gInOrd”DynIn¡
::
	$£tFlßtRegB™sSrc
(
idx
, 
FlßtRegB™s
 
v®
)

399 
š¡Src
[
idx
].
åV®
.
i
 = 
v®
;

400 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] [src:%i] FPBits being set "

401 "tØ%x, %08f...%x\n", 
th»adNumb”
, 
£qNum
, 
idx
,

402 
š¡Src
[
idx
].
åV®
.
i
, in¡Src[idx].åV®.
f
, 
v®
);

403 
	}
}

406 
IÁReg


407 
	gInOrd”DynIn¡
::
	$»adIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
Th»adID
 
tid
)

409 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] [src:%i] IntVal„ead‡s %#x.\n",

410 
th»adNumb”
, 
£qNum
, 
idx
, 
š¡Src
[idx].
štV®
);

411  
š¡Src
[
idx
].
štV®
;

412 
	}
}

415 
FlßtReg


416 
	gInOrd”DynIn¡
::
	$»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

418 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] [src:%i] FPVal being„ead "

419 "a %x, %08f.\n", 
th»adNumb”
, 
£qNum
, 
idx
,

420 
š¡Src
[
idx
].
åV®
.
i
, in¡Src[idx].åV®.
f
);

421  
š¡Src
[
idx
].
åV®
.
f
;

422 
	}
}

426 
FlßtRegB™s


427 
	gInOrd”DynIn¡
::
	$»adFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

429 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] [src:%i] FPBits being„ead "

430 "a %x, %08f.\n", 
th»adNumb”
, 
£qNum
, 
idx
,

431 
š¡Src
[
idx
].
åV®
.
i
, in¡Src[idx].åV®.
f
);

432  
š¡Src
[
idx
].
åV®
.
i
;

433 
	}
}

436 
MiscReg


437 
	gInOrd”DynIn¡
::
	$»adMiscReg
(
misc_»g
)

439  
this
->
ıu
->
	`»adMiscReg
(
misc_»g
, 
th»adNumb”
);

440 
	}
}

446 
MiscReg


447 
	gInOrd”DynIn¡
::
	$»adMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

449 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] Misc. Reg Source Value %i"

450 "„—d‡ %#x.\n", 
th»adNumb”
, 
£qNum
, 
idx
,

451 
š¡Src
[
idx
].
štV®
);

452  
š¡Src
[
idx
].
štV®
;

453 
	}
}

460 
	gInOrd”DynIn¡
::
	$£tMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

461 cÚ¡ 
MiscReg
 &
v®
)

463 
š¡ResuÉ
[
idx
].
ty³
 = 
IÁeg”
;

464 
š¡ResuÉ
[
idx
].
»s
.
štV®
 = 
v®
;

465 
š¡ResuÉ
[
idx
].
tick
 = 
	`curTick
();

467 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] Setting Misc Reg. Operand %i "

468 "bešg s‘Ø%#x.\n", 
th»adNumb”
, 
£qNum
, 
idx
, 
v®
);

469 
	}
}

471 
MiscReg


472 
	gInOrd”DynIn¡
::
	$»adRegOth”Th»ad
(
»g_idx
, 
Th»adID
 
tid
)

474 ià(
tid
 == -1) {

475 
tid
 = 
TheISA
::
	`g‘T¬g‘Th»ad
(
this
->
ıu
->
	`tcBa£
(
th»adNumb”
));

478 
RegIndex
 
»l_idx
;

480 
	`»gIdxToCÏss
(
»g_idx
, &
»l_idx
)) {

481 
IÁRegCÏss
:

482  
this
->
ıu
->
	`»adIÁReg
(
»l_idx
, 
tid
);

484 
FlßtRegCÏss
:

485  
this
->
ıu
->
	`»adFlßtRegB™s
(
»l_idx
, 
tid
);

487 
MiscRegCÏss
:

488  
this
->
ıu
->
	`»adMiscReg
(
»l_idx
, 
tid
);

491 
	`·nic
("»gi¡” %d ouˆoà¿nge\n", 
»g_idx
);

494 
	}
}

498 
	gInOrd”DynIn¡
::
	$£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
IÁReg
 
v®
)

500 
š¡ResuÉ
[
idx
].
ty³
 = 
IÁeg”
;

501 
š¡ResuÉ
[
idx
].
»s
.
štV®
 = 
v®
;

502 
š¡ResuÉ
[
idx
].
tick
 = 
	`curTick
();

504 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] Setting Result Int Reg. %i "

506 
th»adNumb”
, 
£qNum
, 
idx
, 
v®
, 
š¡ResuÉ
[idx].
tick
);

507 
	}
}

511 
	gInOrd”DynIn¡
::
	$£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
)

513 
š¡ResuÉ
[
idx
].
ty³
 = 
Flßt
;

514 
š¡ResuÉ
[
idx
].
»s
.
åV®
.
f
 = 
v®
;

515 
š¡ResuÉ
[
idx
].
tick
 = 
	`curTick
();

517 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] Result Float Reg. %i "

519 
th»adNumb”
, 
£qNum
, 
idx
, 
v®
, v®, 
š¡ResuÉ
[idx].
tick
);

520 
	}
}

524 
	gInOrd”DynIn¡
::
	$£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

525 
FlßtRegB™s
 
v®
)

527 
š¡ResuÉ
[
idx
].
ty³
 = 
FlßtB™s
;

528 
š¡ResuÉ
[
idx
].
»s
.
åV®
.
i
 = 
v®
;

529 
š¡ResuÉ
[
idx
].
tick
 = 
	`curTick
();

531 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] Result Float Reg. Bits %i "

533 
th»adNumb”
, 
£qNum
, 
idx
, 
v®
, 
š¡ResuÉ
[idx].
tick
);

534 
	}
}

541 
	gInOrd”DynIn¡
::
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

543 
this
->
ıu
->
	`£tMiscReg
(
misc_»g
, 
v®
, 
th»adNumb”
);

544 
	}
}

547 
	gInOrd”DynIn¡
::
	$£tRegOth”Th»ad
(
»g_idx
, cÚ¡ 
MiscReg
 &
v®
,

548 
Th»adID
 
tid
)

550 ià(
tid
 =ğ
Inv®idTh»adID
) {

551 
tid
 = 
TheISA
::
	`g‘T¬g‘Th»ad
(
this
->
ıu
->
	`tcBa£
(
th»adNumb”
));

554 
RegIndex
 
»l_idx
;

556 
	`»gIdxToCÏss
(
»g_idx
, &
»l_idx
)) {

557 
IÁRegCÏss
:

558 
this
->
ıu
->
	`£tIÁReg
(
»l_idx
, 
v®
, 
tid
);

561 
FlßtRegCÏss
:

562 
this
->
ıu
->
	`£tFlßtRegB™s
(
»l_idx
, 
v®
, 
tid
);

565 
CCRegCÏss
:

566 
this
->
ıu
->
	`£tCCReg
(
»l_idx
, 
v®
, 
tid
);

569 
MiscRegCÏss
:

570 
this
->
ıu
->
	`£tMiscReg
(
»l_idx
, 
v®
, 
tid
);

573 
	}
}

576 
	gInOrd”DynIn¡
::
	$d—Îoÿ‹CÚ‹xt
(
th»ad_num
)

578 
this
->
ıu
->
	`d—Îoÿ‹CÚ‹xt
(
th»ad_num
);

579 
	}
}

581 
FauÉ


582 
	gInOrd”DynIn¡
::
	$»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
,

583 
size
, 
æags
)

585  
ıu
->
	`»ad
(
this
, 
addr
, 
d©a
, 
size
, 
æags
);

586 
	}
}

588 
FauÉ


589 
	gInOrd”DynIn¡
::
	$wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

590 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
)

592  
ıu
->
	`wr™e
(
this
, 
d©a
, 
size
, 
addr
, 
æags
, 
»s
);

593 
	}
}

597 
	gInOrd”DynIn¡
::
	$dump
()

599 
	`ırštf
("T%d : %#08d `", 
th»adNumb”
, 
pc
.
	`š¡Addr
());

600 
cout
 << 
¡©icIn¡
->
	`di§s£mbË
(
pc
.
	`š¡Addr
());

601 
	`ırštf
("'\n");

602 
	}
}

605 
	gInOrd”DynIn¡
::
dump
(
¡d
::
¡ršg
 &
out¡ršg
)

607 
¡d
::
o¡ršg¡»am
 
s
;

608 
	gs
 << "T" << 
	gth»adNumb”
 << " : " << 
	gpc
 << " "

609 << 
	g¡©icIn¡
->
di§s£mbË
(
pc
.
š¡Addr
());

611 
	gout¡ršg
 = 
s
.
¡r
();

	@inorder/inorder_dyn_inst.hh

34 #iâdeà
__CPU_INORDER_DYN_INST_HH__


35 
	#__CPU_INORDER_DYN_INST_HH__


	)

37 
	~<b™£t
>

38 
	~<li¡
>

39 
	~<¡ršg
>

41 
	~"¬ch/i§_Œa™s.hh
"

42 
	~"¬ch/mt.hh
"

43 
	~"¬ch/ty³s.hh
"

44 
	~"¬ch/ut™y.hh
"

45 
	~"ba£/Œaû.hh
"

46 
	~"ba£/ty³s.hh
"

47 
	~"cÚfig/the_i§.hh
"

48 
	~"ıu/šÜd”/šÜd”_Œaû.hh
"

49 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

50 
	~"ıu/šÜd”/»sourû.hh
"

51 
	~"ıu/šÜd”/»sourû_sked.hh
"

52 
	~"ıu/šÜd”/th»ad_¡©e.hh
"

53 
	~"ıu/ex‘¿û.hh
"

54 
	~"ıu/š¡_£q.hh
"

55 
	~"ıu/İ_şass.hh
"

56 
	~"ıu/¡©ic_š¡.hh
"

57 
	~"ıu/th»ad_cÚ‹xt.hh
"

58 
	~"debug/InOrd”DynIn¡.hh
"

59 
	~"mem/·ck‘.hh
"

60 
	~"sim/çuÉ_fwd.hh
"

61 
	~"sim/sy¡em.hh
"

63 #ià
THE_ISA
 =ğ
ALPHA_ISA


64 
	~"¬ch/®pha/ev5.hh
"

73 
şass
 
	gResourûReque¡
;

74 
şass
 
	gPack‘
;

76 şas 
	cInOrd”DynIn¡
 : 
public
 
RefCouÁed


78 
public
:

80 
TheISA
::
	tMachIn¡
 MachInst;

82 
	mTheISA
::
	tExtMachIn¡
 ExtMachInst;

84 
	mTheISA
::
	tRegIndex
 RegIndex;

86 
	mTheISA
::
	tIÁReg
 IntReg;

88 
	mTheISA
::
	tFlßtReg
 FloatReg;

90 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

92 
	mTheISA
::
	tCCReg
 CCReg;

94 
	mTheISA
::
	tMiscReg
 MiscReg;

96 
	tPhysRegIndex
;

101 
	mRefCouÁšgPŒ
<
	tInOrd”DynIn¡
> 
	tDynIn¡PŒ
;

104 
	m¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

107 
	mMaxIn¡SrcRegs
 = 
TheISA
::
MaxIn¡SrcRegs
,

108 
	mMaxIn¡De¡Regs
 = 
TheISA
::
MaxIn¡De¡Regs


111 
	gpublic
:

117 
InOrd”DynIn¡
(
InOrd”CPU
 *
ıu
, 
InOrd”Th»adS‹
 *
¡©e
,

118 
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
, 
asid
 = 0);

121 ~
InOrd”DynIn¡
();

123 
	gpublic
:

125 
In¡SeqNum
 
£qNum
;

128 
In¡SeqNum
 
	gsquashSeqNum
;

130 
	eStus
 {

131 
	gRegD•M­EÁry
,

132 
	gIqEÁry
,

133 
	gRobEÁry
,

134 
	gLsqEÁry
,

135 
	gCom¶‘ed
,

136 
	gResuÉR—dy
,

137 
	gCªIssue
,

138 
	gIssued
,

139 
	gExecu‹d
,

140 
	gCªComm™
,

141 
	gAtComm™
,

142 
	gComm™‹d
,

143 
	gSquashed
,

144 
	gSquashedInIQ
,

145 
	gSquashedInLSQ
,

146 
	gSquashedInROB
,

147 
	gRecov”In¡
,

148 
	gBlockšgIn¡
,

149 
	gTh»adsyncWa™
,

150 
	gS”ŸlizeBefÜe
,

152 
	gS”ŸlizeAá”
,

153 
	gS”ŸlizeHªdËd
,

154 
	gRemoveLi¡
,

155 
	gNumStus


159 
	g¡d
::
b™£t
<
NumStus
> 
¡©us
;

162 
	gth»adNumb”
;

165 
	gasid
;

168 
	gvœtProcNumb”
;

171 
SticIn¡PŒ
 
	g¡©icIn¡
;

174 
	gT¿û
::
InOrd”T¿ûRecÜd
 *
ŒaûD©a
;

177 
InOrd”CPU
 *
	gıu
;

180 
InOrd”Th»adS‹
 *
	gth»ad
;

183 
FauÉ
 
	gçuÉ
;

186 
Reque¡
 *
	g»q
;

189 
ušt8_t
 *
	gmemD©a
;

192 
ušt64_t
 
	glßdD©a
;

195 
ušt64_t
 
	g¡ÜeD©a
;

198 
	g¡d
::
li¡
<
ResourûReque¡
*> 
»qLi¡
;

201 
Addr
 
	geffAddr
;

204 
Addr
 
	gphysEffAddr
;

207 
	gmemReqFÏgs
;

210 
	g»adyRegs
;

212 
	eResuÉTy³
 {

213 
	gNÚe
,

214 
	gIÁeg”
,

215 
	gFlßt
,

216 
	gFlßtB™s
,

217 
	gDoubË


221 
	sIn¡V®ue
 {

222 
IÁReg
 
	gštV®
;

224 
FlßtReg
 
	gf
;

225 
FlßtRegB™s
 
	gi
;

226 } 
	gåV®
;

228 
In¡V®ue
()

230 
	gštV®
 = 0;

231 
	gåV®
.
	gi
 = 0;

236 
	sIn¡ResuÉ
 {

237 
ResuÉTy³
 
	gty³
;

238 
In¡V®ue
 
	g»s
;

239 
Tick
 
	gtick
;

241 
In¡ResuÉ
()

242 : 
ty³
(
NÚe
), 
tick
(0)

249 
In¡V®ue
 
	gš¡Src
[
MaxIn¡SrcRegs
];

254 
In¡ResuÉ
 
	gš¡ResuÉ
[
MaxIn¡De¡Regs
];

257 
	gTheISA
::
PCS‹
 
pc
;

260 
	gTheISA
::
PCS‹
 
´edPC
;

264 
Addr
 
	gmemAddr
;

269 
boŞ
 
	g_»adySrcRegIdx
[
MaxIn¡SrcRegs
];

274 
	gTheISA
::
RegIndex
 
_æ©De¡RegIdx
[
TheISA
::
MaxIn¡De¡Regs
];

279 
	gTheISA
::
RegIndex
 
_æ©SrcRegIdx
[
TheISA
::
MaxIn¡SrcRegs
];

284 
PhysRegIndex
 
	g_de¡RegIdx
[
MaxIn¡De¡Regs
];

289 
PhysRegIndex
 
	g_¤cRegIdx
[
MaxIn¡SrcRegs
];

294 
PhysRegIndex
 
	g_´evDe¡RegIdx
[
MaxIn¡De¡Regs
];

296 
	gÃxtSge
;

298 
	g´iv©e
:

300 
š™V¬s
();

302 
	gpublic
:

303 
Tick
 
memTime
;

305 
Pack‘D©aPŒ
 
	g¥l™MemD©a
;

306 
Reque¡PŒ
 
	g¥l™MemReq
;

307 
	gtÙ®Size
;

308 
	g¥l™2ndSize
;

309 
Addr
 
	g¥l™2ndAddr
;

310 
boŞ
 
	g¥l™2ndAcûss
;

311 
ušt8_t
 
	g¥l™2ndD©a
;

312 
Pack‘D©aPŒ
 
	g¥l™2ndD©aPŒ
;

313 
	g¥l™2ndFÏgs
;

314 
boŞ
 
	g¥l™In¡
;

315 
	g¥l™FšishCÁ
;

316 
ušt64_t
 *
	g¥l™2ndStÜeD©aPŒ
;

317 
boŞ
 
	g¥l™In¡Sked
;

324 
	g¡d
::
¡ršg
 
	$š¡Name
()

325 {  (
¡©icIn¡
è? sticIn¡->
	`g‘Name
(è: "undecoded-š¡"; 
	}
}

327 
£tSticIn¡
(
SticIn¡PŒ
 
si
);

329 
ExtMachIn¡
 
	$g‘MachIn¡
(è{  
¡©icIn¡
->
machIn¡
; 
	}
}

332 
£tSticIn¡
(
SticIn¡PŒ
 &
¡©ic_š¡
);

335 
	$£tSeqNum
(
In¡SeqNum
 
£q_num
è{ 
£qNum
 = seq_num; 
	}
}

338 
	$£tASID
(
addr_¥aû_id
è{ 
asid
 =‡ddr_¥aû_id; 
	}
}

341 
	$»adTid
(è{  
th»adNumb”
; 
	}
}

344 
	$£tTid
(
Th»adID
 
tid
è{ 
th»adNumb”
 =id; 
	}
}

346 
	$£tV²
(
id
è{ 
vœtProcNumb”
 = id; 
	}
}

348 
	$»adV²
(è{  
vœtProcNumb”
; 
	}
}

351 
	$£tTh»adS‹
(
InOrd”Th»adS‹
 *
¡©e
è{ 
th»ad
 = s‹; 
	}
}

354 
Th»adCÚ‹xt
 *
	$tcBa£
(è{  
th»ad
->
	`g‘TC
(); 
	}
}

357 
FauÉ
 
	$g‘FauÉ
(è{  
çuÉ
; 
	}
}

360 
ıuId
();

363 
	$cÚ‹xtId
(è{  
th»ad
->
	`cÚ‹xtId
(); 
	}
}

370 
boŞ
 
	$isNİ
(ècÚ¡ {  
¡©icIn¡
->
	`isNİ
(); 
	}
}

371 
boŞ
 
	$isMemRef
(ècÚ¡ {  
¡©icIn¡
->
	`isMemRef
(); 
	}
}

372 
boŞ
 
	$isLßd
(ècÚ¡ {  
¡©icIn¡
->
	`isLßd
(); 
	}
}

373 
boŞ
 
	$isStÜe
(ècÚ¡ {  
¡©icIn¡
->
	`isStÜe
(); 
	}
}

374 
boŞ
 
	$isStÜeCÚd™iÚ®
() const

375 {  
¡©icIn¡
->
	`isStÜeCÚd™iÚ®
(); 
	}
}

376 
boŞ
 
	$isIn¡P»ãtch
(ècÚ¡ {  
¡©icIn¡
->
	`isIn¡P»ãtch
(); 
	}
}

377 
boŞ
 
	$isD©aP»ãtch
(ècÚ¡ {  
¡©icIn¡
->
	`isD©aP»ãtch
(); 
	}
}

378 
boŞ
 
	$isIÁeg”
(ècÚ¡ {  
¡©icIn¡
->
	`isIÁeg”
(); 
	}
}

379 
boŞ
 
	$isFlßtšg
(ècÚ¡ {  
¡©icIn¡
->
	`isFlßtšg
(); 
	}
}

380 
boŞ
 
	$isCÚŒŞ
(ècÚ¡ {  
¡©icIn¡
->
	`isCÚŒŞ
(); 
	}
}

381 
boŞ
 
	$isC®l
(ècÚ¡ {  
¡©icIn¡
->
	`isC®l
(); 
	}
}

382 
boŞ
 
	$isR‘uº
(ècÚ¡ {  
¡©icIn¡
->
	`isR‘uº
(); 
	}
}

383 
boŞ
 
	$isDœeùCŒl
(ècÚ¡ {  
¡©icIn¡
->
	`isDœeùCŒl
(); 
	}
}

384 
boŞ
 
	$isIndœeùCŒl
(ècÚ¡ {  
¡©icIn¡
->
	`isIndœeùCŒl
(); 
	}
}

385 
boŞ
 
	$isCÚdCŒl
(ècÚ¡ {  
¡©icIn¡
->
	`isCÚdCŒl
(); 
	}
}

386 
boŞ
 
	$isUncÚdCŒl
(ècÚ¡ {  
¡©icIn¡
->
	`isUncÚdCŒl
(); 
	}
}

387 
boŞ
 
	$isCÚdD–aySlÙ
(ècÚ¡ {  
¡©icIn¡
->
	`isCÚdD–aySlÙ
(); 
	}
}

389 
boŞ
 
	$isTh»adSync
(ècÚ¡ {  
¡©icIn¡
->
	`isTh»adSync
(); 
	}
}

390 
boŞ
 
	$isS”Ÿlizšg
(ècÚ¡ {  
¡©icIn¡
->
	`isS”Ÿlizšg
(); 
	}
}

391 
boŞ
 
	$isS”ŸlizeBefÜe
() const

392 {  
¡©icIn¡
->
	`isS”ŸlizeBefÜe
(è|| 
¡©us
[
S”ŸlizeBefÜe
]; 
	}
}

393 
boŞ
 
	$isS”ŸlizeAá”
() const

394 {  
¡©icIn¡
->
	`isS”ŸlizeAá”
(è|| 
¡©us
[
S”ŸlizeAá”
]; 
	}
}

395 
boŞ
 
	$isMemB¬r›r
(ècÚ¡ {  
¡©icIn¡
->
	`isMemB¬r›r
(); 
	}
}

396 
boŞ
 
	$isWr™eB¬r›r
(ècÚ¡ {  
¡©icIn¡
->
	`isWr™eB¬r›r
(); 
	}
}

397 
boŞ
 
	$isNÚS³cuÏtive
(ècÚ¡ {  
¡©icIn¡
->
	`isNÚS³cuÏtive
(); 
	}
}

398 
boŞ
 
	$isQu›sû
(ècÚ¡ {  
¡©icIn¡
->
	`isQu›sû
(); 
	}
}

399 
boŞ
 
	$isI´Acûss
(ècÚ¡ {  
¡©icIn¡
->
	`isI´Acûss
(); 
	}
}

400 
boŞ
 
	$isUnv”ifŸbË
(ècÚ¡ {  
¡©icIn¡
->
	`isUnv”ifŸbË
(); 
	}
}

401 
boŞ
 
	$isSysÿÎ
() const

402 {  
¡©icIn¡
->
	`isSysÿÎ
(); 
	}
}

403 
boŞ
 
	$isMiüoİ
(ècÚ¡ {  
¡©icIn¡
->
	`isMiüoİ
(); 
	}
}

404 
boŞ
 
	$isLa¡Miüoİ
(ècÚ¡ {  
¡©icIn¡
->
	`isLa¡Miüoİ
(); 
	}
}

412 
	gTheP–še
::
	tRSkedPŒ
 RSkedPtr;

413 
boŞ
 
	gšFrÚtEnd
;

415 
RSkedPŒ
 
	gäÚtSked
;

416 
RSkedIt
 
	gäÚtSked_’d
;

418 
RSkedPŒ
 
	gbackSked
;

419 
RSkedIt
 
	gbackSked_’d
;

421 
RSkedIt
 
	gcurSkedEÁry
;

423 
	$£tFrÚtSked
(
RSkedPŒ
 
äÚt_sked
)

425 
äÚtSked
 = 
äÚt_sked
;

426 
äÚtSked_’d
.
	`š™
(
äÚtSked
);

427 
äÚtSked_’d
 = 
äÚtSked
->
	`’d
();

434 
curSkedEÁry
.
	`š™
(
äÚtSked
);

435 
curSkedEÁry
 = 
äÚtSked
->
	`begš
();

436 
	}
}

438 
	$£tBackSked
(
RSkedPŒ
 
back_sked
)

440 
backSked
 = 
back_sked
;

441 
backSked_’d
.
	`š™
(
backSked
);

442 
backSked_’d
 = 
backSked
->
	`’d
();

443 
	}
}

445 
	$£tNextSge
(
¡age_num
è{ 
ÃxtSge
 = sge_num; 
	}
}

446 
	$g‘NextSge
(è{  
ÃxtSge
; 
	}
}

449 
	$´štSked
()

451 ià(
äÚtSked
 !ğ
NULL
) {

452 
äÚtSked
->
	`´št
();

455 ià(
backSked
 !ğ
NULL
) {

456 
backSked
->
	`´št
();

458 
	}
}

461 
	$ÃxtResSge
()

463 
	`as£¹
((
šFrÚtEnd
 && 
curSkedEÁry
 !ğ
äÚtSked_’d
) ||

464 (!
šFrÚtEnd
 && 
curSkedEÁry
 !ğ
backSked_’d
));

466  
curSkedEÁry
->
¡ageNum
;

467 
	}
}

471 
	$ÃxtResourû
()

473 
	`as£¹
((
šFrÚtEnd
 && 
curSkedEÁry
 !ğ
äÚtSked_’d
) ||

474 (!
šFrÚtEnd
 && 
curSkedEÁry
 !ğ
backSked_’d
));

476  
curSkedEÁry
->
»sNum
;

477 
	}
}

480 
boŞ
 
	$fšishSkedEÁry
()

482 
curSkedEÁry
++;

484 ià(
šFrÚtEnd
 && 
curSkedEÁry
 =ğ
äÚtSked_’d
) {

485 
	`DPRINTF
(
InOrd”DynIn¡
, "[sn:%i] Switchingo "

486 "backƒnd scheduË.\n", 
£qNum
);

487 
	`as£¹
(
backSked
 !ğ
NULL
);

488 
curSkedEÁry
.
	`š™
(
backSked
);

489 
curSkedEÁry
 = 
backSked
->
	`begš
();

490 
šFrÚtEnd
 = 
çl£
;

491 } ià(!
šFrÚtEnd
 && 
curSkedEÁry
 =ğ
backSked_’d
) {

492  
Œue
;

495 
	`DPRINTF
(
InOrd”DynIn¡
, "[sn:%i] Next Stage: %i "

496 "NexˆResourû: %i.\n", 
£qNum
, 
curSkedEÁry
->
¡ageNum
,

497 
curSkedEÁry
->
»sNum
);

499  
çl£
;

500 
	}
}

503 
»Ëa£Req
(
ResourûReque¡
* 
»q
);

511 
OpCÏss
 
	$İCÏss
(ècÚ¡ {  
¡©icIn¡
->
	`İCÏss
(); 
	}
}

514 
FauÉ
 
execu‹
();

516 
	gcurResSlÙ
;

518 
	$g‘CurResSlÙ
(è{  
curResSlÙ
; 
	}
}

520 
	$£tCurResSlÙ
(
¦Ù_num
è{ 
curResSlÙ
 = slÙ_num; 
	}
}

524 
FauÉ
 
hw»i
();

526 
Œ­
(
FauÉ
 
çuÉ
);

527 
boŞ
 
simP®Check
(
·lFunc
);

528 
	gsysÿÎNum
;

531 
sysÿÎ
(
št64_t
 
ÿÎnum
);

538 
vœtu®
 
d—Îoÿ‹CÚ‹xt
(
th»ad_num
);

546 cÚ¡ 
	gTheISA
::
PCS‹
 &
	$pcS‹
(ècÚ¡ {  
pc
; 
	}
}

549 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
_pc
è{ 
pc
 = _pc; }

551 cÚ¡ 
Addr
 
	$š¡Addr
(è{  
pc
.
	`š¡Addr
(); 
	}
}

552 cÚ¡ 
Addr
 
	$ÃxtIn¡Addr
(è{  
pc
.
	`ÃxtIn¡Addr
(); 
	}
}

553 cÚ¡ 
MiüoPC
 
	$miüoPC
(è{  
pc
.
	`miüoPC
(); 
	}
}

561 
£tP»dT¬g
(cÚ¡ 
TheISA
::
PCS‹
 &
´ediùedPC
)

562 { 
´edPC
 = 
´ediùedPC
; }

565 
	gTheISA
::
PCS‹
 
	$»adP»dT¬g
(è{  
´edPC
; 
	}
}

568 
Addr
 
	$´edIn¡Addr
(è{  
´edPC
.
	`š¡Addr
(); 
	}
}

571 
Addr
 
	$´edNextIn¡Addr
(è{  
´edPC
.
	`ÃxtIn¡Addr
(); 
	}
}

574 
Addr
 
	$»adP»dMiüoPC
(è{  
´edPC
.
	`miüoPC
(); 
	}
}

577 
boŞ
 
	$´edTak’
(è{  
´ediùTak’
; 
	}
}

580 
boŞ


581 
	$mi¥»diùed
()

583 
TheISA
::
PCS‹
 
ÃxtPC
 = 
pc
;

584 
TheISA
::
	`advªûPC
(
ÃxtPC
, 
¡©icIn¡
);

585  !(
ÃxtPC
 =ğ
´edPC
);

586 
	}
}

589 
	gTheISA
::
PCS‹
 
	$b¿nchT¬g‘
() const

590 {  
¡©icIn¡
->
	`b¿nchT¬g‘
(
pc
); 
	}
}

597 
boŞ
 
	$dÚeT¬gC®c
(è{  
çl£
; 
	}
}

599 
	$£tB¿nchP»d
(
boŞ
 
´ediùiÚ
è{ 
´ediùTak’
 =…»diùiÚ; 
	}
}

601 
	gsquashšgSge
;

603 
boŞ
 
	g´ediùTak’
;

605 
boŞ
 
	g´ocD–aySlÙOnMi¥»d
;

607 
£tSquashInfo
(
¡age_num
);

615 
FauÉ
 
»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
);

617 
FauÉ
 
wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

618 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

623 
FauÉ
 
š™Ÿ‹Acc
();

626 
FauÉ
 
com¶‘eAcc
(
Pack‘
 *
pkt
);

629 
FauÉ
 
ÿlcEA
();

632 
FauÉ
 
memAcûss
();

634 
Reque¡PŒ
 
	gãtchMemReq
;

635 
Reque¡PŒ
 
	gd©aMemReq
;

637 
boŞ
 
	gmemAddrR—dy
;

639 
boŞ
 
	$v®idMemAddr
()

640 {  
memAddrR—dy
; 
	}
}

642 
	$£tMemAddr
(
Addr
 
addr
)

643 { 
memAddr
 = 
addr
; 
memAddrR—dy
 = 
Œue
;
	}
}

645 
	$un£tMemAddr
()

646 { 
memAddrR—dy
 = 
çl£
;
	}
}

648 
Addr
 
	$g‘MemAddr
()

649 {  
memAddr
; 
	}
}

652 
	$£tEA
(
Addr
 &
—
è{ 
š¡EffAddr
 =ƒa; 
—C®cDÚe
 = 
Œue
; 
	}
}

655 cÚ¡ 
	gAddr
 &
	$g‘EA
(ècÚ¡ {  
š¡EffAddr
; 
	}
}

658 
boŞ
 
	$dÚeEAC®c
(è{  
—C®cDÚe
; 
	}
}

665 
boŞ
 
	$—SrcsR—dy
()

667 
i
 = 1; i < 
	`numSrcRegs
(); ++i) {

668 ià(!
_»adySrcRegIdx
[
i
])

669  
çl£
;

672  
Œue
;

673 
	}
}

681 
št8_t
 
	$numSrcRegs
(ècÚ¡ {  
¡©icIn¡
->
	`numSrcRegs
(); 
	}
}

684 
št8_t
 
	$numDe¡Regs
(ècÚ¡ {  
¡©icIn¡
->
	`numDe¡Regs
(); 
	}
}

688 
št8_t
 
	$numFPDe¡Regs
(ècÚ¡ {  
¡©icIn¡
->
	`numFPDe¡Regs
(); 
	}
}

689 
št8_t
 
	$numIÁDe¡Regs
(ècÚ¡ {  
¡©icIn¡
->
	`numIÁDe¡Regs
(); 
	}
}

692 
RegIndex
 
	$de¡RegIdx
(
i
ècÚ¡ {  
¡©icIn¡
->
	`de¡RegIdx
(i); 
	}
}

695 
RegIndex
 
	$¤cRegIdx
(
i
ècÚ¡ {  
¡©icIn¡
->
	`¤cRegIdx
(i); 
	}
}

705 
PhysRegIndex
 
	$»ÇmedDe¡RegIdx
(
idx
) const

707  
_de¡RegIdx
[
idx
];

708 
	}
}

711 
PhysRegIndex
 
	$»ÇmedSrcRegIdx
(
idx
) const

713  
_¤cRegIdx
[
idx
];

714 
	}
}

718 
æ©‹nSrcReg
(
idx
, 
TheISA
::
RegIndex
 
æ©‹Ãd_¤c
)

720 
_æ©SrcRegIdx
[
idx
] = 
æ©‹Ãd_¤c
;

726 
æ©‹nDe¡Reg
(
idx
, 
TheISA
::
RegIndex
 
æ©‹Ãd_de¡
)

728 
_æ©De¡RegIdx
[
idx
] = 
æ©‹Ãd_de¡
;

734 
	gTheISA
::
RegIndex
 
	$æ©‹ÃdDe¡RegIdx
(
idx
) const

736  
_æ©De¡RegIdx
[
idx
];

737 
	}
}

740 
	gTheISA
::
RegIndex
 
	$æ©‹ÃdSrcRegIdx
(
idx
) const

742  
_æ©SrcRegIdx
[
idx
];

743 
	}
}

748 
PhysRegIndex
 
	$´evDe¡RegIdx
(
idx
) const

750  
_´evDe¡RegIdx
[
idx
];

751 
	}
}

754 
boŞ
 
	$isR—dySrcRegIdx
(
idx
) const

756  
this
->
_»adySrcRegIdx
[
idx
];

757 
	}
}

760 
	$m¬kSrcRegR—dy
()

762 ià(++
»adyRegs
 =ğ
	`numSrcRegs
()) {

763 
¡©us
.
	`£t
(
CªIssue
);

765 
	}
}

768 
	$m¬kSrcRegR—dy
(
RegIndex
 
¤c_idx
)

770 
_»adySrcRegIdx
[
¤c_idx
] = 
Œue
;

772 
	`m¬kSrcRegR—dy
();

773 
	}
}

778 
	$»ÇmeDe¡Reg
(
idx
,

779 
PhysRegIndex
 
»Çmed_de¡
,

780 
PhysRegIndex
 
´evious_»Çme
)

782 
_de¡RegIdx
[
idx
] = 
»Çmed_de¡
;

783 
_´evDe¡RegIdx
[
idx
] = 
´evious_»Çme
;

784 
	}
}

790 
	$»ÇmeSrcReg
(
idx
, 
PhysRegIndex
 
»Çmed_¤c
)

792 
_¤cRegIdx
[
idx
] = 
»Çmed_¤c
;

793 
	}
}

796 
PhysRegIndex
 
	$»adDe¡RegIdx
(
idx
)

798  
_de¡RegIdx
[
idx
];

799 
	}
}

801 
	$£tDe¡RegIdx
(
idx
, 
PhysRegIndex
 
de¡_idx
)

803 
_de¡RegIdx
[
idx
] = 
de¡_idx
;

804 
	}
}

806 
	$g‘De¡IdxNum
(
PhysRegIndex
 
de¡_idx
)

808 
i
=0; i < 
¡©icIn¡
->
	`numDe¡Regs
(); i++) {

809 ià(
_æ©De¡RegIdx
[
i
] =ğ
de¡_idx
)

810  
i
;

814 
	}
}

816 
PhysRegIndex
 
	$»adSrcRegIdx
(
idx
)

818  
_¤cRegIdx
[
idx
];

819 
	}
}

821 
	$£tSrcRegIdx
(
idx
, 
PhysRegIndex
 
¤c_idx
)

823 
_¤cRegIdx
[
idx
] = 
¤c_idx
;

824 
	}
}

826 
	$g‘SrcIdxNum
(
PhysRegIndex
 
¤c_idx
)

828 
i
=0; i < 
¡©icIn¡
->
	`numSrcRegs
(); i++) {

829 ià(
_¤cRegIdx
[
i
] =ğ
¤c_idx
)

830  
i
;

834 
	}
}

844 
£tIÁSrc
(
idx
, 
ušt64_t
 
v®
);

845 
£tFlßtSrc
(
idx
, 
FlßtReg
 
v®
);

846 
£tFlßtRegB™sSrc
(
idx
, 
TheISA
::
FlßtRegB™s
 
v®
);

848 
	gTheISA
::
IÁReg
* 
	$g‘IÁSrcPŒ
(
idx
è{  &
š¡Src
[idx].
štV®
; 
	}
}

849 
ušt64_t
 
	$»adIÁSrc
(
idx
è{  
š¡Src
[idx].
štV®
; 
	}
}

857 
IÁReg
 
»adIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
Th»adID
 
tid
 = 0);

858 
FlßtReg
 
»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
);

859 
	gTheISA
::
FlßtRegB™s
 
»adFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
);

860 
MiscReg
 
»adMiscReg
(
misc_»g
);

861 
MiscReg
 
»adMiscRegNoEfãù
(
misc_»g
);

862 
MiscReg
 
»adMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
);

863 
MiscReg
 
»adMiscRegO³¿ndNoEfãù
(cÚ¡ 
SticIn¡
 *
si
, 
idx
);

866 
ResuÉTy³
 
	$»suÉTy³
(
idx
)

868  
š¡ResuÉ
[
idx
].
ty³
;

869 
	}
}

871 
IÁReg
 
	$»adIÁResuÉ
(
idx
)

873  
š¡ResuÉ
[
idx
].
»s
.
štV®
;

874 
	}
}

876 
FlßtReg
 
	$»adFlßtResuÉ
(
idx
)

878  
š¡ResuÉ
[
idx
].
»s
.
åV®
.
f
;

879 
	}
}

881 
FlßtRegB™s
 
	$»adFlßtB™sResuÉ
(
idx
)

883  
š¡ResuÉ
[
idx
].
»s
.
åV®
.
i
;

884 
	}
}

886 
CCReg
 
	$»adCCResuÉ
(
idx
)

888  
š¡ResuÉ
[
idx
].
»s
.
štV®
;

889 
	}
}

891 
Tick
 
	$»adResuÉTime
(
idx
è{  
š¡ResuÉ
[idx].
tick
; 
	}
}

893 
IÁReg
* 
	$g‘IÁResuÉPŒ
(
idx
è{  &
š¡ResuÉ
[idx].
»s
.
štV®
; 
	}
}

898 
£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
IÁReg
 
v®
);

899 
£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
);

900 
£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

901 
TheISA
::
FlßtRegB™s
 
v®
);

902 
£tCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
CCReg
 
v®
);

903 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

904 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

905 
£tMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, cÚ¡ 
MiscReg
 &
v®
);

906 
£tMiscRegO³¿ndNoEfãù
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

907 cÚ¡ 
MiscReg
 &
v®
);

909 
vœtu®
 
ušt64_t
 
»adRegOth”Th»ad
(
idx
,

910 
Th»adID
 
tid
 = 
Inv®idTh»adID
);

911 
vœtu®
 
£tRegOth”Th»ad
(
idx
, cÚ¡ 
ušt64_t
 &
v®
,

912 
Th»adID
 
tid
 = 
Inv®idTh»adID
);

915 
	$»adStCÚdFau»s
()

916 {  
th»ad
->
¡ÜeCÚdFau»s
; 
	}
}

919 
	$£tStCÚdFau»s
(
sc_çu»s
)

920 { 
th»ad
->
¡ÜeCÚdFau»s
 = 
sc_çu»s
; 
	}
}

928 
	$£tRegD•EÁry
(è{ 
¡©us
.
	`£t
(
RegD•M­EÁry
); 
	}
}

931 
	$ş—rRegD•EÁry
(è{ 
¡©us
.
	`»£t
(
RegD•M­EÁry
); 
	}
}

934 
boŞ
 
	$isRegD•EÁry
(ècÚ¡ {  
¡©us
[
RegD•M­EÁry
]; 
	}
}

937 
	$£tRemoveLi¡
(è{ 
¡©us
.
	`£t
(
RemoveLi¡
); 
	}
}

940 
boŞ
 
	$isRemoveLi¡
(ècÚ¡ {  
¡©us
[
RemoveLi¡
]; 
	}
}

943 
	$£tCom¶‘ed
(è{ 
¡©us
.
	`£t
(
Com¶‘ed
); 
	}
}

946 
boŞ
 
	$isCom¶‘ed
(ècÚ¡ {  
¡©us
[
Com¶‘ed
]; 
	}
}

949 
	$£tResuÉR—dy
(è{ 
¡©us
.
	`£t
(
ResuÉR—dy
); 
	}
}

952 
boŞ
 
	$isResuÉR—dy
(ècÚ¡ {  
¡©us
[
ResuÉR—dy
]; 
	}
}

955 
	$£tCªIssue
(è{ 
¡©us
.
	`£t
(
CªIssue
); 
	}
}

958 
boŞ
 
	$»adyToIssue
(ècÚ¡ {  
¡©us
[
CªIssue
]; 
	}
}

961 
	$£tIssued
(è{ 
¡©us
.
	`£t
(
Issued
); 
	}
}

964 
boŞ
 
	$isIssued
(ècÚ¡ {  
¡©us
[
Issued
]; 
	}
}

967 
	$£tExecu‹d
(è{ 
¡©us
.
	`£t
(
Execu‹d
); 
	}
}

970 
boŞ
 
	$isExecu‹d
(ècÚ¡ {  
¡©us
[
Execu‹d
]; 
	}
}

973 
	$£tCªComm™
(è{ 
¡©us
.
	`£t
(
CªComm™
); 
	}
}

976 
	$ş—rCªComm™
(è{ 
¡©us
.
	`»£t
(
CªComm™
); 
	}
}

979 
boŞ
 
	$»adyToComm™
(ècÚ¡ {  
¡©us
[
CªComm™
]; 
	}
}

981 
	$£tAtComm™
(è{ 
¡©us
.
	`£t
(
AtComm™
); 
	}
}

983 
boŞ
 
	$isAtComm™
(è{  
¡©us
[
AtComm™
]; 
	}
}

986 
	$£tComm™‹d
(è{ 
¡©us
.
	`£t
(
Comm™‹d
); 
	}
}

989 
boŞ
 
	$isComm™‹d
(ècÚ¡ {  
¡©us
[
Comm™‹d
]; 
	}
}

992 
	$£tSquashed
(è{ 
¡©us
.
	`£t
(
Squashed
); 
	}
}

995 
boŞ
 
	$isSquashed
(ècÚ¡ {  
¡©us
[
Squashed
]; 
	}
}

998 
	$£tS”ŸlizeBefÜe
(è{ 
¡©us
.
	`£t
(
S”ŸlizeBefÜe
); 
	}
}

1001 
	$ş—rS”ŸlizeBefÜe
(è{ 
¡©us
.
	`»£t
(
S”ŸlizeBefÜe
); 
	}
}

1004 
boŞ
 
	$isTempS”ŸlizeBefÜe
(è{  
¡©us
[
S”ŸlizeBefÜe
]; 
	}
}

1007 
	$£tS”ŸlizeAá”
(è{ 
¡©us
.
	`£t
(
S”ŸlizeAá”
); 
	}
}

1010 
	$ş—rS”ŸlizeAá”
(è{ 
¡©us
.
	`»£t
(
S”ŸlizeAá”
); 
	}
}

1013 
boŞ
 
	$isTempS”ŸlizeAá”
(è{  
¡©us
[
S”ŸlizeAá”
]; 
	}
}

1016 
	$£tS”ŸlizeHªdËd
(è{ 
¡©us
.
	`£t
(
S”ŸlizeHªdËd
); 
	}
}

1023 
boŞ
 
	$isS”ŸlizeHªdËd
(è{  
¡©us
[
S”ŸlizeHªdËd
]; 
	}
}

1025 
	g´iv©e
:

1029 
Addr
 
š¡EffAddr
;

1034 
boŞ
 
	g—C®cDÚe
;

1036 
	gpublic
:

1038 
št16_t
 
lqIdx
;

1041 
št16_t
 
	gsqIdx
;

1044 
Li¡It
 
	gš¡Li¡It
;

1046 
boŞ
 
	gÚIn¡Li¡
;

1049 
Li¡It
 
	$g‘In¡Li¡It
(è{  
š¡Li¡It
; 
	}
}

1052 
	$£tIn¡Li¡It
(
Li¡It
 
_š¡Li¡It
è{ 
ÚIn¡Li¡
 = 
Œue
; 
š¡Li¡It
 = _š¡Li¡It; 
	}
}

1055 
	gš¡couÁ
;

1057 
»£tIn¡CouÁ
();

1060 
dump
();

1063 
dump
(
¡d
::
¡ršg
 &
out¡ršg
);

	@inorder/inorder_trace.cc

32 
	~<iomª
>

34 
	~"cÚfig/the_i§.hh
"

35 
	~"ıu/šÜd”/šÜd”_Œaû.hh
"

36 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

37 
	~"ıu/ex‘¿û.hh
"

38 
	~"ıu/¡©ic_š¡.hh
"

39 
	~"ıu/th»ad_cÚ‹xt.hh
"

40 
	~"debug/ExecEÇbË.hh
"

41 
	~"·¿ms/InOrd”T¿û.hh
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

44 
usšg
 
Çme¥aû
 
	gTheISA
;

46 
Çme¥aû
 
	gT¿û
 {

48 
šlše
 

49 
	gT¿û
::
InOrd”T¿ûRecÜd
::
dumpTicks
(
¡d
::
o¡»am
 &
outs
)

51 ià(!
¡ageT¿û
) {

52 
cırštf
(
outs
, "%7d: ", 
wh’
);

54 
cırštf
(
outs
, "");

55 
	gi
=0; i < 
	g¡ageCyşe
.
size
(); i++) {

56 ià(
	gi
 < 
	g¡ageCyşe
.
size
() - 1)

57 
	gouts
 << 
	gdec
 << 
	g¡ageCyşe
[
i
] << "-";

59 
	gouts
 << 
	gdec
 << 
	g¡ageCyşe
[
i
] << ":";

64 
InOrd”T¿ûRecÜd
 *

65 
	gInOrd”T¿û
::
g‘In¡RecÜd
(
num_¡ages
, 
boŞ
 
¡age_Œacšg
,

66 
Th»adCÚ‹xt
 *
tc
)

68 ià(!
	gDebug
::
ExecEÇbË
)

69  
NULL
;

71 ià(!
	gT¿û
::
’abËd
)

72  
NULL
;

74  
Ãw
 
InOrd”T¿ûRecÜd
(
num_¡ages
, 
¡age_Œacšg
, 
tc
, 0);

77 
InOrd”T¿ûRecÜd
 *

78 
	gInOrd”T¿û
::
g‘In¡RecÜd
(
Tick
 
wh’
, 
Th»adCÚ‹xt
 *
tc
,

79 cÚ¡ 
SticIn¡PŒ
 
¡©icIn¡
, 
TheISA
::
PCS‹
 
_pc
,

80 cÚ¡ 
SticIn¡PŒ
 
maüoSticIn¡
)

82  
Ãw
 
InOrd”T¿ûRecÜd
(
TheP–še
::
NumSges
, 
Œue
, 
tc
, 
_pc
);

91 
	gT¿û
::
InOrd”T¿û
 *

92 
InOrd”T¿ûP¬ams
::
	$ü—‹
()

94  
Ãw
 
T¿û
::
	`InOrd”T¿û
(
this
);

95 
	}
};

	@inorder/inorder_trace.hh

32 #iâdeà
__CPU_INORDER_INORDER_TRACE_HH__


33 
	#__CPU_INORDER_INORDER_TRACE_HH__


	)

35 
	~"ba£/Œaû.hh
"

36 
	~"ba£/ty³s.hh
"

37 
	~"ıu/ex‘¿û.hh
"

38 
	~"ıu/¡©ic_š¡.hh
"

39 
	~"·¿ms/InOrd”T¿û.hh
"

40 
	~"sim/š¡Œaûr.hh
"

42 
şass
 
	gTh»adCÚ‹xt
;

44 
Çme¥aû
 
	gT¿û
 {

46 şas 
	cInOrd”T¿ûRecÜd
 : 
public
 
ExeT¿ûrRecÜd


48 
public
:

49 
InOrd”T¿ûRecÜd
(
num_¡ages
, 
boŞ
 
_¡age_Œacšg
,

50 
Th»adCÚ‹xt
 *
_th»ad
, 
TheISA
::
PCS‹
 
_pc
, 
boŞ
 
¥ec
 = 
çl£
)

51 : 
ExeT¿ûrRecÜd
(0, 
_th»ad
, 
NULL
, 
_pc
, 
¥ec
)

53 
	g¡ageT¿û
 = 
_¡age_Œacšg
;

54 
	g¡ageCyşe
.
»size
(
num_¡ages
);

58 
boŞ
 
	g¡ageT¿û
;

59 
	g¡d
::
veùÜ
<
Tick
> 
¡ageCyşe
;

61 
dumpTicks
(
¡d
::
o¡»am
 &
outs
);

64 
£tSgeCyşe
(
num_¡age
, 
Tick
 
cur_cyşe
)

66 ià(
	g¡ageT¿û
) {

67 
	g¡ageCyşe
[
num_¡age
] = 
cur_cyşe
;

69 
	gwh’
 = 
cur_cyşe
;

74 
£tSticIn¡
(cÚ¡ 
SticIn¡PŒ
 &
_¡©icIn¡
)

76 
	g¡©icIn¡
 = 
_¡©icIn¡
;

79 
£tPC
(
TheISA
::
PCS‹
 
_pc
è{ 
pc
 = _pc; }

82 şas 
	cInOrd”T¿û
 : 
public
 
In¡T¿ûr


84 
public
:

85 
InOrd”T¿û
(cÚ¡ 
InOrd”T¿ûP¬ams
 *
p
è: 
In¡T¿ûr
(p)

88 
InOrd”T¿ûRecÜd
 *

89 
g‘In¡RecÜd
(
num_¡ages
, 
boŞ
 
¡age_Œacšg
, 
Th»adCÚ‹xt
 *
tc
);

91 
InOrd”T¿ûRecÜd
 *
g‘In¡RecÜd
(
Tick
 
wh’
, 
Th»adCÚ‹xt
 *
tc
,

92 cÚ¡ 
SticIn¡PŒ
 
¡©icIn¡
, 
TheISA
::
PCS‹
 
pc
,

93 cÚ¡ 
SticIn¡PŒ
 
maüoSticIn¡
 = 
NULL
);

	@inorder/pipeline_stage.cc

32 
	~"ba£/¡r.hh
"

33 
	~"cÚfig/the_i§.hh
"

34 
	~"ıu/šÜd”/ıu.hh
"

35 
	~"ıu/šÜd”/p–še_¡age.hh
"

36 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

37 
	~"debug/Aùiv™y.hh
"

38 
	~"debug/InOrd”Sge.hh
"

39 
	~"debug/InOrd”SÎ.hh
"

40 
	~"debug/Resourû.hh
"

41 
	~"debug/Th»adMod–.hh
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

44 
usšg
 
Çme¥aû
 
	gTheP–še
;

46 
	gP–šeSge
::
	$P–šeSge
(
P¬ams
 *
·¿ms
, 
¡age_num
)

47 : 
	`¡ageNum
(
¡age_num
), 
	`¡ageWidth
(
·¿ms
->
¡ageWidth
),

48 
	`numTh»ads
(
TheP–še
::
MaxTh»ads
), 
	`_¡©us
(
IÇùive
),

49 
	`¡ageBufãrMax
(
·¿ms
->
¡ageWidth
),

50 
	`´evSgeV®id
(
çl£
), 
	`ÃxtSgeV®id
(çl£), 
	$idË
(
çl£
)

52 
	`š™
(
·¿ms
);

53 
	}
}

55 
	gP–šeSge
::~
	$P–šeSge
()

57 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

58 
skidBufãr
[
tid
].
	`ş—r
();

59 
¡®ls
[
tid
].
»sourûs
.
	`ş—r
();

61 
	}
}

64 
	gP–šeSge
::
	$š™
(
P¬ams
 *
·¿ms
)

66 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

67 
¡ageStus
[
tid
] = 
IdË
;

69 
¡Num
 = 0; stNum < 
NumSges
; stNum++) {

70 
¡®ls
[
tid
].
¡age
[
¡Num
] = 
çl£
;

72 
¡®ls
[
tid
].
»sourûs
.
	`ş—r
();

74 ià(
¡ageNum
 < 
BackEndS¹Sge
)

75 
Ï¡SÎšgSge
[
tid
] = 
BackEndS¹Sge
 - 1;

77 
Ï¡SÎšgSge
[
tid
] = 
NumSges
 - 1;

80 ià((
InOrd”CPU
::
Th»adMod–
è
·¿ms
->
th»adMod–
 ==

81 
InOrd”CPU
::
Sw™chOnCacheMiss
) {

82 
sw™chedOutBufãr
.
	`»size
(
TheP–še
::
MaxTh»ads
);

83 
sw™chedOutV®id
.
	`»size
(
TheP–še
::
MaxTh»ads
);

85 
	}
}

88 
	g¡d
::
¡ršg


89 
P–šeSge
::
	$Çme
() const

91  
ıu
->
	`Çme
(è+ ".¡age" + 
	`to_¡ršg
(
¡ageNum
);

92 
	}
}

96 
	gP–šeSge
::
	$»gSts
()

98 
idËCyşes


99 .
	`Çme
(name() + ".idleCycles")

100 .
	`desc
("Number of cycles 0 instructions‡re…rocessed.");

102 
runCyşes


103 .
	`Çme
(name() + ".runCycles")

104 .
	`desc
("Number of cycles 1+ instructions‡re…rocessed.");

106 
utiz©iÚ


107 .
	`Çme
(name() + ".utilization")

108 .
	`desc
("Percentage of cycles stage was utilized (processing insts).")

109 .
	`´ecisiÚ
(6);

110 
utiz©iÚ
 = (
runCyşes
 / 
ıu
->
numCyşes
) * 100;

112 
	}
}

116 
	gP–šeSge
::
	$£tCPU
(
InOrd”CPU
 *
ıu_±r
)

118 
ıu
 = 
ıu_±r
;

120 
	`DPRINTF
(
InOrd”Sge
, "Set CPU…ointer.\n");

122 
Œaûr
 = 
dyÇmic_ÿ¡
<
T¿û
::
InOrd”T¿û
 *>(
ıu
->
	`g‘T¿ûr
());

123 
	}
}

127 
	gP–šeSge
::
£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
)

129 
DPRINTF
(
InOrd”Sge
, "Settingime buffer…ointer.\n");

130 
	gtimeBufãr
 = 
tb_±r
;

134 
	gtoP»vSges
 = 
timeBufãr
->
g‘Wœe
(0);

137 
	gäomNextSges
 = 
timeBufãr
->
g‘Wœe
(-1);

142 
	gP–šeSge
::
£tP»vSgeQueue
(
TimeBufãr
<
IÁ”SgeSŒuù
> *
´ev_¡age_±r
)

144 
DPRINTF
(
InOrd”Sge
, "Setting…revious stage queue…ointer.\n");

145 
	g´evSgeQueue
 = 
´ev_¡age_±r
;

148 
	g´evSge
 = 
´evSgeQueue
->
g‘Wœe
(-1);

150 
	g´evSgeV®id
 = 
Œue
;

156 
	gP–šeSge
::
£tNextSgeQueue
(
TimeBufãr
<
IÁ”SgeSŒuù
> *
Ãxt_¡age_±r
)

158 
DPRINTF
(
InOrd”Sge
, "Setting‚ext stage…ointer.\n");

159 
	gÃxtSgeQueue
 = 
Ãxt_¡age_±r
;

162 
	gÃxtSge
 = 
ÃxtSgeQueue
->
g‘Wœe
(0);

163 
	gÃxtSgeV®id
 = 
Œue
;

169 
	gP–šeSge
::
£tAùiveTh»ads
(
li¡
<
Th»adID
> *
©_±r
)

171 
DPRINTF
(
InOrd”Sge
, "Setting‡ctivehreads†ist…ointer.\n");

172 
	gaùiveTh»ads
 = 
©_±r
;

188 
	gP–šeSge
::
	$sw™chOut
()

191 
	`·nic
("Switching Out of Stages Unimplemented");

192 
	}
}

196 
	gP–šeSge
::
	$keOv”From
()

198 
_¡©us
 = 
IÇùive
;

201 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

202 
¡ageStus
[
tid
] = 
IdË
;

204 
¡Num
 = 0; stNum < 
NumSges
; stNum++) {

205 
¡®ls
[
tid
].
¡age
[
¡Num
] = 
çl£
;

208 
¡®ls
[
tid
].
»sourûs
.
	`ş—r
();

210 
skidBufãr
[
tid
].
	`ş—r
();

212 
wrÙeToTimeBufãr
 = 
çl£
;

213 
	}
}

217 
boŞ


218 
	gP–šeSge
::
	$checkSÎ
(
Th»adID
 
tid
) const

220 
boŞ
 
»t_v®
 = 
çl£
;

223 ià(
ÃxtSgeV®id
 && 
¡®ls
[
tid
].
¡age
[
¡ageNum
 + 1]) {

224 
	`DPRINTF
(
InOrd”Sge
,"[tid:%i]: Stall fom Stage %i detected.\n",

225 
tid
, 
¡ageNum
 + 1);

226 
»t_v®
 = 
Œue
;

229 ià(!
¡®ls
[
tid
].
»sourûs
.
	`em±y
()) {

230 #ià
TRACING_ON


231 
¡ršg
 
¡®l_¤c
;

233 
i
=0; i < 
¡®ls
[
tid
].
»sourûs
.
	`size
(); i++) {

234 
¡®l_¤c
 +ğ
¡®ls
[
tid
].
»sourûs
[
i
]->
»s
->
	`Çme
() + ":";

237 
	`DPRINTF
(
InOrd”Sge
,"[tid:%i]: Stall fom„esources (%s) detected.\n",

238 
tid
, 
¡®l_¤c
);

240 
»t_v®
 = 
Œue
;

243  
»t_v®
;

244 
	}
}

248 
	gP–šeSge
::
	$»moveSÎs
(
Th»adID
 
tid
)

250 
¡_num
 = 0; st_num < 
NumSges
; st_num++) {

251 ià(
¡®ls
[
tid
].
¡age
[
¡_num
] =ğ
Œue
) {

252 
	`DPRINTF
(
InOrd”Sge
, "Removing stall from stage %i.\n",

253 
¡_num
);

254 
¡®ls
[
tid
].
¡age
[
¡_num
] = 
çl£
;

257 ià(
toP»vSges
->
¡ageBlock
[
¡_num
][
tid
] =ğ
Œue
) {

258 
	`DPRINTF
(
InOrd”Sge
, "Removing…ending block from stage %i.\n",

259 
¡_num
);

260 
toP»vSges
->
¡ageBlock
[
¡_num
][
tid
] = 
çl£
;

263 ià(
äomNextSges
->
¡ageBlock
[
¡_num
][
tid
] =ğ
Œue
) {

264 
	`DPRINTF
(
InOrd”Sge
, "Removing…ending block from stage %i.\n",

265 
¡_num
);

266 
äomNextSges
->
¡ageBlock
[
¡_num
][
tid
] = 
çl£
;

269 
¡®ls
[
tid
].
»sourûs
.
	`ş—r
();

270 
	}
}

272 
šlše
 
boŞ


273 
	gP–šeSge
::
	$´evSgeIn¡sV®id
()

275  
´evSge
->
š¡s
.
	`size
() > 0;

276 
	}
}

278 
boŞ


279 
	gP–šeSge
::
	$isBlocked
(
Th»adID
 
tid
)

281  
¡ageStus
[
tid
] =ğ
Blocked
;

282 
	}
}

284 
boŞ


285 
	gP–šeSge
::
	$block
(
Th»adID
 
tid
)

287 
	`DPRINTF
(
InOrd”Sge
, "[tid:%d]: Blocking, sending block signal backo "

288 "´eviou ¡ages.\n", 
tid
);

293 ià(
¡ageStus
[
tid
] !ğ
Blocked
) {

294 ià(
¡ageStus
[
tid
] !ğ
Unblockšg
) {

295 
wrÙeToTimeBufãr
 = 
Œue
;

298 
¡ageStus
[
tid
] = 
Blocked
;

300 ià(
´evSgeV®id
) {

301 
	`DPRINTF
(
InOrd”Sge
, "[tid:%d]: Stage %i setting block signal.\n",

302 
tid
, 
¡ageNum
);

303 
toP»vSges
->
¡ageBlock
[
¡ageNum
][
tid
] = 
Œue
;

306  
Œue
;

310  
çl£
;

311 
	}
}

314 
	gP–šeSge
::
	$blockDueToBufãr
(
Th»adID
 
tid
)

316 
	`DPRINTF
(
InOrd”Sge
, "[tid:%d]: Blocking instructions from…assingo "

317 "Ãxˆ¡age.\n", 
tid
);

319 ià(
¡ageStus
[
tid
] !ğ
Blocked
) {

320 ià(
¡ageStus
[
tid
] !ğ
Unblockšg
) {

321 
wrÙeToTimeBufãr
 = 
Œue
;

325 
¡ageStus
[
tid
] = 
Blocked
;

327 
	}
}

329 
boŞ


330 
	gP–šeSge
::
	$unblock
(
Th»adID
 
tid
)

334 ià(
skidBufãr
[
tid
].
	`em±y
()) {

335 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: DÚunblockšg.\n", 
tid
);

337 ià(
´evSgeV®id
)

338 
toP»vSges
->
¡ageUnblock
[
¡ageNum
][
tid
] = 
Œue
;

340 
wrÙeToTimeBufãr
 = 
Œue
;

342 
¡ageStus
[
tid
] = 
RuÂšg
;

344  
Œue
;

347 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Cu¼’y unblockšg.\n", 
tid
);

348  
çl£
;

349 
	}
}

352 
	gP–šeSge
::
	$£tupSquash
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
)

354 ià(
ıu
->
Ï¡SquashCyşe
[
tid
] =ğ
	`curTick
() &&

355 
ıu
->
squashSeqNum
[
tid
] < 
š¡
->
£qNum
){

356 
	`DPRINTF
(
Resourû
, "Ignoring [sn:%i] branch squash signal dueo "

358 
š¡
->
£qNum
, 
ıu
->
squashSeqNum
[
tid
]);

360 
In¡SeqNum
 
squash_£q_num
 = 
š¡
->
squashSeqNum
;

361 
squash_¡age
 = (
ÃxtSgeV®id
è? 
¡ageNum
 + 1

362 : 
¡ageNum
;

364 
toP»vSges
->
¡ageInfo
[
squash_¡age
][
tid
].
squash
 = 
Œue
;

365 
toP»vSges
->
¡ageInfo
[
squash_¡age
][
tid
].
dÚeSeqNum
 =

366 
squash_£q_num
;

368 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Setting up squashing‡fter "

370 
tid
, 
squash_£q_num
, 
š¡
->
£qNum
, in¡->
	`š¡Name
(),

371 
squash_¡age
);

374 
ıu
->
Ï¡SquashCyşe
[
tid
] = 
	`curTick
();

375 
ıu
->
squashSeqNum
[
tid
] = 
squash_£q_num
;

377 
	}
}

380 
	gP–šeSge
::
	$squashDueToMemSÎ
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
)

382 
	`squash
(
£q_num
, 
tid
);

383 
	}
}

386 
	gP–šeSge
::
	$squashP»vSgeIn¡s
(
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

388 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Removing instructions from "

389 "šcomšg sgqueue.\n", 
tid
);

391 
š¡s_äom_´ev_¡age
 = 
´evSge
->
š¡s
.
	`size
();

392 
i
=0; i < 
š¡s_äom_´ev_¡age
; i++) {

393 ià(
´evSge
->
š¡s
[
i
]->
th»adNumb”
 =ğ
tid
 &&

394 
´evSge
->
š¡s
[
i
]->
£qNum
 > 
squash_£q_num
) {

395 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Squashing instruction, "

397 
tid
,

398 
´evSge
->
š¡s
[
i
]->
£qNum
,

399 
´evSge
->
š¡s
[
i
]->
	`pcS‹
());

400 
´evSge
->
š¡s
[
i
]->
	`£tSquashed
();

402 
´evSge
->
š¡s
[
i
] = 
ıu
->
dummyBufãrIn¡
;

405 
	}
}

408 
	gP–šeSge
::
	$squash
(
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

411 
¡ageStus
[
tid
] = 
Squashšg
;

413 
	`squashP»vSgeIn¡s
(
squash_£q_num
, 
tid
);

415 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Removing instructions from incoming stage"

416 " skidbufãr.\n", 
tid
);

419 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
cur_™
 = 
skidBufãr
[
tid
].
	`begš
();

420 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
’d_™
 = 
skidBufãr
[
tid
].
	`’d
();

422 
cur_™
 !ğ
’d_™
) {

423 ià((*
cur_™
)->
£qNum
 <ğ
squash_£q_num
) {

424 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Cannot„emove skidBuffer "

426 "[¢:%i]. %˜š¡ Ëá.\n", 
tid
,

427 (*
cur_™
)->
£qNum
, 
squash_£q_num
,

428 
skidBufãr
[
tid
].
	`size
());

429 
cur_™
++;

431 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Removing instruction, [sn:%i] "

432 " PC %s.\n", 
tid
, (*
cur_™
)->
£qNum
, (*cur_™)->
pc
);

433 (*
cur_™
)->
	`£tSquashed
();

434 
cur_™
 = 
skidBufãr
[
tid
].
	`”a£
(cur_it);

439 
	}
}

442 
	gP–šeSge
::
	$¡ageBufãrAva
()

444 
tÙ®
 = 0;

446 
i
=0; i < 
TheP–še
::
MaxTh»ads
; i++) {

447 
tÙ®
 +ğ
skidBufãr
[
i
].
	`size
();

450 
ava
 = 
¡ageBufãrMax
 - 
tÙ®
;

451 
	`as£¹
(
ava
 >= 0);

453  
ava
;

454 
	}
}

456 
boŞ


457 
	gP–šeSge
::
	$ÿnS’dIn¡ToSge
(
¡age_num
)

459 
boŞ
 
bufãr_ava
 = 
çl£
;

461 ià(
ıu
->
p–šeSge
[
¡age_num
]->
´evSgeV®id
) {

462 
bufãr_ava
 = 
ıu
->
p–šeSge
[
¡age_num
]->
	`¡ageBufãrAva
() -

463 
ıu
->
p–šeSge
[
¡age_num
-1]->
ÃxtSge
->
š¡s
.
	`size
() >= 1;

466 ià(!
bufãr_ava
 && 
	`ÃxtSgeQueueV®id
(
¡age_num
)) {

467 
	`DPRINTF
(
InOrd”SÎ
, "STALL: No„oom in stage %i buffer.\n",

468 
¡ageNum
 + 1);

471  
bufãr_ava
;

472 
	}
}

475 
	gP–šeSge
::
	$skidSize
()

477 
tÙ®
 = 0;

479 
i
=0; i < 
TheP–še
::
MaxTh»ads
; i++) {

480 
tÙ®
 +ğ
skidBufãr
[
i
].
	`size
();

483  
tÙ®
;

484 
	}
}

486 
boŞ


487 
	gP–šeSge
::
	$skidsEm±y
()

489 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

491 
th»ads
 !ğ
aùiveTh»ads
->
	`’d
()) {

492 ià(!
skidBufãr
[*
th»ads
++].
	`em±y
())

493  
çl£
;

496  
Œue
;

497 
	}
}

502 
	gP–šeSge
::
	$upd©eStus
()

504 
boŞ
 
ªy_unblockšg
 = 
çl£
;

506 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

508 
th»ads
 !ğ
aùiveTh»ads
->
	`’d
()) {

509 
Th»adID
 
tid
 = *
th»ads
++;

511 ià(
¡ageStus
[
tid
] =ğ
Unblockšg
) {

512 
ªy_unblockšg
 = 
Œue
;

518 ià(
ªy_unblockšg
) {

519 ià(
_¡©us
 =ğ
IÇùive
) {

520 
_¡©us
 = 
Aùive
;

522 
	`DPRINTF
(
Aùiv™y
, "Activating stage.\n");

524 
ıu
->
	`aùiv©eSge
(
¡ageNum
);

529 ià(
_¡©us
 =ğ
Aùive
) {

530 
_¡©us
 = 
IÇùive
;

531 
	`DPRINTF
(
Aùiv™y
, "Deactivating stage.\n");

533 
ıu
->
	`d—ùiv©eSge
(
¡ageNum
);

536 
	}
}

539 
	gP–šeSge
::
	$aùiv©eTh»ad
(
Th»adID
 
tid
)

541 ià(
ıu
->
th»adMod–
 =ğ
InOrd”CPU
::
Sw™chOnCacheMiss
) {

542 ià(!
sw™chedOutV®id
[
tid
]) {

543 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i] No instruction‡vailable in "

544 "sw™ch ouˆbufãr.\n", 
tid
);

546 
DynIn¡PŒ
 
š¡
 = 
sw™chedOutBufãr
[
tid
];

548 
	`DPRINTF
(
InOrd”Sge
,"[tid:%i]: Re-Inserting [sn:%lli] PC:%s into"

549 " sgskidBufã¸%i\n", 
tid
, 
š¡
->
£qNum
,

550 
š¡
->
	`pcS‹
(), in¡->
th»adNumb”
);

553 
skidBufãr
[
tid
].
	`push_back
(
š¡
);

557 
ıu
->
»sPoŞ
->
	`scheduËEv’t
((
InOrd”CPU
::
CPUEv’tTy³
)

558 
ResourûPoŞ
::
Upd©eAá”CÚ‹xtSw™ch
,

559 
š¡
, 
	`Cyşes
(0), 0, 
tid
);

562 
sw™chedOutBufãr
[
tid
] = 
NULL
;

563 
sw™chedOutV®id
[
tid
] = 
çl£
;

566 
ıu
->
	`upd©eCÚ‹xtSw™chSts
();

570 
	}
}

574 
	gP–šeSge
::
	$sÜtIn¡s
()

576 ià(
´evSgeV®id
) {

577 
	`as£¹
(
´evSge
->
š¡s
.
	`size
(è<ğ
¡ageWidth
);

579 
š¡s_äom_´ev_¡age
 = 
´evSge
->
š¡s
.
	`size
();

580 
š¡s_äom_cur_¡age
 = 
	`skidSize
();

581 
	`DPRINTF
(
InOrd”Sge
, "%i insts‡vailable from stage buffer %i. Stage "

583 
š¡s_äom_´ev_¡age
, 
´evSgeQueue
->
	`id
(),

584 
š¡s_äom_cur_¡age
);

586 
š£¹ed_š¡s
 = 0;

588 
i
 = 0; i < 
š¡s_äom_´ev_¡age
; i++) {

589 ià(
´evSge
->
š¡s
[
i
]->
	`isSquashed
()) {

590 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Ignoring squashed [sn:%i], "

592 
´evSge
->
š¡s
[
i
]->
	`»adTid
(),

593 
´evSge
->
š¡s
[
i
]->
£qNum
);

597 
Th»adID
 
tid
 = 
´evSge
->
š¡s
[
i
]->
th»adNumb”
;

599 ià(
š£¹ed_š¡s
 + 
š¡s_äom_cur_¡age
 =ğ
¡ageWidth
) {

600 
	`DPRINTF
(
InOrd”Sge
, "Stage %i has‡ccepted‡ll insts "

602 
¡ageNum
, 
´evSge
->
š¡s
[
i
]->
£qNum
, stageNum - 1);

603 
ıu
->
p–šeSge
[
¡ageNum
 - 1]->

604 
skidBufãr
[
tid
].
	`push_äÚt
(
´evSge
->
š¡s
[
i
]);

606 
´ev_¡age
 = 
¡ageNum
 - 1;

607 ià(
ıu
->
p–šeSge
[
´ev_¡age
]->
¡ageStus
[
tid
] =ğ
RuÂšg
 ||

608 
ıu
->
p–šeSge
[
´ev_¡age
]->
¡ageStus
[
tid
] =ğ
IdË
) {

609 
ıu
->
p–šeSge
[
´ev_¡age
]->
¡ageStus
[
tid
] = 
Unblockšg
;

612 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: Inserting [sn:%i] into stage "

613 "bufãr.\n", 
´evSge
->
š¡s
[
i
]->
	`»adTid
(),

614 
´evSge
->
š¡s
[
i
]->
£qNum
);

616 
skidBufãr
[
tid
].
	`push_back
(
´evSge
->
š¡s
[
i
]);

619 
´evSge
->
š¡s
[
i
] = 
ıu
->
dummyBufãrIn¡
;

621 
š£¹ed_š¡s
++;

624 
	}
}

629 
	gP–šeSge
::
	$»adSÎSigÇls
(
Th»adID
 
tid
)

631 
¡age_idx
 = 
¡ageNum
+1; sge_idx <ğ
Ï¡SÎšgSge
[
tid
];

632 
¡age_idx
++) {

634 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i] Reading stall signals from Stage "

636 
tid
,

637 
¡age_idx
,

638 
äomNextSges
->
¡ageBlock
[
¡age_idx
][
tid
],

639 
äomNextSges
->
¡ageUnblock
[
¡age_idx
][
tid
]);

642 ià(
äomNextSges
->
¡ageBlock
[
¡age_idx
][
tid
]) {

643 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i] SÎ from sg%˜£t.\n", 
tid
,

644 
¡age_idx
);

645 
¡®ls
[
tid
].
¡age
[
¡age_idx
] = 
Œue
;

649 ià(
äomNextSges
->
¡ageUnblock
[
¡age_idx
][
tid
]) {

650 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i] SÎ from sg%˜un£t.\n", 
tid
,

651 
¡age_idx
);

652 
¡®ls
[
tid
].
¡age
[
¡age_idx
] = 
çl£
;

655 
	}
}

659 
boŞ


660 
	gP–šeSge
::
	$checkSigÇlsAndUpd©e
(
Th»adID
 
tid
)

671 
	`»adSÎSigÇls
(
tid
);

674 
¡age_idx
=
¡ageNum
; sge_idx < 
NumSges
; stage_idx++) {

675 ià(
äomNextSges
->
¡ageInfo
[
¡age_idx
][
tid
].
squash
) {

676 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Squashing instructions dueo "

677 "squash from sg%u.\n", 
tid
, 
¡age_idx
);

678 
In¡SeqNum
 
squash_£q_num
 = 
äomNextSges
->

679 
¡ageInfo
[
¡age_idx
][
tid
].
dÚeSeqNum
;

680 
	`squash
(
squash_£q_num
, 
tid
);

685 ià(
	`checkSÎ
(
tid
)) {

686  
	`block
(
tid
);

689 ià(
¡ageStus
[
tid
] =ğ
Blocked
) {

690 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Done blocking, switchingo "

691 "unblockšg.\n", 
tid
);

693 
¡ageStus
[
tid
] = 
Unblockšg
;

695 
	`unblock
(
tid
);

697  
Œue
;

700 ià(
¡ageStus
[
tid
] =ğ
Squashšg
) {

701 ià(!
skidBufãr
[
tid
].
	`em±y
()) {

702 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Done squashing, switchingo "

703 "unblockšg.\n", 
tid
);

705 
¡ageStus
[
tid
] = 
Unblockšg
;

709 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Done squashing, switchingo "

710 "ruÂšg.\n", 
tid
);

712 
¡ageStus
[
tid
] = 
RuÂšg
;

715  
Œue
;

720  
çl£
;

721 
	}
}

726 
	gP–šeSge
::
	$tick
()

728 
idË
 = 
çl£
;

730 
wrÙeToTimeBufãr
 = 
çl£
;

732 
boŞ
 
¡©us_chªge
 = 
çl£
;

734 
	`sÜtIn¡s
();

736 
š¡sProûs£d
 = 0;

738 
	`´oûssSge
(
¡©us_chªge
);

740 ià(
¡©us_chªge
) {

741 
	`upd©eStus
();

744 ià(
wrÙeToTimeBufãr
) {

745 
	`DPRINTF
(
Aùiv™y
, "Activityhis cycle.\n");

746 
ıu
->
	`aùiv™yThisCyşe
();

749 
	`DPRINTF
(
InOrd”Sge
, "\n\n");

750 
	}
}

753 
	gP–šeSge
::
	$£tResSÎ
(
ResReqPŒ
 
»s_»q
, 
Th»adID
 
tid
)

755 
	`DPRINTF
(
InOrd”Sge
, "In£¹šg sÎ from %s.\n", 
»s_»q
->
»s
->
	`Çme
());

756 
¡®ls
[
tid
].
»sourûs
.
	`push_back
(
»s_»q
);

757 
	}
}

760 
	gP–šeSge
::
	$un£tResSÎ
(
ResReqPŒ
 
»s_»q
, 
Th»adID
 
tid
)

764 
veùÜ
<
ResReqPŒ
>::
™”©Ü
 
»q_™
 = 
¡®ls
[
tid
].
»sourûs
.
	`begš
();

765 
veùÜ
<
ResReqPŒ
>::
™”©Ü
 
»q_’d
 = 
¡®ls
[
tid
].
»sourûs
.
	`’d
();

767 
»q_™
 !ğ
»q_’d
) {

768 ifĞ(*
»q_™
)->
»s
 =ğ
»s_»q
->res &&

769 (*
»q_™
)->
š¡
 =ğ
»s_»q
->inst &&

770 (*
»q_™
)->
	`g‘SlÙ
(è=ğ
»s_»q
->getSlot()) {

771 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Clearing stall by %s.\n",

772 
tid
, 
»s_»q
->
»s
->
	`Çme
());

773 
¡®ls
[
tid
].
»sourûs
.
	`”a£
(
»q_™
);

777 
»q_™
++;

780 ià(
¡®ls
[
tid
].
»sourûs
.
	`size
() == 0) {

781 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: There‡re‚o„emaining„esource"

782 "¡®ls.\n", 
tid
);

784 
	}
}

791 
	gP–šeSge
::
	$´oûssSge
(
boŞ
 &
¡©us_chªge
)

793 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

796 
th»ads
 !ğ
aùiveTh»ads
->
	`’d
()) {

797 
Th»adID
 
tid
 = *
th»ads
++;

799 
	`DPRINTF
(
InOrd”Sge
,"Proûssšg [tid:%i]\n",
tid
);

800 
¡©us_chªge
 = 
	`checkSigÇlsAndUpd©e
(
tid
) || status_change;

802 
	`´oûssTh»ad
(
¡©us_chªge
, 
tid
);

805 ià(
ÃxtSgeV®id
) {

806 
	`DPRINTF
(
InOrd”Sge
, "%i insts‚ow‡vailable for stage %i.\n",

807 
ÃxtSge
->
š¡s
.
	`size
(), 
¡ageNum
 + 1);

810 ià(
š¡sProûs£d
 > 0) {

811 ++
runCyşes
;

812 
idË
 = 
çl£
;

814 ++
idËCyşes
;

815 
idË
 = 
Œue
;

818 
	`DPRINTF
(
InOrd”Sge
, "%˜Ëá iÀ¡ag%˜šcomšg bufãr.\n", 
	`skidSize
(),

819 
¡ageNum
);

821 
	`DPRINTF
(
InOrd”Sge
, "%i‡vailable in stage %i incoming buffer.\n",

822 
	`¡ageBufãrAva
(), 
¡ageNum
);

823 
	}
}

826 
	gP–šeSge
::
	$´oûssTh»ad
(
boŞ
 &
¡©us_chªge
, 
Th»adID
 
tid
)

837 ià(
¡ageStus
[
tid
] =ğ
RuÂšg
 ||

838 
¡ageStus
[
tid
] =ğ
IdË
) {

839 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Not blocked, so‡ttemptingo„un "

840 "¡age.\n",
tid
);

842 
	`´oûssIn¡s
(
tid
);

843 } ià(
¡ageStus
[
tid
] =ğ
Unblockšg
) {

846 
	`as£¹
(!
	`skidsEm±y
());

851 
	`´oûssIn¡s
(
tid
);

853 
¡©us_chªge
 = 
	`unblock
(
tid
) || status_change;

855 
	}
}

859 
	gP–šeSge
::
	$´oûssIn¡s
(
Th»adID
 
tid
)

863 
š¡s_avaabË
 = 
skidBufãr
[
tid
].
	`size
();

865 
¡d
::
li¡
<
DynIn¡PŒ
> &
š¡s_to_¡age
 = 
skidBufãr
[
tid
];

867 ià(
š¡s_avaabË
 == 0) {

868 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Nothingo do, breaking out"

869 "ƒ¬ly.\n",
tid
);

873 
DynIn¡PŒ
 
š¡
;

874 
boŞ
 
Ï¡_»q_com¶‘ed
 = 
Œue
;

876 
š¡s_avaabË
 > 0 &&

877 
š¡sProûs£d
 < 
¡ageWidth
 &&

878 
Ï¡_»q_com¶‘ed
) {

879 
	`as£¹
(!
š¡s_to_¡age
.
	`em±y
());

881 
š¡
 = 
š¡s_to_¡age
.
	`äÚt
();

883 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Processing instruction [sn:%lli] "

884 "% w™h PC %s\n", 
tid
, 
š¡
->
£qNum
,

885 
š¡
->
	`š¡Name
(),

886 
š¡
->
	`pcS‹
());

888 ià(
š¡
->
	`isSquashed
()) {

889 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Instruction %i with PC %s is "

891 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

893 
š¡s_to_¡age
.
	`pİ_äÚt
();

895 --
š¡s_avaabË
;

900 
»qs_´oûs£d
 = 0;

901 
Ï¡_»q_com¶‘ed
 = 
	`´oûssIn¡ScheduË
(
š¡
, 
»qs_´oûs£d
);

906 ià(
»qs_´oûs£d
 > 0)

907 
š¡sProûs£d
++;

911 ià(!
Ï¡_»q_com¶‘ed
)

915 ià(
ÃxtSgeV®id
 && !
	`£ndIn¡ToNextSge
(
š¡
)) {

916 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i] [sn:%i] unableo…roceedo stage"

917 " %i.\n", 
tid
, 
š¡
->
£qNum
,š¡->
ÃxtSge
);

921 
š¡s_to_¡age
.
	`pİ_äÚt
();

923 --
š¡s_avaabË
;

928 ià(!
š¡s_to_¡age
.
	`em±y
()) {

929 
	`blockDueToBufãr
(
tid
);

934 ià(
š¡sProûs£d
) {

935 
wrÙeToTimeBufãr
 = 
Œue
;

937 
	}
}

939 
boŞ


940 
	gP–šeSge
::
	$´oûssIn¡ScheduË
(
DynIn¡PŒ
 
š¡
,&
»qs_´oûs£d
)

942 
boŞ
 
Ï¡_»q_com¶‘ed
 = 
Œue
;

943 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

945 ià(
š¡
->
	`ÃxtResSge
(è=ğ
¡ageNum
) {

946 
»s_¡age_num
 = 
š¡
->
	`ÃxtResSge
();

948 
»s_¡age_num
 =ğ
¡ageNum
) {

949 
»s_num
 = 
š¡
->
	`ÃxtResourû
();

952 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: [sn:%i]: sending„equesto %s."

953 "\n", 
tid
, 
š¡
->
£qNum
, 
ıu
->
»sPoŞ
->
	`Çme
(
»s_num
));

955 
ResReqPŒ
 
»q
 = 
ıu
->
»sPoŞ
->
	`»que¡
(
»s_num
, 
š¡
);

956 
	`as£¹
(
»q
->
v®id
);

958 
boŞ
 
»q_com¶‘ed
 = 
»q
->
	`isCom¶‘ed
();

959 
boŞ
 
dÚe_š_p–še
 = 
çl£
;

960 ià(
»q_com¶‘ed
) {

961 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: [sn:%i]„equesto %s "

962 "com¶‘ed.\n", 
tid
, 
š¡
->
£qNum
,

963 
ıu
->
»sPoŞ
->
	`Çme
(
»s_num
));

965 
»qs_´oûs£d
++;

967 
»q
->
¡agePas£s
++;

969 
dÚe_š_p–še
 = 
š¡
->
	`fšishSkedEÁry
();

970 ià(
dÚe_š_p–še
) {

971 
	`DPRINTF
(
InOrd”DynIn¡
, "[tid:%i]: [sn:%i] finished "

972 "š…–še.\n", 
tid
, 
š¡
->
£qNum
);

975 
	`DPRINTF
(
InOrd”Sge
, "[tid:%i]: [sn:%i]„equesto %s failed."

976 "\n", 
tid
, 
š¡
->
£qNum
, 
ıu
->
»sPoŞ
->
	`Çme
(
»s_num
));

978 
Ï¡_»q_com¶‘ed
 = 
çl£
;

980 ià(
»q
->
	`isMemSÎ
() &&

981 
ıu
->
th»adMod–
 =ğ
InOrd”CPU
::
Sw™chOnCacheMiss
) {

983 
	`DPRINTF
(
Th»adMod–
, "[tid:%i] [sn:%i] Detected cache "

984 "miss.\n", 
tid
, 
š¡
->
£qNum
);

986 
	`DPRINTF
(
InOrd”Sge
, "Inserting [tid:%i][sn:%i] into "

987 "sw™ch ouˆbufãr.\n", 
tid
, 
š¡
->
£qNum
);

989 
sw™chedOutBufãr
[
tid
] = 
š¡
;

990 
sw™chedOutV®id
[
tid
] = 
Œue
;

993 
š¡
->
squashšgSge
 = 
¡ageNum
;

994 
š¡
->
squashSeqNum
 = in¡->
£qNum
;

995 
ıu
->
	`squashFromMemSÎ
(
š¡
, 
tid
);

1000 
	`DPRINTF
(
Th»adMod–
, "Suspending [tid:%i] dueo cache "

1001 "miss.\n", 
tid
);

1002 
ıu
->
	`su¥’dCÚ‹xt
(
tid
);

1005 
	`DPRINTF
(
Th»adMod–
, "Attemptingo‡ctivate‚ext„eady "

1007 
ıu
->
	`aùiv©eNextR—dyCÚ‹xt
();

1013 ià(
»q
->
dÚeInResourû
) {

1014 
»q
->
	`ä“SlÙ
();

1020 ià(
dÚe_š_p–še
 || !
»q_com¶‘ed
) {

1024 
»s_¡age_num
 = 
š¡
->
	`ÃxtResSge
();

1027 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Instruction [sn:%i] with PC %s "

1029 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
(), 
¡ageNum
);

1032  
Ï¡_»q_com¶‘ed
;

1033 
	}
}

1035 
boŞ


1036 
	gP–šeSge
::
	$ÃxtSgeQueueV®id
(
¡age_num
)

1038  
ıu
->
p–šeSge
[
¡age_num
]->
ÃxtSgeV®id
;

1039 
	}
}

1042 
boŞ


1043 
	gP–šeSge
::
	$£ndIn¡ToNextSge
(
DynIn¡PŒ
 
š¡
)

1048 ià(
š¡
->
ÃxtSge
 =ğ
¡ageNum
)

1049 
š¡
->
ÃxtSge
++;

1051 
boŞ
 
sucûss
 = 
çl£
;

1052 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

1053 
Ãxt_¡age
 = 
š¡
->
ÃxtSge
;

1054 
´ev_¡age
 = 
Ãxt_¡age
 - 1;

1056 
	`as£¹
(
Ãxt_¡age
 >= 1);

1057 
	`as£¹
(
´ev_¡age
 >= 0);

1059 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Attemptingo send instructionso "

1060 "¡ag%u.\n", 
tid
, 
¡ageNum
+1);

1062 ià(!
	`ÿnS’dIn¡ToSge
(
š¡
->
ÃxtSge
)) {

1063 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: Could‚ot send instructiono "

1064 "¡ag%u.\n", 
tid
, 
¡ageNum
+1);

1065  
çl£
;

1069 ià(
	`ÃxtSgeQueueV®id
(
š¡
->
ÃxtSge
 - 1)) {

1070 ià(
š¡
->
£qNum
 > 
ıu
->
squashSeqNum
[
tid
] &&

1071 
	`curTick
(è=ğ
ıu
->
Ï¡SquashCyşe
[
tid
]) {

1072 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: [sn:%i]: squashed, skipping "

1073 "š£¹iÚ iÁØ¡ag%˜queue.\n", 
tid
, 
š¡
->
£qNum
,

1074 
š¡
->
ÃxtSge
);

1076 ià(
ÃxtSgeV®id
) {

1077 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u] %i slots‡vailable in‚ext "

1078 "¡agbufãr.\n", 
tid
,

1079 
ıu
->
p–šeSge
[
Ãxt_¡age
]->
	`¡ageBufãrAva
());

1082 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: [sn:%i]: being…laced into "

1084 
tid
, 
š¡
->
£qNum
,

1085 
ıu
->
p–šeSge
[
´ev_¡age
]->
ÃxtSge
->
š¡s
.
	`size
(),

1086 
ıu
->
p–šeSge
[
´ev_¡age
]->
ÃxtSgeQueue
->
	`id
());

1090 
ıu
->
p–šeSge
[
´ev_¡age
]->
ÃxtSge
->
š¡s
.
	`push_back
(
š¡
);

1092 
sucûss
 = 
Œue
;

1095 ià(
š¡
->
ŒaûD©a
) {

1097 
š¡
->
ŒaûD©a
->
	`£tSgeCyşe
(
¡ageNum
, 
	`curTick
());

1103  
sucûss
;

1104 
	}
}

1107 
	gP–šeSge
::
	$dumpIn¡s
()

1109 
	`ırštf
("In¡ š Sg%˜skidbufãrs\n",
¡ageNum
);

1111 
Th»adID
 
tid
 = 0;id < 
TheP–še
::
MaxTh»ads
;id++) {

1112 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
cur_™
 = 
skidBufãr
[
tid
].
	`begš
();

1113 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
’d_™
 = 
skidBufãr
[
tid
].
	`’d
();

1115 
cur_™
 !ğ
’d_™
) {

1116 
DynIn¡PŒ
 
š¡
 = (*
cur_™
);

1118 
	`ırštf
("Inst. PC:%s\n[tid:%i]\n[sn:%i]\n\n",

1119 
š¡
->
	`pcS‹
(), in¡->
th»adNumb”
, in¡->
£qNum
);

1121 
cur_™
++;

1125 
	}
}

	@inorder/pipeline_stage.hh

32 #iâdeà
__CPU_INORDER_PIPELINE_STAGE_HH__


33 
	#__CPU_INORDER_PIPELINE_STAGE_HH__


	)

35 
	~<queue
>

36 
	~<veùÜ
>

38 
	~"ba£/¡©i¡ics.hh
"

39 
	~"ıu/šÜd”/comm.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/timebuf.hh
"

43 
	~"·¿ms/InOrd”CPU.hh
"

45 
şass
 
	gInOrd”CPU
;

47 şas 
	cP–šeSge


49 
	m´Ùeùed
:

50 
TheP–še
::
	tP¬ams
 Params;

51 
	mTheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

53 
	mpublic
:

57 
	eSgeStus
 {

58 
Aùive
,

59 
	mIÇùive


63 
	eTh»adStus
 {

64 
	gRuÂšg
,

65 
	gIdË
,

66 
	gS¹Squash
,

67 
	gSquashšg
,

68 
	gBlocked
,

69 
	gUnblockšg
,

70 
	gMemWa™Re¥Ú£
,

71 
	gMemWa™R‘ry
,

72 
	gMemAcûssCom¶‘e


75 
	g´Ùeùed
:

77 
¡ageNum
;

80 
	g¡ageWidth
;

83 
Th»adID
 
	gnumTh»ads
;

86 
SgeStus
 
	g_¡©us
;

89 
Th»adStus
 
	g¡ageStus
[
TheP–še
::
MaxTh»ads
];

91 
	gpublic
:

92 
P–šeSge
(
P¬ams
 *
·¿ms
, 
¡age_num
);

94 
	gvœtu®
 ~
P–šeSge
();

97 
š™
(
P¬ams
 *
·¿ms
);

100 
	g¡d
::
¡ršg
 
	$Çme
() const;

103 
	`»gSts
();

106 
	`£tCPU
(
InOrd”CPU
 *
ıu_±r
);

109 
	`£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
);

112 
	`£tP»vSgeQueue
(
TimeBufãr
<
IÁ”SgeSŒuù
> *
´ev_¡age_±r
);

115 
	`£tNextSgeQueue
(
TimeBufãr
<
IÁ”SgeSŒuù
> *
Ãxt_¡age_±r
);

118 
	`£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

120 
boŞ
 
	`ÃxtSgeQueueV®id
(
¡age_num
);

122 
boŞ
 
	`isBlocked
(
Th»adID
 
tid
);

135 
	`sw™chOut
();

138 
	`keOv”From
();

143 
	`tick
();

146 
	`£tResSÎ
(
ResReqPŒ
 
»s_»q
, 
Th»adID
 
tid
);

149 
	`un£tResSÎ
(
ResReqPŒ
 
»s_»q
, 
Th»adID
 
tid
);

152 
	`»moveSÎs
(
Th»adID
 
tid
);

155 
	`¡ageBufãrAva
();

157 
´Ùeùed
:

159 
vœtu®
 
	`´oûssSge
(
boŞ
 &
¡©us_chªge
);

166 
	`´oûssTh»ad
(
boŞ
 &
¡©us_chªge
, 
Th»adID
 
tid
);

173 
vœtu®
 
	`´oûssIn¡s
(
Th»adID
 
tid
);

176 
boŞ
 
	`´oûssIn¡ScheduË
(
DynIn¡PŒ
 
š¡
, &
»qs_´oûs£d
);

179 
boŞ
 
	`ÿnS’dIn¡ToSge
(
¡age_num
);

182 
boŞ
 
	`£ndIn¡ToNextSge
(
DynIn¡PŒ
 
š¡
);

185 
	`skidSize
();

188 
boŞ
 
	`skidsEm±y
();

191 
	`upd©eStus
();

196 
	`sÜtIn¡s
();

199 
	`»adSÎSigÇls
(
Th»adID
 
tid
);

202 
boŞ
 
	`checkSigÇlsAndUpd©e
(
Th»adID
 
tid
);

205 
boŞ
 
	$checkSÎ
(
Th»adID
 
tid
) const;

210 
šlše
 
boŞ
 
	`´evSgeIn¡sV®id
();

216 
boŞ
 
	`block
(
Th»adID
 
tid
);

218 
	`blockDueToBufãr
(
Th»adID
 
tid
);

224 
boŞ
 
	`unblock
(
Th»adID
 
tid
);

227 
public
:

228 
	`aùiv©eTh»ad
(
Th»adID
 
tid
);

231 
	`£tupSquash
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
);

233 
vœtu®
 
	`squashDueToMemSÎ
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
);

236 
vœtu®
 
	`squash
(
In¡SeqNum
 
squash_num
, 
Th»adID
 
tid
);

239 
	`squashP»vSgeIn¡s
(
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

241 
	`dumpIn¡s
();

243 
´Ùeùed
:

245 
InOrd”CPU
 *
ıu
;

247 
T¿û
::
InOrd”T¿û
 *
Œaûr
;

250 
¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

256 
¡d
::
veùÜ
<
DynIn¡PŒ
> 
sw™chedOutBufãr
;

257 
¡d
::
veùÜ
<
boŞ
> 
sw™chedOutV®id
;

262 
š¡sProûs£d
;

265 
¡d
::
li¡
<
DynIn¡PŒ
> 
skidBufãr
[
TheP–še
::
MaxTh»ads
];

269 
DynIn¡PŒ
 
dummyBufãrIn¡
;

272 
Addr
 
bd–ayDÚeSeqNum
[
TheP–še
::
MaxTh»ads
];

278 
boŞ
 
squashAá”D–aySlÙ
[
TheP–še
::
MaxTh»ads
];

281 
DynIn¡PŒ
 
squashIn¡
[
TheP–še
::
MaxTh»ads
];

285 
¡ageBufãrMax
;

290 
boŞ
 
wrÙeToTimeBufãr
;

293 
toNextSgeIndex
;

296 
Ï¡SÎšgSge
[
TheP–še
::
MaxTh»ads
];

299 
TimeBufãr
<
TimeSŒuù
> *
timeBufãr
;

301 
public
:

303 
TimeBufãr
<
TimeSŒuù
>::
wœe
 
äomNextSges
;

306 
TimeBufãr
<
TimeSŒuù
>::
wœe
 
toP»vSges
;

309 
TimeBufãr
<
IÁ”SgeSŒuù
> *
´evSgeQueue
;

312 
TimeBufãr
<
IÁ”SgeSŒuù
>::
wœe
 
´evSge
;

315 
TimeBufãr
<
IÁ”SgeSŒuù
> *
ÃxtSgeQueue
;

318 
TimeBufãr
<
IÁ”SgeSŒuù
>::
wœe
 
ÃxtSge
;

321 
boŞ
 
´evSgeV®id
;

324 
boŞ
 
ÃxtSgeV®id
;

326 
boŞ
 
idË
;

329 
	sSÎs
 {

330 
boŞ
 
¡age
[
TheP–še
::
NumSges
];

331 
¡d
::
veùÜ
<
ResReqPŒ
> 
»sourûs
;

332 
	}
};

335 
SÎs
 
	g¡®ls
[
TheP–še
::
MaxTh»ads
];

338 
	gSts
::
SÿÏr
 
idËCyşes
;

341 
	gSts
::
SÿÏr
 
runCyşes
;

344 
	gSts
::
FÜmuÏ
 
utiz©iÚ
;

	@inorder/pipeline_traits.5stage.cc

32 
	~"ıu/šÜd”/»sourûs/»sourû_li¡.hh
"

33 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

34 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
Çme¥aû
 
	gTheP–še
 {

42 
g‘NextPriÜ™y
(
DynIn¡PŒ
 &
š¡
, 
¡age_num
)

44 
	gcur_´i
 = 20;

63  
	gcur_´i
;

66 
ü—‹FrÚtEndScheduË
(
DynIn¡PŒ
 &
š¡
)

68 
	g¡Num
 = 0;

69 
	g¡Pri
 = 0;

71 
ResScheduË
 *
	gš¡_sched
 = &
š¡
->
»sSched
;

76 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
F‘chSeq
, 
F‘chSeqUn™
::
AssignNextPC
));

77 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
ITLB
, 
TLBUn™
::
F‘chLookup
));

78 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
ICache
, 
CacheUn™
::
In™Ÿ‹F‘ch
));

83 
	g¡Num
++; 
	g¡Pri
 = 0;

84 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
ICache
, 
CacheUn™
::
Com¶‘eF‘ch
));

85 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
Decode
, 
DecodeUn™
::
DecodeIn¡
));

86 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
BP»d
, 
B¿nchP»diùÜ
::
P»diùB¿nch
));

87 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
F‘chSeq
, 
F‘chSeqUn™
::
Upd©eT¬g‘PC
));

91 
boŞ
 
ü—‹BackEndScheduË
(
DynIn¡PŒ
 &
š¡
)

93 ià(!
	gš¡
->
	g¡©icIn¡
) {

94  
	gçl£
;

97 
	g¡Num
 = 
BackEndS¹Sge
;

98 
	g¡Pri
 = 0;

101 
ResScheduË
 *
	gš¡_sched
 = &
š¡
->
»sSched
;

106 
	gidx
=0; idx < 
	gš¡
->
numSrcRegs
(); idx++) {

107 ià(!
	gidx
 || !
	gš¡
->
isStÜe
())

108 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
RegMªag”
, 
U£DefUn™
::
R—dSrcReg
, 
idx
));

111 iàĞ
	gš¡
->
isNÚS³cuÏtive
() ) {

113 } ià(
	gš¡
->
isMemRef
()) {

114 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
AGEN
, 
AGENUn™
::
G’”©eAddr
));

115 iàĞ
	gš¡
->
isLßd
() ) {

116 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
DTLB
, 
TLBUn™
::
D©aLookup
));

117 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
DCache
, 
CacheUn™
::
In™Ÿ‹R—dD©a
));

120 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
ExecUn™
, 
ExecutiÚUn™
::
Execu‹In¡
));

126 
	g¡Pri
 = 0; 
	g¡Num
++;

127 iàĞ
	gš¡
->
isStÜe
() ) {

128 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
RegMªag”
, 
U£DefUn™
::
R—dSrcReg
, 1));

130 iàĞ
	gš¡
->
isLßd
() ) {

131 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
DCache
, 
CacheUn™
::
Com¶‘eR—dD©a
));

132 } iàĞ
	gš¡
->
isStÜe
() ) {

133 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
DTLB
, 
TLBUn™
::
D©aLookup
));

134 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
DCache
, 
CacheUn™
::
In™Ÿ‹Wr™eD©a
));

140 
	g¡Pri
 = 0; 
	g¡Num
++;

141 ià(
	gš¡
->
isNÚS³cuÏtive
()) {

142 ià(
	gš¡
->
isMemRef
())

143 
çl
("Schedule doesnt handle Non-Speculative Memory Instructions.\n");

145 ià(
	gš¡
->
İCÏss
(è=ğ
IÁMuÉOp
 || 
š¡
->İCÏss(è=ğ
IÁDivOp
) {

146 
š¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
MDU
, 
MuÉDivUn™
::
MuÉDiv
));

148 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
ExecUn™
, 
ExecutiÚUn™
::
Execu‹In¡
));

152 iàĞ
	gš¡
->
isStÜe
() )

153 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
DCache
, 
CacheUn™
::
Com¶‘eWr™eD©a
));

156 
	gidx
=0; idx < 
	gš¡
->
numDe¡Regs
(); idx++) {

157 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
RegMªag”
, 
U£DefUn™
::
Wr™eDe¡Reg
, 
idx
));

161 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
G¿d
, 
G¿du©iÚUn™
::
G¿du©eIn¡
));

163  
	gŒue
;

	@inorder/pipeline_traits.5stage.hh

32 #iâdeà
__CPU_INORDER_PIPELINE_IMPL_HH__


33 
	#__CPU_INORDER_PIPELINE_IMPL_HH__


	)

35 
	~<li¡
>

36 
	~<queue
>

37 
	~<veùÜ
>

39 
	~"¬ch/i§_Œa™s.hh
"

41 
şass
 
	gInOrd”DynIn¡
;

46 
Çme¥aû
 
	gTheP–še
 {

48 cÚ¡ 
	gNumSges
 = 5;

49 cÚ¡ 
	gMaxTh»ads
 = 3;

50 cÚ¡ 
	gSgeWidth
 = 1;

51 cÚ¡ 
	gBackEndS¹Sge
 = 2;

54 
	eResourûLi¡
 {

55 
	gF‘chSeq
 = 0,

56 
	gITLB
,

57 
	gICache
,

58 
	gDecode
,

59 
	gBP»d
,

60 
	gF‘chBuff
,

61 
	gRegMªag”
,

62 
	gAGEN
,

63 
	gExecUn™
,

64 
	gDTLB
,

65 
	gDCache
,

66 
	gG¿d
,

67 
	gF‘chBuff2


71 cÚ¡ 
	gš‹rSgeBuffSize
[] = {

72 
SgeWidth
,

73 
SgeWidth
,

74 
SgeWidth
,

75 
SgeWidth
,

76 
SgeWidth
,

77 
SgeWidth
,

78 
SgeWidth
,

79 
SgeWidth
,

80 
SgeWidth


83 
InOrd”CPUP¬ams
 
	tP¬ams
;

84 
	gRefCouÁšgPŒ
<
	tInOrd”DynIn¡
> 
	tDynIn¡PŒ
;

89 
	sScheduËEÁry
 {

90 
ScheduËEÁry
(
¡age_num
, 
_´iÜ™y
, 
»s_num
, 
_cmd
 = 0,

91 
_idx
 = 0) :

92 
¡ageNum
(
¡age_num
), 
»sNum
(
»s_num
), 
cmd
(
_cmd
),

93 
idx
(
_idx
), 
´iÜ™y
(
_´iÜ™y
)

95 
	gvœtu®
 ~
ScheduËEÁry
(){}

98 
	g¡ageNum
;

101 
	g»sNum
;

104 
	gcmd
;

107 
	gidx
;

110 
	g´iÜ™y
;

113 
	s’ŒyCom·»
 {

114 
boŞ
 
İ”©Ü
()(cÚ¡ 
ScheduËEÁry
* 
	glhs
, cÚ¡ ScheduËEÁry* 
	grhs
) const

117 ià(
	glhs
->
	g¡ageNum
 > 
	grhs
->stageNum) {

118  
	gŒue
;

119 } ià(
	glhs
->
	g¡ageNum
 =ğ
rhs
->
¡ageNum
) {

126 ià(
lhs
->
´iÜ™y
 > 
rhs
->priority) {

127  
Œue
;

129  
	gçl£
;

132  
	gçl£
;

138 
	g¡d
::
	t´iÜ™y_queue
<
	tScheduËEÁry
*, 
	t¡d
::
	tveùÜ
<ScheduleEntry*>,

139 
	t’ŒyCom·»
> 
	tResScheduË
;

141 
ü—‹FrÚtEndScheduË
(
DynIn¡PŒ
 &
š¡
);

142 
boŞ
 
ü—‹BackEndScheduË
(
DynIn¡PŒ
 &
š¡
);

143 
g‘NextPriÜ™y
(
DynIn¡PŒ
 &
š¡
, 
¡age_num
);

	@inorder/pipeline_traits.9stage.cc

32 
	~"ıu/šÜd”/»sourûs/»sourû_li¡.hh
"

33 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

34 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
Çme¥aû
 
	gTheP–še
 {

43 
g‘NextPriÜ™y
(
DynIn¡PŒ
 &
š¡
, 
¡age_num
)

45 
	gcur_´i
 = 20;

64  
	gcur_´i
;

67 
ü—‹FrÚtEndScheduË
(
DynIn¡PŒ
 &
š¡
)

69 
	g¡Num
 = 0;

70 
	g¡Pri
 = 0;

72 
ResScheduË
 *
	gš¡_sched
 = &
š¡
->
»sSched
;

77 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
F‘chSeq
, 
F‘chSeqUn™
::
AssignNextPC
));

78 
	g¡Pri
++;

80 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ITLB
, 
TLBUn™
::
F‘chLookup
));

81 
	g¡Pri
++;

83 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ICache
, 
CacheUn™
::
In™Ÿ‹F‘ch
));

84 
	g¡Pri
++;

87 
	g¡Num
++;

88 
	g¡Pri
 = 0;

93 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ICache
, 
CacheUn™
::
Com¶‘eF‘ch
));

94 
	g¡Pri
++;

96 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
Decode
, 
DecodeUn™
::
DecodeIn¡
));

97 
	g¡Pri
++;

99 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
BP»d
, 
B¿nchP»diùÜ
::
P»diùB¿nch
));

100 
	g¡Pri
++;

102 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
F‘chSeq
, 
F‘chSeqUn™
::
Upd©eT¬g‘PC
));

103 
	g¡Pri
++;

105 ià(
	gš¡
->
»adTid
() == 0)

106 
š¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
F‘chBuff
, 
In¡Bufãr
::
ScheduËOrBy·ss
));

108 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
F‘chBuff2
, 
In¡Bufãr
::
ScheduËOrBy·ss
));

109 
	g¡Pri
++;

112 
	g¡Num
++;

113 
	g¡Pri
 = 0;

119 
	g¡Num
++;

120 
	g¡Pri
 = 0;

123 
boŞ
 
ü—‹BackEndScheduË
(
DynIn¡PŒ
 &
š¡
)

125 ià(!
	gš¡
->
	g¡©icIn¡
) {

126  
	gçl£
;

129 
	g¡d
::
¡ršg
 
Çme
 = 
š¡
->
¡©icIn¡
->
g‘Name
();

131 
	g¡Num
 = 
BackEndS¹Sge
;

132 
	g¡Pri
 = 0;

135 
ResScheduË
 *
	gš¡_sched
 = &
š¡
->
»sSched
;

141 
	gidx
=0; idx < 
	gš¡
->
numSrcRegs
(); idx++) {

142 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
RegMªag”
, 
U£DefUn™
::
R—dSrcReg
, 
idx
));

144 
	g¡Pri
++;

147 
	g¡Pri
 = 0;

148 
	g¡Num
++;

153 ià(
	gš¡
->
isMemRef
()) {

154 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
AGEN
, 
AGENUn™
::
G’”©eAddr
));

158 
	g¡Pri
 = 0;

159 
	g¡Num
++;

165 ià(!
	gš¡
->
isNÚS³cuÏtive
(è&& !š¡->
isMemRef
()) {

166 ià(
	gš¡
->
İCÏss
(è=ğ
IÁMuÉOp
 || 
š¡
->İCÏss(è=ğ
IÁDivOp
) {

167 
š¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
++, 
MDU
, 
MuÉDivUn™
::
MuÉDiv
));

169 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ExecUn™
, 
ExecutiÚUn™
::
Execu‹In¡
));

172 
	g¡Pri
++;

175 ià(
	gš¡
->
isMemRef
()) {

176 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DTLB
, 
TLBUn™
::
D©aLookup
));

177 
	g¡Pri
++;

179 ià(
	gš¡
->
isLßd
()) {

180 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DCache
, 
CacheUn™
::
In™Ÿ‹R—dD©a
));

181 } ià(
	gš¡
->
isStÜe
()) {

182 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DCache
, 
CacheUn™
::
In™Ÿ‹Wr™eD©a
));

187 
	g¡Pri
 = 0;

188 
	g¡Num
++;

194 ià(
	gš¡
->
isMemRef
()) {

195 ià(
	gš¡
->
isLßd
()) {

196 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DCache
, 
CacheUn™
::
Com¶‘eR—dD©a
));

197 } ià(
	gš¡
->
isStÜe
()) {

198 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DCache
, 
CacheUn™
::
Com¶‘eWr™eD©a
));

203 
	g¡Pri
 = 0;

204 
	g¡Num
++;

210 
	g¡Pri
 = 0;

211 
	g¡Num
++;

217 ià(
	gš¡
->
isNÚS³cuÏtive
() ) {

218 ià(
	gš¡
->
isMemRef
())

219 
çl
("Schedule doesnt handle Non-Speculative Memory Instructions.\n");

221 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ExecUn™
, 
ExecutiÚUn™
::
Execu‹In¡
));

222 
	g¡Pri
++;

226 
	gidx
=0; idx < 
	gš¡
->
numDe¡Regs
(); idx++) {

227 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
RegMªag”
, 
U£DefUn™
::
Wr™eDe¡Reg
, 
idx
));

228 
	g¡Pri
++;

232 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
G¿d
, 
G¿du©iÚUn™
::
G¿du©eIn¡
));

233 
	g¡Pri
++;

236 
	g¡Pri
 = 0;

237 
	g¡Num
++;

239  
	gŒue
;

	@inorder/pipeline_traits.9stage.hh

32 #iâdeà
__CPU_INORDER_PIPELINE_IMPL_HH__


33 
	#__CPU_INORDER_PIPELINE_IMPL_HH__


	)

35 
	~<li¡
>

36 
	~<m­
>

37 
	~<queue
>

38 
	~<veùÜ
>

40 
	~"¬ch/i§_Œa™s.hh
"

42 
şass
 
	gInOrd”DynIn¡
;

47 
Çme¥aû
 
	gTheP–še
 {

49 cÚ¡ 
	gNumSges
 = 9;

50 cÚ¡ 
	gMaxTh»ads
 = 3;

51 cÚ¡ 
	gSgeWidth
 = 2;

52 cÚ¡ 
	gBackEndS¹Sge
 = 3;

55 
	g¡d
::
m­
<, > 
	g¡ageBufãrSizes
;

59 cÚ¡ 
	gš‹rSgeBuffSize
[
NumSges
] = {

60 
SgeWidth
,

61 
SgeWidth
,

63 
SgeWidth
,

64 
SgeWidth
,

65 
SgeWidth
,

66 
SgeWidth
,

67 
SgeWidth
,

68 
SgeWidth


73 
	eResourûLi¡
 {

74 
	gF‘chSeq
 = 0,

75 
	gITLB
,

76 
	gICache
,

77 
	gDecode
,

78 
	gBP»d
,

79 
	gF‘chBuff
,

80 
	gRegMªag”
,

81 
	gAGEN
,

82 
	gExecUn™
,

83 
	gDTLB
,

84 
	gDCache
,

85 
	gG¿d
,

86 
	gF‘chBuff2


89 
InOrd”CPUP¬ams
 
	tP¬ams
;

90 
	gRefCouÁšgPŒ
<
	tInOrd”DynIn¡
> 
	tDynIn¡PŒ
;

97 
	sScheduËEÁry
 {

98 
ScheduËEÁry
(
¡age_num
, 
_´iÜ™y
, 
»s_num
, 
_cmd
 = 0,

99 
_idx
 = 0) :

100 
¡ageNum
(
¡age_num
), 
»sNum
(
»s_num
), 
cmd
(
_cmd
),

101 
idx
(
_idx
), 
´iÜ™y
(
_´iÜ™y
)

103 
	gvœtu®
 ~
ScheduËEÁry
(){}

106 
	g¡ageNum
;

109 
	g»sNum
;

112 
	gcmd
;

115 
	gidx
;

118 
	g´iÜ™y
;

121 
	s’ŒyCom·»
 {

122 
boŞ
 
İ”©Ü
()(cÚ¡ 
ScheduËEÁry
* 
	glhs
, cÚ¡ ScheduËEÁry* 
	grhs
) const

125 ià(
	glhs
->
	g¡ageNum
 > 
	grhs
->stageNum) {

126  
	gŒue
;

127 } ià(
	glhs
->
	g¡ageNum
 =ğ
rhs
->
¡ageNum
) {

134 ià(
lhs
->
´iÜ™y
 > 
rhs
->priority) {

135  
Œue
;

137  
	gçl£
;

140  
	gçl£
;

146 
	g¡d
::
	t´iÜ™y_queue
<
	tScheduËEÁry
*, 
	t¡d
::
	tveùÜ
<ScheduleEntry*>,

147 
	t’ŒyCom·»
> 
	tResScheduË
;

149 
ü—‹FrÚtEndScheduË
(
DynIn¡PŒ
 &
š¡
);

150 
boŞ
 
ü—‹BackEndScheduË
(
DynIn¡PŒ
 &
š¡
);

151 
g‘NextPriÜ™y
(
DynIn¡PŒ
 &
š¡
, 
¡age_num
);

	@inorder/pipeline_traits.9stage.smt2.cc

32 
	~"ıu/šÜd”/»sourûs/»sourû_li¡.hh
"

33 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

34 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

36 
usšg
 
Çme¥aû
 
	g¡d
;

38 
Çme¥aû
 
	gTheP–še
 {

43 
g‘NextPriÜ™y
(
DynIn¡PŒ
 &
š¡
, 
¡age_num
)

45 
	gcur_´i
 = 20;

64  
	gcur_´i
;

67 
ü—‹FrÚtEndScheduË
(
DynIn¡PŒ
 &
š¡
)

69 
	g¡Num
 = 0;

70 
	g¡Pri
 = 0;

72 
ResScheduË
 *
	gš¡_sched
 = &
š¡
->
»sSched
;

77 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
F‘chSeq
, 
F‘chSeqUn™
::
AssignNextPC
));

78 
	g¡Pri
++;

80 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ITLB
, 
TLBUn™
::
F‘chLookup
));

81 
	g¡Pri
++;

83 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ICache
, 
CacheUn™
::
In™Ÿ‹F‘ch
));

84 
	g¡Pri
++;

87 
	g¡Num
++;

88 
	g¡Pri
 = 0;

93 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ICache
, 
CacheUn™
::
Com¶‘eF‘ch
));

94 
	g¡Pri
++;

96 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
Decode
, 
DecodeUn™
::
DecodeIn¡
));

97 
	g¡Pri
++;

99 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
BP»d
, 
B¿nchP»diùÜ
::
P»diùB¿nch
));

100 
	g¡Pri
++;

102 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
F‘chSeq
, 
F‘chSeqUn™
::
Upd©eT¬g‘PC
));

103 
	g¡Pri
++;

105 
	gãtch_buff_num
 = 
F‘chBuff
 + 
š¡
->
»adTid
();

107 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ãtch_buff_num
, 
In¡Bufãr
::
ScheduËOrBy·ss
));

110 
	g¡Num
++;

111 
	g¡Pri
 = 0;

117 
	g¡Num
++;

118 
	g¡Pri
 = 0;

121 
boŞ
 
ü—‹BackEndScheduË
(
DynIn¡PŒ
 &
š¡
)

123 ià(!
	gš¡
->
	g¡©icIn¡
) {

124  
	gçl£
;

127 
	g¡d
::
¡ršg
 
Çme
 = 
š¡
->
¡©icIn¡
->
g‘Name
();

129 
	g¡Num
 = 
BackEndS¹Sge
;

130 
	g¡Pri
 = 0;

133 
ResScheduË
 *
	gš¡_sched
 = &
š¡
->
»sSched
;

139 
	gidx
=0; idx < 
	gš¡
->
numSrcRegs
(); idx++) {

140 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
RegMªag”
, 
U£DefUn™
::
R—dSrcReg
, 
idx
));

142 
	g¡Pri
++;

145 
	g¡Pri
 = 0;

146 
	g¡Num
++;

151 ià(
	gš¡
->
isMemRef
()) {

152 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
AGEN
, 
AGENUn™
::
G’”©eAddr
));

156 
	g¡Pri
 = 0;

157 
	g¡Num
++;

163 ià(!
	gš¡
->
isNÚS³cuÏtive
(è&& !š¡->
isMemRef
()) {

167 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ExecUn™
, 
ExecutiÚUn™
::
Execu‹In¡
));

170 
	g¡Pri
++;

173 ià(
	gš¡
->
isMemRef
()) {

174 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DTLB
, 
TLBUn™
::
D©aLookup
));

175 
	g¡Pri
++;

177 ià(
	gš¡
->
isLßd
()) {

178 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DCache
, 
CacheUn™
::
In™Ÿ‹R—dD©a
));

179 } ià(
	gš¡
->
isStÜe
()) {

180 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DCache
, 
CacheUn™
::
In™Ÿ‹Wr™eD©a
));

185 
	g¡Pri
 = 0;

186 
	g¡Num
++;

192 ià(
	gš¡
->
isMemRef
()) {

193 ià(
	gš¡
->
isLßd
()) {

194 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DCache
, 
CacheUn™
::
Com¶‘eR—dD©a
));

195 } ià(
	gš¡
->
isStÜe
()) {

196 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
DCache
, 
CacheUn™
::
Com¶‘eWr™eD©a
));

201 
	g¡Pri
 = 0;

202 
	g¡Num
++;

208 
	g¡Pri
 = 0;

209 
	g¡Num
++;

215 ià(
	gš¡
->
isNÚS³cuÏtive
() ) {

216 ià(
	gš¡
->
isMemRef
())

217 
çl
("Schedule doesnt handle Non-Speculative Memory Instructions.\n");

219 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
ExecUn™
, 
ExecutiÚUn™
::
Execu‹In¡
));

220 
	g¡Pri
++;

224 
	gidx
=0; idx < 
	gš¡
->
numDe¡Regs
(); idx++) {

225 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
RegMªag”
, 
U£DefUn™
::
Wr™eDe¡Reg
, 
idx
));

226 
	g¡Pri
++;

230 
	gš¡_sched
->
push
(
Ãw
 
ScheduËEÁry
(
¡Num
, 
¡Pri
, 
G¿d
, 
G¿du©iÚUn™
::
G¿du©eIn¡
));

231 
	g¡Pri
++;

234 
	g¡Pri
 = 0;

235 
	g¡Num
++;

237  
	gŒue
;

	@inorder/pipeline_traits.9stage.smt2.hh

32 #iâdeà
__CPU_INORDER_PIPELINE_IMPL_HH__


33 
	#__CPU_INORDER_PIPELINE_IMPL_HH__


	)

35 
	~<li¡
>

36 
	~<m­
>

37 
	~<queue
>

38 
	~<veùÜ
>

40 
	~"¬ch/i§_Œa™s.hh
"

42 
şass
 
	gInOrd”DynIn¡
;

47 
Çme¥aû
 
	gTheP–še
 {

49 cÚ¡ 
	gNumSges
 = 9;

50 cÚ¡ 
	gMaxTh»ads
 = 2;

51 cÚ¡ 
	gSgeWidth
 = 1;

52 cÚ¡ 
	gBackEndS¹Sge
 = 3;

55 
	g¡d
::
m­
<, > 
	g¡ageBufãrSizes
;

59 cÚ¡ 
	gš‹rSgeBuffSize
[
NumSges
] = {

60 
SgeWidth
,

61 
SgeWidth
,

62 
MaxTh»ads
 * 4,

63 
SgeWidth
,

64 
MaxTh»ads
 * 4,

65 
SgeWidth
,

66 
SgeWidth
,

67 
SgeWidth
,

68 
MaxTh»ads


73 
	eResourûLi¡
 {

74 
	gF‘chSeq
 = 0,

75 
	gITLB
,

76 
	gICache
,

77 
	gDecode
,

78 
	gBP»d
,

79 
	gRegMªag”
,

80 
	gAGEN
,

81 
	gExecUn™
,

82 
	gDTLB
,

83 
	gDCache
,

84 
	gG¿d
,

85 
	gF‘chBuff
,

86 
	gF‘chBuff2


89 
InOrd”CPUP¬ams
 
	tP¬ams
;

90 
	gRefCouÁšgPŒ
<
	tInOrd”DynIn¡
> 
	tDynIn¡PŒ
;

97 
	sScheduËEÁry
 {

98 
ScheduËEÁry
(
¡age_num
, 
_´iÜ™y
, 
»s_num
, 
_cmd
 = 0,

99 
_idx
 = 0) :

100 
¡ageNum
(
¡age_num
), 
»sNum
(
»s_num
), 
cmd
(
_cmd
),

101 
idx
(
_idx
), 
´iÜ™y
(
_´iÜ™y
)

103 
	gvœtu®
 ~
ScheduËEÁry
(){}

106 
	g¡ageNum
;

109 
	g»sNum
;

112 
	gcmd
;

115 
	gidx
;

118 
	g´iÜ™y
;

121 
	s’ŒyCom·»
 {

122 
boŞ
 
İ”©Ü
()(cÚ¡ 
ScheduËEÁry
* 
	glhs
, cÚ¡ ScheduËEÁry* 
	grhs
) const

125 ià(
	glhs
->
	g¡ageNum
 > 
	grhs
->stageNum) {

126  
	gŒue
;

127 } ià(
	glhs
->
	g¡ageNum
 =ğ
rhs
->
¡ageNum
) {

134 ià(
lhs
->
´iÜ™y
 > 
rhs
->priority) {

135  
Œue
;

137  
	gçl£
;

140  
	gçl£
;

146 
	g¡d
::
	t´iÜ™y_queue
<
	tScheduËEÁry
*, 
	t¡d
::
	tveùÜ
<ScheduleEntry*>,

147 
	t’ŒyCom·»
> 
	tResScheduË
;

149 
ü—‹FrÚtEndScheduË
(
DynIn¡PŒ
 &
š¡
);

150 
boŞ
 
ü—‹BackEndScheduË
(
DynIn¡PŒ
 &
š¡
);

151 
g‘NextPriÜ™y
(
DynIn¡PŒ
 &
š¡
, 
¡age_num
);

	@inorder/pipeline_traits.hh

32 #iâdeà
__CPU_INORDER_PIPELINE_IMPL_HH__


33 
	#__CPU_INORDER_PIPELINE_IMPL_HH__


	)

35 
	~<li¡
>

36 
	~<queue
>

37 
	~<veùÜ
>

39 
	~"¬ch/i§_Œa™s.hh
"

40 
	~"ıu/ba£.hh
"

41 
	~"·¿ms/InOrd”CPU.hh
"

43 
şass
 
	gInOrd”DynIn¡
;

44 
şass
 
	gScheduËEÁry
;

45 
şass
 
	gResourûSked
;

50 
Çme¥aû
 
	gTheP–še
 {

52 cÚ¡ 
	gNumSges
 = 5;

53 cÚ¡ 
Th»adID
 
	gMaxTh»ads
 = 1;

54 cÚ¡ 
	gBackEndS¹Sge
 = 2;

57 
	eResourûId
 {

58 
	gF‘chSeq
 = 0,

59 
	gICache
,

60 
	gDecode
,

61 
	gBP»d
,

62 
	gF‘chBuff
,

63 
	gRegMªag”
,

64 
	gAGEN
,

65 
	gExecUn™
,

66 
	gMDU
,

67 
	gDCache
,

68 
	gG¿d
,

69 
	gF‘chBuff2


72 
InOrd”CPUP¬ams
 
	tP¬ams
;

73 
	gRefCouÁšgPŒ
<
	tInOrd”DynIn¡
> 
	tDynIn¡PŒ
;

78 
ResourûSked
 
	tResScheduË
;

79 
ResourûSked
* 
	tRSkedPŒ
;

	@inorder/reg_dep_map.cc

33 
	~"¬ch/i§_Œa™s.hh
"

34 
	~"cÚfig/the_i§.hh
"

35 
	~"ıu/šÜd”/ıu.hh
"

36 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

37 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

38 
	~"ıu/šÜd”/»g_d•_m­.hh
"

39 
	~"debug/RegD•M­.hh
"

41 
usšg
 
Çme¥aû
 
	g¡d
;

42 
usšg
 
Çme¥aû
 
	gTheISA
;

43 
usšg
 
Çme¥aû
 
	gTheP–še
;

45 
	gRegD•M­
::
	$RegD•M­
(
size
)

47 
»gM­
.
	`»size
(
NumRegCÏs£s
);

48 
»gM­
[
IÁRegCÏss
].
	`»size
(
NumIÁRegs
);

49 
»gM­
[
FlßtRegCÏss
].
	`»size
(
NumFlßtRegs
);

50 
»gM­
[
MiscRegCÏss
].
	`»size
(
NumMiscRegs
);

51 
	}
}

53 
	gRegD•M­
::~
	$RegD•M­
()

55 
	`ş—r
();

56 
	}
}

58 
¡ršg


59 
	gRegD•M­
::
	$Çme
()

61  
ıu
->
	`Çme
() + ".RegDepMap";

62 
	}
}

65 
	gRegD•M­
::
	$£tCPU
(
InOrd”CPU
 *
_ıu
)

67 
ıu
 = 
_ıu
;

69 
	}
}

72 
	gRegD•M­
::
	$ş—r
()

74 
i
 = 0; i < 
»gM­
.
	`size
(); i++) {

75 
j
 = 0; j < 
»gM­
[j].
	`size
(); j++)

76 
»gM­
[
i
][
j
].
	`ş—r
();

77 
»gM­
[
i
].
	`ş—r
();

79 
»gM­
.
	`ş—r
();

80 
	}
}

83 
	gRegD•M­
::
	$š£¹
(
DynIn¡PŒ
 
š¡
)

85 
de¡_»gs
 = 
š¡
->
	`numDe¡Regs
();

87 
	`DPRINTF
(
RegD•M­
, "Setting Output Dependencies for [sn:%i] "

89 
š¡
->
£qNum
,

90 
š¡
->
	`š¡Name
(),

91 
de¡_»gs
);

93 
i
 = 0; i < 
de¡_»gs
; i++) {

94 
RegCÏss
 
»g_ty³
;

95 
TheISA
::
RegIndex
 
¿w_idx
 = 
š¡
->
	`de¡RegIdx
(
i
);

96 
TheISA
::
RegIndex
 
æ©_idx
 = 
ıu
->
	`æ©‹nRegIdx
(
¿w_idx
,

97 
»g_ty³
,

98 
š¡
->
th»adNumb”
);

100 
	`DPRINTF
(
RegD•M­
, "[sn:%i] #%i flattened %io %i.\n",

101 
š¡
->
£qNum
, 
i
, 
¿w_idx
, 
æ©_idx
);

103 
š¡
->
	`æ©‹nDe¡Reg
(
i
, 
æ©_idx
);

105 ià(
æ©_idx
 =ğ
TheISA
::
Z”oReg
 && 
»g_ty³
 =ğ
IÁRegCÏss
) {

106 
	`DPRINTF
(
RegD•M­
, "[sn:%i]: Ignoring Insert-Dependencyracking for "

107 "ISA-Z”oReg (IÁ. Reg %i).\n", 
š¡
->
£qNum
,

108 
æ©_idx
);

112 
	`š£¹
(
»g_ty³
, 
æ©_idx
, 
š¡
);

114 
	}
}

118 
	gRegD•M­
::
	$š£¹
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
)

120 
	`DPRINTF
(
RegD•M­
, "Inserting [sn:%i] onto %s dep.†ist for "

121 "»g. idx %i.\n", 
š¡
->
£qNum
, 
RegCÏssSŒšgs
[
»g_ty³
],

122 
idx
);

124 
»gM­
[
»g_ty³
][
idx
].
	`push_back
(
š¡
);

126 
š¡
->
	`£tRegD•EÁry
();

127 
	}
}

130 
	gRegD•M­
::
	$»move
(
DynIn¡PŒ
 
š¡
)

132 ià(
š¡
->
	`isRegD•EÁry
()) {

133 
de¡_»gs
 = 
š¡
->
	`numDe¡Regs
();

135 
	`DPRINTF
(
RegD•M­
, "Removing [sn:%i]'sƒntries from„eg. dep. map. for "

137 
š¡
->
£qNum
,

138 
š¡
->
	`š¡Name
(),

139 
de¡_»gs
);

142 
i
 = 0; i < 
de¡_»gs
; i++) {

143 
RegIndex
 
æ©_idx
 = 
š¡
->
	`æ©‹ÃdDe¡RegIdx
(
i
);

144 
RegCÏss
 
»g_ty³
 = 
	`»gIdxToCÏss
(
š¡
->
	`de¡RegIdx
(
i
));

147 ià(
æ©_idx
 =ğ
TheISA
::
Z”oReg
 &&

148 
»g_ty³
 =ğ
IÁRegCÏss
) {

149 
	`DPRINTF
(
RegD•M­
, "[sn:%i]: Ignoring Remove-Dependencyracking for "

150 "ISA-Z”oReg (IÁ. Reg %i).\n", 
š¡
->
£qNum
,

151 
æ©_idx
);

156 
	`»move
(
»g_ty³
, 
æ©_idx
, 
š¡
);

159 
š¡
->
	`ş—rRegD•EÁry
();

161 
	}
}

164 
	gRegD•M­
::
	$»move
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
)

166 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 = 
»gM­
[
»g_ty³
][
idx
].
	`begš
();

167 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_’d
 = 
»gM­
[
»g_ty³
][
idx
].
	`’d
();

170 
li¡_™
 !ğ
li¡_’d
) {

171 if((*
li¡_™
è=ğ
š¡
) {

172 
	`DPRINTF
(
RegD•M­
, "Removing [sn:%i] from %s dep.†ist for "

173 "»g. idx %i.\n", 
š¡
->
£qNum
, 
RegCÏssSŒšgs
[
»g_ty³
],

174 
idx
);

175 
»gM­
[
»g_ty³
][
idx
].
	`”a£
(
li¡_™
);

178 
li¡_™
++;

180 
	`·nic
("[¢:%i] Did‚Ù fšdƒÁry fÜ %i,y³:%i\n", 
š¡
->
£qNum
, 
idx
, 
»g_ty³
);

181 
	}
}

184 
	gRegD•M­
::
	$»moveFrÚt
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
)

186 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 = 
»gM­
[
»g_ty³
][
idx
].
	`begš
();

188 
	`DPRINTF
(
RegD•M­
, "[tid:%u]: Removing dependencyƒntry on„eg. idx "

189 "%˜fÜ [¢:%i].\n", 
š¡
->
	`»adTid
(), 
idx
, in¡->
£qNum
);

191 
	`as£¹
(
li¡_™
 !ğ
»gM­
[
»g_ty³
][
idx
].
	`’d
());

193 
	`as£¹
(
š¡
 =ğ(*
li¡_™
));

195 
»gM­
[
»g_ty³
][
idx
].
	`”a£
(
li¡_™
);

196 
	}
}

198 
boŞ


199 
	gRegD•M­
::
	$ÿnR—d
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
)

201 ià(
»gM­
[
»g_ty³
][
idx
].
	`size
() == 0)

202  
Œue
;

204 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 = 
»gM­
[
»g_ty³
][
idx
].
	`begš
();

206 ià(
š¡
->
£qNum
 <ğ(*
li¡_™
)->seqNum) {

207  
Œue
;

209 
	`DPRINTF
(
RegD•M­
, "[sn:%i] Can't„ead from RegFile, [sn:%i] has "

211 
š¡
->
£qNum
, (*
li¡_™
)->seqNum);

212  
çl£
;

214 
	}
}

216 
	gTheP–še
::
DynIn¡PŒ


217 
RegD•M­
::
	$ÿnFÜw¬d
(
ušt8_t
 
»g_ty³
, 
»g_idx
, 
DynIn¡PŒ
 
š¡
)

219 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 = 
»gM­
[
»g_ty³
][
»g_idx
].
	`begš
();

220 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_’d
 = 
»gM­
[
»g_ty³
][
»g_idx
].
	`’d
();

222 
DynIn¡PŒ
 
fÜw¬d_š¡
 = 
NULL
;

226 
li¡_™
 !ğ
li¡_’d
 &&

227 (*
li¡_™
)->
£qNum
 < 
š¡
->seqNum) {

228 
fÜw¬d_š¡
 = (*
li¡_™
);

229 
li¡_™
++;

232 ià(
fÜw¬d_š¡
) {

233 
de¡_»g_idx
 = 
fÜw¬d_š¡
->
	`g‘De¡IdxNum
(
»g_idx
);

234 
	`as£¹
(
de¡_»g_idx
 != -1);

236 
	`DPRINTF
(
RegD•M­
, "[sn:%i] Found…otential forwarding value for„eg %i "

238 
š¡
->
£qNum
, 
»g_idx
, 
fÜw¬d_š¡
->£qNum, 
de¡_»g_idx
);

240 ià(
fÜw¬d_š¡
->
	`isExecu‹d
() &&

241 
fÜw¬d_š¡
->
	`»adResuÉTime
(
de¡_»g_idx
è< 
	`curTick
()) {

242  
fÜw¬d_š¡
;

244 ià(!
fÜw¬d_š¡
->
	`isExecu‹d
()) {

245 
	`DPRINTF
(
RegD•M­
, "[sn:%i] Can't get valuehrough "

247 
š¡
->
£qNum
, 
fÜw¬d_š¡
->£qNum, fÜw¬d_š¡->
	`š¡Name
());

248 } ià(
fÜw¬d_š¡
->
	`»adResuÉTime
(
de¡_»g_idx
è>ğ
	`curTick
()) {

249 
	`DPRINTF
(
RegD•M­
, "[sn:%i] Can't get valuehrough "

251 
š¡
->
£qNum
, 
fÜw¬d_š¡
->seqNum,

252 
fÜw¬d_š¡
->
	`»adResuÉTime
(
de¡_»g_idx
));

255  
NULL
;

258 
	`DPRINTF
(
RegD•M­
, "[sn:%i] No instruction foundo forward from.\n",

259 
š¡
->
£qNum
);

260  
NULL
;

262 
	}
}

264 
boŞ


265 
	gRegD•M­
::
	$ÿnWr™e
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
)

267 ià(
»gM­
[
»g_ty³
][
idx
].
	`size
() == 0)

268  
Œue
;

270 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 = 
»gM­
[
»g_ty³
][
idx
].
	`begš
();

272 ià(
š¡
->
£qNum
 <ğ(*
li¡_™
)->seqNum) {

273  
Œue
;

275 
	`DPRINTF
(
RegD•M­
, "[sn:%i] Can't write from RegFile: [sn:%i] "

276 "ha nÙ wr™‹À™' v®uback y‘.\n", 
š¡
->
£qNum
,

277 (*
li¡_™
)->
£qNum
);

280  
çl£
;

281 
	}
}

284 
	gRegD•M­
::
	$dump
()

286 
»g_ty³
 = 0;„eg_ty³ < 
NumRegCÏs£s
;„eg_type++) {

287 
idx
=0; idx < 
»gM­
.
	`size
(); idx++) {

288 ià(
»gM­
[
idx
].
	`size
() > 0) {

289 
	`ırštf
("Reg #%˜(size:%i): ", 
idx
, 
»gM­
[
»g_ty³
][idx].
	`size
());

291 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 =

292 
»gM­
[
»g_ty³
][
idx
].
	`begš
();

293 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_’d
 =

294 
»gM­
[
»g_ty³
][
idx
].
	`’d
();

296 
li¡_™
 !ğ
li¡_’d
) {

297 
	`ırštf
("[¢:%i] ", (*
li¡_™
)->
£qNum
);

298 
li¡_™
++;

300 
	`ırštf
("\n");

304 
	}
}

	@inorder/reg_dep_map.hh

33 #iâdeà
CPU_INORDER_REG_DEP_MAP_HH


34 
	#CPU_INORDER_REG_DEP_MAP_HH


	)

36 
	~<li¡
>

37 
	~<veùÜ
>

38 
	~<¡ršg
>

40 
	~"¬ch/i§_Œa™s.hh
"

41 
	~"cÚfig/the_i§.hh
"

42 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

44 şas 
	cRegD•M­


46 
	mpublic
:

47 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

48 
	mTheISA
::
	tRegIndex
 RegIndex;

50 
RegD•M­
(
size
 = 
TheISA
::
TÙ®NumRegs
);

51 ~
RegD•M­
();

53 
	m¡d
::
¡ršg
 
Çme
();

55 
£tCPU
(
InOrd”CPU
 *
_ıu
);

58 
ş—r
();

61 
š£¹
(
DynIn¡PŒ
 
š¡
);

64 
»move
(
DynIn¡PŒ
 
š¡
);

67 
»moveFrÚt
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
);

72 
boŞ
 
ÿnR—d
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
);

77 
DynIn¡PŒ
 
ÿnFÜw¬d
(
ušt8_t
 
»g_ty³
, 
»g_idx
,

78 
DynIn¡PŒ
 
š¡
);

81 
DynIn¡PŒ
 
fšdBy·ssIn¡
(
RegIndex
 
idx
);

86 
boŞ
 
ÿnWr™e
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
);

89 
d•Size
(
RegIndex
 
idx
);

91 
dump
();

93 
	m´iv©e
:

97 
š£¹
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
);

100 
»move
(
ušt8_t
 
»g_ty³
, 
RegIndex
 
idx
, 
DynIn¡PŒ
 
š¡
);

102 
	m¡d
::
	tveùÜ
<
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
> > 
	tD•M­
;

103 
	m¡d
::
veùÜ
<
D•M­
> 
»gM­
;

105 
InOrd”CPU
 *
	mıu
;

	@inorder/resource.cc

32 
	~<li¡
>

33 
	~<veùÜ
>

35 
	~"ba£/¡r.hh
"

36 
	~"ıu/šÜd”/ıu.hh
"

37 
	~"ıu/šÜd”/»sourû.hh
"

38 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

39 
	~"debug/ExecFauÉšg.hh
"

40 
	~"debug/RefCouÁ.hh
"

41 
	~"debug/ResReqCouÁ.hh
"

42 
	~"debug/Resourû.hh
"

44 
usšg
 
Çme¥aû
 
	g¡d
;

46 
	gResourû
::
	$Resourû
(
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

47 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
)

48 : 
	`»sName
(
»s_Çme
), 
	`id
(
»s_id
),

49 
	`width
(
»s_width
), 
	`Ï‹ncy
(
»s_Ï‹ncy
), 
	`ıu
(
_ıu
),

50 
	$»sourûEv’t
(
NULL
)

52 
»qs
.
	`»size
(
width
);

55 
d’›dReq
 = 
Ãw
 
	`ResourûReque¡
(
this
);

56 
d’›dReq
->
v®id
 = 
Œue
;

57 
	}
}

59 
	gResourû
::~
	$Resourû
()

61 ià(
»sourûEv’t
) {

62 
d–‘e
 [] 
»sourûEv’t
;

65 
d–‘e
 
d’›dReq
;

67 
i
 = 0; i < 
width
; i++) {

68 
d–‘e
 
»qs
[
i
];

70 
	}
}

74 
	gResourû
::
	$š™
()

79 ià(
Ï‹ncy
 > 
	`Cyşes
(0))

80 
»sourûEv’t
 = 
Ãw
 
ResourûEv’t
[
width
];

83 
i
 = 0; i < 
width
; i++)

84 
»qs
[
i
] = 
Ãw
 
	`ResourûReque¡
(
this
);

87 
	`š™SlÙs
();

88 
	}
}

91 
	gResourû
::
	$š™SlÙs
()

94 
¦Ù_idx
 = 0; slÙ_idx < 
width
; slot_idx++) {

95 
avaSlÙs
.
	`push_back
(
¦Ù_idx
);

97 ià(
»sourûEv’t
) {

98 
»sourûEv’t
[
¦Ù_idx
].
	`š™
(
this
, slot_idx);

101 
	}
}

103 
	g¡d
::
¡ršg


104 
Resourû
::
	$Çme
()

106  
ıu
->
	`Çme
(è+ "." + 
»sName
;

107 
	}
}

110 
	gResourû
::
	$¦ÙsAva
()

112  
avaSlÙs
.
	`size
();

113 
	}
}

116 
	gResourû
::
	$¦ÙsInU£
()

118  
width
 - 
avaSlÙs
.
	`size
();

119 
	}
}

122 
	gResourû
::
	$ä“SlÙ
(
¦Ù_idx
)

124 
	`DPRINTF
(
Resourû
, "Deallocating [slot:%i].\n",

125 
¦Ù_idx
);

128 
avaSlÙs
.
	`push_back
(
¦Ù_idx
);

131 
»qs
[
¦Ù_idx
]->
	`ş—rReque¡
();

132 
	}
}

135 
	gResourû
::
	$fšdSlÙ
(
DynIn¡PŒ
 
š¡
)

137 
¦Ù_num
 = -1;

139 
i
 = 0; i < 
width
; i++) {

140 ià(
»qs
[
i
]->
v®id
 &&

141 
»qs
[
i
]->
	`g‘In¡
()->
£qNum
 =ğ
š¡
->seqNum) {

142 
¦Ù_num
 = 
»qs
[
i
]->
	`g‘SlÙ
();

145  
¦Ù_num
;

146 
	}
}

149 
	gResourû
::
	$g‘SlÙ
(
DynIn¡PŒ
 
š¡
)

151 
¦Ù_num
 = -1;

153 ià(
	`¦ÙsAva
() != 0) {

154 
¦Ù_num
 = 
avaSlÙs
[0];

156 
veùÜ
<>::
™”©Ü
 
veù_™
 = 
avaSlÙs
.
	`begš
();

158 
	`as£¹
(
¦Ù_num
 =ğ*
veù_™
);

160 
avaSlÙs
.
	`”a£
(
veù_™
);

163  
¦Ù_num
;

164 
	}
}

166 
ResReqPŒ


167 
	gResourû
::
	$»que¡
(
DynIn¡PŒ
 
š¡
)

171 
boŞ
 
Œy_»que¡
 = 
çl£
;

172 
¦Ù_num
 = -1;

173 
¡age_num
;

174 
ResReqPŒ
 
š¡_»q
 = 
	`fšdReque¡
(
š¡
);

176 ià(
š¡_»q
) {

181 
	`»que¡Agaš
(
š¡
, 
Œy_»que¡
);

183 
¦Ù_num
 = 
š¡_»q
->
	`g‘SlÙ
();

184 
¡age_num
 = 
š¡_»q
->
	`g‘SgeNum
();

187 
¦Ù_num
 = 
	`g‘SlÙ
(
š¡
);

189 ià(
¦Ù_num
 != -1) {

190 
	`DPRINTF
(
Resourû
, "Allocating [slot:%i] for [tid:%i]: [sn:%i]\n",

191 
¦Ù_num
, 
š¡
->
	`»adTid
(), in¡->
£qNum
);

194 
¡age_num
 = 
š¡
->
curSkedEÁry
->
¡ageNum
;

195 
cmd
 = 
š¡
->
curSkedEÁry
->cmd;

198 
š¡_»q
 = 
	`g‘Reque¡
(
š¡
, 
¡age_num
, 
id
, 
¦Ù_num
, 
cmd
);

200 ià(
š¡
->
¡©icIn¡
) {

201 
	`DPRINTF
(
Resourû
, "[tid:%i]: [sn:%i]„equestinghis "

203 
š¡
->
	`»adTid
(), in¡->
£qNum
);

205 
	`DPRINTF
(
Resourû
, "[tid:%i]: instruction„equestinghis "

207 
š¡
->
	`»adTid
());

210 
Œy_»que¡
 = 
Œue
;

212 
	`DPRINTF
(
Resourû
, "No slot‡vailable for [tid:%i]: [sn:%i]\n",

213 
š¡
->
	`»adTid
(), in¡->
£qNum
);

218 ià(
Œy_»que¡
) {

220 
	`scheduËExecutiÚ
(
¦Ù_num
);

222 
š¡_»q
 = 
d’›dReq
;

223 
	`»jeùReque¡
(
š¡
);

226  
š¡_»q
;

227 
	}
}

230 
	gResourû
::
	$»que¡Agaš
(
DynIn¡PŒ
 
š¡
, 
boŞ
 &
do_»que¡
)

232 
do_»que¡
 = 
Œue
;

234 ià(
š¡
->
¡©icIn¡
) {

235 
	`DPRINTF
(
Resourû
, "[tid:%i]: [sn:%i]„equestinghis„esource "

237 
š¡
->
	`»adTid
(), in¡->
£qNum
);

239 
	`DPRINTF
(
Resourû
, "[tid:%i]:„equestinghis„esource‡gain.\n",

240 
š¡
->
	`»adTid
());

242 
	}
}

244 
ResReqPŒ


245 
	gResourû
::
	$g‘Reque¡
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
»s_idx
,

246 
¦Ù_num
, 
cmd
)

248 
»qs
[
¦Ù_num
]->
	`£tReque¡
(
š¡
, 
¡age_num
, 
id
, slÙ_num, 
cmd
);

249  
»qs
[
¦Ù_num
];

250 
	}
}

252 
ResReqPŒ


253 
	gResourû
::
	$fšdReque¡
(
DynIn¡PŒ
 
š¡
)

255 
i
 = 0; i < 
width
; i++) {

256 ià(
»qs
[
i
]->
v®id
 &&

257 
»qs
[
i
]->
	`g‘In¡
(è=ğ
š¡
) {

258  
»qs
[
i
];

262  
NULL
;

263 
	}
}

266 
	gResourû
::
	$»jeùReque¡
(
DynIn¡PŒ
 
š¡
)

268 
	`DPRINTF
(
RefCouÁ
, "[tid:%i]: Unableo grant„equest for [sn:%i].\n",

269 
š¡
->
	`»adTid
(), in¡->
£qNum
);

270 
	}
}

273 
	gResourû
::
	$execu‹
(
¦Ù_idx
)

276 
	`DPRINTF
(
Resourû
, "[tid:%i]: Executing %s„esource.\n",

277 
»qs
[
¦Ù_idx
]->
	`g‘Tid
(), 
	`Çme
());

278 
»qs
[
¦Ù_idx
]->
	`£tCom¶‘ed
(
Œue
);

279 
»qs
[
¦Ù_idx
]->
	`dÚe
();

280 
	}
}

283 
	gResourû
::
	$d—ùiv©eTh»ad
(
Th»adID
 
tid
)

287 
DynIn¡PŒ
 
dummy_š¡
 = 
Ãw
 
	`InOrd”DynIn¡
(
ıu
, 
NULL
, 0, 
tid
,id);

288 
	`squash
(
dummy_š¡
, 0, 0, 
tid
);

289 
	}
}

292 
	gResourû
::
	$£tupSquash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
Th»adID
 
tid
)

295 
ıu
->
p–šeSge
[
¡age_num
]->
	`£tupSquash
(
š¡
, 
tid
);

298 
ıu
->
»sPoŞ
->
	`scheduËEv’t
(

299 (
InOrd”CPU
::
CPUEv’tTy³
)
ResourûPoŞ
::
SquashAÎ
, 
š¡
,

300 
	`Cyşes
(0));

301 
	}
}

304 
	gResourû
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
In¡SeqNum
 
squash_£q_num
,

305 
Th»adID
 
tid
)

309 
i
 = 0; i < 
width
; i++) {

310 
ResReqPŒ
 
»q_±r
 = 
»qs
[
i
];

311 
DynIn¡PŒ
 
š¡
 = 
»q_±r
->
	`g‘In¡
();

313 ià(
»q_±r
->
v®id
 &&

314 
š¡
->
	`»adTid
(è=ğ
tid
 &&

315 
š¡
->
£qNum
 > 
squash_£q_num
) {

317 
	`DPRINTF
(
Resourû
, "[tid:%i]: Squashing [sn:%i].\n",

318 
»q_±r
->
	`g‘In¡
()->
	`»adTid
(),

319 
»q_±r
->
	`g‘In¡
()->
£qNum
);

321 
»q_±r
->
	`£tSquashed
();

323 
»q_¦Ù_num
 = 
»q_±r
->
	`g‘SlÙ
();

325 ià(
Ï‹ncy
 > 
	`Cyşes
(0)) {

326 ià(
»sourûEv’t
[
»q_¦Ù_num
].
	`scheduËd
())

327 
	`unscheduËEv’t
(
»q_¦Ù_num
);

330 
	`ä“SlÙ
(
»q_¦Ù_num
);

333 
	}
}

336 
	gResourû
::
	$squashDueToMemSÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

337 
In¡SeqNum
 
squash_£q_num
,

338 
Th»adID
 
tid
)

340 
	`squash
(
š¡
, 
¡age_num
, 
squash_£q_num
, 
tid
);

341 
	}
}

344 
	gResourû
::
	$squashTh’T¿p
(
¡age_num
, 
DynIn¡PŒ
 
š¡
)

346 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

348 
š¡
->
	`£tSquashInfo
(
¡age_num
);

349 
	`£tupSquash
(
š¡
, 
¡age_num
, 
tid
);

351 ià(
š¡
->
ŒaûD©a
) {

352 ià(
š¡
->
¡©icIn¡
 &&

353 
š¡
->
çuÉ
 !ğ
NoFauÉ
 && 
	`DTRACE
(
ExecFauÉšg
)) {

354 
š¡
->
ŒaûD©a
->
	`£tSgeCyşe
(
¡age_num
, 
	`curTick
());

355 
š¡
->
ŒaûD©a
->
	`£tF‘chSeq
(š¡->
£qNum
);

356 
š¡
->
ŒaûD©a
->
	`dump
();

359 
d–‘e
 
š¡
->
ŒaûD©a
;

360 
š¡
->
ŒaûD©a
 = 
NULL
;

363 
ıu
->
	`Œ­CÚ‹xt
(
š¡
->
çuÉ
, 
tid
, inst);

364 
	}
}

367 
	gResourû
::
	$scheduËExecutiÚ
(
¦Ù_num
)

369 ià(
Ï‹ncy
 > 
	`Cyşes
(0)) {

370 
	`scheduËEv’t
(
¦Ù_num
, 
Ï‹ncy
);

372 
	`execu‹
(
¦Ù_num
);

374 
	}
}

377 
	gResourû
::
	$scheduËEv’t
(
¦Ù_idx
, 
Cyşes
 
d–ay
)

379 
	`DPRINTF
(
Resourû
, "[tid:%i]: Schedulingƒvent for [sn:%i] onick %i.\n",

380 
»qs
[
¦Ù_idx
]->
š¡
->
	`»adTid
(),

381 
»qs
[
¦Ù_idx
]->
š¡
->
£qNum
,

382 
ıu
->
	`şockEdge
(
d–ay
));

383 
»sourûEv’t
[
¦Ù_idx
].
	`scheduËEv’t
(
d–ay
);

384 
	}
}

386 
boŞ


387 
	gResourû
::
	$scheduËEv’t
(
DynIn¡PŒ
 
š¡
, 
Cyşes
 
d–ay
)

389 
¦Ù_idx
 = 
	`fšdSlÙ
(
š¡
);

391 if(
¦Ù_idx
 != -1)

392 
»sourûEv’t
[
¦Ù_idx
].
	`scheduËEv’t
(
d–ay
);

394  
¦Ù_idx
;

395 
	}
}

398 
	gResourû
::
	$unscheduËEv’t
(
¦Ù_idx
)

400 
»sourûEv’t
[
¦Ù_idx
].
	`unscheduËEv’t
();

401 
	}
}

403 
boŞ


404 
	gResourû
::
	$unscheduËEv’t
(
DynIn¡PŒ
 
š¡
)

406 
¦Ù_idx
 = 
	`fšdSlÙ
(
š¡
);

408 if(
¦Ù_idx
 != -1)

409 
»sourûEv’t
[
¦Ù_idx
].
	`unscheduËEv’t
();

411  
¦Ù_idx
;

412 
	}
}

414 
	gResourûReque¡
::
»sReqID
 = 0;

416 
	gResourûReque¡
::
maxReqCouÁ
 = 0;

418 
	gResourûReque¡
::
	$ResourûReque¡
(
Resourû
 *
_»s
)

419 : 
	`»s
(
_»s
), 
	`š¡
(
NULL
), 
	`¡agePas£s
(0), 
	`v®id
(
çl£
), 
	`dÚeInResourû
(false),

420 
	`com¶‘ed
(
çl£
), 
	`squashed
(çl£), 
	`´oûssšg
(false),

421 
	$memSÎ
(
çl£
)

423 
	}
}

425 
	gResourûReque¡
::~
	$ResourûReque¡
()

427 #ifdeà
DEBUG


428 
»s
->
ıu
->
»sReqCouÁ
--;

429 
	`DPRINTF
(
ResReqCouÁ
, "Res. Req %˜d–‘ed.„esReqCouÁ=%i.\n", 
»qID
,

430 
»s
->
ıu
->
»sReqCouÁ
);

432 
š¡
 = 
NULL
;

433 
	}
}

435 
	g¡d
::
¡ršg


436 
ResourûReque¡
::
	$Çme
()

438  
	`c¥rštf
("%s[¦Ù:%i]:", 
»s
->
	`Çme
(), 
¦ÙNum
);

439 
	}
}

442 
	gResourûReque¡
::
	$£tReque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
,

443 
»s_idx
, 
¦Ù_num
, 
_cmd
)

445 
v®id
 = 
Œue
;

446 
š¡
 = 
_š¡
;

447 
¡ageNum
 = 
¡age_num
;

448 
»sIdx
 = 
»s_idx
;

449 
¦ÙNum
 = 
¦Ù_num
;

450 
cmd
 = 
_cmd
;

451 
	}
}

454 
	gResourûReque¡
::
	$ş—rReque¡
()

456 
v®id
 = 
çl£
;

457 
š¡
 = 
NULL
;

458 
¡agePas£s
 = 0;

459 
com¶‘ed
 = 
çl£
;

460 
dÚeInResourû
 = 
çl£
;

461 
squashed
 = 
çl£
;

462 
memSÎ
 = 
çl£
;

463 
	}
}

466 
	gResourûReque¡
::
	$ä“SlÙ
()

468 
	`as£¹
(
»s
);

471 
»s
->
	`ä“SlÙ
(
¦ÙNum
);

472 
	}
}

475 
	gResourûReque¡
::
	$dÚe
(
boŞ
 
com¶‘ed
)

477 
	`DPRINTF
(
Resourû
, "done with„equest from "

479 
š¡
->
£qNum
, in¡->
	`»adTid
());

481 
	`£tCom¶‘ed
(
com¶‘ed
);

483 
dÚeInResourû
 = 
Œue
;

484 
	}
}

486 
	gResourûEv’t
::
	$ResourûEv’t
()

487 : 
	`Ev’t
((
Ev’t
::
PriÜ™y
)
Resourû_Ev’t_Pri
)

488 { 
	}
}

490 
ResourûEv’t
::
	$ResourûEv’t
(
Resourû
 *
»s
, 
¦Ù_idx
)

491 : 
	`Ev’t
((
Ev’t
::
PriÜ™y
)
Resourû_Ev’t_Pri
), 
	`»sourû
(
»s
),

492 
	$¦ÙIdx
(
¦Ù_idx
)

493 { 
	}
}

496 
	gResourûEv’t
::
	$š™
(
Resourû
 *
»s
, 
¦Ù_idx
)

498 
»sourû
 = 
»s
;

499 
¦ÙIdx
 = 
¦Ù_idx
;

500 
	}
}

503 
	gResourûEv’t
::
	$´oûss
()

505 
»sourû
->
	`execu‹
(
¦ÙIdx
);

506 
	}
}

509 
	gResourûEv’t
::
	$desütiÚ
() const

511 
¡ršg
 
desc
 = 
»sourû
->
	`Çme
(è+ "-ev’t:¦Ù[" + 
	`to_¡ršg
(
¦ÙIdx
)

514  
desc
.
	`c_¡r
();

515 
	}
}

518 
	gResourûEv’t
::
	$scheduËEv’t
(
Cyşes
 
d–ay
)

520 
	`as£¹
(!
	`scheduËd
(è|| 
	`squashed
());

521 
»sourû
->
ıu
->
	`»scheduË
(
this
,

522 
»sourû
->
ıu
->
	`şockEdge
(
d–ay
), 
Œue
);

523 
	}
}

	@inorder/resource.hh

32 #iâdeà
__CPU_INORDER_RESOURCE_HH__


33 
	#__CPU_INORDER_RESOURCE_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ba£/ty³s.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/š¡_£q.hh
"

43 
	~"sim/ev’tq.hh
"

44 
	~"sim/sim_objeù.hh
"

46 
şass
 
	gEv’t
;

47 
şass
 
	gInOrd”CPU
;

48 
şass
 
	gResourûEv’t
;

49 
şass
 
	gResourûReque¡
;

51 
ResourûReque¡
 
	tResReq
;

52 
ResourûReque¡
* 
	tResReqPŒ
;

54 
şass
 
	gCacheReque¡
;

55 
CacheReque¡
* 
	tCacheReqPŒ
;

57 şas 
	cResourû
 {

58 
	mpublic
:

59 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

61 
ä›nd
 
şass
 
	mResourûEv’t
;

62 
ä›nd
 
şass
 
	mResourûReque¡
;

64 
	mpublic
:

65 
Resourû
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

66 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
);

67 
	mvœtu®
 ~
Resourû
();

71 
vœtu®
 
	m¡d
::
¡ršg
 
Çme
();

74 
	$g‘Id
(è{  
id
; }

79 
vœtu®
 
	`š™
();

80 
vœtu®
 
	`š™SlÙs
();

83 
vœtu®
 
	$»gSts
(è{ 
	}
}

86 
vœtu®
 
	$aùiv©eTh»ad
(
Th»adID
 
tid
è{ 
	}
}

91 
vœtu®
 
d—ùiv©eTh»ad
(
Th»adID
 
tid
);

94 
vœtu®
 
	$su¥’dTh»ad
(
Th»adID
 
tid
è{ 
	}
}

99 
vœtu®
 
	$upd©eAá”CÚ‹xtSw™ch
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
è{ 
	}
}

104 
vœtu®
 
	$š¡G¿du©ed
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
è{ 
	}
}

107 
vœtu®
 
	$Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
è{ 
	}
}

112 
vœtu®
 
ResourûReque¡
* 
»que¡
(
DynIn¡PŒ
 
š¡
);

118 
vœtu®
 
g‘SlÙ
(
DynIn¡PŒ
 
š¡
);

121 
vœtu®
 
fšdSlÙ
(
DynIn¡PŒ
 
š¡
);

124 
vœtu®
 
ä“SlÙ
(
¦Ù_idx
);

130 
vœtu®
 
ResourûReque¡
* 
g‘Reque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
,

131 
»s_idx
, 
¦Ù_num
,

132 
cmd
);

135 
scheduËExecutiÚ
(
¦Ù_idx
);

141 
vœtu®
 
execu‹
(
¦Ù_idx
);

147 
vœtu®
 
FauÉ
 
	$doF‘chAcûss
(
DynIn¡PŒ
 
š¡
)

148 { 
	`·nic
("doF‘chAcûs undefšed fÜ %s", 
	`Çme
());  
NoFauÉ
; 
	}
}

154 
vœtu®
 
	$doCacheAcûss
(
DynIn¡PŒ
 
š¡
, 
ušt64_t
 *
wr™e_»suÉ
 = 
NULL
,

155 
CacheReqPŒ
 
¥l™_»q
 = 
NULL
)

156 { 
	`·nic
("doCacheAcûs undefšed fÜ %s", 
	`Çme
()); 
	}
}

159 
£tupSquash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
Th»adID
 
tid
);

162 
vœtu®
 
squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

163 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

166 
vœtu®
 
squashDueToMemSÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

167 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

170 
squashTh’T¿p
(
¡age_num
, 
DynIn¡PŒ
 
š¡
);

175 
¦ÙsAva
();

178 
¦ÙsInU£
();

181 
scheduËEv’t
(
¦Ù_idx
, 
Cyşes
 
d–ay
);

185 
boŞ
 
scheduËEv’t
(
DynIn¡PŒ
 
š¡
, 
Cyşes
 
d–ay
);

188 
unscheduËEv’t
(
¦Ù_idx
);

191 
boŞ
 
unscheduËEv’t
(
DynIn¡PŒ
 
š¡
);

194 
vœtu®
 
ResReqPŒ
 
fšdReque¡
(
DynIn¡PŒ
 
š¡
);

197 
»jeùReque¡
(
DynIn¡PŒ
 
š¡
);

202 
vœtu®
 
»que¡Agaš
(
DynIn¡PŒ
 
š¡
, 
boŞ
 &
Œy_»que¡
);

206 
vœtu®
 
Cyşes
 
	$g‘L©’cy
(
¦Ù_num
è{  
Ï‹ncy
; 
	}
}

208 
	g´Ùeùed
:

210 
¡d
::
¡ršg
 
»sName
;

215 
	gid
;

220 
	gwidth
;

226 cÚ¡ 
Cyşes
 
	gÏ‹ncy
;

228 
	gpublic
:

232 
¡d
::
veùÜ
<
ResReqPŒ
> 
»qs
;

237 
	g¡d
::
veùÜ
<> 
avaSlÙs
;

240 
InOrd”CPU
 *
	gıu
;

242 
	g´Ùeùed
:

246 
ResourûEv’t
 *
»sourûEv’t
;

249 
ResReqPŒ
 
	gd’›dReq
;

252 şas 
	cResourûEv’t
 : 
public
 
Ev’t


254 
public
:

256 
Resourû
 *
»sourû
;

262 
	eInOrd”PriÜ™y
 {

263 
	mResourû_Ev’t_Pri
 = 45

267 
	g¦ÙIdx
;

270 
ResourûEv’t
();

271 
ResourûEv’t
(
Resourû
 *
»s
, 
¦Ù_idx
);

272 
	gvœtu®
 ~
	$ResourûEv’t
(è{ 
	}
}

275 
vœtu®
 
š™
(
Resourû
 *
»s
, 
¦Ù_idx
);

278 
vœtu®
 
´oûss
();

281 cÚ¡ *
	$desütiÚ
() const;

284 
	$£tSlÙ
(
¦Ù
è{ 
¦ÙIdx
 = slÙ; 
	}
}

287 
scheduËEv’t
(
Cyşes
 
d–ay
);

290 
	$unscheduËEv’t
()

292 ià(
	`scheduËd
())

293 
	`squash
();

294 
	}
}

298 şas 
	cResourûReque¡


300 
	mpublic
:

301 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

303 
	m»sReqID
;

305 
	mmaxReqCouÁ
;

307 
ä›nd
 
şass
 
	mResourû
;

309 
	mpublic
:

310 
ResourûReque¡
(
Resourû
 *
_»s
);

312 
	mvœtu®
 ~
ResourûReque¡
();

314 
	m¡d
::
¡ršg
 
Çme
();

316 
	m»qID
;

318 
£tReque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
,

319 
»s_idx
, 
¦Ù_num
, 
_cmd
);

321 
vœtu®
 
ş—rReque¡
();

326 
dÚe
(
boŞ
 
com¶‘ed
 = 
Œue
);

328 
ä“SlÙ
();

336 
	$g‘ResIdx
(è{  
»sIdx
; }

339 
	$g‘SlÙ
(è{  
¦ÙNum
; 
	}
}

340 
boŞ
 
	$hasSlÙ
(è{  
¦ÙNum
 >ğ0; 
	}
}

343 
	$g‘SgeNum
(è{  
¡ageNum
; 
	}
}

346 
	$£tTid
(
Th»adID
 
_tid
è{ 
tid
 = _tid; 
	}
}

347 
Th»adID
 
	$g‘Tid
(è{  
tid
; 
	}
}

350 
DynIn¡PŒ
 
	$g‘In¡
(è{  
š¡
; 
	}
}

355 
vœtu®
 
Pack‘D©aPŒ
 
	$g‘D©a
(è{  
NULL
; 
	}
}

358 
Resourû
 *
	g»s
;

361 
DynIn¡PŒ
 
	gš¡
;

364 
In¡SeqNum
 
	g£qNum
;

367 
	gcmd
;

369 
	g¡agePas£s
;

371 
boŞ
 
	gv®id
;

373 
boŞ
 
	gdÚeInResourû
;

381 
boŞ
 
	$isCom¶‘ed
(è{  
com¶‘ed
; 
	}
}

382 
	$£tCom¶‘ed
(
boŞ
 
cÚd
 = 
Œue
è{ 
com¶‘ed
 = cÚd; 
	}
}

385 
boŞ
 
	$isSquashed
(è{  
squashed
; 
	}
}

386 
	$£tSquashed
(è{ 
squashed
 = 
Œue
; 
	}
}

389 
boŞ
 
	$isProûssšg
(è{  
´oûssšg
; 
	}
}

390 
	$£tProûssšg
(
boŞ
 
cÚd
 = 
Œue
è{ 
´oûssšg
 = cÚd; 
	}
}

393 
boŞ
 
	$isMemSÎ
(è{  
memSÎ
; 
	}
}

394 
	$£tMemSÎ
(
boŞ
 
¡®l
 = 
Œue
è{ 
memSÎ
 = sÎ; 
	}
}

396 
	g´Ùeùed
:

398 
Th»adID
 
tid
;

399 
	g¡ageNum
;

400 
	g»sIdx
;

401 
	g¦ÙNum
;

404 
boŞ
 
	gcom¶‘ed
;

405 
boŞ
 
	gsquashed
;

406 
boŞ
 
	g´oûssšg
;

408 
boŞ
 
	gmemSÎ
;

	@inorder/resource_pool.9stage.cc

44 
	~<li¡
>

45 
	~<veùÜ
>

47 
	~"ıu/šÜd”/»sourûs/»sourû_li¡.hh
"

48 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

50 
usšg
 
Çme¥aû
 
	g¡d
;

51 
usšg
 
Çme¥aû
 
	gTheP–še
;

53 
	gResourûPoŞ
::
	$ResourûPoŞ
(
InOrd”CPU
 *
_ıu
, 
InOrd”CPUP¬ams
 *
·¿ms
)

54 : 
	`ıu
(
_ıu
), 
	`š¡Un™
(
NULL
), 
	$d©aUn™
(
NULL
)

63 
»sourûs
.
	`push_back
(
Ãw
 
	`F‘chSeqUn™
("ãtch_£q_un™", 
F‘chSeq
,

64 
SgeWidth
 * 2, 0, 
_ıu
, 
·¿ms
));

66 
»sourûs
.
	`push_back
(
Ãw
 
	`TLBUn™
("™lb", 
ITLB
, 
SgeWidth
, 0, 
_ıu
, 
·¿ms
));

71 
š¡Un™
 = 
Ãw
 
	`F‘chUn™
("iÿche_pÜt", 
ICache
,

72 
SgeWidth
 * 
MaxTh»ads
, 0, 
_ıu
,

73 
·¿ms
);

74 
»sourûs
.
	`push_back
(
š¡Un™
);

76 
»sourûs
.
	`push_back
(
Ãw
 
	`DecodeUn™
("decode_un™", 
Decode
, 
SgeWidth
, 0,

77 
_ıu
, 
·¿ms
));

79 
»sourûs
.
	`push_back
(
Ãw
 
	`B¿nchP»diùÜ
("b¿nch_´ediùÜ", 
BP»d
,

80 
SgeWidth
, 0, 
_ıu
, 
·¿ms
));

82 
i
 = 0; i < 
·¿ms
->
numb”OfTh»ads
; i++) {

83 
fbuff_Çme
[20];

84 
	`¥rštf
(
fbuff_Çme
, "ãtch_bufãr_t%i", 
i
);

85 
»sourûs
.
	`push_back
(
Ãw
 
	`In¡Bufãr
(
fbuff_Çme
, 
F‘chBuff
 + 
i
, 4, 0,

86 
_ıu
, 
·¿ms
));

89 
»sourûs
.
	`push_back
(
Ãw
 
	`U£DefUn™
("»gfe_mªag”", 
RegMªag”
,

90 
SgeWidth
 * 
MaxTh»ads
, 0, 
_ıu
, 
·¿ms
));

92 
»sourûs
.
	`push_back
(
Ãw
 
	`AGENUn™
("ag’_un™", 
AGEN
, 
SgeWidth
, 0, 
_ıu
,

93 
·¿ms
));

95 
»sourûs
.
	`push_back
(
Ãw
 
	`ExecutiÚUn™
("executiÚ_un™", 
ExecUn™
,

96 
SgeWidth
, 0, 
_ıu
, 
·¿ms
));

98 
»sourûs
.
	`push_back
(
Ãw
 
	`MuÉDivUn™
("muÉ_div_un™", 
MDU
, 5, 0, 
_ıu
,

99 
·¿ms
));

101 
»sourûs
.
	`push_back
(
Ãw
 
	`TLBUn™
("db", 
DTLB
, 
SgeWidth
, 0, 
_ıu
, 
·¿ms
));

105 
d©aUn™
 = 
Ãw
 
	`CacheUn™
("dÿche_pÜt", 
DCache
,

106 
SgeWidth
 * 
MaxTh»ads
, 0, 
_ıu
,

107 
·¿ms
);

108 
»sourûs
.
	`push_back
(
d©aUn™
);

110 
»sourûs
.
	`push_back
(
Ãw
 
	`G¿du©iÚUn™
("g¿du©iÚ_un™", 
G¿d
,

111 
SgeWidth
 * 
MaxTh»ads
, 0, 
_ıu
, 
·¿ms
));

112 
	}
}

115 
	gResourûPoŞ
::
	$š™
()

117 
i
=0; i < 
»sourûs
.
	`size
(); i++) {

118 
»sourûs
[
i
]->
	`š™
();

120 
	}
}

122 
¡ršg


123 
	gResourûPoŞ
::
	$Çme
()

125  
ıu
->
	`Çme
() + ".ResourcePool";

126 
	}
}

130 
	gResourûPoŞ
::
	$»gSts
()

132 
	`DPRINTF
(
Resourû
, "Registering Stats Throughout Resource Pool.\n");

134 
num_»sourûs
 = 
»sourûs
.
	`size
();

136 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

137 
»sourûs
[
idx
]->
	`»gSts
();

139 
	}
}

141 
ResReqPŒ


142 
	gResourûPoŞ
::
	$»que¡
(
»s_idx
, 
DynIn¡PŒ
 
š¡
)

145 
	`as£¹
(
»s_idx
 >ğ0 &&„es_idx < 
»sourûs
.
	`size
());

147  
»sourûs
[
»s_idx
]->
	`»que¡
(
š¡
);

148 
	}
}

151 
	gResourûPoŞ
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
»s_idx
, 
In¡SeqNum
 
dÚe_£q_num
,

152 
Th»adID
 
tid
)

154 
»sourûs
[
»s_idx
]->
	`squash
(
š¡
, 
TheP–še
::
NumSges
-1, 
dÚe_£q_num
, 
tid
);

155 
	}
}

158 
	gResourûPoŞ
::
	$¦ÙsAva
(
»s_idx
)

160  
»sourûs
[
»s_idx
]->
	`¦ÙsAva
();

161 
	}
}

164 
	gResourûPoŞ
::
	$¦ÙsInU£
(
»s_idx
)

166  
»sourûs
[
»s_idx
]->
	`¦ÙsInU£
();

167 
	}
}

170 
	gResourûPoŞ
::
scheduËEv’t
(
InOrd”CPU
::
CPUEv’tTy³
 
e_ty³
, 
DynIn¡PŒ
 
š¡
,

171 
d–ay
, 
»s_idx
, 
Th»adID
 
tid
)

173 
as£¹
(
d–ay
 >= 0);

175 
ResPoŞEv’t
 *
	g»s_poŞ_ev’t
 = 
Ãw
 ResPoŞEv’t(
this
);

177 
	ge_ty³
)

179 
	gInOrd”CPU
::
Aùiv©eTh»ad
:

181 
DPRINTF
(
Resourû
, "Scheduling Activate Thread Resource Pool Event forick %i.\n",

182 
curTick
(è+ 
d–ay
);

183 
	g»s_poŞ_ev’t
->
£tEv’t
(
e_ty³
,

184 
š¡
,

185 
š¡
->
squashšgSge
,

186 
š¡
->
squashSeqNum
,

187 
š¡
->
»adTid
());

188 
	g»s_poŞ_ev’t
->
scheduË
(
curTick
(è+ 
ıu
->
cyşes
(
d–ay
));

193 
	gInOrd”CPU
::
Su¥’dTh»ad
:

194 
InOrd”CPU
::
D—Îoÿ‹Th»ad
:

196 
DPRINTF
(
Resourû
, "Scheduling Deactivate Thread Resource Pool Event forick %i.\n",

197 
curTick
(è+ 
d–ay
);

199 
	g»s_poŞ_ev’t
->
£tEv’t
(
e_ty³
,

200 
š¡
,

201 
š¡
->
squashšgSge
,

202 
š¡
->
squashSeqNum
,

203 
tid
);

205 
	g»s_poŞ_ev’t
->
scheduË
(
curTick
(è+ 
ıu
->
cyşes
(
d–ay
));

210 
	gResourûPoŞ
::
In¡G¿du©ed
:

212 
DPRINTF
(
Resourû
, "Scheduling Inst-Graduated Resource Pool Event forick %i.\n",

213 
curTick
(è+ 
d–ay
);

215 
	g»s_poŞ_ev’t
->
£tEv’t
(
e_ty³
,

216 
š¡
,

217 
š¡
->
squashšgSge
,

218 
š¡
->
£qNum
,

219 
š¡
->
»adTid
());

220 
	g»s_poŞ_ev’t
->
scheduË
(
curTick
(è+ 
ıu
->
cyşes
(
d–ay
));

225 
	gResourûPoŞ
::
SquashAÎ
:

227 
DPRINTF
(
Resourû
, "Scheduling Squash Resource Pool Event forick %i.\n",

228 
curTick
(è+ 
d–ay
);

229 
	g»s_poŞ_ev’t
->
£tEv’t
(
e_ty³
,

230 
š¡
,

231 
š¡
->
squashšgSge
,

232 
š¡
->
squashSeqNum
,

233 
š¡
->
»adTid
());

234 
	g»s_poŞ_ev’t
->
scheduË
(
curTick
(è+ 
ıu
->
cyşes
(
d–ay
));

240 
DPRINTF
(
Resourû
, "IgnÜšg UÄecognized CPU Ev’ˆTy³ #%i.\n", 
e_ty³
);

246 
	gResourûPoŞ
::
	$unscheduËEv’t
(
»s_idx
, 
DynIn¡PŒ
 
š¡
)

248 
»sourûs
[
»s_idx
]->
	`unscheduËEv’t
(
š¡
);

249 
	}
}

252 
	gResourûPoŞ
::
	$squashAÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

253 
In¡SeqNum
 
dÚe_£q_num
, 
Th»adID
 
tid
)

255 
	`DPRINTF
(
Resourû
, "[tid:%i] Stage %i squashing‡ll instructions‡bove [sn:%i].\n",

256 
¡age_num
, 
tid
, 
dÚe_£q_num
);

258 
num_»sourûs
 = 
»sourûs
.
	`size
();

260 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

261 
»sourûs
[
idx
]->
	`squash
(
š¡
, 
¡age_num
, 
dÚe_£q_num
, 
tid
);

263 
	}
}

266 
	gResourûPoŞ
::
	$aùiv©eAÎ
(
Th»adID
 
tid
)

268 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting Thread Activationo‡ll„esources.\n",

269 
tid
);

271 
num_»sourûs
 = 
»sourûs
.
	`size
();

273 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

274 
»sourûs
[
idx
]->
	`aùiv©eTh»ad
(
tid
);

276 
	}
}

279 
	gResourûPoŞ
::
	$d—ùiv©eAÎ
(
Th»adID
 
tid
)

281 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting Thread Deactivationo‡ll„esources.\n",

282 
tid
);

284 
num_»sourûs
 = 
»sourûs
.
	`size
();

286 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

287 
»sourûs
[
idx
]->
	`d—ùiv©eTh»ad
(
tid
);

289 
	}
}

292 
	gResourûPoŞ
::
	$š¡G¿du©ed
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
)

294 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting [sn:%i] graduationo‡ll„esources.\n",

295 
tid
, 
£q_num
);

297 
num_»sourûs
 = 
»sourûs
.
	`size
();

299 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

300 
»sourûs
[
idx
]->
	`š¡G¿du©ed
(
£q_num
, 
tid
);

302 
	}
}

304 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$ResPoŞEv’t
(
ResourûPoŞ
 *
_»sPoŞ
)

305 : 
	`Ev’t
(&
mašEv’tQueue
, 
CPU_Tick_Pri
),

306 
	$»sPoŞ
(
_»sPoŞ
)

307 { 
ev’tTy³
 = (
InOrd”CPU
::
CPUEv’tTy³
è
DeçuÉ
; 
	}
}

310 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$´oûss
()

312 
ev’tTy³
)

314 
InOrd”CPU
::
Aùiv©eTh»ad
:

315 
»sPoŞ
->
	`aùiv©eAÎ
(
tid
);

318 
InOrd”CPU
::
Su¥’dTh»ad
:

319 
InOrd”CPU
::
D—Îoÿ‹Th»ad
:

320 
»sPoŞ
->
	`d—ùiv©eAÎ
(
tid
);

323 
ResourûPoŞ
::
In¡G¿du©ed
:

324 
»sPoŞ
->
	`š¡G¿du©ed
(
£qNum
, 
tid
);

327 
ResourûPoŞ
::
SquashAÎ
:

328 
»sPoŞ
->
	`squashAÎ
(
š¡
, 
¡ageNum
, 
£qNum
, 
tid
);

332 
	`çl
("Unrecognized Event Type");

335 
»sPoŞ
->
ıu
->
ıuEv’tRemoveLi¡
.
	`push
(
this
);

336 
	}
}

340 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$desütiÚ
()

343 
	}
}

347 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$scheduËEv’t
(
d–ay
)

349 ià(
	`squashed
())

350 
	`»scheduË
(
	`curTick
(è+ 
»sPoŞ
->
ıu
->
	`cyşes
(
d–ay
));

351 ià(!
	`scheduËd
())

352 
	`scheduË
(
	`curTick
(è+ 
»sPoŞ
->
ıu
->
	`cyşes
(
d–ay
));

353 
	}
}

357 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$unscheduËEv’t
()

359 ià(
	`scheduËd
())

360 
	`squash
();

361 
	}
}

	@inorder/resource_pool.cc

44 
	~<li¡
>

45 
	~<veùÜ
>

47 
	~"ıu/šÜd”/»sourûs/»sourû_li¡.hh
"

48 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

49 
	~"debug/Resourû.hh
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

52 
usšg
 
Çme¥aû
 
	gTheP–še
;

54 
	gResourûPoŞ
::
ResourûPoŞ
(
InOrd”CPU
 *
_ıu
, 
TheP–še
::
P¬ams
 *
·¿ms
)

55 : 
ıu
(
_ıu
), 
š¡Un™
(
NULL
), 
	$d©aUn™
(
NULL
)

61 
¡age_width
 = 
ıu
->
¡ageWidth
;

66 
»sourûs
.
	`push_back
(
Ãw
 
	`F‘chSeqUn™
("ãtch_£q_un™", 
F‘chSeq
,

67 
¡age_width
 * 2, 
	`Cyşes
(0),

68 
_ıu
, 
·¿ms
));

72 
š¡Un™
 = 
Ãw
 
	`F‘chUn™
("iÿche_pÜt", 
ICache
,

73 
¡age_width
 * 2 + 
MaxTh»ads
, 
	`Cyşes
(0), 
_ıu
,

74 
·¿ms
);

75 
»sourûs
.
	`push_back
(
š¡Un™
);

77 
»sourûs
.
	`push_back
(
Ãw
 
	`DecodeUn™
("decode_un™", 
Decode
,

78 
¡age_width
, 
	`Cyşes
(0), 
_ıu
,

79 
·¿ms
));

81 
»sourûs
.
	`push_back
(
Ãw
 
	`B¿nchP»diùÜ
("b¿nch_´ediùÜ", 
BP»d
,

82 
¡age_width
, 
	`Cyşes
(0),

83 
_ıu
, 
·¿ms
));

85 
»sourûs
.
	`push_back
(
Ãw
 
	`In¡Bufãr
("ãtch_bufãr_t0", 
F‘chBuff
, 4,

86 
	`Cyşes
(0), 
_ıu
, 
·¿ms
));

88 
»sourûs
.
	`push_back
(
Ãw
 
	`U£DefUn™
("»gfe_mªag”", 
RegMªag”
,

89 
¡age_width
 * 3, 
	`Cyşes
(0), 
_ıu
,

90 
·¿ms
));

92 
»sourûs
.
	`push_back
(
Ãw
 
	`AGENUn™
("ag’_un™", 
AGEN
,

93 
¡age_width
, 
	`Cyşes
(0), 
_ıu
,

94 
·¿ms
));

96 
»sourûs
.
	`push_back
(
Ãw
 
	`ExecutiÚUn™
("executiÚ_un™", 
ExecUn™
,

97 
¡age_width
, 
	`Cyşes
(0), 
_ıu
,

98 
·¿ms
));

100 
»sourûs
.
	`push_back
(
Ãw
 
	`MuÉDivUn™
("muÉ_div_un™", 
MDU
,

101 
¡age_width
 * 2, 
	`Cyşes
(0),

102 
_ıu
, 
·¿ms
));

106 
d©aUn™
 = 
Ãw
 
	`CacheUn™
("dÿche_pÜt", 
DCache
,

107 
¡age_width
 * 2 + 
MaxTh»ads
, 
	`Cyşes
(0), 
_ıu
,

108 
·¿ms
);

109 
»sourûs
.
	`push_back
(
d©aUn™
);

111 
g¿dObjeùs
.
	`push_back
(
BP»d
);

112 
»sourûs
.
	`push_back
(
Ãw
 
	`G¿du©iÚUn™
("g¿du©iÚ_un™", 
G¿d
,

113 
¡age_width
, 
	`Cyşes
(0), 
_ıu
,

114 
·¿ms
));

116 
»sourûs
.
	`push_back
(
Ãw
 
	`In¡Bufãr
("ãtch_bufãr_t1", 
F‘chBuff2
, 4,

117 
	`Cyşes
(0), 
_ıu
, 
·¿ms
));

119 
	}
}

121 
	gResourûPoŞ
::~
	$ResourûPoŞ
()

123 
cout
 << "D–‘šg„esourû ..." << 
’dl
;

125 
i
=0; i < 
»sourûs
.
	`size
(); i++) {

126 
	`DPRINTF
(
Resourû
, "D–‘šg„esourû: %s.\n", 
»sourûs
[
i
]->
	`Çme
());

128 
d–‘e
 
»sourûs
[
i
];

130 
	}
}

134 
	gResourûPoŞ
::
	$š™
()

136 
i
=0; i < 
»sourûs
.
	`size
(); i++) {

137 
	`DPRINTF
(
Resourû
, "Initializing„esource: %s.\n",

138 
»sourûs
[
i
]->
	`Çme
());

140 
»sourûs
[
i
]->
	`š™
();

142 
	}
}

144 
¡ršg


145 
	gResourûPoŞ
::
	$Çme
()

147  
ıu
->
	`Çme
() + ".ResourcePool";

148 
	}
}

151 
	gResourûPoŞ
::
	$´št
()

153 
i
=0; i < 
»sourûs
.
	`size
(); i++) {

154 
	`DPRINTF
(
InOrd”DynIn¡
, "Res:%i %s\n",

155 
i
, 
»sourûs
[i]->
	`Çme
());

158 
	}
}

162 
	gResourûPoŞ
::
	$»gSts
()

164 
	`DPRINTF
(
Resourû
, "Registering Stats Throughout Resource Pool.\n");

166 
num_»sourûs
 = 
»sourûs
.
	`size
();

168 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

169 
»sourûs
[
idx
]->
	`»gSts
();

171 
	}
}

174 
	gResourûPoŞ
::
g‘ResIdx
(cÚ¡ 
TheP–še
::
ResourûId
 &
»s_id
)

176 
num_»sourûs
 = 
»sourûs
.
size
();

178 
	gidx
 = 0; idx < 
	gnum_»sourûs
; idx++) {

179 ià(
	g»sourûs
[
idx
]->
g‘Id
(è=ğ
»s_id
)

180  
idx
;

186 
·nic
("Cª'ˆfšd„esourû idx fÜ: %i\n", 
»s_id
);

191 
ResReqPŒ


192 
	gResourûPoŞ
::
	$»que¡
(
»s_idx
, 
DynIn¡PŒ
 
š¡
)

195 
	`as£¹
(
»s_idx
 >ğ0 &&„es_idx < 
»sourûs
.
	`size
());

197  
»sourûs
[
»s_idx
]->
	`»que¡
(
š¡
);

198 
	}
}

201 
	gResourûPoŞ
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
»s_idx
, 
In¡SeqNum
 
dÚe_£q_num
,

202 
Th»adID
 
tid
)

204 
»sourûs
[
»s_idx
]->
	`squash
(
š¡
, 
TheP–še
::
NumSges
-1, 
dÚe_£q_num
,

205 
tid
);

206 
	}
}

209 
	gResourûPoŞ
::
	$Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
)

211 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting Trapo‡ll "

212 "»sourûs.\n", 
tid
);

214 
num_»sourûs
 = 
»sourûs
.
	`size
();

216 
idx
 = 0; idx < 
num_»sourûs
; idx++)

217 
»sourûs
[
idx
]->
	`Œ­
(
çuÉ
, 
tid
, 
š¡
);

218 
	}
}

221 
	gResourûPoŞ
::
	$¦ÙsAva
(
»s_idx
)

223  
»sourûs
[
»s_idx
]->
	`¦ÙsAva
();

224 
	}
}

227 
	gResourûPoŞ
::
	$¦ÙsInU£
(
»s_idx
)

229  
»sourûs
[
»s_idx
]->
	`¦ÙsInU£
();

230 
	}
}

239 
	gResourûPoŞ
::
scheduËEv’t
(
InOrd”CPU
::
CPUEv’tTy³
 
e_ty³
, 
DynIn¡PŒ
 
š¡
,

240 
Cyşes
 
d–ay
, 
»s_idx
, 
Th»adID
 
tid
)

242 
as£¹
(
d–ay
 >= 0);

244 
Tick
 
	gwh’
 = 
ıu
->
şockEdge
(
d–ay
);

246 ()
	ge_ty³
)

248 
	gResourûPoŞ
::
In¡G¿du©ed
:

250 
DPRINTF
(
Resourû
, "Scheduling Inst-Graduated Resource Pool "

251 "Ev’ˆfÜick %i.\n", 
curTick
(è+ 
d–ay
);

252 
ResPoŞEv’tPri
 
	gg¿d_´i
 = 
ResG¿d_Pri
;

253 
ResPoŞEv’t
 *
	g»s_poŞ_ev’t
 =

254 
Ãw
 
ResPoŞEv’t
(
this
,

255 
e_ty³
,

256 
š¡
,

257 
š¡
->
squashšgSge
,

258 
š¡
->
£qNum
,

259 
š¡
->
»adTid
(),

260 
g¿d_´i
);

261 
	gıu
->
scheduË
(
»s_poŞ_ev’t
, 
wh’
);

265 
	gResourûPoŞ
::
SquashAÎ
:

267 
DPRINTF
(
Resourû
, "Scheduling Squash Resource Pool Event for "

268 "tick %i.\n", 
curTick
(è+ 
d–ay
);

269 
ResPoŞEv’tPri
 
	gsquash_´i
 = 
ResSquash_Pri
;

270 
ResPoŞEv’t
 *
	g»s_poŞ_ev’t
 =

271 
Ãw
 
ResPoŞEv’t
(
this
,

272 
e_ty³
,

273 
š¡
,

274 
š¡
->
squashšgSge
,

275 
š¡
->
squashSeqNum
,

276 
š¡
->
»adTid
(),

277 
squash_´i
);

278 
	gıu
->
scheduË
(
»s_poŞ_ev’t
, 
wh’
);

282 
	gResourûPoŞ
::
Upd©eAá”CÚ‹xtSw™ch
:

284 
DPRINTF
(
Resourû
, "Scheduling UpdatePC Resource Pool Event "

286 
curTick
(è+ 
d–ay
);

287 
ResPoŞEv’t
 *
	g»s_poŞ_ev’t
 = 
Ãw
 ResPoŞEv’t(
this
,

288 
e_ty³
,

289 
š¡
,

290 
š¡
->
squashšgSge
,

291 
š¡
->
£qNum
,

292 
š¡
->
»adTid
());

293 
	gıu
->
scheduË
(
»s_poŞ_ev’t
, 
wh’
);

298 
DPRINTF
(
Resourû
, "Ignoring Unrecognized CPU Event (%s).\n",

299 
InOrd”CPU
::
ev’tNames
[
e_ty³
]);

304 
	gResourûPoŞ
::
	$unscheduËEv’t
(
»s_idx
, 
DynIn¡PŒ
 
š¡
)

306 
»sourûs
[
»s_idx
]->
	`unscheduËEv’t
(
š¡
);

307 
	}
}

310 
	gResourûPoŞ
::
	$squashAÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

311 
In¡SeqNum
 
dÚe_£q_num
, 
Th»adID
 
tid
)

313 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting Squash All Event "

315 
tid
, 
¡age_num
, 
dÚe_£q_num
);

317 
num_»sourûs
 = 
»sourûs
.
	`size
();

319 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

320 
»sourûs
[
idx
]->
	`squash
(
š¡
, 
¡age_num
, 
dÚe_£q_num
, 
tid
);

322 
	}
}

325 
	gResourûPoŞ
::
	$squashDueToMemSÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

326 
In¡SeqNum
 
dÚe_£q_num
, 
Th»adID
 
tid
)

328 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting SquashDueToMemStall Event"

330 
tid
, 
¡age_num
, 
dÚe_£q_num
);

332 
num_»sourûs
 = 
»sourûs
.
	`size
();

334 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

335 
»sourûs
[
idx
]->
	`squashDueToMemSÎ
(
š¡
, 
¡age_num
, 
dÚe_£q_num
,

336 
tid
);

338 
	}
}

341 
	gResourûPoŞ
::
	$aùiv©eTh»ad
(
Th»adID
 
tid
)

343 
boŞ
 
do_aùiv©e
 = 
ıu
->
th»adMod–
 !ğ
InOrd”CPU
::
Sw™chOnCacheMiss
 ||

344 
ıu
->
	`numAùiveTh»ads
() < 1 ||

345 
ıu
->
	`aùiveTh»adId
(è=ğ
tid
;

348 ià(
do_aùiv©e
) {

349 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting Thread Activationo‡ll "

350 "»sourûs.\n", 
tid
);

352 
num_»sourûs
 = 
»sourûs
.
	`size
();

354 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

355 
»sourûs
[
idx
]->
	`aùiv©eTh»ad
(
tid
);

358 
	`DPRINTF
(
Resourû
, "[tid:%i] Ignoring Thread Activationo‡ll "

359 "»sourûs.\n", 
tid
);

361 
	}
}

364 
	gResourûPoŞ
::
	$d—ùiv©eTh»ad
(
Th»adID
 
tid
)

366 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting Thread Deactivationo‡ll "

367 "»sourûs.\n", 
tid
);

369 
num_»sourûs
 = 
»sourûs
.
	`size
();

371 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

372 
»sourûs
[
idx
]->
	`d—ùiv©eTh»ad
(
tid
);

374 
	}
}

377 
	gResourûPoŞ
::
	$su¥’dTh»ad
(
Th»adID
 
tid
)

379 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting Thread Suspensiono‡ll "

380 "»sourûs.\n", 
tid
);

382 
num_»sourûs
 = 
»sourûs
.
	`size
();

384 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

385 
»sourûs
[
idx
]->
	`su¥’dTh»ad
(
tid
);

387 
	}
}

390 
	gResourûPoŞ
::
	$š¡G¿du©ed
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
)

392 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting [sn:%i] graduationo "

393 "­´İrŸ‹„esourûs.\n", 
tid
, 
£q_num
);

395 
num_»sourûs
 = 
g¿dObjeùs
.
	`size
();

397 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

398 
»sourûs
[
g¿dObjeùs
[
idx
]]->
	`š¡G¿du©ed
(
£q_num
, 
tid
);

400 
	}
}

403 
	gResourûPoŞ
::
	$upd©eAá”CÚ‹xtSw™ch
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
)

405 
	`DPRINTF
(
Resourû
, "[tid:%i] Broadcasting Update PCo‡ll„esources.\n",

406 
tid
);

408 
num_»sourûs
 = 
»sourûs
.
	`size
();

410 
idx
 = 0; idx < 
num_»sourûs
; idx++) {

411 
»sourûs
[
idx
]->
	`upd©eAá”CÚ‹xtSw™ch
(
š¡
, 
tid
);

413 
	}
}

415 
	gResourûPoŞ
::
ResPoŞEv’t
::ResPoŞEv’t(
ResourûPoŞ
 *
_»sPoŞ
,

416 
InOrd”CPU
::
CPUEv’tTy³
 
e_ty³
,

417 
DynIn¡PŒ
 
_š¡
,

418 
¡age_num
,

419 
In¡SeqNum
 
£q_num
,

420 
Th»adID
 
_tid
,

421 
ResPoŞEv’tPri
 
»s_´i
)

422 : 
Ev’t
(
»s_´i
), 
»sPoŞ
(
_»sPoŞ
),

423 
ev’tTy³
(
e_ty³
), 
š¡
(
_š¡
), 
£qNum
(
£q_num
),

424 
¡ageNum
(
¡age_num
), 
	$tid
(
_tid
)

425 { 
	}
}

429 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$´oûss
()

431 ()
ev’tTy³
)

434 
ResourûPoŞ
::
In¡G¿du©ed
:

435 
»sPoŞ
->
	`š¡G¿du©ed
(
£qNum
, 
tid
);

438 
ResourûPoŞ
::
SquashAÎ
:

439 
»sPoŞ
->
	`squashAÎ
(
š¡
, 
¡ageNum
, 
£qNum
, 
tid
);

442 
ResourûPoŞ
::
Upd©eAá”CÚ‹xtSw™ch
:

443 
»sPoŞ
->
	`upd©eAá”CÚ‹xtSw™ch
(
š¡
, 
tid
);

447 
	`çl
("Unrecognized Event Type");

450 
»sPoŞ
->
ıu
->
ıuEv’tRemoveLi¡
.
	`push
(
this
);

451 
	}
}

455 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$desütiÚ
() const

458 
	}
}

462 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$scheduËEv’t
(
Cyşes
 
d–ay
)

464 
InOrd”CPU
 *
ıu
 = 
»sPoŞ
->cpu;

465 
	`as£¹
(!
	`scheduËd
(è|| 
	`squashed
());

466 
ıu
->
	`»scheduË
(
this
, cpu->
	`şockEdge
(
d–ay
), 
Œue
);

467 
	}
}

471 
	gResourûPoŞ
::
ResPoŞEv’t
::
	$unscheduËEv’t
()

473 ià(
	`scheduËd
())

474 
	`squash
();

475 
	}
}

	@inorder/resource_pool.hh

44 #iâdeà
__CPU_INORDER_RESOURCE_POOL_HH__


45 
	#__CPU_INORDER_RESOURCE_POOL_HH__


	)

47 
	~<¡ršg
>

48 
	~<veùÜ
>

50 
	~"ıu/šÜd”/ıu.hh
"

51 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

52 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

53 
	~"ıu/šÜd”/»sourû.hh
"

54 
	~"ıu/š¡_£q.hh
"

55 
	~"·¿ms/InOrd”CPU.hh
"

56 
	~"sim/ev’tq.hh
"

57 
	~"sim/sim_objeù.hh
"

59 
şass
 
	gCacheUn™
;

60 
şass
 
	gEv’t
;

61 
şass
 
	gF‘chUn™
;

62 
şass
 
	gResourûEv’t
;

64 şas 
	cResourûPoŞ
 {

65 
	mpublic
:

66 
InOrd”DynIn¡
::
	tDynIn¡PŒ
 DynInstPtr;

68 
	mpublic
:

73 
	eResPoŞEv’tTy³
 {

74 
In¡G¿du©ed
 = 
InOrd”CPU
::
NumCPUEv’ts
,

75 
	mSquashAÎ
,

76 
	mUpd©eAá”CÚ‹xtSw™ch
,

77 
	mDeçuÉ


80 
	eResPoŞEv’tPri
 {

81 
	gResPoŞ_Pri
 = 
InOrd”CPU
::
InOrd”CPU_Pri
 - 5,

82 
	gResG¿d_Pri
,

83 
	gResSquash_Pri


86 şas 
	cResPoŞEv’t
 : 
public
 
Ev’t


88 
´Ùeùed
:

90 
ResourûPoŞ
 *
»sPoŞ
;

92 
	gpublic
:

93 
InOrd”CPU
::
CPUEv’tTy³
 
ev’tTy³
;

95 
DynIn¡PŒ
 
	gš¡
;

97 
In¡SeqNum
 
	g£qNum
;

99 
	g¡ageNum
;

101 
Th»adID
 
	gtid
;

103 
	gpublic
:

105 
ResPoŞEv’t
(
ResourûPoŞ
 *
_»sPoŞ
,

106 
InOrd”CPU
::
CPUEv’tTy³
 
e_ty³
,

107 
DynIn¡PŒ
 
_š¡
,

108 
¡age_num
,

109 
In¡SeqNum
 
£q_num
,

110 
Th»adID
 
_tid
,

111 
ResPoŞEv’tPri
 
»s_´i
 = 
ResPoŞ_Pri
);

114 
£tEv’t
(
InOrd”CPU
::
CPUEv’tTy³
 
e_ty³
,

115 
DynIn¡PŒ
 
_š¡
,

116 
¡age_num
,

117 
In¡SeqNum
 
£q_num
,

118 
Th»adID
 
_tid
)

120 
	gev’tTy³
 = 
e_ty³
;

121 
	gš¡
 = 
_š¡
;

122 
	g£qNum
 = 
£q_num
;

123 
	g¡ageNum
 = 
¡age_num
;

124 
	gtid
 = 
_tid
;

128 
´oûss
();

131 cÚ¡ *
desütiÚ
() const;

134 
scheduËEv’t
(
Cyşes
 
d–ay
);

137 
unscheduËEv’t
();

140 
	gpublic
:

141 
ResourûPoŞ
(
InOrd”CPU
 *
_ıu
, 
TheP–še
::
P¬ams
 *
·¿ms
);

142 
	gvœtu®
 ~
ResourûPoŞ
();

144 
	g¡d
::
¡ršg
 
Çme
();

146 
	g¡d
::
¡ršg
 
	$Çme
(
»s_idx
è{  
»sourûs
[»s_idx]->
	`Çme
(); 
	}
}

148 
š™
();

150 
´št
();

153 
»gSts
();

156 
g‘ResIdx
(cÚ¡ 
TheP–še
::
ResourûId
 &
»s_id
);

159 
Resourû
* 
	$g‘Resourû
(
»s_idx
è{  
»sourûs
[»s_idx]; 
	}
}

164 
ResReqPŒ
 
»que¡
(
»s_idx
, 
DynIn¡PŒ
 
š¡
);

167 
squash
(
DynIn¡PŒ
 
š¡
, 
»s_idx
, 
In¡SeqNum
 
dÚe_£q_num
,

168 
Th»adID
 
tid
);

171 
squashAÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

172 
In¡SeqNum
 
dÚe_£q_num
, 
Th»adID
 
tid
);

177 
squashDueToMemSÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

178 
In¡SeqNum
 
dÚe_£q_num
, 
Th»adID
 
tid
);

181 
aùiv©eTh»ad
(
Th»adID
 
tid
);

184 
d—ùiv©eTh»ad
(
Th»adID
 
tid
);

187 
su¥’dTh»ad
(
Th»adID
 
tid
);

190 
upd©eAá”CÚ‹xtSw™ch
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
);

193 
š¡G¿du©ed
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
);

196 
Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
);

201 
¦ÙsAva
(
»s_idx
);

204 
¦ÙsInU£
(
»s_idx
);

207 
scheduËEv’t
(
InOrd”CPU
::
CPUEv’tTy³
 
e_ty³
, 
DynIn¡PŒ
 
š¡
 = 
NULL
,

208 
Cyşes
 
d–ay
 = Cyşes(0), 
»s_idx
 = 0,

209 
Th»adID
 
tid
 = 0);

212 
unscheduËEv’t
(
»s_idx
, 
DynIn¡PŒ
 
š¡
);

215 
vœtu®
 
	$¡¬tup
(è{ 
	}
}

218 
InOrd”CPU
 *
	gıu
;

220 
DynIn¡PŒ
 
	gdummyIn¡
[
TheP–še
::
MaxTh»ads
];

227 
F‘chUn™
 *
	$g‘In¡Un™
(ècÚ¡ {  
š¡Un™
; 
	}
}

234 
CacheUn™
 *
	$g‘D©aUn™
(ècÚ¡ {  
d©aUn™
; 
	}
}

236 
	g´iv©e
:

239 
F‘chUn™
 *
š¡Un™
;

242 
CacheUn™
 *
	gd©aUn™
;

244 
	g¡d
::
veùÜ
<
Resourû
 *> 
»sourûs
;

247 
	g¡d
::
veùÜ
<> 
g¿dObjeùs
;

	@inorder/resource_sked.cc

32 
	~<c¡dio
>

33 
	~<li¡
>

34 
	~<veùÜ
>

36 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

37 
	~"ıu/šÜd”/»sourû_sked.hh
"

38 
	~"debug/SkedCache.hh
"

40 
usšg
 
Çme¥aû
 
	g¡d
;

41 
usšg
 
Çme¥aû
 
	gTheP–še
;

43 
	gResourûSked
::
	$ResourûSked
()

45 
¡ages
.
	`»size
(
NumSges
);

46 
	}
}

49 
	gResourûSked
::
	$š™
()

51 
	`as£¹
(!
¡ages
[0].
	`em±y
());

53 
curSkedEÁry
 = 
¡ages
[0].
	`begš
();

54 
	}
}

57 
	gResourûSked
::
	$size
()

59 
tÙ®
 = 0;

60 
i
 = 0; i < 
¡ages
.
	`size
(); i++) {

61 
tÙ®
 +ğ
¡ages
[
i
].
	`size
();

64  
tÙ®
;

65 
	}
}

67 
boŞ


68 
	gResourûSked
::
	$em±y
()

70  
	`size
() == 0;

71 
	}
}

74 
	gResourûSked
::
SkedIt


75 
ResourûSked
::
	$begš
()

77 
num_¡ages
 = 
¡ages
.
	`size
();

78 
i
 = 0; i < 
num_¡ages
; i++) {

79 ià(
¡ages
[
i
].
	`size
() > 0)

80  
¡ages
[
i
].
	`begš
();

83  
¡ages
[
num_¡ages
 - 1].
	`’d
();

84 
	}
}

86 
	gResourûSked
::
SkedIt


87 
ResourûSked
::
	$’d
()

89 
num_¡ages
 = 
¡ages
.
	`size
();

90  
¡ages
[
num_¡ages
 - 1].
	`’d
();

91 
	}
}

93 
	gResourûSked
::
SkedIt


94 
ResourûSked
::
	$’d
(
¡age_num
)

96  
¡ages
[
¡age_num
].
	`’d
();

97 
	}
}

99 
	gResourûSked
::
SkedIt


100 
ResourûSked
::
	$fšd
(
¡age_num
, 
cmd
)

102 
SkedIt
 
¡age_™
 = 
¡ages
[
¡age_num
].
	`begš
();

103 
SkedIt
 
¡age_’d
 = 
¡ages
[
¡age_num
].
	`’d
();

105 
¡age_™
 !ğ
¡age_’d
) {

106 ià((*
¡age_™
)->
cmd
 == cmd)

107  
¡age_™
;

108 
¡age_™
++;

111  
¡ages
[
¡age_num
].
	`’d
();

112 
	}
}

114 
ScheduËEÁry
*

115 
	gResourûSked
::
	$tİ
()

117 
	`as£¹
(
	`size
() > 0);

119  *
curSkedEÁry
;

120 
	}
}

123 
	gResourûSked
::
	$pİ
()

125 
¡age_num
 = (*
curSkedEÁry
)->
¡ageNum
;

127 
¡ages
[
¡age_num
].
	`”a£
(
curSkedEÁry
);

129 ià(!
¡ages
[
¡age_num
].
	`em±y
()) {

130 
curSkedEÁry
 = 
¡ages
[
¡age_num
].
	`begš
();

132 
Ãxt_¡age
 = 
¡age_num
 + 1;

134 
Ãxt_¡age
 < 
NumSges
) {

135 ià(
¡ages
[
Ãxt_¡age
].
	`em±y
()) {

136 
Ãxt_¡age
++;

138 
curSkedEÁry
 = 
¡ages
[
Ãxt_¡age
].
	`begš
();

143 
	}
}

146 
	gResourûSked
::
	$push
(
ScheduËEÁry
* 
sked_’Œy
)

148 
¡age_num
 = 
sked_’Œy
->
¡ageNum
;

149 
	`as£¹
(
¡age_num
 < 
NumSges
);

151 
SkedIt
 
´i_™”
 = 
	`fšdI‹rByPriÜ™y
(
sked_’Œy
, 
¡age_num
);

153 
¡ages
[
¡age_num
].
	`š£¹
(
´i_™”
, 
sked_’Œy
);

154 
	}
}

157 
	gResourûSked
::
	$pushBefÜe
(
ScheduËEÁry
* 
sked_’Œy
, 
sked_cmd
,

158 
sked_cmd_idx
)

161 
¡age_num
 = 
sked_’Œy
->
¡ageNum
;

162 
	`as£¹
(
¡age_num
 < 
NumSges
);

164 
SkedIt
 
´i_™”
 = 
	`fšdI‹rByCommªd
(
sked_’Œy
, 
¡age_num
,

165 
sked_cmd
, 
sked_cmd_idx
);

167 
	`as£¹
(
´i_™”
 !ğ
¡ages
[
¡age_num
].
	`’d
() &&

170 
¡ages
[
¡age_num
].
	`š£¹
(
´i_™”
, 
sked_’Œy
);

171 
	}
}

173 
	gResourûSked
::
SkedIt


174 
ResourûSked
::
	$fšdI‹rByPriÜ™y
(
ScheduËEÁry
* 
sked_’Œy
, 
¡age_num
)

176 ià(
¡ages
[
¡age_num
].
	`em±y
()) {

177  
¡ages
[
¡age_num
].
	`’d
();

180 
´iÜ™y
 = 
sked_’Œy
->priority;

182 
SkedIt
 
sked_™
 = 
¡ages
[
¡age_num
].
	`begš
();

183 
SkedIt
 
sked_’d
 = 
¡ages
[
¡age_num
].
	`’d
();

185 
sked_™
 !ğ
sked_’d
) {

186 ià((*
sked_™
)->
´iÜ™y
 >…riority)

189 
sked_™
++;

192  
sked_™
;

193 
	}
}

195 
	gResourûSked
::
SkedIt


196 
ResourûSked
::
	$fšdI‹rByCommªd
(
ScheduËEÁry
* 
sked_’Œy
, 
¡age_num
,

197 
sked_cmd
, 
sked_cmd_idx
)

199 ià(
¡ages
[
¡age_num
].
	`em±y
()) {

200  
¡ages
[
¡age_num
].
	`’d
();

203 
SkedIt
 
sked_™
 = 
¡ages
[
¡age_num
].
	`begš
();

204 
SkedIt
 
sked_’d
 = 
¡ages
[
¡age_num
].
	`’d
();

206 
sked_™
 !ğ
sked_’d
) {

207 ià((*
sked_™
)->
cmd
 =ğ
sked_cmd
 &&

208 (
sked_cmd_idx
 !ğ-1è? (*
sked_™
)->
idx
 =ğsked_cmd_idx : 
Œue
)

211 
sked_™
++;

214  
sked_™
;

215 
	}
}

218 
	gResourûSked
::
	$´št
()

220 
i
 = 0; i < 
¡ages
.
	`size
(); i++) {

222 
SkedIt
 
sked_™
 = 
¡ages
[
i
].
	`begš
();

223 
SkedIt
 
sked_’d
 = 
¡ages
[
i
].
	`’d
();

224 
sked_™
 !ğ
sked_’d
) {

225 
	`DPRINTF
(
SkedCache
, "\t stage:%i„es:%i cmd:%i idx:%i\n",

226 (*
sked_™
)->
¡ageNum
,

227 (*
sked_™
)->
»sNum
,

228 (*
sked_™
)->
cmd
,

229 (*
sked_™
)->
idx
);

230 
sked_™
++;

233 
	}
}

	@inorder/resource_sked.hh

32 #iâdeà
__CPU_INORDER_RESOURCE_SKED_HH__


33 
	#__CPU_INORDER_RESOURCE_SKED_HH__


	)

35 
	~<c¡dlib
>

36 
	~<li¡
>

37 
	~<veùÜ
>

50 şas 
	cScheduËEÁry
 {

51 
	mpublic
:

52 
	$ScheduËEÁry
(
¡age_num
, 
_´iÜ™y
, 
»s_num
, 
_cmd
 = 0,

53 
_idx
 = 0) :

54 
	`¡ageNum
(
¡age_num
), 
	`»sNum
(
»s_num
), 
	`cmd
(
_cmd
),

55 
	`idx
(
_idx
), 
	$´iÜ™y
(
_´iÜ™y
)

59 
¡ageNum
;

62 
»sNum
;

65 
cmd
;

68 
idx
;

71 
´iÜ™y
;

72 
	}
};

87 şas 
	cResourûSked
 {

88 
	mpublic
:

89 
¡d
::
	tli¡
<
	tScheduËEÁry
*>::
	t™”©Ü
 
	tSkedIt
;

90 
	m¡d
::
	tveùÜ
<
	t¡d
::
	tli¡
<
	tScheduËEÁry
*> > 
	tSgeLi¡
;

92 
ResourûSked
();

97 
š™
();

103 
size
();

106 
boŞ
 
em±y
();

109 
SkedIt
 
begš
();

112 
SkedIt
 
’d
();

115 
SkedIt
 
’d
(
¡age_num
);

118 
SkedIt
 
fšd
(
¡age_num
, 
cmd
);

121 
ScheduËEÁry
* 
tİ
();

124 
pİ
();

129 
push
(
ScheduËEÁry
* 
sked_’Œy
);

132 
pushBefÜe
(
ScheduËEÁry
* 
sked_’Œy
, 
sked_cmd
, 
sked_cmd_idx
);

135 
´št
();

137 
SgeLi¡
 *
	$g‘Sges
()

139  &
¡ages
;

142 
´iv©e
:

144 
SkedIt
 
curSkedEÁry
;

149 
SgeLi¡
 
¡ages
;

154 
SkedIt
 
	`fšdI‹rByPriÜ™y
(
ScheduËEÁry
 *
sked_’Œy
, 
¡age_num
);

159 
SkedIt
 
	`fšdI‹rByCommªd
(
ScheduËEÁry
 *
sked_’Œy
, 
¡age_num
,

160 
sked_cmd
, 
sked_cmd_idx
 = -1);

161 
	}
};

168 şas 
	cRSkedIt


170 
	mpublic
:

171 
	$RSkedIt
()

172 : 
	`curSge
(0), 
	$numSges
(0)

179 
	$š™
(
ResourûSked
* 
rsked
)

181 
¡ages
 = 
rsked
->
	`g‘Sges
();

182 
numSges
 = 
¡ages
->
	`size
();

183 
	}
}

190 
RSkedIt
 
	gİ”©Ü
=(
ResourûSked
::
SkedIt
 cÚ¡ &
rhs
)

192 
myIt
 = 
rhs
;

193 ià(
	gmyIt
 !ğ(*
¡ages
)[
numSges
-1].
’d
()) {

194 
curSge
 = (*
myIt
)->
¡ageNum
;

195 
	gcurSge_’d
 = (*
¡ages
)[
curSge
].
’d
();

197  *
	gthis
;

206 
	gRSkedIt
 &
	gİ”©Ü
++(
	gunu£d
)

208 ià(++
	gmyIt
 =ğ
curSge_’d
) {

209 
curSge
++;

210 
	gcurSge
 < 
	gnumSges
) {

211 ià((*
	g¡ages
)[
curSge
].
em±y
()) {

212 
	gcurSge
++;

214 
	gmyIt
 = (*
¡ages
)[
curSge
].
begš
();

215 
	gcurSge_’d
 = (*
¡ages
)[
curSge
].
’d
();

216  *
	gthis
;

220 
	gmyIt
 = (*
¡ages
)[
numSges
 - 1].
’d
();

223  *
	gthis
;

229 
ScheduËEÁry
* 
	gİ”©Ü
->()

231  *
	gmyIt
;

237 
ScheduËEÁry
* 
	gİ”©Ü
*()

239  *
	gmyIt
;

245 
boŞ
 
	gİ”©Ü
==(
RSkedIt
 cÚ¡ &
rhs
)

247  
this
->
myIt
 =ğ
rhs
.myIt;

253 
boŞ
 
	gİ”©Ü
!=(
RSkedIt
 cÚ¡ &
rhs
)

255  
this
->
myIt
 !ğ
rhs
.myIt;

261 
	gResourûSked
::
SkedIt
 
	$g‘It
()

263  
myIt
;

264 
	}
}

266 
	g´iv©e
:

268 
ResourûSked
::
SkedIt
 
myIt
;

273 
	gResourûSked
::
SgeLi¡
 *
¡ages
;

276 
	gResourûSked
::
SkedIt
 
curSge_’d
;

279 
	gcurSge
;

282 
	gnumSges
;

	@inorder/resources/agen_unit.cc

32 
	~"ıu/šÜd”/»sourûs/ag’_un™.hh
"

33 
	~"debug/InOrd”AGEN.hh
"

35 
	gAGENUn™
::
AGENUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

36 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

37 
TheP–še
::
P¬ams
 *
·¿ms
)

38 : 
	$Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
)

39 { 
	}
}

42 
	gAGENUn™
::
	$»gSts
()

44 
ag’s


45 .
	`Çme
(name() + ".agens")

46 .
	`desc
("Number of Address Generations");

48 
Resourû
::
	`»gSts
();

49 
	}
}

52 
	gAGENUn™
::
	$execu‹
(
¦Ù_num
)

54 
ResourûReque¡
* 
ag’_»q
 = 
»qs
[
¦Ù_num
];

55 
DynIn¡PŒ
 
š¡
 = 
»qs
[
¦Ù_num
]->inst;

56 #ià
TRACING_ON


57 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

59 
In¡SeqNum
 
£q_num
 = 
š¡
->
£qNum
;

61 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

62 
	`DPRINTF
(
InOrd”AGEN
,

64 "Ãxˆ¡age.\n", 
tid
, 
š¡
->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

65 
š¡
->
	`pcS‹
());

66 
ag’_»q
->
	`dÚe
();

70 
ag’_»q
->
cmd
)

72 
G’”©eAddr
:

75 ià(
š¡
->
	`isMemRef
()) {

76 
	`DPRINTF
(
InOrd”AGEN
,

78 
tid
, 
£q_num
, 
š¡
->
¡©icIn¡
->
	`g‘Name
());

80 
š¡
->
çuÉ
 = in¡->
	`ÿlcEA
();

81 
š¡
->
	`£tMemAddr
(š¡->
	`g‘EA
());

83 
	`DPRINTF
(
InOrd”AGEN
,

85 
tid
, 
£q_num
, 
š¡
->
	`g‘EA
());

87 ià(
š¡
->
çuÉ
 =ğ
NoFauÉ
) {

88 
ag’_»q
->
	`dÚe
();

90 
	`çl
("%sƒncountered while calculating‡ddress [sn:%i] %s",

91 
š¡
->
çuÉ
->
	`Çme
(), 
£q_num
, in¡->
	`š¡Name
());

94 
ag’s
++;

96 
	`DPRINTF
(
InOrd”AGEN
,

98 
tid
, 
£q_num
);

99 
ag’_»q
->
	`dÚe
();

105 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

107 
	}
}

	@inorder/resources/agen_unit.hh

32 #iâdeà
__CPU_INORDER_AGEN_UNIT_HH__


33 
	#__CPU_INORDER_AGEN_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/šÜd”/ıu.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/šÜd”/»sourû.hh
"

44 şas 
	cAGENUn™
 : 
public
 
Resourû
 {

45 
public
:

46 
InOrd”DynIn¡
::
	tDynIn¡PŒ
 DynInstPtr;

48 
	mpublic
:

49 
AGENUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

50 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

51 
TheP–še
::
P¬ams
 *
·¿ms
);

53 
	eCommªd
 {

54 
	mG’”©eAddr


57 
vœtu®
 
execu‹
(
¦Ù_num
);

58 
»gSts
();

60 
	g´Ùeùed
:

61 
Sts
::
SÿÏr
 
ag’s
;

	@inorder/resources/branch_predictor.cc

32 
	~"cÚfig/the_i§.hh
"

33 
	~"ıu/šÜd”/»sourûs/b¿nch_´ediùÜ.hh
"

34 
	~"debug/InOrd”BP»d.hh
"

35 
	~"debug/InOrd”Sge.hh
"

36 
	~"debug/Resourû.hh
"

38 
usšg
 
Çme¥aû
 
	g¡d
;

39 
usšg
 
Çme¥aû
 
	gTheISA
;

40 
usšg
 
Çme¥aû
 
	gTheP–še
;

42 
	gB¿nchP»diùÜ
::
B¿nchP»diùÜ
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
,

43 
»s_width
, 
Cyşes
 
»s_Ï‹ncy
,

44 
InOrd”CPU
 *
_ıu
,

45 
TheP–še
::
P¬ams
 *
·¿ms
)

46 : 
Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
),

47 
b¿nchP»d
(
·¿ms
->branchPred)

49 
	gš¡Size
 = (
MachIn¡
);

53 
	gB¿nchP»diùÜ
::
	$»gSts
()

55 
´ediùedTak’


56 .
	`Çme
(name() + ".predictedTaken")

57 .
	`desc
("Number of Branches Predicted As Taken (True).");

59 
´ediùedNÙTak’


60 .
	`Çme
(name() + ".predictedNotTaken")

61 .
	`desc
("Number of Branches Predicted As Not Taken (False).");

63 
Resourû
::
	`»gSts
();

64 
	}
}

67 
	gB¿nchP»diùÜ
::
	$execu‹
(
¦Ù_num
)

69 
ResourûReque¡
* 
b´ed_»q
 = 
»qs
[
¦Ù_num
];

70 
DynIn¡PŒ
 
š¡
 = 
b´ed_»q
->inst;

71 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

72 
	`DPRINTF
(
InOrd”BP»d
,

74 "Ãxˆ¡age.\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

75 
š¡
->
	`pcS‹
());

76 
b´ed_»q
->
	`dÚe
();

80 ià(!
š¡
->
	`isCÚŒŞ
()) {

81 
	`DPRINTF
(
Resourû
, "Ignoring %s,‚ot‡ control inst.\n",

82 
š¡
->
	`š¡Name
());

83 
b´ed_»q
->
	`dÚe
();

87 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

88 
In¡SeqNum
 
£q_num
 = 
š¡
->
£qNum
;

89 
b´ed_»q
->
cmd
)

91 
P»diùB¿nch
:

93 ià(
š¡
->
£qNum
 > 
ıu
->
squashSeqNum
[
tid
] &&

94 
	`curTick
(è=ğ
ıu
->
Ï¡SquashCyşe
[
tid
]) {

95 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: [sn:%i]: squashed, "

96 "skpšg…»diùiÚ \n", 
tid
, 
š¡
->
£qNum
);

98 
TheISA
::
PCS‹
 
š¡PC
 = 
š¡
->
	`pcS‹
();

99 
TheISA
::
PCS‹
 
´ed_PC
 = 
š¡
->
	`pcS‹
();

100 
TheISA
::
	`advªûPC
(
´ed_PC
, 
š¡
->
¡©icIn¡
);

102 ià(
š¡
->
	`isCÚŒŞ
()) {

106 
boŞ
 
´ediù_k’
 = 
b¿nchP»d
->
	`´ediùInOrd”
(

107 
š¡
->
¡©icIn¡
, in¡->
£qNum
,

108 
š¡
->
asid
, 
š¡PC
, 
´ed_PC
, 
tid
);

110 ià(
´ediù_k’
) {

111 
	`DPRINTF
(
InOrd”BP»d
, "[tid:%i]: [sn:%i]: Branch "

112 "´ediùedrue.\n", 
tid
, 
£q_num
);

113 
´ediùedTak’
++;

115 
	`DPRINTF
(
InOrd”BP»d
, "[tid:%i]: [sn:%i]: Branch "

116 "´ediùed f®£.\n", 
tid
, 
£q_num
);

117 
´ediùedNÙTak’
++;

120 
š¡
->
	`£tB¿nchP»d
(
´ediù_k’
);

125 
š¡
->
	`£tP»dT¬g
(
´ed_PC
);

126 
	`DPRINTF
(
InOrd”BP»d
, "[tid:%i]: [sn:%i]: %s Predicted PC is "

127 "%s.\n", 
tid
, 
£q_num
, 
š¡
->
	`š¡Name
(), 
´ed_PC
);

130 
b´ed_»q
->
	`dÚe
();

134 
Upd©eP»diùÜ
:

136 ià(
š¡
->
£qNum
 > 
ıu
->
squashSeqNum
[
tid
] &&

137 
	`curTick
(è=ğ
ıu
->
Ï¡SquashCyşe
[
tid
]) {

138 
	`DPRINTF
(
InOrd”Sge
, "[tid:%u]: [sn:%i]: squashed, "

140 
tid
, 
š¡
->
£qNum
);

142 
	`DPRINTF
(
InOrd”BP»d
, "[tid:%i]: [sn:%i]: Updating "

144 
tid
, 
£q_num
);

147 
b¿nchP»d
->
	`upd©e
(
£q_num
, 
tid
);

150 
b´ed_»q
->
	`dÚe
();

155 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

157 
	}
}

160 
	gB¿nchP»diùÜ
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
squash_¡age
,

161 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

163 
In¡SeqNum
 
b´ed_squash_num
 = 
š¡
->
£qNum
;

164 
	`DPRINTF
(
InOrd”BP»d
, "[tid:%i][¢:%i] Squashšg...\n", 
tid
,

165 
b´ed_squash_num
);

168 ià(
squash_¡age
 >ğ
TheP–še
::
BackEndS¹Sge
) {

169 
b¿nchP»d
->
	`squash
(
b´ed_squash_num
, 
š¡
->
	`pcS‹
(),

170 
š¡
->
	`pcS‹
().
	`b¿nchšg
(), 
tid
);

173 
b¿nchP»d
->
	`squash
(
b´ed_squash_num
, 
tid
);

175 
	}
}

178 
	gB¿nchP»diùÜ
::
	$š¡G¿du©ed
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
)

180 
b¿nchP»d
->
	`upd©e
(
£q_num
, 
tid
);

181 
	}
}

	@inorder/resources/branch_predictor.hh

32 #iâdeà
__CPU_INORDER_BRANCH_PREDICTOR_HH__


33 
	#__CPU_INORDER_BRANCH_PREDICTOR_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/´ed/b´ed_un™.hh
"

40 
	~"ıu/šÜd”/ıu.hh
"

41 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

42 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

43 
	~"ıu/šÜd”/»sourû.hh
"

45 şas 
	cB¿nchP»diùÜ
 : 
public
 
Resourû
 {

46 
public
:

47 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

49 
	mpublic
:

50 
	eCommªd
 {

51 
P»diùB¿nch
,

52 
	mUpd©eP»diùÜ


55 
	gpublic
:

56 
B¿nchP»diùÜ
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

57 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

58 
TheP–še
::
P¬ams
 *
·¿ms
);

60 
»gSts
();

62 
execu‹
(
¦Ù_num
);

64 
squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

65 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

67 
š¡G¿du©ed
(
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
);

69 
	g´Ùeùed
:

73 
BP»dUn™
 *
b¿nchP»d
;

75 
	gš¡Size
;

82 
	gSts
::
SÿÏr
 
´ediùedTak’
;

83 
	gSts
::
SÿÏr
 
´ediùedNÙTak’
;

	@inorder/resources/cache_unit.cc

32 
	~<li¡
>

33 
	~<veùÜ
>

35 
	~"¬ch/i§_Œa™s.hh
"

36 
	~"¬ch/locked_mem.hh
"

37 
	~"¬ch/ut™y.hh
"

38 
	~"cÚfig/the_i§.hh
"

39 
	~"ıu/šÜd”/»sourûs/ÿche_un™.hh
"

40 
	~"ıu/šÜd”/ıu.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

43 
	~"debug/Aùiv™y.hh
"

44 
	~"debug/AddrD•.hh
"

45 
	~"debug/InOrd”CachePÜt.hh
"

46 
	~"debug/InOrd”SÎ.hh
"

47 
	~"debug/InOrd”TLB.hh
"

48 
	~"debug/LLSC.hh
"

49 
	~"debug/RefCouÁ.hh
"

50 
	~"debug/Th»adMod–.hh
"

51 
	~"mem/»que¡.hh
"

53 
usšg
 
Çme¥aû
 
	g¡d
;

54 
usšg
 
Çme¥aû
 
	gTheISA
;

55 
usšg
 
Çme¥aû
 
	gTheP–še
;

57 #ià
TRACING_ON


58 
	g¡d
::
¡ršg


59 
	$´štMemD©a
(
ušt8_t
 *
d©a
, 
size
)

61 
¡d
::
¡ršg¡»am
 
d©aSŒ
;

62 
pos
 = 0;…o < 
size
;…os++) {

63 
	`cırštf
(
d©aSŒ
, "%02x", 
d©a
[
pos
]);

65  
d©aSŒ
.
	`¡r
();

66 
	}
}

69 
	gCacheUn™
::
CacheUn™
(
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

70 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

71 
TheP–še
::
P¬ams
 *
·¿ms
)

72 : 
Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
),

73 
ÿchePÜt
(
NULL
), 
	$ÿchePÜtBlocked
(
çl£
)

76 ià(
»s_id
 =ğ
ICache
)

77 
_b
 = 
·¿ms
->
™b
;

78 ià(
»s_id
 =ğ
DCache
)

79 
_b
 = 
·¿ms
->
dtb
;

81 
	`çl
("Unrecognized TLB‚ame…assed by user");

87 
i
=0; i < 
MaxTh»ads
; i++) {

88 
bBlocked
[
i
] = 
çl£
;

89 
bBlockSeqNum
[
i
] = 0;

91 
	}
}

93 
	gTheISA
::
TLB
*

94 
CacheUn™
::
	$b
()

96  
_b
;

98 
	}
}

101 
	gCacheUn™
::
	$š™
()

104 ià(
id
 =ğ
ICache
) {

105 
ÿchePÜt
 = &
ıu
->
	`g‘In¡PÜt
();

106 } ià(
id
 =ğ
DCache
) {

107 
ÿchePÜt
 = &
ıu
->
	`g‘D©aPÜt
();

109 
	`as£¹
(
ÿchePÜt
 !ğ
NULL
);

111 
i
 = 0; i < 
width
; i++) {

112 
»qs
[
i
] = 
Ãw
 
	`CacheReque¡
(
this
);

115 
ÿcheBlkSize
 = 
ıu
->
	`ÿcheLšeSize
();

116 
ÿcheBlkMask
 = 
ÿcheBlkSize
 - 1;

118 
	`š™SlÙs
();

119 
	}
}

122 
	gCacheUn™
::
	$g‘SlÙ
(
DynIn¡PŒ
 
š¡
)

124 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

125 ià(
bBlocked
[
tid
]) {

131 ià(!
š¡
->
	`v®idMemAddr
(è&& !š¡->
¥l™In¡
) {

132 
	`·nic
("[tid:%i][sn:%i] Mem. Addr. must be set before„equesting "

133 "ÿchacûss\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
);

136 
Ãw_¦Ù
 = 
Resourû
::
	`g‘SlÙ
(
š¡
);

137 
š¡
->
memTime
 = 
	`curTick
();

140  
Ãw_¦Ù
;

141 
	}
}

144 
	gCacheUn™
::
	$£tAddrD•’d’cy
(
DynIn¡PŒ
 
š¡
)

146 
Addr
 
»q_addr
 = 
š¡
->
	`g‘MemAddr
();

147 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

149 
addrLi¡
[
tid
].
	`push_back
(
»q_addr
);

150 
addrM­
[
tid
][
»q_addr
] = 
š¡
->
£qNum
;

152 
	`DPRINTF
(
AddrD•
,

154 
š¡
->
	`»adTid
(), in¡->
£qNum
, 
»q_addr
, 
addrLi¡
[
tid
].
	`size
());

164 
	}
}

167 
	gCacheUn™
::
	$»moveAddrD•’d’cy
(
DynIn¡PŒ
 
š¡
)

169 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

171 
Addr
 
mem_addr
 = 
š¡
->
	`g‘MemAddr
();

173 
š¡
->
	`un£tMemAddr
();

176 
¡d
::
li¡
<
Addr
>::
™”©Ü
 
li¡_™
 = 
	`fšd
(
addrLi¡
[
tid
].
	`begš
(),

177 
addrLi¡
[
tid
].
	`’d
(),

178 
mem_addr
);

179 
	`as£¹
(
li¡_™
 !ğ
addrLi¡
[
tid
].
	`’d
(è|| 
š¡
->
¥l™In¡
);

181 ià(
li¡_™
 !ğ
addrLi¡
[
tid
].
	`’d
()) {

182 
	`DPRINTF
(
AddrD•
,

184 "li¡\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
, (*
li¡_™
));

186 
addrLi¡
[
tid
].
	`”a£
(
li¡_™
);

189 
addrM­
[
tid
].
	`”a£
×ddrM­[tid].
	`fšd
(
mem_addr
));

193 
	}
}

195 
ResReqPŒ


196 
	gCacheUn™
::
	$fšdReque¡
(
DynIn¡PŒ
 
š¡
)

198 
i
 = 0; i < 
width
; i++) {

199 
CacheReque¡
* 
ÿche_»q
 =

200 
dyÇmic_ÿ¡
<
CacheReque¡
*>(
»qs
[
i
]);

201 
	`as£¹
(
ÿche_»q
);

203 ià(
ÿche_»q
->
v®id
 &&

204 
ÿche_»q
->
	`g‘In¡
(è=ğ
š¡
 &&

205 
ÿche_»q
->
š¡Idx
 =ğ
š¡
->
curSkedEÁry
->
idx
) {

206  
ÿche_»q
;

210  
NULL
;

211 
	}
}

213 
ResReqPŒ


214 
	gCacheUn™
::
	$fšdReque¡
(
DynIn¡PŒ
 
š¡
, 
idx
)

216 
i
 = 0; i < 
width
; i++) {

217 
CacheReque¡
* 
ÿche_»q
 =

218 
dyÇmic_ÿ¡
<
CacheReque¡
*>(
»qs
[
i
]);

219 
	`as£¹
(
ÿche_»q
);

221 ià(
ÿche_»q
->
v®id
 &&

222 
ÿche_»q
->
	`g‘In¡
(è=ğ
š¡
 &&

223 
ÿche_»q
->
š¡Idx
 =ğ
idx
) {

224  
ÿche_»q
;

228  
NULL
;

229 
	}
}

232 
ResReqPŒ


233 
	gCacheUn™
::
	$g‘Reque¡
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
»s_idx
,

234 
¦Ù_num
, 
cmd
)

236 
ScheduËEÁry
* 
sched_’Œy
 = *
š¡
->
curSkedEÁry
;

237 
CacheReque¡
* 
ÿche_»q
 = 
dyÇmic_ÿ¡
<CacheReque¡*>(
»qs
[
¦Ù_num
]);

239 ià(!
š¡
->
	`v®idMemAddr
()) {

240 
	`·nic
("Mem. Addr. must be set before„equesting cache‡ccess\n");

243 
MemCmd
::
Commªd
 
pkt_cmd
;

245 
sched_’Œy
->
cmd
)

247 
In™SecÚdS¶™R—d
:

248 
pkt_cmd
 = 
MemCmd
::
R—dReq
;

250 
	`DPRINTF
(
InOrd”CachePÜt
,

252 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
¥l™2ndAddr
);

255 
In™Ÿ‹R—dD©a
:

256 
pkt_cmd
 = 
MemCmd
::
R—dReq
;

258 
	`DPRINTF
(
InOrd”CachePÜt
,

260 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
	`g‘MemAddr
());

263 
In™SecÚdS¶™Wr™e
:

264 
pkt_cmd
 = 
MemCmd
::
Wr™eReq
;

266 
	`DPRINTF
(
InOrd”CachePÜt
,

268 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
¥l™2ndAddr
);

271 
In™Ÿ‹Wr™eD©a
:

272 
pkt_cmd
 = 
MemCmd
::
Wr™eReq
;

274 
	`DPRINTF
(
InOrd”CachePÜt
,

276 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
	`g‘MemAddr
());

280 
	`·nic
("%i: UÃx³ùed„eque¡y³ (%iètØ%s", 
	`curTick
(),

281 
sched_’Œy
->
cmd
, 
	`Çme
());

284 
ÿche_»q
->
	`£tReque¡
(
š¡
, 
¡age_num
, 
id
, 
¦Ù_num
,

285 
sched_’Œy
->
cmd
, 
pkt_cmd
,

286 
š¡
->
curSkedEÁry
->
idx
);

287  
ÿche_»q
;

288 
	}
}

291 
	gCacheUn™
::
	$»que¡Agaš
(
DynIn¡PŒ
 
š¡
, 
boŞ
 &
£rviû_»que¡
)

293 
CacheReqPŒ
 
ÿche_»q
 = 
dyÇmic_ÿ¡
<CacheReqPŒ>(
	`fšdReque¡
(
š¡
));

294 
	`as£¹
(
ÿche_»q
);

298 ià(
ÿche_»q
->
cmd
 !ğ
š¡
->
curSkedEÁry
->cmd &&

299 
ÿche_»q
->
š¡Idx
 =ğ
š¡
->
curSkedEÁry
->
idx
) {

301 
ÿche_»q
->
cmd
 = 
š¡
->
curSkedEÁry
->cmd;

302 
	`DPRINTF
(
InOrd”CachePÜt
,

304 "š¡ruùiÚ\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
);

306 
£rviû_»que¡
 = 
Œue
;

307 } ià(
š¡
->
curSkedEÁry
->
idx
 !ğ
CacheUn™
::
In™SecÚdS¶™R—d
 &&

308 
š¡
->
curSkedEÁry
->
idx
 !ğ
CacheUn™
::
In™SecÚdS¶™Wr™e
) {

311 
	`DPRINTF
(
InOrd”CachePÜt
,

313 
š¡
->
	`»adTid
(), in¡->
£qNum
);

315 
£rviû_»que¡
 = 
Œue
;

317 
	}
}

320 
	gCacheUn™
::
	$£tupMemReque¡
(
DynIn¡PŒ
 
š¡
, 
CacheReqPŒ
 
ÿche_»q
,

321 
acc_size
, 
æags
)

323 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

324 
Addr
 
®igÃd_addr
 = 
š¡
->
	`g‘MemAddr
();

326 ià(!
ÿche_»q
->
	`is2ndS¶™
()) {

327 ià(
ÿche_»q
->
memReq
 =ğ
NULL
) {

328 
ÿche_»q
->
memReq
 =

329 
Ãw
 
	`Reque¡
(
ıu
->
asid
[
tid
], 
®igÃd_addr
, 
acc_size
, 
æags
,

330 
ıu
->
	`d©aMa¡”Id
(),

331 
š¡
->
	`š¡Addr
(),

332 
ıu
->
	`»adCpuId
(),

333 
tid
);

336 
	`as£¹
(
š¡
->
¥l™In¡
);

338 ià(
š¡
->
¥l™MemReq
 =ğ
NULL
) {

339 
š¡
->
¥l™MemReq
 = 
Ãw
 
	`Reque¡
(
ıu
->
asid
[
tid
],

340 
š¡
->
¥l™2ndAddr
,

341 
acc_size
,

342 
æags
,

343 
ıu
->
	`d©aMa¡”Id
(),

344 
š¡
->
	`š¡Addr
(),

345 
ıu
->
	`»adCpuId
(),

346 
tid
);

349 
ÿche_»q
->
memReq
 = 
š¡
->
¥l™MemReq
;

351 
	}
}

354 
	gCacheUn™
::
doTLBAcûss
(
DynIn¡PŒ
 
š¡
, 
CacheReqPŒ
 
ÿche_»q
, 
acc_size
,

355 
æags
, 
TheISA
::
TLB
::
Mode
 
b_mode
)

357 
Th»adID
 
tid
 = 
š¡
->
»adTid
();

359 
£tupMemReque¡
(
š¡
, 
ÿche_»q
, 
acc_size
, 
æags
);

364 
Th»adCÚ‹xt
 *
	gtc
 = 
ıu
->
th»ad
[
tid
]->
g‘TC
();

365 
PCS‹
 
	gŞd_pc
 = 
tc
->
pcS‹
();

366 
	gtc
->
pcS‹
(èğ
š¡
->pcState();

368 
	gš¡
->
	gçuÉ
 =

369 
_b
->
Œª¦©eAtomic
(
ÿche_»q
->
memReq
, 
tc
, 
b_mode
);

370 
	gtc
->
pcS‹
(èğ
Şd_pc
;

372 ià(
	gš¡
->
	gçuÉ
 !ğ
NoFauÉ
) {

373 
DPRINTF
(
InOrd”TLB
, "[tid:%i]: %sƒncountered whileranslating "

374 "addr:%08°fÜ [¢:%i].\n", 
tid
, 
š¡
->
çuÉ
->
Çme
(),

375 
ÿche_»q
->
memReq
->
g‘Vaddr
(), 
š¡
->
£qNum
);

377 
	gbBlocked
[
tid
] = 
Œue
;

378 
	gbBlockSeqNum
[
tid
] = 
š¡
->
£qNum
;

382 
	gš¡
->
£tS”ŸlizeAá”
();

386 
	gÿche_»q
->
£tCom¶‘ed
();

388 
DPRINTF
(
InOrd”TLB
, "[tid:%i]: [sn:%i] virt.‡ddr %08pranslated "

389 "tØphys.‡ddr:%08p.\n", 
tid
, 
š¡
->
£qNum
,

390 
ÿche_»q
->
memReq
->
g‘Vaddr
(),

391 
ÿche_»q
->
memReq
->
g‘Paddr
());

396 
	gCacheUn™
::
	$Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
)

398 
bBlocked
[
tid
] = 
çl£
;

399 
	}
}

401 
FauÉ


402 
	gCacheUn™
::
	$»ad
(
DynIn¡PŒ
 
š¡
, 
Addr
 
addr
,

403 
ušt8_t
 *
d©a
, 
size
, 
æags
)

405 
CacheReqPŒ
 
ÿche_»q
 = 
dyÇmic_ÿ¡
<CacheReqPŒ>(
	`fšdReque¡
(
š¡
));

406 
	`as£¹
(
ÿche_»q
 && "Can't Find Instruction for Read!");

409 
blockSize
 = 
ÿcheBlkSize
;

412 
fuÎSize
 = 
size
;

413 
š¡
->
tÙ®Size
 = 
size
;

415 ià(
š¡
->
ŒaûD©a
) {

416 
š¡
->
ŒaûD©a
->
	`£tAddr
(
addr
);

419 ià(
š¡
->
¥l™2ndAcûss
) {

420 
size
 = 
š¡
->
¥l™2ndSize
;

421 
ÿche_»q
->
¥l™Acûss
 = 
Œue
;

422 
ÿche_»q
->
¥l™2ndAcûss
 = 
Œue
;

424 
	`DPRINTF
(
InOrd”CachePÜt
, "[sn:%i] Split Read Access (2 of 2) for "

425 "(%#x, %#x).\n", 
š¡
->
£qNum
, in¡->
	`g‘MemAddr
(),

426 
š¡
->
¥l™2ndAddr
);

432 
Addr
 
£cÚdAddr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
blockSize
);

435 ià(
£cÚdAddr
 > 
addr
 && !
š¡
->
¥l™2ndAcûss
) {

437 ià(!
š¡
->
¥l™In¡
) {

438 
	`DPRINTF
(
InOrd”CachePÜt
, "%i: sn[%i] Split Read Access (1 of 2) for "

439 "(%#x, %#x).\n", 
	`curTick
(), 
š¡
->
£qNum
, 
addr
, 
£cÚdAddr
);

441 
¡age_num
 = 
ÿche_»q
->
	`g‘SgeNum
();

442 
cmd
 = 
š¡
->
curSkedEÁry
->cmd;

450 
š¡
->
¥l™In¡
 = 
Œue
;

451 
š¡
->
	`£tBackSked
(
ıu
->
	`ü—‹BackEndSked
(inst));

452 
š¡
->
curSkedEÁry
 = in¡->
backSked
->
	`fšd
(
¡age_num
, 
cmd
);

454 
	`DPRINTF
(
InOrd”CachePÜt
, "[tid:%i] [sn:%i] Retrying Split Read "

455 "Acûs (1 oà2èfÜ (%#x, %#x).\n", 
š¡
->
	`»adTid
(),

456 
š¡
->
£qNum
, 
addr
, 
£cÚdAddr
);

461 
š¡
->
¥l™MemD©a
 = 
Ãw
 
ušt8_t
[
size
];

465 
size
 = 
£cÚdAddr
 - 
addr
;

466 
ÿche_»q
->
¥l™Acûss
 = 
Œue
;

470 
š¡
->
¥l™2ndSize
 = 
addr
 + 
fuÎSize
 - 
£cÚdAddr
;

471 
š¡
->
¥l™2ndAddr
 = 
£cÚdAddr
;

472 
š¡
->
¥l™2ndD©aPŒ
 = in¡->
¥l™MemD©a
 + 
size
;

473 
š¡
->
¥l™2ndFÏgs
 = 
æags
;

476 
	`doTLBAcûss
(
š¡
, 
ÿche_»q
, 
size
, 
æags
, 
TheISA
::
TLB
::
R—d
);

478 ià(
š¡
->
çuÉ
 =ğ
NoFauÉ
) {

479 ià(!
ÿche_»q
->
¥l™Acûss
) {

480 
ÿche_»q
->
»qD©a
 = 
Ãw
 
ušt8_t
[
size
];

481 
	`doCacheAcûss
(
š¡
, 
NULL
);

483 ià(!
š¡
->
¥l™2ndAcûss
) {

484 
ÿche_»q
->
»qD©a
 = 
š¡
->
¥l™MemD©a
;

486 
ÿche_»q
->
»qD©a
 = 
š¡
->
¥l™2ndD©aPŒ
;

489 
	`doCacheAcûss
(
š¡
, 
NULL
, 
ÿche_»q
);

493  
š¡
->
çuÉ
;

494 
	}
}

496 
FauÉ


497 
	gCacheUn™
::
	$wr™e
(
DynIn¡PŒ
 
š¡
, 
ušt8_t
 *
d©a
, 
size
,

498 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
wr™e_»s
)

500 
CacheReqPŒ
 
ÿche_»q
 = 
dyÇmic_ÿ¡
<CacheReqPŒ>(
	`fšdReque¡
(
š¡
));

501 
	`as£¹
(
ÿche_»q
 && "Can't Find Instruction for Write!");

504 
blockSize
 = 
ÿcheBlkSize
;

507 
fuÎSize
 = 
size
;

508 
š¡
->
tÙ®Size
 = 
size
;

510 ià(
š¡
->
ŒaûD©a
) {

511 
š¡
->
ŒaûD©a
->
	`£tAddr
(
addr
);

514 ià(
š¡
->
¥l™2ndAcûss
) {

515 
size
 = 
š¡
->
¥l™2ndSize
;

516 
ÿche_»q
->
¥l™Acûss
 = 
Œue
;

517 
ÿche_»q
->
¥l™2ndAcûss
 = 
Œue
;

519 
	`DPRINTF
(
InOrd”CachePÜt
, "[sn:%i] Split Write Access (2 of 2) for "

520 "(%#x, %#x).\n", 
š¡
->
£qNum
, in¡->
	`g‘MemAddr
(),

521 
š¡
->
¥l™2ndAddr
);

526 
Addr
 
£cÚdAddr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
blockSize
);

528 ià(
£cÚdAddr
 > 
addr
 && !
š¡
->
¥l™2ndAcûss
) {

530 
	`DPRINTF
(
InOrd”CachePÜt
, "[sn:%i] Split Write Access (1 of 2) for "

531 "(%#x, %#x).\n", 
š¡
->
£qNum
, 
addr
, 
£cÚdAddr
);

535 
š¡
->
¥l™In¡
 = 
Œue
;

537 ià(!
š¡
->
¥l™In¡Sked
) {

538 
	`as£¹
(0 && "Split Requests Not Supported for Now...");

542 
¡age_num
 = 
ÿche_»q
->
	`g‘SgeNum
();

543 
RSkedPŒ
 
š¡_sked
 = (
¡age_num
 >ğ
TheP–še
::
BackEndS¹Sge
) ?

544 
š¡
->
backSked
 : in¡->
äÚtSked
;

548 
¡age_´i
 = 20;

550 
i¥l™_cmd
 = 
CacheUn™
::
In™SecÚdS¶™Wr™e
;

551 
š¡_sked
->
	`push
(
Ãw


552 
	`ScheduËEÁry
(
¡age_num
,

553 
¡age_´i
,

554 
ıu
->
»sPoŞ
->
	`g‘ResIdx
(
DCache
),

555 
i¥l™_cmd
,

558 
c¥l™_cmd
 = 
CacheUn™
::
Com¶‘eSecÚdS¶™Wr™e
;

559 
š¡_sked
->
	`push
(
Ãw


560 
	`ScheduËEÁry
(
¡age_num
 + 1,

562 
ıu
->
»sPoŞ
->
	`g‘ResIdx
(
DCache
),

563 
c¥l™_cmd
,

565 
š¡
->
¥l™In¡Sked
 = 
Œue
;

567 
	`DPRINTF
(
InOrd”CachePÜt
, "[tid:%i] sn:%i] Retrying Split Read "

569 
š¡
->
	`»adTid
(), in¡->
£qNum
, 
addr
, 
£cÚdAddr
);

576 
size
 = 
£cÚdAddr
 - 
addr
;

577 
ÿche_»q
->
¥l™Acûss
 = 
Œue
;

581 
š¡
->
¥l™2ndSize
 = 
addr
 + 
fuÎSize
 - 
£cÚdAddr
;

582 
š¡
->
¥l™2ndAddr
 = 
£cÚdAddr
;

583 
š¡
->
¥l™2ndFÏgs
 = 
æags
;

584 
š¡
->
¥l™In¡Sked
 = 
Œue
;

587 
	`doTLBAcûss
(
š¡
, 
ÿche_»q
, 
size
, 
æags
, 
TheISA
::
TLB
::
Wr™e
);

589 ià(
š¡
->
çuÉ
 =ğ
NoFauÉ
) {

590 ià(!
ÿche_»q
->
¥l™Acûss
) {

591 
ÿche_»q
->
»qD©a
 = 
Ãw
 
ušt8_t
[
size
];

592 
	`memıy
(
ÿche_»q
->
»qD©a
, 
d©a
, 
size
);

597 
	`doCacheAcûss
(
š¡
, 
wr™e_»s
);

599 
	`doCacheAcûss
(
š¡
, 
wr™e_»s
, 
ÿche_»q
);

604  
š¡
->
çuÉ
;

605 
	}
}

609 
	gCacheUn™
::
	$execu‹
(
¦Ù_num
)

611 
CacheReqPŒ
 
ÿche_»q
 = 
dyÇmic_ÿ¡
<CacheReqPŒ>(
»qs
[
¦Ù_num
]);

612 
	`as£¹
(
ÿche_»q
);

614 ià(
ÿchePÜtBlocked
 &&

615 (
ÿche_»q
->
cmd
 =ğ
In™Ÿ‹R—dD©a
 ||

616 
ÿche_»q
->
cmd
 =ğ
In™Ÿ‹Wr™eD©a
 ||

617 
ÿche_»q
->
cmd
 =ğ
In™SecÚdS¶™R—d
 ||

618 
ÿche_»q
->
cmd
 =ğ
In™SecÚdS¶™Wr™e
)) {

619 
	`DPRINTF
(
InOrd”CachePÜt
, "Cache Port Blocked. Cannot Access\n");

620 
ÿche_»q
->
	`dÚe
(
çl£
);

624 
DynIn¡PŒ
 
š¡
 = 
ÿche_»q
->inst;

625 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

626 
	`DPRINTF
(
InOrd”CachePÜt
,

628 "Ãxˆ¡age.\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

629 
š¡
->
	`g‘MemAddr
());

630 
	`fšishCacheUn™Req
(
š¡
, 
ÿche_»q
);

634 ià(
š¡
->
	`isSquashed
()) {

635 
	`DPRINTF
(
InOrd”CachePÜt
,

637 "Ãxˆ¡age.\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
);

638 
	`fšishCacheUn™Req
(
š¡
, 
ÿche_»q
);

642 #ià
TRACING_ON


643 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

644 
¡d
::
¡ršg
 
acc_ty³
 = "write";

647 
ÿche_»q
->
cmd
)

650 
In™Ÿ‹R—dD©a
:

651 #ià
TRACING_ON


652 
acc_ty³
 = "read";

654 
In™Ÿ‹Wr™eD©a
:

655 ià(
ÿchePÜtBlocked
) {

656 
	`DPRINTF
(
InOrd”CachePÜt
, "Cache Port Blocked. Cannot Access\n");

657 
ÿche_»q
->
	`dÚe
(
çl£
);

661 
	`DPRINTF
(
InOrd”CachePÜt
,

663 "addr. %08p\n", 
tid
, 
š¡
->
£qNum
, 
acc_ty³
, 
	`Çme
(),

664 
ÿche_»q
->
š¡
->
	`g‘MemAddr
());

666 
š¡
->
	`£tCurResSlÙ
(
¦Ù_num
);

668 ià(
š¡
->
	`isD©aP»ãtch
(è|| in¡->
	`isIn¡P»ãtch
()) {

669 
š¡
->
	`execu‹
();

671 
š¡
->
	`š™Ÿ‹Acc
();

676 
In™SecÚdS¶™R—d
:

677 
	`DPRINTF
(
InOrd”CachePÜt
,

679 "fÜ‡ddr. %08p\n", 
tid
, 
š¡
->
£qNum
, 
	`Çme
(),

680 
ÿche_»q
->
š¡
->
¥l™2ndAddr
);

681 
š¡
->
¥l™2ndAcûss
 = 
Œue
;

682 
	`as£¹
(
š¡
->
¥l™2ndAddr
 != 0);

683 
	`»ad
(
š¡
, in¡->
¥l™2ndAddr
, &š¡->
¥l™2ndD©a
,

684 
š¡
->
tÙ®Size
, in¡->
¥l™2ndFÏgs
);

687 
In™SecÚdS¶™Wr™e
:

688 
	`DPRINTF
(
InOrd”CachePÜt
,

690 "fÜ‡ddr. %08p\n", 
tid
, 
š¡
->
£qNum
, 
	`Çme
(),

691 
ÿche_»q
->
š¡
->
	`g‘MemAddr
());

693 
š¡
->
¥l™2ndAcûss
 = 
Œue
;

694 
	`as£¹
(
š¡
->
¥l™2ndAddr
 != 0);

695 
	`wr™e
(
š¡
, &š¡->
¥l™2ndD©a
, in¡->
tÙ®Size
,

696 
š¡
->
¥l™2ndAddr
, in¡->
¥l™2ndFÏgs
, 
NULL
);

699 
Com¶‘eR—dD©a
:

700 
	`DPRINTF
(
InOrd”CachePÜt
,

702 
tid
, 
š¡
->
£qNum
);

706 
	`as£¹
(!
š¡
->
	`isIn¡P»ãtch
() && "Can't Handle Inst. Prefecthes");

707 ià(
ÿche_»q
->
	`isMemAccCom¶‘e
(è|| 
š¡
->
	`isD©aP»ãtch
()) {

708 
	`fšishCacheUn™Req
(
š¡
, 
ÿche_»q
);

710 
	`DPRINTF
(
InOrd”SÎ
, "STALL: [tid:%i]: Data miss from %08p\n",

711 
tid
, 
ÿche_»q
->
š¡
->
	`g‘MemAddr
());

712 
ÿche_»q
->
	`£tCom¶‘ed
(
çl£
);

713 
ÿche_»q
->
	`£tMemSÎ
(
Œue
);

717 
Com¶‘eWr™eD©a
:

719 
	`DPRINTF
(
InOrd”CachePÜt
,

721 
tid
, 
š¡
->
£qNum
);

725 
Reque¡PŒ
 
mem_»q
 = 
ÿche_»q
->
memReq
;

726 ià(
mem_»q
->
	`isCÚdSw­
(è|| mem_»q->
	`isLLSC
(è|| mem_»q->
	`isSw­
()) {

727 
	`DPRINTF
(
InOrd”CachePÜt
, "Detected Conditional Store Inst.\n");

729 ià(!
ÿche_»q
->
	`isMemAccCom¶‘e
()) {

730 
	`DPRINTF
(
InOrd”SÎ
, "STALL: [tid:%i]: Data miss from %08p\n",

731 
tid
, 
ÿche_»q
->
š¡
->
	`g‘MemAddr
());

732 
ÿche_»q
->
	`£tCom¶‘ed
(
çl£
);

733 
ÿche_»q
->
	`£tMemSÎ
(
Œue
);

736 
	`DPRINTF
(
InOrd”SÎ
, "Mem Acc Completed\n");

740 ià(
ÿche_»q
->
	`isMemAccP’dšg
()) {

741 
	`DPRINTF
(
InOrd”CachePÜt
, "Store Instruction Pending Completion.\n");

742 
ÿche_»q
->
d©aPkt
->
»qD©a
 = cache_req->reqData;

743 
ÿche_»q
->
d©aPkt
->
memReq
 = cache_req->memReq;

745 
	`DPRINTF
(
InOrd”CachePÜt
, "Store Instruction Finished Completion.\n");

748 
	`fšishCacheUn™Req
(
š¡
, 
ÿche_»q
);

752 
Com¶‘eSecÚdS¶™R—d
:

753 
	`DPRINTF
(
InOrd”CachePÜt
,

755 "Acûss\n", 
tid
, 
š¡
->
£qNum
);

758 
	`as£¹
(!
š¡
->
	`isIn¡P»ãtch
() && "Can't Handle Inst. Prefecthes");

759 ià(
ÿche_»q
->
	`isMemAccCom¶‘e
(è|| 
š¡
->
	`isD©aP»ãtch
()) {

760 
	`fšishCacheUn™Req
(
š¡
, 
ÿche_»q
);

762 
	`DPRINTF
(
InOrd”SÎ
, "STALL: [tid:%i]: Data miss from %08p\n",

763 
tid
, 
ÿche_»q
->
š¡
->
¥l™2ndAddr
);

764 
ÿche_»q
->
	`£tCom¶‘ed
(
çl£
);

765 
ÿche_»q
->
	`£tMemSÎ
(
Œue
);

769 
Com¶‘eSecÚdS¶™Wr™e
:

770 
	`DPRINTF
(
InOrd”CachePÜt
,

772 "Acûss\n", 
tid
, 
š¡
->
£qNum
);

774 
	`as£¹
(!
ÿche_»q
->
memReq
->
	`isSw­
(è&& !ÿche_»q->memReq->
	`isCÚdSw­
()

775 && !
ÿche_»q
->
memReq
->
	`isLLSC
());

777 ià(
ÿche_»q
->
	`isMemAccP’dšg
()) {

778 
ÿche_»q
->
d©aPkt
->
»qD©a
 = cache_req->reqData;

779 
ÿche_»q
->
d©aPkt
->
memReq
 = cache_req->memReq;

783 
	`fšishCacheUn™Req
(
š¡
, 
ÿche_»q
);

787 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

789 
	}
}

792 
	gCacheUn™
::
	$fšishCacheUn™Req
(
DynIn¡PŒ
 
š¡
, 
CacheReque¡
 *
ÿche_»q
)

796 
ÿche_»q
->
	`£tMemSÎ
(
çl£
);

797 
ÿche_»q
->
	`dÚe
();

798 
	}
}

801 
	gCacheUn™
::
	$budD©aPack‘
(
CacheReque¡
 *
ÿche_»q
)

804 ià(
ÿche_»q
->
memReq
->
	`isLLSC
(è&& cache_»q->
pktCmd
 =ğ
MemCmd
::
R—dReq
) {

805 
ÿche_»q
->
pktCmd
 = 
MemCmd
::
LßdLockedReq
;

808 ià(
ÿche_»q
->
pktCmd
 =ğ
MemCmd
::
Wr™eReq
) {

809 
ÿche_»q
->
pktCmd
 =

810 
ÿche_»q
->
memReq
->
	`isSw­
(è? 
MemCmd
::
Sw­Req
 :

811 (
ÿche_»q
->
memReq
->
	`isLLSC
(è? 
MemCmd
::
StÜeCÚdReq


812 : 
MemCmd
::
Wr™eReq
);

815 
ÿche_»q
->
d©aPkt
 = 
Ãw
 
	`CacheReqPack‘
(cache_req,

816 
ÿche_»q
->
pktCmd
,

817 
ÿche_»q
->
š¡Idx
);

818 
	`DPRINTF
(
InOrd”CachePÜt
, "[slot:%i]: Slot marked for %x\n",

819 
ÿche_»q
->
	`g‘SlÙ
(),

820 
ÿche_»q
->
d©aPkt
->
	`g‘Addr
());

822 
ÿche_»q
->
d©aPkt
->
hasSlÙ
 = 
Œue
;

823 
ÿche_»q
->
d©aPkt
->
	`d©aStic
(ÿche_»q->
»qD©a
);

824 
	}
}

827 
	gCacheUn™
::
	$doCacheAcûss
(
DynIn¡PŒ
 
š¡
, 
ušt64_t
 *
wr™e_»s
,

828 
CacheReqPŒ
 
¥l™_»q
)

830 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

831 #ià
TRACING_ON


832 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

834 
boŞ
 
do_acûss
 = 
Œue
;

837 
CacheReqPŒ
 
ÿche_»q
;

838 ià(
¥l™_»q
 =ğ
NULL
)

839 
ÿche_»q
 = 
dyÇmic_ÿ¡
<
CacheReqPŒ
>(
»qs
[
š¡
->
	`g‘CurResSlÙ
()]);

841 
ÿche_»q
 = 
¥l™_»q
;

842 
	`as£¹
(0);

846 
	`as£¹
(
ÿche_»q
);

847 
	`budD©aPack‘
(
ÿche_»q
);

850 
boŞ
 
is_wr™e
 = 
ÿche_»q
->
d©aPkt
->
	`isWr™e
();

851 
Reque¡PŒ
 
mem_»q
 = 
ÿche_»q
->
d©aPkt
->
»q
;

852 ià(
is_wr™e
) {

853 
	`DPRINTF
(
InOrd”CachePÜt
,

855 
tid
, 
š¡
->
£qNum
,

856 
	`´štMemD©a
(
ÿche_»q
->
d©aPkt
->
g‘PŒ
<
ušt8_t
>(),

857 
ÿche_»q
->
d©aPkt
->
	`g‘Size
()));

859 ià(
mem_»q
->
	`isCÚdSw­
()) {

860 
	`as£¹
(
wr™e_»s
);

861 
ÿche_»q
->
memReq
->
	`£tExŒaD©a
(*
wr™e_»s
);

863 ià(
mem_»q
->
	`isLLSC
()) {

864 
	`as£¹
(
ÿche_»q
->
š¡
->
	`isStÜeCÚd™iÚ®
());

865 
	`DPRINTF
(
InOrd”CachePÜt
, "Evaluating Store Conditional‡ccess\n");

866 
do_acûss
 = 
TheISA
::
	`hªdËLockedWr™e
(
š¡
.
	`g‘
(), 
mem_»q
);

871 
	`DPRINTF
(
InOrd”CachePÜt
,

873 
tid
, 
š¡
->
£qNum
, 
ÿche_»q
->
d©aPkt
->
	`g‘Addr
());

875 ià(
do_acûss
) {

876 ià(!
ÿchePÜt
->
	`£ndTimšgReq
(
ÿche_»q
->
d©aPkt
)) {

877 
	`DPRINTF
(
InOrd”CachePÜt
,

879 "i blocked.‚ow wa™šgØ»Œy„eque¡\n", 
tid
,

880 
š¡
->
£qNum
);

881 
d–‘e
 
ÿche_»q
->
d©aPkt
;

882 
ÿche_»q
->
d©aPkt
 = 
NULL
;

884 
d–‘e
 
ÿche_»q
->
memReq
;

885 
ÿche_»q
->
memReq
 = 
NULL
;

887 
ÿche_»q
->
	`dÚe
(
çl£
);

888 
ÿchePÜtBlocked
 = 
Œue
;

890 
	`DPRINTF
(
InOrd”CachePÜt
,

892 
tid
, 
š¡
->
£qNum
);

893 
ÿche_»q
->
	`£tCom¶‘ed
();

894 
ÿche_»q
->
	`£tMemAccP’dšg
();

895 
ÿchePÜtBlocked
 = 
çl£
;

897 } ià(
mem_»q
->
	`isLLSC
()){

899 
	`as£¹
(
ÿche_»q
->
š¡
->
	`isStÜeCÚd™iÚ®
());

900 
ÿche_»q
->
	`£tCom¶‘ed
(
Œue
);

902 
	`DPRINTF
(
LLSC
,

904 
tid
,id);

906 
	`´oûssCacheCom¶‘iÚ
(
ÿche_»q
->
d©aPkt
);

908 
d–‘e
 
ÿche_»q
->
d©aPkt
;

909 
ÿche_»q
->
d©aPkt
 = 
NULL
;

911 
d–‘e
 
ÿche_»q
->
memReq
;

912 
ÿche_»q
->
memReq
 = 
NULL
;

916 
	`DPRINTF
(
InOrd”SÎ
, "STALL: \n");

917 
ÿche_»q
->
	`dÚe
(
çl£
);

920 
	}
}

922 
boŞ


923 
	gCacheUn™
::
	$´oûssSquash
(
CacheReqPack‘
 *
ÿche_pkt
)

930 ià(!
ÿche_pkt
->
hasSlÙ
) {

931 
	`DPRINTF
(
InOrd”CachePÜt
,

933 
ÿche_pkt
->
	`g‘Addr
());

935 ià(
ÿche_pkt
->
»qD©a
) {

936 
d–‘e
 [] 
ÿche_pkt
->
»qD©a
;

937 
ÿche_pkt
->
»qD©a
 = 
NULL
;

940 ià(
ÿche_pkt
->
memReq
) {

941 
d–‘e
 
ÿche_pkt
->
memReq
;

942 
ÿche_pkt
->
memReq
 = 
NULL
;

945 
d–‘e
 
ÿche_pkt
;

946 
ÿche_pkt
 = 
NULL
;

947 
ıu
->
	`wakeCPU
();

948  
Œue
;

950 
	`DPRINTF
(
InOrd”CachePÜt
, "%x has slot %i\n",

951 
ÿche_pkt
->
	`g‘Addr
(), cache_pkt->
ÿcheReq
->
	`g‘SlÙ
());

960 ià(
ÿche_pkt
->
ÿcheReq
->
	`isSquashed
()) {

961 
	`DPRINTF
(
InOrd”CachePÜt
,

963 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
	`»adTid
(),

964 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
£qNum
);

966 
ÿche_pkt
->
ÿcheReq
->
	`£tMemAccP’dšg
(
çl£
);

967 
ÿche_pkt
->
ÿcheReq
->
	`ä“SlÙ
();

968 
d–‘e
 
ÿche_pkt
;

969 
ÿche_pkt
 = 
NULL
;

970 
ıu
->
	`wakeCPU
();

971  
Œue
;

975  
çl£
;

976 
	}
}

979 
	gCacheUn™
::
	$´oûssCacheCom¶‘iÚ
(
Pack‘PŒ
 
pkt
)

983 
CacheReqPack‘
* 
ÿche_pkt
 = 
dyÇmic_ÿ¡
<CacheReqPack‘*>(
pkt
);

984 
	`as£¹
(
ÿche_pkt
);

986 
	`DPRINTF
(
InOrd”CachePÜt
, "Fšished„eque¡ fÜ %x\n", 
pkt
->
	`g‘Addr
());

988 ià(
	`´oûssSquash
(
ÿche_pkt
))

991 
CacheReque¡
 *
ÿche_»q
 = 
dyÇmic_ÿ¡
<
CacheReqPŒ
>(

992 
	`fšdReque¡
(
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
(), cache_pkt->
š¡Idx
));

994 ià(!
ÿche_»q
) {

995 
	`·nic
("[tid:%u]: [sn:%i]: Can't find slot for cache‡ccesso "

996 "addr. %08p\n", 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
	`»adTid
(),

997 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
£qNum
,

998 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
	`g‘MemAddr
());

1001 
	`as£¹
(
ÿche_»q
);

1002 
	`as£¹
(
ÿche_»q
 =ğ
ÿche_pkt
->
ÿcheReq
);

1004 
	`DPRINTF
(
InOrd”CachePÜt
,

1006 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
	`»adTid
(),

1007 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
£qNum
,

1008 
ÿche_»q
->
	`g‘SlÙ
(),

1009 
ÿche_pkt
->
»q
->
	`g‘Vaddr
(),

1010 
ÿche_pkt
->
»q
->
	`g‘Paddr
());

1013 
¡age_num
 = 
ÿche_»q
->
	`g‘SgeNum
();

1014 
DynIn¡PŒ
 
š¡
 = 
ÿche_»q
->inst;

1015 
Th»adID
 
tid
 = 
ÿche_»q
->
š¡
->
	`»adTid
();

1017 
	`as£¹
(!
ÿche_»q
->
	`isSquashed
());

1018 
	`as£¹
(
š¡
->
¡©icIn¡
 && in¡->
	`isMemRef
());

1021 
	`DPRINTF
(
InOrd”CachePÜt
,

1023 
tid
, 
š¡
->
£qNum
);

1025 
Pack‘PŒ
 
¥l™_pkt
 = 
NULL
;

1026 ià(
š¡
->
¥l™In¡
) {

1027 
š¡
->
¥l™FšishCÁ
++;

1029 ià(
š¡
->
¥l™FšishCÁ
 == 2) {

1030 
ÿche_»q
->
memReq
->
	`£tVœt
(0 ,

1031 
š¡
->
	`g‘MemAddr
(),

1032 
š¡
->
tÙ®Size
,

1034 
ıu
->
	`d©aMa¡”Id
(),

1037 
¥l™_pkt
 = 
Ãw
 
	`Pack‘
(
ÿche_»q
->
memReq
, cache_»q->
pktCmd
);

1038 
¥l™_pkt
->
	`d©aStic
(
š¡
->
¥l™MemD©a
);

1040 
	`DPRINTF
(
InOrd”CachePÜt
, "Completing Split Access.\n");

1041 
š¡
->
	`com¶‘eAcc
(
¥l™_pkt
);

1044 
š¡
->
	`com¶‘eAcc
(
ÿche_pkt
);

1047 
š¡
->
	`£tExecu‹d
();

1049 ià(
š¡
->
	`isLßd
()) {

1050 
	`as£¹
(
ÿche_pkt
->
	`isR—d
());

1052 ià(
ÿche_pkt
->
»q
->
	`isLLSC
()) {

1053 
	`DPRINTF
(
InOrd”CachePÜt
,

1055 
tid
, 
š¡
->
£qNum
);

1056 
TheISA
::
	`hªdËLockedR—d
(
š¡
.
	`g‘
(), 
ÿche_pkt
->
»q
);

1059 
	`DPRINTF
(
InOrd”CachePÜt
,

1061 
tid
, 
š¡
->
£qNum
,

1062 (
¥l™_pkt
è? 
	`´štMemD©a
(¥l™_pkt->
g‘PŒ
<
ušt8_t
>(),

1063 
¥l™_pkt
->
	`g‘Size
()) :

1064 
	`´štMemD©a
(
ÿche_pkt
->
g‘PŒ
<
ušt8_t
>(),

1065 
ÿche_pkt
->
	`g‘Size
()));

1066 } if(
š¡
->
	`isStÜe
()) {

1067 
	`as£¹
(
ÿche_pkt
->
	`isWr™e
());

1069 
	`DPRINTF
(
InOrd”CachePÜt
,

1071 
tid
, 
š¡
->
£qNum
,

1072 (
¥l™_pkt
è? 
	`´štMemD©a
(¥l™_pkt->
g‘PŒ
<
ušt8_t
>(),

1073 
¥l™_pkt
->
	`g‘Size
()) :

1074 
	`´štMemD©a
(
ÿche_pkt
->
g‘PŒ
<
ušt8_t
>(),

1075 
ÿche_pkt
->
	`g‘Size
()));

1079 ià(
¥l™_pkt
) {

1080 
d–‘e
 
¥l™_pkt
;

1081 
¥l™_pkt
 = 
NULL
;

1084 
ÿche_»q
->
	`£tMemAccP’dšg
(
çl£
);

1085 
ÿche_»q
->
	`£tMemAccCom¶‘ed
();

1087 ià(
ÿche_»q
->
	`isMemSÎ
() &&

1088 
ıu
->
th»adMod–
 =ğ
InOrd”CPU
::
Sw™chOnCacheMiss
) {

1089 
	`DPRINTF
(
InOrd”CachePÜt
, "[tid:%u] Waking up from Cache Miss.\n",

1090 
tid
);

1092 
ıu
->
	`aùiv©eCÚ‹xt
(
tid
);

1094 
	`DPRINTF
(
Th»adMod–
, "Activating [tid:%i]‡fter„eturn from cache"

1095 "miss.\n", 
tid
);

1100 
ıu
->
	`wakeCPU
();

1102 
	`DPRINTF
(
Aùiv™y
, "[tid:%u] Activating %s dueo cache completion\n",

1103 
tid
, 
ıu
->
p–šeSge
[
¡age_num
]->
	`Çme
());

1105 
ıu
->
	`sw™chToAùive
(
¡age_num
);

1106 
	}
}

1109 
	gCacheUn™
::
	$»cvR‘ry
()

1111 
	`DPRINTF
(
InOrd”CachePÜt
, "Unblocking Cache Port. \n");

1113 
	`as£¹
(
ÿchePÜtBlocked
);

1116 
ÿchePÜtBlocked
 = 
çl£
;

1118 
ıu
->
	`wakeCPU
();

1119 
	}
}

1121 
	gCacheUn™Ev’t
::
	$CacheUn™Ev’t
()

1122 : 
	$ResourûEv’t
()

1123 { 
	}
}

1126 
CacheUn™Ev’t
::
	$´oûss
()

1128 
DynIn¡PŒ
 
š¡
 = 
»sourû
->
»qs
[
¦ÙIdx
]->inst;

1129 
¡age_num
 = 
»sourû
->
»qs
[
¦ÙIdx
]->
	`g‘SgeNum
();

1130 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1131 
CacheReqPŒ
 
»q_±r
 = 
dyÇmic_ÿ¡
<CacheReqPŒ>(
»sourû
->
»qs
[
¦ÙIdx
]);

1133 
	`DPRINTF
(
InOrd”TLB
, "Waking up from TLB Miss caused by [sn:%i].\n",

1134 
š¡
->
£qNum
);

1136 
CacheUn™
* 
b_»s
 = 
dyÇmic_ÿ¡
<CacheUn™*>(
»sourû
);

1137 
	`as£¹
(
b_»s
);

1141 
	`DPRINTF
(
InOrd”TLB
, "Hªdlšg FauÉ % : [¢:%i] %x\n", 
š¡
->
çuÉ
->
	`Çme
(), in¡->
£qNum
, in¡->
	`g‘MemAddr
());

1142 
š¡
->
çuÉ
->
	`švoke
(
b_»s
->
ıu
->
	`tcBa£
(
tid
), in¡->
¡©icIn¡
);

1144 
b_»s
->
bBlocked
[
tid
] = 
çl£
;

1146 
b_»s
->
ıu
->
p–šeSge
[
¡age_num
]->

1147 
	`un£tResSÎ
(
b_»s
->
»qs
[
¦ÙIdx
], 
tid
);

1149 
»q_±r
->
bSÎ
 = 
çl£
;

1155 ià(
»q_±r
->
	`isSquashed
()) {

1156 
»q_±r
->
	`ä“SlÙ
();

1159 
b_»s
->
ıu
->
	`wakeCPU
();

1160 
	}
}

1163 
	gCacheUn™
::
	$squashDueToMemSÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

1164 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

1175 
	`DPRINTF
(
InOrd”CachePÜt
, "Squashing‡bove [sn:%u]\n",

1176 
squash_£q_num
 + 1);

1178 
	`squash
(
š¡
, 
¡age_num
, 
squash_£q_num
 + 1, 
tid
);

1179 
	}
}

1182 
	gCacheUn™
::
	$squashCacheReque¡
(
CacheReqPŒ
 
»q_±r
)

1184 
DynIn¡PŒ
 
š¡
 = 
»q_±r
->
	`g‘In¡
();

1185 
»q_±r
->
	`£tSquashed
();

1186 
š¡
->
	`£tSquashed
();

1198 
	}
}

1202 
	gCacheUn™
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

1203 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

1205 ià(
bBlocked
[
tid
] &&

1206 
bBlockSeqNum
[
tid
] > 
squash_£q_num
) {

1207 
	`DPRINTF
(
InOrd”CachePÜt
, "Releasing TLB Block dueo "

1208 " squash‡á” [¢:%i].\n", 
squash_£q_num
);

1209 
bBlocked
[
tid
] = 
çl£
;

1212 
i
 = 0; i < 
width
; i++) {

1213 
ResReqPŒ
 
»q_±r
 = 
»qs
[
i
];

1215 ià(
»q_±r
->
v®id
 &&

1216 
»q_±r
->
	`g‘In¡
()->
	`»adTid
(è=ğ
tid
 &&

1217 
»q_±r
->
	`g‘In¡
()->
£qNum
 > 
squash_£q_num
) {

1219 
	`DPRINTF
(
InOrd”CachePÜt
,

1221 
»q_±r
->
	`g‘In¡
()->
	`»adTid
(),„eq_±r->g‘In¡()->
£qNum
);

1223 ià(
»q_±r
->
	`isSquashed
()) {

1224 
	`DPRINTF
(
AddrD•
, "Request for [tid:%i] [sn:%i]‡lready "

1226 
»q_±r
->
	`g‘In¡
()->
	`»adTid
(),

1227 
»q_±r
->
	`g‘In¡
()->
£qNum
);

1231 
CacheReqPŒ
 
ÿche_»q
 = 
dyÇmic_ÿ¡
<CacheReqPŒ>(
»q_±r
);

1232 
	`as£¹
(
ÿche_»q
);

1234 
	`squashCacheReque¡
(
ÿche_»q
);

1236 
»q_¦Ù_num
 = 
»q_±r
->
	`g‘SlÙ
();

1238 ià(
ÿche_»q
->
bSÎ
) {

1239 
bBlocked
[
tid
] = 
çl£
;

1241 
¡®l_¡age
 = 
»qs
[
»q_¦Ù_num
]->
	`g‘SgeNum
();

1243 
ıu
->
p–šeSge
[
¡®l_¡age
]->

1244 
	`un£tResSÎ
(
»qs
[
»q_¦Ù_num
], 
tid
);

1247 ià(
ÿche_»q
->
	`isMemAccP’dšg
()) {

1248 
ÿche_»q
->
d©aPkt
->
»qD©a
 = cache_req->reqData;

1249 
ÿche_»q
->
d©aPkt
->
memReq
 = cache_req->memReq;

1252 ià(!
ÿche_»q
->
bSÎ
)

1253 
	`ä“SlÙ
(
»q_¦Ù_num
);

1257 
	}
}

1260 
	gCacheReque¡
::
	$ş—rReque¡
()

1262 ià(!
memAccP’dšg
) {

1263 ià(
»qD©a
 && !
¥l™Acûss
)

1264 
d–‘e
 [] 
»qD©a
;

1266 ià(
memReq
)

1267 
d–‘e
 
memReq
;

1269 ià(
d©aPkt
)

1270 
d–‘e
 
d©aPkt
;

1272 ià(
d©aPkt
)

1273 
d©aPkt
->
hasSlÙ
 = 
çl£
;

1276 
memReq
 = 
NULL
;

1277 
»qD©a
 = 
NULL
;

1278 
d©aPkt
 = 
NULL
;

1279 
memAccCom¶‘e
 = 
çl£
;

1280 
memAccP’dšg
 = 
çl£
;

1281 
bSÎ
 = 
çl£
;

1282 
¥l™Acûss
 = 
çl£
;

1283 
¥l™AcûssNum
 = -1;

1284 
¥l™2ndAcûss
 = 
çl£
;

1285 
š¡Idx
 = 0;

1286 
ãtchBufãrFl
 = 
çl£
;

1288 
ResourûReque¡
::
	`ş—rReque¡
();

1289 
	}
}

	@inorder/resources/cache_unit.hh

32 #iâdeà
__CPU_INORDER_CACHE_UNIT_HH__


33 
	#__CPU_INORDER_CACHE_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"¬ch/b.hh
"

40 
	~"ba£/hashm­.hh
"

41 
	~"cÚfig/the_i§.hh
"

42 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

43 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

44 
	~"ıu/šÜd”/»sourû.hh
"

45 
	~"mem/·ck‘.hh
"

46 
	~"mem/·ck‘_acûss.hh
"

47 
	~"mem/pÜt.hh
"

48 
	~"·¿ms/InOrd”CPU.hh
"

49 
	~"sim/sim_objeù.hh
"

51 
şass
 
	gCacheReqPack‘
;

52 
CacheReqPack‘
* 
	tCacheReqPktPŒ
;

54 şas 
	cCacheUn™
 : 
public
 
Resourû


56 
public
:

57 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

59 
	mpublic
:

60 
CacheUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

61 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

62 
TheP–še
::
P¬ams
 *
·¿ms
);

64 
	eCommªd
 {

65 
	mIn™Ÿ‹R—dD©a
,

66 
	mCom¶‘eR—dD©a
,

67 
	mIn™Ÿ‹Wr™eD©a
,

68 
	mCom¶‘eWr™eD©a
,

69 
	mIn™SecÚdS¶™R—d
,

70 
	mIn™SecÚdS¶™Wr™e
,

71 
	mCom¶‘eSecÚdS¶™R—d
,

72 
	mCom¶‘eSecÚdS¶™Wr™e


75 
	gpublic
:

77 
š™
();

79 
ResourûReque¡
* 
g‘Reque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
,

80 
»s_idx
, 
¦Ù_num
,

81 
cmd
);

83 
ResReqPŒ
 
fšdReque¡
(
DynIn¡PŒ
 
š¡
);

84 
ResReqPŒ
 
fšdReque¡
(
DynIn¡PŒ
 
š¡
, 
idx
);

86 
»que¡Agaš
(
DynIn¡PŒ
 
š¡
, 
boŞ
 &
Œy_»que¡
);

88 
vœtu®
 
g‘SlÙ
(
DynIn¡PŒ
 
š¡
);

91 
vœtu®
 
execu‹
(
¦Ù_num
);

93 
vœtu®
 
squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

94 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

96 
squashDueToMemSÎ
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

97 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

99 
vœtu®
 
squashCacheReque¡
(
CacheReqPŒ
 
»q_±r
);

104 
vœtu®
 
´oûssCacheCom¶‘iÚ
(
Pack‘PŒ
 
pkt
);

107 
vœtu®
 
£tupMemReque¡
(
DynIn¡PŒ
 
š¡
, 
CacheReqPŒ
 
ÿche_»q
,

108 
acc_size
, 
æags
);

110 
fšishCacheUn™Req
(
DynIn¡PŒ
 
š¡
, 
CacheReque¡
 *
ÿche_»q
);

112 
budD©aPack‘
(
CacheReque¡
 *
ÿche_»q
);

114 
boŞ
 
´oûssSquash
(
CacheReqPack‘
 *
ÿche_pkt
);

116 
Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
);

118 
»cvR‘ry
();

120 
FauÉ
 
»ad
(
DynIn¡PŒ
 
š¡
, 
Addr
 
addr
,

121 
ušt8_t
 *
d©a
, 
size
, 
æags
);

123 
FauÉ
 
wr™e
(
DynIn¡PŒ
 
š¡
, 
ušt8_t
 *
d©a
, 
size
,

124 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

126 
doTLBAcûss
(
DynIn¡PŒ
 
š¡
, 
CacheReqPŒ
 
ÿche_»q
, 
acc_size
,

127 
æags
, 
TheISA
::
TLB
::
Mode
 
b_mode
);

132 
doCacheAcûss
(
DynIn¡PŒ
 
š¡
, 
ušt64_t
 *
wr™e_»suÉ
=
NULL
,

133 
CacheReqPŒ
 
¥l™_»q
=
NULL
);

135 
ušt64_t
 
g‘MemD©a
(
Pack‘
 *
·ck‘
);

137 
£tAddrD•’d’cy
(
DynIn¡PŒ
 
š¡
);

138 
vœtu®
 
»moveAddrD•’d’cy
(
DynIn¡PŒ
 
š¡
);

140 
	g´Ùeùed
:

142 
Ma¡”PÜt
 *
ÿchePÜt
;

144 
boŞ
 
	gÿchePÜtBlocked
;

146 
	g¡d
::
li¡
<
Addr
> 
addrLi¡
[
TheP–še
::
MaxTh»ads
];

148 
	gm5
::
hash_m­
<
Addr
, 
	gIn¡SeqNum
> 
	gaddrM­
[
TheP–še
::
MaxTh»ads
];

150 
	gpublic
:

151 
ÿcheBlkSize
;

153 
	gÿcheBlkMask
;

156 
Addr
 
	$ÿcheBlockAlign
(
Addr
 
addr
)

158  (
addr
 & ~(
ÿcheBlkMask
));

159 
	}
}

161 
boŞ
 
	gbBlocked
[
TheP–še
::
MaxTh»ads
];

162 
In¡SeqNum
 
	gbBlockSeqNum
[
TheP–še
::
MaxTh»ads
];

164 
	gTheISA
::
TLB
* 
b
();

165 
	gTheISA
::
TLB
 *
_b
;

168 şas 
	cCacheUn™Ev’t
 : 
public
 
ResourûEv’t
 {

169 
public
:

170 cÚ¡ 
¡d
::
¡ršg
 
	$Çme
() const

177 
	`CacheUn™Ev’t
();

178 
vœtu®
 ~
	$CacheUn™Ev’t
(è{
	}
}

181 
´oûss
();

185 şas 
	cCacheReque¡
 : 
public
 
ResourûReque¡


187 
public
:

188 
	$CacheReque¡
(
CacheUn™
 *
ües
)

189 : 
	`ResourûReque¡
(
ües
), 
	`memReq
(
NULL
), 
	`»qD©a
(NULL),

190 
	`d©aPkt
(
NULL
), 
	`memAccCom¶‘e
(
çl£
),

191 
	`memAccP’dšg
(
çl£
), 
	`bSÎ
(çl£), 
	`¥l™Acûss
(false),

192 
	`¥l™AcûssNum
(-1), 
	`¥l™2ndAcûss
(
çl£
),

193 
	$ãtchBufãrFl
(
çl£
)

196 
vœtu®
 ~
	$CacheReque¡
()

198 ià(
»qD©a
 && !
¥l™Acûss
)

199 
d–‘e
 [] 
»qD©a
;

200 
	}
}

202 
£tReque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
, 
»s_idx
, 
¦Ù_num
,

203 
_cmd
, 
MemCmd
::
Commªd
 
pkt_cmd
, 
idx
)

205 
	gpktCmd
 = 
pkt_cmd
;

206 
	gš¡Idx
 = 
idx
;

208 
	gResourûReque¡
::
£tReque¡
(
_š¡
, 
¡age_num
, 
»s_idx
, 
¦Ù_num
, 
_cmd
);

211 
ş—rReque¡
();

213 
vœtu®
 
Pack‘D©aPŒ
 
	$g‘D©a
()

214 {  
»qD©a
; 
	}
}

217 
	$£tMemAccCom¶‘ed
(
boŞ
 
com¶‘ed
 = 
Œue
)

219 
memAccCom¶‘e
 = 
com¶‘ed
;

220 
	}
}

222 
boŞ
 
	$is2ndS¶™
()

224  
¥l™2ndAcûss
;

225 
	}
}

227 
boŞ
 
	$isMemAccCom¶‘e
(è{  
memAccCom¶‘e
; 
	}
}

229 
	$£tMemAccP’dšg
(
boŞ
 
³ndšg
 = 
Œue
è{ 
memAccP’dšg
 =…’dšg; 
	}
}

230 
boŞ
 
	$isMemAccP’dšg
(è{  
memAccP’dšg
; 
	}
}

233 
	gMemCmd
::
Commªd
 
pktCmd
;

234 
Reque¡PŒ
 
	gmemReq
;

235 
Pack‘D©aPŒ
 
	g»qD©a
;

236 
CacheReqPack‘
 *
	gd©aPkt
;

238 
boŞ
 
	gmemAccCom¶‘e
;

239 
boŞ
 
	gmemAccP’dšg
;

240 
boŞ
 
	gbSÎ
;

242 
boŞ
 
	g¥l™Acûss
;

243 
	g¥l™AcûssNum
;

244 
boŞ
 
	g¥l™2ndAcûss
;

245 
	gš¡Idx
;

248 
boŞ
 
	gãtchBufãrFl
;

251 şas 
	cCacheReqPack‘
 : 
public
 
Pack‘


253 
public
:

254 
	$CacheReqPack‘
(
CacheReque¡
 *
_»q
,

255 
Commªd
 
_cmd
, 
_idx
 = 0)

256 : 
	`Pack‘
(&(*
_»q
->
memReq
), 
_cmd
), 
	`ÿcheReq
(_req),

257 
	`š¡Idx
(
_idx
), 
	`hasSlÙ
(
çl£
), 
	`»qD©a
(
NULL
), 
	$memReq
(
NULL
)

262 
CacheReque¡
 *
ÿcheReq
;

263 
š¡Idx
;

264 
boŞ
 
hasSlÙ
;

265 
Pack‘D©aPŒ
 
»qD©a
;

266 
Reque¡PŒ
 
memReq
;

267 
	}
};

	@inorder/resources/decode_unit.cc

32 
	~"cÚfig/the_i§.hh
"

33 
	~"ıu/šÜd”/»sourûs/decode_un™.hh
"

34 
	~"debug/InOrd”Decode.hh
"

35 
	~"debug/InOrd”SÎ.hh
"

36 
	~"debug/Resourû.hh
"

38 
usšg
 
Çme¥aû
 
	gTheISA
;

39 
usšg
 
Çme¥aû
 
	gTheP–še
;

40 
usšg
 
Çme¥aû
 
	g¡d
;

42 
	gDecodeUn™
::
DecodeUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

43 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

44 
TheP–še
::
P¬ams
 *
·¿ms
)

45 : 
	$Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
)

47 
Th»adID
 
tid
 = 0;id < 
MaxTh»ads
;id++) {

48 
»gD•M­
[
tid
] = &
ıu
->
¬chRegD•M­
[tid];

50 
	}
}

53 
	gDecodeUn™
::
	$execu‹
(
¦Ù_num
)

55 
ResourûReque¡
* 
decode_»q
 = 
»qs
[
¦Ù_num
];

56 
DynIn¡PŒ
 
š¡
 = 
»qs
[
¦Ù_num
]->inst;

58 
decode_»q
->
cmd
)

60 
DecodeIn¡
:

63 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

64 
š¡
->
	`£tBackSked
(
ıu
->
çuÉSked
);

65 
	`DPRINTF
(
InOrd”Decode
,"[tid:%i]: Fault found for instruction [sn:%i]\n",

66 
š¡
->
	`»adTid
(), in¡->
£qNum
);

68 
	`as£¹
(!
š¡
->
¡©icIn¡
->
	`isMaüoİ
());

69 
š¡
->
	`£tBackSked
(
ıu
->
	`ü—‹BackEndSked
(inst));

70 
	`DPRINTF
(
InOrd”Decode
,"Decoded instruction [sn:%i]: %s : 0x%x\n",

71 
š¡
->
£qNum
, in¡->
	`š¡Name
(),

72 
š¡
->
¡©icIn¡
->
machIn¡
);

75 ià(
š¡
->
backSked
 !ğ
NULL
) {

76 
	`DPRINTF
(
InOrd”Decode
,

78 
š¡
->
	`»adTid
(), in¡->
	`š¡Name
(), in¡->
£qNum
);

79 
decode_»q
->
	`dÚe
();

81 
	`DPRINTF
(
Resourû
,

83 
š¡
->
	`»adTid
());

84 
	`DPRINTF
(
Resourû
,

86 
š¡
->
£qNum
);

87 
	`DPRINTF
(
InOrd”SÎ
, "STALL: \n");

88 
decode_»q
->
	`dÚe
(
çl£
);

94 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

96 
	}
}

	@inorder/resources/decode_unit.hh

32 #iâdeà
__CPU_INORDER_DECODE_UNIT_HH__


33 
	#__CPU_INORDER_DECODE_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/šÜd”/ıu.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/šÜd”/»g_d•_m­.hh
"

43 
	~"ıu/šÜd”/»sourû.hh
"

45 şas 
	cDecodeUn™
 : 
public
 
Resourû
 {

46 
public
:

47 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

49 
	mpublic
:

50 
DecodeUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

51 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

52 
TheP–še
::
P¬ams
 *
·¿ms
);

54 
	eCommªd
 {

55 
	mDecodeIn¡


58 
execu‹
(
¦Ù_num
);

60 
RegD•M­
 *
	g»gD•M­
[
TheP–še
::
MaxTh»ads
];

62 
	g´Ùeùed
:

	@inorder/resources/execution_unit.cc

32 
	~<li¡
>

33 
	~<veùÜ
>

35 
	~"ıu/šÜd”/»sourûs/executiÚ_un™.hh
"

36 
	~"ıu/šÜd”/ıu.hh
"

37 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

38 
	~"debug/FauÉ.hh
"

39 
	~"debug/InOrd”Execu‹.hh
"

40 
	~"debug/InOrd”SÎ.hh
"

41 
	~"sim/fuÎ_sy¡em.hh
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

44 
usšg
 
Çme¥aû
 
	gTheP–še
;

46 
	gExecutiÚUn™
::
ExecutiÚUn™
(
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

47 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

48 
TheP–še
::
P¬ams
 *
·¿ms
)

49 : 
Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
),

50 
Ï¡Execu‹Tick
(0), 
	$Ï¡CÚŒŞTick
(0)

51 { 
	}
}

54 
	gExecutiÚUn™
::
	$»gSts
()

56 
´ediùedTak’IncÜ»ù


57 .
	`Çme
(name() + ".predictedTakenIncorrect")

58 .
	`desc
("Number of Branches Incorrectly Predicted As Taken.");

60 
´ediùedNÙTak’IncÜ»ù


61 .
	`Çme
(name() + ".predictedNotTakenIncorrect")

62 .
	`desc
("Number of Branches Incorrectly Predicted As Not Taken).");

64 
executiÚs


65 .
	`Çme
(name() + ".executions")

66 .
	`desc
("Number of Instructions Executed.");

69 
´ediùedIncÜ»ù


70 .
	`Çme
(name() + ".mispredicted")

71 .
	`desc
("Number of Branches Incorrectly Predicted");

73 
´ediùedCÜ»ù


74 .
	`Çme
(name() + ".predicted")

75 .
	`desc
("Number of Branches Incorrectly Predicted");

77 
mi¥»diùPù


78 .
	`Çme
(name() + ".mispredictPct")

79 .
	`desc
("Percentage of Incorrect Branches Predicts")

80 .
	`´ecisiÚ
(6);

81 
mi¥»diùPù
 = (
´ediùedIncÜ»ù
 /

82 (
´ediùedCÜ»ù
 + 
´ediùedIncÜ»ù
)) * 100;

84 
Resourû
::
	`»gSts
();

85 
	}
}

88 
	gExecutiÚUn™
::
	$execu‹
(
¦Ù_num
)

90 
ResourûReque¡
* 
exec_»q
 = 
»qs
[
¦Ù_num
];

91 
DynIn¡PŒ
 
š¡
 = 
»qs
[
¦Ù_num
]->inst;

92 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

93 
	`DPRINTF
(
InOrd”Execu‹
,

95 "Ãxˆ¡age.\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

96 
š¡
->
	`pcS‹
());

97 
exec_»q
->
	`dÚe
();

101 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

102 
Tick
 
cur_tick
 = 
	`curTick
();

103 
¡age_num
 = 
exec_»q
->
	`g‘SgeNum
();

104 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

105 #ià
TRACING_ON


106 
In¡SeqNum
 
£q_num
 = 
š¡
->
£qNum
;

109 
exec_»q
->
cmd
)

111 
Execu‹In¡
:

113 ià(
š¡
->
	`isNİ
()) {

114 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i] [sn:%i] [PC:%s] Ignoringƒxecution"

115 "oà%s.\n", 
š¡
->
	`»adTid
(), 
£q_num
, in¡->
	`pcS‹
(),

116 
š¡
->
	`š¡Name
());

117 
š¡
->
	`£tExecu‹d
();

118 
exec_»q
->
	`dÚe
();

121 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i] Executing [sn:%i] [PC:%s] %s.\n",

122 
š¡
->
	`»adTid
(), 
£q_num
, in¡->
	`pcS‹
(), in¡->
	`š¡Name
());

125 ià(
cur_tick
 !ğ
Ï¡Execu‹Tick
) {

126 
Ï¡Execu‹Tick
 = 
cur_tick
;

130 
	`as£¹
(!
š¡
->
	`isMemRef
());

132 ià(
š¡
->
	`isCÚŒŞ
()) {

133 ià(
Ï¡CÚŒŞTick
 =ğ
cur_tick
) {

134 
	`DPRINTF
(
InOrd”Execu‹
, "Can‚ot Execute Morehan One Control "

136 
exec_»q
->
	`dÚe
(
çl£
);

139 
Ï¡CÚŒŞTick
 = 
	`curTick
();

142 
çuÉ
 = 
š¡
->
	`execu‹
();

146 
executiÚs
++;

148 ià(
çuÉ
 =ğ
NoFauÉ
) {

149 
š¡
->
	`£tExecu‹d
();

151 ià(
š¡
->
	`mi¥»diùed
()) {

152 
	`as£¹
(
š¡
->
	`isCÚŒŞ
());

155 
TheISA
::
PCS‹
 
pc
 = 
š¡
->
	`pcS‹
();

156 
TheISA
::
	`advªûPC
(
pc
, 
š¡
->
¡©icIn¡
);

157 
š¡
->
	`£tP»dT¬g
(
pc
);

158 
š¡
->
	`£tSquashInfo
(
¡age_num
);

159 
	`£tupSquash
(
š¡
, 
¡age_num
, 
tid
);

161 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i]: [sn:%i] Squashing from "

162 "¡ag%i. Redœeùšg f‘chØ%s.\n", 
tid
,

163 
š¡
->
£qNum
, 
¡age_num
, 
pc
);

164 
	`DPRINTF
(
InOrd”SÎ
, "STALL: [tid:%i]: Branch"

165 " mi¥»diùiÚ‡ˆ%s\n", 
tid
, 
š¡
->
	`pcS‹
());

167 ià(
š¡
->
	`´edTak’
()) {

168 
´ediùedTak’IncÜ»ù
++;

169 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i] [sn:%i] %s ..."

172 
tid
, 
š¡
->
£qNum
,

173 
š¡
->
¡©icIn¡
->
	`di§s£mbË
(

174 
š¡
->
	`š¡Addr
()),

175 
š¡
->
	`pcS‹
());

177 
´ediùedNÙTak’IncÜ»ù
++;

178 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i] [sn:%i] %s ..."

181 
tid
, 
š¡
->
£qNum
,

182 
š¡
->
¡©icIn¡
->
	`di§s£mbË
(

183 
š¡
->
	`š¡Addr
()),

184 
š¡
->
	`pcS‹
());

186 
´ediùedIncÜ»ù
++;

188 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i]: [sn:%i]: Prediction"

189 "CÜ»ù.\n", 
š¡
->
	`»adTid
(), 
£q_num
);

190 
´ediùedCÜ»ù
++;

193 
exec_»q
->
	`dÚe
();

195 
	`DPRINTF
(
FauÉ
, "[tid:%i]:[sn:%i]: Fault %s found\n",

196 
š¡
->
	`»adTid
(), in¡->
£qNum
, 
çuÉ
->
	`Çme
());

197 
š¡
->
çuÉ
 = fault;

198 
exec_»q
->
	`dÚe
();

202 
çuÉ
 = 
š¡
->
	`execu‹
();

203 
executiÚs
++;

205 ià(
çuÉ
 =ğ
NoFauÉ
) {

206 
š¡
->
	`£tExecu‹d
();

208 #ià
TRACING_ON


209 
didx
 = 0; didx < 
š¡
->
	`numDe¡Regs
(); didx++)

210 ià(
š¡
->
	`»suÉTy³
(
didx
è=ğ
InOrd”DynIn¡
::
Flßt
 ||

211 
š¡
->
	`»suÉTy³
(
didx
è=ğ
InOrd”DynIn¡
::
FlßtB™s
 ||

212 
š¡
->
	`»suÉTy³
(
didx
è=ğ
InOrd”DynIn¡
::
DoubË
)

213 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i]: [sn:%i]: Dest„esult %i "

214 "oàFPƒxecutiÚ i %08à(%x).\n", 
š¡
->
	`»adTid
(),

215 
£q_num
, 
didx
, 
š¡
->
	`»adFlßtResuÉ
(didx),

216 
š¡
->
	`»adFlßtB™sResuÉ
(
didx
));

218 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i]: [sn:%i]: Dest„esult %i "

219 "oàIÁƒxecutiÚ i 0x%x.\n", 
š¡
->
	`»adTid
(),

220 
£q_num
, 
didx
, 
š¡
->
	`»adIÁResuÉ
(didx));

223 ià(!
FuÎSy¡em
) {

226 ià(
š¡
->
	`isSysÿÎ
()) {

227 
š¡
->
	`£tSquashInfo
(
¡age_num
);

228 
	`£tupSquash
(
š¡
, 
¡age_num
, 
tid
);

232 
	`DPRINTF
(
InOrd”Execu‹
, "[tid:%i]: [sn:%i]: had‡ %s "

233 "çuÉ.\n", 
š¡
->
	`»adTid
(), 
£q_num
, 
çuÉ
->
	`Çme
());

234 
	`DPRINTF
(
FauÉ
, "[tid:%i]:[sn:%i]: Fault %s found\n",

235 
š¡
->
	`»adTid
(), in¡->
£qNum
, 
çuÉ
->
	`Çme
());

236 
š¡
->
çuÉ
 = fault;

239 
exec_»q
->
	`dÚe
();

245 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

247 
	}
}

	@inorder/resources/execution_unit.hh

32 #iâdeà
__CPU_INORDER_EXECUTION_UNIT_HH__


33 
	#__CPU_INORDER_EXECUTION_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/šÜd”/fœ¡_¡age.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/»sourû.hh
"

42 
	~"ıu/func_un™.hh
"

44 şas 
	cExecutiÚUn™
 : 
public
 
Resourû
 {

45 
public
:

46 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

48 
	eCommªd
 {

49 
	mExecu‹In¡


52 
	gpublic
:

53 
ExecutiÚUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

54 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

55 
TheP–še
::
P¬ams
 *
·¿ms
);

57 
	gpublic
:

58 
»gSts
();

64 
execu‹
(
¦Ù_num
);

66 
	g´Ùeùed
:

72 
Sts
::
SÿÏr
 
´ediùedTak’IncÜ»ù
;

73 
	gSts
::
SÿÏr
 
´ediùedNÙTak’IncÜ»ù
;

74 
	gSts
::
SÿÏr
 
´ediùedIncÜ»ù
;

75 
	gSts
::
SÿÏr
 
´ediùedCÜ»ù
;

76 
	gSts
::
FÜmuÏ
 
mi¥»diùPù
;

77 
	gSts
::
SÿÏr
 
executiÚs
;

78 
Tick
 
	gÏ¡Execu‹Tick
;

79 
Tick
 
	gÏ¡CÚŒŞTick
;

	@inorder/resources/fetch_seq_unit.cc

32 
	~"cÚfig/the_i§.hh
"

33 
	~"ıu/šÜd”/»sourûs/ãtch_£q_un™.hh
"

34 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

35 
	~"debug/InOrd”F‘chSeq.hh
"

36 
	~"debug/InOrd”SÎ.hh
"

38 
usšg
 
Çme¥aû
 
	g¡d
;

39 
usšg
 
Çme¥aû
 
	gTheISA
;

40 
usšg
 
Çme¥aû
 
	gTheP–še
;

42 
	gF‘chSeqUn™
::
F‘chSeqUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

43 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

44 
TheP–še
::
P¬ams
 *
·¿ms
)

45 : 
Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
),

46 
š¡Size
((
MachIn¡
))

48 
Th»adID
 
tid
 = 0;id < 
TheP–še
::
MaxTh»ads
;id++) {

49 
pcV®id
[
tid
] = 
çl£
;

50 
pcBlockSge
[
tid
] = 0;

54 
squashSeqNum
[
tid
] = (
In¡SeqNum
)-1;

55 
Ï¡SquashCyşe
[
tid
] = 0;

57 
	}
}

59 
	gF‘chSeqUn™
::~
	$F‘chSeqUn™
()

61 
d–‘e
 [] 
»sourûEv’t
;

62 
	}
}

65 
	gF‘chSeqUn™
::
	$š™
()

67 
»sourûEv’t
 = 
Ãw
 
F‘chSeqEv’t
[
width
];

69 
i
 = 0; i < 
width
; i++) {

70 
»qs
[
i
] = 
Ãw
 
	`ResourûReque¡
(
this
);

73 
	`š™SlÙs
();

74 
	}
}

77 
	gF‘chSeqUn™
::
	$execu‹
(
¦Ù_num
)

79 
ResourûReque¡
* 
fs_»q
 = 
»qs
[
¦Ù_num
];

80 
DynIn¡PŒ
 
š¡
 = 
fs_»q
->inst;

81 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

82 
¡age_num
 = 
fs_»q
->
	`g‘SgeNum
();

84 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

85 
	`DPRINTF
(
InOrd”F‘chSeq
,

87 "Ãxˆ¡age.\n", 
tid
, 
š¡
->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

88 
š¡
->
	`pcS‹
());

89 
fs_»q
->
	`dÚe
();

93 
fs_»q
->
cmd
)

95 
AssignNextPC
:

97 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Cu¼’ˆPC i %s\n", 
tid
,

98 
pc
[
tid
]);

100 ià(
pcV®id
[
tid
]) {

101 
š¡
->
	`pcS‹
(
pc
[
tid
]);

102 
š¡
->
	`£tMemAddr
(
pc
[
tid
].
	`š¡Addr
());

105 
pc
[
tid
].
	`advªû
();

107 
š¡
->
	`£tSeqNum
(
ıu
->
	`g‘AndInüem’tIn¡Seq
(
tid
));

109 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Assigning [sn:%i]o "

110 "PC %s\n", 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

112 
fs_»q
->
	`dÚe
();

114 
	`DPRINTF
(
InOrd”SÎ
, "STALL: [tid:%i]: NPC‚Ù v®id\n", 
tid
);

115 
fs_»q
->
	`dÚe
(
çl£
);

120 
Upd©eT¬g‘PC
:

122 
	`as£¹
(!
š¡
->
	`isCÚdD–aySlÙ
() &&

125 ià(
š¡
->
	`isCÚŒŞ
()) {

126 ià(
š¡
->
	`isR‘uº
(è&& !š¡->
	`´edTak’
()) {

130 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%d]: Setting block signal "

132 
tid
, 
¡age_num
);

133 
ıu
->
p–šeSge
[
¡age_num
]->

134 
toP»vSges
->
¡ageBlock
[
¡age_num
][
tid
] = 
Œue
;

135 
pcV®id
[
tid
] = 
çl£
;

136 
pcBlockSge
[
tid
] = 
¡age_num
;

137 } ià(
š¡
->
	`´edTak’
()) {

139 
š¡
->
	`£tSquashInfo
(
¡age_num
);

140 
	`£tupSquash
(
š¡
, 
¡age_num
, 
tid
);

142 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i] Setting up squasho "

144 
tid
, 
¡age_num
, 
š¡
->
squashSeqNum
);

147 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: [sn:%i]: Ignoring branch "

149 "š¡ruùiÚ.\n", 
tid
, 
š¡
->
£qNum
);

152 
fs_»q
->
	`dÚe
();

157 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

159 
	}
}

162 
	gF‘chSeqUn™
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
squash_¡age
,

163 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

165 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Updating dueo squash from %s (%s) "

166 "¡ag%i.\n", 
tid
, 
š¡
->
	`š¡Name
(), in¡->
	`pcS‹
(),

167 
squash_¡age
);

169 ià(
Ï¡SquashCyşe
[
tid
] =ğ
	`curTick
() &&

170 
squashSeqNum
[
tid
] <ğ
squash_£q_num
) {

171 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Ignoring squash from stage %i, "

173 
tid
, 
squash_¡age
);

175 
squashSeqNum
[
tid
] = 
squash_£q_num
;

176 
Ï¡SquashCyşe
[
tid
] = 
	`curTick
();

178 ià(
š¡
->
¡©icIn¡
) {

179 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

182 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i] Blocking dueo fault @ "

183 "[¢:%i].% % \n", 
tid
, 
š¡
->
£qNum
,

184 
š¡
->
	`š¡Name
(), in¡->
	`pcS‹
());

185 
pcV®id
[
tid
] = 
çl£
;

187 
TheISA
::
PCS‹
 
ÃxtPC
;

188 
	`as£¹
(
š¡
->
¡©icIn¡
);

189 ià(
š¡
->
	`isCÚŒŞ
()) {

190 
ÃxtPC
 = 
š¡
->
	`»adP»dT¬g
();

197 
DynIn¡PŒ
 
bd–ay_š¡
 = 
NULL
;

198 
Li¡It
 
bd–ay_™
;

199 ià(
š¡
->
ÚIn¡Li¡
) {

200 
bd–ay_™
 = 
š¡
->
	`g‘In¡Li¡It
();

201 
bd–ay_™
++;

203 
In¡SeqNum
 
b¿nch_d–ay_num
 = 
š¡
->
£qNum
 + 1;

204 
bd–ay_™
 = 
ıu
->
	`fšdIn¡
(
b¿nch_d–ay_num
, 
tid
);

207 ià(
bd–ay_™
 !ğ
ıu
->
š¡Li¡
[
tid
].
	`’d
()) {

208 
bd–ay_š¡
 = (*
bd–ay_™
);

211 ià(
bd–ay_š¡
) {

212 ià(
bd–ay_š¡
->
pc
.
	`š¡Addr
(è=ğ
ÃxtPC
.instAddr()) {

213 
bd–ay_š¡
->
pc
 = 
ÃxtPC
;

214 
	`advªûPC
(
ÃxtPC
, 
š¡
->
¡©icIn¡
);

215 
	`DPRINTF
(
InOrd”F‘chSeq
, "Advªûd PCØ%s\n", 
ÃxtPC
);

219 
ÃxtPC
 = 
š¡
->
	`pcS‹
();

220 
	`advªûPC
(
ÃxtPC
, 
š¡
->
¡©icIn¡
);

224 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Setting PCo %s.\n",

225 
tid
, 
ÃxtPC
);

226 
pc
[
tid
] = 
ÃxtPC
;

229 ià(!
pcV®id
[
tid
]) {

230 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%d]: Setting unblock signal "

232 
tid
, 
pcBlockSge
[tid]);

238 
ıu
->
p–šeSge
[
pcBlockSge
[
tid
]]->

239 
äomNextSges
->
¡ageUnblock
[
pcBlockSge
[
tid
]][tid] = 
Œue
;

242 
pcV®id
[
tid
] = 
Œue
;

247 
Resourû
::
	`squash
(
š¡
, 
squash_¡age
, 
squash_£q_num
, 
tid
);

248 
	}
}

250 
	gF‘chSeqUn™
::
F‘chSeqEv’t
::
	$F‘chSeqEv’t
()

251 : 
	$ResourûEv’t
()

252 { 
	}
}

255 
F‘chSeqUn™
::
F‘chSeqEv’t
::
	$´oûss
()

257 
F‘chSeqUn™
* 
fs_»s
 = 
dyÇmic_ÿ¡
<F‘chSeqUn™*>(
»sourû
);

258 
	`as£¹
(
fs_»s
);

260 
i
 = 0; i < 
MaxTh»ads
; i++) {

261 
fs_»s
->
pc
[
i
] = fs_»s->
ıu
->
	`pcS‹
(i);

262 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Setting PC: %s.\n",

263 
fs_»s
->
pc
[
i
]);

265 
fs_»s
->
pcV®id
[
i
] = 
Œue
;

267 
	}
}

271 
	gF‘chSeqUn™
::
	$aùiv©eTh»ad
(
Th»adID
 
tid
)

273 
pcV®id
[
tid
] = 
Œue
;

275 
pc
[
tid
] = 
ıu
->
	`pcS‹
(tid);

277 
ıu
->
ãtchPriÜ™yLi¡
.
	`push_back
(
tid
);

279 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Reading PC: %s.\n",

280 
tid
, 
pc
[tid]);

281 
	}
}

284 
	gF‘chSeqUn™
::
	$d—ùiv©eTh»ad
(
Th»adID
 
tid
)

286 
pcV®id
[
tid
] = 
çl£
;

287 
pcBlockSge
[
tid
] = 0;

289 
squashSeqNum
[
tid
] = (
In¡SeqNum
)-1;

290 
Ï¡SquashCyşe
[
tid
] = 0;

292 
li¡
<
Th»adID
>::
™”©Ü
 
th»ad_™
 = 
	`fšd
(
ıu
->
ãtchPriÜ™yLi¡
.
	`begš
(),

293 
ıu
->
ãtchPriÜ™yLi¡
.
	`’d
(),

294 
tid
);

296 ià(
th»ad_™
 !ğ
ıu
->
ãtchPriÜ™yLi¡
.
	`’d
())

297 
ıu
->
ãtchPriÜ™yLi¡
.
	`”a£
(
th»ad_™
);

298 
	}
}

301 
	gF‘chSeqUn™
::
	$su¥’dTh»ad
(
Th»adID
 
tid
)

303 
	`d—ùiv©eTh»ad
(
tid
);

304 
	}
}

307 
	gF‘chSeqUn™
::
	$Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
)

309 
pcV®id
[
tid
] = 
Œue
;

310 
pc
[
tid
] = 
ıu
->
	`pcS‹
(tid);

311 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Trap updatingo PC: "

312 "%s.\n", 
tid
, 
pc
[tid]);

313 
	}
}

316 
	gF‘chSeqUn™
::
	$upd©eAá”CÚ‹xtSw™ch
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
)

318 
pcV®id
[
tid
] = 
Œue
;

320 ià(
ıu
->
th»ad
[
tid
]->
Ï¡G¿dIsB¿nch
) {

325 
	`as£¹
(
ıu
->
	`ÃxtIn¡Addr
(
tid
è=ğ
š¡
->
	`š¡Addr
());

326 
pc
[
tid
] = 
ıu
->
th»ad
[tid]->
Ï¡B¿nchPC
;

328 
pc
[
tid
] = 
š¡
->
	`pcS‹
();

330 
	`as£¹
(
š¡
->
¡©icIn¡
);

331 
	`advªûPC
(
pc
[
tid
], 
š¡
->
¡©icIn¡
);

333 
	`DPRINTF
(
InOrd”F‘chSeq
, "[tid:%i]: Updating PCs dueo Context Switch."

334 "Assignšg PC: %s.\n", 
tid
, 
pc
[tid]);

335 
	}
}

	@inorder/resources/fetch_seq_unit.hh

32 #iâdeà
__CPU_INORDER_FETCH_SEQ_UNIT_HH__


33 
	#__CPU_INORDER_FETCH_SEQ_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"cÚfig/the_i§.hh
"

40 
	~"ıu/šÜd”/ıu.hh
"

41 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

42 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

43 
	~"ıu/šÜd”/»sourû.hh
"

45 şas 
	cF‘chSeqUn™
 : 
public
 
Resourû
 {

46 
public
:

47 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

48 
	m¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

50 
	eCommªd
 {

51 
	mAssignNextPC
,

52 
	mUpd©eT¬g‘PC


55 
	gpublic
:

56 
F‘chSeqUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

57 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

58 
TheP–še
::
P¬ams
 *
·¿ms
);

59 ~
F‘chSeqUn™
();

61 
š™
();

62 
aùiv©eTh»ad
(
Th»adID
 
tid
);

63 
d—ùiv©eTh»ad
(
Th»adID
 
tid
);

64 
su¥’dTh»ad
(
Th»adID
 
tid
);

65 
execu‹
(
¦Ù_num
);

66 
upd©eAá”CÚ‹xtSw™ch
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
);

70 
squash
(
DynIn¡PŒ
 
š¡
, 
squash_¡age
,

71 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

74 
Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
);

76 
	g´Ùeùed
:

77 
š¡Size
;

79 
boŞ
 
	gpcV®id
[
TheP–še
::
MaxTh»ads
];

80 
	gpcBlockSge
[
TheP–še
::
MaxTh»ads
];

82 
	gTheISA
::
PCS‹
 
pc
[
TheP–še
::
MaxTh»ads
];

85 
In¡SeqNum
 
	gsquashSeqNum
[
TheP–še
::
MaxTh»ads
];

88 
Tick
 
	gÏ¡SquashCyşe
[
TheP–še
::
MaxTh»ads
];

92 
	gpublic
:

93 şas 
	cF‘chSeqEv’t
 : 
public
 
ResourûEv’t
 {

94 
public
:

96 
F‘chSeqEv’t
();

97 ~
F‘chSeqEv’t
() {}

100 
´oûss
();

	@inorder/resources/fetch_unit.cc

32 
	~<li¡
>

33 
	~<veùÜ
>

35 
	~"¬ch/i§_Œa™s.hh
"

36 
	~"¬ch/locked_mem.hh
"

37 
	~"¬ch/ut™y.hh
"

38 
	~"cÚfig/the_i§.hh
"

39 
	~"ıu/šÜd”/»sourûs/ÿche_un™.hh
"

40 
	~"ıu/šÜd”/»sourûs/ãtch_un™.hh
"

41 
	~"ıu/šÜd”/ıu.hh
"

42 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

43 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

44 
	~"debug/Aùiv™y.hh
"

45 
	~"debug/InOrd”CachePÜt.hh
"

46 
	~"debug/InOrd”SÎ.hh
"

47 
	~"debug/RefCouÁ.hh
"

48 
	~"debug/Th»adMod–.hh
"

49 
	~"mem/»que¡.hh
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

52 
usšg
 
Çme¥aû
 
	gTheISA
;

53 
usšg
 
Çme¥aû
 
	gTheP–še
;

55 
	gF‘chUn™
::
F‘chUn™
(
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

56 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

57 
TheP–še
::
P¬ams
 *
·¿ms
)

58 : 
CacheUn™
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
, 
·¿ms
),

59 
š¡Size
((
TheISA
::
MachIn¡
)), 
ãtchBuffSize
(
·¿ms
->fetchBuffSize)

61 
	gtid
 = 0;id < 
	gMaxTh»ads
;id++)

62 
	gdecod”
[
tid
] = 
Ãw
 
Decod”
;

65 
	gF‘chUn™
::~
	$F‘chUn™
()

67 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
 = 
ãtchBufãr
.
	`begš
();

68 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
’d_™
 = 
ãtchBufãr
.
	`’d
();

69 
ãtch_™
 !ğ
’d_™
) {

70 
	`d–‘e
 (*
ãtch_™
)->
block
;

71 
d–‘e
 *
ãtch_™
;

72 
ãtch_™
++;

74 
ãtchBufãr
.
	`ş—r
();

77 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
³nd_™
 = 
³ndšgF‘ch
.
	`begš
();

78 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
³nd_’d
 = 
³ndšgF‘ch
.
	`’d
();

79 
³nd_™
 !ğ
³nd_’d
) {

80 ià((*
³nd_™
)->
block
) {

81 
	`d–‘e
 (*
³nd_™
)->
block
;

84 
d–‘e
 *
³nd_™
;

85 
³nd_™
++;

87 
³ndšgF‘ch
.
	`ş—r
();

88 
	}
}

91 
	gF‘chUn™
::
ü—‹MachIn¡
(
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
,

92 
DynIn¡PŒ
 
š¡
)

94 
Addr
 
	gblock_addr
 = 
ÿcheBlockAlign
(
š¡
->
g‘MemAddr
());

95 
Addr
 
	gãtch_addr
 = 
š¡
->
g‘MemAddr
();

96 
	gãtch_off£t
 = (
ãtch_addr
 - 
block_addr
è/ 
š¡Size
;

97 
Th»adID
 
	gtid
 = 
š¡
->
»adTid
();

98 
	gTheISA
::
PCS‹
 
š¡PC
 = 
š¡
->
pcS‹
();

101 
DPRINTF
(
InOrd”CachePÜt
, "Creating instruction [sn:%i] w/fetch data @"

102 "addr:%08°block:%08p\n", 
š¡
->
£qNum
, 
ãtch_addr
, 
block_addr
);

104 
as£¹
((*
ãtch_™
)->
v®id
);

106 
	gTheISA
::
MachIn¡
 *
ãtchIn¡s
 =

107 
»š‹½»t_ÿ¡
<
TheISA
::
MachIn¡
 *>((*
ãtch_™
)->
block
);

109 
MachIn¡
 
	gmach_š¡
 =

110 
TheISA
::
gtoh
(
ãtchIn¡s
[
ãtch_off£t
]);

112 
	gdecod”
[
tid
]->
mÜeBy‹s
(
š¡PC
, 
š¡
->
š¡Addr
(), 
mach_š¡
);

113 
as£¹
(
decod”
[
tid
]->
š¡R—dy
());

114 
	gš¡
->
£tSticIn¡
(
decod”
[
tid
]->
decode
(
š¡PC
));

115 
	gš¡
->
pcS‹
(
š¡PC
);

119 
	gF‘chUn™
::
	$»moveAddrD•’d’cy
(
DynIn¡PŒ
 
š¡
)

121 
š¡
->
	`un£tMemAddr
();

122 
	}
}

124 
ResReqPŒ


125 
	gF‘chUn™
::
	$g‘Reque¡
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
»s_idx
,

126 
¦Ù_num
, 
cmd
)

128 
ScheduËEÁry
* 
sched_’Œy
 = *
š¡
->
curSkedEÁry
;

129 
CacheReque¡
* 
ÿche_»q
 = 
dyÇmic_ÿ¡
<CacheReque¡*>(
»qs
[
¦Ù_num
]);

131 ià(!
š¡
->
	`v®idMemAddr
()) {

132 
	`·nic
("Mem. Addr. must be set before„equesting cache‡ccess\n");

135 
	`as£¹
(
sched_’Œy
->
cmd
 =ğ
In™Ÿ‹F‘ch
);

137 
	`DPRINTF
(
InOrd”CachePÜt
,

139 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
	`g‘MemAddr
());

141 
ÿche_»q
->
	`£tReque¡
(
š¡
, 
¡age_num
, 
id
, 
¦Ù_num
,

142 
sched_’Œy
->
cmd
, 
MemCmd
::
R—dReq
,

143 
š¡
->
curSkedEÁry
->
idx
);

145  
ÿche_»q
;

146 
	}
}

149 
	gF‘chUn™
::
	$£tupMemReque¡
(
DynIn¡PŒ
 
š¡
, 
CacheReqPŒ
 
ÿche_»q
,

150 
acc_size
, 
æags
)

152 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

153 
Addr
 
®igÃd_addr
 = 
	`ÿcheBlockAlign
(
š¡
->
	`g‘MemAddr
());

154 ià(
ÿche_»q
->
memReq
 =ğ
NULL
) {

155 
ÿche_»q
->
memReq
 =

156 
Ãw
 
	`Reque¡
(
tid
, 
®igÃd_addr
, 
acc_size
, 
æags
,

157 
ıu
->
	`š¡Ma¡”Id
(), 
š¡
->
	`š¡Addr
(), cpu->
	`»adCpuId
(),

158 
tid
);

159 
	`DPRINTF
(
InOrd”CachePÜt
, "[sn:%i] Created memReq @%x, ->%x\n",

160 
š¡
->
£qNum
, &
ÿche_»q
->
memReq
, cache_req->memReq);

162 
	}
}

164 
	g¡d
::
li¡
<
F‘chUn™
::
F‘chBlock
*>::
™”©Ü


165 
F‘chUn™
::
fšdBlock
(
¡d
::
li¡
<
F‘chBlock
*> &
ãtch_blocks
, 
asid
,

166 
Addr
 
block_addr
)

168 
	g¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
 = 
ãtch_blocks
.
begš
();

169 
	g¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
’d_™
 = 
ãtch_blocks
.
’d
();

171 
	gãtch_™
 !ğ
’d_™
) {

172 ià((*
ãtch_™
)->
asid
 ==‡sid &&

173 (*
ãtch_™
)->
addr
 =ğ
block_addr
) {

174  
ãtch_™
;

177 
	gãtch_™
++;

180  
	gãtch_™
;

183 
	g¡d
::
li¡
<
F‘chUn™
::
F‘chBlock
*>::
™”©Ü


184 
F‘chUn™
::
	$fšdR•Ïûm’tBlock
()

186 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
 = 
ãtchBufãr
.
	`begš
();

187 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
’d_™
 = 
ãtchBufãr
.
	`’d
();

189 
ãtch_™
 !ğ
’d_™
) {

190 ià((*
ãtch_™
)->
út
 == 0) {

191  
ãtch_™
;

193 
	`DPRINTF
(
InOrd”CachePÜt
, "Block %08p has %i insts…ending.\n",

194 (*
ãtch_™
)->
addr
, (*ãtch_™)->
út
);

196 
ãtch_™
++;

199  
ãtch_™
;

200 
	}
}

203 
	gF‘chUn™
::
m¬kBlockU£d
(
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
block_™
)

207 ià(
block_™
 !ğ
ãtchBufãr
.
’d
()) {

208 
F‘chBlock
 *
mru_blk
 = *
block_™
;

209 
	gãtchBufãr
.
”a£
(
block_™
);

210 
	gãtchBufãr
.
push_back
(
mru_blk
);

215 
	gF‘chUn™
::
	$blocksInU£
()

217 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
 = 
ãtchBufãr
.
	`begš
();

218 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
’d_™
 = 
ãtchBufãr
.
	`’d
();

220 
út
 = 0;

221 
ãtch_™
 !ğ
’d_™
) {

222 ià((*
ãtch_™
)->
út
 > 0)

223 
út
++;

225 
ãtch_™
++;

228  
út
;

229 
	}
}

232 
	gF‘chUn™
::
	$ş—rF‘chBufãr
()

234 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
 = 
ãtchBufãr
.
	`begš
();

235 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
’d_™
 = 
ãtchBufãr
.
	`’d
();

237 
ãtch_™
 !ğ
’d_™
) {

238 ià((*
ãtch_™
)->
block
) {

239 
d–‘e
 [] (*
ãtch_™
)->
block
;

241 
d–‘e
 *
ãtch_™
;

242 
ãtch_™
++;

244 
ãtchBufãr
.
	`ş—r
();

245 
	}
}

248 
	gF‘chUn™
::
	$execu‹
(
¦Ù_num
)

250 
CacheReqPŒ
 
ÿche_»q
 = 
dyÇmic_ÿ¡
<CacheReqPŒ>(
»qs
[
¦Ù_num
]);

251 
	`as£¹
(
ÿche_»q
);

253 ià(
ÿchePÜtBlocked
 && 
ÿche_»q
->
cmd
 =ğ
In™Ÿ‹F‘ch
) {

254 
	`DPRINTF
(
InOrd”CachePÜt
, "Cache Port Blocked. Cannot Access\n");

255 
ÿche_»q
->
	`dÚe
(
çl£
);

259 
DynIn¡PŒ
 
š¡
 = 
ÿche_»q
->inst;

260 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

261 
Addr
 
block_addr
 = 
	`ÿcheBlockAlign
(
š¡
->
	`g‘MemAddr
());

262 
asid
 = 
ıu
->asid[
tid
];

264 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

265 
	`DPRINTF
(
InOrd”CachePÜt
,

267 "Ãxˆ¡age.\n", 
tid
, 
š¡
->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

268 
	`ÿcheBlockAlign
(
š¡
->
	`g‘MemAddr
()));

269 
	`fšishCacheUn™Req
(
š¡
, 
ÿche_»q
);

273 
ÿche_»q
->
cmd
)

275 
In™Ÿ‹F‘ch
:

279 
boŞ
 
do_ãtch
 = 
Œue
;

280 
tÙ®_³ndšg
 = 
³ndšgF‘ch
.
	`size
(è+ 
	`blocksInU£
();

282 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
³ndšg_™
;

283 
³ndšg_™
 = 
	`fšdBlock
(
³ndšgF‘ch
, 
asid
, 
block_addr
);

284 ià(
³ndšg_™
 !ğ
³ndšgF‘ch
.
	`’d
()) {

285 (*
³ndšg_™
)->
út
++;

286 
do_ãtch
 = 
çl£
;

288 
	`DPRINTF
(
InOrd”CachePÜt
, "%08p is‡…ending fetch block "

289 "Õ’dšg:%i).\n", 
block_addr
,

290 (*
³ndšg_™
)->
út
);

291 } ià(
tÙ®_³ndšg
 < 
ãtchBuffSize
) {

292 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
buff_™
;

293 
buff_™
 = 
	`fšdBlock
(
ãtchBufãr
, 
asid
, 
block_addr
);

294 ià(
buff_™
 !ğ
ãtchBufãr
.
	`’d
()) {

295 (*
buff_™
)->
út
++;

296 
do_ãtch
 = 
çl£
;

298 
	`DPRINTF
(
InOrd”CachePÜt
, "%08p is in fetch buffer "

299 "Õ’dšg:%i).\n", 
block_addr
, (*
buff_™
)->
út
);

303 ià(!
do_ãtch
) {

304 
	`DPRINTF
(
InOrd”CachePÜt
, "Inst. [sn:%i] markedo be filled "

305 "through f‘ch bufãr.\n", 
š¡
->
£qNum
);

306 
ÿche_»q
->
ãtchBufãrFl
 = 
Œue
;

307 
ÿche_»q
->
	`£tCom¶‘ed
(
Œue
);

313 ià(
tÙ®_³ndšg
 >ğ
ãtchBuffSize
) {

314 
	`DPRINTF
(
InOrd”CachePÜt
, "No„oom‡vailable in fetch buffer.\n");

315 
ÿche_»q
->
	`dÚe
(
çl£
);

319 
	`doTLBAcûss
(
š¡
, 
ÿche_»q
, 
ÿcheBlkSize
, 
Reque¡
::
INST_FETCH
, 
TheISA
::
TLB
::
Execu‹
);

321 ià(
š¡
->
çuÉ
 =ğ
NoFauÉ
) {

322 
	`DPRINTF
(
InOrd”CachePÜt
,

324 "addr:%#x (block:%#x)\n", 
tid
, 
	`Çme
(),

325 
ÿche_»q
->
š¡
->
	`g‘MemAddr
(), 
block_addr
);

327 
ÿche_»q
->
»qD©a
 = 
Ãw
 
ušt8_t
[
ÿcheBlkSize
];

329 
š¡
->
	`£tCurResSlÙ
(
¦Ù_num
);

331 
	`doCacheAcûss
(
š¡
);

333 ià(
ÿche_»q
->
	`isMemAccP’dšg
()) {

334 
³ndšgF‘ch
.
	`push_back
(
Ãw
 
	`F‘chBlock
(
asid
, 
block_addr
));

343 
Com¶‘eF‘ch
:

344 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

345 
	`DPRINTF
(
InOrd”CachePÜt
,

347 "Ãxˆ¡age.\n", 
tid
, 
š¡
->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

348 
š¡
->
	`g‘MemAddr
());

349 
	`fšishCacheUn™Req
(
š¡
, 
ÿche_»q
);

353 ià(
ÿche_»q
->
ãtchBufãrFl
) {

355 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
 = 
	`fšdBlock
(
ãtchBufãr
, 
asid
, 
block_addr
);

356 ià(
ãtch_™
 =ğ
ãtchBufãr
.
	`’d
()) {

357 
	`DPRINTF
(
InOrd”CachePÜt
, "%#x‚ot‡vailable yet\n",

358 
block_addr
);

359 
ÿche_»q
->
	`£tCom¶‘ed
(
çl£
);

364 
	`ü—‹MachIn¡
(
ãtch_™
, 
š¡
);

365 ià(
š¡
->
ŒaûD©a
) {

366 
š¡
->
ŒaûD©a
->
	`£tSticIn¡
(š¡->
¡©icIn¡
);

367 
š¡
->
ŒaûD©a
->
	`£tPC
(š¡->
	`pcS‹
());

371 (*
ãtch_™
)->
út
--;

372 
	`as£¹
((*
ãtch_™
)->
út
 >= 0);

373 
	`m¬kBlockU£d
(
ãtch_™
);

375 
ÿche_»q
->
	`dÚe
();

379 ià(
ÿche_»q
->
	`isMemAccCom¶‘e
()) {

380 ià(
ãtchBufãr
.
	`size
(è>ğ
ãtchBuffSize
) {

384 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
»¶_™
 =

385 
	`fšdR•Ïûm’tBlock
();

386 ià(
»¶_™
 =ğ
ãtchBufãr
.
	`’d
()) {

387 
	`DPRINTF
(
InOrd”CachePÜt
, "Unableo find„eplacement block"

389 
ÿche_»q
->
	`£tCom¶‘ed
(
çl£
);

393 
d–‘e
 [] (*
»¶_™
)->
block
;

394 
d–‘e
 *
»¶_™
;

395 
ãtchBufãr
.
	`”a£
(
»¶_™
);

398 
	`DPRINTF
(
InOrd”CachePÜt
,

400 
tid
, 
š¡
->
£qNum
);

403 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
 =

404 
	`fšdBlock
(
³ndšgF‘ch
, 
asid
, 
block_addr
);

406 
	`as£¹
(
ãtch_™
 !ğ
³ndšgF‘ch
.
	`’d
());

407 
	`as£¹
((*
ãtch_™
)->
v®id
);

409 
	`ü—‹MachIn¡
(
ãtch_™
, 
š¡
);

410 ià(
š¡
->
ŒaûD©a
) {

411 
š¡
->
ŒaûD©a
->
	`£tSticIn¡
(š¡->
¡©icIn¡
);

412 
š¡
->
ŒaûD©a
->
	`£tPC
(š¡->
	`pcS‹
());

417 
F‘chBlock
 *
Ãw_block
 = (*
ãtch_™
);

418 
Ãw_block
->
út
--;

419 
	`as£¹
(
Ãw_block
->
út
 >= 0);

423 
³ndšgF‘ch
.
	`”a£
(
ãtch_™
);

424 
ãtchBufãr
.
	`push_back
(
Ãw_block
);

426 
	`DPRINTF
(
InOrd”CachePÜt
, "[tid:%i]: Instruction [sn:%i] is: %s\n",

427 
tid
, 
š¡
->
£qNum
,

428 
š¡
->
¡©icIn¡
->
	`di§s£mbË
(š¡->
	`š¡Addr
()));

430 
š¡
->
	`un£tMemAddr
();

432 
ÿche_»q
->
	`dÚe
();

434 
	`DPRINTF
(
InOrd”CachePÜt
,

436 
tid
, 
š¡
->
£qNum
);

437 
	`DPRINTF
(
InOrd”SÎ
,

439 
tid
, 
ÿche_»q
->
š¡
->
	`š¡Addr
());

440 
ÿche_»q
->
	`£tCom¶‘ed
(
çl£
);

448 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

450 
	}
}

453 
	gF‘chUn™
::
	$´oûssCacheCom¶‘iÚ
(
Pack‘PŒ
 
pkt
)

458 
CacheReqPack‘
* 
ÿche_pkt
 = 
dyÇmic_ÿ¡
<CacheReqPack‘*>(
pkt
);

459 
	`as£¹
(
ÿche_pkt
);

461 
	`DPRINTF
(
InOrd”CachePÜt
, "Finished„equest for %x\n",

462 
ÿche_pkt
->
	`g‘Addr
());

464 ià(
	`´oûssSquash
(
ÿche_pkt
))

467 
Addr
 
block_addr
 = 
	`ÿcheBlockAlign
(
ÿche_pkt
->
ÿcheReq
->

468 
	`g‘In¡
()->
	`g‘MemAddr
());

470 
	`DPRINTF
(
InOrd”CachePÜt
,

472 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
	`»adTid
(),

473 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
£qNum
,

474 
block_addr
, 
ÿche_pkt
->
	`g‘Addr
(), cache_pkt->
	`g‘Size
());

477 
CacheReque¡
 *
ÿche_»q
 = 
dyÇmic_ÿ¡
<
CacheReqPŒ
>(

478 
	`fšdReque¡
(
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
(), cache_pkt->
š¡Idx
));

480 ià(!
ÿche_»q
) {

481 
	`·nic
("[tid:%u]: [sn:%i]: Can't find slot for fetch‡ccesso "

482 "addr. %08p\n", 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
	`»adTid
(),

483 
ÿche_pkt
->
ÿcheReq
->
	`g‘In¡
()->
£qNum
,

484 
block_addr
);

488 
¡age_num
 = 
ÿche_»q
->
	`g‘SgeNum
();

489 
DynIn¡PŒ
 
š¡
 = 
ÿche_»q
->inst;

490 
Th»adID
 
tid
 = 
ÿche_»q
->
š¡
->
	`»adTid
();

491 
asid
 = 
ıu
->asid[
tid
];

493 
	`as£¹
(!
ÿche_»q
->
	`isSquashed
());

494 
	`as£¹
(
š¡
->
curSkedEÁry
->
cmd
 =ğ
Com¶‘eF‘ch
);

496 
	`DPRINTF
(
InOrd”CachePÜt
,

498 
tid
, 
š¡
->
£qNum
, 
block_addr
);

500 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
³nd_™
 = 
	`fšdBlock
(
³ndšgF‘ch
, 
asid
,

501 
block_addr
);

502 
	`as£¹
(
³nd_™
 !ğ
³ndšgF‘ch
.
	`’d
());

505 (*
³nd_™
)->
block
 = 
Ãw
 
ušt8_t
[
ÿcheBlkSize
];

506 
	`memıy
((*
³nd_™
)->
block
, 
ÿche_pkt
->
g‘PŒ
<
ušt8_t
>(), 
ÿcheBlkSize
);

507 (*
³nd_™
)->
v®id
 = 
Œue
;

509 
ÿche_»q
->
	`£tMemAccP’dšg
(
çl£
);

510 
ÿche_»q
->
	`£tMemAccCom¶‘ed
();

512 ià(
ÿche_»q
->
	`isMemSÎ
() &&

513 
ıu
->
th»adMod–
 =ğ
InOrd”CPU
::
Sw™chOnCacheMiss
) {

514 
	`DPRINTF
(
InOrd”CachePÜt
, "[tid:%u] Waking up from Cache Miss.\n",

515 
tid
);

517 
ıu
->
	`aùiv©eCÚ‹xt
(
tid
);

519 
	`DPRINTF
(
Th»adMod–
, "Activating [tid:%i]‡fter„eturn from cache"

520 "miss.\n", 
tid
);

525 
ıu
->
	`wakeCPU
();

527 
	`DPRINTF
(
Aùiv™y
, "[tid:%u] Activating %s dueo cache completion\n",

528 
tid
, 
ıu
->
p–šeSge
[
¡age_num
]->
	`Çme
());

530 
ıu
->
	`sw™chToAùive
(
¡age_num
);

531 
	}
}

534 
	gF‘chUn™
::
	$squashCacheReque¡
(
CacheReqPŒ
 
»q_±r
)

536 
DynIn¡PŒ
 
š¡
 = 
»q_±r
->
	`g‘In¡
();

537 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

538 
Addr
 
block_addr
 = 
	`ÿcheBlockAlign
(
š¡
->
	`g‘MemAddr
());

539 
asid
 = 
ıu
->asid[
tid
];

543 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
buff_™
 = 
	`fšdBlock
(
ãtchBufãr
,

544 
asid
,

545 
block_addr
);

546 ià(
buff_™
 !ğ
ãtchBufãr
.
	`’d
()) {

547 (*
buff_™
)->
út
--;

548 
	`DPRINTF
(
InOrd”CachePÜt
, "[sn:%i] Removing Pending Access "

549 "fÜ F‘ch Bufã¸block %08°(út=%i)\n", 
š¡
->
£qNum
,

550 
block_addr
, (*
buff_™
)->
út
);

551 
	`as£¹
((*
buff_™
)->
út
 >= 0);

553 
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
block_™
 = 
	`fšdBlock
(
³ndšgF‘ch
,

554 
asid
,

555 
block_addr
);

556 ià(
block_™
 !ğ
³ndšgF‘ch
.
	`’d
()) {

557 (*
block_™
)->
út
--;

558 
	`DPRINTF
(
InOrd”CachePÜt
, "[sn:%i] Removing Pending Access "

560 
š¡
->
£qNum
,

561 
block_addr
, (*
block_™
)->
út
);

562 
	`as£¹
((*
block_™
)->
út
 >= 0);

563 ià((*
block_™
)->
út
 == 0) {

564 ià((*
block_™
)->
block
) {

565 
d–‘e
 [] (*
block_™
)->
block
;

567 
d–‘e
 *
block_™
;

568 
³ndšgF‘ch
.
	`”a£
(
block_™
);

573 
CacheUn™
::
	`squashCacheReque¡
(
»q_±r
);

574 
	}
}

577 
	gF‘chUn™
::
	$Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
)

580 
decod”
[
tid
]->
	`»£t
();

583 
	`squash
(
NULL
, 
NumSges
 - 1, 0, 
tid
);

586 
	`as£¹
(
	`blocksInU£
() == 0);

587 
	`as£¹
(
³ndšgF‘ch
.
	`size
() == 0);

590 
	`ş—rF‘chBufãr
();

591 
	}
}

	@inorder/resources/fetch_unit.hh

32 #iâdeà
__CPU_INORDER_FETCH_UNIT_HH__


33 
	#__CPU_INORDER_FETCH_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"¬ch/decod”.hh
"

40 
	~"¬ch/b.hh
"

41 
	~"cÚfig/the_i§.hh
"

42 
	~"ıu/šÜd”/»sourûs/ÿche_un™.hh
"

43 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

44 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

45 
	~"ıu/šÜd”/»sourû.hh
"

46 
	~"mem/·ck‘.hh
"

47 
	~"mem/·ck‘_acûss.hh
"

48 
	~"mem/pÜt.hh
"

49 
	~"·¿ms/InOrd”CPU.hh
"

50 
	~"sim/sim_objeù.hh
"

52 şas 
	cF‘chUn™
 : 
public
 
CacheUn™


54 
public
:

55 
F‘chUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

56 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

57 
TheP–še
::
P¬ams
 *
·¿ms
);

59 
	mvœtu®
 ~
F‘chUn™
();

61 
	mTheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

62 
	mTheISA
::
	tExtMachIn¡
 ExtMachInst;

64 
	sF‘chBlock
 {

65 
	masid
;

66 
Addr
 
	maddr
;

67 
ušt8_t
 *
	mblock
;

68 
	mút
;

69 
boŞ
 
	mv®id
;

71 
F‘chBlock
(
_asid
, 
Addr
 
_addr
)

72 : 
asid
(
_asid
), 
addr
(
_addr
), 
block
(
NULL
), 
út
(1), 
v®id
(
çl£
)

77 
	eCommªd
 {

78 
	gIn™Ÿ‹F‘ch
,

79 
	gCom¶‘eF‘ch


83 
ResourûReque¡
* 
g‘Reque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
,

84 
»s_idx
, 
¦Ù_num
,

85 
cmd
);

88 
execu‹
(
¦Ù_num
);

90 
Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
DynIn¡PŒ
 
š¡
);

92 
	gTheISA
::
Decod”
 *
decod”
[
TheP–še
::
MaxTh»ads
];

94 
	g´iv©e
:

95 
squashCacheReque¡
(
CacheReqPŒ
 
»q_±r
);

97 
ü—‹MachIn¡
(
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
ãtch_™
,

98 
DynIn¡PŒ
 
š¡
);

103 
´oûssCacheCom¶‘iÚ
(
Pack‘PŒ
 
pkt
);

106 
vœtu®
 
£tupMemReque¡
(
DynIn¡PŒ
 
š¡
, 
CacheReqPŒ
 
ÿche_»q
,

107 
acc_size
, 
æags
);

110 
Addr
 
	$ÿcheBlockAlignPC
(
Addr
 
addr
)

112  (
addr
 & ~(
ÿcheBlkMask
));

113 
	}
}

115 
»moveAddrD•’d’cy
(
DynIn¡PŒ
 
š¡
);

117 
	g¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
fšdR•Ïûm’tBlock
();

118 
	g¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
fšdBlock
(
¡d
::list<FetchBlock*>

119 &
ãtch_blocks
, 
asid
,

120 
Addr
 
block_addr
);

122 
m¬kBlockU£d
(
¡d
::
li¡
<
F‘chBlock
*>::
™”©Ü
 
block_™
);

124 
blocksInU£
();

126 
ş—rF‘chBufãr
();

128 
	gš¡Size
;

130 
	gãtchBuffSize
;

133 
	g¡d
::
li¡
<
F‘chBlock
*> 
ãtchBufãr
;

136 
	g¡d
::
li¡
<
F‘chBlock
*> 
³ndšgF‘ch
;

	@inorder/resources/graduation_unit.cc

32 
	~"ıu/šÜd”/»sourûs/g¿du©iÚ_un™.hh
"

33 
	~"debug/InOrd”G¿du©iÚ.hh
"

35 
usšg
 
Çme¥aû
 
	gTheP–še
;

37 
	gG¿du©iÚUn™
::
G¿du©iÚUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

38 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

39 
TheP–še
::
P¬ams
 *
·¿ms
)

40 : 
	$Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
)

42 
Th»adID
 
tid
 = 0;id < 
TheP–še
::
MaxTh»ads
;id++) {

43 
nÚS³cIn¡Aùive
[
tid
] = &
ıu
->nonSpecInstActive[tid];

44 
nÚS³cSeqNum
[
tid
] = &
ıu
->nonSpecSeqNum[tid];

45 
Ï¡NÚS³cTick
[
tid
] = 0;

46 
Ï¡FauÉTick
[
tid
] = 0;

48 
	}
}

51 
	gG¿du©iÚUn™
::
	$execu‹
(
¦Ù_num
)

53 
ResourûReque¡
* 
g¿d_»q
 = 
»qs
[
¦Ù_num
];

54 
DynIn¡PŒ
 
š¡
 = 
»qs
[
¦Ù_num
]->inst;

55 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

56 
¡age_num
 = 
š¡
->
curSkedEÁry
->
¡ageNum
;

57 
Tick
 
cur_tick
 = 
	`curTick
();

62 ià(
Ï¡NÚS³cTick
[
tid
] =ğ
cur_tick
) {

63 
	`DPRINTF
(
InOrd”G¿du©iÚ
, "Unableo graduate [sn:%i]. "

65 
g¿d_»q
->
	`dÚe
(
çl£
);

70 ià(
ıu
->
Œ­P’dšg
[
tid
]) {

72 
	`DPRINTF
(
InOrd”G¿du©iÚ
, "Unableo graduate [sn:%i]. "

74 
g¿d_»q
->
	`dÚe
(
çl£
);

79 
g¿d_»q
->
cmd
)

81 
CheckFauÉ
:

84 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

85 
	`DPRINTF
(
InOrd”G¿du©iÚ
, "[tid:%i]: [sn:%i]: fault %s found for %s\n",

86 
tid
, 
š¡
->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

87 
š¡
->
	`š¡Name
());

88 
	`squashTh’T¿p
(
¡age_num
, 
š¡
);

89 
Ï¡FauÉTick
[
tid
] = 
cur_tick
;

90 
g¿d_»q
->
	`dÚe
(
çl£
);

94 
	`DPRINTF
(
InOrd”G¿du©iÚ
, "[tid:%i] [sn:%i]: No fault found for %s\n",

95 
tid
, 
š¡
->
£qNum
, in¡->
	`š¡Name
());

96 
g¿d_»q
->
	`dÚe
();

100 
G¿du©eIn¡
:

102 
	`DPRINTF
(
InOrd”G¿du©iÚ
,

104 
tid
, 
š¡
->
£qNum
, in¡->
¡©icIn¡
->
	`di§s£mbË
(š¡->
	`š¡Addr
()));

112 ià(
š¡
->
	`isNÚS³cuÏtive
()) {

113 *
nÚS³cIn¡Aùive
[
tid
] = 
çl£
;

114 
	`DPRINTF
(
InOrd”G¿du©iÚ
,

116 
tid
, 
š¡
->
£qNum
);

117 
Ï¡NÚS³cTick
[
tid
] = 
cur_tick
;

120 ià(
š¡
->
ŒaûD©a
) {

121 
š¡
->
ŒaûD©a
->
	`£tSgeCyşe
(
¡age_num
, 
cur_tick
);

125 
ıu
->
	`š¡DÚe
(
š¡
, 
tid
);

127 
g¿d_»q
->
	`dÚe
();

132 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

135 
	}
}

	@inorder/resources/graduation_unit.hh

32 #iâdeà
__CPU_INORDER_GRAD_UNIT_HH__


33 
	#__CPU_INORDER_GRAD_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/šÜd”/ıu.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/šÜd”/»sourû.hh
"

44 şas 
	cG¿du©iÚUn™
 : 
public
 
Resourû
 {

45 
public
:

46 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

48 
	eCommªd
 {

49 
	mCheckFauÉ
,

50 
	mG¿du©eIn¡


53 
	gpublic
:

54 
G¿du©iÚUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

55 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

56 
TheP–še
::
P¬ams
 *
·¿ms
);

58 
execu‹
(
¦Ù_num
);

60 
	g´Ùeùed
:

61 
Tick
 
Ï¡NÚS³cTick
[
TheP–še
::
MaxTh»ads
];

62 
Tick
 
	gÏ¡FauÉTick
[
TheP–še
::
MaxTh»ads
];

63 
boŞ
 *
	gnÚS³cIn¡Aùive
[
TheP–še
::
MaxTh»ads
];

64 
In¡SeqNum
 *
	gnÚS³cSeqNum
[
TheP–še
::
MaxTh»ads
];

	@inorder/resources/inst_buffer.cc

32 
	~<li¡
>

33 
	~<veùÜ
>

35 
	~"¬ch/i§_Œa™s.hh
"

36 
	~"cÚfig/the_i§.hh
"

37 
	~"ıu/šÜd”/»sourûs/š¡_bufãr.hh
"

38 
	~"ıu/šÜd”/ıu.hh
"

39 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

40 
	~"debug/InOrd”In¡Bufãr.hh
"

41 
	~"debug/Resourû.hh
"

43 
usšg
 
Çme¥aû
 
	g¡d
;

44 
usšg
 
Çme¥aû
 
	gTheISA
;

45 
usšg
 
Çme¥aû
 
	gTheP–še
;

47 
	gIn¡Bufãr
::
In¡Bufãr
(
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

48 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

49 
TheP–še
::
P¬ams
 *
·¿ms
)

50 : 
	$Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
)

51 { 
	}
}

54 
	gIn¡Bufãr
::
	$»gSts
()

56 
š¡sBy·s£d


57 .
	`Çme
(name() + ".instsBypassed")

58 .
	`desc
("Number of Instructions Bypassed.")

59 .
	`´”eq
(
š¡sBy·s£d
);

61 
Resourû
::
	`»gSts
();

62 
	}
}

65 
	gIn¡Bufãr
::
	$execu‹
(
¦Ù_idx
)

67 
ResReqPŒ
 
ib_»q
 = 
»qs
[
¦Ù_idx
];

68 
DynIn¡PŒ
 
š¡
 = 
ib_»q
->inst;

69 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

70 
¡age_num
 = 
ib_»q
->
	`g‘SgeNum
();

72 
ib_»q
->
cmd
)

74 
ScheduËOrBy·ss
:

76 
Ãxt_¡age
 = 
¡age_num
 + 1;

77 
by·ss_¡age
 = 
¡age_num
 + 2;

78 
boŞ
 
do_by·ss
 = 
Œue
;

80 ià(!
š¡Li¡
.
	`em±y
()) {

81 
	`DPRINTF
(
InOrd”In¡Bufãr
, "[sn:%i] cannot bypass stage %i "

83 
š¡
->
£qNum
, 
Ãxt_¡age
);

84 
do_by·ss
 = 
çl£
;

85 } if(
ıu
->
p–šeSge
[
by·ss_¡age
]->
	`isBlocked
(
tid
)) {

86 
	`DPRINTF
(
InOrd”In¡Bufãr
, "[sn:%i] cannot bypass stage %i "

88 
š¡
->
£qNum
, 
Ãxt_¡age
);

89 
do_by·ss
 = 
çl£
;

90 } if(
ıu
->
p–šeSge
[
by·ss_¡age
]->

91 
	`¡ageBufãrAva
() <= 0) {

92 
	`DPRINTF
(
InOrd”In¡Bufãr
, "[sn:%i] cannot bypass stage %i "

94 "bufãr.\n", 
š¡
->
£qNum
, 
Ãxt_¡age
);

95 
do_by·ss
 = 
çl£
;

98 ià(!
do_by·ss
) {

99 
	`DPRINTF
(
InOrd”In¡Bufãr
, "Scheduling [sn:%i] for buffer "

101 
š¡
->
£qNum
, 
Ãxt_¡age
);

104 
¡age_´i
 = 20;

105 
RSkedPŒ
 
š£¹_sked
 = (
¡age_num
 >ğ
TheP–še
::
BackEndS¹Sge
) ?

106 
š¡
->
backSked
 : in¡->
äÚtSked
;

108 
š£¹_sked
->
	`push
(
Ãw
 
	`ScheduËEÁry
(
Ãxt_¡age
,

109 
¡age_´i
,

110 
id
,

111 
In¡Bufãr
::
In£¹In¡
));

115 
¡age_´i
 = 20;

116 
RSkedPŒ
 
by·ss_sked
 = (
¡age_num
 >ğ
TheP–še
::
BackEndS¹Sge
) ?

117 
š¡
->
backSked
 : in¡->
äÚtSked
;

119 
by·ss_sked
->
	`push
(
Ãw
 
	`ScheduËEÁry
(
by·ss_¡age
,

120 
¡age_´i
,

121 
id
,

122 
In¡Bufãr
::
RemoveIn¡
));

124 
	`DPRINTF
(
InOrd”In¡Bufãr
, "Setting [sn:%i]o bypass stage "

125 "%˜ªdƒÁ” sg%i.\n", 
š¡
->
£qNum
, 
Ãxt_¡age
,

126 
by·ss_¡age
);

127 
š¡
->
	`£tNextSge
(
by·ss_¡age
);

128 
š¡sBy·s£d
++;

131 
ib_»q
->
	`dÚe
();

135 
In£¹In¡
:

137 
boŞ
 
š£¹ed
 = 
çl£
;

139 ià(
š¡Li¡
.
	`size
(è< 
width
) {

140 
	`DPRINTF
(
InOrd”In¡Bufãr
, "[tid:%i]: Inserting [sn:%i] into "

141 "bufãr.\n", 
tid
, 
š¡
->
£qNum
);

142 
	`š£¹
(
š¡
);

143 
š£¹ed
 = 
Œue
;

145 
	`DPRINTF
(
InOrd”In¡Bufãr
, "[tid:%i]: Denying [sn:%i]„equest "

146 "beÿu£ bufã¸i fuÎ.\n", 
tid
, 
š¡
->
£qNum
);

149 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 = 
š¡Li¡
.
	`begš
();

150 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_’d
 = 
š¡Li¡
.
	`’d
();

152 
li¡_™
 !ğ
li¡_’d
) {

153 
	`DPRINTF
(
Resourû
,"Serving [tid:%i] [sn:%i].\n",

154 (*
li¡_™
)->
	`»adTid
(), (*li¡_™)->
£qNum
);

155 
li¡_™
++;

159 
ib_»q
->
	`dÚe
(
š£¹ed
);

163 
RemoveIn¡
:

165 
	`DPRINTF
(
InOrd”In¡Bufãr
, "[tid:%i]: Removing [sn:%i] from "

166 "bufãr.\n", 
tid
, 
š¡
->
£qNum
);

167 
	`»move
(
š¡
);

168 
ib_»q
->
	`dÚe
();

173 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

176 
	`DPRINTF
(
InOrd”In¡Bufãr
, "Buffer‚ow contains %i insts.\n",

177 
š¡Li¡
.
	`size
());

178 
	}
}

181 
	gIn¡Bufãr
::
	$š£¹
(
DynIn¡PŒ
 
š¡
)

183 
š¡Li¡
.
	`push_back
(
š¡
);

184 
	}
}

187 
	gIn¡Bufãr
::
	$»move
(
DynIn¡PŒ
 
š¡
)

189 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 = 
š¡Li¡
.
	`begš
();

190 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_’d
 = 
š¡Li¡
.
	`’d
();

192 
li¡_™
 !ğ
li¡_’d
) {

193 if((*
li¡_™
è=ğ
š¡
) {

194 
š¡Li¡
.
	`”a£
(
li¡_™
);

197 
li¡_™
++;

199 
	}
}

202 
	gIn¡Bufãr
::
	$pİ
(
Th»adID
 
tid
)

204 
š¡Li¡
.
	`pİ_äÚt
();

205 
	}
}

207 
	gTheP–še
::
DynIn¡PŒ


208 
In¡Bufãr
::
	$tİ
(
Th»adID
 
tid
)

210  
š¡Li¡
.
	`äÚt
();

211 
	}
}

214 
	gIn¡Bufãr
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

215 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

217 
queue
<
li¡
<
DynIn¡PŒ
>::
™”©Ü
> 
»move_li¡
;

218 
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_™
 = 
š¡Li¡
.
	`begš
();

219 
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
li¡_’d
 = 
š¡Li¡
.
	`’d
();

222 
li¡_™
 !ğ
li¡_’d
) {

223 if((*
li¡_™
)->
	`»adTid
(è=ğ
tid
 &&

224 (*
li¡_™
)->
£qNum
 > 
squash_£q_num
) {

225 (*
li¡_™
)->
	`£tSquashed
();

226 
»move_li¡
.
	`push
(
li¡_™
);

229 
li¡_™
++;

233 !
»move_li¡
.
	`em±y
()) {

234 
	`DPRINTF
(
InOrd”In¡Bufãr
, "[tid:%i]: Removing squashed [sn:%i] from "

235 "bufãr.\n", 
tid
, (*
»move_li¡
.
	`äÚt
())->
£qNum
);

236 
š¡Li¡
.
	`”a£
(
»move_li¡
.
	`äÚt
());

237 
»move_li¡
.
	`pİ
();

240 
Resourû
::
	`squash
(
š¡
, 
¡age_num
, 
squash_£q_num
, 
tid
);

241 
	}
}

	@inorder/resources/inst_buffer.hh

32 #iâdeà
__CPU_INORDER_INST_BUFF_UNIT_HH__


33 
	#__CPU_INORDER_INST_BUFF_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/šÜd”/ıu.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/šÜd”/»sourû.hh
"

44 şas 
	cIn¡Bufãr
 : 
public
 
Resourû
 {

45 
public
:

46 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

48 
	mpublic
:

49 
	eCommªd
 {

50 
In£¹In¡
,

51 
	mIn£¹Addr
,

52 
	mRemoveIn¡
,

53 
	mRemoveAddr
,

54 
	mScheduËOrBy·ss


57 
	gpublic
:

58 
In¡Bufãr
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

59 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

60 
TheP–še
::
P¬ams
 *
·¿ms
);

62 
»gSts
();

64 
execu‹
(
¦Ù_num
);

66 
š£¹
(
DynIn¡PŒ
 
š¡
);

68 
»move
(
DynIn¡PŒ
 
š¡
);

70 
pİ
(
Th»adID
 
tid
);

72 
DynIn¡PŒ
 
tİ
(
Th»adID
 
tid
);

74 
squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

75 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
);

76 
	g´Ùeùed
:

80 
¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
;

82 
	gpublic
:

89 
Sts
::
SÿÏr
 
š¡sBy·s£d
;

	@inorder/resources/mem_dep_unit.hh

32 #iâdeà
__CPU_INORDER_MEM_DEP_UNIT_HH__


33 
	#__CPU_INORDER_MEM_DEP_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/šÜd”/ıu.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/šÜd”/»sourû.hh
"

44 şas 
	cMemD•Un™
 : 
public
 
Resourû
 {

45 
public
:

46 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

48 
	mpublic
:

49 
MemD•Un™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

50 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
);

51 
	mvœtu®
 ~
	$MemD•Un™
() {}

53 
vœtu®
 
	`execu‹
(
¦Ù_num
);

55 
´Ùeùed
:

56 
Tick
 
Ï¡CyşeG¿d
;

57 
numCyşeG¿d
;

59 
boŞ
 *
nÚS³cIn¡Aùive
[
TheP–še
::
MaxTh»ads
];

61 
In¡SeqNum
 *
nÚS³cSeqNum
[
TheP–še
::
MaxTh»ads
];

64 
	}
};

	@inorder/resources/mult_div_unit.cc

32 
	~<li¡
>

33 
	~<veùÜ
>

35 
	~"ıu/šÜd”/»sourûs/muÉ_div_un™.hh
"

36 
	~"ıu/šÜd”/ıu.hh
"

37 
	~"ıu/šÜd”/»sourû_poŞ.hh
"

38 
	~"ıu/İ_şass.hh
"

39 
	~"debug/InOrd”MDU.hh
"

40 
	~"debug/Resourû.hh
"

42 
usšg
 
Çme¥aû
 
	g¡d
;

43 
usšg
 
Çme¥aû
 
	gTheP–še
;

45 
	gMuÉDivUn™
::
MuÉDivUn™
(
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

46 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

47 
TheP–še
::
P¬ams
 *
·¿ms
)

48 : 
Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
),

49 
muÉR•—tR©e
(
·¿ms
->multRepeatRate),

50 
muÉL©’cy
(
·¿ms
->multLatency),

51 
div8R•—tR©e
(
·¿ms
->div8RepeatRate),

52 
div8L©’cy
(
·¿ms
->div8Latency),

53 
div16R•—tR©e
(
·¿ms
->div16RepeatRate),

54 
div16L©’cy
(
·¿ms
->div16Latency),

55 
div24R•—tR©e
(
·¿ms
->div24RepeatRate),

56 
div24L©’cy
(
·¿ms
->div24Latency),

57 
div32R•—tR©e
(
·¿ms
->div32RepeatRate),

58 
div32L©’cy
(
·¿ms
->div32Latency),

59 
Ï¡MDUCyşe
(0), 
	$Ï¡OpTy³
(
No_OpCÏss
)

60 { 
	}
}

63 
	gMuÉDivUn™
::
	$»gSts
()

65 
muÉl›s


66 .
	`Çme
(name() + ".multiplies")

67 .
	`desc
("Number of Multipy Operations Executed");

69 
divides


70 .
	`Çme
(name() + ".divides")

71 .
	`desc
("Number of Divide Operations Executed");

73 
Resourû
::
	`»gSts
();

74 
	}
}

77 
	gMuÉDivUn™
::
	$š™
()

80 
»sourûEv’t
 = 
Ãw
 
MDUEv’t
[
width
];

82 
i
 = 0; i < 
width
; i++) {

83 
»qs
[
i
] = 
Ãw
 
	`ResourûReque¡
(
this
);

86 
	`š™SlÙs
();

87 
	}
}

92 
	gMuÉDivUn™
::
	$»que¡Agaš
(
DynIn¡PŒ
 
š¡
, 
boŞ
 &
£rviû_»que¡
)

94 
ResReqPŒ
 
muÉ_div_»q
 = 
	`fšdReque¡
(
š¡
);

95 
	`as£¹
(
muÉ_div_»q
);

97 
£rviû_»que¡
 = 
Œue
;

101 ià(
muÉ_div_»q
->
cmd
 !ğ
š¡
->
curSkedEÁry
->cmd) {

103 
muÉ_div_»q
->
cmd
 = 
š¡
->
curSkedEÁry
->cmd;

104 
	`DPRINTF
(
InOrd”MDU
,

106 "š¡ruùiÚ\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
);

110 
	`DPRINTF
(
InOrd”MDU
,

112 
š¡
->
	`»adTid
(), in¡->
£qNum
);

114 
	}
}

116 
	gMuÉDivUn™
::
	$g‘SlÙ
(
DynIn¡PŒ
 
š¡
)

119 
¦Ù_num
 = 
	`fšdSlÙ
(
š¡
);

122 ià(
¦Ù_num
 != -1 &&

123 
š¡
->
curSkedEÁry
->
cmd
 =ğ
»qs
[
¦Ù_num
]->cmd)

124  
¦Ù_num
;

126 
»³©_¿‹
 = 0;

129 ià(
Ï¡OpTy³
 =ğ
IÁMuÉOp
) {

130 
»³©_¿‹
 = 
muÉR•—tR©e
;

134 ià(
Ï¡OpTy³
 =ğ
IÁDivOp
) {

135 
Ï¡DivSize
) {

137 
»³©_¿‹
 = 
div8R•—tR©e
;

141 
»³©_¿‹
 = 
div16R•—tR©e
;

145 
»³©_¿‹
 = 
div24R•—tR©e
;

149 
»³©_¿‹
 = 
div32R•—tR©e
;

154 ià(
Ï¡MDUCyşe
 + 
»³©_¿‹
 > 
	`curTick
()) {

155 
	`DPRINTF
(
InOrd”MDU
, "MDU‚ot„eadyo…rocess‡nother inst. until %i, "

156 "d’yšg„eque¡.\n", 
Ï¡MDUCyşe
 + 
»³©_¿‹
);

159 
rv®
 = 
Resourû
::
	`g‘SlÙ
(
š¡
);

160 
	`DPRINTF
(
InOrd”MDU
, "MDU„equest should…ass: %i.\n",

161 
rv®
);

163 ià(
rv®
 != -1) {

164 
Ï¡MDUCyşe
 = 
	`curTick
();

165 
Ï¡OpTy³
 = 
š¡
->
	`İCÏss
();

166 
Ï¡In¡Name
 = 
š¡
->
¡©icIn¡
->
	`g‘Name
();

169  
rv®
;

171 
	}
}

174 
	gMuÉDivUn™
::
	$g‘DivOpSize
(
DynIn¡PŒ
 
š¡
)

177 
ušt32_t
 
div_İ
 = 
š¡
->
	`»adIÁSrc
(1);

179 ià(
div_İ
 <= 0xFF) {

181 } ià(
div_İ
 <= 0xFFFF) {

183 } ià(
div_İ
 <= 0xFFFFFF) {

188 
	}
}

191 
	gMuÉDivUn™
::
	$execu‹
(
¦Ù_num
)

193 
ResourûReque¡
* 
muÉ_div_»q
 = 
»qs
[
¦Ù_num
];

194 
DynIn¡PŒ
 
š¡
 = 
»qs
[
¦Ù_num
]->inst;

195 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

196 
	`DPRINTF
(
InOrd”MDU
,

198 "Ãxˆ¡age.\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

199 
š¡
->
	`pcS‹
());

200 
muÉ_div_»q
->
	`dÚe
();

204 
	`DPRINTF
(
InOrd”MDU
, "Executšg [¢:%i] ...\n", 
¦Ù_num
);

206 
muÉ_div_»q
->
cmd
)

208 
S¹MuÉDiv
:

210 
	`DPRINTF
(
InOrd”MDU
, "Start MDU called ...\n");

212 
OpCÏss
 
İ_şass
 = 
š¡
->
	`İCÏss
();

213 ià(
İ_şass
 =ğ
IÁMuÉOp
) {

214 
	`scheduËEv’t
(
¦Ù_num
, 
muÉL©’cy
);

215 } ià(
İ_şass
 =ğ
IÁDivOp
) {

216 
İ_size
 = 
	`g‘DivOpSize
(
š¡
);

218 
İ_size
)

221 
	`scheduËEv’t
(
¦Ù_num
, 
div8L©’cy
);

225 
	`scheduËEv’t
(
¦Ù_num
, 
div16L©’cy
);

229 
	`scheduËEv’t
(
¦Ù_num
, 
div24L©’cy
);

233 
	`scheduËEv’t
(
¦Ù_num
, 
div32L©’cy
);

237 
Ï¡DivSize
 = 
İ_size
;

242 
muÉ_div_»q
->
	`£tProûssšg
();

243 
muÉ_div_»q
->
	`£tCom¶‘ed
();

247 
MuÉDiv
:

248 
	`DPRINTF
(
InOrd”MDU
, "Execute MDU called ...\n");

249 
	`exeMulDiv
(
¦Ù_num
);

250 
muÉ_div_»q
->
	`dÚe
();

254 
EndMuÉDiv
:

261 
	`DPRINTF
(
InOrd”MDU
, "End MDU called ...\n");

262 ià(!
muÉ_div_»q
->
	`isProûssšg
()) {

263 
	`DPRINTF
(
InOrd”MDU
, "Mult/Div finished.\n");

264 
muÉ_div_»q
->
	`dÚe
();

266 
muÉ_div_»q
->
	`£tCom¶‘ed
(
çl£
);

273 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

275 
	}
}

278 
	gMuÉDivUn™
::
	$exeMulDiv
(
¦Ù_num
)

280 
ResourûReque¡
* 
muÉ_div_»q
 = 
»qs
[
¦Ù_num
];

281 
DynIn¡PŒ
 
š¡
 = 
»qs
[
¦Ù_num
]->inst;

283 
š¡
->
çuÉ
 = in¡->
	`execu‹
();

285 ià(
š¡
->
	`İCÏss
(è=ğ
IÁMuÉOp
) {

286 
muÉl›s
++;

287 } ià(
š¡
->
	`İCÏss
(è=ğ
IÁDivOp
) {

288 
divides
++;

291 ià(
š¡
->
çuÉ
 =ğ
NoFauÉ
) {

292 
š¡
->
	`£tExecu‹d
();

294 
	`DPRINTF
(
InOrd”MDU
, "[tid:%i]: The„esult ofƒxecution is 0x%x.\n",

295 
š¡
->
	`»adTid
(), in¡->
	`»adIÁResuÉ
(0));

297 
	`DPRINTF
(
InOrd”MDU
, "[tid:%i]: [sn:%i]: had‡ %s "

298 "çuÉ.\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
çuÉ
->
	`Çme
());

301 
muÉ_div_»q
->
	`£tProûssšg
(
çl£
);

302 
ıu
->
	`wakeCPU
();

303 
	}
}

306 
	gMuÉDivUn™
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
In¡SeqNum
 
squash_£q_num
,

307 
Th»adID
 
tid
)

309 
i
 = 0; i < 
width
; i++) {

310 
ResReqPŒ
 
»q_±r
 = 
»qs
[
i
];

311 
DynIn¡PŒ
 
š¡
 = 
»q_±r
->
	`g‘In¡
();

313 ià(
»q_±r
->
v®id
 &&

314 
š¡
->
	`»adTid
(è=ğ
tid
 &&

315 
š¡
->
£qNum
 > 
squash_£q_num
) {

317 
	`DPRINTF
(
InOrd”MDU
, "[tid:%i]: Squashing [sn:%i].\n",

318 
»q_±r
->
	`g‘In¡
()->
	`»adTid
(),

319 
»q_±r
->
	`g‘In¡
()->
£qNum
);

321 
»q_±r
->
	`£tSquashed
();

323 
»q_¦Ù_num
 = 
»q_±r
->
	`g‘SlÙ
();

325 ià(
»q_±r
->
	`isProûssšg
())

326 
	`DPRINTF
(
InOrd”MDU
, "[tid:%i]: Squashed [sn:%i], but "

328 
»q_±r
->
	`g‘In¡
()->
	`»adTid
(),

329 
»q_±r
->
	`g‘In¡
()->
£qNum
);

331 
	`ä“SlÙ
(
»q_¦Ù_num
);

334 
	}
}

336 
	gMDUEv’t
::
	$MDUEv’t
()

337 : 
	$ResourûEv’t
()

338 { 
	}
}

341 
MDUEv’t
::
	$´oûss
()

343 
MuÉDivUn™
* 
mdu_»s
 = 
»š‹½»t_ÿ¡
<MuÉDivUn™*>(
»sourû
);

345 
mdu_»s
->
	`exeMulDiv
(
¦ÙIdx
);

347 
ResourûReque¡
* 
muÉ_div_»q
 = 
»sourû
->
»qs
[
¦ÙIdx
];

349 ià(
muÉ_div_»q
->
	`isSquashed
())

350 
mdu_»s
->
	`ä“SlÙ
(
¦ÙIdx
);

351 
	}
}

	@inorder/resources/mult_div_unit.hh

32 #iâdeà
__CPU_INORDER_MULT_DIV_UNIT_HH__


33 
	#__CPU_INORDER_MULT_DIV_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/šÜd”/fœ¡_¡age.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/»sourû.hh
"

42 
	~"ıu/func_un™.hh
"

43 
	~"ıu/İ_şass.hh
"

45 
şass
 
	gMDUEv’t
;

47 şas 
	cMuÉDivUn™
 : 
public
 
Resourû
 {

48 
public
:

49 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

51 
	eCommªd
 {

52 
	mS¹MuÉDiv
,

53 
	mEndMuÉDiv
,

54 
	mMuÉDiv


57 
	gpublic
:

58 
MuÉDivUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

59 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

60 
TheP–še
::
P¬ams
 *
·¿ms
);

62 
	gpublic
:

66 
g‘SlÙ
(
DynIn¡PŒ
 
š¡
);

68 
š™
();

71 
g‘DivOpSize
(
DynIn¡PŒ
 
š¡
);

74 
execu‹
(
¦Ù_num
);

76 
exeMulDiv
(
¦Ù_num
);

79 
»gSts
();

81 
»que¡Agaš
(
DynIn¡PŒ
 
š¡
, 
boŞ
 &
Œy_»que¡
);

83 
squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
In¡SeqNum
 
squash_£q_num
,

84 
Th»adID
 
tid
);

86 
	g´Ùeùed
:

88 
muÉR•—tR©e
;

89 
Cyşes
 
	gmuÉL©’cy
;

92 
	gdiv8R•—tR©e
;

93 
Cyşes
 
	gdiv8L©’cy
;

96 
	gdiv16R•—tR©e
;

97 
Cyşes
 
	gdiv16L©’cy
;

100 
	gdiv24R•—tR©e
;

101 
Cyşes
 
	gdiv24L©’cy
;

104 
	gdiv32R•—tR©e
;

105 
Cyşes
 
	gdiv32L©’cy
;

108 
Tick
 
	gÏ¡MDUCyşe
;

111 
OpCÏss
 
	gÏ¡OpTy³
;

114 
ušt32_t
 
	gÏ¡DivSize
;

117 
	g¡d
::
¡ršg
 
Ï¡In¡Name
;

120 
	gSts
::
SÿÏr
 
muÉl›s
;

123 
	gSts
::
SÿÏr
 
divides
;

125 
MDUEv’t
 *
	gmduEv’t
;

128 şas 
	cMDUEv’t
 : 
public
 
ResourûEv’t


130 
public
:

131 
MDUEv’t
();

132 ~
	$MDUEv’t
() { }

135 
	`´oûss
();

136 
	}
};

	@inorder/resources/resource_list.hh

32 #iâdeà
CPU_INORDER_RESOURCE_LIST_HH


33 
	#CPU_INORDER_RESOURCE_LIST_HH


	)

35 
	~"ıu/šÜd”/»sourûs/ag’_un™.hh
"

36 
	~"ıu/šÜd”/»sourûs/b¿nch_´ediùÜ.hh
"

37 
	~"ıu/šÜd”/»sourûs/ÿche_un™.hh
"

38 
	~"ıu/šÜd”/»sourûs/decode_un™.hh
"

39 
	~"ıu/šÜd”/»sourûs/executiÚ_un™.hh
"

40 
	~"ıu/šÜd”/»sourûs/ãtch_£q_un™.hh
"

41 
	~"ıu/šÜd”/»sourûs/ãtch_un™.hh
"

42 
	~"ıu/šÜd”/»sourûs/g¿du©iÚ_un™.hh
"

43 
	~"ıu/šÜd”/»sourûs/š¡_bufãr.hh
"

44 
	~"ıu/šÜd”/»sourûs/muÉ_div_un™.hh
"

48 
	~"ıu/šÜd”/»sourûs/u£_def.hh
"

	@inorder/resources/tlb_unit.cc

32 
	~<li¡
>

33 
	~<veùÜ
>

35 
	~"¬ch/i§_Œa™s.hh
"

36 
	~"cÚfig/the_i§.hh
"

37 
	~"ıu/šÜd”/»sourûs/b_un™.hh
"

38 
	~"ıu/šÜd”/ıu.hh
"

39 
	~"ıu/šÜd”/fœ¡_¡age.hh
"

40 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
usšg
 
Çme¥aû
 
	g¡d
;

43 
usšg
 
Çme¥aû
 
	gTheISA
;

44 
usšg
 
Çme¥aû
 
	gTheP–še
;

46 
	gTLBUn™
::
TLBUn™
(
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

47 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

48 
TheP–še
::
P¬ams
 *
·¿ms
)

49 : 
	$Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
)

52 ià(
»s_Çme
 == "I-TLB")

53 
_b
 = 
·¿ms
->
™b
;

54 ià(
»s_Çme
 == "D-TLB")

55 
_b
 = 
·¿ms
->
dtb
;

57 
	`çl
("Unrecognized TLB‚ame…assed by user");

59 
i
=0; i < 
MaxTh»ads
; i++) {

60 
bBlocked
[
i
] = 
çl£
;

62 
	}
}

64 
	gTheISA
::
TLB
*

65 
TLBUn™
::
	$b
()

67  
_b
;

69 
	}
}

72 
	gTLBUn™
::
	$š™
()

74 
»sourûEv’t
 = 
Ãw
 
TLBUn™Ev’t
[
width
];

76 
i
 = 0; i < 
width
; i++) {

77 
»qs
[
i
] = 
Ãw
 
	`TLBUn™Reque¡
(
this
);

80 
	`š™SlÙs
();

81 
	}
}

84 
	gTLBUn™
::
	$g‘SlÙ
(
DynIn¡PŒ
 
š¡
)

86 ià(
bBlocked
[
š¡
->
th»adNumb”
]) {

89  
Resourû
::
	`g‘SlÙ
(
š¡
);

91 
	}
}

93 
ResourûReque¡
*

94 
	gTLBUn™
::
	$g‘Reque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
,

95 
»s_idx
, 
¦Ù_num
,

96 
cmd
)

98 
TLBUn™Reque¡
 *
b_»q
 = 
dyÇmic_ÿ¡
<TLBUn™Reque¡*>(
»qs
[
¦Ù_num
]);

99 
b_»q
->
	`£tReque¡
(
š¡
, 
¡age_num
, 
id
, 
¦Ù_num
, 
cmd
);

100  
ud_»q
;

101 
	}
}

104 
	gTLBUn™
::
	$execu‹
(
¦Ù_idx
)

108 
TLBUn™Reque¡
* 
b_»q
 = 
dyÇmic_ÿ¡
<TLBUn™Reque¡*>(
»qs
[
¦Ù_idx
]);

109 
	`as£¹
(
b_»q
 != 0x0);

111 
DynIn¡PŒ
 
š¡
 = 
b_»q
->inst;

112 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

113 
In¡SeqNum
 
£q_num
 = 
š¡
->
£qNum
;

114 
¡age_num
 = 
b_»q
->
	`g‘SgeNum
();

116 
b_»q
->
çuÉ
 = 
NoFauÉ
;

118 
	`as£¹
(
ıu
->
th»ad
[
tid
]->
	`g‘TC
() != 0x0);

119 
	`as£¹
(
ıu
->
p–šeSge
[
¡age_num
] != 0x0);

121 
b_»q
->
cmd
)

123 
F‘chLookup
:

125 
b_»q
->
çuÉ
 =

126 
_b
->
	`Œª¦©eAtomic
(
b_»q
->
memReq
,

127 
ıu
->
th»ad
[
tid
]->
	`g‘TC
(), 
TheISA
::
TLB
::
Execu‹
);

129 ià(
b_»q
->
çuÉ
 !ğ
NoFauÉ
) {

130 
	`DPRINTF
(
InOrd”TLB
, "[tid:%i]: %sƒncountered whileranslating "

131 "addr:%08°fÜ [¢:%i].\n", 
tid
, 
b_»q
->
çuÉ
->
	`Çme
(),

132 
b_»q
->
memReq
->
	`g‘Vaddr
(), 
£q_num
);

134 
	`DPRINTF
(
InOrd”TLB
, "¦Ù:%˜¢:%˜scheduËƒv’t.\n", 
¦Ù_idx
, 
£q_num
);

136 
ıu
->
p–šeSge
[
¡age_num
]->
	`£tResSÎ
(
b_»q
, 
tid
);

137 
bBlocked
[
tid
] = 
Œue
;

138 
	`scheduËEv’t
(
¦Ù_idx
, 1);

142 
ıu
->
	`Œ­
(
b_»q
->
çuÉ
, 
tid
);

144 
	`DPRINTF
(
InOrd”TLB
, "[tid:%i]: [sn:%i] virt.‡ddr %08pranslated "

145 "tØphys.‡ddr:%08p.\n", 
tid
, 
£q_num
,

146 
b_»q
->
memReq
->
	`g‘Vaddr
(),

147 
b_»q
->
memReq
->
	`g‘Paddr
());

148 
b_»q
->
	`dÚe
();

153 
D©aR—dLookup
:

154 
D©aWr™eLookup
:

156 
	`DPRINTF
(
InOrd”TLB
, "[tid:%i]: [sn:%i]: Attemptingoranslate %08p.\n",

157 
tid
, 
£q_num
, 
b_»q
->
memReq
->
	`g‘Vaddr
());

160 
TheISA
::
TLB
::
Mode
 
b_mode
 = (
b_»q
->
cmd
 =ğ
D©aR—dLookup
) ?

161 
TheISA
::
TLB
::
R—d
 : TheISA::TLB::
Wr™e
;

163 
b_»q
->
çuÉ
 =

164 
_b
->
	`Œª¦©eAtomic
(
b_»q
->
memReq
,

165 
ıu
->
th»ad
[
tid
]->
	`g‘TC
(), 
b_mode
);

167 ià(
b_»q
->
çuÉ
 !ğ
NoFauÉ
) {

168 
	`DPRINTF
(
InOrd”TLB
, "[tid:%i]: %sƒncountered whileranslating "

169 "addr:%08°fÜ [¢:%i] %s.\n", 
tid
, 
b_»q
->
çuÉ
->
	`Çme
(),

170 
b_»q
->
memReq
->
	`g‘Vaddr
(), 
£q_num
, 
š¡
->
	`š¡Name
());

172 ià(
š¡
->
	`isD©aP»ãtch
()) {

173 
	`DPRINTF
(
InOrd”TLB
, "Ignoring %s fault for data…refetch\n",

174 
b_»q
->
çuÉ
->
	`Çme
());

176 
b_»q
->
çuÉ
 = 
NoFauÉ
;

178 
b_»q
->
	`dÚe
();

180 
ıu
->
p–šeSge
[
¡age_num
]->
	`£tResSÎ
(
b_»q
, 
tid
);

181 
bBlocked
[
tid
] = 
Œue
;

182 
	`scheduËEv’t
(
¦Ù_idx
, 1);

185 
ıu
->
	`Œ­
(
b_»q
->
çuÉ
, 
tid
, 
š¡
);

188 
	`DPRINTF
(
InOrd”TLB
, "[tid:%i]: [sn:%i] virt.‡ddr %08pranslated "

189 "tØphys.‡ddr:%08p.\n", 
tid
, 
£q_num
,

190 
b_»q
->
memReq
->
	`g‘Vaddr
(),

191 
b_»q
->
memReq
->
	`g‘Paddr
());

192 
b_»q
->
	`dÚe
();

198 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

200 
	}
}

202 
	gTLBUn™Ev’t
::
	$TLBUn™Ev’t
()

203 : 
	$ResourûEv’t
()

204 { 
	}
}

207 
TLBUn™Ev’t
::
	$´oûss
()

209 
DynIn¡PŒ
 
š¡
 = 
»sourû
->
»qs
[
¦ÙIdx
]->inst;

210 
¡age_num
 = 
»sourû
->
»qs
[
¦ÙIdx
]->
	`g‘SgeNum
();

211 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

213 
	`DPRINTF
(
InOrd”TLB
, "Waking up from TLB Miss caused by [sn:%i].\n",

214 
š¡
->
£qNum
);

216 
TLBUn™
* 
b_»s
 = 
dyÇmic_ÿ¡
<TLBUn™*>(
»sourû
);

217 
	`as£¹
(
b_»s
);

219 
b_»s
->
bBlocked
[
tid
] = 
çl£
;

221 
b_»s
->
ıu
->
p–šeSge
[
¡age_num
]->

222 
	`un£tResSÎ
(
b_»s
->
»qs
[
¦ÙIdx
], 
tid
);

223 
	}
}

226 
	gTLBUn™
::
	$squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
,

227 
In¡SeqNum
 
squash_£q_num
, 
Th»adID
 
tid
)

229 
i
 = 0; i < 
width
; i++) {

230 
ResReqPŒ
 
»q_±r
 = 
»qs
[
i
];

232 ià(
»q_±r
->
v®id
 &&

233 
»q_±r
->
	`g‘In¡
()->
	`»adTid
(è=ğ
tid
 &&

234 
»q_±r
->
	`g‘In¡
()->
£qNum
 > 
squash_£q_num
) {

236 
	`DPRINTF
(
Resourû
, "[tid:%i]: Squashing [sn:%i].\n",

237 
»q_±r
->
	`g‘In¡
()->
	`»adTid
(),

238 
»q_±r
->
	`g‘In¡
()->
£qNum
);

240 
»q_±r
->
	`£tSquashed
();

242 
»q_¦Ù_num
 = 
»q_±r
->
	`g‘SlÙ
();

244 
bBlocked
[
tid
] = 
çl£
;

246 
¡®l_¡age
 = 
»qs
[
»q_¦Ù_num
]->
	`g‘SgeNum
();

248 
ıu
->
p–šeSge
[
¡®l_¡age
]->

249 
	`un£tResSÎ
(
»qs
[
»q_¦Ù_num
], 
tid
);

251 ià(
»sourûEv’t
[
»q_¦Ù_num
].
	`scheduËd
())

252 
	`unscheduËEv’t
(
»q_¦Ù_num
);

254 
	`ä“SlÙ
(
»q_¦Ù_num
);

257 
	}
}

	@inorder/resources/tlb_unit.hh

32 #iâdeà
__CPU_INORDER_TLB_UNIT_HH__


33 
	#__CPU_INORDER_TLB_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"cÚfig/the_i§.hh
"

40 
	~"ıu/šÜd”/»sourûs/š¡_bufãr.hh
"

41 
	~"ıu/šÜd”/ıu.hh
"

42 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

43 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

45 şas 
	cTLBUn™
 : 
public
 
Resourû


47 
public
:

48 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

50 
	eTLBCommªd
 {

51 
	mF‘chLookup
,

52 
	mD©aR—dLookup
,

53 
	mD©aWr™eLookup


56 
	gpublic
:

57 
TLBUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

58 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

59 
TheP–še
::
P¬ams
 *
·¿ms
);

60 
	gvœtu®
 ~
	$TLBUn™
(è{
	}
}

62 
š™
();

64 
g‘SlÙ
(
DynIn¡PŒ
 
š¡
);

66 
vœtu®
 
ResourûReque¡
* 
g‘Reque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
,

67 
»s_idx
, 
¦Ù_num
,

68 
cmd
);

70 
vœtu®
 
execu‹
(
¦Ù_num
);

72 
squash
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
In¡SeqNum
 
squash_£q_num
,

73 
Th»adID
 
tid
);

75 
boŞ
 
	gbBlocked
[
TheP–še
::
MaxTh»ads
];

77 
	gTheISA
::
TLB
* 
b
();

79 
	g´Ùeùed
:

83 
¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
;

85 
	gTheISA
::
TLB
 *
_b
;

88 şas 
	cTLBUn™Ev’t
 : 
public
 
ResourûEv’t
 {

89 
public
:

91 
TLBUn™Ev’t
();

92 
	mvœtu®
 ~
	$TLBUn™Ev’t
() {}

95 
vœtu®
 
	`´oûss
();

96 
	}
};

98 şas 
	cTLBUn™Reque¡
 : 
public
 
ResourûReque¡
 {

99 
public
:

100 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

102 
	mpublic
:

103 
	$TLBUn™Reque¡
(
TLBUn™
 *
»s
)

104 : 
	`ResourûReque¡
(
»s
), 
	$memReq
(
NULL
)

108 
Reque¡PŒ
 
memReq
;

110 
	$£tReque¡
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
»s_idx
, 
¦Ù_num
,

111 
_cmd
)

113 
Addr
 
®igÃd_addr
;

114 
»q_size
;

115 
æags
;

117 ià(
_cmd
 =ğ
TLBUn™
::
F‘chLookup
) {

118 
®igÃd_addr
 = 
š¡
->
	`g‘MemAddr
();

119 
»q_size
 = (
TheISA
::
MachIn¡
);

120 
æags
 = 0;

121 
š¡
->
ãtchMemReq
 = 
Ãw
 
	`Reque¡
(š¡->
	`»adTid
(), 
®igÃd_addr
,

122 
»q_size
, 
æags
,

123 
»s
->
ıu
->
	`š¡Ma¡”Id
(),

124 
š¡
->
	`š¡Addr
(),

125 
»s
->
ıu
->
	`»adCpuId
(),

126 
š¡
->
	`»adTid
());

127 
memReq
 = 
š¡
->
ãtchMemReq
;

129 
®igÃd_addr
 = 
š¡
->
	`g‘MemAddr
();;

130 
»q_size
 = 0;

131 
æags
 = 0;

133 ià(
»q_size
 =ğ0 && (
š¡
->
	`isD©aP»ãtch
(è|| in¡->
	`isIn¡P»ãtch
())) {

134 
»q_size
 = 8;

137 
š¡
->
d©aMemReq
 = 
Ãw
 
	`Reque¡
(š¡->
	`»adTid
(), 
®igÃd_addr
,

138 
»q_size
, 
æags
,

139 
»s
->
ıu
->
	`d©aMa¡”Id
(),

140 
š¡
->
	`š¡Addr
(),

141 
»s
->
ıu
->
	`»adCpuId
(),

142 
š¡
->
	`»adTid
());

143 
memReq
 = 
š¡
->
d©aMemReq
;

146 
ResourûReque¡
::
	`£tReque¡
(
š¡
, 
¡age_num
, 
»s_idx
, 
¦Ù_num
, 
_cmd
);

147 
	}
}

	@inorder/resources/use_def.cc

33 
	~<li¡
>

34 
	~<veùÜ
>

36 
	~"¬ch/i§_Œa™s.hh
"

37 
	~"cÚfig/the_i§.hh
"

38 
	~"ıu/šÜd”/»sourûs/u£_def.hh
"

39 
	~"ıu/šÜd”/ıu.hh
"

40 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

41 
	~"debug/InOrd”SÎ.hh
"

42 
	~"debug/InOrd”U£Def.hh
"

44 
usšg
 
Çme¥aû
 
	g¡d
;

45 
usšg
 
Çme¥aû
 
	gTheISA
;

46 
usšg
 
Çme¥aû
 
	gTheP–še
;

48 
	gU£DefUn™
::
U£DefUn™
(
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

49 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

50 
TheP–še
::
P¬ams
 *
·¿ms
)

51 : 
	$Resourû
(
»s_Çme
, 
»s_id
, 
»s_width
, 
»s_Ï‹ncy
, 
_ıu
)

53 
Th»adID
 
tid
 = 0;id < 
TheP–še
::
MaxTh»ads
;id++) {

54 
nÚS³cIn¡Aùive
[
tid
] = &
ıu
->nonSpecInstActive[tid];

55 
nÚS³cSeqNum
[
tid
] = &
ıu
->nonSpecSeqNum[tid];

56 
£rŸlizeOnNextIn¡
[
tid
] = 
çl£
;

57 
£rŸlizeAá”SeqNum
[
tid
] = 0;

58 
»gD•M­
[
tid
] = &
ıu
->
¬chRegD•M­
[tid];

61 
	}
}

64 
	gU£DefUn™
::
	$»gSts
()

66 
uniqueRegsP”Sw™ch


67 .
	`Çme
(name() + ".uniqueRegsPerSwitch")

68 .
	`desc
("Number of Unique Registers Needed Per Context Switch")

69 .
	`´”eq
(
uniqueRegsP”Sw™ch
);

71 
štRegFeR—ds


72 .
	`Çme
(name() + ".intRegFileReads")

73 .
	`desc
("Number of Reads from Int. Register File");

75 
štRegFeWr™es


76 .
	`Çme
(name() + ".intRegFileWrites")

77 .
	`desc
("Number of Writeso Int. Register File");

79 
štRegFeAccs


80 .
	`Çme
(name() + ".intRegFileAccesses")

81 .
	`desc
("Total Accesses (Read+Write)ohe Int. Register File");

82 
štRegFeAccs
 = 
štRegFeR—ds
 + 
štRegFeWr™es
;

84 
æßtRegFeR—ds


85 .
	`Çme
(name() + ".floatRegFileReads")

86 .
	`desc
("Number of Reads from FP Register File");

88 
æßtRegFeWr™es


89 .
	`Çme
(name() + ".floatRegFileWrites")

90 .
	`desc
("Number of Writeso FP Register File");

92 
æßtRegFeAccs


93 .
	`Çme
(name() + ".floatRegFileAccesses")

94 .
	`desc
("Total Accesses (Read+Write)ohe FP Register File");

95 
æßtRegFeAccs
 = 
æßtRegFeR—ds
 + 
æßtRegFeWr™es
;

100 
»gFÜw¬ds


101 .
	`Çme
(name() + ".regForwards")

102 .
	`desc
("Number of Registers Read Through Forwarding Logic");

104 
Resourû
::
	`»gSts
();

105 
	}
}

108 
	gU£DefUn™
::
	$š™
()

111 ià(
Ï‹ncy
 > 
	`Cyşes
(0)) {

112 
»sourûEv’t
 = 
Ãw
 
ResourûEv’t
[
width
];

114 
»sourûEv’t
 = 
NULL
;

117 
i
 = 0; i < 
width
; i++) {

118 
»qs
[
i
] = 
Ãw
 
	`U£DefReque¡
(
this
);

121 
	`š™SlÙs
();

122 
	}
}

124 
ResReqPŒ


125 
	gU£DefUn™
::
	$g‘Reque¡
(
DynIn¡PŒ
 
š¡
, 
¡age_num
, 
»s_idx
,

126 
¦Ù_num
, 
cmd
)

128 
U£DefReque¡
 *
ud_»q
 = 
dyÇmic_ÿ¡
<U£DefReque¡*>(
»qs
[
¦Ù_num
]);

129 
ud_»q
->
	`£tReque¡
(
š¡
, 
¡age_num
, 
id
, 
¦Ù_num
, 
cmd
,

130 
š¡
->
curSkedEÁry
->
idx
);

131  
ud_»q
;

132 
	}
}

135 
ResReqPŒ


136 
	gU£DefUn™
::
	$fšdReque¡
(
DynIn¡PŒ
 
š¡
)

138 
i
 = 0; i < 
width
; i++) {

139 
U£DefReque¡
* 
ud_»q
 =

140 
dyÇmic_ÿ¡
<
U£DefReque¡
*>(
»qs
[
i
]);

141 
	`as£¹
(
ud_»q
);

143 ià(
ud_»q
->
v®id
 &&

144 
ud_»q
->
	`g‘In¡
(è=ğ
š¡
 &&

145 
ud_»q
->
cmd
 =ğ
š¡
->
curSkedEÁry
->cmd &&

146 
ud_»q
->
u£DefIdx
 =ğ
š¡
->
curSkedEÁry
->
idx
) {

147  
ud_»q
;

151  
NULL
;

152 
	}
}

155 
	gU£DefUn™
::
	$execu‹
(
¦Ù_idx
)

157 
U£DefReque¡
* 
ud_»q
 = 
dyÇmic_ÿ¡
<U£DefReque¡*>(
»qs
[
¦Ù_idx
]);

158 
DynIn¡PŒ
 
š¡
 = 
ud_»q
->inst;

159 
Th»adID
 
tid
 = 
š¡
->
	`»adTid
();

160 
In¡SeqNum
 
£q_num
 = 
š¡
->
£qNum
;

161 
ud_idx
 = 
ud_»q
->
u£DefIdx
;

163 ià(
£rŸlizeOnNextIn¡
[
tid
] &&

164 
£q_num
 > 
£rŸlizeAá”SeqNum
[
tid
]) {

165 
š¡
->
	`£tS”ŸlizeBefÜe
();

166 
£rŸlizeOnNextIn¡
[
tid
] = 
çl£
;

169 ià((
š¡
->
	`isI´Acûss
(è|| in¡->
	`isS”ŸlizeBefÜe
()) &&

170 
ıu
->
š¡Li¡
[
tid
].
	`äÚt
(è!ğ
š¡
) {

171 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i] Serialize before instructionƒncountered."

172 " Blockšg uÁ…–ši ş—r.\n", 
tid
, 
£q_num
);

173 
ud_»q
->
	`dÚe
(
çl£
);

175 } ià(
š¡
->
	`isStÜeCÚd™iÚ®
(è|| in¡->
	`isS”ŸlizeAá”
()) {

176 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i] Serialize‡fter instructionƒncountered."

177 " Blockšg uÁ…–ši ş—r.\n", 
tid
, 
£q_num
);

178 
£rŸlizeOnNextIn¡
[
tid
] = 
Œue
;

179 
£rŸlizeAá”SeqNum
[
tid
] = 
£q_num
;

182 ià(
š¡
->
çuÉ
 !ğ
NoFauÉ
) {

183 
	`DPRINTF
(
InOrd”U£Def
,

185 "Ãxˆ¡age.\n", 
š¡
->
	`»adTid
(), in¡->
£qNum
, in¡->
çuÉ
->
	`Çme
(),

186 
š¡
->
	`pcS‹
());

187 
ud_»q
->
	`dÚe
();

194 ià(*
nÚS³cIn¡Aùive
[
tid
] =ğ
Œue
 && 
£q_num
 > *
nÚS³cSeqNum
[tid]) {

195 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i] cannotƒxecute because"

197 "g¿du©ed.\n", 
tid
, 
£q_num
, *
nÚS³cSeqNum
[tid]);

198 
ud_»q
->
	`dÚe
(
çl£
);

200 } ià(
š¡
->
	`isNÚS³cuÏtive
()) {

201 *
nÚS³cIn¡Aùive
[
tid
] = 
Œue
;

202 *
nÚS³cSeqNum
[
tid
] = 
£q_num
;

205 
ud_»q
->
cmd
)

207 
R—dSrcReg
:

209 
RegCÏss
 
»g_ty³
;

210 
RegIndex
 
»g_idx
 = 
š¡
->
_¤cRegIdx
[
ud_idx
];

211 
RegIndex
 
æ©_idx
 = 
ıu
->
	`æ©‹nRegIdx
(
»g_idx
, 
»g_ty³
, 
tid
);

212 
š¡
->
	`æ©‹nSrcReg
(
ud_idx
, 
æ©_idx
);

214 ià(
æ©_idx
 =ğ
TheISA
::
Z”oReg
 && 
»g_ty³
 =ğ
IÁRegCÏss
) {

215 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Ignoring Reading of ISA-ZeroReg "

216 "(IÁ. Reg %i).\n", 
tid
, 
š¡
->
£qNum
, 
æ©_idx
);

217 
ud_»q
->
	`dÚe
();

220 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Attemptingo„ead source "

222 
tid
, 
£q_num
, 
ud_idx
, 
»g_idx
, 
æ©_idx
);

225 ià(
»gD•M­
[
tid
]->
	`ÿnR—d
(
»g_ty³
, 
æ©_idx
, 
š¡
)) {

226 
»g_ty³
)

228 
IÁRegCÏss
:

230 
uniqueIÁRegM­
[
æ©_idx
] = 
Œue
;

232 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Reading Int Reg %i"

234 
tid
, 
£q_num
,

235 
»g_idx
, 
æ©_idx
,

236 
ıu
->
	`»adIÁReg
(
æ©_idx
,
š¡
->
	`»adTid
()));

237 
š¡
->
	`£tIÁSrc
(
ud_idx
,

238 
ıu
->
	`»adIÁReg
(
æ©_idx
,

239 
š¡
->
	`»adTid
()));

240 
štRegFeR—ds
++;

244 
FlßtRegCÏss
:

246 
uniqueFlßtRegM­
[
æ©_idx
] = 
Œue
;

247 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Reading Float Reg %i"

249 
tid
, 
£q_num
,

250 
»g_idx
 - 
FP_Reg_Ba£
, 
æ©_idx
,

251 
ıu
->
	`»adFlßtRegB™s
(
æ©_idx
,

252 
š¡
->
	`»adTid
()),

253 
ıu
->
	`»adFlßtReg
(
æ©_idx
,

254 
š¡
->
	`»adTid
()));

256 
š¡
->
	`£tFlßtSrc
(
ud_idx
,

257 
ıu
->
	`»adFlßtReg
(
æ©_idx
,

258 
š¡
->
	`»adTid
()));

259 
š¡
->
	`£tFlßtRegB™sSrc
(
ud_idx
,

260 
ıu
->
	`»adFlßtRegB™s
(
æ©_idx
,

261 
š¡
->
	`»adTid
()));

262 
æßtRegFeR—ds
++;

266 
MiscRegCÏss
:

268 
uniqueMiscRegM­
[
æ©_idx
] = 
Œue
;

269 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Reading Misc Reg %i "

271 
tid
, 
£q_num
,

272 
»g_idx
 - 
Misc_Reg_Ba£
, 
æ©_idx
,

273 
ıu
->
	`»adMiscReg
(
æ©_idx
,

274 
š¡
->
	`»adTid
()));

275 
š¡
->
	`£tIÁSrc
(
ud_idx
,

276 
ıu
->
	`»adMiscReg
(
æ©_idx
,

277 
š¡
->
	`»adTid
()));

282 
	`·nic
("Inv®id Regi¡” Ty³: %i", 
»g_ty³
);

285 
ud_»q
->
	`dÚe
();

288 
DynIn¡PŒ
 
fÜw¬d_š¡
 = 
»gD•M­
[
tid
]->
	`ÿnFÜw¬d
(
»g_ty³
,

289 
æ©_idx
,

290 
š¡
);

292 ià(
fÜw¬d_š¡
) {

293 
de¡_»g_idx
 =

294 
fÜw¬d_š¡
->
	`g‘De¡IdxNum
(
æ©_idx
);

296 
»g_ty³
)

298 
IÁRegCÏss
:

300 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: Forwarding dest."

303 
tid
, 
»g_idx
, 
æ©_idx
,

304 
fÜw¬d_š¡
->
	`»adIÁResuÉ
(
de¡_»g_idx
),

305 
fÜw¬d_š¡
->
£qNum
,

306 
š¡
->
£qNum
, 
ud_idx
);

307 
š¡
->
	`£tIÁSrc
(
ud_idx
,

308 
fÜw¬d_š¡
->

309 
	`»adIÁResuÉ
(
de¡_»g_idx
));

313 
FlßtRegCÏss
:

315 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: Forwarding dest."

318 
tid
, 
»g_idx
 - 
FP_Reg_Ba£
, 
æ©_idx
,

319 
fÜw¬d_š¡
->
	`»adFlßtResuÉ
(
de¡_»g_idx
),

320 
fÜw¬d_š¡
->
£qNum
, 
š¡
->£qNum, 
ud_idx
);

321 
š¡
->
	`£tFlßtSrc
(
ud_idx
,

322 
fÜw¬d_š¡
->

323 
	`»adFlßtResuÉ
(
de¡_»g_idx
));

327 
MiscRegCÏss
:

329 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: Forwarding dest."

332 
tid
, 
»g_idx
 - 
Misc_Reg_Ba£
, 
æ©_idx
,

333 
fÜw¬d_š¡
->
	`»adIÁResuÉ
(
de¡_»g_idx
),

334 
fÜw¬d_š¡
->
£qNum
,

335 
š¡
->
£qNum
, 
ud_idx
);

336 
š¡
->
	`£tIÁSrc
(
ud_idx
,

337 
fÜw¬d_š¡
->

338 
	`»adIÁResuÉ
(
de¡_»g_idx
));

343 
	`·nic
("Inv®id Regi¡” Ty³: %i", 
»g_ty³
);

346 
»gFÜw¬ds
++;

347 
ud_»q
->
	`dÚe
();

349 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: Source„egister idx: %i "

351 
tid
, 
»g_idx
);

352 
	`DPRINTF
(
InOrd”SÎ
, "STALL: [tid:%i]: waitingo„ead "

354 
tid
, 
»g_idx
);

355 
ud_»q
->
	`dÚe
(
çl£
);

361 
Wr™eDe¡Reg
:

363 
RegCÏss
 
»g_ty³
;

364 
RegIndex
 
»g_idx
 = 
š¡
->
_de¡RegIdx
[
ud_idx
];

365 
RegIndex
 
æ©_idx
 = 
ıu
->
	`æ©‹nRegIdx
(
»g_idx
, 
»g_ty³
, 
tid
);

367 ià(
æ©_idx
 =ğ
TheISA
::
Z”oReg
 && 
»g_ty³
 =ğ
IÁRegCÏss
) {

368 
	`DPRINTF
(
IÁRegs
, "[tid:%i]: Ignoring Writing of ISA-ZeroReg "

369 "(IÁ. Reg %i)\n", 
tid
, 
æ©_idx
);

370 
ud_»q
->
	`dÚe
();

374 ià(
»gD•M­
[
tid
]->
	`ÿnWr™e
(
»g_ty³
, 
æ©_idx
, 
š¡
)) {

375 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Flattening„egister idx %i "

377 
tid
, 
£q_num
, 
»g_idx
, 
æ©_idx
);

379 
»g_ty³
)

381 
IÁRegCÏss
:

383 
uniqueIÁRegM­
[
æ©_idx
] = 
Œue
;

385 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Writing Int. Result "

387 
tid
, 
£q_num
, 
š¡
->
	`»adIÁResuÉ
(
ud_idx
),

388 
»g_idx
, 
æ©_idx
);

391 
»gD•M­
[
tid
]->
	`»moveFrÚt
(
»g_ty³
, 
æ©_idx
, 
š¡
);

393 
ıu
->
	`£tIÁReg
(
æ©_idx
,

394 
š¡
->
	`»adIÁResuÉ
(
ud_idx
),

395 
š¡
->
	`»adTid
());

396 
štRegFeWr™es
++;

400 
FlßtRegCÏss
:

402 
uniqueFlßtRegM­
[
æ©_idx
] = 
Œue
;

405 
»gD•M­
[
tid
]->
	`»moveFrÚt
(
»g_ty³
, 
æ©_idx
, 
š¡
);

407 ià(
š¡
->
	`»suÉTy³
(
ud_idx
) ==

408 
InOrd”DynIn¡
::
FlßtB™s
) {

409 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Writing FP-Bits "

412 
tid
, 
£q_num
,

413 
š¡
->
	`»adFlßtResuÉ
(
ud_idx
),

414 
š¡
->
	`»adFlßtB™sResuÉ
(
ud_idx
),

415 
»g_idx
 - 
FP_Reg_Ba£
, 
æ©_idx
);

418 
ıu
->
	`£tFlßtRegB™s
(
æ©_idx
,

419 
š¡
->
	`»adFlßtB™sResuÉ
(
ud_idx
),

420 
š¡
->
	`»adTid
());

421 } ià(
š¡
->
	`»suÉTy³
(
ud_idx
) ==

422 
InOrd”DynIn¡
::
Flßt
) {

423 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Writing Float "

426 
tid
, 
£q_num
, 
š¡
->
	`»adFlßtResuÉ
(
ud_idx
),

427 
š¡
->
	`»adIÁResuÉ
(
ud_idx
),

428 
»g_idx
 - 
FP_Reg_Ba£
, 
æ©_idx
);

430 
ıu
->
	`£tFlßtReg
(
æ©_idx
,

431 
š¡
->
	`»adFlßtResuÉ
(
ud_idx
),

432 
š¡
->
	`»adTid
());

433 } ià(
š¡
->
	`»suÉTy³
(
ud_idx
) ==

434 
InOrd”DynIn¡
::
DoubË
) {

435 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Writing Double "

438 
tid
, 
£q_num
,

439 
š¡
->
	`»adFlßtResuÉ
(
ud_idx
),

440 
š¡
->
	`»adIÁResuÉ
(
ud_idx
),

441 
»g_idx
 - 
FP_Reg_Ba£
, 
æ©_idx
);

443 
ıu
->
	`£tFlßtReg
(
æ©_idx
,

444 
š¡
->
	`»adFlßtResuÉ
(
ud_idx
),

445 
š¡
->
	`»adTid
());

447 
	`·nic
("Result Type Not Set For [sn:%i] %s.\n",

448 
š¡
->
£qNum
, in¡->
	`š¡Name
());

451 
æßtRegFeWr™es
++;

455 
MiscRegCÏss
:

457 
uniqueMiscRegM­
[
æ©_idx
] = 
Œue
;

459 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: Writing Misc. 0x%x "

461 
tid
, 
š¡
->
	`»adIÁResuÉ
(
ud_idx
), 
»g_idx
 - 
Misc_Reg_Ba£
);

464 
»gD•M­
[
tid
]->
	`»moveFrÚt
(
»g_ty³
, 
æ©_idx
, 
š¡
);

466 
ıu
->
	`£tMiscReg
(
æ©_idx
,

467 
š¡
->
	`»adIÁResuÉ
(
ud_idx
),

468 
š¡
->
	`»adTid
());

473 
	`·nic
("Inv®id Regi¡” Ty³: %i", 
»g_ty³
);

476 
ud_»q
->
	`dÚe
();

478 
	`DPRINTF
(
InOrd”U£Def
, "[tid:%i]: [sn:%i]: Dest.„egister idx: %i is "

480 
tid
, 
£q_num
, 
»g_idx
);

481 
	`DPRINTF
(
InOrd”SÎ
, "STALL: [tid:%i]: waitingo write "

483 
tid
, 
»g_idx
);

484 
ud_»q
->
	`dÚe
(
çl£
);

489 
M¬kDe¡Regs
:

491 
»gD•M­
[
tid
]->
	`š£¹
(
š¡
);

492 
ud_»q
->
	`dÚe
();

497 
	`çl
("UÄecognized commªdØ%s", 
»sName
);

500 
	}
}

503 
	gU£DefUn™
::
	$upd©eAá”CÚ‹xtSw™ch
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
)

505 
uniqueRegsP”Sw™ch
 = 
uniqueIÁRegM­
.
	`size
(è+ 
uniqueFlßtRegM­
.size()

506 + 
uniqueMiscRegM­
.
	`size
();

507 
uniqueIÁRegM­
.
	`ş—r
();

508 
uniqueFlßtRegM­
.
	`ş—r
();

509 
uniqueMiscRegM­
.
	`ş—r
();

510 
	}
}

	@inorder/resources/use_def.hh

32 #iâdeà
__CPU_INORDER_USE_DEF_UNIT_HH__


33 
	#__CPU_INORDER_USE_DEF_UNIT_HH__


	)

35 
	~<li¡
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ıu/šÜd”/fœ¡_¡age.hh
"

40 
	~"ıu/šÜd”/šÜd”_dyn_š¡.hh
"

41 
	~"ıu/šÜd”/p–še_Œa™s.hh
"

42 
	~"ıu/šÜd”/»g_d•_m­.hh
"

43 
	~"ıu/šÜd”/»sourû.hh
"

44 
	~"ıu/func_un™.hh
"

46 şas 
	cU£DefUn™
 : 
public
 
Resourû
 {

47 
public
:

48 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

49 
	mTheISA
::
	tRegIndex
 RegIndex;

51 
	eCommªd
 {

52 
	mR—dSrcReg
,

53 
	mWr™eDe¡Reg
,

54 
	mM¬kDe¡Regs


57 
	gpublic
:

58 
U£DefUn™
(
¡d
::
¡ršg
 
»s_Çme
, 
»s_id
, 
»s_width
,

59 
Cyşes
 
»s_Ï‹ncy
, 
InOrd”CPU
 *
_ıu
,

60 
TheP–še
::
P¬ams
 *
·¿ms
);

62 
š™
();

64 
ResourûReque¡
* 
g‘Reque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
,

65 
»s_idx
, 
¦Ù_num
,

66 
cmd
);

68 
ResReqPŒ
 
fšdReque¡
(
DynIn¡PŒ
 
š¡
);

70 
execu‹
(
¦Ù_num
);

72 
upd©eAá”CÚ‹xtSw™ch
(
DynIn¡PŒ
 
š¡
, 
Th»adID
 
tid
);

74 
»gSts
();

76 
	g´Ùeùed
:

77 
RegD•M­
 *
»gD•M­
[
TheP–še
::
MaxTh»ads
];

79 
boŞ
 *
	gnÚS³cIn¡Aùive
[
TheP–še
::
MaxTh»ads
];

80 
In¡SeqNum
 *
	gnÚS³cSeqNum
[
TheP–še
::
MaxTh»ads
];

82 
boŞ
 
	g£rŸlizeOnNextIn¡
[
TheP–še
::
MaxTh»ads
];

83 
In¡SeqNum
 
	g£rŸlizeAá”SeqNum
[
TheP–še
::
MaxTh»ads
];

85 
	gSts
::
Av”age
 
uniqueRegsP”Sw™ch
;

86 
	g¡d
::
m­
<
RegIndex
, 
	gboŞ
> 
	guniqueIÁRegM­
;

87 
	g¡d
::
m­
<
RegIndex
, 
	gboŞ
> 
	guniqueFlßtRegM­
;

88 
	g¡d
::
m­
<
RegIndex
, 
	gboŞ
> 
	guniqueMiscRegM­
;

90 
	gpublic
:

91 şas 
	cU£DefReque¡
 : 
public
 
ResourûReque¡
 {

92 
public
:

93 
TheP–še
::
	tDynIn¡PŒ
 DynInstPtr;

95 
	gpublic
:

96 
U£DefReque¡
(
U£DefUn™
 *
»s
)

97 : 
ResourûReque¡
(
»s
)

100 
u£DefIdx
;

102 
£tReque¡
(
DynIn¡PŒ
 
_š¡
, 
¡age_num
, 
»s_idx
,

103 
¦Ù_num
, 
_cmd
, 
idx
)

105 
	gu£DefIdx
 = 
idx
;

107 
	gResourûReque¡
::
£tReque¡
(
_š¡
, 
¡age_num
, 
»s_idx
, 
¦Ù_num
,

108 
_cmd
);

112 
	g´Ùeùed
:

114 
Sts
::
SÿÏr
 
štRegFeR—ds
;

117 
	gSts
::
SÿÏr
 
štRegFeWr™es
;

120 
	gSts
::
FÜmuÏ
 
štRegFeAccs
;

123 
	gSts
::
SÿÏr
 
æßtRegFeR—ds
;

126 
	gSts
::
SÿÏr
 
æßtRegFeWr™es
;

129 
	gSts
::
FÜmuÏ
 
æßtRegFeAccs
;

132 
	gSts
::
SÿÏr
 
»gFÜw¬ds
;

	@inorder/thread_context.cc

45 
	~"¬ch/i§_Œa™s.hh
"

46 
	~"cÚfig/the_i§.hh
"

47 
	~"ıu/šÜd”/th»ad_cÚ‹xt.hh
"

48 
	~"ıu/ex‘¿û.hh
"

49 
	~"debug/InOrd”CPU.hh
"

50 
	~"sim/fuÎ_sy¡em.hh
"

52 
usšg
 
Çme¥aû
 
	gTheISA
;

54 
	gFST¿n¦©šgPÜtProxy
&

55 
	gInOrd”Th»adCÚ‹xt
::
	$g‘VœtProxy
()

57  
th»ad
->
	`g‘VœtProxy
();

58 
	}
}

61 
	gInOrd”Th»adCÚ‹xt
::
	$dumpFuncProfe
()

63 
th»ad
->
	`dumpFuncProfe
();

64 
	}
}

67 
Tick


68 
	gInOrd”Th»adCÚ‹xt
::
	$»adLa¡Aùiv©e
()

70  
th»ad
->
Ï¡Aùiv©e
;

71 
	}
}

74 
Tick


75 
	gInOrd”Th»adCÚ‹xt
::
	$»adLa¡Su¥’d
()

77  
th»ad
->
Ï¡Su¥’d
;

78 
	}
}

82 
	gInOrd”Th»adCÚ‹xt
::
	$´ofeCË¬
()

84 
th»ad
->
	`´ofeCË¬
();

85 
	}
}

89 
	gInOrd”Th»adCÚ‹xt
::
	$´ofeSam¶e
()

91 
th»ad
->
	`´ofeSam¶e
();

92 
	}
}

95 
	gInOrd”Th»adCÚ‹xt
::
	$keOv”From
(
Th»adCÚ‹xt
 *
Şd_cÚ‹xt
)

97 ::
	`keOv”From
(*
this
, *
Şd_cÚ‹xt
);

99 
th»ad
->
funcExeIn¡
 = 
Şd_cÚ‹xt
->
	`»adFuncExeIn¡
();

101 
th»ad
->
noSquashFromTC
 = 
çl£
;

102 
th»ad
->
Œ­P’dšg
 = 
çl£
;

103 
	}
}

106 
	gInOrd”Th»adCÚ‹xt
::
	$aùiv©e
(
Cyşes
 
d–ay
)

108 
	`DPRINTF
(
InOrd”CPU
, "Calling‡ctivate on Thread Context %d\n",

109 
	`g‘Th»adNum
());

111 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
)

114 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
Aùive
);

116 
ıu
->
	`aùiv©eCÚ‹xt
(
th»ad
->
	`th»adId
(), 
d–ay
);

117 
	}
}

121 
	gInOrd”Th»adCÚ‹xt
::
	$su¥’d
(
Cyşes
 
d–ay
)

123 
	`DPRINTF
(
InOrd”CPU
, "Calling suspend on Thread Context %d\n",

124 
	`g‘Th»adNum
());

126 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Su¥’ded
)

129 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
Su¥’ded
);

130 
ıu
->
	`su¥’dCÚ‹xt
(
th»ad
->
	`th»adId
());

131 
	}
}

134 
	gInOrd”Th»adCÚ‹xt
::
	$h®t
(
Cyşes
 
d–ay
)

136 
	`DPRINTF
(
InOrd”CPU
, "Calling halt on Thread Context %d\n",

137 
	`g‘Th»adNum
());

139 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
H®‹d
)

142 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
H®‹d
);

143 
ıu
->
	`h®tCÚ‹xt
(
th»ad
->
	`th»adId
());

144 
	}
}

148 
	gInOrd”Th»adCÚ‹xt
::
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
)

150 ià(
FuÎSy¡em
) {

151 
th»ad
->
k”ÃlSts
 = 
Ãw
 
TheISA
::
K”Ãl
::
Sti¡ics
(
ıu
->
sy¡em
);

152 
	gth»ad
->
	gk”ÃlSts
->
»gSts
(
Çme
 + ".kern");

157 
	gInOrd”Th»adCÚ‹xt
::
	$cİyArchRegs
(
Th»adCÚ‹xt
 *
¤c_tc
)

159 
TheISA
::
	`cİyRegs
(
¤c_tc
, 
this
);

160 
	}
}

164 
	gInOrd”Th»adCÚ‹xt
::
	$ş—rArchRegs
()

166 
ıu
->
i§
[
th»ad
->
	`th»adId
()]->
	`ş—r
();

167 
	}
}

170 
ušt64_t


171 
	gInOrd”Th»adCÚ‹xt
::
	$»adIÁReg
(
»g_idx
)

173 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

174 
»g_idx
 = 
ıu
->
i§
[
tid
]->
	`æ©‹nIÁIndex
(reg_idx);

175  
ıu
->
	`»adIÁReg
(
»g_idx
, 
tid
);

176 
	}
}

178 
FlßtReg


179 
	gInOrd”Th»adCÚ‹xt
::
	$»adFlßtReg
(
»g_idx
)

181 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

182 
»g_idx
 = 
ıu
->
i§
[
tid
]->
	`æ©‹nFlßtIndex
(reg_idx);

183  
ıu
->
	`»adFlßtReg
(
»g_idx
, 
tid
);

184 
	}
}

186 
FlßtRegB™s


187 
	gInOrd”Th»adCÚ‹xt
::
	$»adFlßtRegB™s
(
»g_idx
)

189 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

190 
»g_idx
 = 
ıu
->
i§
[
tid
]->
	`æ©‹nFlßtIndex
(reg_idx);

191  
ıu
->
	`»adFlßtRegB™s
(
»g_idx
, 
tid
);

192 
	}
}

194 
CCReg


195 
	gInOrd”Th»adCÚ‹xt
::
	$»adCCReg
(
»g_idx
)

197 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

198 
»g_idx
 = 
ıu
->
i§
[
tid
]->
	`æ©‹nCCIndex
(reg_idx);

199  
ıu
->
	`»adCCReg
(
»g_idx
, 
tid
);

200 
	}
}

202 
ušt64_t


203 
	gInOrd”Th»adCÚ‹xt
::
	$»adRegOth”Th»ad
(
»g_idx
, 
Th»adID
 
tid
)

205  
ıu
->
	`»adRegOth”Th»ad
(
»g_idx
, 
tid
);

206 
	}
}

209 
	gInOrd”Th»adCÚ‹xt
::
	$£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
)

211 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

212 
»g_idx
 = 
ıu
->
i§
[
tid
]->
	`æ©‹nIÁIndex
(reg_idx);

213 
ıu
->
	`£tIÁReg
(
»g_idx
, 
v®
, 
tid
);

214 
	}
}

217 
	gInOrd”Th»adCÚ‹xt
::
	$£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
)

219 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

220 
»g_idx
 = 
ıu
->
i§
[
tid
]->
	`æ©‹nFlßtIndex
(reg_idx);

221 
ıu
->
	`£tFlßtReg
(
»g_idx
, 
v®
, 
tid
);

222 
	}
}

225 
	gInOrd”Th»adCÚ‹xt
::
	$£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
)

227 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

228 
»g_idx
 = 
ıu
->
i§
[
tid
]->
	`æ©‹nFlßtIndex
(reg_idx);

229 
ıu
->
	`£tFlßtRegB™s
(
»g_idx
, 
v®
, 
tid
);

230 
	}
}

233 
	gInOrd”Th»adCÚ‹xt
::
	$£tCCReg
(
»g_idx
, 
CCReg
 
v®
)

235 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

236 
»g_idx
 = 
ıu
->
i§
[
tid
]->
	`æ©‹nCCIndex
(reg_idx);

237 
ıu
->
	`£tCCReg
(
»g_idx
, 
v®
, 
tid
);

238 
	}
}

241 
	gInOrd”Th»adCÚ‹xt
::
	$£tRegOth”Th»ad
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
,

242 
Th»adID
 
tid
)

244 
ıu
->
	`£tRegOth”Th»ad
(
misc_»g
, 
v®
, 
tid
);

245 
	}
}

248 
	gInOrd”Th»adCÚ‹xt
::
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

250 
ıu
->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
, 
th»ad
->
	`th»adId
());

251 
	}
}

254 
	gInOrd”Th»adCÚ‹xt
::
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

256 
ıu
->
	`£tMiscReg
(
misc_»g
, 
v®
, 
th»ad
->
	`th»adId
());

257 
	}
}

260 
ušt64_t


261 
	gInOrd”Th»adCÚ‹xt
::
	$»adIÁRegFÏt
(
idx
)

263 cÚ¡ 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

264  
ıu
->
	`»adIÁReg
(
idx
, 
tid
);

265 
	}
}

268 
	gInOrd”Th»adCÚ‹xt
::
	$£tIÁRegFÏt
(
idx
, 
ušt64_t
 
v®
)

270 cÚ¡ 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

271 
ıu
->
	`£tIÁReg
(
idx
, 
v®
, 
tid
);

272 
	}
}

274 
FlßtReg


275 
	gInOrd”Th»adCÚ‹xt
::
	$»adFlßtRegFÏt
(
idx
)

277 cÚ¡ 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

278  
ıu
->
	`»adFlßtReg
(
idx
, 
tid
);

279 
	}
}

282 
	gInOrd”Th»adCÚ‹xt
::
	$£tFlßtRegFÏt
(
idx
, 
FlßtReg
 
v®
)

284 cÚ¡ 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

285 
ıu
->
	`£tFlßtReg
(
idx
, 
v®
, 
tid
);

286 
	}
}

288 
FlßtRegB™s


289 
	gInOrd”Th»adCÚ‹xt
::
	$»adFlßtRegB™sFÏt
(
idx
)

291 cÚ¡ 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

292  
ıu
->
	`»adFlßtRegB™s
(
idx
, 
tid
);

293 
	}
}

296 
	gInOrd”Th»adCÚ‹xt
::
	$£tFlßtRegB™sFÏt
(
idx
, 
FlßtRegB™s
 
v®
)

298 cÚ¡ 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

299 
ıu
->
	`£tFlßtRegB™s
(
idx
, 
v®
, 
tid
);

300 
	}
}

302 
CCReg


303 
	gInOrd”Th»adCÚ‹xt
::
	$»adCCRegFÏt
(
idx
)

305 cÚ¡ 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

306  
ıu
->
	`»adCCReg
(
idx
, 
tid
);

307 
	}
}

310 
	gInOrd”Th»adCÚ‹xt
::
	$£tCCRegFÏt
(
idx
, 
CCReg
 
v®
)

312 cÚ¡ 
Th»adID
 
tid
 = 
th»ad
->
	`th»adId
();

313 
ıu
->
	`£tCCReg
(
idx
, 
v®
, 
tid
);

314 
	}
}

	@inorder/thread_context.hh

45 #iâdeà
__CPU_INORDER_THREAD_CONTEXT_HH__


46 
	#__CPU_INORDER_THREAD_CONTEXT_HH__


	)

48 
	~"cÚfig/the_i§.hh
"

49 
	~"ıu/šÜd”/ıu.hh
"

50 
	~"ıu/šÜd”/th»ad_¡©e.hh
"

51 
	~"ıu/ex‘¿û.hh
"

52 
	~"ıu/th»ad_cÚ‹xt.hh
"

53 
	~"¬ch/k”Ãl_¡©s.hh
"

55 
şass
 
	gEndQu›sûEv’t
;

56 
şass
 
	gCheck”CPU
;

57 
Çme¥aû
 
	gK”Ãl
 {

58 
şass
 
	gSti¡ics
;

74 şas 
	cInOrd”Th»adCÚ‹xt
 : 
public
 
Th»adCÚ‹xt


76 
public
:

77 
	$InOrd”Th»adCÚ‹xt
() { }

80 
InOrd”CPU
 *
ıu
;

83 
InOrd”Th»adS‹
 *
th»ad
;

87 
TheISA
::
TLB
 *
	$g‘ITBPŒ
(è{  
ıu
->
	`g‘ITBPŒ
(); 
	}
}

91 
	gTheISA
::
TLB
 *
	$g‘DTBPŒ
(è{  
ıu
->
	`g‘DTBPŒ
(); 
	}
}

97 
Check”CPU
 *
	$g‘Check”CpuPŒ
(è{  
NULL
; 
	}
}

99 
	gTheISA
::
Decod”
 *

100 
	$g‘Decod”PŒ
()

102  
ıu
->
	`g‘Decod”PŒ
(
th»ad
->
	`cÚ‹xtId
());

103 
	}
}

105 
Sy¡em
 *
	$g‘Sy¡emPŒ
(è{  
ıu
->
sy¡em
; 
	}
}

108 
Ba£CPU
 *
	$g‘CpuPŒ
(è{  
ıu
; 
	}
}

111 
	g¡d
::
¡ršg
 
	$g‘CpuName
(è{  
ıu
->
	`Çme
(); 
	}
}

114 
	$ıuId
(è{  
ıu
->
	`ıuId
(); 
	}
}

116 
	$cÚ‹xtId
(è{  
th»ad
->
	`cÚ‹xtId
(); 
	}
}

118 
	$£tCÚ‹xtId
(
id
è{ 
th»ad
->
	`£tCÚ‹xtId
(id); 
	}
}

121 
	$th»adId
(è{  
th»ad
->
	`th»adId
(); 
	}
}

122 
	$£tTh»adId
(
id
è{  
th»ad
->
	`£tTh»adId
(id); 
	}
}

124 
ušt64_t
 
	$»adMiüoPC
()

125 {  0; 
	}
}

127 
	$£tMiüoPC
(
ušt64_t
 
v®
è{ 
	}
};

129 
ušt64_t
 
	$»adNextMiüoPC
()

130 {  0; 
	}
}

132 
	$£tNextMiüoPC
(
ušt64_t
 
v®
è{ 
	}
};

135 
	gTheISA
::
K”Ãl
::
Sti¡ics
 *
	$g‘K”ÃlSts
()

136 {  
th»ad
->
k”ÃlSts
; 
	}
}

138 
	gPÜtProxy
 &
	$g‘PhysProxy
(è{  
th»ad
->
	`g‘PhysProxy
(); 
	}
}

140 
	gFST¿n¦©šgPÜtProxy
 &
g‘VœtProxy
();

142 
	$š™MemProx›s
(
Th»adCÚ‹xt
 *
tc
)

143 { 
th»ad
->
	`š™MemProx›s
(
tc
); 
	}
}

148 
dumpFuncProfe
();

151 
Tick
 
»adLa¡Aùiv©e
();

153 
Tick
 
»adLa¡Su¥’d
();

156 
´ofeCË¬
();

159 
´ofeSam¶e
();

162 
EndQu›sûEv’t
 *
	$g‘Qu›sûEv’t
()

164  
this
->
th»ad
->
qu›sûEv’t
;

165 
	}
}

167 
	gSET¿n¦©šgPÜtProxy
 &
	$g‘MemProxy
(è{  
th»ad
->
	`g‘MemProxy
(); 
	}
}

170 
Proûss
 *
	$g‘ProûssPŒ
(è{  
th»ad
->
	`g‘ProûssPŒ
(); 
	}
}

173 
Stus
 
	$¡©us
(ècÚ¡ {  
th»ad
->
	`¡©us
(); 
	}
}

176 
	$£tStus
(
Stus
 
Ãw_¡©us
)

177 { 
th»ad
->
	`£tStus
(
Ãw_¡©us
); 
	}
}

181 
aùiv©e
(
Cyşes
 
d–ay
 = Cycles(1));

184 
su¥’d
(
Cyşes
 
d–ay
 = Cycles(0));

187 
h®t
(
Cyşes
 
d–ay
 = Cycles(0));

190 
keOv”From
(
Th»adCÚ‹xt
 *
Şd_cÚ‹xt
);

193 
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
);

196 
	$g‘Th»adNum
(è{  
th»ad
->
	`th»adId
(); 
	}
}

199 
cİyArchRegs
(
Th»adCÚ‹xt
 *
¤c_tc
);

202 
ş—rArchRegs
();

205 
ušt64_t
 
»adIÁReg
(
»g_idx
);

207 
FlßtReg
 
»adFlßtReg
(
»g_idx
);

209 
FlßtRegB™s
 
»adFlßtRegB™s
(
»g_idx
);

211 
CCReg
 
»adCCReg
(
»g_idx
);

213 
ušt64_t
 
»adRegOth”Th»ad
(
misc_»g
, 
Th»adID
 
tid
);

216 
£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
);

218 
£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
);

220 
£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
);

222 
£tCCReg
(
»g_idx
, 
CCReg
 
v®
);

224 
£tRegOth”Th»ad
(
misc_»g
,

225 cÚ¡ 
MiscReg
 &
v®
,

226 
Th»adID
 
tid
);

229 
	gTheISA
::
PCS‹
 
	$pcS‹
()

230 {  
ıu
->
	`pcS‹
(
th»ad
->
	`th»adId
()); 
	}
}

233 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

234 { 
ıu
->
pcS‹
(
v®
, 
th»ad
->
th»adId
()); }

239 
pcS‹NoRecÜd
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

242 
Addr
 
	$š¡Addr
()

243 {  
ıu
->
	`š¡Addr
(
th»ad
->
	`th»adId
()); 
	}
}

245 
Addr
 
	$ÃxtIn¡Addr
()

246 {  
ıu
->
	`ÃxtIn¡Addr
(
th»ad
->
	`th»adId
()); 
	}
}

248 
MiüoPC
 
	$miüoPC
()

249 {  
ıu
->
	`miüoPC
(
th»ad
->
	`th»adId
()); 
	}
}

252 
MiscReg
 
	$»adMiscRegNoEfãù
(
misc_»g
)

253 {  
ıu
->
	`»adMiscRegNoEfãù
(
misc_»g
, 
th»ad
->
	`th»adId
()); 
	}
}

257 
MiscReg
 
	$»adMiscReg
(
misc_»g
)

258 {  
ıu
->
	`»adMiscReg
(
misc_»g
, 
th»ad
->
	`th»adId
()); 
	}
}

261 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

265 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

267 
	$æ©‹nIÁIndex
(
»g
)

268 {  
ıu
->
i§
[
th»ad
->
	`th»adId
()]->
	`æ©‹nIÁIndex
(
»g
); 
	}
}

270 
	$æ©‹nFlßtIndex
(
»g
)

271 {  
ıu
->
i§
[
th»ad
->
	`th»adId
()]->
	`æ©‹nFlßtIndex
(
»g
); 
	}
}

273 
	$æ©‹nCCIndex
(
»g
)

274 {  
ıu
->
i§
[
th»ad
->
	`th»adId
()]->
	`æ©‹nCCIndex
(
»g
); 
	}
}

276 
	$aùiv©eCÚ‹xt
(
Cyşes
 
d–ay
)

277 { 
ıu
->
	`aùiv©eCÚ‹xt
(
th»ad
->
	`th»adId
(), 
d–ay
); 
	}
}

279 
	$d—Îoÿ‹CÚ‹xt
()

280 { 
ıu
->
	`d—Îoÿ‹CÚ‹xt
(
th»ad
->
	`th»adId
()); 
	}
}

284 
	$»adStCÚdFau»s
()

285 {  
th»ad
->
¡ÜeCÚdFau»s
; 
	}
}

288 
	$£tStCÚdFau»s
(
sc_çu»s
)

289 { 
th»ad
->
¡ÜeCÚdFau»s
 = 
sc_çu»s
; 
	}
}

297 
boŞ
 
	$mis¥ecuÏtšg
(è{  
çl£
; 
	}
}

300 
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

301 {  
ıu
->
	`sysÿÎ
(
ÿÎnum
, 
th»ad
->
	`th»adId
()); 
	}
}

304 
CouÁ”
 
	$»adFuncExeIn¡
(è{  
th»ad
->
funcExeIn¡
; 
	}
}

306 
	$chªgeRegFeCÚ‹xt
(
·¿m
,

307 
v®
)

308 { 
	`·nic
("NÙ suµÜ‹d!"); 
	}
}

310 
ušt64_t
 
»adIÁRegFÏt
(
idx
);

311 
£tIÁRegFÏt
(
idx
, 
ušt64_t
 
v®
);

313 
FlßtReg
 
»adFlßtRegFÏt
(
idx
);

314 
£tFlßtRegFÏt
(
idx
, 
FlßtReg
 
v®
);

316 
FlßtRegB™s
 
»adFlßtRegB™sFÏt
(
idx
);

317 
£tFlßtRegB™sFÏt
(
idx
, 
FlßtRegB™s
 
v®
);

319 
CCReg
 
»adCCRegFÏt
(
idx
);

320 
£tCCRegFÏt
(
idx
, 
CCReg
 
v®
);

	@inorder/thread_state.cc

32 
	~"¬ch/i§_Œa™s.hh
"

33 
	~"ıu/šÜd”/ıu.hh
"

34 
	~"ıu/šÜd”/th»ad_¡©e.hh
"

35 
	~"ıu/ex‘¿û.hh
"

37 
usšg
 
Çme¥aû
 
	gTheISA
;

40 
	gInOrd”Th»adS‹
::
	$dumpFuncProfe
()

42 
¡d
::
o¡»am
 *
os
 = 
simout
.
	`ü—‹
(
	`c¥rštf
("´ofe.%s.d©", 
ıu
->
	`Çme
()));

43 
´ofe
->
	`dump
(
tc
, *
os
);

44 
	}
}

	@inorder/thread_state.hh

31 #iâdeà
__CPU_INORDER_THREAD_STATE_HH__


32 
	#__CPU_INORDER_THREAD_STATE_HH__


	)

34 
	~"¬ch/i§_Œa™s.hh
"

35 
	~"ba£/ÿÎback.hh
"

36 
	~"ba£/ouut.hh
"

37 
	~"ıu/th»ad_cÚ‹xt.hh
"

38 
	~"ıu/th»ad_¡©e.hh
"

39 
	~"sim/sim_ex™.hh
"

41 
şass
 
	gEndQu›sûEv’t
;

42 
şass
 
	gEv’t
;

43 
şass
 
	gFunùiÚ®MemÜy
;

44 
şass
 
	gFunùiÚProfe
;

45 
şass
 
	gInOrd”CPU
;

46 
şass
 
	gProûss
;

47 
şass
 
	gProfeNode
;

56 şas 
	cInOrd”Th»adS‹
 : 
public
 
Th»adS‹
 {

57 
Th»adCÚ‹xt
::
	tStus
 Status;

59 
	m´iv©e
:

61 
InOrd”CPU
 *
ıu
;

63 
	mpublic
:

72 
boŞ
 
noSquashFromTC
;

77 
boŞ
 
	mŒ­P’dšg
;

79 
	$InOrd”Th»adS‹
(
InOrd”CPU
 *
_ıu
, 
Th»adID
 
_th»ad_num
,

80 
Proûss
 *
_´oûss
)

81 : 
	`Th»adS‹
(
»š‹½»t_ÿ¡
<
Ba£CPU
*>(
_ıu
), 
_th»ad_num
,

82 
_´oûss
),

83 
	`ıu
(
_ıu
), 
	`noSquashFromTC
(
çl£
), 
	`Œ­P’dšg
(false),

84 
	$Ï¡G¿dIsB¿nch
(
çl£
)

88 
	$sysÿÎ
(
št64_t
 
ÿÎnum
è{ 
´oûss
->
	`sysÿÎ
(ÿÎnum, 
tc
); 
	}
}

90 
dumpFuncProfe
();

93 
Th»adCÚ‹xt
 *
	gtc
;

96 
Th»adCÚ‹xt
 *
	$g‘TC
(è{  
tc
; 
	}
}

99 
boŞ
 
	gÏ¡G¿dIsB¿nch
;

100 
	gTheISA
::
PCS‹
 
Ï¡B¿nchPC
;

	@inst_seq.hh

32 #iâdeà
__STD_TYPES_HH__


33 
	#__STD_TYPES_HH__


	)

35 
	~"ba£/ty³s.hh
"

40 
ušt64_t
 
	tIn¡SeqNum
;

43 
	tIn¡Tag
;

	@inteltrace.cc

34 
	~<iomª
>

36 
	~"cÚfig/the_i§.hh
"

37 
	~"ıu/ex‘¿û.hh
"

38 
	~"ıu/š‹É¿û.hh
"

39 
	~"ıu/¡©ic_š¡.hh
"

41 
usšg
 
Çme¥aû
 
	g¡d
;

42 
usšg
 
Çme¥aû
 
	gTheISA
;

44 
Çme¥aû
 
	gT¿û
 {

47 
	gT¿û
::
IÁ–T¿ûRecÜd
::
dump
()

49 
o¡»am
 &
outs
 = 
T¿û
::
ouut
();

50 
cırštf
(
outs
, "%7d ) ", 
wh’
);

51 
	gouts
 << "0x" << 
	ghex
 << 
	gpc
.
š¡Addr
() << ":\t";

52 ià(
	g¡©icIn¡
->
isLßd
()) {

53 
cırštf
(
outs
, "<RD %#x>", 
addr
);

54 } ià(
	g¡©icIn¡
->
isStÜe
()) {

55 
cırštf
(
outs
, "<WR %#x>", 
addr
);

57 
	gouts
 << 
	g’dl
;

66 
	gT¿û
::
IÁ–T¿û
 *

67 
IÁ–T¿ûP¬ams
::
	$ü—‹
()

69  
Ãw
 
T¿û
::
	`IÁ–T¿û
(
this
);

70 
	}
}

	@inteltrace.hh

32 #iâdeà
__CPU_INTELTRACE_HH__


33 
	#__CPU_INTELTRACE_HH__


	)

35 
	~"ba£/Œaû.hh
"

36 
	~"ba£/ty³s.hh
"

37 
	~"ıu/¡©ic_š¡.hh
"

38 
	~"ıu/th»ad_cÚ‹xt.hh
"

39 
	~"debug/ExecEÇbË.hh
"

40 
	~"debug/ExecS³cuÏtive.hh
"

41 
	~"·¿ms/IÁ–T¿û.hh
"

42 
	~"sim/š¡Œaûr.hh
"

44 
Çme¥aû
 
	gT¿û
 {

46 şas 
	cIÁ–T¿ûRecÜd
 : 
public
 
In¡RecÜd


48 
public
:

49 
IÁ–T¿ûRecÜd
(
Tick
 
_wh’
, 
Th»adCÚ‹xt
 *
_th»ad
,

50 cÚ¡ 
SticIn¡PŒ
 
_¡©icIn¡
, 
TheISA
::
PCS‹
 
_pc
,

51 
boŞ
 
¥ec
, cÚ¡ 
SticIn¡PŒ
 
_maüoSticIn¡
 = 
NULL
)

52 : 
In¡RecÜd
(
_wh’
, 
_th»ad
, 
_¡©icIn¡
, 
_pc
, 
¥ec
,

53 
_maüoSticIn¡
)

57 
dump
();

60 şas 
	cIÁ–T¿û
 : 
public
 
In¡T¿ûr


62 
public
:

64 
IÁ–T¿û
(cÚ¡ 
IÁ–T¿ûP¬ams
 *
p
è: 
In¡T¿ûr
(p)

67 
IÁ–T¿ûRecÜd
 *

68 
g‘In¡RecÜd
(
Tick
 
wh’
, 
Th»adCÚ‹xt
 *
tc
,

69 cÚ¡ 
SticIn¡PŒ
 
¡©icIn¡
, 
TheISA
::
PCS‹
 
pc
,

70 cÚ¡ 
SticIn¡PŒ
 
maüoSticIn¡
 = 
NULL
)

72 ià(!
Debug
::
ExecEÇbË
)

73  
NULL
;

75 ià(!
	gT¿û
::
’abËd
)

76  
NULL
;

78 ià(!
	gDebug
::
ExecS³cuÏtive
 && 
tc
->
mis¥ecuÏtšg
())

79  
NULL
;

81  
Ãw
 
IÁ–T¿ûRecÜd
(
wh’
, 
tc
,

82 
¡©icIn¡
, 
pc
, 
tc
->
mis¥ecuÏtšg
(), 
maüoSticIn¡
);

	@intr_control.cc

32 
	~<¡ršg
>

33 
	~<veùÜ
>

35 
	~"ba£/Œaû.hh
"

36 
	~"ıu/ba£.hh
"

37 
	~"ıu/šŒ_cÚŒŞ.hh
"

38 
	~"ıu/th»ad_cÚ‹xt.hh
"

39 
	~"debug/IÁrCÚŒŞ.hh
"

40 
	~"sim/sim_objeù.hh
"

42 
usšg
 
Çme¥aû
 
	g¡d
;

44 
	gIÁrCÚŒŞ
::
	$IÁrCÚŒŞ
(cÚ¡ 
P¬ams
 *
p
)

45 : 
	`SimObjeù
(
p
), 
	`sys
Õ->
sys
)

46 {
	}
}

49 
	gIÁrCÚŒŞ
::
	$po¡
(
ıu_id
, 
št_num
, 
šdex
)

51 
	`DPRINTF
(
IÁrCÚŒŞ
, "po¡ %d:%d (ıu %d)\n", 
št_num
, 
šdex
, 
ıu_id
);

52 
¡d
::
veùÜ
<
Th»adCÚ‹xt
 *> &
tcvec
 = 
sys
->
th»adCÚ‹xts
;

53 
Ba£CPU
 *
ıu
 = 
tcvec
[
ıu_id
]->
	`g‘CpuPŒ
();

54 
ıu
->
	`po¡IÁ”ru±
(
št_num
, 
šdex
);

55 
	}
}

58 
	gIÁrCÚŒŞ
::
	$ş—r
(
ıu_id
, 
št_num
, 
šdex
)

60 
	`DPRINTF
(
IÁrCÚŒŞ
, "ş—¸%d:%d (ıu %d)\n", 
št_num
, 
šdex
, 
ıu_id
);

61 
¡d
::
veùÜ
<
Th»adCÚ‹xt
 *> &
tcvec
 = 
sys
->
th»adCÚ‹xts
;

62 
Ba£CPU
 *
ıu
 = 
tcvec
[
ıu_id
]->
	`g‘CpuPŒ
();

63 
ıu
->
	`ş—rIÁ”ru±
(
št_num
, 
šdex
);

64 
	}
}

66 
IÁrCÚŒŞ
 *

67 
	gIÁrCÚŒŞP¬ams
::
	$ü—‹
()

69  
Ãw
 
	`IÁrCÚŒŞ
(
this
);

70 
	}
}

	@intr_control.hh

32 #iâdeà
__INTR_CONTROL_HH__


33 
	#__INTR_CONTROL_HH__


	)

35 
	~<veùÜ
>

37 
	~"ba£/misc.hh
"

38 
	~"·¿ms/IÁrCÚŒŞ.hh
"

39 
	~"sim/sim_objeù.hh
"

40 
	~"sim/sy¡em.hh
"

42 şas 
	cIÁrCÚŒŞ
 : 
public
 
SimObjeù


44 
public
:

45 
Sy¡em
 *
sys
;

46 
IÁrCÚŒŞP¬ams
 
	tP¬ams
;

47 
IÁrCÚŒŞ
(cÚ¡ 
P¬ams
 *
p
);

49 
ş—r
(
ıu_id
, 
št_num
, 
šdex
);

50 
po¡
(
ıu_id
, 
št_num
, 
šdex
);

53 
	$ş—r
(
št_num
, 
šdex
 = 0)

55 
	`ş—r
(0, 
št_num
, 
šdex
);

59 
	$po¡
(
št_num
, 
šdex
 = 0)

61 
	`po¡
(0, 
št_num
, 
šdex
);

62 
	}
}

	@intr_control_noisa.cc

32 
	~"ıu/šŒ_cÚŒŞ.hh
"

34 
usšg
 
Çme¥aû
 
	g¡d
;

36 
	gIÁrCÚŒŞ
::
	$IÁrCÚŒŞ
(cÚ¡ 
P¬ams
 *
p
)

37 : 
	`SimObjeù
(
p
), 
	`sys
Õ->
sys
)

38 {
	}
}

41 
	gIÁrCÚŒŞ
::
	$po¡
(
ıu_id
, 
št_num
, 
šdex
)

43 
	}
}

46 
	gIÁrCÚŒŞ
::
	$ş—r
(
ıu_id
, 
št_num
, 
šdex
)

48 
	}
}

50 
IÁrCÚŒŞ
 *

51 
	gIÁrCÚŒŞP¬ams
::
	$ü—‹
()

53  
Ãw
 
	`IÁrCÚŒŞ
(
this
);

54 
	}
}

	@kvm/arm_cpu.cc

40 
	~<lšux/kvm.h
>

42 
	~<®gÜ™hm
>

43 
	~<û¼no
>

44 
	~<memÜy
>

46 
	~"¬ch/»gi¡”s.hh
"

47 
	~"ıu/kvm/¬m_ıu.hh
"

48 
	~"ıu/kvm/ba£.hh
"

49 
	~"debug/Kvm.hh
"

50 
	~"debug/KvmCÚ‹xt.hh
"

51 
	~"debug/KvmIÁ.hh
"

52 
	~"sim/p£udo_š¡.hh
"

54 
usšg
 
Çme¥aû
 
	gArmISA
;

56 
	#EXTRACT_FIELD
(
v®
, 
mask
, 
shiá
) \

57 (((
v®
è& (
mask
)è>> (
shiá
))

	)

59 
	#REG_IS_ARM
(
id
) \

60 (((
id
è& 
KVM_REG_ARCH_MASK
è=ğ
KVM_REG_ARM
)

	)

62 
	#REG_IS_32BIT
(
id
) \

63 (((
id
è& 
KVM_REG_SIZE_MASK
è=ğ
KVM_REG_SIZE_U32
)

	)

65 
	#REG_IS_64BIT
(
id
) \

66 (((
id
è& 
KVM_REG_SIZE_MASK
è=ğ
KVM_REG_SIZE_U64
)

	)

68 
	#REG_IS_CP
(
id
, 
ı
) \

69 (((
id
è& 
KVM_REG_ARM_COPROC_MASK
è=ğ(
ı
))

	)

71 
	#REG_IS_CORE
(
id
è
	`REG_IS_CP
((id), 
KVM_REG_ARM_CORE
)

	)

73 
	#REG_IS_VFP
(
id
è
	`REG_IS_CP
((id), 
KVM_REG_ARM_VFP
)

	)

74 
	#REG_VFP_REG
(
id
è((idè& 
KVM_REG_ARM_VFP_MASK
)

	)

77 
	#REG_IS_VFP_REG
(
id
è(
	`REG_VFP_REG
(idè< 0x100)

	)

78 
	#REG_IS_VFP_CTRL
(
id
è(
	`REG_VFP_REG
(idè>ğ0x100)

	)

80 
	#REG_IS_DEMUX
(
id
è
	`REG_IS_CP
((id), 
KVM_REG_ARM_DEMUX
)

	)

86 
	#REG_CORE_IDX
(
id
) \

87 (~(
KVM_REG_ARCH_MASK
 | 
KVM_REG_SIZE_MASK
 | 
KVM_REG_ARM_CORE
))

	)

89 
	#REG_CP
(
id
) \

90 
	`EXTRACT_FIELD
(
id
, 
KVM_REG_ARM_COPROC_MASK
, 
KVM_REG_ARM_COPROC_SHIFT
)

	)

92 
	#REG_CRN
(
id
) \

93 
	`EXTRACT_FIELD
(
id
, 
KVM_REG_ARM_32_CRN_MASK
, 
KVM_REG_ARM_32_CRN_SHIFT
)

	)

95 
	#REG_OPC1
(
id
) \

96 
	`EXTRACT_FIELD
(
id
, 
KVM_REG_ARM_OPC1_MASK
, 
KVM_REG_ARM_OPC1_SHIFT
)

	)

98 
	#REG_CRM
(
id
) \

99 
	`EXTRACT_FIELD
(
id
, 
KVM_REG_ARM_CRM_MASK
, 
KVM_REG_ARM_CRM_SHIFT
)

	)

101 
	#REG_OPC2
(
id
) \

102 
	`EXTRACT_FIELD
(
id
, 
KVM_REG_ARM_32_OPC2_MASK
, 
KVM_REG_ARM_32_OPC2_SHIFT
)

	)

104 
	#REG_CP32
(
ınum
, 
ün
, 
İc1
, 
üm
, 
İc2
) ( \

105 (
KVM_REG_ARM
 | 
KVM_REG_SIZE_U32
) | \

106 ((
ınum
è<< 
KVM_REG_ARM_COPROC_SHIFT
) | \

107 ((
ün
è<< 
KVM_REG_ARM_32_CRN_SHIFT
) | \

108 ((
İc1
è<< 
KVM_REG_ARM_OPC1_SHIFT
) | \

109 ((
üm
è<< 
KVM_REG_ARM_CRM_SHIFT
) | \

110 ((
İc2
è<< 
KVM_REG_ARM_32_OPC2_SHIFT
))

	)

112 
	#REG_CP64
(
ınum
, 
İc1
, 
üm
) ( \

113 (
KVM_REG_ARM
 | 
KVM_REG_SIZE_U64
) | \

114 ((
ınum
è<< 
KVM_REG_ARM_COPROC_SHIFT
) | \

115 ((
İc1
è<< 
KVM_REG_ARM_OPC1_SHIFT
) | \

116 ((
üm
è<< 
KVM_REG_ARM_CRM_SHIFT
))

	)

118 
	#REG_CORE32
(
kÇme
) ( \

119 (
KVM_REG_ARM
 | 
KVM_REG_SIZE_U32
) | \

120 (
KVM_REG_ARM_CORE
) | \

121 (
	`KVM_REG_ARM_CORE_REG
(
kÇme
)))

	)

123 
	#REG_VFP32
(
»gno
) ( \

124 (
KVM_REG_ARM
 | 
KVM_REG_SIZE_U32
) | \

125 
KVM_REG_ARM_VFP
 | (
»gno
))

	)

127 
	#REG_VFP64
(
»gno
) ( \

128 (
KVM_REG_ARM
 | 
KVM_REG_SIZE_U64
) | \

129 
KVM_REG_ARM_VFP
 | (
»gno
))

	)

131 
	#REG_DEMUX32
(
dmxid
, 
v®
) ( \

132 (
KVM_REG_ARM
 | 
KVM_REG_SIZE_U32
) | \

133 (
dmxid
è| (
v®
))

	)

138 
ušt64_t
 
	gšv¬ŸÁ_»g_veùÜ
[] = {

139 
REG_CP32
(15, 0, 0, 0, 0),

140 
REG_CP32
(15, 0, 0, 0, 1),

141 
REG_CP32
(15, 0, 0, 0, 2),

142 
REG_CP32
(15, 0, 0, 0, 3),

143 
REG_CP32
(15, 0, 0, 0, 6),

145 
REG_CP32
(15, 0, 0, 1, 0),

146 
REG_CP32
(15, 0, 0, 1, 1),

147 
REG_CP32
(15, 0, 0, 1, 2),

148 
REG_CP32
(15, 0, 0, 1, 3),

149 
REG_CP32
(15, 0, 0, 1, 4),

150 
REG_CP32
(15, 0, 0, 1, 5),

151 
REG_CP32
(15, 0, 0, 1, 6),

152 
REG_CP32
(15, 0, 0, 1, 7),

154 
REG_CP32
(15, 0, 0, 2, 0),

155 
REG_CP32
(15, 0, 0, 2, 1),

156 
REG_CP32
(15, 0, 0, 2, 2),

157 
REG_CP32
(15, 0, 0, 2, 3),

158 
REG_CP32
(15, 0, 0, 2, 4),

159 
REG_CP32
(15, 0, 0, 2, 5),

161 
REG_CP32
(15, 0, 1, 0, 0),

162 
REG_CP32
(15, 0, 1, 0, 1),

163 
REG_CP32
(15, 0, 1, 0, 7),

165 
REG_VFP32
(
KVM_REG_ARM_VFP_MVFR0
),

166 
REG_VFP32
(
KVM_REG_ARM_VFP_MVFR1
),

167 
REG_VFP32
(
KVM_REG_ARM_VFP_FPSID
),

169 
REG_DEMUX32
(
KVM_REG_ARM_DEMUX_ID_CCSIDR
, 0),

172 cÚ¡ 
ušt64_t
 
KVM_REG64_TTBR0
(
REG_CP64
(15, 0, 2));

173 cÚ¡ 
ušt64_t
 
KVM_REG64_TTBR1
(
REG_CP64
(15, 1, 2));

175 
	#INTERRUPT_ID
(
ty³
, 
vıu
, 
œq
) ( \

176 ((
ty³
è<< 
KVM_ARM_IRQ_TYPE_SHIFT
) | \

177 ((
vıu
è<< 
KVM_ARM_IRQ_VCPU_SHIFT
) | \

178 ((
œq
è<< 
KVM_ARM_IRQ_NUM_SHIFT
))

	)

180 
	#INTERRUPT_VCPU_IRQ
(
vıu
) \

181 
	`INTERRUPT_ID
(
KVM_ARM_IRQ_TYPE_CPU
, 
vıu
, 
KVM_ARM_IRQ_CPU_IRQ
)

	)

183 
	#INTERRUPT_VCPU_FIQ
(
vıu
) \

184 
	`INTERRUPT_ID
(
KVM_ARM_IRQ_TYPE_CPU
, 
vıu
, 
KVM_ARM_IRQ_CPU_FIQ
)

	)

187 
	#COUNT_OF
(
l
è(Öè/ (*l))

	)

189 cÚ¡ 
	g¡d
::
£t
<
ušt64_t
> 
ArmKvmCPU
::
šv¬ŸÁ_»gs
(

190 
šv¬ŸÁ_»g_veùÜ
,

191 
šv¬ŸÁ_»g_veùÜ
 + 
COUNT_OF
(invariant_reg_vector));

194 
	gArmKvmCPU
::
KvmIÁRegInfo
 
ArmKvmCPU
::
kvmIÁRegs
[] = {

195 { 
REG_CORE32
(
u¤_»gs
.
ARM_r0
), 
INTREG_R0
, "R0" },

196 { 
REG_CORE32
(
u¤_»gs
.
ARM_r1
), 
INTREG_R1
, "R1" },

197 { 
REG_CORE32
(
u¤_»gs
.
ARM_r2
), 
INTREG_R2
, "R2" },

198 { 
REG_CORE32
(
u¤_»gs
.
ARM_r3
), 
INTREG_R3
, "R3" },

199 { 
REG_CORE32
(
u¤_»gs
.
ARM_r4
), 
INTREG_R4
, "R4" },

200 { 
REG_CORE32
(
u¤_»gs
.
ARM_r5
), 
INTREG_R5
, "R5" },

201 { 
REG_CORE32
(
u¤_»gs
.
ARM_r6
), 
INTREG_R6
, "R6" },

202 { 
REG_CORE32
(
u¤_»gs
.
ARM_r7
), 
INTREG_R7
, "R7" },

203 { 
REG_CORE32
(
u¤_»gs
.
ARM_r8
), 
INTREG_R8
, "R8" },

204 { 
REG_CORE32
(
u¤_»gs
.
ARM_r9
), 
INTREG_R9
, "R9" },

205 { 
REG_CORE32
(
u¤_»gs
.
ARM_r10
), 
INTREG_R10
, "R10" },

206 { 
REG_CORE32
(
u¤_»gs
.
ARM_å
), 
INTREG_R11
, "R11" },

207 { 
REG_CORE32
(
u¤_»gs
.
ARM_
), 
INTREG_R12
, "R12" },

208 { 
REG_CORE32
(
u¤_»gs
.
ARM_¥
), 
INTREG_R13
, "R13(USR)" },

209 { 
REG_CORE32
(
u¤_»gs
.
ARM_Ì
), 
INTREG_R14
, "R14(USR)" },

211 { 
REG_CORE32
(
svc_»gs
[0]), 
INTREG_SP_SVC
, "R13(SVC)" },

212 { 
REG_CORE32
(
svc_»gs
[1]), 
INTREG_LR_SVC
, "R14(SVC)" },

214 { 
REG_CORE32
(
abt_»gs
[0]), 
INTREG_SP_ABT
, "R13(ABT)" },

215 { 
REG_CORE32
(
abt_»gs
[1]), 
INTREG_LR_ABT
, "R14(ABT)" },

217 { 
REG_CORE32
(
und_»gs
[0]), 
INTREG_SP_UND
, "R13(UND)" },

218 { 
REG_CORE32
(
und_»gs
[1]), 
INTREG_LR_UND
, "R14(UND)" },

220 { 
REG_CORE32
(
œq_»gs
[0]), 
INTREG_SP_IRQ
, "R13(IRQ)" },

221 { 
REG_CORE32
(
œq_»gs
[1]), 
INTREG_LR_IRQ
, "R14(IRQ)" },

224 { 
REG_CORE32
(
fiq_»gs
[0]), 
INTREG_R8_FIQ
, "R8(FIQ)" },

225 { 
REG_CORE32
(
fiq_»gs
[1]), 
INTREG_R9_FIQ
, "R9(FIQ)" },

226 { 
REG_CORE32
(
fiq_»gs
[2]), 
INTREG_R10_FIQ
, "R10(FIQ)" },

227 { 
REG_CORE32
(
fiq_»gs
[3]), 
INTREG_R11_FIQ
, "R11(FIQ)" },

228 { 
REG_CORE32
(
fiq_»gs
[4]), 
INTREG_R12_FIQ
, "R12(FIQ)" },

229 { 
REG_CORE32
(
fiq_»gs
[5]), 
INTREG_R13_FIQ
, "R13(FIQ)" },

230 { 
REG_CORE32
(
fiq_»gs
[6]), 
INTREG_R14_FIQ
, "R14(FIQ)" },

231 { 0, 
NUM_INTREGS
, 
NULL
 }

234 
	gArmKvmCPU
::
KvmCÜeMiscRegInfo
 
ArmKvmCPU
::
kvmCÜeMiscRegs
[] = {

235 { 
REG_CORE32
(
u¤_»gs
.
ARM_ı¤
), 
MISCREG_CPSR
, "CPSR" },

236 { 
REG_CORE32
(
svc_»gs
[2]), 
MISCREG_SPSR_SVC
, "SPSR(SVC)" },

237 { 
REG_CORE32
(
abt_»gs
[2]), 
MISCREG_SPSR_ABT
, "SPSR(ABT)" },

238 { 
REG_CORE32
(
und_»gs
[2]), 
MISCREG_SPSR_UND
, "SPSR(UND)" },

239 { 
REG_CORE32
(
œq_»gs
[2]), 
MISCREG_SPSR_IRQ
, "SPSR(IRQ)" },

240 { 
REG_CORE32
(
fiq_»gs
[2]), 
MISCREG_SPSR_FIQ
, "SPSR(FIQ)" },

241 { 0, 
NUM_MISCREGS
 }

244 
	gArmKvmCPU
::
	$ArmKvmCPU
(
ArmKvmCPUP¬ams
 *
·¿ms
)

245 : 
	`Ba£KvmCPU
(
·¿ms
),

246 
	`œqAs£¹ed
(
çl£
), 
	$fiqAs£¹ed
(
çl£
)

248 
	}
}

250 
	gArmKvmCPU
::~
	$ArmKvmCPU
()

252 
	}
}

255 
ArmKvmCPU
::
	$¡¬tup
()

257 
Ba£KvmCPU
::
	`¡¬tup
();

266 
	`kvmArmVCpuIn™
(
KVM_ARM_TARGET_CORTEX_A15
);

267 
	}
}

269 
Tick


270 
	gArmKvmCPU
::
	$kvmRun
(
Tick
 
ticks
)

272 
boŞ
 
	`simFIQ
(
š‹¼u±s
->
	`checkRaw
(
INT_FIQ
));

273 
boŞ
 
	`simIRQ
(
š‹¼u±s
->
	`checkRaw
(
INT_IRQ
));

275 ià(
fiqAs£¹ed
 !ğ
simFIQ
) {

276 
fiqAs£¹ed
 = 
simFIQ
;

277 
	`DPRINTF
(
KvmIÁ
, "KVM: Upd©FIQ s‹: %i\n", 
simFIQ
);

278 
vm
.
	`£tIRQLše
(
	`INTERRUPT_VCPU_FIQ
(
vıuID
), 
simFIQ
);

280 ià(
œqAs£¹ed
 !ğ
simIRQ
) {

281 
œqAs£¹ed
 = 
simIRQ
;

282 
	`DPRINTF
(
KvmIÁ
, "KVM: Upd©IRQ s‹: %i\n", 
simIRQ
);

283 
vm
.
	`£tIRQLše
(
	`INTERRUPT_VCPU_IRQ
(
vıuID
), 
simIRQ
);

286  
Ba£KvmCPU
::
	`kvmRun
(
ticks
);

287 
	}
}

290 
	gArmKvmCPU
::
	$dump
()

292 
	`dumpKvmS‹CÜe
();

293 
	`dumpKvmS‹Misc
();

294 
	}
}

297 
	gArmKvmCPU
::
	$upd©eKvmS‹
()

299 
	`DPRINTF
(
KvmCÚ‹xt
, "Updating KVM state...\n");

301 
	`upd©eKvmS‹CÜe
();

302 
	`upd©eKvmS‹Misc
();

303 
	}
}

306 
	gArmKvmCPU
::
	$upd©eTh»adCÚ‹xt
()

308 
	`DPRINTF
(
KvmCÚ‹xt
, "Updating gem5 state...\n");

310 
	`upd©eTCS‹CÜe
();

311 
	`upd©eTCS‹Misc
();

312 
	}
}

314 
Tick


315 
	gArmKvmCPU
::
	$ÚKvmEx™Hy³rÿÎ
()

317 
Th»adCÚ‹xt
 *
	`tc
(
	`g‘CÚ‹xt
(0));

318 cÚ¡ 
ušt32_t
 
	`»g_
(
tc
->
	`»adIÁRegFÏt
(
INTREG_R12
));

319 cÚ¡ 
ušt8_t
 
	`func
((
»g_
 >> 8) & 0xFF);

320 cÚ¡ 
ušt8_t
 
	`subfunc
(
»g_
 & 0xFF);

322 
	`DPRINTF
(
Kvm
, "KVM Hy³rÿÎ: 0x%x/0x%x\n", 
func
, 
subfunc
);

323 cÚ¡ 
ušt64_t
 
	`»t
(
P£udoIn¡
::
	`p£udoIn¡
(
	`g‘CÚ‹xt
(0), 
func
, 
subfunc
));

328 
	`£tOÃReg
(
	`REG_CORE32
(
u¤_»gs
.
ARM_r0
), 
»t
 & 0xFFFFFFFF);

329 
	`£tOÃReg
(
	`REG_CORE32
(
u¤_»gs
.
ARM_r1
), (
»t
 >> 32) & 0xFFFFFFFF);

332 
	}
}

334 cÚ¡ 
	gArmKvmCPU
::
RegIndexVeùÜ
 &

335 
ArmKvmCPU
::
	$g‘RegLi¡
() const

337 ià(
_»gIndexLi¡
.
	`size
() == 0) {

338 
¡d
::
unique_±r
<
kvm_»g_li¡
> 
»gs
;

339 
ušt64_t
 
	`i
(1);

342 
i
 <<= 1;

343 
»gs
.
	`»£t
((
kvm_»g_li¡
 *)

344 
İ”©Ü
 
	`Ãw
((
kvm_»g_li¡
) +

345 
i
 * (
ušt64_t
)));

346 
»gs
->
n
 = 
i
;

347 } !
	`g‘RegLi¡
(*
»gs
));

348 
_»gIndexLi¡
.
	`assign
(
»gs
->
»g
,

349 
»gs
->
»g
 +„egs->
n
);

352  
_»gIndexLi¡
;

353 
	}
}

356 
	gArmKvmCPU
::
	$kvmArmVCpuIn™
(
ušt32_t
 
rg‘
)

358 
kvm_vıu_š™
 
š™
;

360 
	`mem£t
(&
š™
, 0, (init));

362 
š™
.
rg‘
 =arget;

364 
	`kvmArmVCpuIn™
(
š™
);

365 
	}
}

368 
	gArmKvmCPU
::
	$kvmArmVCpuIn™
(cÚ¡ 
kvm_vıu_š™
 &
š™
)

370 ià(
	`ioùl
(
KVM_ARM_VCPU_INIT
, (*)&
š™
) == -1)

371 
	`·nic
("KVM: Failedo initialize vCPU\n");

372 
	}
}

374 
MiscRegIndex


375 
	gArmKvmCPU
::
	$decodeCoProcReg
(
ušt64_t
 
id
) const

377 cÚ¡ 
	`ı
(
	`REG_CP
(
id
));

378 cÚ¡ 
boŞ
 
	`is_»g32
(
	`REG_IS_32BIT
(
id
));

379 cÚ¡ 
boŞ
 
	`is_»g64
(
	`REG_IS_64BIT
(
id
));

382 ià(
ı
 > 15)

383  
NUM_MISCREGS
;

385 cÚ¡ 
	`üm
(
	`REG_CRM
(
id
));

386 cÚ¡ 
	`ün
(
	`REG_CRN
(
id
));

387 cÚ¡ 
	`İc1
(
	`REG_OPC1
(
id
));

388 cÚ¡ 
	`İc2
(
	`REG_OPC2
(
id
));

390 ià(
is_»g32
) {

391 
ı
) {

393  
	`decodeCP14Reg
(
ün
, 
İc1
, 
üm
, 
İc2
);

396  
	`decodeCP15Reg
(
ün
, 
İc1
, 
üm
, 
İc2
);

399  
NUM_MISCREGS
;

401 } if(
is_»g64
) {

402  
NUM_MISCREGS
;

404 
	`w¬n
("Unhandled„egister†ength,„egister (0x%x) ignored.\n");

405  
NUM_MISCREGS
;

407 
	}
}

409 
	gArmISA
::
MiscRegIndex


410 
ArmKvmCPU
::
	$decodeVFPCŒlReg
(
ušt64_t
 
id
) const

412 ià(!
	`REG_IS_ARM
(
id
è|| !
	`REG_IS_VFP
(idè|| !
	`REG_IS_VFP_CTRL
(id))

413  
NUM_MISCREGS
;

415 cÚ¡ 
	`vå_»g
(
	`REG_VFP_REG
(
id
));

416 
vå_»g
) {

417 
KVM_REG_ARM_VFP_FPSID
:  
MISCREG_FPSID
;

418 
KVM_REG_ARM_VFP_FPSCR
:  
MISCREG_FPSCR
;

419 
KVM_REG_ARM_VFP_MVFR0
:  
MISCREG_MVFR0
;

420 
KVM_REG_ARM_VFP_MVFR1
:  
MISCREG_MVFR1
;

421 
KVM_REG_ARM_VFP_FPEXC
:  
MISCREG_FPEXC
;

423 
KVM_REG_ARM_VFP_FPINST
:

424 
KVM_REG_ARM_VFP_FPINST2
:

425 
	`w¬n_Úû
("KVM: FPINST‚ot implemented.\n");

426  
NUM_MISCREGS
;

429  
NUM_MISCREGS
;

431 
	}
}

433 
boŞ


434 
	gArmKvmCPU
::
	$isInv¬ŸÁReg
(
ušt64_t
 
id
)

439 ià(
	`REG_IS_ARM
(
id
è&& 
	`REG_IS_DEMUX
(id))

440 
id
 &ğ~
KVM_REG_ARM_DEMUX_VAL_MASK
;

442  
šv¬ŸÁ_»gs
.
	`fšd
(
id
è!ğšv¬ŸÁ_»gs.
	`’d
();

443 
	}
}

445 
boŞ


446 
	gArmKvmCPU
::
	$g‘RegLi¡
(
kvm_»g_li¡
 &
»gs
) const

448 ià(
	`ioùl
(
KVM_GET_REG_LIST
, (*)&
»gs
) == -1) {

449 ià(
”ºo
 =ğ
E2BIG
) {

450  
çl£
;

452 
	`·nic
("KVM: Failedo get vCPU„egister†ist (errno: %i)\n",

453 
”ºo
);

456  
Œue
;

458 
	}
}

461 
	gArmKvmCPU
::
	$dumpKvmS‹CÜe
()

464 
ušt32_t
 
	`pc
(
	`g‘OÃRegU32
(
	`REG_CORE32
(
u¤_»gs
.
ARM_pc
)));

465 
	`šfÜm
("PC: 0x%x\n", 
pc
);

467 cÚ¡ 
KvmIÁRegInfo
 *
	`ri
(
kvmIÁRegs
);

468 
ri
->
idx
 !ğ
NUM_INTREGS
; ++ri) {

470 
ušt32_t
 
	`v®ue
(
	`g‘OÃRegU32
(
ri
->
id
));

471 
	`šfÜm
("%s: 0x%x\n", 
ri
->
Çme
, 
v®ue
);

474 cÚ¡ 
KvmCÜeMiscRegInfo
 *
	`ri
(
kvmCÜeMiscRegs
);

475 
ri
->
idx
 !ğ
NUM_MISCREGS
; ++ri) {

477 
ušt32_t
 
	`v®ue
(
	`g‘OÃRegU32
(
ri
->
id
));

478 
	`šfÜm
("%s: 0x%x\n", 
miscRegName
[
ri
->
idx
], 
v®ue
);

480 
	}
}

483 
	gArmKvmCPU
::
	$dumpKvmS‹Misc
()

486 cÚ¡ 
RegIndexVeùÜ
 &
	`»g_ids
(
	`g‘RegLi¡
());;

487 
RegIndexVeùÜ
::
cÚ¡_™”©Ü
 
	`™
(
»g_ids
.
	`begš
());

488 
™
 !ğ
»g_ids
.
	`’d
(); ++it) {

489 
ušt64_t
 
	`id
(*
™
);

491 ià(
	`REG_IS_ARM
(
id
è&& 
	`REG_CP
(id) <= 15) {

492 
	`dumpKvmS‹CoProc
(
id
);

493 } ià(
	`REG_IS_ARM
(
id
è&& 
	`REG_IS_VFP
(id)) {

494 
	`dumpKvmS‹VFP
(
id
);

495 } ià(
	`REG_IS_ARM
(
id
è&& 
	`REG_IS_DEMUX
(id)) {

496 
id
 & 
KVM_REG_ARM_DEMUX_ID_MASK
) {

497 
KVM_REG_ARM_DEMUX_ID_CCSIDR
:

498 
	`šfÜm
("CCSIDR [0x%x]: %s\n",

499 
	`EXTRACT_FIELD
(
id
,

500 
KVM_REG_ARM_DEMUX_VAL_MASK
,

501 
KVM_REG_ARM_DEMUX_VAL_SHIFT
),

502 
	`g‘AndFÜm©OÃReg
(
id
));

505 
	`šfÜm
("DEMUX [0x%x, 0x%x]: %s\n",

506 
	`EXTRACT_FIELD
(
id
,

507 
KVM_REG_ARM_DEMUX_ID_MASK
,

508 
KVM_REG_ARM_DEMUX_ID_SHIFT
),

509 
	`EXTRACT_FIELD
(
id
,

510 
KVM_REG_ARM_DEMUX_VAL_MASK
,

511 
KVM_REG_ARM_DEMUX_VAL_SHIFT
),

512 
	`g‘AndFÜm©OÃReg
(
id
));

515 } ià(!
	`REG_IS_CORE
(
id
)) {

516 
	`šfÜm
("0x%x: %s\n", 
id
, 
	`g‘AndFÜm©OÃReg
(id));

519 
	}
}

522 
	gArmKvmCPU
::
	$dumpKvmS‹CoProc
(
ušt64_t
 
id
)

524 
	`as£¹
(
	`REG_IS_ARM
(
id
));

525 
	`as£¹
(
	`REG_CP
(
id
) <= 15);

527 ià(
	`REG_IS_32BIT
(
id
)) {

529 
MiscRegIndex
 
	`idx
(
	`decodeCoProcReg
(
id
));

530 
ušt32_t
 
	`v®ue
(
	`g‘OÃRegU32
(
id
));

532 ià(
idx
 !ğ
NUM_MISCREGS
 &&

533 !(
idx
 >ğ
MISCREG_CP15_UNIMP_START
 && idx < 
MISCREG_CP15_END
)) {

534 cÚ¡ *
	`Çme
(
miscRegName
[
idx
]);

535 cÚ¡ 
	`m5_Ã
(
tc
->
	`»adMiscRegNoEfãù
(
idx
));

536 cÚ¡ 
	`m5_e
(
tc
->
	`»adMiscReg
(
idx
));

537 
	`šfÜm
("CP%i: [CRn: c%i opc1: %.2i CRm: c%i opc2: %i inv: %i]: "

539 
	`REG_CP
(
id
), 
	`REG_CRN
(id), 
	`REG_OPC1
(id), 
	`REG_CRM
(id),

540 
	`REG_OPC2
(
id
), 
	`isInv¬ŸÁReg
(id),

541 
Çme
, 
v®ue
, 
m5_e
);

542 ià(
m5_e
 !ğ
m5_Ã
) {

543 
	`šfÜm
("readMiscReg: %x,„eadMiscRegNoEffect: %x\n",

544 
m5_e
, 
m5_Ã
);

547 cÚ¡ *
	`Çme
(
idx
 !ğ
NUM_MISCREGS
 ? 
miscRegName
[idx] : "-");

548 
	`šfÜm
("CP%i: [CRn: c%i opc1: %.2i CRm: c%i opc2: %i inv: %i]: [%s]: "

550 
	`REG_CP
(
id
), 
	`REG_CRN
(id), 
	`REG_OPC1
(id), 
	`REG_CRM
(id),

551 
	`REG_OPC2
(
id
), 
	`isInv¬ŸÁReg
(id), 
Çme
, 
v®ue
);

554 
	`šfÜm
("CP%i: [CRn: c%i opc1: %.2i CRm: c%i opc2: %i inv: %i "

556 
	`REG_CP
(
id
), 
	`REG_CRN
(id), 
	`REG_OPC1
(id), 
	`REG_CRM
(id),

557 
	`REG_OPC2
(
id
), 
	`isInv¬ŸÁReg
(id),

558 
	`EXTRACT_FIELD
(
id
, 
KVM_REG_SIZE_MASK
, 
KVM_REG_SIZE_SHIFT
),

559 
	`g‘AndFÜm©OÃReg
(
id
));

561 
	}
}

564 
	gArmKvmCPU
::
	$dumpKvmS‹VFP
(
ušt64_t
 
id
)

566 
	`as£¹
(
	`REG_IS_ARM
(
id
));

567 
	`as£¹
(
	`REG_IS_VFP
(
id
));

569 ià(
	`REG_IS_VFP_REG
(
id
)) {

570 cÚ¡ 
	`idx
(
id
 & 
KVM_REG_ARM_VFP_MASK
);

571 
	`šfÜm
("VFP„eg %i: %s", 
idx
, 
	`g‘AndFÜm©OÃReg
(
id
));

572 } ià(
	`REG_IS_VFP_CTRL
(
id
)) {

573 
MiscRegIndex
 
	`idx
(
	`decodeVFPCŒlReg
(
id
));

574 ià(
idx
 !ğ
NUM_MISCREGS
) {

575 
	`šfÜm
("VFP [%s]: %s", 
miscRegName
[
idx
], 
	`g‘AndFÜm©OÃReg
(
id
));

577 
	`šfÜm
("VFP [0x%x]: %s", 
id
, 
	`g‘AndFÜm©OÃReg
(id));

580 
	`šfÜm
("VFP [0x%x]: %s", 
id
, 
	`g‘AndFÜm©OÃReg
(id));

582 
	}
}

585 
	gArmKvmCPU
::
	$upd©eKvmS‹CÜe
()

587 cÚ¡ 
KvmIÁRegInfo
 *
	`ri
(
kvmIÁRegs
);

588 
ri
->
idx
 !ğ
NUM_INTREGS
; ++ri) {

590 
ušt64_t
 
	`v®ue
(
tc
->
	`»adIÁRegFÏt
(
ri
->
idx
));

591 
	`DPRINTF
(
KvmCÚ‹xt
, "kvm(%sè:ğ0x%x\n", 
ri
->
Çme
, 
v®ue
);

592 
	`£tOÃReg
(
ri
->
id
, 
v®ue
);

595 
	`DPRINTF
(
KvmCÚ‹xt
, "kvm(PCè:ğ0x%x\n", 
tc
->
	`š¡Addr
());

596 
	`£tOÃReg
(
	`REG_CORE32
(
u¤_»gs
.
ARM_pc
), 
tc
->
	`š¡Addr
());

598 cÚ¡ 
KvmCÜeMiscRegInfo
 *
	`ri
(
kvmCÜeMiscRegs
);

599 
ri
->
idx
 !ğ
NUM_MISCREGS
; ++ri) {

601 
ušt64_t
 
	`v®ue
(
tc
->
	`»adMiscReg
(
ri
->
idx
));

602 
	`DPRINTF
(
KvmCÚ‹xt
, "kvm(%sè:ğ0x%x\n", 
ri
->
Çme
, 
v®ue
);

603 
	`£tOÃReg
(
ri
->
id
, 
v®ue
);

606 ià(
	`DTRACE
(
KvmCÚ‹xt
))

607 
	`dumpKvmS‹CÜe
();

608 
	}
}

611 
	gArmKvmCPU
::
	$upd©eKvmS‹Misc
()

613 
boŞ
 
	`w¬Ãd
(
çl£
);

616 cÚ¡ 
RegIndexVeùÜ
 &
	`»gs
(
	`g‘RegLi¡
());

618 
RegIndexVeùÜ
::
cÚ¡_™”©Ü
 
	`™
(
»gs
.
	`begš
());

619 
™
 !ğ
»gs
.
	`’d
();

620 ++
™
) {

622 ià(!
	`REG_IS_ARM
(*
™
)) {

623 ià(!
w¬Ãd
)

624 
	`w¬n
("Skpšg‚Ú-ARM„egi¡”: 0x%x\n", *
™
);

625 } ià(
	`isInv¬ŸÁReg
(*
™
)) {

626 
	`DPRINTF
(
Kvm
, "Skpšg inv¬ŸÁ„egi¡”: 0x%x\n", *
™
);

627 } ià(
	`REG_IS_CORE
(*
™
)) {

630 } ià(
	`REG_CP
(*
™
) <= 15) {

631 
	`upd©eKvmS‹CoProc
(*
™
, !
w¬Ãd
);

632 } ià(
	`REG_IS_VFP
(*
™
)) {

633 
	`upd©eKvmS‹VFP
(*
™
, !
w¬Ãd
);

635 ià(!
w¬Ãd
) {

636 
	`w¬n
("Skipping„egister with unknown CP (%i) id: 0x%x\n",

637 
	`REG_CP
(*
™
), *it);

643 
w¬Ãd
 = 
Œue
;

644 ià(
	`DTRACE
(
KvmCÚ‹xt
))

645 
	`dumpKvmS‹Misc
();

646 
	}
}

649 
	gArmKvmCPU
::
	$upd©eKvmS‹CoProc
(
ušt64_t
 
id
, 
boŞ
 
show_w¬nšgs
)

651 
MiscRegIndex
 
	`»g
(
	`decodeCoProcReg
(
id
));

653 
	`as£¹
(
	`REG_IS_ARM
(
id
));

654 
	`as£¹
(
	`REG_CP
(
id
) <= 15);

656 ià(
id
 =ğ
KVM_REG64_TTBR0
 || id =ğ
KVM_REG64_TTBR1
) {

658 
»g
 = (
id
 =ğ
KVM_REG64_TTBR0
 ? 
MISCREG_TTBR0
 : 
MISCREG_TTBR1
);

659 ià(
show_w¬nšgs
)

660 
	`hack
("KVM: 64-bit TTBBRx workaround\n");

663 ià(
»g
 =ğ
NUM_MISCREGS
) {

664 ià(
show_w¬nšgs
) {

665 
	`w¬n
("KVM: Ignoring unknown KVM co-processor„egister (0x%.8x):\n",

666 
id
);

667 
	`w¬n
("\t0x%x: [CP: %i 64: %i CRn: c%i opc1: %.2i CRm: c%i"

669 
id
, 
	`REG_CP
(id), 
	`REG_IS_64BIT
(id), 
	`REG_CRN
(id),

670 
	`REG_OPC1
(
id
), 
	`REG_CRM
(id), 
	`REG_OPC2
(id));

672 } ià(
»g
 >ğ
MISCREG_CP15_UNIMP_START
 &&„eg < 
MISCREG_CP15_END
) {

673 ià(
show_w¬nšgs
)

674 
	`w¬n
("KVM: Co-processor„eg. %s‚ot implemented by gem5.\n",

675 
miscRegName
[
»g
]);

677 
	`£tOÃReg
(
id
, 
tc
->
	`»adMiscRegNoEfãù
(
»g
));

679 
	}
}

683 
	gArmKvmCPU
::
	$upd©eKvmS‹VFP
(
ušt64_t
 
id
, 
boŞ
 
show_w¬nšgs
)

685 
	`as£¹
(
	`REG_IS_ARM
(
id
));

686 
	`as£¹
(
	`REG_IS_VFP
(
id
));

688 ià(
	`REG_IS_VFP_REG
(
id
)) {

689 ià(!
	`REG_IS_64BIT
(
id
)) {

690 ià(
show_w¬nšgs
)

691 
	`w¬n
("UÃx³ùed VFP„egi¡”†’gth (»g: 0x%x).\n", 
id
);

694 cÚ¡ 
	`idx
(
id
 & 
KVM_REG_ARM_VFP_MASK
);

695 cÚ¡ 
	`idx_ba£
(
idx
 << 1);

696 cÚ¡ 
	`idx_hi
(
idx_ba£
 + 1);

697 cÚ¡ 
	`idx_lo
(
idx_ba£
 + 0);

698 
ušt64_t
 
	`v®ue
(

699 ((
ušt64_t
)
tc
->
	`»adFlßtRegB™sFÏt
(
idx_hi
) << 32) |

700 
tc
->
	`»adFlßtRegB™sFÏt
(
idx_lo
));

702 
	`£tOÃReg
(
id
, 
v®ue
);

703 } ià(
	`REG_IS_VFP_CTRL
(
id
)) {

704 
MiscRegIndex
 
	`idx
(
	`decodeVFPCŒlReg
(
id
));

705 ià(
idx
 =ğ
NUM_MISCREGS
) {

706 ià(
show_w¬nšgs
)

707 
	`w¬n
("UnhªdËd VFP cÚŒŞ„egi¡”: 0x%x\n", 
id
);

710 ià(!
	`REG_IS_32BIT
(
id
)) {

711 ià(
show_w¬nšgs
)

712 
	`w¬n
("Ignoring VFP control„egister (%s) with "

714 
miscRegName
[
idx
]);

717 
	`£tOÃReg
(
id
, (
ušt32_t
)
tc
->
	`»adMiscReg
(
idx
));

719 ià(
show_w¬nšgs
)

720 
	`w¬n
("UnhªdËd VFP„egi¡”: 0x%x\n", 
id
);

722 
	}
}

725 
	gArmKvmCPU
::
	$upd©eTCS‹CÜe
()

727 cÚ¡ 
KvmIÁRegInfo
 *
	`ri
(
kvmIÁRegs
);

728 
ri
->
idx
 !ğ
NUM_INTREGS
; ++ri) {

730 
tc
->
	`£tIÁRegFÏt
(
ri
->
idx
, 
	`g‘OÃRegU32
Ôi->
id
));

733 cÚ¡ 
KvmCÜeMiscRegInfo
 *
	`ri
(
kvmCÜeMiscRegs
);

734 
ri
->
idx
 !ğ
NUM_MISCREGS
; ++ri) {

736 
tc
->
	`£tMiscRegNoEfãù
(
ri
->
idx
, 
	`g‘OÃRegU32
Ôi->
id
));

742 
tc
->
	`£tMiscReg
(
MISCREG_CPSR
,c->
	`»adMiscRegNoEfãù
(MISCREG_CPSR));

746 
PCS‹
 
	`pc
(
tc
->
	`pcS‹
());

747 
pc
.
	`£t
(
	`g‘OÃRegU32
(
	`REG_CORE32
(
u¤_»gs
.
ARM_pc
)));

748 
tc
->
	`pcS‹
(
pc
);

750 ià(
	`DTRACE
(
KvmCÚ‹xt
))

751 
	`dumpKvmS‹CÜe
();

752 
	}
}

755 
	gArmKvmCPU
::
	$upd©eTCS‹Misc
()

757 
boŞ
 
	`w¬Ãd
(
çl£
);

760 cÚ¡ 
RegIndexVeùÜ
 &
	`»g_ids
(
	`g‘RegLi¡
());;

761 
RegIndexVeùÜ
::
cÚ¡_™”©Ü
 
	`™
(
»g_ids
.
	`begš
());

762 
™
 !ğ
»g_ids
.
	`’d
(); ++it) {

764 ià(!
	`REG_IS_ARM
(*
™
)) {

765 ià(!
w¬Ãd
)

766 
	`w¬n
("Skpšg‚Ú-ARM„egi¡”: 0x%x\n", *
™
);

767 } ià(
	`REG_IS_CORE
(*
™
)) {

769 } ià(
	`REG_CP
(*
™
) <= 15) {

770 
	`upd©eTCS‹CoProc
(*
™
, !
w¬Ãd
);

771 } ià(
	`REG_IS_VFP
(*
™
)) {

772 
	`upd©eTCS‹VFP
(*
™
, !
w¬Ãd
);

774 ià(!
w¬Ãd
) {

775 
	`w¬n
("Skipping„egister with unknown CP (%i) id: 0x%x\n",

776 
	`REG_CP
(*
™
), *it);

781 
w¬Ãd
 = 
Œue
;

783 ià(
	`DTRACE
(
KvmCÚ‹xt
))

784 
	`dumpKvmS‹Misc
();

785 
	}
}

788 
	gArmKvmCPU
::
	$upd©eTCS‹CoProc
(
ušt64_t
 
id
, 
boŞ
 
show_w¬nšgs
)

790 
MiscRegIndex
 
	`»g
(
	`decodeCoProcReg
(
id
));

792 
	`as£¹
(
	`REG_IS_ARM
(
id
));

793 
	`as£¹
(
	`REG_CP
(
id
) <= 15);

795 ià(
id
 =ğ
KVM_REG64_TTBR0
 || id =ğ
KVM_REG64_TTBR1
) {

797 
	`hack_Úû
("KVM: 64-bit TTBRx workaround\n");

798 
tc
->
	`£tMiscRegNoEfãù
(

799 
id
 =ğ
KVM_REG64_TTBR0
 ? 
MISCREG_TTBR0
 : 
MISCREG_TTBR1
,

800 (
ušt32_t
)(
	`g‘OÃRegU64
(
id
) & 0xFFFFFFFF));

801 } ià(
»g
 =ğ
MISCREG_TTBCR
) {

802 
ušt32_t
 
	`v®ue
(
	`g‘OÃRegU64
(
id
));

803 ià(
v®ue
 & 0x80000000)

804 
	`·nic
("KVM: Guestriedoƒnable LPAE.\n");

805 
tc
->
	`£tMiscRegNoEfãù
(
»g
, 
v®ue
);

806 } ià(
»g
 =ğ
NUM_MISCREGS
) {

807 ià(
show_w¬nšgs
) {

808 
	`w¬n
("KVM: IgnÜšg unknowÀKVM co-´oûssÜ„egi¡”:\n", 
id
);

809 
	`w¬n
("\t0x%x: [CP: %i 64: %i CRn: c%i opc1: %.2i CRm: c%i"

811 
id
, 
	`REG_CP
(id), 
	`REG_IS_64BIT
(id), 
	`REG_CRN
(id),

812 
	`REG_OPC1
(
id
), 
	`REG_CRM
(id), 
	`REG_OPC2
(id));

814 } ià(
»g
 >ğ
MISCREG_CP15_UNIMP_START
 &&„eg < 
MISCREG_CP15_END
) {

815 ià(
show_w¬nšgs
)

816 
	`w¬n_Úû
("KVM: Co-processor„eg. %s‚ot implemented by gem5.\n",

817 
miscRegName
[
»g
]);

819 
tc
->
	`£tMiscRegNoEfãù
(
»g
, 
	`g‘OÃRegU32
(
id
));

821 
	}
}

824 
	gArmKvmCPU
::
	$upd©eTCS‹VFP
(
ušt64_t
 
id
, 
boŞ
 
show_w¬nšgs
)

826 
	`as£¹
(
	`REG_IS_ARM
(
id
));

827 
	`as£¹
(
	`REG_IS_VFP
(
id
));

829 ià(
	`REG_IS_VFP_REG
(
id
)) {

830 ià(!
	`REG_IS_64BIT
(
id
)) {

831 ià(
show_w¬nšgs
)

832 
	`w¬n
("UÃx³ùed VFP„egi¡”†’gth (»g: 0x%x).\n", 
id
);

835 cÚ¡ 
	`idx
(
id
 & 
KVM_REG_ARM_VFP_MASK
);

836 cÚ¡ 
	`idx_ba£
(
idx
 << 1);

837 cÚ¡ 
	`idx_hi
(
idx_ba£
 + 1);

838 cÚ¡ 
	`idx_lo
(
idx_ba£
 + 0);

839 
ušt64_t
 
	`v®ue
(
	`g‘OÃRegU64
(
id
));

841 
tc
->
	`£tFlßtRegB™sFÏt
(
idx_hi
, (
v®ue
 >> 32) & 0xFFFFFFFF);

842 
tc
->
	`£tFlßtRegB™sFÏt
(
idx_lo
, 
v®ue
 & 0xFFFFFFFF);

843 } ià(
	`REG_IS_VFP_CTRL
(
id
)) {

844 
MiscRegIndex
 
	`idx
(
	`decodeVFPCŒlReg
(
id
));

845 ià(
idx
 =ğ
NUM_MISCREGS
) {

846 ià(
show_w¬nšgs
)

847 
	`w¬n
("UnhªdËd VFP cÚŒŞ„egi¡”: 0x%x\n", 
id
);

850 ià(!
	`REG_IS_32BIT
(
id
)) {

851 ià(
show_w¬nšgs
)

852 
	`w¬n
("Ignoring VFP control„egister (%s) with "

854 
miscRegName
[
idx
]);

857 
tc
->
	`£tMiscReg
(
idx
, 
	`g‘OÃRegU64
(
id
));

859 ià(
show_w¬nšgs
)

860 
	`w¬n
("UnhªdËd VFP„egi¡”: 0x%x\n", 
id
);

862 
	}
}

864 
ArmKvmCPU
 *

865 
	gArmKvmCPUP¬ams
::
	$ü—‹
()

867  
Ãw
 
	`ArmKvmCPU
(
this
);

868 
	}
}

	@kvm/arm_cpu.hh

40 #iâdeà
__CPU_KVM_ARM_CPU_HH__


41 
	#__CPU_KVM_ARM_CPU_HH__


	)

43 
	~<£t
>

44 
	~<veùÜ
>

46 
	~"ıu/kvm/ba£.hh
"

47 
	~"·¿ms/ArmKvmCPU.hh
"

61 şas 
	cArmKvmCPU
 : 
public
 
Ba£KvmCPU


63 
public
:

64 
ArmKvmCPU
(
ArmKvmCPUP¬ams
 *
·¿ms
);

65 
	mvœtu®
 ~
ArmKvmCPU
();

67 
¡¬tup
();

69 
dump
();

71 
	m´Ùeùed
:

72 
	sKvmIÁRegInfo
 {

74 cÚ¡ 
ušt64_t
 
id
;

76 cÚ¡ 
IÁRegIndex
 
	midx
;

78 cÚ¡ *
	mÇme
;

81 
	sKvmCÜeMiscRegInfo
 {

83 cÚ¡ 
ušt64_t
 
	gid
;

85 cÚ¡ 
MiscRegIndex
 
	gidx
;

87 cÚ¡ *
	gÇme
;

90 
	g¡d
::
	tveùÜ
<
	tušt64_t
> 
	tRegIndexVeùÜ
;

92 
Tick
 
kvmRun
(Tick 
ticks
);

94 
upd©eKvmS‹
();

95 
upd©eTh»adCÚ‹xt
();

97 
Tick
 
ÚKvmEx™Hy³rÿÎ
();

102 cÚ¡ 
	gRegIndexVeùÜ
 &
	$g‘RegLi¡
() const;

104 
	`kvmArmVCpuIn™
(
ušt32_t
 
rg‘
);

105 
	`kvmArmVCpuIn™
(cÚ¡ 
kvm_vıu_š™
 &
š™
);

107 
ArmISA
::
MiscRegIndex
 
	$decodeCoProcReg
(
ušt64_t
 
id
) const;

109 
ArmISA
::
MiscRegIndex
 
	$decodeVFPCŒlReg
(
ušt64_t
 
id
) const;

120 
boŞ
 
	`isInv¬ŸÁReg
(
ušt64_t
 
id
);

122 
KvmIÁRegInfo
 
kvmIÁRegs
[];

123 
KvmCÜeMiscRegInfo
 
kvmCÜeMiscRegs
[];

125 
´iv©e
:

133 
boŞ
 
	$g‘RegLi¡
(
kvm_»g_li¡
 &
»gs
) const;

135 
	`dumpKvmS‹CÜe
();

136 
	`dumpKvmS‹Misc
();

137 
	`dumpKvmS‹CoProc
(
ušt64_t
 
id
);

138 
	`dumpKvmS‹VFP
(
ušt64_t
 
id
);

140 
	`upd©eKvmS‹CÜe
();

141 
	`upd©eKvmS‹Misc
();

142 
	`upd©eKvmS‹CoProc
(
ušt64_t
 
id
, 
boŞ
 
show_w¬nšgs
);

143 
	`upd©eKvmS‹VFP
(
ušt64_t
 
id
, 
boŞ
 
show_w¬nšgs
);

145 
	`upd©eTCS‹CÜe
();

146 
	`upd©eTCS‹Misc
();

147 
	`upd©eTCS‹CoProc
(
ušt64_t
 
id
, 
boŞ
 
show_w¬nšgs
);

148 
	`upd©eTCS‹VFP
(
ušt64_t
 
id
, 
boŞ
 
show_w¬nšgs
);

152 
boŞ
 
œqAs£¹ed
;

154 
boŞ
 
fiqAs£¹ed
;

160 
mubË
 
RegIndexVeùÜ
 
_»gIndexLi¡
;

167 cÚ¡ 
¡d
::
£t
<
ušt64_t
> 
šv¬ŸÁ_»gs
;

168 
	}
};

	@kvm/base.cc

40 
	~<lšux/kvm.h
>

41 
	~<sys/ioùl.h
>

42 
	~<sys/mmª.h
>

43 
	~<uni¡d.h
>

45 
	~<û¼no
>

46 
	~<csigÇl
>

47 
	~<o¡»am
>

49 
	~"¬ch/mm­³d_r.hh
"

50 
	~"¬ch/ut™y.hh
"

51 
	~"ıu/kvm/ba£.hh
"

52 
	~"debug/Checkpošt.hh
"

53 
	~"debug/D¿š.hh
"

54 
	~"debug/Kvm.hh
"

55 
	~"debug/KvmIO.hh
"

56 
	~"debug/KvmRun.hh
"

57 
	~"·¿ms/Ba£KvmCPU.hh
"

58 
	~"sim/´oûss.hh
"

59 
	~"sim/sy¡em.hh
"

61 
	~<sigÇl.h
>

64 
	#PAGE_SIZE
 
·geSize


	)

66 vŞ©
boŞ
 
	gtim”Ov”æowed
 = 
çl£
;

68 
	gBa£KvmCPU
::
	$Ba£KvmCPU
(
Ba£KvmCPUP¬ams
 *
·¿ms
)

69 : 
	`Ba£CPU
(
·¿ms
),

70 
	`vm
(*
·¿ms
->
kvmVM
),

71 
	`_¡©us
(
IdË
),

72 
	`d©aPÜt
(
	`Çme
(è+ ".dÿche_pÜt", 
this
),

73 
	`š¡PÜt
(
	`Çme
(è+ ".iÿche_pÜt", 
this
),

74 
	`th»adCÚ‹xtDœty
(
Œue
),

75 
	`kvmS‹Dœty
(
çl£
),

76 
	`vıuID
(
vm
.
	`®locVCPUID
()), 
	`vıuFD
(-1), 
	`vıuMM­Size
(0),

77 
	`_kvmRun
(
NULL
), 
	`mmioRšg
(NULL),

78 
	`·geSize
(
	`syscÚf
(
_SC_PAGE_SIZE
)),

79 
	`tickEv’t
(*
this
),

80 
	`aùiveIn¡P”iod
(0),

81 
	`³rfCÚŒŞËdByTim”
(
·¿ms
->
u£P”fOv”æow
),

82 
	`ho¡FaùÜ
(
·¿ms
->
ho¡FaùÜ
),

83 
	`d¿šMªag”
(
NULL
),

84 
	$ùrIn¡s
(0)

86 ià(
·geSize
 == -1)

87 
	`·nic
("KVM: Failedo determine host…age size (%i)\n",

88 
”ºo
);

90 
th»ad
 = 
Ãw
 
	`Sim¶eTh»ad
(
this
, 0, 
·¿ms
->
sy¡em
,

91 
·¿ms
->
™b
,…¬ams->
dtb
,…¬ams->
i§
[0]);

92 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
H®‹d
);

93 
tc
 = 
th»ad
->
	`g‘TC
();

94 
th»adCÚ‹xts
.
	`push_back
(
tc
);

96 
	`£tupCouÁ”s
();

98 ià(
·¿ms
->
u£P”fOv”æow
)

99 
runTim”
.
	`»£t
(
Ãw
 
	`P”fKvmTim”
(
hwCyşes
,

100 
KVM_TIMER_SIGNAL
,

101 
·¿ms
->
ho¡FaùÜ
,

102 
·¿ms
->
ho¡F»q
));

104 
runTim”
.
	`»£t
(
Ãw
 
	`PosixKvmTim”
(
KVM_TIMER_SIGNAL
, 
CLOCK_MONOTONIC
,

105 
·¿ms
->
ho¡FaùÜ
,

106 
·¿ms
->
ho¡F»q
));

107 
	}
}

109 
	gBa£KvmCPU
::~
	$Ba£KvmCPU
()

111 ià(
_kvmRun
)

112 
	`munm­
(
_kvmRun
, 
vıuMM­Size
);

113 
	`şo£
(
vıuFD
);

114 
	}
}

117 
	gBa£KvmCPU
::
	$š™
()

119 
Ba£CPU
::
	`š™
();

121 ià(
numTh»ads
 != 1)

122 
	`çl
("KVM: Multithreading‚ot supported");

124 
tc
->
	`š™MemProx›s
(tc);

127 ià(
FuÎSy¡em
 && !
	`sw™chedOut
())

128 
TheISA
::
	`š™CPU
(
tc
,c->
	`cÚ‹xtId
());

130 
mmio_»q
.
	`£tTh»adCÚ‹xt
(
tc
->
	`cÚ‹xtId
(), 0);

131 
	}
}

134 
	gBa£KvmCPU
::
	$¡¬tup
()

136 cÚ¡ 
Ba£KvmCPUP¬ams
 * cÚ¡ 
	`p
(

137 
dyÇmic_ÿ¡
<cÚ¡ 
Ba£KvmCPUP¬ams
 *>(
	`·¿ms
()));

139 
Kvm
 &
	`kvm
(
vm
.
kvm
);

141 
Ba£CPU
::
	`¡¬tup
();

143 
	`as£¹
(
vıuFD
 == -1);

146 
vm
.
	`ıuS¹up
();

151 
vıuFD
 = 
vm
.
	`ü—‹VCPU
(
vıuID
);

155 
	`£tupSigÇlHªdËr
();

158 
vıuMM­Size
 = 
kvm
.
	`g‘VCPUMM­Size
();

159 
_kvmRun
 = (
kvm_run
 *)
	`mm­
(0, 
vıuMM­Size
,

160 
PROT_READ
 | 
PROT_WRITE
, 
MAP_SHARED
,

161 
vıuFD
, 0);

162 ià(
_kvmRun
 =ğ
MAP_FAILED
)

163 
	`·nic
("KVM: Failedo map„un data structure\n");

168 
	`mmioOff£t
(
kvm
.
	`ÿpCßËsûdMMIO
());

169 ià(!
p
->
u£CßËsûdMMIO
) {

170 
	`šfÜm
("KVM: Coalesced MMIO disabled by config.\n");

171 } ià(
mmioOff£t
) {

172 
	`šfÜm
("KVM: Coalesced IO‡vailable\n");

173 
mmioRšg
 = (
kvm_cßËsûd_mmio_ršg
 *)(

174 (*)
_kvmRun
 + (
mmioOff£t
 * 
·geSize
));

176 
	`šfÜm
("KVM: Coalesced‚ot supported by host OS\n");

179 
th»ad
->
	`¡¬tup
();

180 
	}
}

183 
	gBa£KvmCPU
::
	$»gSts
()

185 
usšg
 
Çme¥aû
 
Sts
;

187 
Ba£CPU
::
	`»gSts
();

189 
numIn¡s


190 .
	`Çme
(name() + ".committedInsts")

191 .
	`desc
("Number of instructions committed")

194 
numVMEx™s


195 .
	`Çme
(name() + ".numVMExits")

196 .
	`desc
("total‚umber of KVMƒxits")

199 
numVMH®fEÁr›s


200 .
	`Çme
(name() + ".numVMHalfEntries")

201 .
	`desc
("number of KVMƒntrieso finalize…ending operations")

204 
numEx™SigÇl


205 .
	`Çme
(name() + ".numExitSignal")

206 .
	`desc
("exits dueo signal delivery")

209 
numMMIO


210 .
	`Çme
(name() + ".numMMIO")

211 .
	`desc
("number of VMƒxits dueo memory mapped IO")

214 
numCßËsûdMMIO


215 .
	`Çme
(name() + ".numCoalescedMMIO")

216 .
	`desc
("number of coalesced memory mapped IO„equests")

219 
numIO


220 .
	`Çme
(name() + ".numIO")

221 .
	`desc
("number of VMƒxits dueo†egacy IO")

224 
numH®t


225 .
	`Çme
(name() + ".numHalt")

226 .
	`desc
("number of VMƒxits dueo wait for interrupt instructions")

229 
numIÁ”ru±s


230 .
	`Çme
(name() + ".numInterrupts")

231 .
	`desc
("number of interrupts delivered")

234 
numHy³rÿÎs


235 .
	`Çme
(name() + ".numHypercalls")

236 .
	`desc
("number of hypercalls")

238 
	}
}

241 
	gBa£KvmCPU
::
£rŸlizeTh»ad
(
¡d
::
o¡»am
 &
os
, 
Th»adID
 
tid
)

243 ià(
DTRACE
(
Checkpošt
)) {

244 
DPRINTF
(
Checkpošt
, "KVM: S”Ÿlizšgh»ad %i:\n", 
tid
);

245 
dump
();

248 
as£¹
(
tid
 == 0);

249 
as£¹
(
_¡©us
 =ğ
IdË
);

250 
	gth»ad
->
£rŸlize
(
os
);

254 
	gBa£KvmCPU
::
un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
,

255 
Th»adID
 
tid
)

257 
DPRINTF
(
Checkpošt
, "KVM: Un£rŸlizth»ad %i:\n", 
tid
);

259 
as£¹
(
tid
 == 0);

260 
as£¹
(
_¡©us
 =ğ
IdË
);

261 
	gth»ad
->
un£rŸlize
(
ı
, 
£ùiÚ
);

262 
	gth»adCÚ‹xtDœty
 = 
Œue
;

266 
	gBa£KvmCPU
::
	$d¿š
(
D¿šMªag”
 *
dm
)

268 ià(
	`sw™chedOut
())

271 
	`DPRINTF
(
D¿š
, "BaseKvmCPU::drain\n");

272 
_¡©us
) {

273 
RuÂšg
:

279 ià(!
	`¬chIsD¿šed
()) {

280 
d¿šMªag”
 = 
dm
;

288 ià(
tickEv’t
.
	`scheduËd
())

289 
	`descheduË
(
tickEv’t
);

290 
_¡©us
 = 
IdË
;

293 
IdË
:

295 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

299 
	`syncTh»adCÚ‹xt
();

303 
RuÂšgS”viûCom¶‘iÚ
:

310 
d¿šMªag”
 = 
dm
;

312 
	`DPRINTF
(
D¿š
, "KVM CPU is waiting for service completion, "

316 
RuÂšgS”viû
:

318 
d¿šMªag”
 = 
dm
;

320 
	`DPRINTF
(
D¿š
, "KVM CPU is waiting for service,„equesting drain.\n");

324 
	`·nic
("KVM: Unhandled CPU state in drain()\n");

327 
	}
}

330 
	gBa£KvmCPU
::
	$d¿šResume
()

332 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

336 ià(
	`sw™chedOut
())

339 
	`DPRINTF
(
Kvm
, "drainResume\n");

340 
	`v”ifyMemÜyMode
();

344 ià(
tc
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
) {

345 
	`scheduË
(
tickEv’t
, 
	`ÃxtCyşe
());

346 
_¡©us
 = 
RuÂšg
;

348 
_¡©us
 = 
IdË
;

350 
	}
}

353 
	gBa£KvmCPU
::
	$sw™chOut
()

355 
	`DPRINTF
(
Kvm
, "switchOut\n");

357 
Ba£CPU
::
	`sw™chOut
();

362 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

363 
	`as£¹
(
_¡©us
 =ğ
IdË
);

364 
	}
}

367 
	gBa£KvmCPU
::
	$keOv”From
(
Ba£CPU
 *
ıu
)

369 
	`DPRINTF
(
Kvm
, "takeOverFrom\n");

371 
Ba£CPU
::
	`keOv”From
(
ıu
);

376 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

377 
	`as£¹
(
_¡©us
 =ğ
IdË
);

378 
	`as£¹
(
th»adCÚ‹xts
.
	`size
() == 1);

384 
	`upd©eKvmS‹
();

385 
th»adCÚ‹xtDœty
 = 
çl£
;

386 
	}
}

389 
	gBa£KvmCPU
::
	$v”ifyMemÜyMode
() const

391 ià(!(
sy¡em
->
	`isAtomicMode
(è&& sy¡em->
	`by·ssCaches
())) {

392 
	`çl
("The KVM-based CPUs„equireshe memory systemo be inhe "

395 
	}
}

398 
	gBa£KvmCPU
::
	$wakeup
()

400 
	`DPRINTF
(
Kvm
, "wakeup()\n");

402 ià(
th»ad
->
	`¡©us
(è!ğ
Th»adCÚ‹xt
::
Su¥’ded
)

405 
th»ad
->
	`aùiv©e
();

406 
	}
}

409 
	gBa£KvmCPU
::
	$aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
)

411 
	`DPRINTF
(
Kvm
, "Aùiv©eCÚ‹xˆ%d (%d cyşes)\n", 
th»ad_num
, 
d–ay
);

413 
	`as£¹
(
th»ad_num
 == 0);

414 
	`as£¹
(
th»ad
);

416 
	`as£¹
(
_¡©us
 =ğ
IdË
);

417 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

419 
numCyşes
 +ğ
	`ticksToCyşes
(
th»ad
->
Ï¡Aùiv©e
 -h»ad->
Ï¡Su¥’d
);

421 
	`scheduË
(
tickEv’t
, 
	`şockEdge
(
d–ay
));

422 
_¡©us
 = 
RuÂšg
;

423 
	}
}

427 
	gBa£KvmCPU
::
	$su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
)

429 
	`DPRINTF
(
Kvm
, "Su¥’dCÚ‹xˆ%d\n", 
th»ad_num
);

431 
	`as£¹
(
th»ad_num
 == 0);

432 
	`as£¹
(
th»ad
);

434 ià(
_¡©us
 =ğ
IdË
)

437 
	`as£¹
(
_¡©us
 =ğ
RuÂšg
);

443 ià(
tickEv’t
.
	`scheduËd
())

444 
	`descheduË
(
tickEv’t
);

446 
_¡©us
 = 
IdË
;

447 
	}
}

450 
	gBa£KvmCPU
::
	$d—Îoÿ‹CÚ‹xt
(
Th»adID
 
th»ad_num
)

453 
	`su¥’dCÚ‹xt
(
th»ad_num
);

454 
	}
}

457 
	gBa£KvmCPU
::
	$h®tCÚ‹xt
(
Th»adID
 
th»ad_num
)

460 
	`su¥’dCÚ‹xt
(
th»ad_num
);

461 
	}
}

463 
Th»adCÚ‹xt
 *

464 
	gBa£KvmCPU
::
	$g‘CÚ‹xt
(
Š
)

466 
	`as£¹
(
Š
 == 0);

467 
	`syncTh»adCÚ‹xt
();

468  
tc
;

469 
	}
}

472 
CouÁ”


473 
	gBa£KvmCPU
::
	$tÙ®In¡s
() const

475  
ùrIn¡s
;

476 
	}
}

478 
CouÁ”


479 
	gBa£KvmCPU
::
	$tÙ®Ops
() const

481 
	`hack_Úû
("PretendingotalOps isƒquivalentootalInsts()\n");

482  
ùrIn¡s
;

483 
	}
}

486 
	gBa£KvmCPU
::
	$dump
()

488 
	`šfÜm
("State dumping‚ot implemented.");

489 
	}
}

492 
	gBa£KvmCPU
::
	$tick
()

494 
Tick
 
	`d–ay
(0);

495 
	`as£¹
(
_¡©us
 !ğ
IdË
);

497 
_¡©us
) {

498 
RuÂšgS”viû
:

500 
d–ay
 = 
	`hªdËKvmEx™
();

502 ià(
	`ŒyD¿š
())

503 
_¡©us
 = 
IdË
;

506 
RuÂšgS”viûCom¶‘iÚ
:

507 
RuÂšg
: {

508 
Ev’tQueue
 *
q
 = 
	`curEv’tQueue
();

509 
Tick
 
	`ticksToExecu‹
(
q
->
	`ÃxtTick
(è- 
	`curTick
());

512 
	`syncKvmS‹
();

516 
	`£tupIn¡Stİ
();

518 
	`DPRINTF
(
KvmRun
, "Entering KVM...\n");

519 ià(
d¿šMªag”
) {

524 
d–ay
 = 
	`kvmRunD¿š
();

526 
d–ay
 = 
	`kvmRun
(
ticksToExecu‹
);

532 
kvmS‹Dœty
 = 
Œue
;

536 ià(
_kvmRun
->
ex™_»asÚ
 !ğ
KVM_EXIT_INTR
) {

537 
_¡©us
 = 
RuÂšgS”viû
;

539 ++
numEx™SigÇl
;

540 
_¡©us
 = 
RuÂšg
;

546 
comIn¡Ev’tQueue
[0]->
	`£rviûEv’ts
(
ùrIn¡s
);

547 
sy¡em
->
š¡Ev’tQueue
.
	`£rviûEv’ts
(sy¡em->
tÙ®NumIn¡s
);

549 ià(
	`ŒyD¿š
())

550 
_¡©us
 = 
IdË
;

554 
	`·nic
("BaseKvmCPUƒnteredick() in‡n illegal state (%i)\n",

555 
_¡©us
);

559 ià(
_¡©us
 !ğ
IdË
)

560 
	`scheduË
(
tickEv’t
, 
	`şockEdge
(
	`ticksToCyşes
(
d–ay
)));

561 
	}
}

563 
Tick


564 
	gBa£KvmCPU
::
	$kvmRunD¿š
()

569 
	`as£¹
(
_¡©us
 =ğ
RuÂšgS”viûCom¶‘iÚ
);

573  
	`kvmRun
(0);

574 
	}
}

576 
ušt64_t


577 
	gBa£KvmCPU
::
	$g‘Ho¡Cyşes
() const

579  
hwCyşes
.
	`»ad
();

580 
	}
}

582 
Tick


583 
	gBa£KvmCPU
::
	$kvmRun
(
Tick
 
ticks
)

585 
Tick
 
ticksExecu‹d
;

586 
	`DPRINTF
(
KvmRun
, "KVM: Executšg fÜ %˜ticks\n", 
ticks
);

587 
tim”Ov”æowed
 = 
çl£
;

589 ià(
ticks
 == 0) {

593 
	`DPRINTF
(
KvmRun
, "KVM: Delivering IO without full guestƒntry\n");

595 ++
numVMH®fEÁr›s
;

600 
	`¿i£
(
KVM_TIMER_SIGNAL
);

607 
	`ioùlRun
();

612 
ticksExecu‹d
 = 
	`şockP”iod
();

614 ià(
ticks
 < 
runTim”
->
	`»sŞutiÚ
()) {

615 
	`DPRINTF
(
KvmRun
, "KVM: Adjustingick count (%i -> %i)\n",

616 
ticks
, 
runTim”
->
	`»sŞutiÚ
());

617 
ticks
 = 
runTim”
->
	`»sŞutiÚ
();

622 
ušt64_t
 
	`ba£Cyşes
(
	`g‘Ho¡Cyşes
());

623 
ušt64_t
 
	`ba£In¡rs
(
hwIn¡ruùiÚs
.
	`»ad
());

629 
runTim”
->
	`¬m
(
ticks
);

630 ià(!
³rfCÚŒŞËdByTim”
)

631 
hwCyşes
.
	`¡¬t
();

633 
	`ioùlRun
();

635 
runTim”
->
	`di§rm
();

636 ià(!
³rfCÚŒŞËdByTim”
)

637 
hwCyşes
.
	`¡İ
();

644 
	`disÿrdP’dšgSigÇl
(
KVM_TIMER_SIGNAL
);

645 
	`disÿrdP’dšgSigÇl
(
KVM_INST_SIGNAL
);

647 cÚ¡ 
ušt64_t
 
	`ho¡CyşesExecu‹d
(
	`g‘Ho¡Cyşes
(è- 
ba£Cyşes
);

648 cÚ¡ 
ušt64_t
 
	`simCyşesExecu‹d
(
ho¡CyşesExecu‹d
 * 
ho¡FaùÜ
);

649 cÚ¡ 
ušt64_t
 
	`š¡sExecu‹d
(
hwIn¡ruùiÚs
.
	`»ad
(è- 
ba£In¡rs
);

650 
ticksExecu‹d
 = 
runTim”
->
	`ticksFromHo¡Cyşes
(
ho¡CyşesExecu‹d
);

652 ià(
ticksExecu‹d
 < 
ticks
 &&

653 
tim”Ov”æowed
 &&

654 
_kvmRun
->
ex™_»asÚ
 =ğ
KVM_EXIT_INTR
) {

656 
	`w¬n
("KVM: Earlyimerƒvent,„equested %iicks but got %iicks.\n",

657 
ticks
, 
ticksExecu‹d
);

661 
numCyşes
 +ğ
simCyşesExecu‹d
;;

662 
numIn¡s
 +ğ
š¡sExecu‹d
;

663 
ùrIn¡s
 +ğ
š¡sExecu‹d
;

664 
sy¡em
->
tÙ®NumIn¡s
 +ğ
š¡sExecu‹d
;

666 
	`DPRINTF
(
KvmRun
,

669 
š¡sExecu‹d
, 
ho¡CyşesExecu‹d
, 
ticksExecu‹d
, 
simCyşesExecu‹d
);

672 ++
numVMEx™s
;

674  
ticksExecu‹d
 + 
	`æushCßËsûdMMIO
();

675 
	}
}

678 
	gBa£KvmCPU
::
	$kvmNÚMaskabËIÁ”ru±
()

680 ++
numIÁ”ru±s
;

681 ià(
	`ioùl
(
KVM_NMI
) == -1)

682 
	`·nic
("KVM: Failedo deliver NMIo virtual CPU\n");

683 
	}
}

686 
	gBa£KvmCPU
::
	$kvmIÁ”ru±
(cÚ¡ 
kvm_š‹¼u±
 &
š‹¼u±
)

688 ++
numIÁ”ru±s
;

689 ià(
	`ioùl
(
KVM_INTERRUPT
, (*)&
š‹¼u±
) == -1)

690 
	`·nic
("KVM: Failedo deliver interrupto virtual CPU\n");

691 
	}
}

694 
	gBa£KvmCPU
::
	$g‘Regi¡”s
(
kvm_»gs
 &
»gs
) const

696 ià(
	`ioùl
(
KVM_GET_REGS
, &
»gs
) == -1)

697 
	`·nic
("KVM: Failedo get guest„egisters\n");

698 
	}
}

701 
	gBa£KvmCPU
::
	$£tRegi¡”s
(cÚ¡ 
kvm_»gs
 &
»gs
)

703 ià(
	`ioùl
(
KVM_SET_REGS
, (*)&
»gs
) == -1)

704 
	`·nic
("KVM: Failedo set guest„egisters\n");

705 
	}
}

708 
	gBa£KvmCPU
::
	$g‘S³cŸlRegi¡”s
(
kvm_¤egs
 &
»gs
) const

710 ià(
	`ioùl
(
KVM_GET_SREGS
, &
»gs
) == -1)

711 
	`·nic
("KVM: Failedo get guest special„egisters\n");

712 
	}
}

715 
	gBa£KvmCPU
::
	$£tS³cŸlRegi¡”s
(cÚ¡ 
kvm_¤egs
 &
»gs
)

717 ià(
	`ioùl
(
KVM_SET_SREGS
, (*)&
»gs
) == -1)

718 
	`·nic
("KVM: Failedo set guest special„egisters\n");

719 
	}
}

722 
	gBa£KvmCPU
::
	$g‘FPUS‹
(
kvm_åu
 &
¡©e
) const

724 ià(
	`ioùl
(
KVM_GET_FPU
, &
¡©e
) == -1)

725 
	`·nic
("KVM: Failedo get guest FPU state\n");

726 
	}
}

729 
	gBa£KvmCPU
::
	$£tFPUS‹
(cÚ¡ 
kvm_åu
 &
¡©e
)

731 ià(
	`ioùl
(
KVM_SET_FPU
, (*)&
¡©e
) == -1)

732 
	`·nic
("KVM: Failedo set guest FPU state\n");

733 
	}
}

737 
	gBa£KvmCPU
::
	$£tOÃReg
(
ušt64_t
 
id
, cÚ¡ *
addr
)

739 #ifdeà
KVM_SET_ONE_REG


740 
kvm_Úe_»g
 
»g
;

741 
»g
.
id
 = id;

742 
»g
.
addr
 = (
ušt64_t
)addr;

744 ià(
	`ioùl
(
KVM_SET_ONE_REG
, &
»g
) == -1) {

745 
	`·nic
("KVM: Failedo set„egister (0x%x) value (errno: %i)\n",

746 
id
, 
”ºo
);

749 
	`·nic
("KVM_SET_ONE_REG is unsupported onhis…latform.\n");

751 
	}
}

754 
	gBa£KvmCPU
::
	$g‘OÃReg
(
ušt64_t
 
id
, *
addr
) const

756 #ifdeà
KVM_GET_ONE_REG


757 
kvm_Úe_»g
 
»g
;

758 
»g
.
id
 = id;

759 
»g
.
addr
 = (
ušt64_t
)addr;

761 ià(
	`ioùl
(
KVM_GET_ONE_REG
, &
»g
) == -1) {

762 
	`·nic
("KVM: Failedo get„egister (0x%x) value (errno: %i)\n",

763 
id
, 
”ºo
);

766 
	`·nic
("KVM_GET_ONE_REG is unsupported onhis…latform.\n");

768 
	}
}

770 
	g¡d
::
¡ršg


771 
Ba£KvmCPU
::
	$g‘AndFÜm©OÃReg
(
ušt64_t
 
id
) const

773 #ifdeà
KVM_GET_ONE_REG


774 
¡d
::
o¡ršg¡»am
 
ss
;

776 
ss
.
	`£tf
(
¡d
::
ios
::
hex
, std::ios::
ba£f›ld
);

777 
ss
.
	`£tf
(
¡d
::
ios
::
showba£
);

778 
	#HANDLE_INTTYPE
(
Ën
) \

779 
KVM_REG_SIZE_U
 ## 
Ën
: { \

780 
ušt
 ## 
Ën
 ## 
_t
 
v®ue
; \

781 
	`g‘OÃReg
(
id
, &
v®ue
); \

782 
ss
 << 
v®ue
; \

783 } 

	)

785 
	#HANDLE_ARRAY
(
Ën
) \

786 
KVM_REG_SIZE_U
 ## 
Ën
: { \

787 
ušt8_t
 
v®ue
[
Ën
 / 8]; \

788 
	`g‘OÃReg
(
id
, 
v®ue
); \

789 
ss
 << "[" << 
v®ue
[0]; \

790 
i
 = 1; i < 
Ën
 / 8; ++i) \

791 
ss
 << ", " << 
v®ue
[
i
]; \

792 
ss
 << "]"; \

793 } 

	)

795 
id
 & 
KVM_REG_SIZE_MASK
) {

796 
	`HANDLE_INTTYPE
(8);

797 
	`HANDLE_INTTYPE
(16);

798 
	`HANDLE_INTTYPE
(32);

799 
	`HANDLE_INTTYPE
(64);

800 
	`HANDLE_ARRAY
(128);

801 
	`HANDLE_ARRAY
(256);

802 
	`HANDLE_ARRAY
(512);

803 
	`HANDLE_ARRAY
(1024);

805 
ss
 << "??";

808 #undeà
HANDLE_INTTYPE


809 #undeà
HANDLE_ARRAY


811  
ss
.
	`¡r
();

813 
	`·nic
("KVM_GET_ONE_REG is unsupported onhis…latform.\n");

815 
	}
}

818 
	gBa£KvmCPU
::
	$syncTh»adCÚ‹xt
()

820 ià(!
kvmS‹Dœty
)

823 
	`as£¹
(!
th»adCÚ‹xtDœty
);

825 
	`upd©eTh»adCÚ‹xt
();

826 
kvmS‹Dœty
 = 
çl£
;

827 
	}
}

830 
	gBa£KvmCPU
::
	$syncKvmS‹
()

832 ià(!
th»adCÚ‹xtDœty
)

835 
	`as£¹
(!
kvmS‹Dœty
);

837 
	`upd©eKvmS‹
();

838 
th»adCÚ‹xtDœty
 = 
çl£
;

839 
	}
}

841 
Tick


842 
	gBa£KvmCPU
::
	$hªdËKvmEx™
()

844 
	`DPRINTF
(
KvmRun
, "hªdËKvmEx™ (ex™_»asÚ: %i)\n", 
_kvmRun
->
ex™_»asÚ
);

845 
	`as£¹
(
_¡©us
 =ğ
RuÂšgS”viû
);

849 
_¡©us
 = 
RuÂšg
;

850 
_kvmRun
->
ex™_»asÚ
) {

851 
KVM_EXIT_UNKNOWN
:

852  
	`hªdËKvmEx™Unknown
();

854 
KVM_EXIT_EXCEPTION
:

855  
	`hªdËKvmEx™Exû±iÚ
();

857 
KVM_EXIT_IO
:

858 
_¡©us
 = 
RuÂšgS”viûCom¶‘iÚ
;

859 ++
numIO
;

860  
	`hªdËKvmEx™IO
();

862 
KVM_EXIT_HYPERCALL
:

863 ++
numHy³rÿÎs
;

864  
	`hªdËKvmEx™Hy³rÿÎ
();

866 
KVM_EXIT_HLT
:

868 
	`DPRINTF
(
Kvm
, "handleKvmExitHalt\n");

869 ++
numH®t
;

872 
th»ad
->
	`su¥’d
();

877 
KVM_EXIT_MMIO
:

878 
_¡©us
 = 
RuÂšgS”viûCom¶‘iÚ
;

880 
	`DPRINTF
(
KvmIO
, "KVM: Handling MMIO (w: %u,‡ddr: 0x%x,†en: %u)\n",

881 
_kvmRun
->
mmio
.
is_wr™e
,

882 
_kvmRun
->
mmio
.
phys_addr
, _kvmRun->mmio.
Ën
);

884 ++
numMMIO
;

885  
	`doMMIOAcûss
(
_kvmRun
->
mmio
.
phys_addr
, _kvmRun->mmio.
d©a
,

886 
_kvmRun
->
mmio
.
Ën
, _kvmRun->mmio.
is_wr™e
);

888 
KVM_EXIT_IRQ_WINDOW_OPEN
:

889  
	`hªdËKvmEx™IRQWšdowO³n
();

891 
KVM_EXIT_FAIL_ENTRY
:

892  
	`hªdËKvmEx™FaEÁry
();

894 
KVM_EXIT_INTR
:

899 
KVM_EXIT_INTERNAL_ERROR
:

900 
	`·nic
("KVM: Internalƒrror (suberror: %u)\n",

901 
_kvmRun
->
š‹º®
.
sub”rÜ
);

904 
	`dump
();

905 
	`·nic
("KVM: UÃx³ùedƒx™ (ex™_»asÚ: %u)\n", 
_kvmRun
->
ex™_»asÚ
);

907 
	}
}

909 
Tick


910 
	gBa£KvmCPU
::
	$hªdËKvmEx™IO
()

912 
	`·nic
("KVM: Unhandled guest IO (dir: %i, size: %i,…ort: 0x%x, count: %i)\n",

913 
_kvmRun
->
io
.
dœeùiÚ
, _kvmRun->io.
size
,

914 
_kvmRun
->
io
.
pÜt
, _kvmRun->io.
couÁ
);

915 
	}
}

917 
Tick


918 
	gBa£KvmCPU
::
	$hªdËKvmEx™Hy³rÿÎ
()

920 
	`·nic
("KVM: Unhandled hypercall\n");

921 
	}
}

923 
Tick


924 
	gBa£KvmCPU
::
	$hªdËKvmEx™IRQWšdowO³n
()

926 
	`w¬n
("KVM: Unhandled IRQ window.\n");

928 
	}
}

931 
Tick


932 
	gBa£KvmCPU
::
	$hªdËKvmEx™Unknown
()

934 
	`dump
();

935 
	`·nic
("KVM: Unknownƒrror when starting vCPU (hw„eason: 0x%llx)\n",

936 
_kvmRun
->
hw
.
h¬dw¬e_ex™_»asÚ
);

937 
	}
}

939 
Tick


940 
	gBa£KvmCPU
::
	$hªdËKvmEx™Exû±iÚ
()

942 
	`dump
();

943 
	`·nic
("KVM: Gotƒxception when starting vCPU "

945 
_kvmRun
->
ex
.
exû±iÚ
, _kvmRun->ex.
”rÜ_code
);

946 
	}
}

948 
Tick


949 
	gBa£KvmCPU
::
	$hªdËKvmEx™FaEÁry
()

951 
	`dump
();

952 
	`·nic
("KVM: Failedoƒnter virtualized mode (hw„eason: 0x%llx)\n",

953 
_kvmRun
->
ç_’Œy
.
h¬dw¬e_’Œy_çu»_»asÚ
);

954 
	}
}

956 
Tick


957 
	gBa£KvmCPU
::
	$doMMIOAcûss
(
Addr
 
·ddr
, *
d©a
, 
size
, 
boŞ
 
wr™e
)

959 
Th»adCÚ‹xt
 *
	`tc
(
th»ad
->
	`g‘TC
());

960 
	`syncTh»adCÚ‹xt
();

962 
mmio_»q
.
	`£tPhys
(
·ddr
, 
size
, 
Reque¡
::
UNCACHEABLE
, 
	`d©aMa¡”Id
());

967 
Ba£TLB
::
Mode
 
	`b_mode
(
wr™e
 ? Ba£TLB::
Wr™e
 : Ba£TLB::
R—d
);

968 
FauÉ
 
	`çuÉ
(
tc
->
	`g‘DTBPŒ
()->
	`fš®izePhysiÿl
(&
mmio_»q
,c, 
b_mode
));

969 ià(
çuÉ
 !ğ
NoFauÉ
)

970 
	`w¬n
("Fš®iz©iÚ oàMMIO‡dd»s çed: %s\n", 
çuÉ
->
	`Çme
());

973 cÚ¡ 
MemCmd
 
	`cmd
(
wr™e
 ? MemCmd::
Wr™eReq
 : MemCmd::
R—dReq
);

974 
Pack‘
 
	`pkt
(&
mmio_»q
, 
cmd
);

975 
pkt
.
	`d©aStic
(
d©a
);

977 ià(
mmio_»q
.
	`isMm­³dI´
()) {

978 cÚ¡ 
Cyşes
 
	`r_d–ay
(
wr™e
 ?

979 
TheISA
::
	`hªdËI´Wr™e
(
tc
, &
pkt
) :

980 
TheISA
::
	`hªdËI´R—d
(
tc
, &
pkt
));

981  
	`şockP”iod
(è* 
r_d–ay
;

983  
d©aPÜt
.
	`£ndAtomic
(&
pkt
);

985 
	}
}

988 
	gBa£KvmCPU
::
	$£tSigÇlMask
(cÚ¡ 
sig£t_t
 *
mask
)

990 
¡d
::
unique_±r
<
kvm_sigÇl_mask
> 
kvm_mask
;

992 ià(
mask
) {

993 
kvm_mask
.
	`»£t
((
kvm_sigÇl_mask
 *)
İ”©Ü
 
	`Ãw
(

994 (
kvm_sigÇl_mask
è+ (*
mask
)));

998 
	`as£¹
((*
mask
) >= 8);

999 
kvm_mask
->
Ën
 = 8;

1000 
	`memıy
(
kvm_mask
->
sig£t
, 
mask
, kvm_mask->
Ën
);

1003 ià(
	`ioùl
(
KVM_SET_SIGNAL_MASK
, (*)
kvm_mask
.
	`g‘
()) == -1)

1004 
	`·nic
("KVM: Failedo set vCPU signal mask (errno: %i)\n",

1005 
”ºo
);

1006 
	}
}

1009 
	gBa£KvmCPU
::
	$ioùl
(
»que¡
, 
p1
) const

1011 ià(
vıuFD
 == -1)

1012 
	`·nic
("KVM: CPU ioctl called before initialization\n");

1014  ::
	`ioùl
(
vıuFD
, 
»que¡
, 
p1
);

1015 
	}
}

1017 
Tick


1018 
	gBa£KvmCPU
::
	$æushCßËsûdMMIO
()

1020 ià(!
mmioRšg
)

1023 
	`DPRINTF
(
KvmIO
, "KVM: Flushinghe coalesced MMIO„ing buffer\n");

1027 
Tick
 
	`ticks
(0);

1028 
mmioRšg
->
fœ¡
 !ğmmioRšg->
Ï¡
) {

1029 
kvm_cßËsûd_mmio
 &
	`’t
(

1030 
mmioRšg
->
cßËsûd_mmio
[mmioRšg->
fœ¡
]);

1032 
	`DPRINTF
(
KvmIO
, "KVM: Handling coalesced MMIO (addr: 0x%x,†en: %u)\n",

1033 
’t
.
phys_addr
,ƒÁ.
Ën
);

1035 ++
numCßËsûdMMIO
;

1036 
ticks
 +ğ
	`doMMIOAcûss
(
’t
.
phys_addr
,ƒÁ.
d©a
,ƒÁ.
Ën
, 
Œue
);

1038 
mmioRšg
->
fœ¡
 = (mmioRšg->fœ¡ + 1è% 
KVM_COALESCED_MMIO_MAX
;

1041  
ticks
;

1042 
	}
}

1049 
	$ÚTim”Ov”æow
(
signo
, 
sigšfo_t
 *
si
, *
d©a
)

1051 
tim”Ov”æowed
 = 
Œue
;

1052 
	}
}

1060 
	$ÚIn¡Ev’t
(
signo
, 
sigšfo_t
 *
si
, *
d©a
)

1062 
	}
}

1065 
	gBa£KvmCPU
::
	$£tupSigÇlHªdËr
()

1067 
sigaùiÚ
 
§
;

1069 
	`mem£t
(&
§
, 0, (sa));

1070 
§
.
§_sigaùiÚ
 = 
ÚTim”Ov”æow
;

1071 
§
.
§_æags
 = 
SA_SIGINFO
 | 
SA_RESTART
;

1072 ià(
	`sigaùiÚ
(
KVM_TIMER_SIGNAL
, &
§
, 
NULL
) == -1)

1073 
	`·nic
("KVM: Failedo setup vCPUimer signal handler\n");

1075 
	`mem£t
(&
§
, 0, (sa));

1076 
§
.
§_sigaùiÚ
 = 
ÚIn¡Ev’t
;

1077 
§
.
§_æags
 = 
SA_SIGINFO
 | 
SA_RESTART
;

1078 ià(
	`sigaùiÚ
(
KVM_INST_SIGNAL
, &
§
, 
NULL
) == -1)

1079 
	`·nic
("KVM: Failedo setup vCPU instruction signal handler\n");

1081 
sig£t_t
 
sig£t
;

1082 ià(
	`sig´ocmask
(
SIG_BLOCK
, 
NULL
, &
sig£t
) == -1)

1083 
	`·nic
("KVM: Failed get signal mask\n");

1089 
	`£tSigÇlMask
(&
sig£t
);

1093 
	`sigadd£t
(&
sig£t
, 
KVM_TIMER_SIGNAL
);

1094 
	`sigadd£t
(&
sig£t
, 
KVM_INST_SIGNAL
);

1095 ià(
	`sig´ocmask
(
SIG_SETMASK
, &
sig£t
, 
NULL
) == -1)

1096 
	`·nic
("KVM: Failed maskhe KVM control signals\n");

1097 
	}
}

1099 
boŞ


1100 
	gBa£KvmCPU
::
	$disÿrdP’dšgSigÇl
(
signum
) const

1102 
disÿrdedSigÇl
;

1106 
time¥ec
 
timeout
;

1107 
timeout
.
tv_£c
 = 0;

1108 
timeout
.
tv_n£c
 = 0;

1110 
sig£t_t
 
sig£t
;

1111 
	`sigem±y£t
(&
sig£t
);

1112 
	`sigadd£t
(&
sig£t
, 
signum
);

1115 
disÿrdedSigÇl
 = 
	`sigtimedwa™
(&
sig£t
, 
NULL
, &
timeout
);

1116 } 
disÿrdedSigÇl
 =ğ-1 && 
”ºo
 =ğ
EINTR
);

1118 ià(
disÿrdedSigÇl
 =ğ
signum
)

1119  
Œue
;

1120 ià(
disÿrdedSigÇl
 =ğ-1 && 
”ºo
 =ğ
EAGAIN
)

1121  
çl£
;

1123 
	`·nic
("Unexpected„eturn value from sigtimedwait: %i (errno: %i)\n",

1124 
disÿrdedSigÇl
, 
”ºo
);

1125 
	}
}

1128 
	gBa£KvmCPU
::
	$£tupCouÁ”s
()

1130 
	`DPRINTF
(
Kvm
, "Attaching cycle counter...\n");

1131 
P”fKvmCouÁ”CÚfig
 
	`cfgCyşes
(
PERF_TYPE_HARDWARE
,

1132 
PERF_COUNT_HW_CPU_CYCLES
);

1133 
cfgCyşes
.
	`di§bËd
(
Œue
)

1134 .
	`pšÃd
(
Œue
);

1139 
cfgCyşes
.
	`exşude_hv
(
Œue
)

1140 .
	`exşude_ho¡
(
Œue
);

1142 ià(
³rfCÚŒŞËdByTim”
) {

1148 
cfgCyşes
.
	`wakeupEv’ts
(1)

1149 .
	`§m¶eP”iod
(42);

1152 
hwCyşes
.
	`©ch
(
cfgCyşes
,

1155 
	`£tupIn¡CouÁ”
();

1156 
	}
}

1158 
boŞ


1159 
	gBa£KvmCPU
::
	$ŒyD¿š
()

1161 ià(!
d¿šMªag”
)

1162  
çl£
;

1164 ià(!
	`¬chIsD¿šed
()) {

1165 
	`DPRINTF
(
D¿š
, "tryDrain: Architecture code is‚ot„eady.\n");

1166  
çl£
;

1169 ià(
_¡©us
 =ğ
IdË
 || _¡©u =ğ
RuÂšg
) {

1170 
	`DPRINTF
(
D¿š
,

1172 
d¿šMªag”
->
	`sigÇlD¿šDÚe
();

1173 
d¿šMªag”
 = 
NULL
;

1174  
Œue
;

1176 
	`DPRINTF
(
D¿š
, "tryDrain: CPU‚ot„eady.\n");

1177  
çl£
;

1179 
	}
}

1182 
	gBa£KvmCPU
::
	$ioùlRun
()

1184 ià(
	`ioùl
(
KVM_RUN
) == -1) {

1185 ià(
”ºo
 !ğ
EINTR
)

1186 
	`·nic
("KVM: Failedo start virtual CPU (errno: %i)\n",

1187 
”ºo
);

1189 
	}
}

1192 
	gBa£KvmCPU
::
	$£tupIn¡Stİ
()

1194 ià(
comIn¡Ev’tQueue
[0]->
	`em±y
()) {

1195 
	`£tupIn¡CouÁ”
(0);

1197 cÚ¡ 
ušt64_t
 
	`Ãxt
(
comIn¡Ev’tQueue
[0]->
	`ÃxtTick
());

1199 
	`as£¹
(
Ãxt
 > 
ùrIn¡s
);

1200 
	`£tupIn¡CouÁ”
(
Ãxt
 - 
ùrIn¡s
);

1202 
	}
}

1205 
	gBa£KvmCPU
::
	$£tupIn¡CouÁ”
(
ušt64_t
 
³riod
)

1209 ià(
³riod
 =ğ
aùiveIn¡P”iod
 && 
hwIn¡ruùiÚs
.
	`©ched
())

1212 
P”fKvmCouÁ”CÚfig
 
	`cfgIn¡ruùiÚs
(
PERF_TYPE_HARDWARE
,

1213 
PERF_COUNT_HW_INSTRUCTIONS
);

1218 
cfgIn¡ruùiÚs
.
	`exşude_hv
(
Œue
)

1219 .
	`exşude_ho¡
(
Œue
);

1221 ià(
³riod
) {

1223 
cfgIn¡ruùiÚs
.
	`wakeupEv’ts
(1)

1224 .
	`§m¶eP”iod
(
³riod
);

1229 ià(
hwIn¡ruùiÚs
.
	`©ched
())

1230 
hwIn¡ruùiÚs
.
	`d‘ach
();

1231 
	`as£¹
(
hwCyşes
.
	`©ched
());

1232 
hwIn¡ruùiÚs
.
	`©ch
(
cfgIn¡ruùiÚs
,

1234 
hwCyşes
);

1236 ià(
³riod
)

1237 
hwIn¡ruùiÚs
.
	`’abËSigÇls
(
KVM_INST_SIGNAL
);

1239 
aùiveIn¡P”iod
 = 
³riod
;

1240 
	}
}

	@kvm/base.hh

40 #iâdeà
__CPU_KVM_BASE_HH__


41 
	#__CPU_KVM_BASE_HH__


	)

43 
	~<memÜy
>

44 
	~<csigÇl
>

46 
	~"ba£/¡©i¡ics.hh
"

47 
	~"ıu/kvm/³rãv’t.hh
"

48 
	~"ıu/kvm/tim”.hh
"

49 
	~"ıu/kvm/vm.hh
"

50 
	~"ıu/ba£.hh
"

51 
	~"ıu/sim¶e_th»ad.hh
"

54 
	#KVM_TIMER_SIGNAL
 
SIGRTMIN


	)

57 
	#KVM_INST_SIGNAL
 (
SIGRTMIN
+1)

	)

60 
şass
 
	gTh»adCÚ‹xt
;

61 
	gBa£KvmCPUP¬ams
;

78 şas 
	cBa£KvmCPU
 : 
public
 
Ba£CPU


80 
public
:

81 
Ba£KvmCPU
(
Ba£KvmCPUP¬ams
 *
·¿ms
);

82 
	mvœtu®
 ~
Ba£KvmCPU
();

84 
š™
();

85 
¡¬tup
();

86 
»gSts
();

88 
£rŸlizeTh»ad
(
¡d
::
o¡»am
 &
os
, 
Th»adID
 
tid
);

89 
un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
,

90 
Th»adID
 
tid
);

92 
d¿š
(
D¿šMªag”
 *
dm
);

93 
d¿šResume
();

95 
sw™chOut
();

96 
keOv”From
(
Ba£CPU
 *
ıu
);

98 
	$v”ifyMemÜyMode
() const;

100 
Ma¡”PÜt
 &
	$g‘D©aPÜt
(è{  
d©aPÜt
; }

101 
Ma¡”PÜt
 &
	$g‘In¡PÜt
(è{  
š¡PÜt
; 
	}
}

103 
wakeup
();

104 
aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
);

105 
su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
);

106 
d—Îoÿ‹CÚ‹xt
(
Th»adID
 
th»ad_num
);

107 
h®tCÚ‹xt
(
Th»adID
 
th»ad_num
);

109 
Th»adCÚ‹xt
 *
g‘CÚ‹xt
(
Š
);

111 
CouÁ”
 
	$tÙ®In¡s
() const;

112 
CouÁ”
 
	$tÙ®Ops
() const;

115 
vœtu®
 
	`dump
();

130 
Sim¶eTh»ad
 *
th»ad
;

135 
Th»adCÚ‹xt
 *
tc
;

137 
KvmVM
 &
vm
;

139 
´Ùeùed
:

162 
	eStus
 {

172 
IdË
,

178 
RuÂšg
,

191 
RuÂšgS”viû
,

200 
RuÂšgS”viûCom¶‘iÚ
,

201 
	}
};

204 
Stus
 
	g_¡©us
;

210 
tick
();

225 
vœtu®
 
ušt64_t
 
	$g‘Ho¡Cyşes
() const;

248 
vœtu®
 
Tick
 
	`kvmRun
(Tick 
ticks
);

261 
vœtu®
 
Tick
 
	`kvmRunD¿š
();

267 
kvm_run
 *
	$g‘KvmRunS‹
(è{  
_kvmRun
; 
	}
};

277 
ušt8_t
 *
	$g‘Gue¡D©a
(
ušt64_t
 
off£t
) const {

278  (
ušt8_t
 *)
_kvmRun
 + 
off£t
;

279 
	}
};

290 
kvmNÚMaskabËIÁ”ru±
();

302 
kvmIÁ”ru±
(cÚ¡ 
kvm_š‹¼u±
 &
š‹¼u±
);

316 
	$g‘Regi¡”s
(
kvm_»gs
 &
»gs
) const;

317 
	`£tRegi¡”s
(cÚ¡ 
kvm_»gs
 &
»gs
);

318 
	$g‘S³cŸlRegi¡”s
(
kvm_¤egs
 &
»gs
) const;

319 
	`£tS³cŸlRegi¡”s
(cÚ¡ 
kvm_¤egs
 &
»gs
);

326 
	$g‘FPUS‹
(
kvm_åu
 &
¡©e
) const;

327 
	`£tFPUS‹
(cÚ¡ 
kvm_åu
 &
¡©e
);

336 
	`£tOÃReg
(
ušt64_t
 
id
, cÚ¡ *
addr
);

337 
	$£tOÃReg
(
ušt64_t
 
id
, ušt64_ˆ
v®ue
è{ 
	`£tOÃReg
(id, &v®ue); 
	}
}

338 
	$£tOÃReg
(
ušt64_t
 
id
, 
ušt32_t
 
v®ue
è{ 
	`£tOÃReg
(id, &v®ue); 
	}
}

339 
	$g‘OÃReg
(
ušt64_t
 
id
, *
addr
) const;

340 
ušt64_t
 
	$g‘OÃRegU64
(
ušt64_t
 
id
) const {

341 
ušt64_t
 
v®ue
;

342 
	`g‘OÃReg
(
id
, &
v®ue
);

343  
v®ue
;

344 
	}
}

345 
ušt32_t
 
	$g‘OÃRegU32
(
ušt64_t
 
id
) const {

346 
ušt32_t
 
v®ue
;

347 
	`g‘OÃReg
(
id
, &
v®ue
);

348  
v®ue
;

349 
	}
}

360 
	g¡d
::
¡ršg
 
	$g‘AndFÜm©OÃReg
(
ušt64_t
 
id
) const;

371 
vœtu®
 
	`upd©eKvmS‹
() = 0;

381 
vœtu®
 
	`upd©eTh»adCÚ‹xt
() = 0;

387 
	`syncTh»adCÚ‹xt
();

392 
	`syncKvmS‹
();

402 
vœtu®
 
Tick
 
	`hªdËKvmEx™
();

409 
vœtu®
 
Tick
 
	`hªdËKvmEx™IO
();

416 
vœtu®
 
Tick
 
	`hªdËKvmEx™Hy³rÿÎ
();

427 
vœtu®
 
Tick
 
	`hªdËKvmEx™IRQWšdowO³n
();

441 
vœtu®
 
Tick
 
	`hªdËKvmEx™Unknown
();

452 
vœtu®
 
Tick
 
	`hªdËKvmEx™Exû±iÚ
();

462 
vœtu®
 
Tick
 
	`hªdËKvmEx™FaEÁry
();

481 
vœtu®
 
boŞ
 
	$¬chIsD¿šed
(ècÚ¡ {  
Œue
; 
	}
}

492 
Tick
 
doMMIOAcûss
(
Addr
 
·ddr
, *
d©a
, 
size
, 
boŞ
 
wr™e
);

507 
£tSigÇlMask
(cÚ¡ 
sig£t_t
 *
mask
);

523 
	$ioùl
(
»que¡
, 
p1
) const;

524 
	$ioùl
(
»que¡
, *
p1
) const {

525  
	`ioùl
(
»que¡
, ()
p1
);

526 
	}
}

527 
	$ioùl
(
»que¡
) const {

528  
	`ioùl
(
»que¡
, 0L);

529 
	}
}

537 şas 
	cKVMCpuPÜt
 : 
public
 
Ma¡”PÜt


540 
public
:

541 
KVMCpuPÜt
(cÚ¡ 
¡d
::
¡ršg
 &
_Çme
, 
Ba£KvmCPU
 *
_ıu
)

542 : 
Ma¡”PÜt
(
_Çme
, 
_ıu
)

545 
	g´Ùeùed
:

546 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

548 
·nic
("The KVM CPU doesn'tƒxpect„ecvTimingResp!\n");

549  
	gŒue
;

552 
»cvR‘ry
()

554 
·nic
("The KVM CPU doesn'tƒxpect„ecvRetry!\n");

560 
KVMCpuPÜt
 
	gd©aPÜt
;

563 
KVMCpuPÜt
 
	gš¡PÜt
;

566 
Reque¡
 
	gmmio_»q
;

572 
boŞ
 
	gth»adCÚ‹xtDœty
;

578 
boŞ
 
	gkvmS‹Dœty
;

581 cÚ¡ 
	gvıuID
;

583 
	g´iv©e
:

584 
TickEv’t
 : 
public
 
Ev’t


586 
Ba£KvmCPU
 &
ıu
;

588 
TickEv’t
(
Ba£KvmCPU
 &
c
)

589 : 
Ev’t
(
CPU_Tick_Pri
), 
ıu
(
c
) {}

591 
´oûss
(è{ 
	gıu
.
tick
(); }

593 cÚ¡ *
desütiÚ
() const {

605 
Tick
 
æushCßËsûdMMIO
();

611 
£tupSigÇlHªdËr
();

619 
boŞ
 
	$disÿrdP’dšgSigÇl
(
signum
) const;

622 
boŞ
 
	`ŒyD¿š
();

625 
	`ioùlRun
();

628 
vıuFD
;

630 
vıuMM­Size
;

639 
kvm_run
 *
_kvmRun
;

644 
kvm_cßËsûd_mmio_ršg
 *
mmioRšg
;

646 cÚ¡ 
·geSize
;

648 
TickEv’t
 
tickEv’t
;

660 
	`£tupIn¡Stİ
();

664 
	`£tupCouÁ”s
();

676 
	`£tupIn¡CouÁ”
(
ušt64_t
 
³riod
 = 0);

679 
ušt64_t
 
aùiveIn¡P”iod
;

689 
P”fKvmCouÁ”
 
hwCyşes
;

702 
P”fKvmCouÁ”
 
hwIn¡ruùiÚs
;

711 
boŞ
 
³rfCÚŒŞËdByTim”
;

720 
¡d
::
unique_±r
<
Ba£KvmTim”
> 
runTim”
;

723 
ho¡FaùÜ
;

730 
D¿šMªag”
 *
d¿šMªag”
;

732 
public
:

734 
Sts
::
SÿÏr
 
numIn¡s
;

735 
Sts
::
SÿÏr
 
numVMEx™s
;

736 
Sts
::
SÿÏr
 
numVMH®fEÁr›s
;

737 
Sts
::
SÿÏr
 
numEx™SigÇl
;

738 
Sts
::
SÿÏr
 
numMMIO
;

739 
Sts
::
SÿÏr
 
numCßËsûdMMIO
;

740 
Sts
::
SÿÏr
 
numIO
;

741 
Sts
::
SÿÏr
 
numH®t
;

742 
Sts
::
SÿÏr
 
numIÁ”ru±s
;

743 
Sts
::
SÿÏr
 
numHy³rÿÎs
;

747 
CouÁ”
 
ùrIn¡s
;

748 
	}
};

	@kvm/perfevent.cc

40 
	~<sys/ioùl.h
>

41 
	~<sys/mmª.h
>

42 
	~<sys/sysÿÎ.h
>

43 
	~<sys/ty³s.h
>

44 
	~<fú.h
>

45 
	~<sysÿÎ.h
>

46 
	~<uni¡d.h
>

48 
	~<ÿs£¹
>

49 
	~<û¼no
>

50 
	~<csigÇl
>

51 
	~<c¡ršg
>

53 
	~"ba£/misc.hh
"

54 
	~"³rãv’t.hh
"

56 
	gP”fKvmCouÁ”CÚfig
::
	$P”fKvmCouÁ”CÚfig
(
ušt32_t
 
ty³
, 
ušt64_t
 
cÚfig
)

58 
	`mem£t
(&
©Œ
, 0, (attr));

60 
©Œ
.
size
 = 
PERF_ATTR_SIZE_VER0
;

61 
©Œ
.
ty³
 =ype;

62 
©Œ
.
cÚfig
 = config;

63 
	}
}

65 
	gP”fKvmCouÁ”CÚfig
::~
	$P”fKvmCouÁ”CÚfig
()

67 
	}
}

70 
P”fKvmCouÁ”
::
	$P”fKvmCouÁ”
(
P”fKvmCouÁ”CÚfig
 &
cÚfig
, 
pid_t
 
tid
)

71 : 
	`fd
(-1), 
	`ršgBufãr
(
NULL
), 
	`·geSize
(-1)

73 
	`©ch
(
cÚfig
, 
tid
, -1);

74 
	}
}

76 
	gP”fKvmCouÁ”
::
	$P”fKvmCouÁ”
(
P”fKvmCouÁ”CÚfig
 &
cÚfig
,

77 
pid_t
 
tid
, cÚ¡ 
P”fKvmCouÁ”
 &
·»Á
)

78 : 
	`fd
(-1), 
	`ršgBufãr
(
NULL
), 
	`·geSize
(-1)

80 
	`©ch
(
cÚfig
, 
tid
, 
·»Á
);

81 
	}
}

83 
	gP”fKvmCouÁ”
::
	$P”fKvmCouÁ”
()

84 : 
	`fd
(-1), 
	`ršgBufãr
(
NULL
), 
	`·geSize
(-1)

86 
	}
}

88 
	gP”fKvmCouÁ”
::~
	$P”fKvmCouÁ”
()

90 ià(
	`©ched
())

91 
	`d‘ach
();

92 
	}
}

95 
	gP”fKvmCouÁ”
::
	$d‘ach
()

97 
	`as£¹
(
	`©ched
());

99 ià(
	`munm­
(
ršgBufãr
, 
ršgNumPages
 * 
·geSize
) == -1)

100 
	`w¬n
("PerfKvmCounter: Failedo unmap„ing buffer (%i)\n",

101 
”ºo
);

102 
	`şo£
(
fd
);

104 
fd
 = -1;

105 
ršgBufãr
 = 
NULL
;

106 
	}
}

109 
	gP”fKvmCouÁ”
::
	$¡¬t
()

111 ià(
	`ioùl
(
PERF_EVENT_IOC_ENABLE
, 
PERF_IOC_FLAG_GROUP
) == -1)

112 
	`·nic
("KVM: FaedØ’abË…”fÜmªû couÁ” (%i)\n", 
”ºo
);

113 
	}
}

116 
	gP”fKvmCouÁ”
::
	$¡İ
()

118 ià(
	`ioùl
(
PERF_EVENT_IOC_DISABLE
, 
PERF_IOC_FLAG_GROUP
) == -1)

119 
	`·nic
("KVM: FaedØdi§bË…”fÜmªû couÁ” (%i)\n", 
”ºo
);

120 
	}
}

123 
	gP”fKvmCouÁ”
::
	$³riod
(
ušt64_t
 
³riod
)

125 ià(
	`ioùl
(
PERF_EVENT_IOC_PERIOD
, &
³riod
) == -1)

126 
	`·nic
("KVM: FaedØ£ˆ³riod oà³rfÜmªû couÁ” (%i)\n", 
”ºo
);

127 
	}
}

130 
	gP”fKvmCouÁ”
::
	$»äesh
(
»äesh
)

132 ià(
	`ioùl
(
PERF_EVENT_IOC_REFRESH
, 
»äesh
) == -1)

133 
	`·nic
("KVM: FaedØ»äesh…”fÜmªû couÁ” (%i)\n", 
”ºo
);

134 
	}
}

136 
ušt64_t


137 
	gP”fKvmCouÁ”
::
	$»ad
() const

139 
ušt64_t
 
v®ue
;

141 
	`»ad
(&
v®ue
, (
ušt64_t
));

142  
v®ue
;

143 
	}
}

146 
	gP”fKvmCouÁ”
::
	$’abËSigÇls
(
pid_t
 
tid
, 
sigÇl
)

148 
f_owÃr_ex
 
sigowÃr
;

150 
sigowÃr
.
ty³
 = 
F_OWNER_TID
;

151 
sigowÃr
.
pid
 = 
tid
;

153 ià(
	`fú
(
F_SETOWN_EX
, &
sigowÃr
) == -1 ||

154 
	`fú
(
F_SETSIG
, 
sigÇl
) == -1 ||

155 
	`fú
(
F_SETFL
, 
O_ASYNC
) == -1)

156 
	`·nic
("PerfKvmCounter: Failedoƒnable signals for counter (%i)\n",

157 
”ºo
);

158 
	}
}

161 
	gP”fKvmCouÁ”
::
	$©ch
(
P”fKvmCouÁ”CÚfig
 &
cÚfig
,

162 
pid_t
 
tid
, 
group_fd
)

164 
	`as£¹
(!
	`©ched
());

166 
fd
 = 
	`sysÿÎ
(
__NR_³rf_ev’t_İ’
,

167 &
cÚfig
.
©Œ
, 
tid
,

169 
group_fd
,

171 ià(
fd
 == -1)

172 
	`·nic
("P”fKvmCouÁ”::İ’ faed (%i)\n", 
”ºo
);

174 
	`mm­P”f
(1);

175 
	}
}

177 
pid_t


178 
	gP”fKvmCouÁ”
::
	$g‘tid
()

180  
	`sysÿÎ
(
__NR_g‘tid
);

181 
	}
}

184 
	gP”fKvmCouÁ”
::
	$mm­P”f
(
·ges
)

186 
	`as£¹
(
	`©ched
());

187 
	`as£¹
(
ršgBufãr
 =ğ
NULL
);

189 ià(
·geSize
 == -1) {

190 
·geSize
 = 
	`syscÚf
(
_SC_PAGE_SIZE
);

191 ià(
·geSize
 == -1)

192 
	`·nic
("PerfKvmCounter: Failedo determine…age size (%i)\n",

193 
”ºo
);

196 
ršgNumPages
 = 
·ges
 + 1;

197 
ršgBufãr
 = (
³rf_ev’t_mm­_·ge
 *)
	`mm­
(

198 
NULL
, 
ršgNumPages
 * 4096,

199 
PROT_READ
 | 
PROT_WRITE
, 
MAP_SHARED
,

200 
fd
, 0);

201 ià(
ršgBufãr
 =ğ
MAP_FAILED
)

202 
	`·nic
("PerfKvmCounter: MMAP failed (%i)\n",

203 
”ºo
);

204 
	}
}

207 
	gP”fKvmCouÁ”
::
	$fú
(
cmd
, 
p1
)

209 
	`as£¹
(
	`©ched
());

210  ::
	`fú
(
fd
, 
cmd
, 
p1
);

211 
	}
}

214 
	gP”fKvmCouÁ”
::
	$ioùl
(
»que¡
, 
p1
)

216 
	`as£¹
(
	`©ched
());

217  ::
	`ioùl
(
fd
, 
»que¡
, 
p1
);

218 
	}
}

221 
	gP”fKvmCouÁ”
::
	$»ad
(*
buf
, 
size_t
 
size
) const

223 *
_buf
 = (*)
buf
;

224 
size_t
 
_size
 = 
size
;

226 
	`as£¹
(
	`©ched
());

229 
ssize_t
 
»t
;

230 
»t
 = ::
	`»ad
(
fd
, 
_buf
, 
_size
);

231 
»t
) {

233 ià(
”ºo
 !ğ
EAGAIN
)

234 
	`·nic
("P”fKvmCouÁ”::»ad faed (%i)\n", 
”ºo
);

238 
	`·nic
("PerfKvmCounter::read unexpected EOF.\n");

241 
_size
 -ğ
»t
;

242 
_buf
 +ğ
»t
;

245 } 
_size
);

246 
	}
}

	@kvm/perfevent.hh

40 #iâdeà
__CPU_KVM_PERFEVENT_HH__


41 
	#__CPU_KVM_PERFEVENT_HH__


	)

43 
	~<lšux/³rf_ev’t.h
>

44 
	~<sys/ty³s.h
>

46 
	~<š‰y³s.h
>

48 
	~"cÚfig/have_³rf_©Œ_exşude_ho¡.hh
"

53 şas 
	cP”fKvmCouÁ”CÚfig


55 
	mpublic
:

76 
P”fKvmCouÁ”CÚfig
(
ušt32_t
 
ty³
, 
ušt64_t
 
cÚfig
);

77 ~
P”fKvmCouÁ”CÚfig
();

87 
	mP”fKvmCouÁ”CÚfig
 &
	$§m¶eP”iod
(
ušt64_t
 
³riod
) {

88 
©Œ
.
äeq
 = 0;

89 
©Œ
.
§m¶e_³riod
 = 
³riod
;

90  *
this
;

100 
P”fKvmCouÁ”CÚfig
 &
	$wakeupEv’ts
(
ušt32_t
 
ev’ts
) {

101 
©Œ
.
w©”m¬k
 = 0;

102 
©Œ
.
wakeup_ev’ts
 = 
ev’ts
;

103  *
this
;

104 
	}
}

112 
	gP”fKvmCouÁ”CÚfig
 &
	$di§bËd
(
boŞ
 
v®
) {

113 
©Œ
.
di§bËd
 = 
v®
;

114  *
this
;

115 
	}
}

125 
	gP”fKvmCouÁ”CÚfig
 &
	$pšÃd
(
boŞ
 
v®
) {

126 
©Œ
.
pšÃd
 = 
v®
;

127  *
this
;

128 
	}
}

143 
	gP”fKvmCouÁ”CÚfig
 &
	$exşude_ho¡
(
boŞ
 
v®
) {

144 #ià
HAVE_PERF_ATTR_EXCLUDE_HOST
 == 1

145 
©Œ
.
exşude_ho¡
 = 
v®
;

147  *
this
;

148 
	}
}

158 
	gP”fKvmCouÁ”CÚfig
 &
	$exşude_hv
(
boŞ
 
v®
) {

159 
©Œ
.
exşude_hv
 = 
v®
;

160  *
this
;

161 
	}
}

164 
³rf_ev’t_©Œ
 
	g©Œ
;

170 şas 
	cP”fKvmCouÁ”


172 
	mpublic
:

179 
P”fKvmCouÁ”
(
P”fKvmCouÁ”CÚfig
 &
cÚfig
, 
pid_t
 
tid
);

188 
P”fKvmCouÁ”
(
P”fKvmCouÁ”CÚfig
 &
cÚfig
,

189 
pid_t
 
tid
, cÚ¡ 
P”fKvmCouÁ”
 &
·»Á
);

193 
P”fKvmCouÁ”
();

194 ~
P”fKvmCouÁ”
();

206 
	$©ch
(
P”fKvmCouÁ”CÚfig
 &
cÚfig
, 
pid_t
 
tid
) {

207 
	`©ch
(
cÚfig
, 
tid
, -1);

221 
	$©ch
(
P”fKvmCouÁ”CÚfig
 &
cÚfig
,

222 
pid_t
 
tid
, cÚ¡ 
P”fKvmCouÁ”
 &
·»Á
) {

223 
	`©ch
(
cÚfig
, 
tid
, 
·»Á
.
fd
);

224 
	}
}

227 
d‘ach
();

230 
boŞ
 
	$©ched
(ècÚ¡ {  
fd
 !ğ-1; 
	}
}

238 
¡¬t
();

246 
¡İ
();

264 
³riod
(
ušt64_t
…eriod);

278 
»äesh
(refresh);

283 
ušt64_t
 
	$»ad
() const;

291 
	`’abËSigÇls
(
pid_t
 
tid
, 
sigÇl
);

300 
	$’abËSigÇls
(
sigÇl
è{ 
	`’abËSigÇls
(
	`g‘tid
(), sigÇl); 
	}
}

302 
	g´iv©e
:

304 
P”fKvmCouÁ”
(cÚ¡ P”fKvmCouÁ” &
th©
);

306 
	gP”fKvmCouÁ”
 &
	gİ”©Ü
=(cÚ¡ 
P”fKvmCouÁ”
 &
th©
);

308 
©ch
(
P”fKvmCouÁ”CÚfig
 &
cÚfig
, 
pid_t
 
tid
, 
group_fd
);

315 
pid_t
 
g‘tid
();

329 
mm­P”f
(
·ges
);

341 
fú
(
cmd
, 
p1
);

342 
	$fú
(
cmd
, *
p1
è{  
	`fú
(cmd, (í1); 
	}
}

355 
ioùl
(
»que¡
, 
p1
);

356 
	$ioùl
(
»que¡
, *
p1
è{  
	`ioùl
Ôeque¡, (í1); 
	}
}

357 
	$ioùl
(
»que¡
è{  
	`ioùl
Ôeque¡, 0L); 
	}
}

366 
	$»ad
(*
buf
, 
size_t
 
size
) const;

372 
fd
;

375 
³rf_ev’t_mm­_·ge
 *
ršgBufãr
;

377 
ršgNumPages
;

380 
·geSize
;

381 
	}
};

	@kvm/timer.cc

40 
	~<®gÜ™hm
>

41 
	~<csigÇl
>

42 
	~<ùime
>

44 
	~"ba£/misc.hh
"

45 
	~"ba£/Œaû.hh
"

46 
	~"ıu/kvm/tim”.hh
"

47 
	~"debug/KvmTim”.hh
"

56 cÚ¡ 
ušt64_t
 
	gMIN_HOST_CYCLES
 = 1000;

58 
	gPosixKvmTim”
::
	$PosixKvmTim”
(
signo
, 
şockid_t
 
şockID
,

59 
ho¡FaùÜ
, 
Tick
 
ho¡F»q
)

60 : 
	`Ba£KvmTim”
(
signo
, 
ho¡FaùÜ
, 
ho¡F»q
),

61 
	$şockID
(
şockID
)

63 
sigev’t
 
£v
;

68 
£v
.
sigev_nÙify
 = 
SIGEV_SIGNAL
;

69 
£v
.
sigev_signo
 = 
signo
;

70 
£v
.
sigev_v®ue
.
siv®_±r
 = 
NULL
;

72 
	`tim”_ü—‹
(
şockID
, &
£v
, &
tim”
) == -1) {

73 ià(
”ºo
 !ğ
EAGAIN
)

74 
	`·nic
("tim”_ü—‹: %i", 
”ºo
);

76 
	}
}

78 
	gPosixKvmTim”
::~
	$PosixKvmTim”
()

80 
	`tim”_d–‘e
(
tim”
);

81 
	}
}

84 
	gPosixKvmTim”
::
	$¬m
(
Tick
 
ticks
)

86 
™im”¥ec
 
ts
;

87 
	`mem£t
(&
ts
, 0, (ts));

89 
ts
.
™_š‹rv®
.
tv_£c
 = 0;

90 
ts
.
™_š‹rv®
.
tv_n£c
 = 0;

91 
ts
.
™_v®ue
.
tv_£c
 = 
	`ho¡Ns
(
ticks
) / 1000000000ULL;

92 
ts
.
™_v®ue
.
tv_n£c
 = 
	`ho¡Ns
(
ticks
) % 1000000000ULL;

94 
	`as£¹
(
ts
.
™_v®ue
.
tv_n£c
 > 0 ||s.™_v®ue.
tv_£c
 > 0);

96 
	`DPRINTF
(
KvmTim”
, "Arming POSIXimer: %iicks (%is%ins)\n",

97 
ticks
, 
ts
.
™_v®ue
.
tv_£c
,s.™_v®ue.
tv_n£c
);

99 ià(
	`tim”_£‰ime
(
tim”
, 0, &
ts
, 
NULL
) == -1)

100 
	`·nic
("PosixKvmTimer: Failedo‡rmimer\n");

101 
	}
}

104 
	gPosixKvmTim”
::
	$di§rm
()

106 
™im”¥ec
 
ts
;

107 
	`mem£t
(&
ts
, 0, (ts));

109 
	`DPRINTF
(
KvmTim”
, "Disarming POSIXimer\n");

111 ià(
	`tim”_£‰ime
(
tim”
, 0, &
ts
, 
NULL
) == -1)

112 
	`·nic
("PosixKvmTimer: Failedo disarmimer\n");

113 
	}
}

115 
Tick


116 
	gPosixKvmTim”
::
	$ÿlcResŞutiÚ
()

118 
time¥ec
 
ts
;

120 ià(
	`şock_g‘»s
(
şockID
, &
ts
) == -1)

121 
	`·nic
("PosixKvmTimer: Failedo getimer„esolution\n");

123 cÚ¡ 
ušt64_t
 
	`»s_ns
(
ts
.
tv_£c
 * 1000000000ULL +s.
tv_n£c
);

132 cÚ¡ 
Tick
 
	`»sŞutiÚ
(
	`ticksFromHo¡Ns
(
»s_ns
) + 1);

137 cÚ¡ 
Tick
 
	`mš_cyşes
(
	`ticksFromHo¡Cyşes
(
MIN_HOST_CYCLES
));

139  
¡d
::
	`max
(
»sŞutiÚ
, 
mš_cyşes
);

140 
	}
}

143 
	gP”fKvmTim”
::
	$P”fKvmTim”
(
P”fKvmCouÁ”
 &
ùr
,

144 
signo
, 
ho¡FaùÜ
, 
Tick
 
ho¡F»q
)

145 : 
	`Ba£KvmTim”
(
signo
, 
ho¡FaùÜ
, 
ho¡F»q
),

146 
	$hwOv”æow
(
ùr
)

148 
hwOv”æow
.
	`’abËSigÇls
(
signo
);

149 
	}
}

151 
	gP”fKvmTim”
::~
	$P”fKvmTim”
()

153 
	}
}

156 
P”fKvmTim”
::
	$¬m
(
Tick
 
ticks
)

158 
hwOv”æow
.
	`³riod
(
	`ho¡Cyşes
(
ticks
));

159 
hwOv”æow
.
	`»äesh
(1);

160 
	}
}

163 
	gP”fKvmTim”
::
	$di§rm
()

165 
hwOv”æow
.
	`¡İ
();

166 
	}
}

168 
Tick


169 
	gP”fKvmTim”
::
	$ÿlcResŞutiÚ
()

171  
	`ticksFromHo¡Cyşes
(
MIN_HOST_CYCLES
);

172 
	}
}

	@kvm/timer.hh

40 #iâdeà
__CPU_KVM_TIMER_HH__


41 
	#__CPU_KVM_TIMER_HH__


	)

43 
	~<ùime
>

45 
	~"ıu/kvm/³rãv’t.hh
"

46 
	~"sim/cÜe.hh
"

62 şas 
	cBa£KvmTim”


64 
	mpublic
:

73 
	$Ba£KvmTim”
(
signo
, 
ho¡FaùÜ
, 
Tick
 
ho¡F»q
)

74 : 
	`signo
(
signo
), 
	`_»sŞutiÚ
(0),

75 
	`ho¡FaùÜ
(
ho¡FaùÜ
), 
	$ho¡F»q
(
ho¡F»q
) {};

76 
vœtu®
 ~
	$Ba£KvmTim”
(è{
	}
};

90 
vœtu®
 
¬m
(
Tick
 
ticks
) = 0;

97 
vœtu®
 
di§rm
() = 0;

106 
Tick
 
	$»sŞutiÚ
() {

107 ià(
_»sŞutiÚ
 == 0)

108 
_»sŞutiÚ
 = 
	`ÿlcResŞutiÚ
();

109  
_»sŞutiÚ
;

110 
	}
}

119 
Tick
 
	$ticksFromHo¡Cyşes
(
ušt64_t
 
cyşes
) {

120  
cyşes
 * 
ho¡FaùÜ
 * 
ho¡F»q
;

121 
	}
}

130 
Tick
 
	$ticksFromHo¡Ns
(
ušt64_t
 
ns
) {

131  
ns
 * 
ho¡FaùÜ
 * 
SimClock
::
Flßt
::ns;

132 
	}
}

134 
	g´Ùeùed
:

141 
vœtu®
 
Tick
 
ÿlcResŞutiÚ
() = 0;

148 
ušt64_t
 
	$ho¡Ns
(
Tick
 
ticks
) {

149  
ticks
 / (
SimClock
::
Flßt
::
ns
 * 
ho¡FaùÜ
);

150 
	}
}

158 
ušt64_t
 
	$ho¡Cyşes
(
Tick
 
ticks
) {

159  
ticks
 / (
ho¡F»q
 * 
ho¡FaùÜ
);

160 
	}
}

163 
	gsigno
;

165 
	g´iv©e
:

167 
mubË
 
Tick
 
_»sŞutiÚ
;

170 
	gho¡FaùÜ
;

172 
Tick
 
	gho¡F»q
;

183 şas 
	cPosixKvmTim”
 : 
public
 
Ba£KvmTim”


185 
public
:

192 
PosixKvmTim”
(
signo
, 
şockid_t
 
şockID
,

193 
ho¡FaùÜ
, 
Tick
 
ho¡F»q
);

194 ~
PosixKvmTim”
();

196 
¬m
(
Tick
 
ticks
);

197 
di§rm
();

199 
	m´Ùeùed
:

200 
Tick
 
ÿlcResŞutiÚ
();

202 
	m´iv©e
:

203 
şockid_t
 
şockID
;

204 
tim”_t
 
	mtim”
;

215 şas 
	cP”fKvmTim”
 : 
public
 
Ba£KvmTim”


217 
public
:

232 
P”fKvmTim”
(
P”fKvmCouÁ”
 &
ùr
,

233 
signo
,

234 
ho¡FaùÜ
, 
Tick
 
ho¡F»q
);

235 ~
P”fKvmTim”
();

237 
¬m
(
Tick
 
ticks
);

238 
di§rm
();

240 
	m´Ùeùed
:

241 
Tick
 
ÿlcResŞutiÚ
();

243 
	m´iv©e
:

244 
P”fKvmCouÁ”
 &
hwOv”æow
;

	@kvm/vm.cc

40 
	~<lšux/kvm.h
>

41 
	~<sys/ioùl.h
>

42 
	~<sys/¡©.h
>

43 
	~<sys/ty³s.h
>

44 
	~<fú.h
>

45 
	~<uni¡d.h
>

47 
	~<û¼no
>

48 
	~<memÜy
>

50 
	~"ıu/kvm/vm.hh
"

51 
	~"debug/Kvm.hh
"

52 
	~"·¿ms/KvmVM.hh
"

53 
	~"sim/sy¡em.hh
"

55 
	#EXPECTED_KVM_API_VERSION
 12

	)

57 #ià
EXPECTED_KVM_API_VERSION
 !ğ
KVM_API_VERSION


58 #”rÜ 
UnsuµÜ‹d
 
KVM
 
v”siÚ


61 
Kvm
 *
	gKvm
::
š¡ªû
 = 
NULL
;

63 
	gKvm
::
	$Kvm
()

64 : 
	`kvmFD
(-1), 
	`­iV”siÚ
(-1), 
	$vıuMM­Size
(0)

66 
kvmFD
 = ::
	`İ’
("/dev/kvm", 
O_RDWR
);

67 ià(
kvmFD
 == -1)

68 
	`çl
("KVM: Failedo open /dev/kvm\n");

70 
­iV”siÚ
 = 
	`ioùl
(
KVM_GET_API_VERSION
);

71 ià(
­iV”siÚ
 !ğ
EXPECTED_KVM_API_VERSION
)

72 
	`çl
("KVM: Incompatible API version\n");

74 
vıuMM­Size
 = 
	`ioùl
(
KVM_GET_VCPU_MMAP_SIZE
);

75 ià(
vıuMM­Size
 == -1)

76 
	`·nic
("KVM: Failedo get virtual CPU MMAP size\n");

77 
	}
}

79 
	gKvm
::~
	$Kvm
()

81 
	`şo£
(
kvmFD
);

82 
	}
}

84 
Kvm
 *

85 
	gKvm
::
	$ü—‹
()

87 ià(!
š¡ªû
)

88 
š¡ªû
 = 
Ãw
 
	`Kvm
();

90  
š¡ªû
;

91 
	}
}

93 
boŞ


94 
	gKvm
::
	$ÿpU£rMemÜy
() const

96  
	`checkEx‹nsiÚ
(
KVM_CAP_USER_MEMORY
) != 0;

97 
	}
}

99 
boŞ


100 
	gKvm
::
	$ÿpS‘TSSAdd»ss
() const

102  
	`checkEx‹nsiÚ
(
KVM_CAP_SET_TSS_ADDR
) != 0;

103 
	}
}

105 
boŞ


106 
	gKvm
::
	$ÿpEx‹ndedCPUID
() const

108  
	`checkEx‹nsiÚ
(
KVM_CAP_EXT_CPUID
) != 0;

109 
	}
}

111 
boŞ


112 
	gKvm
::
	$ÿpU£rNMI
() const

114 #ifdeà
KVM_CAP_USER_NMI


115  
	`checkEx‹nsiÚ
(
KVM_CAP_USER_NMI
) != 0;

117  
çl£
;

119 
	}
}

122 
	gKvm
::
	$ÿpCßËsûdMMIO
() const

124  
	`checkEx‹nsiÚ
(
KVM_CAP_COALESCED_MMIO
);

125 
	}
}

127 
boŞ


128 
	gKvm
::
	$ÿpOÃReg
() const

130 #ifdeà
KVM_CAP_ONE_REG


131  
	`checkEx‹nsiÚ
(
KVM_CAP_ONE_REG
) != 0;

133  
çl£
;

135 
	}
}

137 
boŞ


138 
	gKvm
::
	$ÿpIRQCh
() const

140  
	`checkEx‹nsiÚ
(
KVM_CAP_IRQCHIP
) != 0;

141 
	}
}

143 
boŞ


144 
	gKvm
::
	$ÿpVCPUEv’ts
() const

146 #ifdeà
KVM_CAP_VCPU_EVENTS


147  
	`checkEx‹nsiÚ
(
KVM_CAP_VCPU_EVENTS
) != 0;

149  
çl£
;

151 
	}
}

153 
boŞ


154 
	gKvm
::
	$ÿpDebugRegs
() const

156 #ifdeà
KVM_CAP_DEBUGREGS


157  
	`checkEx‹nsiÚ
(
KVM_CAP_DEBUGREGS
) != 0;

159  
çl£
;

161 
	}
}

163 
boŞ


164 
	gKvm
::
	$ÿpXCRs
() const

166 #ifdeà
KVM_CAP_XCRS


167  
	`checkEx‹nsiÚ
(
KVM_CAP_XCRS
) != 0;

169  
çl£
;

171 
	}
}

173 
boŞ


174 
	gKvm
::
	$ÿpXSave
() const

176 #ifdeà
KVM_CAP_XSAVE


177  
	`checkEx‹nsiÚ
(
KVM_CAP_XSAVE
) != 0;

179  
çl£
;

181 
	}
}

183 
boŞ


184 
	gKvm
::
	$g‘SuµÜ‹dCPUID
(
kvm_ıuid2
 &
ıuid
) const

186 #ià
	`defšed
(
__i386__
è|| defšed(
__x86_64__
)

187 ià(
	`ioùl
(
KVM_GET_SUPPORTED_CPUID
, (*)&
ıuid
) == -1) {

188 ià(
”ºo
 =ğ
E2BIG
)

189  
çl£
;

191 
	`·nic
("KVM: FaedØg‘ suµÜ‹d CPUID (”ºo: %i)\n", 
”ºo
);

193  
Œue
;

195 
	`·nic
("KVM: getSupportedCPUID is unsupported onhis…latform.\n");

197 
	}
}

199 cÚ¡ 
	gKvm
::
CPUIDVeùÜ
 &

200 
Kvm
::
	$g‘SuµÜ‹dCPUID
() const

202 ià(
suµÜ‹dCPUIDCache
.
	`em±y
()) {

203 
¡d
::
unique_±r
<
kvm_ıuid2
> 
ıuid
;

204 
	`i
(1);

206 
ıuid
.
	`»£t
((
kvm_ıuid2
 *)
İ”©Ü
 
	`Ãw
(

207 (
kvm_ıuid2
è+ 
i
 * (
kvm_ıuid_’Œy2
)));

209 
ıuid
->
ÃÁ
 = 
i
;

210 ++
i
;

211 } !
	`g‘SuµÜ‹dCPUID
(*
ıuid
));

212 
suµÜ‹dCPUIDCache
.
	`assign
(
ıuid
->
’Œ›s
,

213 
ıuid
->
’Œ›s
 + cpuid->
ÃÁ
);

216  
suµÜ‹dCPUIDCache
;

217 
	}
}

219 
boŞ


220 
	gKvm
::
	$g‘SuµÜ‹dMSRs
(
kvm_m¤_li¡
 &
m¤s
) const

222 #ià
	`defšed
(
__i386__
è|| defšed(
__x86_64__
)

223 ià(
	`ioùl
(
KVM_GET_MSR_INDEX_LIST
, (*)&
m¤s
) == -1) {

224 ià(
”ºo
 =ğ
E2BIG
)

225  
çl£
;

227 
	`·nic
("KVM: FaedØg‘ suµÜ‹d CPUID (”ºo: %i)\n", 
”ºo
);

229  
Œue
;

231 
	`·nic
("KVM: getSupportedCPUID is unsupported onhis…latform.\n");

233 
	}
}

235 cÚ¡ 
	gKvm
::
MSRIndexVeùÜ
 &

236 
Kvm
::
	$g‘SuµÜ‹dMSRs
() const

238 ià(
suµÜ‹dMSRCache
.
	`em±y
()) {

239 
¡d
::
unique_±r
<
kvm_m¤_li¡
> 
m¤s
;

240 
	`i
(0);

242 
m¤s
.
	`»£t
((
kvm_m¤_li¡
 *)
İ”©Ü
 
	`Ãw
(

243 (
kvm_m¤_li¡
è+ 
i
 * (
ušt32_t
)));

245 
m¤s
->
nm¤s
 = 
i
;

246 ++
i
;

247 } !
	`g‘SuµÜ‹dMSRs
(*
m¤s
));

248 
suµÜ‹dMSRCache
.
	`assign
(
m¤s
->
šdiûs
, m¤s->šdiû + m¤s->
nm¤s
);

251  
suµÜ‹dMSRCache
;

252 
	}
}

255 
	gKvm
::
	$checkEx‹nsiÚ
(
ex‹nsiÚ
) const

257 
»t
 = 
	`ioùl
(
KVM_CHECK_EXTENSION
, 
ex‹nsiÚ
);

258 ià(
»t
 == -1)

259 
	`·nic
("KVM: ioctl failed when checking forƒxtension\n");

260  
»t
;

261 
	}
}

264 
	gKvm
::
	$ioùl
(
»que¡
, 
p1
) const

266 
	`as£¹
(
kvmFD
 != -1);

268  ::
	`ioùl
(
kvmFD
, 
»que¡
, 
p1
);

269 
	}
}

272 
	gKvm
::
	$ü—‹VM
()

274 
vmFD
;

276 
vmFD
 = 
	`ioùl
(
KVM_CREATE_VM
);

277 ià(
vmFD
 == -1)

278 
	`·nic
("Failedo create KVM VM\n");

280  
vmFD
;

281 
	}
}

284 
	gKvmVM
::
	$KvmVM
(
KvmVMP¬ams
 *
·¿ms
)

285 : 
	`SimObjeù
(
·¿ms
),

286 
	`kvm
(), 
	`sy¡em
(
·¿ms
->
sy¡em
),

287 
	`vmFD
(
kvm
.
	`ü—‹VM
()),

288 
	`¡¬‹d
(
çl£
),

289 
	$ÃxtVCPUID
(0)

292 
i
 = 0; i < 
·¿ms
->
cßËsûdMMIO
.
	`size
(); ++i)

293 
	`cßËsûMMIO
(
·¿ms
->
cßËsûdMMIO
[
i
]);

294 
	}
}

296 
	gKvmVM
::~
	$KvmVM
()

298 
	`şo£
(
vmFD
);

299 
	}
}

302 
	gKvmVM
::
	$ıuS¹up
()

304 ià(
¡¬‹d
)

306 
¡¬‹d
 = 
Œue
;

308 
	`d–ayedS¹up
();

309 
	}
}

312 
	gKvmVM
::
	$d–ayedS¹up
()

314 cÚ¡ 
¡d
::
veùÜ
<¡d::
·œ
<
AddrRªge
, 
ušt8_t
*> >&
	`memÜ›s
(

315 
sy¡em
->
	`g‘PhysMem
().
	`g‘BackšgStÜe
());

317 
	`DPRINTF
(
Kvm
, "M­pšg %˜memÜy„egiÚ(s)\n", 
memÜ›s
.
	`size
());

318 
	`¦Ù
(0); 
¦Ù
 < 
memÜ›s
.
	`size
(); ++slot) {

319 cÚ¡ 
AddrRªge
 &
	`¿nge
(
memÜ›s
[
¦Ù
].
fœ¡
);

320 *
	`pmem
(
memÜ›s
[
¦Ù
].
£cÚd
);

322 ià(
pmem
) {

323 
	`DPRINTF
(
Kvm
, "Mapping„egion: 0x%p -> 0x%llx [size: 0x%llx]\n",

324 
pmem
, 
¿nge
.
	`¡¬t
(),„ªge.
	`size
());

326 
	`£tU£rMemÜyRegiÚ
(
¦Ù
, 
pmem
, 
¿nge
, 0 );

328 
	`DPRINTF
(
Kvm
, "Z”o-»giÚ‚Ù m­³d: [0x%Îx]\n", 
¿nge
.
	`¡¬t
());

329 
	`hack
("KVM: Zero memory handled‡s IO\n");

332 
	}
}

335 
	gKvmVM
::
	$£tU£rMemÜyRegiÚ
(
ušt32_t
 
¦Ù
,

336 *
ho¡_addr
, 
AddrRªge
 
gue¡_¿nge
,

337 
ušt32_t
 
æags
)

339 ià(
gue¡_¿nge
.
	`š‹¾—ved
())

340 
	`·nic
("Triedo map‡n interleaved memory„ange into‡ KVM VM.\n");

342 
	`£tU£rMemÜyRegiÚ
(
¦Ù
, 
ho¡_addr
,

343 
gue¡_¿nge
.
	`¡¬t
(), gue¡_¿nge.
	`size
(),

344 
æags
);

345 
	}
}

348 
	gKvmVM
::
	$£tU£rMemÜyRegiÚ
(
ušt32_t
 
¦Ù
,

349 *
ho¡_addr
, 
Addr
 
gue¡_addr
,

350 
ušt64_t
 
Ën
, 
ušt32_t
 
æags
)

352 
kvm_u£r¥aû_memÜy_»giÚ
 
m
;

354 
	`mem£t
(&
m
, 0, (m));

355 
m
.
¦Ù
 = slot;

356 
m
.
æags
 = flags;

357 
m
.
gue¡_phys_addr
 = (
ušt64_t
)
gue¡_addr
;

358 
m
.
memÜy_size
 = 
Ën
;

359 
m
.
u£r¥aû_addr
 = (
__u64
)
ho¡_addr
;

361 ià(
	`ioùl
(
KVM_SET_USER_MEMORY_REGION
, (*)&
m
) == -1) {

362 
	`·nic
("Failedo setup KVM memory„egion:\n"

367 
m
.
u£r¥aû_addr
, m.
gue¡_phys_addr
,

368 
m
.
memÜy_size
, m.
æags
);

370 
	}
}

373 
	gKvmVM
::
	$cßËsûMMIO
(cÚ¡ 
AddrRªge
 &
¿nge
)

375 
	`cßËsûMMIO
(
¿nge
.
	`¡¬t
(),„ªge.
	`size
());

376 
	}
}

379 
	gKvmVM
::
	$cßËsûMMIO
(
Addr
 
¡¬t
, 
size
)

381 
kvm_cßËsûd_mmio_zÚe
 
zÚe
;

383 
zÚe
.
addr
 = 
¡¬t
;

384 
zÚe
.
size
 = size;

385 
zÚe
.
·d
 = 0;

387 
	`DPRINTF
(
Kvm
, "KVM: Registering coalesced MMIO„egion [0x%x, 0x%x]\n",

388 
zÚe
.
addr
, zÚe.add¸+ zÚe.
size
 - 1);

389 ià(
	`ioùl
(
KVM_REGISTER_COALESCED_MMIO
, (*)&
zÚe
) == -1)

390 
	`·nic
("KVM: Failedo„egister coalesced MMIO„egion (%i)\n",

391 
”ºo
);

392 
	}
}

395 
	gKvmVM
::
	$£tTSSAdd»ss
(
Addr
 
tss_add»ss
)

397 ià(
	`ioùl
(
KVM_SET_TSS_ADDR
, ()
tss_add»ss
) == -1)

398 
	`·nic
("KVM: Failedo set VM TSS‡ddress\n");

399 
	}
}

402 
	gKvmVM
::
	$ü—‹IRQCh
()

404 ià(
_hasK”ÃlIRQCh
)

405 
	`·nic
("KvmVM::createIRQChip calledwice.\n");

407 ià(
	`ioùl
(
KVM_CREATE_IRQCHIP
) != -1) {

408 
_hasK”ÃlIRQCh
 = 
Œue
;

410 
	`w¬n
("KVM: Failedo create in-kernel IRQ chip (errno: %i)\n",

411 
”ºo
);

412 
_hasK”ÃlIRQCh
 = 
çl£
;

414 
	}
}

417 
	gKvmVM
::
	$£tIRQLše
(
ušt32_t
 
œq
, 
boŞ
 
high
)

419 
kvm_œq_Ëv–
 
kvm_Ëv–
;

421 
kvm_Ëv–
.
œq
 = irq;

422 
kvm_Ëv–
.
Ëv–
 = 
high
 ? 1 : 0;

424 ià(
	`ioùl
(
KVM_IRQ_LINE
, &
kvm_Ëv–
) == -1)

425 
	`·nic
("KVM: Failedo set IRQ†ine†evel (errno: %i)\n",

426 
”ºo
);

427 
	}
}

430 
	gKvmVM
::
	$ü—‹VCPU
(
vıuID
)

432 
fd
;

434 
fd
 = 
	`ioùl
(
KVM_CREATE_VCPU
, 
vıuID
);

435 ià(
fd
 == -1)

436 
	`·nic
("KVM: Failedo create virtual CPU");

438  
fd
;

439 
	}
}

442 
	gKvmVM
::
	$®locVCPUID
()

444  
ÃxtVCPUID
++;

445 
	}
}

448 
	gKvmVM
::
	$ioùl
(
»que¡
, 
p1
) const

450 
	`as£¹
(
vmFD
 != -1);

452  ::
	`ioùl
(
vmFD
, 
»que¡
, 
p1
);

453 
	}
}

456 
KvmVM
 *

457 
	gKvmVMP¬ams
::
	$ü—‹
()

459 
boŞ
 
ü—‹d
 = 
çl£
;

460 ià(
ü—‹d
)

461 
	`w¬n_Úû
("Use of multiple KvmVMs is currently untested!\n");

463 
ü—‹d
 = 
Œue
;

465  
Ãw
 
	`KvmVM
(
this
);

466 
	}
}

	@kvm/vm.hh

40 #iâdeà
__CPU_KVM_KVMVM_HH__


41 
	#__CPU_KVM_KVMVM_HH__


	)

43 
	~<veùÜ
>

45 
	~"ba£/addr_¿nge.hh
"

46 
	~"sim/sim_objeù.hh
"

49 
	gKvmVMP¬ams
;

50 
şass
 
	gSy¡em
;

72 şas 
	cKvm


74 
ä›nd
 
şass
 
	mKvmVM
;

76 
	mpublic
:

77 
¡d
::
	tveùÜ
<
	tkvm_ıuid_’Œy2
> 
	tCPUIDVeùÜ
;

78 
	m¡d
::
	tveùÜ
<
	tušt32_t
> 
	tMSRIndexVeùÜ
;

80 
	mvœtu®
 ~
Kvm
();

82 
Kvm
 *
ü—‹
();

85 
	$g‘APIV”siÚ
(ècÚ¡ {  
­iV”siÚ
; }

91 
	$g‘VCPUMM­Size
(ècÚ¡ {  
vıuMM­Size
; 
	}
}

95 
boŞ
 
	$ÿpU£rMemÜy
() const;

97 
boŞ
 
	$ÿpS‘TSSAdd»ss
() const;

99 
boŞ
 
	$ÿpEx‹ndedCPUID
() const;

101 
boŞ
 
	$ÿpU£rNMI
() const;

110 
	$ÿpCßËsûdMMIO
() const;

117 
boŞ
 
	$ÿpOÃReg
() const;

124 
boŞ
 
	$ÿpIRQCh
() const;

127 
boŞ
 
	$ÿpVCPUEv’ts
() const;

130 
boŞ
 
	$ÿpDebugRegs
() const;

133 
boŞ
 
	$ÿpXCRs
() const;

136 
boŞ
 
	$ÿpXSave
() const;

146 
boŞ
 
	$g‘SuµÜ‹dCPUID
(
kvm_ıuid2
 &
ıuid
) const;

158 cÚ¡ 
CPUIDVeùÜ
 &
	$g‘SuµÜ‹dCPUID
() const;

165 
boŞ
 
	$g‘SuµÜ‹dMSRs
(
kvm_m¤_li¡
 &
m¤s
) const;

175 cÚ¡ 
MSRIndexVeùÜ
 &
	$g‘SuµÜ‹dMSRs
() const;

177 
´Ùeùed
:

188 
	$checkEx‹nsiÚ
(
ex‹nsiÚ
) const;

203 
	$ioùl
(
»que¡
, 
p1
) const;

204 
	$ioùl
(
»que¡
, *
p1
) const {

205  
	`ioùl
(
»que¡
, ()
p1
);

206 
	}
}

207 
	$ioùl
(
»que¡
) const {

208  
	`ioùl
(
»que¡
, 0L);

209 
	}
}

212 
	g´iv©e
:

214 
Kvm
();

217 
Kvm
(cÚ¡ Kvm &
kvm
);

219 
	gKvm
 &
	gİ”©Ü
=(cÚ¡ 
Kvm
 &
kvm
);

226 
ü—‹VM
();

229 
	gkvmFD
;

231 
	g­iV”siÚ
;

233 
	gvıuMM­Size
;

236 
mubË
 
CPUIDVeùÜ
 
	gsuµÜ‹dCPUIDCache
;

239 
mubË
 
MSRIndexVeùÜ
 
	gsuµÜ‹dMSRCache
;

242 
Kvm
 *
	gš¡ªû
;

271 şas 
	cKvmVM
 : 
public
 
SimObjeù


273 
ä›nd
 
şass
 
Ba£KvmCPU
;

275 
	mpublic
:

276 
KvmVM
(
KvmVMP¬ams
 *
·¿ms
);

277 
	mvœtu®
 ~
KvmVM
();

285 
£tTSSAdd»ss
(
Addr
 
tss_add»ss
);

294 
cßËsûMMIO
(
Addr
 
¡¬t
, 
size
);

301 
cßËsûMMIO
(cÚ¡ 
AddrRªge
 &
¿nge
);

313 
ü—‹IRQCh
();

326 
£tIRQLše
(
ušt32_t
 
œq
, 
boŞ
 
high
);

331 
boŞ
 
	$hasK”ÃlIRQCh
(ècÚ¡ {  
_hasK”ÃlIRQCh
; }

335 
Kvm
 
kvm
;

337 
´Ùeùed
:

346 
	`ıuS¹up
();

359 
	`d–ayedS¹up
();

373 
	`£tU£rMemÜyRegiÚ
(
ušt32_t
 
¦Ù
,

374 *
ho¡_addr
, 
Addr
 
gue¡_addr
,

375 
ušt64_t
 
Ën
, 
ušt32_t
 
æags
);

376 
	`£tU£rMemÜyRegiÚ
(
ušt32_t
 
¦Ù
,

377 *
ho¡_addr
, 
AddrRªge
 
gue¡_¿nge
,

378 
ušt32_t
 
æags
);

387 
	`ü—‹VCPU
(
vıuID
);

397 
	`®locVCPUID
();

412 
	$ioùl
(
»que¡
, 
p1
) const;

413 
	$ioùl
(
»que¡
, *
p1
) const {

414  
	`ioùl
(
»que¡
, ()
p1
);

415 
	}
}

416 
	$ioùl
(
»que¡
) const {

417  
	`ioùl
(
»que¡
, 0L);

418 
	}
}

421 
	g´iv©e
:

423 
KvmVM
(cÚ¡ KvmVM &
vm
);

425 
	gKvmVM
 &
	gİ”©Ü
=(cÚ¡ 
KvmVM
 &
vm
);

427 
Sy¡em
 *
	gsy¡em
;

430 cÚ¡ 
	gvmFD
;

433 
boŞ
 
	g¡¬‹d
;

436 
boŞ
 
	g_hasK”ÃlIRQCh
;

439 
	gÃxtVCPUID
;

	@kvm/x86_cpu.cc

31 
	~<lšux/kvm.h
>

33 
	~<®gÜ™hm
>

34 
	~<û¼no
>

35 
	~<memÜy
>

37 
	~"¬ch/x86/»gs/m¤.hh
"

38 
	~"¬ch/x86/ıuid.hh
"

39 
	~"¬ch/x86/ut™y.hh
"

40 
	~"¬ch/»gi¡”s.hh
"

41 
	~"ıu/kvm/ba£.hh
"

42 
	~"ıu/kvm/x86_ıu.hh
"

43 
	~"debug/D¿š.hh
"

44 
	~"debug/Kvm.hh
"

45 
	~"debug/KvmCÚ‹xt.hh
"

46 
	~"debug/KvmIO.hh
"

47 
	~"debug/KvmIÁ.hh
"

49 
usšg
 
Çme¥aû
 
	gX86ISA
;

51 
	#MSR_TSC
 0x10

	)

53 
	#IO_PCI_CONF_ADDR
 0xCF8

	)

54 
	#IO_PCI_CONF_DATA_BASE
 0xCFC

	)

57 
	#SEG_SYS_TYPE_TSS_AVAILABLE
 9

	)

59 
	#SEG_SYS_TYPE_TSS_BUSY
 11

	)

62 
	#SEG_CS_TYPE_ACCESSED
 9

	)

64 
	#SEG_CS_TYPE_READ_ACCESSED
 11

	)

68 
	#SEG_TYPE_BIT_ACCESSED
 1

	)

70 
	sFXSave


72 
ušt16_t
 
	mfcw
;

73 
ušt16_t
 
	mfsw
;

74 
ušt8_t
 
	máwx
;

75 
ušt8_t
 
	m·d0
;

76 
ušt16_t
 
	mÏ¡_İcode
;

79 
ušt32_t
 
	måu_
;

80 
ušt16_t
 
	måu_cs
;

81 
ušt16_t
 
	m·d1
;

82 
ušt32_t
 
	måu_dp
;

83 
ušt16_t
 
	måu_ds
;

84 
ušt16_t
 
	m·d2
;

85 } 
	mù¾32
;

88 
ušt64_t
 
	måu_
;

89 
ušt64_t
 
	måu_dp
;

90 } 
	mù¾64
;

92 
ušt32_t
 
	mmxc¤
;

93 
ušt32_t
 
	mmxc¤_mask
;

95 
ušt8_t
 
	mår
[8][16];

96 
ušt8_t
 
	mxmm
[16][16];

98 
ušt64_t
 
	m»£rved
[12];

99 } 
	gM5_ATTR_PACKED
;

101 
¡©ic_as£¹
((
FXSave
) == 512, "Unexpected size of FXSave");

103 
	#FOREACH_IREG
() \

105 
	`APPLY_IREG
(
¿x
, 
INTREG_RAX
); \

106 
	`APPLY_IREG
(
rbx
, 
INTREG_RBX
); \

107 
	`APPLY_IREG
(
rcx
, 
INTREG_RCX
); \

108 
	`APPLY_IREG
(
rdx
, 
INTREG_RDX
); \

109 
	`APPLY_IREG
(
rsi
, 
INTREG_RSI
); \

110 
	`APPLY_IREG
(
rdi
, 
INTREG_RDI
); \

111 
	`APPLY_IREG
(
r¥
, 
INTREG_RSP
); \

112 
	`APPLY_IREG
(
rbp
, 
INTREG_RBP
); \

113 
	`APPLY_IREG
(
r8
, 
INTREG_R8
); \

114 
	`APPLY_IREG
(
r9
, 
INTREG_R9
); \

115 
	`APPLY_IREG
(
r10
, 
INTREG_R10
); \

116 
	`APPLY_IREG
(
r11
, 
INTREG_R11
); \

117 
	`APPLY_IREG
(
r12
, 
INTREG_R12
); \

118 
	`APPLY_IREG
(
r13
, 
INTREG_R13
); \

119 
	`APPLY_IREG
(
r14
, 
INTREG_R14
); \

120 
	`APPLY_IREG
(
r15
, 
INTREG_R15
); \

121 } 0)

	)

123 
	#FOREACH_SREG
() \

125 
	`APPLY_SREG
(
ü0
, 
MISCREG_CR0
); \

126 
	`APPLY_SREG
(
ü2
, 
MISCREG_CR2
); \

127 
	`APPLY_SREG
(
ü3
, 
MISCREG_CR3
); \

128 
	`APPLY_SREG
(
ü4
, 
MISCREG_CR4
); \

129 
	`APPLY_SREG
(
ü8
, 
MISCREG_CR8
); \

130 
	`APPLY_SREG
(
eãr
, 
MISCREG_EFER
); \

131 
	`APPLY_SREG
(
­ic_ba£
, 
MISCREG_APIC_BASE
); \

132 } 0)

	)

134 
	#FOREACH_DREG
() \

136 
	`APPLY_DREG
(
db
[0], 
MISCREG_DR0
); \

137 
	`APPLY_DREG
(
db
[1], 
MISCREG_DR1
); \

138 
	`APPLY_DREG
(
db
[2], 
MISCREG_DR2
); \

139 
	`APPLY_DREG
(
db
[3], 
MISCREG_DR3
); \

140 
	`APPLY_DREG
(
dr6
, 
MISCREG_DR6
); \

141 
	`APPLY_DREG
(
dr7
, 
MISCREG_DR7
); \

142 } 0)

	)

144 
	#FOREACH_SEGMENT
() \

146 
	`APPLY_SEGMENT
(
cs
, 
MISCREG_CS
 - 
MISCREG_SEG_SEL_BASE
); \

147 
	`APPLY_SEGMENT
(
ds
, 
MISCREG_DS
 - 
MISCREG_SEG_SEL_BASE
); \

148 
	`APPLY_SEGMENT
(
es
, 
MISCREG_ES
 - 
MISCREG_SEG_SEL_BASE
); \

149 
	`APPLY_SEGMENT
(
fs
, 
MISCREG_FS
 - 
MISCREG_SEG_SEL_BASE
); \

150 
	`APPLY_SEGMENT
(
gs
, 
MISCREG_GS
 - 
MISCREG_SEG_SEL_BASE
); \

151 
	`APPLY_SEGMENT
(
ss
, 
MISCREG_SS
 - 
MISCREG_SEG_SEL_BASE
); \

152 
	`APPLY_SEGMENT
(
Œ
, 
MISCREG_TR
 - 
MISCREG_SEG_SEL_BASE
); \

153 
	`APPLY_SEGMENT
(
ldt
, 
MISCREG_TSL
 - 
MISCREG_SEG_SEL_BASE
); \

154 } 0)

	)

156 
	#FOREACH_DTABLE
() \

158 
	`APPLY_DTABLE
(
gdt
, 
MISCREG_TSG
 - 
MISCREG_SEG_SEL_BASE
); \

159 
	`APPLY_DTABLE
(
idt
, 
MISCREG_IDTR
 - 
MISCREG_SEG_SEL_BASE
); \

160 } 0)

	)

162 
	g‹m¶©e
<
ty³Çme
 
	gSTRUCT
,y³Çm
	gENTRY
>

163 
STRUCT
 *
	$ÃwV¬SŒuù
(
size_t
 
’Œ›s
)

165  (
STRUCT
 *)
İ”©Ü
 
	`Ãw
((STRUCTè+ 
’Œ›s
 * (
ENTRY
));

166 
	}
}

169 
	$dumpKvm
(cÚ¡ 
kvm_»gs
 &
»gs
)

171 
	`šfÜm
("KVM„egister state:\n");

173 
	#APPLY_IREG
(
k»g
, 
m»g
) \

174 
	`šfÜm
("\t" #k»g ": 0x%Îx\n", 
»gs
.
k»g
)

	)

176 
	`FOREACH_IREG
();

178 #undeà
APPLY_IREG


180 
	`šfÜm
("\Œ: 0x%Îx\n", 
»gs
.
r
);

181 
	`šfÜm
("\Œæags: 0x%Îx\n", 
»gs
.
ræags
);

182 
	}
}

185 
	$dumpKvm
(cÚ¡ *
»g_Çme
, cÚ¡ 
kvm_£gm’t
 &
£g
)

187 
	`šfÜm
("\t%s: @0x%llx+%x [sel: 0x%x,ype: 0x%x]\n"

189 
»g_Çme
,

190 
£g
.
ba£
, seg.
lim™
, seg.
£ËùÜ
, seg.
ty³
,

191 
£g
.
´e£Á
, seg.
d¶
, seg.
db
, seg.
s
, seg.
l
, seg.
g
, seg.
avl
, seg.
unu§bË
);

192 
	}
}

195 
	$dumpKvm
(cÚ¡ *
»g_Çme
, cÚ¡ 
kvm_dbË
 &
dbË
)

197 
	`šfÜm
("\t%s: @0x%llx+%x\n",

198 
»g_Çme
, 
dbË
.
ba£
, dbË.
lim™
);

199 
	}
}

202 
	$dumpKvm
(cÚ¡ 
kvm_¤egs
 &
¤egs
)

204 
	#APPLY_SREG
(
k»g
, 
m»g
) \

205 
	`šfÜm
("\t" #k»g ": 0x%Îx\n", 
¤egs
.
k»g
);

	)

206 
	#APPLY_SEGMENT
(
k»g
, 
idx
) \

207 
	`dumpKvm
(#k»g, 
¤egs
.
k»g
);

	)

208 
	#APPLY_DTABLE
(
k»g
, 
idx
) \

209 
	`dumpKvm
(#k»g, 
¤egs
.
k»g
);

	)

211 
	`šfÜm
("Special„egisters:\n");

212 
	`FOREACH_SEGMENT
();

213 
	`FOREACH_SREG
();

214 
	`FOREACH_DTABLE
();

216 
	`šfÜm
("Interrupt Bitmap:");

217 
i
 = 0; i < 
KVM_NR_INTERRUPTS
; i += 64)

218 
	`šfÜm
(" 0x%.8x", 
¤egs
.
š‹¼u±_b™m­
[
i
 / 64]);

220 #undeà
APPLY_SREG


221 #undeà
APPLY_SEGMENT


222 #undeà
APPLY_DTABLE


223 
	}
}

225 #ifdeà
KVM_GET_DEBUGREGS


227 
	$dumpKvm
(cÚ¡ 
kvm_debug»gs
 &
»gs
)

229 
	`šfÜm
("KVM debug state:\n");

231 
	#APPLY_DREG
(
k»g
, 
m»g
) \

232 
	`šfÜm
("\t" #k»g ": 0x%Îx\n", 
»gs
.
k»g
)

	)

234 
	`FOREACH_DREG
();

236 #undeà
APPLY_DREG


238 
	`šfÜm
("\tæags: 0x%Îx\n", 
»gs
.
æags
);

239 
	}
}

243 
	$dumpFpuS³c
(cÚ¡ 
FXSave
 &
xs
)

245 
	`šfÜm
("\a¡_: 0x%x\n", 
xs
.
ù¾64
.
åu_
);

246 
	`šfÜm
("\a¡_dp: 0x%x\n", 
xs
.
ù¾64
.
åu_dp
);

247 
	`šfÜm
("\tmxc¤_mask: 0x%x\n", 
xs
.
mxc¤_mask
);

248 
	}
}

251 
	$dumpFpuS³c
(cÚ¡ 
kvm_åu
 &
åu
)

253 
	`šfÜm
("\a¡_: 0x%x\n", 
åu
.
Ï¡_
);

254 
	`šfÜm
("\a¡_dp: 0x%x\n", 
åu
.
Ï¡_dp
);

255 
	}
}

257 
	g‹m¶©e
<
ty³Çme
 
	gT
>

259 
	$dumpFpuCommÚ
(cÚ¡ 
T
 &
åu
)

261 cÚ¡ 
	`tİ
((
åu
.
fsw
 >> 11) & 0x7);

262 
	`šfÜm
("\tfcw: 0x%x\n", 
åu
.
fcw
);

264 
	`šfÜm
("\tfsw: 0x%x (top: %i, "

266 
åu
.
fsw
, 
tİ
,

268 (
åu
.
fsw
 & 
CC0B™
) ? "C0" : "",

269 (
åu
.
fsw
 & 
CC1B™
) ? "C1" : "",

270 (
åu
.
fsw
 & 
CC2B™
) ? "C2" : "",

271 (
åu
.
fsw
 & 
CC3B™
) ? "C3" : "",

273 (
åu
.
fsw
 & 
IEB™
) ? "I" : "",

274 (
åu
.
fsw
 & 
DEB™
) ? "D" : "",

275 (
åu
.
fsw
 & 
ZEB™
) ? "Z" : "",

276 (
åu
.
fsw
 & 
OEB™
) ? "O" : "",

277 (
åu
.
fsw
 & 
UEB™
) ? "U" : "",

278 (
åu
.
fsw
 & 
PEB™
) ? "P" : "",

280 (
åu
.
fsw
 & 
SckFauÉB™
) ? "SF " : "",

281 (
åu
.
fsw
 & 
E¼Summ¬yB™
) ? "ES " : "",

282 (
åu
.
fsw
 & 
BusyB™
) ? "BUSY " : ""

284 
	`šfÜm
("\táwx: 0x%x\n", 
åu
.
áwx
);

285 
	`šfÜm
("\a¡_İcode: 0x%x\n", 
åu
.
Ï¡_İcode
);

286 
	`dumpFpuS³c
(
åu
);

287 
	`šfÜm
("\tmxc¤: 0x%x\n", 
åu
.
mxc¤
);

288 
	`šfÜm
("\tFP Stack:\n");

289 
i
 = 0; i < 8; ++i) {

290 cÚ¡ 
	`»g_idx
((
i
 + 
tİ
) & 0x7);

291 cÚ¡ 
boŞ
 
	`em±y
(!((
åu
.
áwx
 >> 
»g_idx
) & 0x1));

292 cÚ¡ 
	`v®ue
(
X86ISA
::
	`lßdFlßt80
(
åu
.
år
[
i
]));

293 
hex
[33];

294 
j
 = 0; j < 10; ++j)

295 
	`¢´štf
(&
hex
[
j
*2], 3, "%.2x", 
åu
.
år
[
i
][j]);

296 
	`šfÜm
("\t\tST%i/%i: 0x% (%f)%s\n", 
i
, 
»g_idx
,

297 
hex
, 
v®ue
, 
em±y
 ? " (e)" : "");

299 
	`šfÜm
("\tXMM„egisters:\n");

300 
i
 = 0; i < 16; ++i) {

301 
hex
[33];

302 
j
 = 0; j < 16; ++j)

303 
	`¢´štf
(&
hex
[
j
*2], 3, "%.2x", 
åu
.
xmm
[
i
][j]);

304 
	`šfÜm
("\t\t%i: 0x%s\n", 
i
, 
hex
);

306 
	}
}

309 
	$dumpKvm
(cÚ¡ 
kvm_åu
 &
åu
)

311 
	`šfÜm
("FPU„egisters:\n");

312 
	`dumpFpuCommÚ
(
åu
);

313 
	}
}

316 
	$dumpKvm
(cÚ¡ 
kvm_x§ve
 &
x§ve
)

318 
	`šfÜm
("FPU„egisters (XSave):\n");

319 
	`dumpFpuCommÚ
(*(
FXSave
 *)
x§ve
.
»giÚ
);

320 
	}
}

323 
	$dumpKvm
(cÚ¡ 
kvm_m¤s
 &
m¤s
)

325 
	`šfÜm
("MSRs:\n");

327 
i
 = 0; i < 
m¤s
.
nm¤s
; ++i) {

328 cÚ¡ 
kvm_m¤_’Œy
 &
	`e
(
m¤s
.
’Œ›s
[
i
]);

330 
	`šfÜm
("\t0x%x: 0x%x\n", 
e
.
šdex
,ƒ.
d©a
);

332 
	}
}

335 
	$dumpKvm
(cÚ¡ 
kvm_xüs
 &
»gs
)

337 
	`šfÜm
("KVM XCR„egisters:\n");

339 
	`šfÜm
("\tFÏgs: 0x%x\n", 
»gs
.
æags
);

340 
i
 = 0; i < 
»gs
.
Ä_xüs
; ++i) {

341 
	`šfÜm
("\tXCR[0x%x]: 0x%x\n",

342 
»gs
.
xüs
[
i
].
xü
,

343 
»gs
.
xüs
[
i
].
v®ue
);

345 
	}
}

348 
	$dumpKvm
(cÚ¡ 
kvm_vıu_ev’ts
 &
ev’ts
)

350 
	`šfÜm
("vCPUƒvents:\n");

352 
	`šfÜm
("\tException: [inj: %i,‚r: %i, has_ec: %i,ƒc: %i]\n",

353 
ev’ts
.
exû±iÚ
.
šjeùed
,ƒv’ts.exû±iÚ.
Ä
,

354 
ev’ts
.
exû±iÚ
.
has_”rÜ_code
,ƒv’ts.exû±iÚ.
”rÜ_code
);

356 
	`šfÜm
("\tInterrupt: [inj: %i,‚r: %i, soft: %i]\n",

357 
ev’ts
.
š‹¼u±
.
šjeùed
,ƒv’ts.š‹¼u±.
Ä
,

358 
ev’ts
.
š‹¼u±
.
soá
);

360 
	`šfÜm
("\tNMI: [inj: %i,…ending: %i, masked: %i]\n",

361 
ev’ts
.
nmi
.
šjeùed
,ƒv’ts.nmi.
³ndšg
,

362 
ev’ts
.
nmi
.
masked
);

364 
	`šfÜm
("\tSIPI veùÜ: 0x%x\n", 
ev’ts
.
si_veùÜ
);

365 
	`šfÜm
("\tFÏgs: 0x%x\n", 
ev’ts
.
æags
);

366 
	}
}

368 
boŞ


369 
	$isCªÚiÿlAdd»ss
(
ušt64_t
 
addr
)

375 
ušt64_t
 
	`uµ”_h®f
(
addr
 & 0xffff800000000000ULL);

376  
uµ”_h®f
 == 0 || upper_half == 0xffff800000000000;

377 
	}
}

380 
	$checkSeg
(cÚ¡ *
Çme
, cÚ¡ 
idx
, cÚ¡ 
kvm_£gm’t
 &
£g
,

381 
kvm_¤egs
 
¤egs
)

384 
idx
) {

385 
MISCREG_TSL
:

386 
MISCREG_TR
:

387 
MISCREG_FS
:

388 
MISCREG_GS
:

389 ià(!
	`isCªÚiÿlAdd»ss
(
£g
.
ba£
))

390 
	`w¬n
("IÎeg® % ba£: 0x%x\n", 
Çme
, 
£g
.
ba£
);

393 
MISCREG_SS
:

394 
MISCREG_DS
:

395 
MISCREG_ES
:

396 ià(
£g
.
unu§bË
)

398 
MISCREG_CS
:

399 ià(
£g
.
ba£
 & 0xffffffff00000000ULL)

400 
	`w¬n
("IÎeg® % ba£: 0x%x\n", 
Çme
, 
£g
.
ba£
);

405 
idx
) {

406 
MISCREG_CS
:

407 
£g
.
ty³
) {

409 ià(
£g
.
d¶
 != 0)

410 
	`w¬n
("CSype is 3 but dpl != 0.\n");

414 ià(
£g
.
d¶
 !ğ
¤egs
.
ss
.dpl)

415 
	`w¬n
("CSy³ i %˜buˆCS DPL !ğSS DPL\n", 
£g
.
ty³
);

419 ià(
£g
.
d¶
 > 
¤egs
.
ss
.dpl)

420 
	`w¬n
("CSy³ i %˜buˆCS DPL > SS DPL\n", 
£g
.
ty³
);

423 
	`w¬n
("IÎeg® CSy³: %i\n", 
£g
.
ty³
);

428 
MISCREG_SS
:

429 ià(
£g
.
unu§bË
)

431 
£g
.
ty³
) {

433 ià(
¤egs
.
cs
.
ty³
 =ğ3 && 
£g
.
d¶
 != 0)

434 
	`w¬n
("CSype is 3, but SS DPL is != 0.\n");

437 ià(!(
¤egs
.
ü0
 & 1è&& 
£g
.
d¶
 != 0)

438 
	`w¬n
("SS DPL i %i, buˆCR0 PE i 0\n", 
£g
.
d¶
);

441 
	`w¬n
("IÎeg® SSy³: %i\n", 
£g
.
ty³
);

446 
MISCREG_DS
:

447 
MISCREG_ES
:

448 
MISCREG_FS
:

449 
MISCREG_GS
:

450 ià(
£g
.
unu§bË
)

452 ià(!(
£g
.
ty³
 & 0x1) ||

453 ((
£g
.
ty³
 & 0x8) && !(seg.type & 0x2)))

454 
	`w¬n
("% ha ª iÎeg®y³ f›ld: %i\n", 
Çme
, 
£g
.
ty³
);

457 
MISCREG_TR
:

459 ià(
£g
.
ty³
 != 3 && seg.type != 11)

460 
	`w¬n
("%s: IÎeg® segm’ˆty³ (%i)\n", 
Çme
, 
£g
.
ty³
);

463 
MISCREG_TSL
:

464 ià(
£g
.
unu§bË
)

466 ià(
£g
.
ty³
 != 2)

467 
	`w¬n
("%s: IÎeg® segm’ˆty³ (%i)\n", 
Çme
, 
£g
.
ty³
);

471 
idx
) {

472 
MISCREG_SS
:

473 
MISCREG_DS
:

474 
MISCREG_ES
:

475 
MISCREG_FS
:

476 
MISCREG_GS
:

477 ià(
£g
.
unu§bË
)

479 
MISCREG_CS
:

480 ià(!
£g
.
s
)

481 
	`w¬n
("%s: S fÏg‚Ù s‘\n", 
Çme
);

484 
MISCREG_TSL
:

485 ià(
£g
.
unu§bË
)

487 
MISCREG_TR
:

488 ià(
£g
.
s
)

489 
	`w¬n
("%s: S fÏg i £t\n", 
Çme
);

493 
idx
) {

494 
MISCREG_SS
:

495 
MISCREG_DS
:

496 
MISCREG_ES
:

497 
MISCREG_FS
:

498 
MISCREG_GS
:

499 
MISCREG_TSL
:

500 ià(
£g
.
unu§bË
)

502 
MISCREG_TR
:

503 
MISCREG_CS
:

504 ià(!
£g
.
´e£Á
)

505 
	`w¬n
("%s: P fÏg‚Ù s‘\n", 
Çme
);

507 ià(((
£g
.
lim™
 & 0xFFFè=ğ0 && seg.
g
) ||

508 ((
£g
.
lim™
 & 0xFFF00000è!ğ0 && !£g.
g
)) {

509 
	`w¬n
("%s†imit (0x%x)‡nd g (%i) combination is illegal.\n",

510 
Çme
, 
£g
.
lim™
, seg.
g
);

516 
	}
}

518 
	gX86KvmCPU
::
	$X86KvmCPU
(
X86KvmCPUP¬ams
 *
·¿ms
)

519 : 
	`Ba£KvmCPU
(
·¿ms
),

520 
	`u£XSave
(
·¿ms
->
u£XSave
)

522 
Kvm
 &
	`kvm
(
vm
.
kvm
);

524 ià(!
kvm
.
	`ÿpS‘TSSAdd»ss
())

525 
	`·nic
("KVM: Missing capability (KVM_CAP_SET_TSS_ADDR)\n");

526 ià(!
kvm
.
	`ÿpEx‹ndedCPUID
())

527 
	`·nic
("KVM: Missing capability (KVM_CAP_EXT_CPUID)\n");

528 ià(!
kvm
.
	`ÿpU£rNMI
())

529 
	`w¬n
("KVM: Missing capability (KVM_CAP_USER_NMI)\n");

530 ià(!
kvm
.
	`ÿpVCPUEv’ts
())

531 
	`w¬n
("KVM: Missing capability (KVM_CAP_VCPU_EVENTS)\n");

533 
haveDebugRegs
 = 
kvm
.
	`ÿpDebugRegs
();

534 
haveXSave
 = 
kvm
.
	`ÿpXSave
();

535 
haveXCRs
 = 
kvm
.
	`ÿpXCRs
();

537 ià(
u£XSave
 && !
haveXSave
) {

538 
	`w¬n
("KVM: XSAVE‚ot supported by host. MXCSR synchronization might be "

540 
u£XSave
 = 
çl£
;

541 } ià(!
u£XSave
) {

542 
	`w¬n
("KVM: XSave FPU/SIMD synchronization disabled by user.\n");

544 
	}
}

546 
	gX86KvmCPU
::~
	$X86KvmCPU
()

548 
	}
}

551 
X86KvmCPU
::
	$¡¬tup
()

553 
Ba£KvmCPU
::
	`¡¬tup
();

555 
	`upd©eCPUID
();

557 
io_»q
.
	`£tTh»adCÚ‹xt
(
tc
->
	`cÚ‹xtId
(), 0);

564 
	}
}

567 
	gX86KvmCPU
::
	$dump
()

569 
	`dumpIÁRegs
();

570 ià(
u£XSave
)

571 
	`dumpXSave
();

573 
	`dumpFpuRegs
();

574 
	`dumpS³cRegs
();

575 
	`dumpDebugRegs
();

576 
	`dumpXCRs
();

577 
	`dumpVCpuEv’ts
();

578 
	`dumpMSRs
();

579 
	}
}

582 
	gX86KvmCPU
::
	$dumpFpuRegs
() const

584 
kvm_åu
 
åu
;

585 
	`g‘FPUS‹
(
åu
);

586 
	`dumpKvm
(
åu
);

587 
	}
}

590 
	gX86KvmCPU
::
	$dumpIÁRegs
() const

592 
kvm_»gs
 
»gs
;

593 
	`g‘Regi¡”s
(
»gs
);

594 
	`dumpKvm
(
»gs
);

595 
	}
}

598 
	gX86KvmCPU
::
	$dumpS³cRegs
() const

600 
kvm_¤egs
 
¤egs
;

601 
	`g‘S³cŸlRegi¡”s
(
¤egs
);

602 
	`dumpKvm
(
¤egs
);

603 
	}
}

606 
	gX86KvmCPU
::
	$dumpDebugRegs
() const

608 ià(
haveDebugRegs
) {

609 #ifdeà
KVM_GET_DEBUGREGS


610 
kvm_debug»gs
 
d»gs
;

611 
	`g‘DebugRegi¡”s
(
d»gs
);

612 
	`dumpKvm
(
d»gs
);

615 
	`šfÜm
("Debug„egisters‚ot supported by kernel.\n");

617 
	}
}

620 
	gX86KvmCPU
::
	$dumpXCRs
() const

622 ià(
haveXCRs
) {

623 
kvm_xüs
 
xüs
;

624 
	`g‘XCRs
(
xüs
);

625 
	`dumpKvm
(
xüs
);

627 
	`šfÜm
("XCRs‚ot supported by kernel.\n");

629 
	}
}

632 
	gX86KvmCPU
::
	$dumpXSave
() const

634 ià(
haveXSave
) {

635 
kvm_x§ve
 
x§ve
;

636 
	`g‘XSave
(
x§ve
);

637 
	`dumpKvm
(
x§ve
);

639 
	`šfÜm
("XSave‚ot supported by kernel.\n");

641 
	}
}

644 
	gX86KvmCPU
::
	$dumpVCpuEv’ts
() const

646 
kvm_vıu_ev’ts
 
ev’ts
;

647 
	`g‘VCpuEv’ts
(
ev’ts
);

648 
	`dumpKvm
(
ev’ts
);

649 
	}
}

652 
	gX86KvmCPU
::
	$dumpMSRs
() const

654 cÚ¡ 
Kvm
::
MSRIndexVeùÜ
 &
	`suµÜ‹d_m¤s
(
vm
.
kvm
.
	`g‘SuµÜ‹dMSRs
());

655 
¡d
::
unique_±r
<
kvm_m¤s
> 
	`m¤s
(

656 
ÃwV¬SŒuù
<
kvm_m¤s
, 
kvm_m¤_’Œy
>(

657 
suµÜ‹d_m¤s
.
	`size
()));

659 
m¤s
->
nm¤s
 = 
suµÜ‹d_m¤s
.
	`size
();

660 
i
 = 0; i < 
suµÜ‹d_m¤s
.
	`size
(); ++i) {

661 
kvm_m¤_’Œy
 &
	`e
(
m¤s
->
’Œ›s
[
i
]);

662 
e
.
šdex
 = 
suµÜ‹d_m¤s
[
i
];

663 
e
.
»£rved
 = 0;

664 
e
.
d©a
 = 0;

666 
	`g‘MSRs
(*
m¤s
.
	`g‘
());

668 
	`dumpKvm
(*
m¤s
.
	`g‘
());

669 
	}
}

672 
	gX86KvmCPU
::
	$upd©eKvmS‹
()

674 
	`upd©eKvmS‹Regs
();

675 
	`upd©eKvmS‹SRegs
();

676 
	`upd©eKvmS‹FPU
();

677 
	`upd©eKvmS‹MSRs
();

679 
	`DPRINTF
(
KvmCÚ‹xt
, "X86KvmCPU::updateKvmState():\n");

680 ià(
	`DTRACE
(
KvmCÚ‹xt
))

681 
	`dump
();

682 
	}
}

685 
	gX86KvmCPU
::
	$upd©eKvmS‹Regs
()

687 
kvm_»gs
 
»gs
;

689 
	#APPLY_IREG
(
k»g
, 
m»g
è
»gs
.k»g = 
tc
->
	`»adIÁReg
(m»g)

	)

690 
	`FOREACH_IREG
();

691 #undeà
APPLY_IREG


693 
»gs
.
r
 = 
tc
->
	`š¡Addr
();

701 
»gs
.
ræags
 = 
X86ISA
::
	`g‘RFÏgs
(
tc
);

703 
	`£tRegi¡”s
(
»gs
);

704 
	}
}

706 
šlše
 

707 
	$£tKvmSegm’tReg
(
Th»adCÚ‹xt
 *
tc
, 
kvm_£gm’t
 &
kvm_£g
,

708 cÚ¡ 
šdex
)

710 
SegA‰r
 
	`©Œ
(
tc
->
	`»adMiscRegNoEfãù
(
	`MISCREG_SEG_ATTR
(
šdex
)));

712 
kvm_£g
.
ba£
 = 
tc
->
	`»adMiscRegNoEfãù
(
	`MISCREG_SEG_BASE
(
šdex
));

713 
kvm_£g
.
lim™
 = 
tc
->
	`»adMiscRegNoEfãù
(
	`MISCREG_SEG_LIMIT
(
šdex
));

714 
kvm_£g
.
£ËùÜ
 = 
tc
->
	`»adMiscRegNoEfãù
(
	`MISCREG_SEG_SEL
(
šdex
));

715 
kvm_£g
.
ty³
 = 
©Œ
.type;

716 
kvm_£g
.
´e£Á
 = 
©Œ
.present;

717 
kvm_£g
.
d¶
 = 
©Œ
.dpl;

718 
kvm_£g
.
db
 = 
©Œ
.
deçuÉSize
;

719 
kvm_£g
.
s
 = 
©Œ
.
sy¡em
;

720 
kvm_£g
.
l
 = 
©Œ
.
lÚgMode
;

721 
kvm_£g
.
g
 = 
©Œ
.
g¿nuÏr™y
;

722 
kvm_£g
.
avl
 = 
©Œ
.avl;

728 
kvm_£g
.
unu§bË
 = (kvm_£g.
£ËùÜ
 == 0);

729 
	}
}

731 
šlše
 

732 
	$£tKvmDTabËReg
(
Th»adCÚ‹xt
 *
tc
, 
kvm_dbË
 &kvm_dtable,

733 cÚ¡ 
šdex
)

735 
kvm_dbË
.
ba£
 = 
tc
->
	`»adMiscRegNoEfãù
(
	`MISCREG_SEG_BASE
(
šdex
));

736 
kvm_dbË
.
lim™
 = 
tc
->
	`»adMiscRegNoEfãù
(
	`MISCREG_SEG_LIMIT
(
šdex
));

737 
	}
}

740 
	$fÜûSegAcûs£d
(
kvm_£gm’t
 &
£g
)

747 ià(!
£g
.
unu§bË
)

748 
£g
.
ty³
 |ğ
SEG_TYPE_BIT_ACCESSED
;

749 
	}
}

752 
	gX86KvmCPU
::
	$upd©eKvmS‹SRegs
()

754 
kvm_¤egs
 
¤egs
;

756 
	#APPLY_SREG
(
k»g
, 
m»g
è
¤egs
.k»g = 
tc
->
	`»adMiscRegNoEfãù
(m»g)

	)

757 
	#APPLY_SEGMENT
(
k»g
, 
idx
è
	`£tKvmSegm’tReg
(
tc
, 
¤egs
.k»g, idx)

	)

758 
	#APPLY_DTABLE
(
k»g
, 
idx
è
	`£tKvmDTabËReg
(
tc
, 
¤egs
.k»g, idx)

	)

760 
	`FOREACH_SREG
();

761 
	`FOREACH_SEGMENT
();

762 
	`FOREACH_DTABLE
();

764 #undeà
APPLY_SREG


765 #undeà
APPLY_SEGMENT


766 #undeà
APPLY_DTABLE


769 
	`mem£t
(&
¤egs
.
š‹¼u±_b™m­
, 0, (sregs.interrupt_bitmap));

773 
	`fÜûSegAcûs£d
(
¤egs
.
cs
);

774 
	`fÜûSegAcûs£d
(
¤egs
.
ss
);

775 
	`fÜûSegAcûs£d
(
¤egs
.
ds
);

776 
	`fÜûSegAcûs£d
(
¤egs
.
es
);

777 
	`fÜûSegAcûs£d
(
¤egs
.
fs
);

778 
	`fÜûSegAcûs£d
(
¤egs
.
gs
);

782 ià(
¤egs
.
Œ
.
ty³
 =ğ
SEG_SYS_TYPE_TSS_AVAILABLE
) {

783 
	`hack
("tr.type (%i) is‚ot busy. Forcinghe busy bit.\n",

784 
¤egs
.
Œ
.
ty³
);

785 
¤egs
.
Œ
.
ty³
 = 
SEG_SYS_TYPE_TSS_BUSY
;

792 ià((
¤egs
.
cs
.
ty³
 =ğ
SEG_CS_TYPE_ACCESSED
 ||

793 
¤egs
.
cs
.
ty³
 =ğ
SEG_CS_TYPE_READ_ACCESSED
) &&

794 
¤egs
.
cs
.
d¶
 !ğ¤egs.
ss
.dpl) {

796 
	`hack
("CS.DPL (%i) != SS.DPL (%i): Forcing SS.DPLo %i\n",

797 
¤egs
.
cs
.
d¶
, s»gs.
ss
.dpl, sregs.cs.dpl);

798 
¤egs
.
ss
.
d¶
 = s»gs.
cs
.dpl;

803 
RFLAGS
 
	`ræags_nocc
(
tc
->
	`»adMiscReg
(
MISCREG_RFLAGS
));

804 ià(!
ræags_nocc
.
vm
) {

809 
	#APPLY_SEGMENT
(
k»g
, 
idx
) \

810 
	`checkSeg
(#k»g, 
idx
 + 
MISCREG_SEG_SEL_BASE
, 
¤egs
.
k»g
, s»gs)

	)

812 
	`FOREACH_SEGMENT
();

813 #undeà
APPLY_SEGMENT


816 
	`£tS³cŸlRegi¡”s
(
¤egs
);

817 
	}
}

819 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

821 
	$upd©eKvmS‹FPUCommÚ
(
Th»adCÚ‹xt
 *
tc
, 
T
 &
åu
)

823 
	`¡©ic_as£¹
((
X86ISA
::
FlßtRegB™s
) == 8,

826 
åu
.
mxc¤
 = 
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_MXCSR
);

827 
åu
.
fcw
 = 
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FCW
);

830 
åu
.
fsw
 = 
tc
->
	`»adMiscReg
(
MISCREG_FSW
);

832 
ušt64_t
 
	`áw
(
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FTW
));

833 
åu
.
áwx
 = 
X86ISA
::
	`cÚvX87TagsToXTags
(
áw
);

835 
åu
.
Ï¡_İcode
 = 
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FOP
);

837 cÚ¡ 
	`tİ
((
åu
.
fsw
 >> 11) & 0x7);

838 
i
 = 0; i < 8; ++i) {

839 cÚ¡ 
	`»g_idx
((
i
 + 
tİ
) & 0x7);

840 cÚ¡ 
	`v®ue
(
tc
->
	`»adFlßtReg
(
	`FLOATREG_FPR
(
»g_idx
)));

841 
	`DPRINTF
(
KvmCÚ‹xt
, "Setting KVM FP„eg %i (st[%i]) := %f\n",

842 
»g_idx
, 
i
, 
v®ue
);

843 
X86ISA
::
	`¡ÜeFlßt80
(
åu
.
år
[
i
], 
v®ue
);

848 
i
 = 0; i < 16; ++i) {

849 *(
X86ISA
::
FlßtRegB™s
 *)&
åu
.
xmm
[
i
][0] =

850 
tc
->
	`»adFlßtRegB™s
(
	`FLOATREG_XMM_LOW
(
i
));

851 *(
X86ISA
::
FlßtRegB™s
 *)&
åu
.
xmm
[
i
][8] =

852 
tc
->
	`»adFlßtRegB™s
(
	`FLOATREG_XMM_HIGH
(
i
));

854 
	}
}

857 
	gX86KvmCPU
::
	$upd©eKvmS‹FPULegacy
()

859 
kvm_åu
 
åu
;

863 
	`mem£t
(&
åu
, 0, (fpu));

865 
	`upd©eKvmS‹FPUCommÚ
(
tc
, 
åu
);

867 ià(
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FISEG
))

868 
	`w¬n_Úû
("MISCREG_FISEG is‚on-zero.\n");

870 
åu
.
Ï¡_
 = 
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FIOFF
);

872 ià(
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FOSEG
))

873 
	`w¬n_Úû
("MISCREG_FOSEG is‚on-zero.\n");

875 
åu
.
Ï¡_dp
 = 
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FOOFF
);

877 
	`£tFPUS‹
(
åu
);

878 
	}
}

881 
	gX86KvmCPU
::
	$upd©eKvmS‹FPUXSave
()

883 
kvm_x§ve
 
kx§ve
;

884 
FXSave
 &
	`x§ve
(*(FXSav*)
kx§ve
.
»giÚ
);

888 
	`mem£t
(&
kx§ve
, 0, (kxsave));

890 
	`upd©eKvmS‹FPUCommÚ
(
tc
, 
x§ve
);

892 ià(
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FISEG
))

893 
	`w¬n_Úû
("MISCREG_FISEG is‚on-zero.\n");

895 
x§ve
.
ù¾64
.
åu_
 = 
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FIOFF
);

897 ià(
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FOSEG
))

898 
	`w¬n_Úû
("MISCREG_FOSEG is‚on-zero.\n");

900 
x§ve
.
ù¾64
.
åu_dp
 = 
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_FOOFF
);

902 
	`£tXSave
(
kx§ve
);

903 
	}
}

906 
	gX86KvmCPU
::
	$upd©eKvmS‹FPU
()

908 ià(
u£XSave
)

909 
	`upd©eKvmS‹FPUXSave
();

911 
	`upd©eKvmS‹FPULegacy
();

912 
	}
}

915 
	gX86KvmCPU
::
	$upd©eKvmS‹MSRs
()

917 
KvmMSRVeùÜ
 
m¤s
;

919 cÚ¡ 
Kvm
::
MSRIndexVeùÜ
 &
	`šdiûs
(
	`g‘M¤IÁ”£ùiÚ
());

921 autØ
™
 = 
šdiûs
.
	`cbegš
(); iˆ!ğšdiûs.
	`ûnd
(); ++it) {

922 
kvm_m¤_’Œy
 
e
;

924 
e
.
šdex
 = *
™
;

925 
e
.
»£rved
 = 0;

926 
e
.
d©a
 = 
tc
->
	`»adMiscReg
(
m¤M­
.
	`©
(*
™
));

927 
	`DPRINTF
(
KvmCÚ‹xt
, "Adding MSR: idx: 0x%x, data: 0x%x\n",

928 
e
.
šdex
,ƒ.
d©a
);

930 
m¤s
.
	`push_back
(
e
);

933 
	`£tMSRs
(
m¤s
);

934 
	}
}

937 
	gX86KvmCPU
::
	$upd©eTh»adCÚ‹xt
()

939 
	`DPRINTF
(
KvmCÚ‹xt
, "X86KvmCPU::updateThreadContext():\n");

940 ià(
	`DTRACE
(
KvmCÚ‹xt
))

941 
	`dump
();

943 
	`upd©eTh»adCÚ‹xtRegs
();

944 
	`upd©eTh»adCÚ‹xtSRegs
();

945 ià(
u£XSave
)

946 
	`upd©eTh»adCÚ‹xtXSave
();

948 
	`upd©eTh»adCÚ‹xtFPU
();

949 
	`upd©eTh»adCÚ‹xtMSRs
();

954 
tc
->
	`£tMiscReg
(
MISCREG_M5_REG
, 0);

955 
	}
}

958 
	gX86KvmCPU
::
	$upd©eTh»adCÚ‹xtRegs
()

960 
kvm_»gs
 
»gs
;

961 
	`g‘Regi¡”s
(
»gs
);

963 
	#APPLY_IREG
(
k»g
, 
m»g
è
tc
->
	`£tIÁReg
(m»g, 
»gs
.k»g)

	)

965 
	`FOREACH_IREG
();

967 #undeà
APPLY_IREG


969 
tc
->
	`pcS‹
(
	`PCS‹
(
»gs
.
r
));

973 
X86ISA
::
	`£tRFÏgs
(
tc
, 
»gs
.
ræags
);

974 
	}
}

977 
šlše
 

978 
	$£tCÚ‹xtSegm’t
(
Th»adCÚ‹xt
 *
tc
, cÚ¡ 
kvm_£gm’t
 &
kvm_£g
,

979 cÚ¡ 
šdex
)

981 
SegA‰r
 
	`©Œ
(0);

983 
©Œ
.
ty³
 = 
kvm_£g
.type;

984 
©Œ
.
´e£Á
 = 
kvm_£g
.present;

985 
©Œ
.
d¶
 = 
kvm_£g
.dpl;

986 
©Œ
.
deçuÉSize
 = 
kvm_£g
.
db
;

987 
©Œ
.
sy¡em
 = 
kvm_£g
.
s
;

988 
©Œ
.
lÚgMode
 = 
kvm_£g
.
l
;

989 
©Œ
.
g¿nuÏr™y
 = 
kvm_£g
.
g
;

990 
©Œ
.
avl
 = 
kvm_£g
.avl;

991 
©Œ
.
unu§bË
 = 
kvm_£g
.unusable;

996 
tc
->
	`£tMiscReg
(
	`MISCREG_SEG_BASE
(
šdex
), 
kvm_£g
.
ba£
);

997 
tc
->
	`£tMiscReg
(
	`MISCREG_SEG_LIMIT
(
šdex
), 
kvm_£g
.
lim™
);

998 
tc
->
	`£tMiscReg
(
	`MISCREG_SEG_SEL
(
šdex
), 
kvm_£g
.
£ËùÜ
);

999 
tc
->
	`£tMiscReg
(
	`MISCREG_SEG_ATTR
(
šdex
), 
©Œ
);

1000 
	}
}

1002 
šlše
 

1003 
	$£tCÚ‹xtSegm’t
(
Th»adCÚ‹xt
 *
tc
, cÚ¡ 
kvm_dbË
 &kvm_dtable,

1004 cÚ¡ 
šdex
)

1009 
tc
->
	`£tMiscReg
(
	`MISCREG_SEG_BASE
(
šdex
), 
kvm_dbË
.
ba£
);

1010 
tc
->
	`£tMiscReg
(
	`MISCREG_SEG_LIMIT
(
šdex
), 
kvm_dbË
.
lim™
);

1011 
	}
}

1014 
	gX86KvmCPU
::
	$upd©eTh»adCÚ‹xtSRegs
()

1016 
kvm_¤egs
 
¤egs
;

1017 
	`g‘S³cŸlRegi¡”s
(
¤egs
);

1019 
	`as£¹
(
	`g‘KvmRunS‹
()->
­ic_ba£
 =ğ
¤egs
.apic_base);

1020 
	`as£¹
(
	`g‘KvmRunS‹
()->
ü8
 =ğ
¤egs
.cr8);

1022 
	#APPLY_SREG
(
k»g
, 
m»g
è
tc
->
	`£tMiscRegNoEfãù
(m»g, 
¤egs
.k»g)

	)

1023 
	#APPLY_SEGMENT
(
k»g
, 
idx
è
	`£tCÚ‹xtSegm’t
(
tc
, 
¤egs
.k»g, idx)

	)

1024 
	#APPLY_DTABLE
(
k»g
, 
idx
è
	`£tCÚ‹xtSegm’t
(
tc
, 
¤egs
.k»g, idx)

	)

1025 
	`FOREACH_SREG
();

1026 
	`FOREACH_SEGMENT
();

1027 
	`FOREACH_DTABLE
();

1028 #undeà
APPLY_SREG


1029 #undeà
APPLY_SEGMENT


1030 #undeà
APPLY_DTABLE


1031 
	}
}

1033 
	g‹m¶©e
<
ty³Çme
 
	gT
>

1035 
	$upd©eTh»adCÚ‹xtFPUCommÚ
(
Th»adCÚ‹xt
 *
tc
, cÚ¡ 
T
 &
åu
)

1037 cÚ¡ 
	`tİ
((
åu
.
fsw
 >> 11) & 0x7);

1039 
	`¡©ic_as£¹
((
X86ISA
::
FlßtRegB™s
) == 8,

1042 
i
 = 0; i < 8; ++i) {

1043 cÚ¡ 
	`»g_idx
((
i
 + 
tİ
) & 0x7);

1044 cÚ¡ 
	`v®ue
(
X86ISA
::
	`lßdFlßt80
(
åu
.
år
[
i
]));

1045 
	`DPRINTF
(
KvmCÚ‹xt
, "Setting gem5 FP„eg %i (st[%i]) := %f\n",

1046 
»g_idx
, 
i
, 
v®ue
);

1047 
tc
->
	`£tFlßtReg
(
	`FLOATREG_FPR
(
»g_idx
), 
v®ue
);

1052 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_X87_TOP
, 
tİ
);

1053 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_MXCSR
, 
åu
.
mxc¤
);

1054 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FCW
, 
åu
.
fcw
);

1055 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FSW
, 
åu
.
fsw
);

1057 
ušt64_t
 
	`áw
(
	`cÚvX87XTagsToTags
(
åu
.
áwx
));

1059 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FTW
, 
áw
);

1060 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FTAG
, 
áw
);

1062 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FOP
, 
åu
.
Ï¡_İcode
);

1064 
i
 = 0; i < 16; ++i) {

1065 
tc
->
	`£tFlßtRegB™s
(
	`FLOATREG_XMM_LOW
(
i
),

1066 *(
X86ISA
::
FlßtRegB™s
 *)&
åu
.
xmm
[
i
][0]);

1067 
tc
->
	`£tFlßtRegB™s
(
	`FLOATREG_XMM_HIGH
(
i
),

1068 *(
X86ISA
::
FlßtRegB™s
 *)&
åu
.
xmm
[
i
][8]);

1070 
	}
}

1073 
	gX86KvmCPU
::
	$upd©eTh»adCÚ‹xtFPU
()

1075 
kvm_åu
 
åu
;

1076 
	`g‘FPUS‹
(
åu
);

1078 
	`upd©eTh»adCÚ‹xtFPUCommÚ
(
tc
, 
åu
);

1080 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FISEG
, 0);

1081 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FIOFF
, 
åu
.
Ï¡_
);

1082 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FOSEG
, 0);

1083 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FOOFF
, 
åu
.
Ï¡_dp
);

1084 
	}
}

1087 
	gX86KvmCPU
::
	$upd©eTh»adCÚ‹xtXSave
()

1089 
kvm_x§ve
 
kx§ve
;

1090 
FXSave
 &
	`x§ve
(*(FXSav*)
kx§ve
.
»giÚ
);

1091 
	`g‘XSave
(
kx§ve
);

1093 
	`upd©eTh»adCÚ‹xtFPUCommÚ
(
tc
, 
x§ve
);

1095 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FISEG
, 0);

1096 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FIOFF
, 
x§ve
.
ù¾64
.
åu_
);

1097 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FOSEG
, 0);

1098 
tc
->
	`£tMiscRegNoEfãù
(
MISCREG_FOOFF
, 
x§ve
.
ù¾64
.
åu_dp
);

1099 
	}
}

1102 
	gX86KvmCPU
::
	$upd©eTh»adCÚ‹xtMSRs
()

1104 cÚ¡ 
Kvm
::
MSRIndexVeùÜ
 &
	`m¤s
(
	`g‘M¤IÁ”£ùiÚ
());

1106 
¡d
::
unique_±r
<
kvm_m¤s
> 
	`kvm_m¤s
(

1107 
ÃwV¬SŒuù
<
kvm_m¤s
, 
kvm_m¤_’Œy
>(
m¤s
.
	`size
()));

1108 
kvm_m¤_’Œy
 *
’Œy
;

1111 
kvm_m¤s
->
nm¤s
 = 
m¤s
.
	`size
();

1112 
’Œy
 = &
kvm_m¤s
->
’Œ›s
[0];

1113 autØ
™
 = 
m¤s
.
	`cbegš
(); iˆ!ğm¤s.
	`ûnd
(); ++™, ++
’Œy
) {

1114 
’Œy
->
šdex
 = *
™
;

1115 
’Œy
->
»£rved
 = 0;

1116 
’Œy
->
d©a
 = 0;

1119 
	`g‘MSRs
(*
kvm_m¤s
.
	`g‘
());

1122 
’Œy
 = &
kvm_m¤s
->
’Œ›s
[0];

1123 
i
 = 0; i < 
kvm_m¤s
->
nm¤s
; ++i, ++
’Œy
) {

1124 
	`DPRINTF
(
KvmCÚ‹xt
, "Setting M5 MSR: idx: 0x%x, data: 0x%x\n",

1125 
’Œy
->
šdex
,ƒÁry->
d©a
);

1127 
tc
->
	`£tMiscReg
(
X86ISA
::
m¤M­
.
	`©
(
’Œy
->
šdex
),ƒÁry->
d©a
);

1129 
	}
}

1132 
	gX86KvmCPU
::
	$d–iv”IÁ”ru±s
()

1134 
	`syncTh»adCÚ‹xt
();

1136 
FauÉ
 
	`çuÉ
(
š‹¼u±s
->
	`g‘IÁ”ru±
(
tc
));

1137 
š‹¼u±s
->
	`upd©eIÁrInfo
(
tc
);

1139 
X86IÁ”ru±
 *
	`x86št
(
dyÇmic_ÿ¡
<X86IÁ”ru± *>(
çuÉ
.
	`g‘
()));

1140 ià(
x86št
) {

1141 
kvm_š‹¼u±
 
kvm_št
;

1142 
kvm_št
.
œq
 = 
x86št
->
	`g‘VeùÜ
();

1144 
	`DPRINTF
(
KvmIÁ
, "Delivering interrupt: %s (%u)\n",

1145 
çuÉ
->
	`Çme
(), 
kvm_št
.
œq
);

1147 
	`kvmIÁ”ru±
(
kvm_št
);

1148 } ià(
dyÇmic_ÿ¡
<
NÚMaskabËIÁ”ru±
 *>(
çuÉ
.
	`g‘
())) {

1149 
	`DPRINTF
(
KvmIÁ
, "Delivering NMI\n");

1150 
	`kvmNÚMaskabËIÁ”ru±
();

1152 
	`·nic
("KVM: Unknown interruptype\n");

1155 
	}
}

1157 
Tick


1158 
	gX86KvmCPU
::
	$kvmRun
(
Tick
 
ticks
)

1160 
kvm_run
 &
	`kvm_run
(*
	`g‘KvmRunS‹
());

1162 ià(
š‹¼u±s
->
	`checkIÁ”ru±sRaw
()) {

1163 ià(
kvm_run
.
»ady_fÜ_š‹¼u±_šjeùiÚ
) {

1169 
	`syncTh»adCÚ‹xt
();

1170 ià(
š‹¼u±s
->
	`checkIÁ”ru±s
(
tc
)) {

1171 
	`DPRINTF
(
KvmIÁ
,

1174 
	`d–iv”IÁ”ru±s
();

1176 
	`DPRINTF
(
KvmIÁ
,

1178 
kvm_run
.
»que¡_š‹¼u±_wšdow
 = 1;

1180 } ià(!
kvm_run
.
»que¡_š‹¼u±_wšdow
) {

1181 
	`DPRINTF
(
KvmIÁ
,

1184 
kvm_run
.
»que¡_š‹¼u±_wšdow
 = 1;

1187 
kvm_run
.
»que¡_š‹¼u±_wšdow
 = 0;

1190  
	`kvmRunW¿µ”
(
ticks
);

1191 
	}
}

1193 
Tick


1194 
	gX86KvmCPU
::
	$kvmRunD¿š
()

1196 
kvm_run
 &
	`kvm_run
(*
	`g‘KvmRunS‹
());

1198 ià(!
	`¬chIsD¿šed
()) {

1199 
	`DPRINTF
(
D¿š
, "kvmRunDrain: Architecture code isn't drained\n");

1205 
kvm_run
.
»que¡_š‹¼u±_wšdow
 = 1;

1210  
	`kvmRunW¿µ”
(1 * 
SimClock
::
Flßt
::
ms
);

1212 
	`DPRINTF
(
D¿š
, "kvmRunDrain: Delivering…ending IO\n");

1214  
	`kvmRunW¿µ”
(0);

1216 
	}
}

1218 
Tick


1219 
	gX86KvmCPU
::
	$kvmRunW¿µ”
(
Tick
 
ticks
)

1221 
kvm_run
 &
	`kvm_run
(*
	`g‘KvmRunS‹
());

1226 
kvm_run
.
­ic_ba£
 = 
tc
->
	`»adMiscReg
(
MISCREG_APIC_BASE
);

1227 
kvm_run
.
ü8
 = 
tc
->
	`»adMiscReg
(
MISCREG_CR8
);

1229 cÚ¡ 
Tick
 
	`run_ticks
(
Ba£KvmCPU
::
	`kvmRun
(
ticks
));

1231 
tc
->
	`£tMiscReg
(
MISCREG_APIC_BASE
, 
kvm_run
.
­ic_ba£
);

1232 
kvm_run
.
ü8
 = 
tc
->
	`»adMiscReg
(
MISCREG_CR8
);

1234  
run_ticks
;

1235 
	}
}

1237 
ušt64_t


1238 
	gX86KvmCPU
::
	$g‘Ho¡Cyşes
() const

1240  
	`g‘MSR
(
MSR_TSC
);

1241 
	}
}

1244 
	gX86KvmCPU
::
	$hªdËIOMiscReg32
(
misüeg
)

1246 
kvm_run
 &
	`kvm_run
(*
	`g‘KvmRunS‹
());

1247 cÚ¡ 
ušt16_t
 
	`pÜt
(
kvm_run
.
io
.
pÜt
);

1249 
	`as£¹
(
kvm_run
.
ex™_»asÚ
 =ğ
KVM_EXIT_IO
);

1251 ià(
kvm_run
.
io
.
size
 != 4) {

1252 
	`·nic
("Unexpected IO size (%u) for‡ddress 0x%x.\n",

1253 
kvm_run
.
io
.
size
, 
pÜt
);

1256 ià(
kvm_run
.
io
.
couÁ
 != 1) {

1257 
	`·nic
("Unexpected IO count (%u) for‡ddress 0x%x.\n",

1258 
kvm_run
.
io
.
couÁ
, 
pÜt
);

1261 
ušt32_t
 *
	`d©a
((ušt32_ˆ*)
	`g‘Gue¡D©a
(
kvm_run
.
io
.
d©a_off£t
));

1262 ià(
kvm_run
.
io
.
dœeùiÚ
 =ğ
KVM_EXIT_IO_OUT
)

1263 
tc
->
	`£tMiscReg
(
misüeg
, *
d©a
);

1265 *
d©a
 = 
tc
->
	`»adMiscRegNoEfãù
(
misüeg
);

1266 
	}
}

1268 
Tick


1269 
	gX86KvmCPU
::
	$hªdËKvmEx™IO
()

1271 
kvm_run
 &
	`kvm_run
(*
	`g‘KvmRunS‹
());

1272 
boŞ
 
	`isWr™e
(
kvm_run
.
io
.
dœeùiÚ
 =ğ
KVM_EXIT_IO_OUT
);

1273 *
	`gue¡D©a
(
	`g‘Gue¡D©a
(
kvm_run
.
io
.
d©a_off£t
));

1274 
Tick
 
	`d–ay
(0);

1275 
ušt16_t
 
	`pÜt
(
kvm_run
.
io
.
pÜt
);

1276 
Addr
 
pAddr
;

1277 cÚ¡ 
	`couÁ
(
kvm_run
.
io
.
couÁ
);

1279 
	`as£¹
(
kvm_run
.
io
.
dœeùiÚ
 =ğ
KVM_EXIT_IO_IN
 ||

1280 
kvm_run
.
io
.
dœeùiÚ
 =ğ
KVM_EXIT_IO_OUT
);

1282 
	`DPRINTF
(
KvmIO
, "KVM-x86: Handling IO instruction (%s) (port: 0x%x)\n",

1283 (
isWr™e
 ? "out" : "š"), 
kvm_run
.
io
.
pÜt
);

1294 ià(
pÜt
 =ğ
IO_PCI_CONF_ADDR
) {

1295 
	`hªdËIOMiscReg32
(
MISCREG_PCI_CONFIG_ADDRESS
);

1297 } ià((
pÜt
 & ~0x3è=ğ
IO_PCI_CONF_DATA_BASE
) {

1298 
Addr
 
	`pciCÚfigAddr
(
tc
->
	`»adMiscRegNoEfãù
(
MISCREG_PCI_CONFIG_ADDRESS
));

1299 ià(
pciCÚfigAddr
 & 0x80000000) {

1300 
pAddr
 = 
X86ISA
::
	`x86PciCÚfigAdd»ss
((
pciCÚfigAddr
 & 0x7ffffffc) |

1301 (
pÜt
 & 0x3));

1303 
pAddr
 = 
X86ISA
::
	`x86IOAdd»ss
(
pÜt
);

1306 
pAddr
 = 
X86ISA
::
	`x86IOAdd»ss
(
pÜt
);

1309 
io_»q
.
	`£tPhys
(
pAddr
, 
kvm_run
.
io
.
size
, 
Reque¡
::
UNCACHEABLE
,

1310 
	`d©aMa¡”Id
());

1312 cÚ¡ 
MemCmd
 
	`cmd
(
isWr™e
 ? MemCmd::
Wr™eReq
 : MemCmd::
R—dReq
);

1313 
i
 = 0; i < 
couÁ
; ++i) {

1314 
Pack‘
 
	`pkt
(&
io_»q
, 
cmd
);

1316 
pkt
.
	`d©aStic
(
gue¡D©a
);

1317 
d–ay
 +ğ
d©aPÜt
.
	`£ndAtomic
(&
pkt
);

1319 
gue¡D©a
 +ğ
kvm_run
.
io
.
size
;

1322  
d–ay
;

1323 
	}
}

1325 
Tick


1326 
	gX86KvmCPU
::
	$hªdËKvmEx™IRQWšdowO³n
()

1332 
	}
}

1334 
boŞ


1335 
	gX86KvmCPU
::
	$¬chIsD¿šed
() const

1337 
kvm_vıu_ev’ts
 
ev’ts
;

1339 
	`g‘VCpuEv’ts
(
ev’ts
);

1348 cÚ¡ 
boŞ
 
	`³ndšg_ev’ts
(
ev’ts
.
exû±iÚ
.
šjeùed
 ||

1349 
ev’ts
.
š‹¼u±
.
šjeùed
 ||

1350 
ev’ts
.
nmi
.
šjeùed
 ||ƒv’ts.nmi.
³ndšg
);

1352 ià(
³ndšg_ev’ts
) {

1353 
	`DPRINTF
(
D¿š
, "archIsDrained: Pendingƒvents: %s %s %s %s\n",

1354 
ev’ts
.
exû±iÚ
.
šjeùed
 ? "exception" : "",

1355 
ev’ts
.
š‹¼u±
.
šjeùed
 ? "interrupt" : "",

1356 
ev’ts
.
nmi
.
šjeùed
 ? "nmi[i]" : "",

1357 
ev’ts
.
nmi
.
³ndšg
 ? "nmi[p]" : "");

1360  !
³ndšg_ev’ts
;

1361 
	}
}

1363 
kvm_ıuid_’Œy2


1364 
	$makeKvmCpuid
(
ušt32_t
 
funùiÚ
, ušt32_ˆ
šdex
,

1365 
CpuidResuÉ
 &
»suÉ
)

1367 
kvm_ıuid_’Œy2
 
e
;

1368 
e
.
funùiÚ
 = function;

1369 
e
.
šdex
 = index;

1370 
e
.
æags
 = 0;

1371 
e
.
—x
 = (
ušt32_t
)
»suÉ
.
¿x
;

1372 
e
.
ebx
 = (
ušt32_t
)
»suÉ
.
rbx
;

1373 
e
.
ecx
 = (
ušt32_t
)
»suÉ
.
rcx
;

1374 
e
.
edx
 = (
ušt32_t
)
»suÉ
.
rdx
;

1376  
e
;

1377 
	}
}

1380 
	gX86KvmCPU
::
	$upd©eCPUID
()

1382 
Kvm
::
CPUIDVeùÜ
 
m5_suµÜ‹d
;

1391 
CpuidResuÉ
 
func0
;

1392 
X86ISA
::
	`doCpuid
(
tc
, 0x0, 0, 
func0
);

1393 
ušt32_t
 
funùiÚ
 = 0; funùiÚ <ğ
func0
.
¿x
; ++function) {

1394 
CpuidResuÉ
 
ıuid
;

1395 
ušt32_t
 
	`idx
(0);

1397 
X86ISA
::
	`doCpuid
(
tc
, 
funùiÚ
, 
idx
, 
ıuid
);

1398 
m5_suµÜ‹d
.
	`push_back
(
	`makeKvmCpuid
(
funùiÚ
, 
idx
, 
ıuid
));

1402 
CpuidResuÉ
 
efunc0
;

1403 
X86ISA
::
	`doCpuid
(
tc
, 0x80000000, 0, 
efunc0
);

1404 
ušt32_t
 
funùiÚ
 = 0x80000000; funùiÚ <ğ
efunc0
.
¿x
; ++function) {

1405 
CpuidResuÉ
 
ıuid
;

1406 
ušt32_t
 
	`idx
(0);

1408 
X86ISA
::
	`doCpuid
(
tc
, 
funùiÚ
, 
idx
, 
ıuid
);

1409 
m5_suµÜ‹d
.
	`push_back
(
	`makeKvmCpuid
(
funùiÚ
, 
idx
, 
ıuid
));

1412 
	`£tCPUID
(
m5_suµÜ‹d
);

1413 
	}
}

1416 
	gX86KvmCPU
::
	$£tCPUID
(cÚ¡ 
kvm_ıuid2
 &
ıuid
)

1418 ià(
	`ioùl
(
KVM_SET_CPUID2
, (*)&
ıuid
) == -1)

1419 
	`·nic
("KVM: Failedo set guest CPUID2 (errno: %i)\n",

1420 
”ºo
);

1421 
	}
}

1424 
	gX86KvmCPU
::
£tCPUID
(cÚ¡ 
Kvm
::
CPUIDVeùÜ
 &
ıuid
)

1426 
¡d
::
unique_±r
<
kvm_ıuid2
> 
kvm_ıuid
(

1427 
ÃwV¬SŒuù
<
kvm_ıuid2
, 
kvm_ıuid_’Œy2
>(
ıuid
.
size
()));

1429 
	gkvm_ıuid
->
	gÃÁ
 = 
ıuid
.
size
();

1430 
	g¡d
::
cİy
(
ıuid
.
begš
(), cpuid.
’d
(), 
kvm_ıuid
->
’Œ›s
);

1432 
£tCPUID
(*
kvm_ıuid
);

1436 
	gX86KvmCPU
::
	$£tMSRs
(cÚ¡ 
kvm_m¤s
 &
m¤s
)

1438 ià(
	`ioùl
(
KVM_SET_MSRS
, (*)&
m¤s
) == -1)

1439 
	`·nic
("KVM: Failedo set guest MSRs (errno: %i)\n",

1440 
”ºo
);

1441 
	}
}

1444 
	gX86KvmCPU
::
	$£tMSRs
(cÚ¡ 
KvmMSRVeùÜ
 &
m¤s
)

1446 
¡d
::
unique_±r
<
kvm_m¤s
> 
	`kvm_m¤s
(

1447 
ÃwV¬SŒuù
<
kvm_m¤s
, 
kvm_m¤_’Œy
>(
m¤s
.
	`size
()));

1449 
kvm_m¤s
->
nm¤s
 = 
m¤s
.
	`size
();

1450 
¡d
::
	`cİy
(
m¤s
.
	`begš
(), m¤s.
	`’d
(), 
kvm_m¤s
->
’Œ›s
);

1452 
	`£tMSRs
(*
kvm_m¤s
);

1453 
	}
}

1456 
	gX86KvmCPU
::
	$g‘MSRs
(
kvm_m¤s
 &
m¤s
) const

1458 ià(
	`ioùl
(
KVM_GET_MSRS
, (*)&
m¤s
) == -1)

1459 
	`·nic
("KVM: Failedo get guest MSRs (errno: %i)\n",

1460 
”ºo
);

1461 
	}
}

1465 
	gX86KvmCPU
::
	$£tMSR
(
ušt32_t
 
šdex
, 
ušt64_t
 
v®ue
)

1467 
¡d
::
unique_±r
<
kvm_m¤s
> 
	`kvm_m¤s
(

1468 
ÃwV¬SŒuù
<
kvm_m¤s
, 
kvm_m¤_’Œy
>(1));

1469 
kvm_m¤_’Œy
 &
	`’Œy
(
kvm_m¤s
->
’Œ›s
[0]);

1471 
kvm_m¤s
->
nm¤s
 = 1;

1472 
’Œy
.
šdex
 = index;

1473 
’Œy
.
»£rved
 = 0;

1474 
’Œy
.
d©a
 = 
v®ue
;

1476 
	`£tMSRs
(*
kvm_m¤s
.
	`g‘
());

1477 
	}
}

1479 
ušt64_t


1480 
	gX86KvmCPU
::
	$g‘MSR
(
ušt32_t
 
šdex
) const

1482 
¡d
::
unique_±r
<
kvm_m¤s
> 
	`kvm_m¤s
(

1483 
ÃwV¬SŒuù
<
kvm_m¤s
, 
kvm_m¤_’Œy
>(1));

1484 
kvm_m¤_’Œy
 &
	`’Œy
(
kvm_m¤s
->
’Œ›s
[0]);

1486 
kvm_m¤s
->
nm¤s
 = 1;

1487 
’Œy
.
šdex
 = index;

1488 
’Œy
.
»£rved
 = 0;

1489 
’Œy
.
d©a
 = 0;

1491 
	`g‘MSRs
(*
kvm_m¤s
.
	`g‘
());

1492  
’Œy
.
d©a
;

1493 
	}
}

1495 cÚ¡ 
	gKvm
::
MSRIndexVeùÜ
 &

1496 
X86KvmCPU
::
	$g‘M¤IÁ”£ùiÚ
() const

1498 ià(
ÿchedM¤IÁ”£ùiÚ
.
	`em±y
()) {

1499 cÚ¡ 
Kvm
::
MSRIndexVeùÜ
 &
	`kvm_m¤s
(
vm
.
kvm
.
	`g‘SuµÜ‹dMSRs
());

1501 
	`DPRINTF
(
Kvm
, "kvm-x86: Updating MSR intersection\n");

1502 autØ
™
 = 
kvm_m¤s
.
	`cbegš
(); iˆ!ğkvm_m¤s.
	`ûnd
(); ++it) {

1503 ià(
X86ISA
::
m¤M­
.
	`fšd
(*
™
è!ğX86ISA::m¤M­.
	`’d
()) {

1504 
ÿchedM¤IÁ”£ùiÚ
.
	`push_back
(*
™
);

1505 
	`DPRINTF
(
Kvm
, "kvm-x86: Addšg MSR 0x%x\n", *
™
);

1507 
	`w¬n
("kvm-x86: MSR (0x%x) unsupported by gem5. Skipping.\n",

1508 *
™
);

1513  
ÿchedM¤IÁ”£ùiÚ
;

1514 
	}
}

1517 
	gX86KvmCPU
::
	$g‘DebugRegi¡”s
(
kvm_debug»gs
 &
»gs
) const

1519 #ifdeà
KVM_GET_DEBUGREGS


1520 ià(
	`ioùl
(
KVM_GET_DEBUGREGS
, &
»gs
) == -1)

1521 
	`·nic
("KVM: Failedo get guest debug„egisters\n");

1523 
	`·nic
("KVM: Unsupported getDebugRegisters call.\n");

1525 
	}
}

1528 
	gX86KvmCPU
::
	$£tDebugRegi¡”s
(cÚ¡ 
kvm_debug»gs
 &
»gs
)

1530 #ifdeà
KVM_SET_DEBUGREGS


1531 ià(
	`ioùl
(
KVM_SET_DEBUGREGS
, (*)&
»gs
) == -1)

1532 
	`·nic
("KVM: Failedo set guest debug„egisters\n");

1534 
	`·nic
("KVM: Unsupported setDebugRegisters call.\n");

1536 
	}
}

1539 
	gX86KvmCPU
::
	$g‘XCRs
(
kvm_xüs
 &
»gs
) const

1541 ià(
	`ioùl
(
KVM_GET_XCRS
, &
»gs
) == -1)

1542 
	`·nic
("KVM: Failedo get guest debug„egisters\n");

1543 
	}
}

1546 
	gX86KvmCPU
::
	$£tXCRs
(cÚ¡ 
kvm_xüs
 &
»gs
)

1548 ià(
	`ioùl
(
KVM_SET_XCRS
, (*)&
»gs
) == -1)

1549 
	`·nic
("KVM: Failedo set guest debug„egisters\n");

1550 
	}
}

1553 
	gX86KvmCPU
::
	$g‘XSave
(
kvm_x§ve
 &
x§ve
) const

1555 ià(
	`ioùl
(
KVM_GET_XSAVE
, &
x§ve
) == -1)

1556 
	`·nic
("KVM: Failedo get guest debug„egisters\n");

1557 
	}
}

1560 
	gX86KvmCPU
::
	$£tXSave
(cÚ¡ 
kvm_x§ve
 &
x§ve
)

1562 ià(
	`ioùl
(
KVM_SET_XSAVE
, (*)&
x§ve
) == -1)

1563 
	`·nic
("KVM: Failedo set guest debug„egisters\n");

1564 
	}
}

1568 
	gX86KvmCPU
::
	$g‘VCpuEv’ts
(
kvm_vıu_ev’ts
 &
ev’ts
) const

1570 ià(
	`ioùl
(
KVM_GET_VCPU_EVENTS
, &
ev’ts
) == -1)

1571 
	`·nic
("KVM: Failedo get guest debug„egisters\n");

1572 
	}
}

1575 
	gX86KvmCPU
::
	$£tVCpuEv’ts
(cÚ¡ 
kvm_vıu_ev’ts
 &
ev’ts
)

1577 ià(
	`ioùl
(
KVM_SET_VCPU_EVENTS
, (*)&
ev’ts
) == -1)

1578 
	`·nic
("KVM: Failedo set guest debug„egisters\n");

1579 
	}
}

1581 
X86KvmCPU
 *

1582 
	gX86KvmCPUP¬ams
::
	$ü—‹
()

1584  
Ãw
 
	`X86KvmCPU
(
this
);

1585 
	}
}

	@kvm/x86_cpu.hh

31 #iâdeà
__CPU_KVM_X86_CPU_HH__


32 
	#__CPU_KVM_X86_CPU_HH__


	)

34 
	~"ıu/kvm/ba£.hh
"

35 
	~"ıu/kvm/vm.hh
"

36 
	~"·¿ms/X86KvmCPU.hh
"

41 şas 
	cX86KvmCPU
 : 
public
 
Ba£KvmCPU


43 
public
:

44 
X86KvmCPU
(
X86KvmCPUP¬ams
 *
·¿ms
);

45 
	mvœtu®
 ~
X86KvmCPU
();

47 
¡¬tup
();

50 
dump
();

51 
	$dumpFpuRegs
() const;

52 
	$dumpIÁRegs
() const;

53 
	$dumpS³cRegs
() const;

54 
	$dumpDebugRegs
() const;

55 
	$dumpXCRs
() const;

56 
	$dumpXSave
() const;

57 
	$dumpVCpuEv’ts
() const;

58 
	$dumpMSRs
() const;

61 
´Ùeùed
:

62 
¡d
::
	tveùÜ
<
	tkvm_m¤_’Œy
> 
	tKvmMSRVeùÜ
;

64 
Tick
 
	`kvmRun
(Tick 
ticks
);

81 
Tick
 
	`kvmRunD¿š
();

84 
Tick
 
	`kvmRunW¿µ”
(Tick 
ticks
);

86 
ušt64_t
 
	$g‘Ho¡Cyşes
() const;

94 
	`£tCPUID
(cÚ¡ 
kvm_ıuid2
 &
ıuid
);

95 
	`£tCPUID
(cÚ¡ 
Kvm
::
CPUIDVeùÜ
 &
ıuid
);

103 
	`£tMSRs
(cÚ¡ 
kvm_m¤s
 &
m¤s
);

104 
	`£tMSRs
(cÚ¡ 
KvmMSRVeùÜ
 &
m¤s
);

105 
	$g‘MSRs
(
kvm_m¤s
 &
m¤s
) const;

106 
	`£tMSR
(
ušt32_t
 
šdex
, 
ušt64_t
 
v®ue
);

107 
ušt64_t
 
	$g‘MSR
(
ušt32_t
 
šdex
) const;

118 cÚ¡ 
Kvm
::
MSRIndexVeùÜ
 &
	$g‘M¤IÁ”£ùiÚ
() const;

125 
	$g‘DebugRegi¡”s
(
kvm_debug»gs
 &
»gs
) const;

126 
	`£tDebugRegi¡”s
(cÚ¡ 
kvm_debug»gs
 &
»gs
);

127 
	$g‘XCRs
(
kvm_xüs
 &
»gs
) const;

128 
	`£tXCRs
(cÚ¡ 
kvm_xüs
 &
»gs
);

129 
	$g‘XSave
(
kvm_x§ve
 &
x§ve
) const;

130 
	`£tXSave
(cÚ¡ 
kvm_x§ve
 &
x§ve
);

131 
	$g‘VCpuEv’ts
(
kvm_vıu_ev’ts
 &
ev’ts
) const;

132 
	`£tVCpuEv’ts
(cÚ¡ 
kvm_vıu_ev’ts
 &
ev’ts
);

135 
	`upd©eKvmS‹
();

136 
	`upd©eTh»adCÚ‹xt
();

141 
	`d–iv”IÁ”ru±s
();

146 
Tick
 
	`hªdËKvmEx™IO
();

148 
Tick
 
	`hªdËKvmEx™IRQWšdowO³n
();

161 
boŞ
 
	$¬chIsD¿šed
() const;

163 
´iv©e
:

171 
	`upd©eKvmS‹Regs
();

173 
	`upd©eKvmS‹SRegs
();

184 
	`upd©eKvmS‹FPU
();

192 
	`upd©eKvmS‹FPULegacy
();

200 
	`upd©eKvmS‹FPUXSave
();

202 
	`upd©eKvmS‹MSRs
();

212 
	`upd©eTh»adCÚ‹xtRegs
();

214 
	`upd©eTh»adCÚ‹xtSRegs
();

216 
	`upd©eTh»adCÚ‹xtFPU
();

218 
	`upd©eTh»adCÚ‹xtXSave
();

220 
	`upd©eTh»adCÚ‹xtMSRs
();

224 
	`upd©eCPUID
();

234 
	`hªdËIOMiscReg32
(
misüeg
);

237 
Reque¡
 
io_»q
;

240 
mubË
 
Kvm
::
MSRIndexVeùÜ
 
ÿchedM¤IÁ”£ùiÚ
;

244 
boŞ
 
haveDebugRegs
;

246 
boŞ
 
haveXSave
;

251 
boŞ
 
u£XSave
;

253 
boŞ
 
haveXCRs
;

	@legiontrace.cc

34 
	~"cÚfig/the_i§.hh
"

35 #ià
THE_ISA
 !ğ
SPARC_ISA


36 #”rÜ 
LegiÚ
 
Œacšg
 
Úly
 
wÜks
 
w™h
 
SPARC
 
simuÏtiÚs
!

39 
	~<sys/c.h
>

40 
	~<sys/shm.h
>

42 
	~<c¡dio
>

43 
	~<iomª
>

45 
	~"¬ch/¥¬c/decod”.hh
"

46 
	~"¬ch/¥¬c/»gi¡”s.hh
"

47 
	~"¬ch/¥¬c/ut™y.hh
"

48 
	~"¬ch/b.hh
"

49 
	~"ba£/sock‘.hh
"

50 
	~"ıu/ba£.hh
"

51 
	~"ıu/ËgiÚŒaû.hh
"

52 
	~"ıu/¡©ic_š¡.hh
"

53 
	~"ıu/th»ad_cÚ‹xt.hh
"

54 
	~"sim/fuÎ_sy¡em.hh
"

55 
	~"sim/sy¡em.hh
"

58 
	~"ıu/m5ËgiÚ_š‹rçû.h
"

60 
usšg
 
Çme¥aû
 
	g¡d
;

61 
usšg
 
Çme¥aû
 
	gTheISA
;

63 
	gdiffcouÁ
 = 0;

64 
boŞ
 
	gwasMiüo
 = 
çl£
;

66 
Çme¥aû
 
	gT¿û
 {

67 
Sh¬edD©a
 *
	gsh¬ed_d©a
 = 
NULL
;

70 
£tupSh¬edD©a
()

72 
	gshmfd
 = 
shmg‘
('M' << 24 | 
g‘uid
(), (
Sh¬edD©a
), 0777);

73 ià(
	gshmfd
 < 0)

74 
çl
("Couldn't get shared memory fd. Is Legion„unning?");

76 
	gsh¬ed_d©a
 = (
Sh¬edD©a
*)
shm©
(
shmfd
, 
NULL
, 
SHM_RND
);

77 ià(
	gsh¬ed_d©a
 =ğ(
Sh¬edD©a
*)-1)

78 
çl
("Couldn't‡llocate shared memory");

80 ià(
	gsh¬ed_d©a
->
	gæags
 !ğ
OWN_M5
)

81 
çl
("Shared memory has invalid owner");

83 ià(
	gsh¬ed_d©a
->
	gv”siÚ
 !ğ
VERSION
)

84 
çl
("Sh¬ed D©¨i wrÚg v”siÚ! M5: %d LegiÚ: %d", 
VERSION
,

85 
sh¬ed_d©a
->
v”siÚ
);

88 
	gsh¬ed_d©a
->
	gæags
 = 
OWN_LEGION
;

96 
šlše
 * 
g’C’‹»dLab–
(
Ëngth
, * 
bufãr
, cÚ¡ * 
Ïb–
)

98 
	gÏb–L’gth
 = 
¡¾’
(
Ïb–
);

99 
as£¹
(
Ïb–L’gth
 <ğ
Ëngth
);

100 
	gËáPad
 = (
Ëngth
 - 
Ïb–L’gth
) / 2;

101 
	grightPad
 = 
Ëngth
 - 
ËáPad
 - 
Ïb–L’gth
;

102 
	gfÜm©
[64];

103 
¥rštf
(
fÜm©
, "%%%ds%%s%%%ds", 
ËáPad
, 
rightPad
);

104 
¥rštf
(
bufãr
, 
fÜm©
, "", 
Ïb–
, "");

105  
	gbufãr
;

108 
šlše
 
´štRegPaœ
(
o¡»am
 & 
os
, cÚ¡ * 
t™Ë
, 
ušt64_t
 
a
, ušt64_ˆ
b
)

110 
cırštf
(
os
, " %16s | %#018x %s %#-018x \n",

111 
t™Ë
, 
a
, (¨=ğ
b
) ? "|" : "X", b);

114 
šlše
 
´štCŞumnLab–s
(
o¡»am
 & 
os
)

116 * 
	g»gLab–
 = 
g’C’‹»dLab–
(16, 
Ãw
 [17], "Register");

117 * 
	gm5Lab–
 = 
g’C’‹»dLab–
(18, 
Ãw
 [18], "M5");

118 * 
	gËgiÚLab–
 = 
g’C’‹»dLab–
(18, 
Ãw
 [18], "Legion");

119 
cırštf
(
os
, " %  | %  | %  \n", 
»gLab–
, 
m5Lab–
, 
ËgiÚLab–
);

120 
cırštf
(
os
, "--------------------+-----------------------+-----------------------\n");

123 
šlše
 
´štSeùiÚH—d”
(
o¡»am
 & 
os
, cÚ¡ * 
Çme
)

125 
	g£ùiÚSŒšg
[70];

126 
g’C’‹»dLab–
(69, 
£ùiÚSŒšg
, 
Çme
);

127 
cırštf
(
os
, "====================================================================\n");

128 
cırštf
(
os
, "%69s\n", 
£ùiÚSŒšg
);

129 
cırštf
(
os
, "====================================================================\n");

132 
šlše
 
´štLev–H—d”
(
o¡»am
 & 
os
, 
Ëv–
)

134 
	g£ùiÚSŒšg
[70];

135 
	gËv–Name
[70];

136 
¥rštf
(
Ëv–Name
, "T¿°¡ack†ev– %d", 
Ëv–
);

137 
g’C’‹»dLab–
(69, 
£ùiÚSŒšg
, 
Ëv–Name
);

138 
cırštf
(
os
, "====================================================================\n");

139 
cırštf
(
os
, "%69s\n", 
£ùiÚSŒšg
);

140 
cırštf
(
os
, "====================================================================\n");

144 
	gT¿û
::
LegiÚT¿ûRecÜd
::
dump
()

146 
o¡»am
 &
outs
 = 
T¿û
::
ouut
();

149 
boŞ
 
	gcom·»d
 = 
çl£
;

150 
boŞ
 
	gdiffPC
 = 
çl£
;

151 
boŞ
 
	gdiffCC
 = 
çl£
;

152 
boŞ
 
	gdiffIn¡
 = 
çl£
;

153 
boŞ
 
	gdiffIÁRegs
 = 
çl£
;

154 
boŞ
 
	gdiffFpRegs
 = 
çl£
;

155 
boŞ
 
	gdiffTpc
 = 
çl£
;

156 
boŞ
 
	gdiffTÅc
 = 
çl£
;

157 
boŞ
 
	gdiffT¡©e
 = 
çl£
;

158 
boŞ
 
	gdiffTt
 = 
çl£
;

159 
boŞ
 
diffTba
 
	gM5_VAR_USED
 = 
çl£
;

160 
boŞ
 
	gdiffHp¡©e
 = 
çl£
;

161 
boŞ
 
	gdiffHt¡©e
 = 
çl£
;

162 
boŞ
 
	gdiffHtba
 = 
çl£
;

163 
boŞ
 
	gdiffP¡©e
 = 
çl£
;

164 
boŞ
 
	gdiffY
 = 
çl£
;

165 
boŞ
 
	gdiffF¤
 = 
çl£
;

166 
boŞ
 
	gdiffCü
 = 
çl£
;

167 
boŞ
 
	gdiffTl
 = 
çl£
;

168 
boŞ
 
	gdiffGl
 = 
çl£
;

169 
boŞ
 
	gdiffAsi
 = 
çl£
;

170 
boŞ
 
	gdiffP
 = 
çl£
;

171 
boŞ
 
	gdiffCwp
 = 
çl£
;

172 
boŞ
 
	gdiffCª§ve
 = 
çl£
;

173 
boŞ
 
	gdiffCª»¡Üe
 = 
çl£
;

174 
boŞ
 
	gdiffOth”wš
 = 
çl£
;

175 
boŞ
 
	gdiffCËªwš
 = 
çl£
;

176 
boŞ
 
	gdiffTlb
 = 
çl£
;

177 
Addr
 
	gm5Pc
, 
	glgnPc
;

179 ià(!
	gsh¬ed_d©a
)

180 
£tupSh¬edD©a
();

183 ià(
	gwasMiüo
 && !
	g¡©icIn¡
->
isMiüoİ
())

186 !
	gcom·»d
)

187 ià(
	gsh¬ed_d©a
->
	gæags
 =ğ
OWN_M5
) {

188 
sh¬ed_d©a
->
æags
 = 
OWN_LEGION
;

189 
	gcom·»d
 = 
Œue
;

191 
	gcom·»d
 = 
çl£
;

192 
	gwasMiüo
 = 
çl£
;

195 ià(
	g¡©icIn¡
->
isLa¡Miüoİ
())

196 
	gwasMiüo
 = 
çl£
;

197 ià(
	g¡©icIn¡
->
isMiüoİ
())

198 
	gwasMiüo
 = 
Œue
;

201 if(!
	g¡©icIn¡
->
isMiüoİ
(è|| sticIn¡->
isLa¡Miüoİ
()) {

202 !
	gcom·»d
) {

203 ià(
	gsh¬ed_d©a
->
	gæags
 =ğ
OWN_M5
) {

204 
m5Pc
 = 
pc
.
š¡Addr
(è& 
S·rcISA
::
PAddrIm¶Mask
;

205 ià(
b™s
(
sh¬ed_d©a
->
p¡©e
,3,3)) {

206 
	gm5Pc
 &ğ
mask
(32);

208 
	glgnPc
 = 
sh¬ed_d©a
->
pc
 & 
S·rcISA
::
PAddrIm¶Mask
;

209 ià(
	glgnPc
 !ğ
m5Pc
)

210 
diffPC
 = 
Œue
;

212 ià(
	gsh¬ed_d©a
->
	gcyşe_couÁ
 !=

213 
th»ad
->
g‘CpuPŒ
()->
š¡CouÁ
())

214 
diffCC
 = 
Œue
;

216 ià(
	gsh¬ed_d©a
->
	gš¡ruùiÚ
 !=

217 (
S·rcISA
::
MachIn¡
)
¡©icIn¡
->
machIn¡
) {

218 
diffIn¡
 = 
Œue
;

221 
	gi
 = 1; i < 
	gTheISA
::
NumIÁArchRegs
; i++) {

222 ià(
	gth»ad
->
»adIÁReg
(
i
è!ğ
sh¬ed_d©a
->
šŒegs
[i]) {

223 
diffIÁRegs
 = 
Œue
;

226 
	gi
 = 0; i < 
	gTheISA
::
NumFlßtRegs
/2; i++) {

227 ià(
	gth»ad
->
»adFlßtRegB™s
(
i
*2) !=

228 
sh¬ed_d©a
->
å»gs
[
i
]) {

229 
diffFpRegs
 = 
Œue
;

232 
ušt64_t
 
	gŞdTl
 =

233 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_TL
);

234 ià(
	gŞdTl
 !ğ
sh¬ed_d©a
->

)

235 
diffTl
 = 
Œue
;

236 
	gi
 = 1; i <ğ
MaxTL
; i++) {

237 
	gth»ad
->
£tMiscRegNoEfãù
(
MISCREG_TL
, 
i
);

238 ià(
	gth»ad
->
»adMiscRegNoEfãù
(
MISCREG_TPC
) !=

239 
sh¬ed_d©a
->
c
[
i
-1])

240 
diffTpc
 = 
Œue
;

241 ià(
	gth»ad
->
»adMiscRegNoEfãù
(
MISCREG_TNPC
) !=

242 
sh¬ed_d©a
->
Špc
[
i
-1])

243 
diffTÅc
 = 
Œue
;

244 ià(
	gth»ad
->
»adMiscRegNoEfãù
(
MISCREG_TSTATE
) !=

245 
sh¬ed_d©a
->
t¡©e
[
i
-1])

246 
diffT¡©e
 = 
Œue
;

247 ià(
	gth»ad
->
»adMiscRegNoEfãù
(
MISCREG_TT
) !=

248 
sh¬ed_d©a
->
‰
[
i
-1])

249 
diffTt
 = 
Œue
;

250 ià(
	gth»ad
->
»adMiscRegNoEfãù
(
MISCREG_HTSTATE
) !=

251 
sh¬ed_d©a
->
ht¡©e
[
i
-1])

252 
diffHt¡©e
 = 
Œue
;

254 
	gth»ad
->
£tMiscRegNoEfãù
(
MISCREG_TL
, 
ŞdTl
);

256 if(
	gsh¬ed_d©a
->
	gtba
 !ğ
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_TBA
))

257 
diffTba
 = 
Œue
;

264 if((
	gsh¬ed_d©a
->
	ghp¡©e
 | (1 << 11)) !=

265 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_HPSTATE
))

266 
diffHp¡©e
 = 
Œue
;

267 if(
	gsh¬ed_d©a
->
	ghtba
 !=

268 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_HTBA
))

269 
diffHtba
 = 
Œue
;

270 if(
	gsh¬ed_d©a
->
	gp¡©e
 !=

271 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_PSTATE
))

272 
diffP¡©e
 = 
Œue
;

275 if(
	gsh¬ed_d©a
->
	gy
 !=

276 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 1))

277 
diffY
 = 
Œue
;

278 if(
	gsh¬ed_d©a
->
	gf¤
 !=

279 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_FSR
)) {

280 
diffF¤
 = 
Œue
;

281 ià(
mb™s
(
sh¬ed_d©a
->
f¤
, 63,10) ==

282 
mb™s
(
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_FSR
),

284 
	gth»ad
->
£tMiscRegNoEfãù
(
MISCREG_FSR
,

285 
sh¬ed_d©a
->
f¤
);

286 
	gdiffF¤
 = 
çl£
;

291 if(
	gsh¬ed_d©a
->
	gcü
 !=

292 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 2))

293 
diffCü
 = 
Œue
;

294 if(
	gsh¬ed_d©a
->
	ggl
 !=

295 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_GL
))

296 
diffGl
 = 
Œue
;

297 if(
	gsh¬ed_d©a
->
	gasi
 !=

298 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_ASI
))

299 
diffAsi
 = 
Œue
;

300 if(
	gsh¬ed_d©a
->
	gp
 !=

301 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_PIL
))

302 
diffP
 = 
Œue
;

303 if(
	gsh¬ed_d©a
->
	gcwp
 !=

304 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_CWP
))

305 
diffCwp
 = 
Œue
;

308 if(
	gsh¬ed_d©a
->
	gÿn§ve
 !=

309 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 3))

310 
diffCª§ve
 = 
Œue
;

313 if(
	gsh¬ed_d©a
->
	gÿÄe¡Üe
 !=

314 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 4))

315 
diffCª»¡Üe
 = 
Œue
;

318 if(
	gsh¬ed_d©a
->
	gÙh”wš
 !=

319 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 6))

320 
diffOth”wš
 = 
Œue
;

323 if(
	gsh¬ed_d©a
->
	gş—nwš
 !=

324 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 5))

325 
diffCËªwš
 = 
Œue
;

327 
	gi
 = 0; i < 64; i++) {

328 ià(
	gsh¬ed_d©a
->
	g™b
[
i
] !=

329 
th»ad
->
g‘ITBPŒ
()->
T‹R—d
(
i
))

330 
diffTlb
 = 
Œue
;

331 ià(
	gsh¬ed_d©a
->
	gdtb
[
i
] !=

332 
th»ad
->
g‘DTBPŒ
()->
T‹R—d
(
i
))

333 
diffTlb
 = 
Œue
;

336 ià(
	gdiffPC
 || 
	gdiffCC
 || 
	gdiffIn¡
 ||

337 
	gdiffIÁRegs
 || 
	gdiffFpRegs
 ||

338 
	gdiffTpc
 || 
	gdiffTÅc
 || 
	gdiffT¡©e
 || 
	gdiffTt
 ||

339 
	gdiffHp¡©e
 || 
	gdiffHt¡©e
 || 
	gdiffHtba
 ||

340 
	gdiffP¡©e
 || 
	gdiffY
 || 
	gdiffCü
 || 
	gdiffTl
 || 
	gdiffF¤
 ||

341 
	gdiffGl
 || 
	gdiffAsi
 || 
	gdiffP
 || 
	gdiffCwp
 ||

342 
	gdiffCª§ve
 || 
	gdiffCª»¡Üe
 ||

343 
	gdiffOth”wš
 || 
	gdiffCËªwš
 || 
	gdiffTlb
) {

345 
	gouts
 << "Differences found between M5‡nd Legion:";

346 ià(
	gdiffPC
)

347 
	gouts
 << " [PC]";

348 ià(
	gdiffCC
)

349 
	gouts
 << " [CC]";

350 ià(
	gdiffIn¡
)

351 
	gouts
 << " [Instruction]";

352 ià(
	gdiffIÁRegs
)

353 
	gouts
 << " [IntRegs]";

354 ià(
	gdiffFpRegs
)

355 
	gouts
 << " [FpRegs]";

356 ià(
	gdiffTpc
)

357 
	gouts
 << " [Tpc]";

358 ià(
	gdiffTÅc
)

359 
	gouts
 << " [Tnpc]";

360 ià(
	gdiffT¡©e
)

361 
	gouts
 << " [Tstate]";

362 ià(
	gdiffTt
)

363 
	gouts
 << " [Tt]";

364 ià(
	gdiffHp¡©e
)

365 
	gouts
 << " [Hpstate]";

366 ià(
	gdiffHt¡©e
)

367 
	gouts
 << " [Htstate]";

368 ià(
	gdiffHtba
)

369 
	gouts
 << " [Htba]";

370 ià(
	gdiffP¡©e
)

371 
	gouts
 << " [Pstate]";

372 ià(
	gdiffY
)

373 
	gouts
 << " [Y]";

374 ià(
	gdiffF¤
)

375 
	gouts
 << " [FSR]";

376 ià(
	gdiffCü
)

377 
	gouts
 << " [Ccr]";

378 ià(
	gdiffTl
)

379 
	gouts
 << " [Tl]";

380 ià(
	gdiffGl
)

381 
	gouts
 << " [Gl]";

382 ià(
	gdiffAsi
)

383 
	gouts
 << " [Asi]";

384 ià(
	gdiffP
)

385 
	gouts
 << " [Pil]";

386 ià(
	gdiffCwp
)

387 
	gouts
 << " [Cwp]";

388 ià(
	gdiffCª§ve
)

389 
	gouts
 << " [Cansave]";

390 ià(
	gdiffCª»¡Üe
)

391 
	gouts
 << " [Canrestore]";

392 ià(
	gdiffOth”wš
)

393 
	gouts
 << " [Otherwin]";

394 ià(
	gdiffCËªwš
)

395 
	gouts
 << " [Cleanwin]";

396 ià(
	gdiffTlb
)

397 
	gouts
 << " [Tlb]";

398 
	gouts
 << 
	g’dl
 <<ƒndl;

400 
	gouts
 << 
	gright
 << 
£tfl
(' 'è<< 
£tw
(15)

401 << "M5 PC: " << "0x"<< 
£tw
(16è<< 
£tfl
('0')

402 << 
	ghex
 << 
	gm5Pc
 << 
	g’dl
;

403 
	gouts
 << 
£tfl
(' 'è<< 
£tw
(15)

405 << 
£tw
(16è<< 
£tfl
('0'è<< 
	ghex


406 << 
	glgnPc
 << 
	g’dl
 <<ƒndl;

408 
	gouts
 << 
	gright
 << 
£tfl
(' 'è<< 
£tw
(15)

410 << 
£tw
(16è<< 
£tfl
('0'è<< 
	ghex


411 << 
	gth»ad
->
g‘CpuPŒ
()->
š¡CouÁ
(è<< 
	g’dl
;

412 
	gouts
 << 
£tfl
(' 'è<< 
£tw
(15)

414 << 
£tw
(16è<< 
£tfl
('0'è<< 
	ghex


415 << 
	gsh¬ed_d©a
->
	gcyşe_couÁ
 << 
	g’dl
 <<ƒndl;

417 
	gouts
 << 
£tfl
(' 'è<< 
£tw
(15)

419 << 
£tw
(8è<< 
£tfl
('0'è<< 
	ghex


420 << 
	g¡©icIn¡
->
	gmachIn¡


421 << 
	g¡©icIn¡
->
di§s£mbË
(
m5Pc
, 
debugSymbŞTabË
)

422 << 
	g’dl
;

424 
	gTheISA
::
Decod”
 *
decod”
 = 
th»ad
->
g‘Decod”PŒ
();

425 
	gdecod”
->
mÜeBy‹s
(
m5Pc
, m5Pc, 
sh¬ed_d©a
->
š¡ruùiÚ
);

427 
as£¹
(
decod”
->
š¡R—dy
());

429 
PCS‹
 
	g‹mpPC
 = 
pc
;

430 
SticIn¡PŒ
 
	gËgiÚIn¡
 = 
decod”
->
decode
(
‹mpPC
);

431 
	gouts
 << 
£tfl
(' 'è<< 
£tw
(15)

433 << "0x" << 
£tw
(8è<< 
£tfl
('0'è<< 
	ghex


434 << 
	gsh¬ed_d©a
->
	gš¡ruùiÚ


435 << 
	gËgiÚIn¡
->
di§s£mbË
(
lgnPc
, 
debugSymbŞTabË
)

436 << 
	g’dl
 <<ƒndl;

438 
´štSeùiÚH—d”
(
outs
, "General State");

439 
´štCŞumnLab–s
(
outs
);

440 
´štRegPaœ
(
outs
, "HPstate",

441 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_HPSTATE
),

442 
sh¬ed_d©a
->
hp¡©e
 | (1 << 11));

443 
´štRegPaœ
(
outs
, "Htba",

444 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_HTBA
),

445 
sh¬ed_d©a
->
htba
);

446 
´štRegPaœ
(
outs
, "Pstate",

447 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_PSTATE
),

448 
sh¬ed_d©a
->
p¡©e
);

449 
´štRegPaœ
(
outs
, "Y",

451 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 1),

452 
sh¬ed_d©a
->
y
);

453 
´štRegPaœ
(
outs
, "FSR",

454 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_FSR
),

455 
sh¬ed_d©a
->
f¤
);

456 
´štRegPaœ
(
outs
, "Ccr",

458 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 2),

459 
sh¬ed_d©a
->
cü
);

460 
´štRegPaœ
(
outs
, "Tl",

461 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_TL
),

462 
sh¬ed_d©a
->

);

463 
´štRegPaœ
(
outs
, "Gl",

464 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_GL
),

465 
sh¬ed_d©a
->
gl
);

466 
´štRegPaœ
(
outs
, "Asi",

467 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_ASI
),

468 
sh¬ed_d©a
->
asi
);

469 
´štRegPaœ
(
outs
, "Pil",

470 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_PIL
),

471 
sh¬ed_d©a
->
p
);

472 
´štRegPaœ
(
outs
, "Cwp",

473 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_CWP
),

474 
sh¬ed_d©a
->
cwp
);

475 
´štRegPaœ
(
outs
, "Cansave",

477 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 3),

478 
sh¬ed_d©a
->
ÿn§ve
);

479 
´štRegPaœ
(
outs
, "Canrestore",

481 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 4),

482 
sh¬ed_d©a
->
ÿÄe¡Üe
);

483 
´štRegPaœ
(
outs
, "Otherwin",

485 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 6),

486 
sh¬ed_d©a
->
Ùh”wš
);

487 
´štRegPaœ
(
outs
, "Cleanwin",

489 
th»ad
->
»adIÁReg
(
NumIÁArchRegs
 + 5),

490 
sh¬ed_d©a
->
ş—nwš
);

491 
	gouts
 << 
	g’dl
;

492 
	gi
 = 1; i <ğ
MaxTL
; i++) {

493 
´štLev–H—d”
(
outs
, 
i
);

494 
´štCŞumnLab–s
(
outs
);

495 
	gth»ad
->
£tMiscRegNoEfãù
(
MISCREG_TL
, 
i
);

496 
´štRegPaœ
(
outs
, "Tpc",

497 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_TPC
),

498 
sh¬ed_d©a
->
c
[
i
-1]);

499 
´štRegPaœ
(
outs
, "Tnpc",

500 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_TNPC
),

501 
sh¬ed_d©a
->
Špc
[
i
-1]);

502 
´štRegPaœ
(
outs
, "Tstate",

503 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_TSTATE
),

504 
sh¬ed_d©a
->
t¡©e
[
i
-1]);

505 
´štRegPaœ
(
outs
, "Tt",

506 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_TT
),

507 
sh¬ed_d©a
->
‰
[
i
-1]);

508 
´štRegPaœ
(
outs
, "Htstate",

509 
th»ad
->
»adMiscRegNoEfãù
(
MISCREG_HTSTATE
),

510 
sh¬ed_d©a
->
ht¡©e
[
i
-1]);

512 
	gth»ad
->
£tMiscRegNoEfãù
(
MISCREG_TL
, 
ŞdTl
);

513 
	gouts
 << 
	g’dl
;

515 
´štSeùiÚH—d”
(
outs
, "General Purpose Registers");

516 cÚ¡ * 
	g»gty³s
[4] =

518 
	gy
 = 0; y < 4; y++) {

519 
	gx
 = 0; x < 8; x++) {

520 
	gÏb–
[8];

521 
¥rštf
(
Ïb–
, "%s%d", 
»gty³s
[
y
], 
x
);

522 
´štRegPaœ
(
outs
, 
Ïb–
,

523 
th»ad
->
»adIÁReg
(
y
*8+
x
),

524 
sh¬ed_d©a
->
šŒegs
[
y
*8+
x
]);

527 ià(
	gdiffFpRegs
) {

528 
	gx
 = 0; x < 32; x++) {

529 
	gÏb–
[8];

530 
¥rštf
(
Ïb–
, "%%f%d", 
x
);

531 
´štRegPaœ
(
outs
, 
Ïb–
,

532 
th»ad
->
»adFlßtRegB™s
(
x
*2),

533 
sh¬ed_d©a
->
å»gs
[
x
]);

536 ià(
	gdiffTlb
) {

537 
´štCŞumnLab–s
(
outs
);

538 
	gÏb–
[9];

539 
	gx
 = 0; x < 64; x++) {

540 ià(
	gsh¬ed_d©a
->
	g™b
[
x
] !=

541 
ULL
(0xFFFFFFFFFFFFFFFF) ||

542 
th»ad
->
g‘ITBPŒ
()->
T‹R—d
(
x
) !=

543 
ULL
(0xFFFFFFFFFFFFFFFF)) {

544 
¥rštf
(
Ïb–
, "I-TLB:%02d", 
x
);

545 
´štRegPaœ
(
outs
, 
Ïb–
,

546 
th»ad
->
g‘ITBPŒ
()->
T‹R—d
(
x
),

547 
sh¬ed_d©a
->
™b
[
x
]);

550 
	gx
 = 0; x < 64; x++) {

551 ià(
	gsh¬ed_d©a
->
	gdtb
[
x
] !=

552 
ULL
(0xFFFFFFFFFFFFFFFF) ||

553 
th»ad
->
g‘DTBPŒ
()->
T‹R—d
(
x
) !=

554 
ULL
(0xFFFFFFFFFFFFFFFF)) {

555 
¥rštf
(
Ïb–
, "D-TLB:%02d", 
x
);

556 
´štRegPaœ
(
outs
, 
Ïb–
,

557 
th»ad
->
g‘DTBPŒ
()->
T‹R—d
(
x
),

558 
sh¬ed_d©a
->
dtb
[
x
]);

561 
	gth»ad
->
g‘ITBPŒ
()->
dumpAÎ
();

562 
	gth»ad
->
g‘DTBPŒ
()->
dumpAÎ
();

565 
	gdiffcouÁ
++;

566 ià(
	gdiffcouÁ
 > 3)

567 
çl
("Differences found between Legion‡nd M5\n");

569 
	gdiffcouÁ
 = 0;

571 
	gcom·»d
 = 
Œue
;

572 
	gsh¬ed_d©a
->
	gæags
 = 
OWN_LEGION
;

584 
	gT¿û
::
LegiÚT¿û
 *

585 
LegiÚT¿ûP¬ams
::
	$ü—‹
()

587 ià(!
FuÎSy¡em
)

588 
	`·nic
("Legionracing only works in full system!");

589  
Ãw
 
T¿û
::
	`LegiÚT¿û
(
this
);

590 
	}
};

	@legiontrace.hh

32 #iâdeà
__CPU_LEGIONTRACE_HH__


33 
	#__CPU_LEGIONTRACE_HH__


	)

35 
	~"ba£/Œaû.hh
"

36 
	~"ba£/ty³s.hh
"

37 
	~"ıu/¡©ic_š¡.hh
"

38 
	~"·¿ms/LegiÚT¿û.hh
"

39 
	~"sim/š¡Œaûr.hh
"

41 
şass
 
	gTh»adCÚ‹xt
;

43 
Çme¥aû
 
	gT¿û
 {

45 
£tupSh¬edD©a
();

47 şas 
	cLegiÚT¿ûRecÜd
 : 
public
 
In¡RecÜd


49 
public
:

50 
LegiÚT¿ûRecÜd
(
Tick
 
_wh’
, 
Th»adCÚ‹xt
 *
_th»ad
,

51 cÚ¡ 
SticIn¡PŒ
 
_¡©icIn¡
, 
TheISA
::
PCS‹
 
_pc
,

52 
boŞ
 
¥ec
, cÚ¡ 
SticIn¡PŒ
 
_maüoSticIn¡
 = 
NULL
)

53 : 
In¡RecÜd
(
_wh’
, 
_th»ad
, 
_¡©icIn¡
, 
_pc
, 
¥ec
,

54 
_maüoSticIn¡
)

58 
dump
();

61 şas 
	cLegiÚT¿û
 : 
public
 
In¡T¿ûr


63 
public
:

64 
LegiÚT¿ûP¬ams
 
	tP¬ams
;

65 
LegiÚT¿û
(cÚ¡ 
P¬ams
 *
p
è: 
In¡T¿ûr
(p)

68 
LegiÚT¿ûRecÜd
 *

69 
g‘In¡RecÜd
(
Tick
 
wh’
, 
Th»adCÚ‹xt
 *
tc
,

70 cÚ¡ 
SticIn¡PŒ
 
¡©icIn¡
, 
TheISA
::
PCS‹
 
pc
,

71 cÚ¡ 
SticIn¡PŒ
 
maüoSticIn¡
 = 
NULL
)

73 ià(
tc
->
mis¥ecuÏtšg
())

74  
NULL
;

76  
Ãw
 
LegiÚT¿ûRecÜd
(
wh’
, 
tc
,

77 
¡©icIn¡
, 
pc
, 
tc
->
mis¥ecuÏtšg
(), 
maüoSticIn¡
);

	@m5legion_interface.h

31 
	~<uni¡d.h
>

33 
	#VERSION
 0xA1000009

	)

34 
	#OWN_M5
 0x000000AA

	)

35 
	#OWN_LEGION
 0x00000055

	)

40 
ušt32_t
 
	mæags
;

41 
ušt32_t
 
	mv”siÚ
;

43 
ušt64_t
 
	mpc
;

44 
ušt64_t
 
	mÃw_pc
;

45 
ušt64_t
 
	mcyşe_couÁ
;

46 
ušt64_t
 
	mÃw_cyşe_couÁ
;

47 
ušt32_t
 
	mš¡ruùiÚ
;

48 
ušt32_t
 
	mÃw_š¡ruùiÚ
;

49 
ušt64_t
 
	mšŒegs
[32];

50 
ušt64_t
 
	må»gs
[32];

52 
ušt64_t
 
	mc
[8];

53 
ušt64_t
 
	mŠpc
[8];

54 
ušt64_t
 
	mt¡©e
[8];

55 
ušt16_t
 
	m‰
[8];

56 
ušt64_t
 
	mtba
;

58 
ušt64_t
 
	mhp¡©e
;

59 
ušt64_t
 
	mht¡©e
[8];

60 
ušt64_t
 
	mhtba
;

61 
ušt16_t
 
	mp¡©e
;

63 
ušt64_t
 
	my
;

64 
ušt64_t
 
	mf¤
;

65 
ušt8_t
 
	mcü
;

66 
ušt8_t
 
	m
;

67 
ušt8_t
 
	mgl
;

68 
ušt8_t
 
	masi
;

69 
ušt8_t
 
	mp
;

71 
ušt8_t
 
	mcwp
;

72 
ušt8_t
 
	mÿn§ve
;

73 
ušt8_t
 
	mÿÄe¡Üe
;

74 
ušt8_t
 
	mÙh”wš
;

75 
ušt8_t
 
	mş—nwš
;

77 
ušt64_t
 
	m™b
[64];

78 
ušt64_t
 
	mdtb
[64];

80 } 
	tSh¬edD©a
;

	@nativetrace.cc

31 
	~"ba£/sock‘.hh
"

32 
	~"ıu/Çtiv‘¿û.hh
"

33 
	~"ıu/¡©ic_š¡.hh
"

34 
	~"debug/GDBMisc.hh
"

35 
	~"·¿ms/N©iveT¿û.hh
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 
Çme¥aû
 
	gT¿û
 {

41 
	gN©iveT¿û
::
N©iveT¿û
(cÚ¡ 
P¬ams
 *
p
)

42 : 
ExeT¿ûr
(
p
)

44 ià(
Li¡’Sock‘
::
®lDi§bËd
())

45 
çl
("All†isteners‡re disabled!");

47 
	gpÜt
 = 8000;

48 !
	gÇtive_li¡’”
.
li¡’
(
pÜt
, 
Œue
))

50 
DPRINTF
(
GDBMisc
, "Cª'ˆbšd…Üˆ%d\n", 
pÜt
);

51 
	gpÜt
++;

53 
cırštf
(
û¼
, "Li¡’šg fÜ‚©iv´oûs Ú…Üˆ%d\n", 
pÜt
);

54 
	gfd
 = 
Çtive_li¡’”
.
acû±
();

58 
	gT¿û
::
N©iveT¿ûRecÜd
::
dump
()

62 ià(!
¡©icIn¡
->
isMiüoİ
(è|| sticIn¡->
isLa¡Miüoİ
())

63 
·»Á
->
check
(
this
);

	@nativetrace.hh

31 #iâdeà
__CPU_NATIVETRACE_HH__


32 
	#__CPU_NATIVETRACE_HH__


	)

34 
	~<uni¡d.h
>

36 
	~<û¼no
>

38 
	~"ba£/sock‘.hh
"

39 
	~"ba£/Œaû.hh
"

40 
	~"ba£/ty³s.hh
"

41 
	~"ıu/ex‘¿û.hh
"

42 
	~"ıu/¡©ic_š¡.hh
"

44 
şass
 
	gTh»adCÚ‹xt
;

46 
Çme¥aû
 
	gT¿û
 {

48 
şass
 
	gN©iveT¿û
;

50 şas 
	cN©iveT¿ûRecÜd
 : 
public
 
ExeT¿ûrRecÜd


52 
´Ùeùed
:

53 
N©iveT¿û
 * 
·»Á
;

55 
	gpublic
:

56 
N©iveT¿ûRecÜd
(
N©iveT¿û
 * 
_·»Á
,

57 
Tick
 
_wh’
, 
Th»adCÚ‹xt
 *
_th»ad
,

58 cÚ¡ 
SticIn¡PŒ
 
_¡©icIn¡
, 
TheISA
::
PCS‹
 
_pc
,

59 
boŞ
 
¥ec
, cÚ¡ 
SticIn¡PŒ
 
_maüoSticIn¡
 = 
NULL
)

60 : 
ExeT¿ûrRecÜd
(
_wh’
, 
_th»ad
, 
_¡©icIn¡
, 
_pc
, 
¥ec
,

61 
_maüoSticIn¡
),

62 
·»Á
(
_·»Á
)

66 
dump
();

69 şas 
	cN©iveT¿û
 : 
public
 
ExeT¿ûr


71 
´Ùeùed
:

72 
fd
;

74 
Li¡’Sock‘
 
	gÇtive_li¡’”
;

76 
	gpublic
:

78 
N©iveT¿û
(cÚ¡ 
P¬ams
 *
p
);

79 
	gvœtu®
 ~
N©iveT¿û
() {}

81 
N©iveT¿ûRecÜd
 *

82 
g‘In¡RecÜd
(
Tick
 
wh’
, 
Th»adCÚ‹xt
 *
tc
,

83 cÚ¡ 
SticIn¡PŒ
 
¡©icIn¡
, 
TheISA
::
PCS‹
 
pc
,

84 cÚ¡ 
SticIn¡PŒ
 
maüoSticIn¡
 = 
NULL
)

86 ià(
tc
->
mis¥ecuÏtšg
())

87  
NULL
;

89  
Ãw
 
N©iveT¿ûRecÜd
(
this
, 
wh’
, 
tc
,

90 
¡©icIn¡
, 
pc
, 
tc
->
mis¥ecuÏtšg
(), 
maüoSticIn¡
);

93 
	g‹m¶©e
<
şass
 
	gT
>

94 
boŞ


95 
checkReg
(cÚ¡ * 
»gName
, 
T
 &
v®
, T &
»®V®
)

97 if(
	gv®
 !ğ
»®V®
)

99 
DPRINTFN
("Register %s should be %#x but is %#x.\n",

100 
»gName
, 
»®V®
, 
v®
);

101  
	gçl£
;

103  
	gŒue
;

107 
»ad
(*
±r
, 
size_t
 
size
)

109 
size_t
 
	gsoF¬
 = 0;

110 
	gsoF¬
 < 
	gsize
) {

111 
ssize_t
 
	g»s
 = ::
»ad
(
fd
, (
ušt8_t
 *)
±r
 + 
soF¬
, 
size
 - soFar);

112 ià(
	g»s
 < 0)

113 
·nic
("R—d c®Èçed! %s\n", 
¡»¼Ü
(
”ºo
));

115 
	gsoF¬
 +ğ
»s
;

119 
vœtu®
 

120 
check
(
N©iveT¿ûRecÜd
 *
»cÜd
) = 0;

	@o3/base_dyn_inst.cc

31 
	~"ıu/o3/ıu.hh
"

32 
	~"ıu/o3/i§_¥ecific.hh
"

33 
	~"ıu/ba£_dyn_š¡_im¶.hh
"

36 
‹m¶©e
 
şass
 
	gBa£DynIn¡
<
	gO3CPUIm¶
>;

	@o3/checker.cc

43 
	~"ıu/check”/ıu_im¶.hh
"

44 
	~"ıu/o3/check”.hh
"

45 
	~"·¿ms/O3Check”.hh
"

47 
şass
 
	gMemObjeù
;

49 
‹m¶©e


50 
şass
 
	gCheck”
<
	gO3CPUIm¶
>;

56 
O3Check”
 *

57 
	gO3Check”P¬ams
::
	$ü—‹
()

59 
O3Check”
::
P¬ams
 *
·¿ms
 = 
Ãw
 O3Check”::
	`P¬ams
();

60 
·¿ms
->
Çme
 =‚ame;

61 
·¿ms
->
numTh»ads
 =‚umThreads;

62 
·¿ms
->
max_š¡s_ªy_th»ad
 = 0;

63 
·¿ms
->
max_š¡s_®l_th»ads
 = 0;

64 
·¿ms
->
max_lßds_ªy_th»ad
 = 0;

65 
·¿ms
->
max_lßds_®l_th»ads
 = 0;

66 
·¿ms
->
ex™OnE¼Ü
 =ƒxitOnError;

67 
·¿ms
->
upd©eOnE¼Ü
 = updateOnError;

68 
·¿ms
->
w¬nOÆyOnLßdE¼Ü
 = warnOnlyOnLoadError;

69 
·¿ms
->
şk_domaš
 = clk_domain;

70 
·¿ms
->
Œaûr
 =racer;

73 
CouÁ”
 
‹mp
;

74 
‹mp
 = 
max_š¡s_ªy_th»ad
;

75 
‹mp
 = 
max_š¡s_®l_th»ads
;

76 
‹mp
 = 
max_lßds_ªy_th»ad
;

77 
‹mp
 = 
max_lßds_®l_th»ads
;

78 
‹mp
++;

79 
Tick
 
‹mp2
 = 
´og»ss_š‹rv®
;

80 
·¿ms
->
´og»ss_š‹rv®
 = 0;

81 
‹mp2
++;

83 
·¿ms
->
™b
 = itb;

84 
·¿ms
->
dtb
 = dtb;

85 
·¿ms
->
i§
 = isa;

86 
·¿ms
->
sy¡em
 = system;

87 
·¿ms
->
ıu_id
 = cpu_id;

88 
·¿ms
->
´ofe
 =…rofile;

89 
·¿ms
->
š‹¼u±s
 = 
NULL
;

90 
·¿ms
->
wÜklßd
 = workload;

92 
O3Check”
 *
ıu
 = 
Ãw
 
	`O3Check”
(
·¿ms
);

93  
ıu
;

94 
	}
}

	@o3/checker.hh

43 #iâdeà
__CPU_O3_CHECKER_HH__


44 
	#__CPU_O3_CHECKER_HH__


	)

46 
	~"ıu/check”/ıu.hh
"

47 
	~"ıu/o3/dyn_š¡.hh
"

48 
	~"ıu/o3/im¶.hh
"

53 
şass
 
	gO3Check”
 : 
public
 
Check”
<
O3CPUIm¶
>

55 
public
:

56 
O3Check”
(
P¬ams
 *
p
)

57 : 
Check”
<
O3CPUIm¶
>(
p
)

	@o3/comm.hh

43 #iâdeà
__CPU_O3_COMM_HH__


44 
	#__CPU_O3_COMM_HH__


	)

46 
	~<veùÜ
>

48 
	~"¬ch/ty³s.hh
"

49 
	~"ba£/ty³s.hh
"

50 
	~"ıu/š¡_£q.hh
"

51 
	~"sim/çuÉs.hh
"

56 
	tPhysRegIndex
;

59 
	g‹m¶©e
<
şass
 
	gIm¶
>

60 
	sDeçuÉF‘chDeçuÉDecode
 {

61 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

63 
	msize
;

65 
DynIn¡PŒ
 
	mš¡s
[
Im¶
::
MaxWidth
];

66 
FauÉ
 
	mãtchFauÉ
;

67 
In¡SeqNum
 
	mãtchFauÉSN
;

68 
boŞ
 
	mş—rF‘chFauÉ
;

72 
	g‹m¶©e
<
şass
 
	gIm¶
>

73 
	sDeçuÉDecodeDeçuÉR’ame
 {

74 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

76 
	msize
;

78 
DynIn¡PŒ
 
	mš¡s
[
Im¶
::
MaxWidth
];

82 
	g‹m¶©e
<
şass
 
	gIm¶
>

83 
	sDeçuÉR’ameDeçuÉIEW
 {

84 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

86 
	msize
;

88 
DynIn¡PŒ
 
	mš¡s
[
Im¶
::
MaxWidth
];

92 
	g‹m¶©e
<
şass
 
	gIm¶
>

93 
	sDeçuÉIEWDeçuÉComm™
 {

94 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

96 
	msize
;

98 
DynIn¡PŒ
 
	mš¡s
[
Im¶
::
MaxWidth
];

99 
DynIn¡PŒ
 
	mmi¥»diùIn¡
[
Im¶
::
MaxTh»ads
];

100 
Addr
 
	mmi¥»dPC
[
Im¶
::
MaxTh»ads
];

101 
In¡SeqNum
 
	msquashedSeqNum
[
Im¶
::
MaxTh»ads
];

102 
	mTheISA
::
PCS‹
 
pc
[
Im¶
::
MaxTh»ads
];

104 
boŞ
 
	msquash
[
Im¶
::
MaxTh»ads
];

105 
boŞ
 
	mb¿nchMi¥»diù
[
Im¶
::
MaxTh»ads
];

106 
boŞ
 
	mb¿nchTak’
[
Im¶
::
MaxTh»ads
];

107 
boŞ
 
	mšşudeSquashIn¡
[
Im¶
::
MaxTh»ads
];

110 
	g‹m¶©e
<
şass
 
	gIm¶
>

111 
	sIssueSŒuù
 {

112 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

114 
	msize
;

116 
DynIn¡PŒ
 
	mš¡s
[
Im¶
::
MaxWidth
];

120 
	g‹m¶©e
<
şass
 
	gIm¶
>

121 
	sTimeBufSŒuù
 {

122 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

123 
	sdecodeComm
 {

124 
	mTheISA
::
PCS‹
 
ÃxtPC
;

125 
DynIn¡PŒ
 
	mmi¥»diùIn¡
;

126 
DynIn¡PŒ
 
	msquashIn¡
;

127 
In¡SeqNum
 
	mdÚeSeqNum
;

128 
Addr
 
	mmi¥»dPC
;

129 
ušt64_t
 
	mb¿nchAddr
;

130 
	mb¿nchCouÁ
;

131 
boŞ
 
	msquash
;

132 
boŞ
 
	m´edIncÜ»ù
;

133 
boŞ
 
	mb¿nchMi¥»diù
;

134 
boŞ
 
	mb¿nchTak’
;

137 
decodeComm
 
	mdecodeInfo
[
Im¶
::
MaxTh»ads
];

139 
	s»ÇmeComm
 {

142 
»ÇmeComm
 
	m»ÇmeInfo
[
Im¶
::
MaxTh»ads
];

144 
	s›wComm
 {

146 
	mä“IQEÁr›s
;

147 
	mä“LSQEÁr›s
;

149 
	miqCouÁ
;

150 
	mld¡qCouÁ
;

152 
	mdi¥©ched
;

153 
	mdi¥©chedToLSQ
;

154 
boŞ
 
	mu£dIQ
;

155 
boŞ
 
	mu£dLSQ
;

158 
›wComm
 
	m›wInfo
[
Im¶
::
MaxTh»ads
];

160 
	scomm™Comm
 {

176 
	mTheISA
::
PCS‹
 
pc
;

180 
DynIn¡PŒ
 
	mmi¥»diùIn¡
;

183 
DynIn¡PŒ
 
	msquashIn¡
;

186 
DynIn¡PŒ
 
	munÿchedLßd
;

190 
In¡SeqNum
 
	mnÚS³cSeqNum
;

195 
In¡SeqNum
 
	mdÚeSeqNum
;

198 
	mä“ROBEÁr›s
;

200 
boŞ
 
	msquash
;

201 
boŞ
 
	mrobSquashšg
;

204 
boŞ
 
	mu£dROB
;

207 
boŞ
 
	mem±yROB
;

210 
boŞ
 
	mb¿nchTak’
;

212 
boŞ
 
	mš‹¼u±P’dšg
;

214 
boŞ
 
	mş—rIÁ”ru±
;

217 
boŞ
 
	munÿched
;

221 
comm™Comm
 
	mcomm™Info
[
Im¶
::
MaxTh»ads
];

223 
boŞ
 
	mdecodeBlock
[
Im¶
::
MaxTh»ads
];

224 
boŞ
 
	mdecodeUnblock
[
Im¶
::
MaxTh»ads
];

225 
boŞ
 
	m»ÇmeBlock
[
Im¶
::
MaxTh»ads
];

226 
boŞ
 
	m»ÇmeUnblock
[
Im¶
::
MaxTh»ads
];

227 
boŞ
 
	m›wBlock
[
Im¶
::
MaxTh»ads
];

228 
boŞ
 
	m›wUnblock
[
Im¶
::
MaxTh»ads
];

229 
boŞ
 
	mcomm™Block
[
Im¶
::
MaxTh»ads
];

230 
boŞ
 
	mcomm™Unblock
[
Im¶
::
MaxTh»ads
];

	@o3/commit.cc

31 
	~"ıu/o3/comm™_im¶.hh
"

32 
	~"ıu/o3/i§_¥ecific.hh
"

34 
‹m¶©e
 
şass
 
	gDeçuÉComm™
<
	gO3CPUIm¶
>;

	@o3/commit.hh

44 #iâdeà
__CPU_O3_COMMIT_HH__


45 
	#__CPU_O3_COMMIT_HH__


	)

47 
	~<queue
>

49 
	~"ba£/¡©i¡ics.hh
"

50 
	~"ıu/ex‘¿û.hh
"

51 
	~"ıu/š¡_£q.hh
"

52 
	~"ıu/timebuf.hh
"

54 
	gD”ivO3CPUP¬ams
;

56 
	g‹m¶©e
 <
	gşass
>

57 
	gO3Th»adS‹
;

81 
	g‹m¶©e
<
şass
 
	gIm¶
>

82 şas 
	cDeçuÉComm™


84 
	mpublic
:

86 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

87 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

88 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
 CPUPol;

90 
ty³Çme
 
	tCPUPŞ
::
	tR’ameM­
 RenameMap;

91 
ty³Çme
 
	tCPUPŞ
::
	tROB
 ROB;

93 
ty³Çme
 
	tCPUPŞ
::
	tTimeSŒuù
 TimeStruct;

94 
ty³Çme
 
	tCPUPŞ
::
	tF‘chSŒuù
 FetchStruct;

95 
ty³Çme
 
	tCPUPŞ
::
	tIEWSŒuù
 IEWStruct;

96 
ty³Çme
 
	tCPUPŞ
::
	tR’ameSŒuù
 RenameStruct;

98 
ty³Çme
 
	tCPUPŞ
::
	tF‘ch
 Fetch;

99 
ty³Çme
 
	tCPUPŞ
::
	tIEW
 IEW;

101 
	mO3Th»adS‹
<
	tIm¶
> 
	tTh»ad
;

106 şas 
	cT¿pEv’t
 : 
public
 
Ev’t
 {

107 
´iv©e
:

108 
DeçuÉComm™
<
Im¶
> *
comm™
;

109 
Th»adID
 
	mtid
;

111 
	mpublic
:

112 
T¿pEv’t
(
DeçuÉComm™
<
Im¶
> *
_comm™
, 
Th»adID
 
_tid
);

114 
´oûss
();

115 cÚ¡ *
desütiÚ
() const;

121 
	eComm™Stus
{

122 
	gAùive
,

123 
	gIÇùive


127 
	eTh»adStus
 {

128 
	gRuÂšg
,

129 
	gIdË
,

130 
	gROBSquashšg
,

131 
	gT¿pP’dšg
,

132 
	gF‘chT¿pP’dšg
,

133 
	gSquashAá”P’dšg
,

137 
	eComm™PŞicy
 {

138 
	gAgg»ssive
,

139 
	gRoundRobš
,

140 
	gOlde¡R—dy


143 
	g´iv©e
:

145 
Comm™Stus
 
_¡©us
;

147 
Comm™Stus
 
	g_ÃxtStus
;

149 
Th»adStus
 
	gcomm™Stus
[
Im¶
::
MaxTh»ads
];

151 
Comm™PŞicy
 
	gcomm™PŞicy
;

153 
	gpublic
:

155 
DeçuÉComm™
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
);

158 
	g¡d
::
¡ršg
 
	$Çme
() const;

161 
	`»gSts
();

164 
	`£tTh»ads
(
¡d
::
veùÜ
<
Th»ad
 *> &
th»ads
);

167 
	`£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
);

169 
	`£tF‘chQueue
(
TimeBufãr
<
F‘chSŒuù
> *
fq_±r
);

172 
	`£tR’ameQueue
(
TimeBufãr
<
R’ameSŒuù
> *
rq_±r
);

175 
	`£tIEWQueue
(
TimeBufãr
<
IEWSŒuù
> *
iq_±r
);

178 
	`£tIEWSge
(
IEW
 *
›w_¡age
);

181 
¡d
::
queue
<
DynIn¡PŒ
> 
skidBufãr
;

187 
IEW
 *
›wSge
;

190 
	`£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

193 
	`£tR’ameM­
(
R’ameM­
 
rm_±r
[
Im¶
::
MaxTh»ads
]);

196 
	`£tROB
(
ROB
 *
rob_±r
);

199 
	`¡¬tupSge
();

202 
	`d¿š
();

205 
	`d¿šResume
();

208 
	$d¿šSª™yCheck
() const;

211 
boŞ
 
	$isD¿šed
() const;

214 
	`keOv”From
();

217 
	`tick
();

222 
	`comm™
();

225 
size_t
 
	`numROBF»eEÁr›s
(
Th»adID
 
tid
);

228 
	`g’”©eT¿pEv’t
(
Th»adID
 
tid
);

233 
	`g’”©eTCEv’t
(
Th»adID
 
tid
);

235 
´iv©e
:

239 
	`upd©eStus
();

244 
	`£tNextStus
();

249 
boŞ
 
	`robDÚeSquashšg
();

255 
boŞ
 
	`chªgedROBEÁr›s
();

258 
	`squashAÎ
(
Th»adID
 
tid
);

261 
	`squashFromT¿p
(
Th»adID
 
tid
);

264 
	`squashFromTC
(
Th»adID
 
tid
);

267 
	`squashFromSquashAá”
(
Th»adID
 
tid
);

297 
	`squashAá”
(
Th»adID
 
tid
, 
DynIn¡PŒ
 &
h—d_š¡
);

300 
	`hªdËIÁ”ru±
();

303 
	`´İag©eIÁ”ru±
();

306 
	`comm™In¡s
();

311 
boŞ
 
	`comm™H—d
(
DynIn¡PŒ
 &
h—d_š¡
, 
š¡_num
);

314 
	`g‘In¡s
();

317 
	`skidIn£¹
();

320 
	`m¬kCom¶‘edIn¡s
();

323 
Th»adID
 
	`g‘Comm™tšgTh»ad
();

326 
Th»adID
 
	`roundRobš
();

329 
Th»adID
 
	`Şde¡R—dy
();

331 
public
:

333 
TheISA
::
PCS‹
 
	$pcS‹
(
Th»adID
 
tid
è{  
pc
[tid]; 
	}
}

336 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
, 
Th»adID
 
tid
)

337 { 
	gpc
[
tid
] = 
v®
; }

340 
Addr
 
	$š¡Addr
(
Th»adID
 
tid
è{  
pc
[tid].
	`š¡Addr
(); 
	}
}

343 
Addr
 
	$ÃxtIn¡Addr
(
Th»adID
 
tid
è{  
pc
[tid].
	`ÃxtIn¡Addr
(); 
	}
}

346 
Addr
 
	$miüoPC
(
Th»adID
 
tid
è{  
pc
[tid].
	`miüoPC
(); 
	}
}

348 
	g´iv©e
:

350 
TimeBufãr
<
TimeSŒuù
> *
timeBufãr
;

353 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
toIEW
;

356 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
robInfoFromIEW
;

358 
	gTimeBufãr
<
	gF‘chSŒuù
> *
	gãtchQueue
;

360 
ty³Çme
 
	gTimeBufãr
<
	gF‘chSŒuù
>::
wœe
 
äomF‘ch
;

363 
	gTimeBufãr
<
	gIEWSŒuù
> *
	g›wQueue
;

366 
ty³Çme
 
	gTimeBufãr
<
	gIEWSŒuù
>::
wœe
 
äomIEW
;

369 
	gTimeBufãr
<
	gR’ameSŒuù
> *
	g»ÇmeQueue
;

372 
ty³Çme
 
	gTimeBufãr
<
	gR’ameSŒuù
>::
wœe
 
äomR’ame
;

374 
	gpublic
:

376 
ROB
 *
rob
;

378 
	g´iv©e
:

380 
O3CPU
 *
ıu
;

383 
	g¡d
::
veùÜ
<
Th»ad
 *> 
th»ad
;

388 
boŞ
 
	gwrÙeToTimeBufãr
;

393 
boŞ
 
	gchªgedROBNumEÁr›s
[
Im¶
::
MaxTh»ads
];

396 
Th»adID
 
	gsquashCouÁ”
;

399 
boŞ
 
	gŒ­Squash
[
Im¶
::
MaxTh»ads
];

402 
boŞ
 
	gtcSquash
[
Im¶
::
MaxTh»ads
];

411 
DynIn¡PŒ
 
	gsquashAá”In¡
[
Im¶
::
MaxTh»ads
];

414 
	g¡d
::
li¡
<
Th»adID
> 
´iÜ™y_li¡
;

417 
Cyşes
 
	g›wToComm™D–ay
;

420 
Cyşes
 
	gcomm™ToIEWD–ay
;

423 
Cyşes
 
	g»ÇmeToROBD–ay
;

425 
Cyşes
 
	gãtchToComm™D–ay
;

430 
	g»ÇmeWidth
;

433 
	gcomm™Width
;

436 
	gnumRobs
;

439 
Th»adID
 
	gnumTh»ads
;

442 
boŞ
 
	gd¿šP’dšg
;

447 
Cyşes
 
	gŒ­L©’cy
;

450 
FauÉ
 
	gš‹¼u±
;

455 
	gTheISA
::
PCS‹
 
pc
[
Im¶
::
MaxTh»ads
];

458 
In¡SeqNum
 
	gyounge¡SeqNum
[
Im¶
::
MaxTh»ads
];

461 
In¡SeqNum
 
	gÏ¡Comm™edSeqNum
[
Im¶
::
MaxTh»ads
];

464 
boŞ
 
	gŒ­InFlight
[
Im¶
::
MaxTh»ads
];

467 
boŞ
 
	gcomm™‹dStÜes
[
Im¶
::
MaxTh»ads
];

471 
boŞ
 
	gcheckEm±yROB
[
Im¶
::
MaxTh»ads
];

474 
	g¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

477 
R’ameM­
 *
	g»ÇmeM­
[
Im¶
::
MaxTh»ads
];

480 
boŞ
 
	gÿnHªdËIÁ”ru±s
;

486 
boŞ
 
	gavoidQu›sûLiveLock
;

489 
upd©eComIn¡Sts
(
DynIn¡PŒ
 &
š¡
);

493 
	gSts
::
SÿÏr
 
comm™SquashedIn¡s
;

497 
	gSts
::
SÿÏr
 
comm™SquashEv’ts
;

501 
	gSts
::
SÿÏr
 
comm™NÚS³cSÎs
;

503 
	gSts
::
SÿÏr
 
b¿nchMi¥»diùs
;

505 
	gSts
::
Di¡ributiÚ
 
numComm™‹dDi¡
;

508 
	gSts
::
VeùÜ
 
š¡sComm™‹d
;

510 
	gSts
::
VeùÜ
 
İsComm™‹d
;

512 
	gSts
::
VeùÜ
 
¡©ComSwp
;

514 
	gSts
::
VeùÜ
 
¡©ComRefs
;

516 
	gSts
::
VeùÜ
 
¡©ComLßds
;

518 
	gSts
::
VeùÜ
 
¡©ComMemb¬s
;

520 
	gSts
::
VeùÜ
 
¡©ComB¿nches
;

522 
	gSts
::
VeùÜ
 
¡©ComFlßtšg
;

524 
	gSts
::
VeùÜ
 
¡©ComIÁeg”
;

526 
	gSts
::
VeùÜ
 
¡©ComFunùiÚC®ls
;

529 
	gSts
::
SÿÏr
 
comm™EligibËSam¶es
;

531 
	gSts
::
VeùÜ
 
comm™EligibË
;

	@o3/commit_impl.hh

43 #iâdeà
__CPU_O3_COMMIT_IMPL_HH__


44 
	#__CPU_O3_COMMIT_IMPL_HH__


	)

46 
	~<®gÜ™hm
>

47 
	~<£t
>

48 
	~<¡ršg
>

50 
	~"¬ch/ut™y.hh
"

51 
	~"ba£/lßd”/symb.hh
"

52 
	~"ba£/ı_ªnÙ©e.hh
"

53 
	~"cÚfig/the_i§.hh
"

54 
	~"ıu/check”/ıu.hh
"

55 
	~"ıu/o3/comm™.hh
"

56 
	~"ıu/o3/th»ad_¡©e.hh
"

57 
	~"ıu/ba£.hh
"

58 
	~"ıu/ex‘¿û.hh
"

59 
	~"ıu/timebuf.hh
"

60 
	~"debug/Aùiv™y.hh
"

61 
	~"debug/Comm™.hh
"

62 
	~"debug/Comm™R©e.hh
"

63 
	~"debug/D¿š.hh
"

64 
	~"debug/ExecFauÉšg.hh
"

65 
	~"debug/O3PeV›w.hh
"

66 
	~"·¿ms/D”ivO3CPU.hh
"

67 
	~"sim/çuÉs.hh
"

68 
	~"sim/fuÎ_sy¡em.hh
"

70 
usšg
 
Çme¥aû
 
	g¡d
;

72 
	g‹m¶©e
 <
şass
 
	gIm¶
>

73 
	gDeçuÉComm™
<
	gIm¶
>::
T¿pEv’t
::T¿pEv’t(
DeçuÉComm™
<
Im¶
> *
_comm™
,

74 
Th»adID
 
_tid
)

75 : 
Ev’t
(
CPU_Tick_Pri
, 
AutoD–‘e
), 
comm™
(
_comm™
), 
	$tid
(
_tid
)

77 
	}
}

79 
	g‹m¶©e
 <
şass
 
	gIm¶
>

81 
	gDeçuÉComm™
<
	gIm¶
>::
T¿pEv’t
::
	$´oûss
()

85 
comm™
->
Œ­Squash
[
tid
] = 
Œue
;

86 
	}
}

88 
	g‹m¶©e
 <
şass
 
	gIm¶
>

90 
	gDeçuÉComm™
<
	gIm¶
>::
T¿pEv’t
::
	$desütiÚ
() const

93 
	}
}

95 
	g‹m¶©e
 <
şass
 
	gIm¶
>

96 
	gDeçuÉComm™
<
	gIm¶
>::
	$DeçuÉComm™
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
)

97 : 
	`ıu
(
_ıu
),

98 
	`squashCouÁ”
(0),

99 
	`›wToComm™D–ay
(
·¿ms
->
›wToComm™D–ay
),

100 
	`comm™ToIEWD–ay
(
·¿ms
->
comm™ToIEWD–ay
),

101 
	`»ÇmeToROBD–ay
(
·¿ms
->
»ÇmeToROBD–ay
),

102 
	`ãtchToComm™D–ay
(
·¿ms
->
comm™ToF‘chD–ay
),

103 
	`»ÇmeWidth
(
·¿ms
->
»ÇmeWidth
),

104 
	`comm™Width
(
·¿ms
->
comm™Width
),

105 
	`numTh»ads
(
·¿ms
->
numTh»ads
),

106 
	`d¿šP’dšg
(
çl£
),

107 
	`Œ­L©’cy
(
·¿ms
->
Œ­L©’cy
),

108 
	`ÿnHªdËIÁ”ru±s
(
Œue
),

109 
	$avoidQu›sûLiveLock
(
çl£
)

111 
_¡©us
 = 
Aùive
;

112 
_ÃxtStus
 = 
IÇùive
;

113 
¡d
::
¡ršg
 
pŞicy
 = 
·¿ms
->
smtComm™PŞicy
;

116 
¡d
::
	`ŒªsfÜm
(
pŞicy
.
	`begš
(),…Şicy.
	`’d
(),…olicy.begin(),

117 ((*)()è
tŞow”
);

120 ià(
pŞicy
 == "aggressive"){

121 
comm™PŞicy
 = 
Agg»ssive
;

123 
	`DPRINTF
(
Comm™
,"Commit Policy seto Aggressive.\n");

124 } ià(
pŞicy
 == "roundrobin"){

125 
comm™PŞicy
 = 
RoundRobš
;

128 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

129 
´iÜ™y_li¡
.
	`push_back
(
tid
);

132 
	`DPRINTF
(
Comm™
,"Commit Policy seto Round Robin.\n");

133 } ià(
pŞicy
 == "oldestready"){

134 
comm™PŞicy
 = 
Olde¡R—dy
;

136 
	`DPRINTF
(
Comm™
,"Commit Policy seto Oldest Ready.");

138 
	`as£¹
(0 && "Invalid SMT Commit Policy. Options Are: {Aggressive,"

142 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

143 
comm™Stus
[
tid
] = 
IdË
;

144 
chªgedROBNumEÁr›s
[
tid
] = 
çl£
;

145 
checkEm±yROB
[
tid
] = 
çl£
;

146 
Œ­InFlight
[
tid
] = 
çl£
;

147 
comm™‹dStÜes
[
tid
] = 
çl£
;

148 
Œ­Squash
[
tid
] = 
çl£
;

149 
tcSquash
[
tid
] = 
çl£
;

150 
pc
[
tid
].
	`£t
(0);

151 
Ï¡Comm™edSeqNum
[
tid
] = 0;

152 
squashAá”In¡
[
tid
] = 
NULL
;

154 
š‹¼u±
 = 
NoFauÉ
;

155 
	}
}

157 
	g‹m¶©e
 <
şass
 
	gIm¶
>

158 
	g¡d
::
¡ršg


159 
DeçuÉComm™
<
Im¶
>::
	$Çme
() const

161  
ıu
->
	`Çme
() + ".commit";

162 
	}
}

164 
	g‹m¶©e
 <
şass
 
	gIm¶
>

166 
	gDeçuÉComm™
<
	gIm¶
>::
	$»gSts
()

168 
usšg
 
Çme¥aû
 
Sts
;

169 
comm™SquashedIn¡s


170 .
	`Çme
(name() + ".commitSquashedInsts")

171 .
	`desc
("The‚umber of squashed insts skipped by commit")

172 .
	`´”eq
(
comm™SquashedIn¡s
);

173 
comm™SquashEv’ts


174 .
	`Çme
(name() + ".commitSquashEvents")

175 .
	`desc
("The‚umber ofimes commit isoldo squash")

176 .
	`´”eq
(
comm™SquashEv’ts
);

177 
comm™NÚS³cSÎs


178 .
	`Çme
(name() + ".commitNonSpecStalls")

179 .
	`desc
("The‚umber ofimes commit has been forcedo stallo "

181 .
	`´”eq
(
comm™NÚS³cSÎs
);

182 
b¿nchMi¥»diùs


183 .
	`Çme
(name() + ".branchMispredicts")

184 .
	`desc
("The‚umber ofimes‡ branch was mispredicted")

185 .
	`´”eq
(
b¿nchMi¥»diùs
);

186 
numComm™‹dDi¡


187 .
	`š™
(0,
comm™Width
,1)

188 .
	`Çme
(name() + ".committed_per_cycle")

189 .
	`desc
("Number of insts commitedƒach cycle")

190 .
	`æags
(
Sts
::
pdf
)

193 
š¡sComm™‹d


194 .
	`š™
(
ıu
->
numTh»ads
)

195 .
	`Çme
(name() + ".committedInsts")

196 .
	`desc
("Number of instructions committed")

197 .
	`æags
(
tÙ®
)

200 
İsComm™‹d


201 .
	`š™
(
ıu
->
numTh»ads
)

202 .
	`Çme
(name() + ".committedOps")

203 .
	`desc
("Number of ops (including micro ops) committed")

204 .
	`æags
(
tÙ®
)

207 
¡©ComSwp


208 .
	`š™
(
ıu
->
numTh»ads
)

209 .
	`Çme
(name() + ".swp_count")

210 .
	`desc
("Number of s/w…refetches committed")

211 .
	`æags
(
tÙ®
)

214 
¡©ComRefs


215 .
	`š™
(
ıu
->
numTh»ads
)

216 .
	`Çme
(name() + ".refs")

217 .
	`desc
("Number of memory„eferences committed")

218 .
	`æags
(
tÙ®
)

221 
¡©ComLßds


222 .
	`š™
(
ıu
->
numTh»ads
)

223 .
	`Çme
(name() + ".loads")

224 .
	`desc
("Number of†oads committed")

225 .
	`æags
(
tÙ®
)

228 
¡©ComMemb¬s


229 .
	`š™
(
ıu
->
numTh»ads
)

230 .
	`Çme
(name() + ".membars")

231 .
	`desc
("Number of memory barriers committed")

232 .
	`æags
(
tÙ®
)

235 
¡©ComB¿nches


236 .
	`š™
(
ıu
->
numTh»ads
)

237 .
	`Çme
(name() + ".branches")

238 .
	`desc
("Number of branches committed")

239 .
	`æags
(
tÙ®
)

242 
¡©ComFlßtšg


243 .
	`š™
(
ıu
->
numTh»ads
)

244 .
	`Çme
(name() + ".fp_insts")

245 .
	`desc
("Number of committed floating…oint instructions.")

246 .
	`æags
(
tÙ®
)

249 
¡©ComIÁeg”


250 .
	`š™
(
ıu
->
numTh»ads
)

251 .
	`Çme
(name()+".int_insts")

252 .
	`desc
("Number of committed integer instructions.")

253 .
	`æags
(
tÙ®
)

256 
¡©ComFunùiÚC®ls


257 .
	`š™
(
ıu
->
numTh»ads
)

258 .
	`Çme
(name()+".function_calls")

259 .
	`desc
("Number of function calls committed.")

260 .
	`æags
(
tÙ®
)

263 
comm™EligibË


264 .
	`š™
(
ıu
->
numTh»ads
)

265 .
	`Çme
(name() + ".bw_limited")

266 .
	`desc
("number of insts‚ot committed dueo BW†imits")

267 .
	`æags
(
tÙ®
)

270 
comm™EligibËSam¶es


271 .
	`Çme
(name() + ".bw_lim_events")

272 .
	`desc
("number cycles where commit BW†imit„eached")

274 
	}
}

276 
	g‹m¶©e
 <
şass
 
	gIm¶
>

278 
	gDeçuÉComm™
<
	gIm¶
>::
£tTh»ads
(
¡d
::
veùÜ
<
Th»ad
 *> &
th»ads
)

280 
th»ad
 = 
th»ads
;

283 
	g‹m¶©e
 <
şass
 
	gIm¶
>

285 
	gDeçuÉComm™
<
	gIm¶
>::
£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
)

287 
timeBufãr
 = 
tb_±r
;

290 
	gtoIEW
 = 
timeBufãr
->
g‘Wœe
(0);

293 
	grobInfoFromIEW
 = 
timeBufãr
->
g‘Wœe
(-
›wToComm™D–ay
);

296 
	g‹m¶©e
 <
şass
 
	gIm¶
>

298 
	gDeçuÉComm™
<
	gIm¶
>::
£tF‘chQueue
(
TimeBufãr
<
F‘chSŒuù
> *
fq_±r
)

300 
ãtchQueue
 = 
fq_±r
;

303 
	gäomF‘ch
 = 
ãtchQueue
->
g‘Wœe
(-
ãtchToComm™D–ay
);

306 
	g‹m¶©e
 <
şass
 
	gIm¶
>

308 
	gDeçuÉComm™
<
	gIm¶
>::
£tR’ameQueue
(
TimeBufãr
<
R’ameSŒuù
> *
rq_±r
)

310 
»ÇmeQueue
 = 
rq_±r
;

313 
	gäomR’ame
 = 
»ÇmeQueue
->
g‘Wœe
(-
»ÇmeToROBD–ay
);

316 
	g‹m¶©e
 <
şass
 
	gIm¶
>

318 
	gDeçuÉComm™
<
	gIm¶
>::
£tIEWQueue
(
TimeBufãr
<
IEWSŒuù
> *
iq_±r
)

320 
›wQueue
 = 
iq_±r
;

323 
	gäomIEW
 = 
›wQueue
->
g‘Wœe
(-
›wToComm™D–ay
);

326 
	g‹m¶©e
 <
şass
 
	gIm¶
>

328 
	gDeçuÉComm™
<
	gIm¶
>::
	$£tIEWSge
(
IEW
 *
›w_¡age
)

330 
›wSge
 = 
›w_¡age
;

331 
	}
}

333 
	g‹m¶©e
<
şass
 
	gIm¶
>

335 
	gDeçuÉComm™
<
	gIm¶
>::
£tAùiveTh»ads
(
li¡
<
Th»adID
> *
©_±r
)

337 
aùiveTh»ads
 = 
©_±r
;

340 
	g‹m¶©e
 <
şass
 
	gIm¶
>

342 
	gDeçuÉComm™
<
	gIm¶
>::
	$£tR’ameM­
(
R’ameM­
 
rm_±r
[])

344 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++)

345 
»ÇmeM­
[
tid
] = &
rm_±r
[tid];

346 
	}
}

348 
	g‹m¶©e
 <
şass
 
	gIm¶
>

350 
	gDeçuÉComm™
<
	gIm¶
>::
	$£tROB
(
ROB
 *
rob_±r
)

352 
rob
 = 
rob_±r
;

353 
	}
}

355 
	g‹m¶©e
 <
şass
 
	gIm¶
>

357 
	gDeçuÉComm™
<
	gIm¶
>::
	$¡¬tupSge
()

359 
rob
->
	`£tAùiveTh»ads
(
aùiveTh»ads
);

360 
rob
->
	`»£tEÁr›s
();

363 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

364 
toIEW
->
comm™Info
[
tid
].
u£dROB
 = 
Œue
;

365 
toIEW
->
comm™Info
[
tid
].
ä“ROBEÁr›s
 = 
rob
->
	`numF»eEÁr›s
(tid);

366 
toIEW
->
comm™Info
[
tid
].
em±yROB
 = 
Œue
;

371 
ıu
->
	`aùiv©eSge
(
O3CPU
::
Comm™Idx
);

373 
ıu
->
	`aùiv™yThisCyşe
();

374 
	}
}

376 
	g‹m¶©e
 <
şass
 
	gIm¶
>

378 
	gDeçuÉComm™
<
	gIm¶
>::
	$d¿š
()

380 
d¿šP’dšg
 = 
Œue
;

381 
	}
}

383 
	g‹m¶©e
 <
şass
 
	gIm¶
>

385 
	gDeçuÉComm™
<
	gIm¶
>::
	$d¿šResume
()

387 
d¿šP’dšg
 = 
çl£
;

388 
	}
}

390 
	g‹m¶©e
 <
şass
 
	gIm¶
>

392 
	gDeçuÉComm™
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

394 
	`as£¹
(
	`isD¿šed
());

395 
rob
->
	`d¿šSª™yCheck
();

396 
	}
}

398 
	g‹m¶©e
 <
şass
 
	gIm¶
>

399 
boŞ


400 
	gDeçuÉComm™
<
	gIm¶
>::
	$isD¿šed
() const

411 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

412 ià(
pc
[
tid
].
	`miüoPC
() != 0)

413  
çl£
;

422  
rob
->
	`isEm±y
() &&

423 
š‹¼u±
 =ğ
NoFauÉ
;

424 
	}
}

426 
	g‹m¶©e
 <
şass
 
	gIm¶
>

428 
	gDeçuÉComm™
<
	gIm¶
>::
	$keOv”From
()

430 
_¡©us
 = 
Aùive
;

431 
_ÃxtStus
 = 
IÇùive
;

432 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

433 
comm™Stus
[
tid
] = 
IdË
;

434 
chªgedROBNumEÁr›s
[
tid
] = 
çl£
;

435 
Œ­Squash
[
tid
] = 
çl£
;

436 
tcSquash
[
tid
] = 
çl£
;

437 
squashAá”In¡
[
tid
] = 
NULL
;

439 
squashCouÁ”
 = 0;

440 
rob
->
	`keOv”From
();

441 
	}
}

443 
	g‹m¶©e
 <
şass
 
	gIm¶
>

445 
	gDeçuÉComm™
<
	gIm¶
>::
	$upd©eStus
()

448 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

449 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

451 
th»ads
 !ğ
’d
) {

452 
Th»adID
 
tid
 = *
th»ads
++;

454 
chªgedROBNumEÁr›s
[
tid
] = 
çl£
;

457 ià(
comm™Stus
[
tid
] =ğ
T¿pP’dšg
 ||

458 
comm™Stus
[
tid
] =ğ
F‘chT¿pP’dšg
) {

459 
_ÃxtStus
 = 
Aùive
;

463 ià(
_ÃxtStus
 =ğ
IÇùive
 && 
_¡©us
 =ğ
Aùive
) {

464 
	`DPRINTF
(
Aùiv™y
, "Deactivating stage.\n");

465 
ıu
->
	`d—ùiv©eSge
(
O3CPU
::
Comm™Idx
);

466 } ià(
_ÃxtStus
 =ğ
Aùive
 && 
_¡©us
 =ğ
IÇùive
) {

467 
	`DPRINTF
(
Aùiv™y
, "Activating stage.\n");

468 
ıu
->
	`aùiv©eSge
(
O3CPU
::
Comm™Idx
);

471 
_¡©us
 = 
_ÃxtStus
;

472 
	}
}

474 
	g‹m¶©e
 <
şass
 
	gIm¶
>

476 
	gDeçuÉComm™
<
	gIm¶
>::
	$£tNextStus
()

478 
squashes
 = 0;

480 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

481 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

483 
th»ads
 !ğ
’d
) {

484 
Th»adID
 
tid
 = *
th»ads
++;

486 ià(
comm™Stus
[
tid
] =ğ
ROBSquashšg
) {

487 
squashes
++;

491 
squashCouÁ”
 = 
squashes
;

495 ià(
squashCouÁ”
) {

496 
_ÃxtStus
 = 
Aùive
;

498 
	}
}

500 
	g‹m¶©e
 <
şass
 
	gIm¶
>

501 
boŞ


502 
	gDeçuÉComm™
<
	gIm¶
>::
	$chªgedROBEÁr›s
()

504 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

505 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

507 
th»ads
 !ğ
’d
) {

508 
Th»adID
 
tid
 = *
th»ads
++;

510 ià(
chªgedROBNumEÁr›s
[
tid
]) {

511  
Œue
;

515  
çl£
;

516 
	}
}

518 
	g‹m¶©e
 <
şass
 
	gIm¶
>

519 
size_t


520 
	gDeçuÉComm™
<
	gIm¶
>::
	$numROBF»eEÁr›s
(
Th»adID
 
tid
)

522  
rob
->
	`numF»eEÁr›s
(
tid
);

523 
	}
}

525 
	g‹m¶©e
 <
şass
 
	gIm¶
>

527 
	gDeçuÉComm™
<
	gIm¶
>::
	$g’”©eT¿pEv’t
(
Th»adID
 
tid
)

529 
	`DPRINTF
(
Comm™
, "G’”©šg¿°ev’ˆfÜ [tid:%i]\n", 
tid
);

531 
T¿pEv’t
 *
Œ­
 = 
Ãw
 
	`T¿pEv’t
(
this
, 
tid
);

533 
ıu
->
	`scheduË
(
Œ­
, cpu->
	`şockEdge
(
Œ­L©’cy
));

534 
Œ­InFlight
[
tid
] = 
Œue
;

535 
th»ad
[
tid
]->
Œ­P’dšg
 = 
Œue
;

536 
	}
}

538 
	g‹m¶©e
 <
şass
 
	gIm¶
>

540 
	gDeçuÉComm™
<
	gIm¶
>::
	$g’”©eTCEv’t
(
Th»adID
 
tid
)

542 
	`as£¹
(!
Œ­InFlight
[
tid
]);

543 
	`DPRINTF
(
Comm™
, "G’”©šg TC squashƒv’ˆfÜ [tid:%i]\n", 
tid
);

545 
tcSquash
[
tid
] = 
Œue
;

546 
	}
}

548 
	g‹m¶©e
 <
şass
 
	gIm¶
>

550 
	gDeçuÉComm™
<
	gIm¶
>::
	$squashAÎ
(
Th»adID
 
tid
)

556 
In¡SeqNum
 
squashed_š¡
 = 
rob
->
	`isEm±y
() ?

557 
Ï¡Comm™edSeqNum
[
tid
] : 
rob
->
	`»adH—dIn¡
Ñid)->
£qNum
 - 1;

562 
younge¡SeqNum
[
tid
] = 
Ï¡Comm™edSeqNum
[tid];

564 
rob
->
	`squash
(
squashed_š¡
, 
tid
);

565 
chªgedROBNumEÁr›s
[
tid
] = 
Œue
;

568 
toIEW
->
comm™Info
[
tid
].
dÚeSeqNum
 = 
squashed_š¡
;

572 
toIEW
->
comm™Info
[
tid
].
squash
 = 
Œue
;

576 
toIEW
->
comm™Info
[
tid
].
robSquashšg
 = 
Œue
;

578 
toIEW
->
comm™Info
[
tid
].
mi¥»diùIn¡
 = 
NULL
;

579 
toIEW
->
comm™Info
[
tid
].
squashIn¡
 = 
NULL
;

581 
toIEW
->
comm™Info
[
tid
].
pc
 =…c[tid];

582 
	}
}

584 
	g‹m¶©e
 <
şass
 
	gIm¶
>

586 
	gDeçuÉComm™
<
	gIm¶
>::
	$squashFromT¿p
(
Th»adID
 
tid
)

588 
	`squashAÎ
(
tid
);

590 
	`DPRINTF
(
Comm™
, "Squashšg from¿p,„e¡¬tšg‡ˆPC %s\n", 
pc
[
tid
]);

592 
th»ad
[
tid
]->
Œ­P’dšg
 = 
çl£
;

593 
th»ad
[
tid
]->
noSquashFromTC
 = 
çl£
;

594 
Œ­InFlight
[
tid
] = 
çl£
;

596 
Œ­Squash
[
tid
] = 
çl£
;

598 
comm™Stus
[
tid
] = 
ROBSquashšg
;

599 
ıu
->
	`aùiv™yThisCyşe
();

600 
	}
}

602 
	g‹m¶©e
 <
şass
 
	gIm¶
>

604 
	gDeçuÉComm™
<
	gIm¶
>::
	$squashFromTC
(
Th»adID
 
tid
)

606 
	`squashAÎ
(
tid
);

608 
	`DPRINTF
(
Comm™
, "Squashšg from TC,„e¡¬tšg‡ˆPC %s\n", 
pc
[
tid
]);

610 
th»ad
[
tid
]->
noSquashFromTC
 = 
çl£
;

611 
	`as£¹
(!
th»ad
[
tid
]->
Œ­P’dšg
);

613 
comm™Stus
[
tid
] = 
ROBSquashšg
;

614 
ıu
->
	`aùiv™yThisCyşe
();

616 
tcSquash
[
tid
] = 
çl£
;

617 
	}
}

619 
	g‹m¶©e
 <
şass
 
	gIm¶
>

621 
	gDeçuÉComm™
<
	gIm¶
>::
	$squashFromSquashAá”
(
Th»adID
 
tid
)

623 
	`DPRINTF
(
Comm™
, "Squashing‡fter squash‡fter„equest, "

624 "»¡¬tšg‡ˆPC %s\n", 
pc
[
tid
]);

626 
	`squashAÎ
(
tid
);

630 
toIEW
->
comm™Info
[
tid
].
squashIn¡
 = 
squashAá”In¡
[tid];

631 
squashAá”In¡
[
tid
] = 
NULL
;

633 
comm™Stus
[
tid
] = 
ROBSquashšg
;

634 
ıu
->
	`aùiv™yThisCyşe
();

635 
	}
}

637 
	g‹m¶©e
 <
şass
 
	gIm¶
>

639 
	gDeçuÉComm™
<
	gIm¶
>::
	$squashAá”
(
Th»adID
 
tid
, 
DynIn¡PŒ
 &
h—d_š¡
)

641 
	`DPRINTF
(
Comm™
, "Executing squash‡fter for [tid:%i] inst [sn:%lli]\n",

642 
tid
, 
h—d_š¡
->
£qNum
);

644 
	`as£¹
(!
squashAá”In¡
[
tid
] || squashAá”In¡[tid] =ğ
h—d_š¡
);

645 
comm™Stus
[
tid
] = 
SquashAá”P’dšg
;

646 
squashAá”In¡
[
tid
] = 
h—d_š¡
;

647 
	}
}

649 
	g‹m¶©e
 <
şass
 
	gIm¶
>

651 
	gDeçuÉComm™
<
	gIm¶
>::
	$tick
()

653 
wrÙeToTimeBufãr
 = 
çl£
;

654 
_ÃxtStus
 = 
IÇùive
;

656 ià(
aùiveTh»ads
->
	`em±y
())

659 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

660 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

664 
th»ads
 !ğ
’d
) {

665 
Th»adID
 
tid
 = *
th»ads
++;

669 
comm™‹dStÜes
[
tid
] = 
çl£
;

671 ià(
comm™Stus
[
tid
] =ğ
ROBSquashšg
) {

673 ià(
rob
->
	`isDÚeSquashšg
(
tid
)) {

674 
comm™Stus
[
tid
] = 
RuÂšg
;

676 
	`DPRINTF
(
Comm™
,"[tid:%u]: Still Squashing, cannot commit‡ny"

677 " in¡ thi cyşe.\n", 
tid
);

678 
rob
->
	`doSquash
(
tid
);

679 
toIEW
->
comm™Info
[
tid
].
robSquashšg
 = 
Œue
;

680 
wrÙeToTimeBufãr
 = 
Œue
;

685 
	`comm™
();

687 
	`m¬kCom¶‘edIn¡s
();

689 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

691 
th»ads
 !ğ
’d
) {

692 
Th»adID
 
tid
 = *
th»ads
++;

694 ià(!
rob
->
	`isEm±y
(
tid
è&&„ob->
	`»adH—dIn¡
Ñid)->
	`»adyToComm™
()) {

697 
_ÃxtStus
 = 
Aùive
;

699 
DynIn¡PŒ
 
š¡
 = 
rob
->
	`»adH—dIn¡
(
tid
);

701 
	`DPRINTF
(
Comm™
,"[tid:%i]: Instruction [sn:%lli] PC %s is head of"

703 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

705 } ià(!
rob
->
	`isEm±y
(
tid
)) {

706 
DynIn¡PŒ
 
š¡
 = 
rob
->
	`»adH—dIn¡
(
tid
);

708 
	`DPRINTF
(
Comm™
,"[tid:%i]: Can't commit, Instruction [sn:%lli] PC "

710 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

713 
	`DPRINTF
(
Comm™
, "[tid:%i]: ROB has %d insts & %d freeƒntries.\n",

714 
tid
, 
rob
->
	`couÁIn¡s
Ñid),„ob->
	`numF»eEÁr›s
(tid));

718 ià(
wrÙeToTimeBufãr
) {

719 
	`DPRINTF
(
Aùiv™y
, "Activity This Cycle.\n");

720 
ıu
->
	`aùiv™yThisCyşe
();

723 
	`upd©eStus
();

724 
	}
}

726 
	g‹m¶©e
 <
şass
 
	gIm¶
>

728 
	gDeçuÉComm™
<
	gIm¶
>::
	$hªdËIÁ”ru±
()

731 ià(!
ıu
->
	`checkIÁ”ru±s
(ıu->
	`tcBa£
(0))) {

732 
	`DPRINTF
(
Comm™
, "Pending interrupt is cleared by master before "

734 
toIEW
->
comm™Info
[0].
ş—rIÁ”ru±
 = 
Œue
;

735 
š‹¼u±
 = 
NoFauÉ
;

736 
avoidQu›sûLiveLock
 = 
Œue
;

742 ià(
ÿnHªdËIÁ”ru±s
 && 
ıu
->
š¡Li¡
.
	`em±y
()) {

745 
	`DPRINTF
(
Comm™
, "Interrupt detected.\n");

748 
toIEW
->
comm™Info
[0].
ş—rIÁ”ru±
 = 
Œue
;

750 
	`as£¹
(!
th»ad
[0]->
noSquashFromTC
);

751 
th»ad
[0]->
noSquashFromTC
 = 
Œue
;

753 ià(
ıu
->
check”
) {

754 
ıu
->
check”
->
	`hªdËP’dšgIÁ
();

760 
ıu
->
	`´oûssIÁ”ru±s
(ıu->
	`g‘IÁ”ru±s
());

762 
th»ad
[0]->
noSquashFromTC
 = 
çl£
;

764 
comm™Stus
[0] = 
T¿pP’dšg
;

767 
	`g’”©eT¿pEv’t
(0);

769 
š‹¼u±
 = 
NoFauÉ
;

770 
avoidQu›sûLiveLock
 = 
çl£
;

772 
	`DPRINTF
(
Comm™
, "Interrupt…ending: instruction is %sin "

774 
ÿnHªdËIÁ”ru±s
 ? "not " : "",

775 
ıu
->
š¡Li¡
.
	`em±y
() ? "" : "not " );

777 
	}
}

779 
	g‹m¶©e
 <
şass
 
	gIm¶
>

781 
	gDeçuÉComm™
<
	gIm¶
>::
	$´İag©eIÁ”ru±
()

783 ià(
comm™Stus
[0] =ğ
T¿pP’dšg
 || 
š‹¼u±
 || 
Œ­Squash
[0] ||

784 
tcSquash
[0])

793 
š‹¼u±
 = 
ıu
->
	`g‘IÁ”ru±s
();

798 ià(
š‹¼u±
 !ğ
NoFauÉ
)

799 
toIEW
->
comm™Info
[0].
š‹¼u±P’dšg
 = 
Œue
;

800 
	}
}

802 
	g‹m¶©e
 <
şass
 
	gIm¶
>

804 
	gDeçuÉComm™
<
	gIm¶
>::
	$comm™
()

806 ià(
FuÎSy¡em
) {

808 ià(
ıu
->
	`checkIÁ”ru±s
(ıu->
	`tcBa£
(0)))

809 
	`´İag©eIÁ”ru±
();

815 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

816 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

818 
th»ads
 !ğ
’d
) {

819 
Th»adID
 
tid
 = *
th»ads
++;

823 ià(
Œ­Squash
[
tid
] =ğ
Œue
) {

824 
	`as£¹
(!
tcSquash
[
tid
]);

825 
	`squashFromT¿p
(
tid
);

826 } ià(
tcSquash
[
tid
] =ğ
Œue
) {

827 
	`as£¹
(
comm™Stus
[
tid
] !ğ
T¿pP’dšg
);

828 
	`squashFromTC
(
tid
);

829 } ià(
comm™Stus
[
tid
] =ğ
SquashAá”P’dšg
) {

833 
	`squashFromSquashAá”
(
tid
);

839 ià(
äomIEW
->
squash
[
tid
] &&

840 
comm™Stus
[
tid
] !ğ
T¿pP’dšg
 &&

841 
äomIEW
->
squashedSeqNum
[
tid
] <ğ
younge¡SeqNum
[tid]) {

843 ià(
äomIEW
->
mi¥»diùIn¡
[
tid
]) {

844 
	`DPRINTF
(
Comm™
,

846 
tid
,

847 
äomIEW
->
mi¥»diùIn¡
[
tid
]->
	`š¡Addr
(),

848 
äomIEW
->
squashedSeqNum
[
tid
]);

850 
	`DPRINTF
(
Comm™
,

852 
tid
, 
äomIEW
->
squashedSeqNum
[tid]);

855 
	`DPRINTF
(
Comm™
, "[tid:%i]: Redirectingo PC %#x\n",

856 
tid
,

857 
äomIEW
->
pc
[
tid
].
	`ÃxtIn¡Addr
());

859 
comm™Stus
[
tid
] = 
ROBSquashšg
;

863 
In¡SeqNum
 
squashed_š¡
 = 
äomIEW
->
squashedSeqNum
[
tid
];

865 ià(
äomIEW
->
šşudeSquashIn¡
[
tid
] =ğ
Œue
) {

866 
squashed_š¡
--;

871 
younge¡SeqNum
[
tid
] = 
squashed_š¡
;

873 
rob
->
	`squash
(
squashed_š¡
, 
tid
);

874 
chªgedROBNumEÁr›s
[
tid
] = 
Œue
;

876 
toIEW
->
comm™Info
[
tid
].
dÚeSeqNum
 = 
squashed_š¡
;

878 
toIEW
->
comm™Info
[
tid
].
squash
 = 
Œue
;

882 
toIEW
->
comm™Info
[
tid
].
robSquashšg
 = 
Œue
;

884 
toIEW
->
comm™Info
[
tid
].
mi¥»diùIn¡
 =

885 
äomIEW
->
mi¥»diùIn¡
[
tid
];

886 
toIEW
->
comm™Info
[
tid
].
b¿nchTak’
 =

887 
äomIEW
->
b¿nchTak’
[
tid
];

888 
toIEW
->
comm™Info
[
tid
].
squashIn¡
 =

889 
rob
->
	`fšdIn¡
(
tid
, 
squashed_š¡
);

890 ià(
toIEW
->
comm™Info
[
tid
].
mi¥»diùIn¡
) {

891 ià(
toIEW
->
comm™Info
[
tid
].
mi¥»diùIn¡
->
	`isUncÚdCŒl
()) {

892 
toIEW
->
comm™Info
[
tid
].
b¿nchTak’
 = 
Œue
;

896 
toIEW
->
comm™Info
[
tid
].
pc
 = 
äomIEW
->pc[tid];

898 ià(
toIEW
->
comm™Info
[
tid
].
mi¥»diùIn¡
) {

899 ++
b¿nchMi¥»diùs
;

905 
	`£tNextStus
();

907 ià(
squashCouÁ”
 !ğ
numTh»ads
) {

909 
	`g‘In¡s
();

912 
	`comm™In¡s
();

916 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

918 
th»ads
 !ğ
’d
) {

919 
Th»adID
 
tid
 = *
th»ads
++;

921 ià(
chªgedROBNumEÁr›s
[
tid
]) {

922 
toIEW
->
comm™Info
[
tid
].
u£dROB
 = 
Œue
;

923 
toIEW
->
comm™Info
[
tid
].
ä“ROBEÁr›s
 = 
rob
->
	`numF»eEÁr›s
(tid);

925 
wrÙeToTimeBufãr
 = 
Œue
;

926 
chªgedROBNumEÁr›s
[
tid
] = 
çl£
;

927 ià(
rob
->
	`isEm±y
(
tid
))

928 
checkEm±yROB
[
tid
] = 
Œue
;

939 ià(
checkEm±yROB
[
tid
] && 
rob
->
	`isEm±y
(tid) &&

940 !
›wSge
->
	`hasStÜesToWB
(
tid
è&& !
comm™‹dStÜes
[tid]) {

941 
checkEm±yROB
[
tid
] = 
çl£
;

942 
toIEW
->
comm™Info
[
tid
].
u£dROB
 = 
Œue
;

943 
toIEW
->
comm™Info
[
tid
].
em±yROB
 = 
Œue
;

944 
toIEW
->
comm™Info
[
tid
].
ä“ROBEÁr›s
 = 
rob
->
	`numF»eEÁr›s
(tid);

945 
wrÙeToTimeBufãr
 = 
Œue
;

949 
	}
}

951 
	g‹m¶©e
 <
şass
 
	gIm¶
>

953 
	gDeçuÉComm™
<
	gIm¶
>::
	$comm™In¡s
()

964 
	`DPRINTF
(
Comm™
, "Tryingo commit instructions inhe ROB.\n");

966 
num_comm™‹d
 = 0;

968 
DynIn¡PŒ
 
h—d_š¡
;

972 
num_comm™‹d
 < 
comm™Width
) {

975 ià(
š‹¼u±
 !ğ
NoFauÉ
)

976 
	`hªdËIÁ”ru±
();

978 
comm™_th»ad
 = 
	`g‘Comm™tšgTh»ad
();

980 ià(
comm™_th»ad
 =ğ-1 || !
rob
->
	`isH—dR—dy
(commit_thread))

983 
h—d_š¡
 = 
rob
->
	`»adH—dIn¡
(
comm™_th»ad
);

985 
Th»adID
 
tid
 = 
h—d_š¡
->
th»adNumb”
;

987 
	`as£¹
(
tid
 =ğ
comm™_th»ad
);

989 
	`DPRINTF
(
Comm™
, "Tryingo commit head instruction, [sn:%i] [tid:%i]\n",

990 
h—d_š¡
->
£qNum
, 
tid
);

994 ià(
h—d_š¡
->
	`isSquashed
()) {

996 
	`DPRINTF
(
Comm™
, "Retiring squashed instruction from "

999 
rob
->
	`»tœeH—d
(
comm™_th»ad
);

1001 ++
comm™SquashedIn¡s
;

1004 
chªgedROBNumEÁr›s
[
tid
] = 
Œue
;

1006 
pc
[
tid
] = 
h—d_š¡
->
	`pcS‹
();

1013 
th»ad
[
tid
]->
funcExeIn¡
++;

1016 
boŞ
 
comm™_sucûss
 = 
	`comm™H—d
(
h—d_š¡
, 
num_comm™‹d
);

1018 ià(
comm™_sucûss
) {

1019 ++
num_comm™‹d
;

1021 
chªgedROBNumEÁr›s
[
tid
] = 
Œue
;

1024 
toIEW
->
comm™Info
[
tid
].
dÚeSeqNum
 = 
h—d_š¡
->
£qNum
;

1026 ià(
tid
 == 0) {

1027 
ÿnHªdËIÁ”ru±s
 = (!
h—d_š¡
->
	`isD–ayedComm™
()) &&

1028 ((
THE_ISA
 !ğ
ALPHA_ISA
) ||

1029 (!(
pc
[0].
	`š¡Addr
() & 0x3)));

1033 
h—d_š¡
->
	`upd©eMiscRegs
();

1035 
ıu
->
	`ŒaûFunùiÚs
(
pc
[
tid
].
	`š¡Addr
());

1037 
TheISA
::
	`advªûPC
(
pc
[
tid
], 
h—d_š¡
->
¡©icIn¡
);

1040 
Ï¡Comm™edSeqNum
[
tid
] = 
h—d_š¡
->
£qNum
;

1044 ià(
h—d_š¡
->
	`isSquashAá”
())

1045 
	`squashAá”
(
tid
, 
h—d_š¡
);

1047 ià(
d¿šP’dšg
) {

1048 
	`DPRINTF
(
D¿š
, "D¿ššg: %i:%s\n", 
tid
, 
pc
[tid]);

1049 ià(
pc
[
tid
].
	`miüoPC
(è=ğ0 && 
š‹¼u±
 =ğ
NoFauÉ
) {

1050 
	`squashAá”
(
tid
, 
h—d_š¡
);

1051 
ıu
->
	`comm™D¿šed
(
tid
);

1055 
couÁ
 = 0;

1056 
Addr
 
Şdpc
;

1059 
	`as£¹
(!
th»ad
[
tid
]->
noSquashFromTC
 && !th»ad[tid]->
Œ­P’dšg
);

1061 
Şdpc
 = 
pc
[
tid
].
	`š¡Addr
();

1062 
ıu
->
sy¡em
->
pcEv’tQueue
.
	`£rviû
(
th»ad
[
tid
]->
	`g‘TC
());

1063 
couÁ
++;

1064 } 
Şdpc
 !ğ
pc
[
tid
].
	`š¡Addr
());

1065 ià(
couÁ
 > 1) {

1066 
	`DPRINTF
(
Comm™
,

1078 ià(!
š‹¼u±
 && 
avoidQu›sûLiveLock
 &&

1079 (!
h—d_š¡
->
	`isMiüoİ
(è|| h—d_š¡->
	`isLa¡Miüoİ
()) &&

1080 
ıu
->
	`checkIÁ”ru±s
(ıu->
	`tcBa£
(0)))

1081 
	`squashAá”
(
tid
, 
h—d_š¡
);

1083 
	`DPRINTF
(
Comm™
, "Unableo commit head instruction PC:%s "

1085 
h—d_š¡
->
	`pcS‹
(), 
tid
 ,h—d_š¡->
£qNum
);

1091 
	`DPRINTF
(
Comm™R©e
, "%i\n", 
num_comm™‹d
);

1092 
numComm™‹dDi¡
.
	`§m¶e
(
num_comm™‹d
);

1094 ià(
num_comm™‹d
 =ğ
comm™Width
) {

1095 
comm™EligibËSam¶es
++;

1097 
	}
}

1099 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1100 
boŞ


1101 
	gDeçuÉComm™
<
	gIm¶
>::
	$comm™H—d
(
DynIn¡PŒ
 &
h—d_š¡
, 
š¡_num
)

1103 
	`as£¹
(
h—d_š¡
);

1105 
Th»adID
 
tid
 = 
h—d_š¡
->
th»adNumb”
;

1109 ià(!
h—d_š¡
->
	`isExecu‹d
()) {

1112 
th»ad
[
tid
]->
funcExeIn¡
--;

1116 
	`as£¹
(
h—d_š¡
->
	`isNÚS³cuÏtive
(è|| h—d_š¡->
	`isStÜeCÚd™iÚ®
()

1117 || 
h—d_š¡
->
	`isMemB¬r›r
(è|| h—d_š¡->
	`isWr™eB¬r›r
() ||

1118 (
h—d_š¡
->
	`isLßd
(è&& h—d_š¡->
	`unÿch—bË
()));

1120 
	`DPRINTF
(
Comm™
, "Encountered‡ barrier or‚on-speculative "

1122 
h—d_š¡
->
£qNum
, h—d_š¡->
	`pcS‹
());

1124 ià(
š¡_num
 > 0 || 
›wSge
->
	`hasStÜesToWB
(
tid
)) {

1125 
	`DPRINTF
(
Comm™
, "Waiting for‡ll storeso writeback.\n");

1126  
çl£
;

1129 
toIEW
->
comm™Info
[
tid
].
nÚS³cSeqNum
 = 
h—d_š¡
->
£qNum
;

1133 
h—d_š¡
->
	`ş—rCªComm™
();

1135 ià(
h—d_š¡
->
	`isLßd
(è&& h—d_š¡->
	`unÿch—bË
()) {

1136 
	`DPRINTF
(
Comm™
, "[sn:%lli]: Uncached†oad, PC %s.\n",

1137 
h—d_š¡
->
£qNum
, h—d_š¡->
	`pcS‹
());

1138 
toIEW
->
comm™Info
[
tid
].
unÿched
 = 
Œue
;

1139 
toIEW
->
comm™Info
[
tid
].
unÿchedLßd
 = 
h—d_š¡
;

1141 ++
comm™NÚS³cSÎs
;

1144  
çl£
;

1147 ià(
h—d_š¡
->
	`isTh»adSync
()) {

1149 
	`·nic
("Thread sync instructions‡re‚ot handled yet.\n");

1153 
FauÉ
 
š¡_çuÉ
 = 
h—d_š¡
->
	`g‘FauÉ
();

1156 ià(!
h—d_š¡
->
	`isStÜe
(è&& 
š¡_çuÉ
 =ğ
NoFauÉ
) {

1157 
h—d_š¡
->
	`£tCom¶‘ed
();

1162 ià(
ıu
->
check”
) {

1163 
ıu
->
check”
->
	`v”ify
(
h—d_š¡
);

1166 ià(
š¡_çuÉ
 !ğ
NoFauÉ
) {

1167 
	`DPRINTF
(
Comm™
, "Inst [sn:%lli] PC %s has‡ fault\n",

1168 
h—d_š¡
->
£qNum
, h—d_š¡->
	`pcS‹
());

1170 ià(
›wSge
->
	`hasStÜesToWB
(
tid
è|| 
š¡_num
 > 0) {

1171 
	`DPRINTF
(
Comm™
, "Stores outstanding, fault must wait.\n");

1172  
çl£
;

1175 
h—d_š¡
->
	`£tCom¶‘ed
();

1177 ià(
ıu
->
check”
) {

1179 
ıu
->
check”
->
	`v”ify
(
h—d_š¡
);

1182 
	`as£¹
(!
th»ad
[
tid
]->
noSquashFromTC
);

1186 
th»ad
[
tid
]->
noSquashFromTC
 = 
Œue
;

1194 
ıu
->
	`Œ­
(
š¡_çuÉ
, 
tid
, 
h—d_š¡
->
¡©icIn¡
);

1197 
th»ad
[
tid
]->
noSquashFromTC
 = 
çl£
;

1199 
comm™Stus
[
tid
] = 
T¿pP’dšg
;

1201 
	`DPRINTF
(
Comm™
, "Committing instruction with fault [sn:%lli]\n",

1202 
h—d_š¡
->
£qNum
);

1203 ià(
h—d_š¡
->
ŒaûD©a
) {

1204 ià(
	`DTRACE
(
ExecFauÉšg
)) {

1205 
h—d_š¡
->
ŒaûD©a
->
	`£tF‘chSeq
(h—d_š¡->
£qNum
);

1206 
h—d_š¡
->
ŒaûD©a
->
	`£tCPSeq
(
th»ad
[
tid
]->
numOp
);

1207 
h—d_š¡
->
ŒaûD©a
->
	`dump
();

1209 
d–‘e
 
h—d_š¡
->
ŒaûD©a
;

1210 
h—d_š¡
->
ŒaûD©a
 = 
NULL
;

1214 
	`g’”©eT¿pEv’t
(
tid
);

1215  
çl£
;

1218 
	`upd©eComIn¡Sts
(
h—d_š¡
);

1220 ià(
FuÎSy¡em
) {

1221 ià(
th»ad
[
tid
]->
´ofe
) {

1222 
th»ad
[
tid
]->
´ofePC
 = 
h—d_š¡
->
	`š¡Addr
();

1223 
ProfeNode
 *
node
 = 
th»ad
[
tid
]->
´ofe
->
	`cÚsume
(

1224 
th»ad
[
tid
]->
	`g‘TC
(), 
h—d_š¡
->
¡©icIn¡
);

1226 ià(
node
)

1227 
th»ad
[
tid
]->
´ofeNode
 = 
node
;

1229 ià(
CPA
::
	`avaabË
()) {

1230 ià(
h—d_š¡
->
	`isCÚŒŞ
()) {

1231 
Th»adCÚ‹xt
 *
tc
 = 
th»ad
[
tid
]->
	`g‘TC
();

1232 
CPA
::
	`ıa
()->
	`swAutoBegš
(
tc
, 
h—d_š¡
->
	`ÃxtIn¡Addr
());

1236 
	`DPRINTF
(
Comm™
, "Committing instruction with [sn:%lli] PC %s\n",

1237 
h—d_š¡
->
£qNum
, h—d_š¡->
	`pcS‹
());

1238 ià(
h—d_š¡
->
ŒaûD©a
) {

1239 
h—d_š¡
->
ŒaûD©a
->
	`£tF‘chSeq
(h—d_š¡->
£qNum
);

1240 
h—d_š¡
->
ŒaûD©a
->
	`£tCPSeq
(
th»ad
[
tid
]->
numOp
);

1241 
h—d_š¡
->
ŒaûD©a
->
	`dump
();

1242 
d–‘e
 
h—d_š¡
->
ŒaûD©a
;

1243 
h—d_š¡
->
ŒaûD©a
 = 
NULL
;

1245 ià(
h—d_š¡
->
	`isR‘uº
()) {

1246 
	`DPRINTF
(
Comm™
,"Return Instruction Committed [sn:%lli] PC %s \n",

1247 
h—d_š¡
->
£qNum
, h—d_š¡->
	`pcS‹
());

1251 
i
 = 0; i < 
h—d_š¡
->
	`numDe¡Regs
(); i++) {

1252 
»ÇmeM­
[
tid
]->
	`£tEÁry
(
h—d_š¡
->
	`æ©‹ÃdDe¡RegIdx
(
i
),

1253 
h—d_š¡
->
	`»ÇmedDe¡RegIdx
(
i
));

1257 
rob
->
	`»tœeH—d
(
tid
);

1259 #ià
TRACING_ON


1260 ià(
	`DTRACE
(
O3PeV›w
)) {

1261 
h—d_š¡
->
comm™Tick
 = 
	`curTick
(è- h—d_š¡->
ãtchTick
;

1266 ià(
h—d_š¡
->
	`isStÜe
())

1267 
comm™‹dStÜes
[
tid
] = 
Œue
;

1270  
Œue
;

1271 
	}
}

1273 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1275 
	gDeçuÉComm™
<
	gIm¶
>::
	$g‘In¡s
()

1277 
	`DPRINTF
(
Comm™
, "Getting instructions from Rename stage.\n");

1280 
š¡s_to_´oûss
 = 
¡d
::
	`mš
(()
»ÇmeWidth
, 
äomR’ame
->
size
);

1282 
š¡_num
 = 0; in¡_num < 
š¡s_to_´oûss
; ++inst_num) {

1283 
DynIn¡PŒ
 
š¡
;

1285 
š¡
 = 
äomR’ame
->
š¡s
[
š¡_num
];

1286 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1288 ià(!
š¡
->
	`isSquashed
() &&

1289 
comm™Stus
[
tid
] !ğ
ROBSquashšg
 &&

1290 
comm™Stus
[
tid
] !ğ
T¿pP’dšg
) {

1291 
chªgedROBNumEÁr›s
[
tid
] = 
Œue
;

1293 
	`DPRINTF
(
Comm™
, "Inserting PC %s [sn:%i] [tid:%i] into ROB.\n",

1294 
š¡
->
	`pcS‹
(), in¡->
£qNum
, 
tid
);

1296 
rob
->
	`š£¹In¡
(
š¡
);

1298 
	`as£¹
(
rob
->
	`g‘Th»adEÁr›s
(
tid
è<ğrob->
	`g‘MaxEÁr›s
(tid));

1300 
younge¡SeqNum
[
tid
] = 
š¡
->
£qNum
;

1302 
	`DPRINTF
(
Comm™
, "Instruction PC %s [sn:%i] [tid:%i] was "

1304 
š¡
->
	`pcS‹
(), in¡->
£qNum
, 
tid
);

1307 
	}
}

1309 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1311 
	gDeçuÉComm™
<
	gIm¶
>::
	$skidIn£¹
()

1313 
	`DPRINTF
(
Comm™
, "Attemptingo‡ny instructions from„ename into "

1316 
š¡_num
 = 0; in¡_num < 
äomR’ame
->
size
; ++inst_num) {

1317 
DynIn¡PŒ
 
š¡
 = 
äomR’ame
->
š¡s
[
š¡_num
];

1319 ià(!
š¡
->
	`isSquashed
()) {

1320 
	`DPRINTF
(
Comm™
, "Inserting PC %s [sn:%i] [tid:%i] into ",

1321 "skidBufãr.\n", 
š¡
->
	`pcS‹
(), in¡->
£qNum
,

1322 
š¡
->
th»adNumb”
);

1323 
skidBufãr
.
	`push
(
š¡
);

1325 
	`DPRINTF
(
Comm™
, "Instruction PC %s [sn:%i] [tid:%i] was "

1327 
š¡
->
	`pcS‹
(), in¡->
£qNum
, in¡->
th»adNumb”
);

1330 
	}
}

1332 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1334 
	gDeçuÉComm™
<
	gIm¶
>::
	$m¬kCom¶‘edIn¡s
()

1338 
š¡_num
 = 0;

1339 
š¡_num
 < 
äomIEW
->
size
 && fromIEW->
š¡s
[inst_num];

1340 ++
š¡_num
)

1342 ià(!
äomIEW
->
š¡s
[
š¡_num
]->
	`isSquashed
()) {

1343 
	`DPRINTF
(
Comm™
, "[tid:%i]: Marking PC %s, [sn:%lli]„eady "

1345 
äomIEW
->
š¡s
[
š¡_num
]->
th»adNumb”
,

1346 
äomIEW
->
š¡s
[
š¡_num
]->
	`pcS‹
(),

1347 
äomIEW
->
š¡s
[
š¡_num
]->
£qNum
);

1350 
äomIEW
->
š¡s
[
š¡_num
]->
	`£tCªComm™
();

1353 
	}
}

1355 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1356 
boŞ


1357 
	gDeçuÉComm™
<
	gIm¶
>::
	$robDÚeSquashšg
()

1359 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

1360 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

1362 
th»ads
 !ğ
’d
) {

1363 
Th»adID
 
tid
 = *
th»ads
++;

1365 ià(!
rob
->
	`isDÚeSquashšg
(
tid
))

1366  
çl£
;

1369  
Œue
;

1370 
	}
}

1372 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1374 
	gDeçuÉComm™
<
	gIm¶
>::
	$upd©eComIn¡Sts
(
DynIn¡PŒ
 &
š¡
)

1376 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1378 ià(!
š¡
->
	`isMiüoİ
(è|| in¡->
	`isLa¡Miüoİ
())

1379 
š¡sComm™‹d
[
tid
]++;

1380 
İsComm™‹d
[
tid
]++;

1384 ià(!
š¡
->
	`isNİ
(è&& !š¡->
	`isIn¡P»ãtch
()) {

1385 
ıu
->
	`š¡DÚe
(
tid
, 
š¡
);

1391 ià(
š¡
->
	`isCÚŒŞ
())

1392 
¡©ComB¿nches
[
tid
]++;

1397 ià(
š¡
->
	`isMemRef
()) {

1398 
¡©ComRefs
[
tid
]++;

1400 ià(
š¡
->
	`isLßd
()) {

1401 
¡©ComLßds
[
tid
]++;

1405 ià(
š¡
->
	`isMemB¬r›r
()) {

1406 
¡©ComMemb¬s
[
tid
]++;

1410 ià(
š¡
->
	`isIÁeg”
())

1411 
¡©ComIÁeg”
[
tid
]++;

1414 ià(
š¡
->
	`isFlßtšg
())

1415 
¡©ComFlßtšg
[
tid
]++;

1418 ià(
š¡
->
	`isC®l
())

1419 
¡©ComFunùiÚC®ls
[
tid
]++;

1421 
	}
}

1428 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1429 
Th»adID


1430 
	gDeçuÉComm™
<
	gIm¶
>::
	$g‘Comm™tšgTh»ad
()

1432 ià(
numTh»ads
 > 1) {

1433 
comm™PŞicy
) {

1435 
Agg»ssive
:

1439  
	`Şde¡R—dy
();

1441 
RoundRobš
:

1442  
	`roundRobš
();

1444 
Olde¡R—dy
:

1445  
	`Şde¡R—dy
();

1448  
Inv®idTh»adID
;

1451 
	`as£¹
(!
aùiveTh»ads
->
	`em±y
());

1452 
Th»adID
 
tid
 = 
aùiveTh»ads
->
	`äÚt
();

1454 ià(
comm™Stus
[
tid
] =ğ
RuÂšg
 ||

1455 
comm™Stus
[
tid
] =ğ
IdË
 ||

1456 
comm™Stus
[
tid
] =ğ
F‘chT¿pP’dšg
) {

1457  
tid
;

1459  
Inv®idTh»adID
;

1462 
	}
}

1464 
	g‹m¶©e
<
şass
 
	gIm¶
>

1465 
Th»adID


1466 
	gDeçuÉComm™
<
	gIm¶
>::
	$roundRobš
()

1468 
li¡
<
Th»adID
>::
™”©Ü
 
´i_™”
 = 
´iÜ™y_li¡
.
	`begš
();

1469 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
´iÜ™y_li¡
.
	`’d
();

1471 
´i_™”
 !ğ
’d
) {

1472 
Th»adID
 
tid
 = *
´i_™”
;

1474 ià(
comm™Stus
[
tid
] =ğ
RuÂšg
 ||

1475 
comm™Stus
[
tid
] =ğ
IdË
 ||

1476 
comm™Stus
[
tid
] =ğ
F‘chT¿pP’dšg
) {

1478 ià(
rob
->
	`isH—dR—dy
(
tid
)) {

1479 
´iÜ™y_li¡
.
	`”a£
(
´i_™”
);

1480 
´iÜ™y_li¡
.
	`push_back
(
tid
);

1482  
tid
;

1486 
´i_™”
++;

1489  
Inv®idTh»adID
;

1490 
	}
}

1492 
	g‹m¶©e
<
şass
 
	gIm¶
>

1493 
Th»adID


1494 
	gDeçuÉComm™
<
	gIm¶
>::
	$Şde¡R—dy
()

1496 
Şde¡
 = 0;

1497 
boŞ
 
fœ¡
 = 
Œue
;

1499 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

1500 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

1502 
th»ads
 !ğ
’d
) {

1503 
Th»adID
 
tid
 = *
th»ads
++;

1505 ià(!
rob
->
	`isEm±y
(
tid
) &&

1506 (
comm™Stus
[
tid
] =ğ
RuÂšg
 ||

1507 
comm™Stus
[
tid
] =ğ
IdË
 ||

1508 
comm™Stus
[
tid
] =ğ
F‘chT¿pP’dšg
)) {

1510 ià(
rob
->
	`isH—dR—dy
(
tid
)) {

1512 
DynIn¡PŒ
 
h—d_š¡
 = 
rob
->
	`»adH—dIn¡
(
tid
);

1514 ià(
fœ¡
) {

1515 
Şde¡
 = 
tid
;

1516 
fœ¡
 = 
çl£
;

1517 } ià(
h—d_š¡
->
£qNum
 < 
Şde¡
) {

1518 
Şde¡
 = 
tid
;

1524 ià(!
fœ¡
) {

1525  
Şde¡
;

1527  
Inv®idTh»adID
;

1529 
	}
}

	@o3/cpu.cc

47 
	~"¬ch/k”Ãl_¡©s.hh
"

48 
	~"cÚfig/the_i§.hh
"

49 
	~"ıu/check”/ıu.hh
"

50 
	~"ıu/check”/th»ad_cÚ‹xt.hh
"

51 
	~"ıu/o3/ıu.hh
"

52 
	~"ıu/o3/i§_¥ecific.hh
"

53 
	~"ıu/o3/th»ad_cÚ‹xt.hh
"

54 
	~"ıu/aùiv™y.hh
"

55 
	~"ıu/qu›sû_ev’t.hh
"

56 
	~"ıu/sim¶e_th»ad.hh
"

57 
	~"ıu/th»ad_cÚ‹xt.hh
"

58 
	~"debug/Aùiv™y.hh
"

59 
	~"debug/D¿š.hh
"

60 
	~"debug/O3CPU.hh
"

61 
	~"debug/Qu›sû.hh
"

62 
	~"’ums/MemÜyMode.hh
"

63 
	~"sim/cÜe.hh
"

64 
	~"sim/fuÎ_sy¡em.hh
"

65 
	~"sim/´oûss.hh
"

66 
	~"sim/¡©_cÚŒŞ.hh
"

67 
	~"sim/sy¡em.hh
"

69 #ià
THE_ISA
 =ğ
ALPHA_ISA


70 
	~"¬ch/®pha/oså®.hh
"

71 
	~"debug/Aùiv™y.hh
"

74 
	gBa£CPUP¬ams
;

76 
usšg
 
Çme¥aû
 
	gTheISA
;

77 
usšg
 
Çme¥aû
 
	g¡d
;

79 
	gBa£O3CPU
::
	$Ba£O3CPU
(
Ba£CPUP¬ams
 *
·¿ms
)

80 : 
	$Ba£CPU
(
·¿ms
)

82 
	}
}

85 
Ba£O3CPU
::
	$»gSts
()

87 
Ba£CPU
::
	`»gSts
();

88 
	}
}

90 
	g‹m¶©e
<
şass
 
	gIm¶
>

91 
boŞ


92 
	gFuÎO3CPU
<
	gIm¶
>::
IÿchePÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

94 
	`DPRINTF
(
O3CPU
, "Fetch unit„eceivediming\n");

96 
	`as£¹
(!(
pkt
->
	`memInhib™As£¹ed
(è&& !pkt->
	`sh¬edAs£¹ed
()));

97 
ãtch
->
	`´oûssCacheCom¶‘iÚ
(
pkt
);

99  
Œue
;

100 
	}
}

102 
	g‹m¶©e
<
şass
 
	gIm¶
>

104 
	gFuÎO3CPU
<
	gIm¶
>::
IÿchePÜt
::
	$»cvR‘ry
()

106 
ãtch
->
	`»cvR‘ry
();

107 
	}
}

109 
	g‹m¶©e
 <
şass
 
	gIm¶
>

110 
boŞ


111 
	gFuÎO3CPU
<
	gIm¶
>::
DÿchePÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

113  
lsq
->
	`»cvTimšgRe¥
(
pkt
);

114 
	}
}

116 
	g‹m¶©e
 <
şass
 
	gIm¶
>

118 
	gFuÎO3CPU
<
	gIm¶
>::
DÿchePÜt
::
	$»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
)

120 
lsq
->
	`»cvTimšgSnoİReq
(
pkt
);

121 
	}
}

123 
	g‹m¶©e
 <
şass
 
	gIm¶
>

125 
	gFuÎO3CPU
<
	gIm¶
>::
DÿchePÜt
::
	$»cvR‘ry
()

127 
lsq
->
	`»cvR‘ry
();

128 
	}
}

130 
	g‹m¶©e
 <
şass
 
	gIm¶
>

131 
	gFuÎO3CPU
<
	gIm¶
>::
TickEv’t
::TickEv’t(
FuÎO3CPU
<
Im¶
> *
c
)

132 : 
Ev’t
(
CPU_Tick_Pri
), 
	$ıu
(
c
)

134 
	}
}

136 
	g‹m¶©e
 <
şass
 
	gIm¶
>

138 
	gFuÎO3CPU
<
	gIm¶
>::
TickEv’t
::
	$´oûss
()

140 
ıu
->
	`tick
();

141 
	}
}

143 
	g‹m¶©e
 <
şass
 
	gIm¶
>

145 
	gFuÎO3CPU
<
	gIm¶
>::
TickEv’t
::
	$desütiÚ
() const

148 
	}
}

150 
	g‹m¶©e
 <
şass
 
	gIm¶
>

151 
	gFuÎO3CPU
<
	gIm¶
>::
Aùiv©eTh»adEv’t
::
	$Aùiv©eTh»adEv’t
()

152 : 
	$Ev’t
(
CPU_Sw™ch_Pri
)

154 
	}
}

156 
‹m¶©e
 <
şass
 
Im¶
>

158 
FuÎO3CPU
<
Im¶
>::
Aùiv©eTh»adEv’t
::
š™
(
th»ad_num
,

159 
FuÎO3CPU
<
Im¶
> *
th»ad_ıu
)

161 
	gtid
 = 
th»ad_num
;

162 
	gıu
 = 
th»ad_ıu
;

165 
	g‹m¶©e
 <
şass
 
	gIm¶
>

167 
	gFuÎO3CPU
<
	gIm¶
>::
Aùiv©eTh»adEv’t
::
	$´oûss
()

169 
ıu
->
	`aùiv©eTh»ad
(
tid
);

170 
	}
}

172 
	g‹m¶©e
 <
şass
 
	gIm¶
>

174 
	gFuÎO3CPU
<
	gIm¶
>::
Aùiv©eTh»adEv’t
::
	$desütiÚ
() const

177 
	}
}

179 
	g‹m¶©e
 <
şass
 
	gIm¶
>

180 
	gFuÎO3CPU
<
	gIm¶
>::
D—Îoÿ‹CÚ‹xtEv’t
::
	$D—Îoÿ‹CÚ‹xtEv’t
()

181 : 
	`Ev’t
(
CPU_Tick_Pri
), 
	`tid
(0), 
	`»move
(
çl£
), 
	$ıu
(
NULL
)

183 
	}
}

185 
	g‹m¶©e
 <
şass
 
	gIm¶
>

187 
	gFuÎO3CPU
<
	gIm¶
>::
D—Îoÿ‹CÚ‹xtEv’t
::
š™
(
th»ad_num
,

188 
FuÎO3CPU
<
Im¶
> *
th»ad_ıu
)

190 
	gtid
 = 
th»ad_num
;

191 
	gıu
 = 
th»ad_ıu
;

192 
	g»move
 = 
çl£
;

195 
	g‹m¶©e
 <
şass
 
	gIm¶
>

197 
	gFuÎO3CPU
<
	gIm¶
>::
D—Îoÿ‹CÚ‹xtEv’t
::
	$´oûss
()

199 
ıu
->
	`d—ùiv©eTh»ad
(
tid
);

200 ià(
»move
)

201 
ıu
->
	`»moveTh»ad
(
tid
);

202 
	}
}

204 
	g‹m¶©e
 <
şass
 
	gIm¶
>

206 
	gFuÎO3CPU
<
	gIm¶
>::
D—Îoÿ‹CÚ‹xtEv’t
::
	$desütiÚ
() const

209 
	}
}

211 
	g‹m¶©e
 <
şass
 
	gIm¶
>

212 
	gFuÎO3CPU
<
	gIm¶
>::
	$FuÎO3CPU
(
D”ivO3CPUP¬ams
 *
·¿ms
)

213 : 
	`Ba£O3CPU
(
·¿ms
),

214 
	`™b
(
·¿ms
->
™b
),

215 
	`dtb
(
·¿ms
->
dtb
),

216 
	`tickEv’t
(
this
),

217 #iâdeà
NDEBUG


218 
	`š¡couÁ
(0),

220 
	`»moveIn¡sThisCyşe
(
çl£
),

221 
	`ãtch
(
this
, 
·¿ms
),

222 
	`decode
(
this
, 
·¿ms
),

223 
	`»Çme
(
this
, 
·¿ms
),

224 
	`›w
(
this
, 
·¿ms
),

225 
	`comm™
(
this
, 
·¿ms
),

227 
	`»gFe
(
·¿ms
->
numPhysIÁRegs
,

228 
·¿ms
->
numPhysFlßtRegs
,

229 
·¿ms
->
numPhysCCRegs
),

231 
	`ä“Li¡
(
	`Çme
(è+ ".ä“li¡", &
»gFe
),

233 
	`rob
(
this
, 
·¿ms
),

235 
	`scÜebßrd
(
	`Çme
() + ".scoreboard",

236 
»gFe
.
	`tÙ®NumPhysRegs
(), 
TheISA
::
NumMiscRegs
,

237 
TheISA
::
Z”oReg
, TheISA::ZeroReg),

239 
	`i§
(
numTh»ads
, 
NULL
),

241 
	`iÿchePÜt
(&
ãtch
, 
this
),

242 
	`dÿchePÜt
(&
›w
.
ld¡Queue
, 
this
),

244 
	`timeBufãr
(
·¿ms
->
backComSize
,…¬ams->
fÜw¬dComSize
),

245 
	`ãtchQueue
(
·¿ms
->
backComSize
,…¬ams->
fÜw¬dComSize
),

246 
	`decodeQueue
(
·¿ms
->
backComSize
,…¬ams->
fÜw¬dComSize
),

247 
	`»ÇmeQueue
(
·¿ms
->
backComSize
,…¬ams->
fÜw¬dComSize
),

248 
	`›wQueue
(
·¿ms
->
backComSize
,…¬ams->
fÜw¬dComSize
),

249 
	`aùiv™yRec
(
	`Çme
(), 
NumSges
,

250 
·¿ms
->
backComSize
 +…¬ams->
fÜw¬dComSize
,

251 
·¿ms
->
aùiv™y
),

253 
	`glob®SeqNum
(1),

254 
	`sy¡em
(
·¿ms
->
sy¡em
),

255 
	`d¿šMªag”
(
NULL
),

256 
	`Ï¡RuÂšgCyşe
(
	$curCyşe
())

258 ià(!
·¿ms
->
sw™ched_out
) {

259 
_¡©us
 = 
RuÂšg
;

261 
_¡©us
 = 
Sw™chedOut
;

264 ià(
·¿ms
->
check”
) {

265 
Ba£CPU
 *
‹mp_check”
 = 
·¿ms
->
check”
;

266 
check”
 = 
dyÇmic_ÿ¡
<
Check”
<
Im¶
> *>(
‹mp_check”
);

267 
check”
->
	`£tIÿchePÜt
(&
iÿchePÜt
);

268 
check”
->
	`£tSy¡em
(
·¿ms
->
sy¡em
);

270 
check”
 = 
NULL
;

273 ià(!
FuÎSy¡em
) {

274 
th»ad
.
	`»size
(
numTh»ads
);

275 
tids
.
	`»size
(
numTh»ads
);

283 
ãtch
.
	`£tAùiveTh»ads
(&
aùiveTh»ads
);

284 
decode
.
	`£tAùiveTh»ads
(&
aùiveTh»ads
);

285 
»Çme
.
	`£tAùiveTh»ads
(&
aùiveTh»ads
);

286 
›w
.
	`£tAùiveTh»ads
(&
aùiveTh»ads
);

287 
comm™
.
	`£tAùiveTh»ads
(&
aùiveTh»ads
);

290 
ãtch
.
	`£tTimeBufãr
(&
timeBufãr
);

291 
decode
.
	`£tTimeBufãr
(&
timeBufãr
);

292 
»Çme
.
	`£tTimeBufãr
(&
timeBufãr
);

293 
›w
.
	`£tTimeBufãr
(&
timeBufãr
);

294 
comm™
.
	`£tTimeBufãr
(&
timeBufãr
);

297 
ãtch
.
	`£tF‘chQueue
(&
ãtchQueue
);

298 
decode
.
	`£tF‘chQueue
(&
ãtchQueue
);

299 
comm™
.
	`£tF‘chQueue
(&
ãtchQueue
);

300 
decode
.
	`£tDecodeQueue
(&
decodeQueue
);

301 
»Çme
.
	`£tDecodeQueue
(&
decodeQueue
);

302 
»Çme
.
	`£tR’ameQueue
(&
»ÇmeQueue
);

303 
›w
.
	`£tR’ameQueue
(&
»ÇmeQueue
);

304 
›w
.
	`£tIEWQueue
(&
›wQueue
);

305 
comm™
.
	`£tIEWQueue
(&
›wQueue
);

306 
comm™
.
	`£tR’ameQueue
(&
»ÇmeQueue
);

308 
comm™
.
	`£tIEWSge
(&
›w
);

309 
»Çme
.
	`£tIEWSge
(&
›w
);

310 
»Çme
.
	`£tComm™Sge
(&
comm™
);

312 
Th»adID
 
aùive_th»ads
;

313 ià(
FuÎSy¡em
) {

314 
aùive_th»ads
 = 1;

316 
aùive_th»ads
 = 
·¿ms
->
wÜklßd
.
	`size
();

318 ià(
aùive_th»ads
 > 
Im¶
::
MaxTh»ads
) {

319 
	`·nic
("Workload Sizeoo†arge. Increasehe 'MaxThreads' "

326 
	`as£¹
(
·¿ms
->
numPhysIÁRegs
 >ğ
numTh»ads
 * 
TheISA
::
NumIÁRegs
);

327 
	`as£¹
(
·¿ms
->
numPhysFlßtRegs
 >ğ
numTh»ads
 * 
TheISA
::
NumFlßtRegs
);

328 
	`as£¹
(
·¿ms
->
numPhysCCRegs
 >ğ
numTh»ads
 * 
TheISA
::
NumCCRegs
);

330 
»Çme
.
	`£tScÜebßrd
(&
scÜebßrd
);

331 
›w
.
	`£tScÜebßrd
(&
scÜebßrd
);

334 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

335 
i§
[
tid
] = 
·¿ms
->isa[tid];

340 
RegIndex
 
šv®idFPReg
 = 
TheISA
::
NumFlßtRegs
 + 1;

341 
RegIndex
 
åZ”oReg
 =

342 (
THE_ISA
 =ğ
ALPHA_ISA
è? 
TheISA
::
Z”oReg
 : 
šv®idFPReg
;

344 
comm™R’ameM­
[
tid
].
	`š™
(&
»gFe
, 
TheISA
::
Z”oReg
, 
åZ”oReg
,

345 &
ä“Li¡
);

347 
»ÇmeM­
[
tid
].
	`š™
(&
»gFe
, 
TheISA
::
Z”oReg
, 
åZ”oReg
,

348 &
ä“Li¡
);

350 
aùiv©eTh»adEv’t
[
tid
].
	`š™
Ñid, 
this
);

351 
d—Îoÿ‹CÚ‹xtEv’t
[
tid
].
	`š™
Ñid, 
this
);

356 
Th»adID
 
tid
 = 0;id < 
aùive_th»ads
;id++) {

357 
RegIndex
 
ridx
 = 0;„idx < 
TheISA
::
NumIÁRegs
; ++ridx) {

360 
PhysRegIndex
 
phys_»g
 = 
ä“Li¡
.
	`g‘IÁReg
();

361 
»ÇmeM­
[
tid
].
	`£tIÁEÁry
(
ridx
, 
phys_»g
);

362 
comm™R’ameM­
[
tid
].
	`£tIÁEÁry
(
ridx
, 
phys_»g
);

365 
RegIndex
 
ridx
 = 0;„idx < 
TheISA
::
NumFlßtRegs
; ++ridx) {

366 
PhysRegIndex
 
phys_»g
 = 
ä“Li¡
.
	`g‘FlßtReg
();

367 
»ÇmeM­
[
tid
].
	`£tFlßtEÁry
(
ridx
, 
phys_»g
);

368 
comm™R’ameM­
[
tid
].
	`£tFlßtEÁry
(
ridx
, 
phys_»g
);

371 
RegIndex
 
ridx
 = 0;„idx < 
TheISA
::
NumCCRegs
; ++ridx) {

372 
PhysRegIndex
 
phys_»g
 = 
ä“Li¡
.
	`g‘CCReg
();

373 
»ÇmeM­
[
tid
].
	`£tCCEÁry
(
ridx
, 
phys_»g
);

374 
comm™R’ameM­
[
tid
].
	`£tCCEÁry
(
ridx
, 
phys_»g
);

378 
»Çme
.
	`£tR’ameM­
(
»ÇmeM­
);

379 
comm™
.
	`£tR’ameM­
(
comm™R’ameM­
);

380 
»Çme
.
	`£tF»eLi¡
(&
ä“Li¡
);

383 
comm™
.
	`£tROB
(&
rob
);

385 
Ï¡Aùiv©edCyşe
 = 0;

388 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++)

389 
glob®SeqNum
[
tid
] = 1;

392 
cÚ‹xtSw™ch
 = 
çl£
;

393 
	`DPRINTF
(
O3CPU
, "Creating O3CPU object.\n");

396 
this
->
th»ad
.
	`»size
Ñhis->
numTh»ads
);

398 
Th»adID
 
tid
 = 0;id < 
this
->
numTh»ads
; ++tid) {

399 ià(
FuÎSy¡em
) {

401 
	`as£¹
(
this
->
numTh»ads
 == 1);

402 
this
->
th»ad
[
tid
] = 
Ãw
 
	`Th»ad
Ñhis, 0, 
NULL
);

404 ià(
tid
 < 
·¿ms
->
wÜklßd
.
	`size
()) {

405 
	`DPRINTF
(
O3CPU
, "Workload[%i]…rocess is %#x",

406 
tid
, 
this
->
th»ad
[tid]);

407 
this
->
th»ad
[
tid
] = 
Ãw
 
ty³Çme
 
FuÎO3CPU
<
Im¶
>::
	`Th»ad
(

408 (
ty³Çme
 
Im¶
::
O3CPU
 *)(
this
),

409 
tid
, 
·¿ms
->
wÜklßd
[tid]);

416 
Proûss
* 
dummy_´oc
 = 
NULL
;

418 
this
->
th»ad
[
tid
] = 
Ãw
 
ty³Çme
 
FuÎO3CPU
<
Im¶
>::
	`Th»ad
(

419 (
ty³Çme
 
Im¶
::
O3CPU
 *)(
this
),

420 
tid
, 
dummy_´oc
);

425 
Th»adCÚ‹xt
 *
tc
;

428 
O3Th»adCÚ‹xt
<
Im¶
> *
o3_tc
 = 
Ãw
 O3ThreadContext<Impl>;

430 
tc
 = 
o3_tc
;

434 ià(
·¿ms
->
check”
) {

435 
tc
 = 
Ãw
 
Check”Th»adCÚ‹xt
<
O3Th»adCÚ‹xt
<
Im¶
> >(

436 
o3_tc
, 
this
->
check”
);

439 
o3_tc
->
ıu
 = (
ty³Çme
 
Im¶
::
O3CPU
 *)(
this
);

440 
	`as£¹
(
o3_tc
->
ıu
);

441 
o3_tc
->
th»ad
 = 
this
->th»ad[
tid
];

443 ià(
FuÎSy¡em
) {

445 
this
->
th»ad
[
tid
]->
qu›sûEv’t
 = 
Ãw
 
	`EndQu›sûEv’t
(
tc
);

448 
this
->
th»ad
[
tid
]->
tc
 =c;

451 
this
->
th»adCÚ‹xts
.
	`push_back
(
tc
);

455 ià(!
·¿ms
->
sw™ched_out
 && !
š‹¼u±s
) {

456 
	`çl
("FullO3CPU %s has‚o interrupt controller.\n"

457 "Ensu» c»©eIÁ”ru±CÚŒŞËr(èi ÿÎed.\n", 
	`Çme
());

460 
Th»adID
 
tid
 = 0;id < 
this
->
numTh»ads
;id++)

461 
this
->
th»ad
[
tid
]->
	`£tFuncExeIn¡
(0);

462 
	}
}

464 
	g‹m¶©e
 <
şass
 
	gIm¶
>

465 
	gFuÎO3CPU
<
	gIm¶
>::~
	$FuÎO3CPU
()

467 
	}
}

469 
‹m¶©e
 <
şass
 
Im¶
>

471 
FuÎO3CPU
<
Im¶
>::
	$»gSts
()

473 
Ba£O3CPU
::
	`»gSts
();

476 
timesIdËd


477 .
	`Çme
(name() + ".timesIdled")

478 .
	`desc
("Number ofimeshatheƒntire CPU went into‡n idle state‡nd"

480 .
	`´”eq
(
timesIdËd
);

482 
idËCyşes


483 .
	`Çme
(name() + ".idleCycles")

484 .
	`desc
("Total‚umber of cycleshathe CPU has spent unscheduled due "

486 .
	`´”eq
(
idËCyşes
);

488 
qu›sûCyşes


489 .
	`Çme
(name() + ".quiesceCycles")

490 .
	`desc
("Total‚umber of cycleshat CPU has spent quiesced or waiting "

492 .
	`´”eq
(
qu›sûCyşes
);

498 
comm™‹dIn¡s


499 .
	`š™
(
numTh»ads
)

500 .
	`Çme
(name() + ".committedInsts")

501 .
	`desc
("Number of Instructions Simulated");

503 
comm™‹dOps


504 .
	`š™
(
numTh»ads
)

505 .
	`Çme
(name() + ".committedOps")

506 .
	`desc
("Number of Ops (including micro ops) Simulated");

508 
tÙ®Comm™‹dIn¡s


509 .
	`Çme
(name() + ".committedInsts_total")

510 .
	`desc
("Number of Instructions Simulated");

512 
ıi


513 .
	`Çme
(name() + ".cpi")

514 .
	`desc
("CPI: Cycles Per Instruction")

515 .
	`´ecisiÚ
(6);

516 
ıi
 = 
numCyşes
 / 
comm™‹dIn¡s
;

518 
tÙ®Cpi


519 .
	`Çme
(name() + ".cpi_total")

520 .
	`desc
("CPI: Total CPI of All Threads")

521 .
	`´ecisiÚ
(6);

522 
tÙ®Cpi
 = 
numCyşes
 / 
tÙ®Comm™‹dIn¡s
;

524 
c


525 .
	`Çme
(name() + ".ipc")

526 .
	`desc
("IPC: Instructions Per Cycle")

527 .
	`´ecisiÚ
(6);

528 
c
 = 
comm™‹dIn¡s
 / 
numCyşes
;

530 
tÙ®Ipc


531 .
	`Çme
(name() + ".ipc_total")

532 .
	`desc
("IPC: Total IPC of All Threads")

533 .
	`´ecisiÚ
(6);

534 
tÙ®Ipc
 = 
tÙ®Comm™‹dIn¡s
 / 
numCyşes
;

536 
this
->
ãtch
.
	`»gSts
();

537 
this
->
decode
.
	`»gSts
();

538 
this
->
»Çme
.
	`»gSts
();

539 
this
->
›w
.
	`»gSts
();

540 
this
->
comm™
.
	`»gSts
();

541 
this
->
rob
.
	`»gSts
();

543 
štRegfeR—ds


544 .
	`Çme
(name() + ".int_regfile_reads")

545 .
	`desc
("number of integer„egfile„eads")

546 .
	`´”eq
(
štRegfeR—ds
);

548 
štRegfeWr™es


549 .
	`Çme
(name() + ".int_regfile_writes")

550 .
	`desc
("number of integer„egfile writes")

551 .
	`´”eq
(
štRegfeWr™es
);

553 
åRegfeR—ds


554 .
	`Çme
(name() + ".fp_regfile_reads")

555 .
	`desc
("number of floating„egfile„eads")

556 .
	`´”eq
(
åRegfeR—ds
);

558 
åRegfeWr™es


559 .
	`Çme
(name() + ".fp_regfile_writes")

560 .
	`desc
("number of floating„egfile writes")

561 .
	`´”eq
(
åRegfeWr™es
);

563 
ccRegfeR—ds


564 .
	`Çme
(name() + ".cc_regfile_reads")

565 .
	`desc
("number of cc„egfile„eads")

566 .
	`´”eq
(
ccRegfeR—ds
);

568 
ccRegfeWr™es


569 .
	`Çme
(name() + ".cc_regfile_writes")

570 .
	`desc
("number of cc„egfile writes")

571 .
	`´”eq
(
ccRegfeWr™es
);

573 
miscRegfeR—ds


574 .
	`Çme
(name() + ".misc_regfile_reads")

575 .
	`desc
("number of misc„egfile„eads")

576 .
	`´”eq
(
miscRegfeR—ds
);

578 
miscRegfeWr™es


579 .
	`Çme
(name() + ".misc_regfile_writes")

580 .
	`desc
("number of misc„egfile writes")

581 .
	`´”eq
(
miscRegfeWr™es
);

582 
	}
}

584 
	g‹m¶©e
 <
şass
 
	gIm¶
>

586 
	gFuÎO3CPU
<
	gIm¶
>::
	$tick
()

588 
	`DPRINTF
(
O3CPU
, "\n\nFullO3CPU: Ticking main, FullO3CPU.\n");

589 
	`as£¹
(!
	`sw™chedOut
());

590 
	`as£¹
(
	`g‘D¿šS‹
(è!ğ
D¿šabË
::
D¿šed
);

592 ++
numCyşes
;

597 
ãtch
.
	`tick
();

599 
decode
.
	`tick
();

601 
»Çme
.
	`tick
();

603 
›w
.
	`tick
();

605 
comm™
.
	`tick
();

607 ià(!
FuÎSy¡em
)

608 
	`doCÚ‹xtSw™ch
();

611 
timeBufãr
.
	`advªû
();

613 
ãtchQueue
.
	`advªû
();

614 
decodeQueue
.
	`advªû
();

615 
»ÇmeQueue
.
	`advªû
();

616 
›wQueue
.
	`advªû
();

618 
aùiv™yRec
.
	`advªû
();

620 ià(
»moveIn¡sThisCyşe
) {

621 
	`ş—nUpRemovedIn¡s
();

624 ià(!
tickEv’t
.
	`scheduËd
()) {

625 ià(
_¡©us
 =ğ
Sw™chedOut
) {

626 
	`DPRINTF
(
O3CPU
, "Switched out!\n");

628 
Ï¡RuÂšgCyşe
 = 
	`curCyşe
();

629 } ià(!
aùiv™yRec
.
	`aùive
(è|| 
_¡©us
 =ğ
IdË
) {

630 
	`DPRINTF
(
O3CPU
, "Idle!\n");

631 
Ï¡RuÂšgCyşe
 = 
	`curCyşe
();

632 
timesIdËd
++;

634 
	`scheduË
(
tickEv’t
, 
	`şockEdge
(
	`Cyşes
(1)));

635 
	`DPRINTF
(
O3CPU
, "Scheduling‚extick!\n");

639 ià(!
FuÎSy¡em
)

640 
	`upd©eTh»adPriÜ™y
();

642 
	`ŒyD¿š
();

643 
	}
}

645 
	g‹m¶©e
 <
şass
 
	gIm¶
>

647 
	gFuÎO3CPU
<
	gIm¶
>::
	$š™
()

649 
Ba£CPU
::
	`š™
();

651 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

654 
th»ad
[
tid
]->
noSquashFromTC
 = 
Œue
;

656 
th»ad
[
tid
]->
	`š™MemProx›s
Ñh»ad[tid]->
	`g‘TC
());

659 ià(
FuÎSy¡em
 && !
	`·¿ms
()->
sw™ched_out
) {

660 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

661 
Th»adCÚ‹xt
 *
¤c_tc
 = 
th»adCÚ‹xts
[
tid
];

662 
TheISA
::
	`š™CPU
(
¤c_tc
, src_tc->
	`cÚ‹xtId
());

667 
tid
 = 0;id < 
numTh»ads
; ++tid)

668 
th»ad
[
tid
]->
noSquashFromTC
 = 
çl£
;

670 
comm™
.
	`£tTh»ads
(
th»ad
);

671 
	}
}

673 
	g‹m¶©e
 <
şass
 
	gIm¶
>

675 
	gFuÎO3CPU
<
	gIm¶
>::
	$¡¬tup
()

677 
Ba£CPU
::
	`¡¬tup
();

678 
tid
 = 0;id < 
numTh»ads
; ++tid)

679 
i§
[
tid
]->
	`¡¬tup
(
th»adCÚ‹xts
[tid]);

681 
ãtch
.
	`¡¬tupSge
();

682 
decode
.
	`¡¬tupSge
();

683 
›w
.
	`¡¬tupSge
();

684 
»Çme
.
	`¡¬tupSge
();

685 
comm™
.
	`¡¬tupSge
();

686 
	}
}

688 
	g‹m¶©e
 <
şass
 
	gIm¶
>

690 
	gFuÎO3CPU
<
	gIm¶
>::
	$aùiv©eTh»ad
(
Th»adID
 
tid
)

692 
li¡
<
Th»adID
>::
™”©Ü
 
isAùive
 =

693 
¡d
::
	`fšd
(
aùiveTh»ads
.
	`begš
(),‡ùiveTh»ads.
	`’d
(), 
tid
);

695 
	`DPRINTF
(
O3CPU
, "[tid:%i]: C®lšg‡ùiv©th»ad.\n", 
tid
);

696 
	`as£¹
(!
	`sw™chedOut
());

698 ià(
isAùive
 =ğ
aùiveTh»ads
.
	`’d
()) {

699 
	`DPRINTF
(
O3CPU
, "[tid:%i]: Addingo‡ctivehreads†ist\n",

700 
tid
);

702 
aùiveTh»ads
.
	`push_back
(
tid
);

704 
	}
}

706 
	g‹m¶©e
 <
şass
 
	gIm¶
>

708 
	gFuÎO3CPU
<
	gIm¶
>::
	$d—ùiv©eTh»ad
(
Th»adID
 
tid
)

711 
li¡
<
Th»adID
>::
™”©Ü
 
th»ad_™
 =

712 
¡d
::
	`fšd
(
aùiveTh»ads
.
	`begš
(),‡ùiveTh»ads.
	`’d
(), 
tid
);

714 
	`DPRINTF
(
O3CPU
, "[tid:%i]: C®lšg d—ùiv©th»ad.\n", 
tid
);

715 
	`as£¹
(!
	`sw™chedOut
());

717 ià(
th»ad_™
 !ğ
aùiveTh»ads
.
	`’d
()) {

718 
	`DPRINTF
(
O3CPU
,"[tid:%i]: Removing from‡ctivehreads†ist\n",

719 
tid
);

720 
aùiveTh»ads
.
	`”a£
(
th»ad_™
);

722 
	}
}

724 
	g‹m¶©e
 <
şass
 
	gIm¶
>

725 
CouÁ”


726 
	gFuÎO3CPU
<
	gIm¶
>::
	$tÙ®In¡s
() const

728 
CouÁ”
 
	`tÙ®
(0);

730 
Th»adID
 
size
 = 
th»ad
.
	`size
();

731 
Th»adID
 
i
 = 0; i < 
size
; i++)

732 
tÙ®
 +ğ
th»ad
[
i
]->
numIn¡
;

734  
tÙ®
;

735 
	}
}

737 
	g‹m¶©e
 <
şass
 
	gIm¶
>

738 
CouÁ”


739 
	gFuÎO3CPU
<
	gIm¶
>::
	$tÙ®Ops
() const

741 
CouÁ”
 
	`tÙ®
(0);

743 
Th»adID
 
size
 = 
th»ad
.
	`size
();

744 
Th»adID
 
i
 = 0; i < 
size
; i++)

745 
tÙ®
 +ğ
th»ad
[
i
]->
numOp
;

747  
tÙ®
;

748 
	}
}

750 
	g‹m¶©e
 <
şass
 
	gIm¶
>

752 
	gFuÎO3CPU
<
	gIm¶
>::
	$aùiv©eCÚ‹xt
(
Th»adID
 
tid
, 
Cyşes
 
d–ay
)

754 
	`as£¹
(!
	`sw™chedOut
());

757 ià(
d–ay
){

758 
	`DPRINTF
(
O3CPU
, "[tid:%i]: Schedulinghread contexto‡ctivate "

759 "Ú cyş%d\n", 
tid
, 
	`şockEdge
(
d–ay
));

760 
	`scheduËAùiv©eTh»adEv’t
(
tid
, 
d–ay
);

762 
	`aùiv©eTh»ad
(
tid
);

768 ià(
	`g‘D¿šS‹
(è=ğ
D¿šabË
::
D¿šed
)

773 ià(
Ï¡Aùiv©edCyşe
 =ğ0 ||†a¡Aùiv©edCyş< 
	`curTick
()) {

774 
	`scheduËTickEv’t
(
d–ay
);

778 
aùiv™yRec
.
	`aùiv™y
();

779 
ãtch
.
	`wakeFromQu›sû
();

781 
Cyşes
 
	`cyşes
(
	`curCyşe
(è- 
Ï¡RuÂšgCyşe
);

783 ià(
cyşes
 != 0)

784 --
cyşes
;

785 
qu›sûCyşes
 +ğ
cyşes
;

787 
Ï¡Aùiv©edCyşe
 = 
	`curTick
();

789 
_¡©us
 = 
RuÂšg
;

791 
	}
}

793 
	g‹m¶©e
 <
şass
 
	gIm¶
>

794 
boŞ


795 
	gFuÎO3CPU
<
	gIm¶
>::
	$scheduËD—Îoÿ‹CÚ‹xt
(
Th»adID
 
tid
, 
boŞ
 
»move
,

796 
Cyşes
 
d–ay
)

799 ià(
d–ay
){

800 
	`DPRINTF
(
O3CPU
, "[tid:%i]: Schedulinghread contexto deallocate "

801 "Úick %d\n", 
tid
, 
	`şockEdge
(
d–ay
));

802 
	`scheduËD—Îoÿ‹CÚ‹xtEv’t
(
tid
, 
»move
, 
d–ay
);

803  
çl£
;

805 
	`d—ùiv©eTh»ad
(
tid
);

806 ià(
»move
)

807 
	`»moveTh»ad
(
tid
);

808  
Œue
;

810 
	}
}

812 
	g‹m¶©e
 <
şass
 
	gIm¶
>

814 
	gFuÎO3CPU
<
	gIm¶
>::
	$su¥’dCÚ‹xt
(
Th»adID
 
tid
)

816 
	`DPRINTF
(
O3CPU
,"[tid: %i]: Su¥’dšg Th»ad CÚ‹xt.\n", 
tid
);

817 
	`as£¹
(!
	`sw™chedOut
());

818 
boŞ
 
d—Îoÿ‹d
 = 
	`scheduËD—Îoÿ‹CÚ‹xt
(
tid
, 
çl£
, 
	`Cyşes
(1));

820 ià((
aùiveTh»ads
.
	`size
(è=ğ1 && !
d—Îoÿ‹d
) ||

821 
aùiveTh»ads
.
	`size
() == 0)

822 
	`unscheduËTickEv’t
();

824 
	`DPRINTF
(
Qu›sû
, "Suspending Context\n");

825 
Ï¡RuÂšgCyşe
 = 
	`curCyşe
();

826 
_¡©us
 = 
IdË
;

827 
	}
}

829 
	g‹m¶©e
 <
şass
 
	gIm¶
>

831 
	gFuÎO3CPU
<
	gIm¶
>::
	$h®tCÚ‹xt
(
Th»adID
 
tid
)

834 
	`DPRINTF
(
O3CPU
,"[tid:%i]: H®ˆCÚ‹xˆÿÎed. D—Îoÿtšg", 
tid
);

835 
	`as£¹
(!
	`sw™chedOut
());

836 
	`scheduËD—Îoÿ‹CÚ‹xt
(
tid
, 
Œue
, 
	`Cyşes
(1));

837 
	}
}

839 
	g‹m¶©e
 <
şass
 
	gIm¶
>

841 
	gFuÎO3CPU
<
	gIm¶
>::
	$š£¹Th»ad
(
Th»adID
 
tid
)

843 
	`DPRINTF
(
O3CPU
,"[tid:%i] Initializinghread into CPU");

846 
Th»adCÚ‹xt
 *
¤c_tc
;

847 ià(
FuÎSy¡em
)

848 
¤c_tc
 = 
sy¡em
->
th»adCÚ‹xts
[
tid
];

850 
¤c_tc
 = 
	`tcBa£
(
tid
);

853 
œeg
 = 0; i»g < 
TheISA
::
NumIÁRegs
; ireg++) {

854 
PhysRegIndex
 
phys_»g
 = 
ä“Li¡
.
	`g‘IÁReg
();

856 
»ÇmeM­
[
tid
].
	`£tEÁry
(
œeg
,
phys_»g
);

857 
scÜebßrd
.
	`£tReg
(
phys_»g
);

861 
max_»g
 = 
TheISA
::
NumIÁRegs
 + TheISA::
NumFlßtRegs
;

862 
äeg
 = 
TheISA
::
NumIÁRegs
; f»g < 
max_»g
; freg++) {

863 
PhysRegIndex
 
phys_»g
 = 
ä“Li¡
.
	`g‘FlßtReg
();

865 
»ÇmeM­
[
tid
].
	`£tEÁry
(
äeg
,
phys_»g
);

866 
scÜebßrd
.
	`£tReg
(
phys_»g
);

870 
max_»g
 = 
TheISA
::
NumIÁRegs
 + TheISA::
NumFlßtRegs
 + TheISA::
NumCCRegs
;

871 
üeg
 = 
TheISA
::
NumIÁRegs
 + TheISA::
NumFlßtRegs
;

872 
üeg
 < 
max_»g
; creg++) {

873 
PhysRegIndex
 
phys_»g
 = 
ä“Li¡
.
	`g‘CCReg
();

875 
»ÇmeM­
[
tid
].
	`£tEÁry
(
üeg
,
phys_»g
);

876 
scÜebßrd
.
	`£tReg
(
phys_»g
);

883 
	`pcS‹
(
¤c_tc
->pcS‹(), 
tid
);

885 
¤c_tc
->
	`£tStus
(
Th»adCÚ‹xt
::
Aùive
);

887 
	`aùiv©eCÚ‹xt
(
tid
, 
	`Cyşes
(1));

890 
comm™
.
rob
->
	`»£tEÁr›s
();

891 
›w
.
	`»£tEÁr›s
();

892 
	}
}

894 
	g‹m¶©e
 <
şass
 
	gIm¶
>

896 
	gFuÎO3CPU
<
	gIm¶
>::
	$»moveTh»ad
(
Th»adID
 
tid
)

898 
	`DPRINTF
(
O3CPU
,"[tid:%i] Removšgh»ad cÚ‹xˆäom CPU.\n", 
tid
);

910 
œeg
 = 0; i»g < 
TheISA
::
NumIÁRegs
; ireg++) {

911 
PhysRegIndex
 
phys_»g
 = 
»ÇmeM­
[
tid
].
	`lookup
(
œeg
);

913 
scÜebßrd
.
	`un£tReg
(
phys_»g
);

914 
ä“Li¡
.
	`addReg
(
phys_»g
);

918 
max_»g
 = 
TheISA
::
NumIÁRegs
 + TheISA::
NumFlßtRegs
;

919 
äeg
 = 
TheISA
::
NumIÁRegs
; f»g < 
max_»g
; freg++) {

920 
PhysRegIndex
 
phys_»g
 = 
»ÇmeM­
[
tid
].
	`lookup
(
äeg
);

922 
scÜebßrd
.
	`un£tReg
(
phys_»g
);

923 
ä“Li¡
.
	`addReg
(
phys_»g
);

927 
max_»g
 = 
TheISA
::
NumIÁRegs
 + TheISA::
NumFlßtRegs
 + TheISA::
NumCCRegs
;

928 
üeg
 = 
TheISA
::
NumIÁRegs
 + TheISA::
NumFlßtRegs
;

929 
üeg
 < 
max_»g
; creg++) {

930 
PhysRegIndex
 
phys_»g
 = 
»ÇmeM­
[
tid
].
	`lookup
(
üeg
);

932 
scÜebßrd
.
	`un£tReg
(
phys_»g
);

933 
ä“Li¡
.
	`addReg
(
phys_»g
);

937 
DynIn¡PŒ
 
š¡
 = 
comm™
.
rob
->
	`»adH—dIn¡
(
tid
);

938 
In¡SeqNum
 
squash_£q_num
 = 
š¡
->
£qNum
;

939 
ãtch
.
	`squash
(0, 
squash_£q_num
, 
š¡
, 
tid
);

940 
decode
.
	`squash
(
tid
);

941 
»Çme
.
	`squash
(
squash_£q_num
, 
tid
);

942 
›w
.
	`squash
(
tid
);

943 
›w
.
ld¡Queue
.
	`squash
(
squash_£q_num
, 
tid
);

944 
comm™
.
rob
->
	`squash
(
squash_£q_num
, 
tid
);

947 
	`as£¹
(
›w
.
š¡Queue
.
	`g‘CouÁ
(
tid
) == 0);

948 
	`as£¹
(
›w
.
ld¡Queue
.
	`g‘CouÁ
(
tid
) == 0);

962 
	}
}

965 
	g‹m¶©e
 <
şass
 
	gIm¶
>

967 
	gFuÎO3CPU
<
	gIm¶
>::
	$aùiv©eWh’R—dy
(
Th»adID
 
tid
)

969 
	`DPRINTF
(
O3CPU
,"[tid:%i]: Checking if„esources‡re‡vailable for incoming"

971 
tid
);

973 
boŞ
 
»ady
 = 
Œue
;

976 ià(
ä“Li¡
.
	`numF»eIÁRegs
(è>ğ
TheISA
::
NumIÁRegs
) {

977 
	`DPRINTF
(
O3CPU
,"[tid:%i] Suspendinghread dueo‚otƒnough "

979 
tid
);

980 
»ady
 = 
çl£
;

981 } ià(
ä“Li¡
.
	`numF»eFlßtRegs
(è>ğ
TheISA
::
NumFlßtRegs
) {

982 
	`DPRINTF
(
O3CPU
,"[tid:%i] Suspendinghread dueo‚otƒnough "

984 
tid
);

985 
»ady
 = 
çl£
;

986 } ià(
ä“Li¡
.
	`numF»eCCRegs
(è>ğ
TheISA
::
NumCCRegs
) {

987 
	`DPRINTF
(
O3CPU
,"[tid:%i] Suspendinghread dueo‚otƒnough "

989 
tid
);

990 
»ady
 = 
çl£
;

991 } ià(
comm™
.
rob
->
	`numF»eEÁr›s
() >=

992 
comm™
.
rob
->
	`’ŒyAmouÁ
(
aùiveTh»ads
.
	`size
() + 1)) {

993 
	`DPRINTF
(
O3CPU
,"[tid:%i] Suspendinghread dueo‚otƒnough "

995 
tid
);

996 
»ady
 = 
çl£
;

997 } ià(
›w
.
š¡Queue
.
	`numF»eEÁr›s
() >=

998 
›w
.
š¡Queue
.
	`’ŒyAmouÁ
(
aùiveTh»ads
.
	`size
() + 1)) {

999 
	`DPRINTF
(
O3CPU
,"[tid:%i] Suspendinghread dueo‚otƒnough "

1001 
tid
);

1002 
»ady
 = 
çl£
;

1003 } ià(
›w
.
ld¡Queue
.
	`numF»eEÁr›s
() >=

1004 
›w
.
ld¡Queue
.
	`’ŒyAmouÁ
(
aùiveTh»ads
.
	`size
() + 1)) {

1005 
	`DPRINTF
(
O3CPU
,"[tid:%i] Suspendinghread dueo‚otƒnough "

1007 
tid
);

1008 
»ady
 = 
çl£
;

1011 ià(
»ady
) {

1012 
	`š£¹Th»ad
(
tid
);

1014 
cÚ‹xtSw™ch
 = 
çl£
;

1016 
ıuWa™Li¡
.
	`»move
(
tid
);

1018 
	`su¥’dCÚ‹xt
(
tid
);

1021 
cÚ‹xtSw™ch
 = 
Œue
;

1025 
ıuWa™Li¡
.
	`push_back
(
tid
);

1027 
	}
}

1029 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1030 
FauÉ


1031 
	gFuÎO3CPU
<
	gIm¶
>::
	$hw»i
(
Th»adID
 
tid
)

1033 #ià
THE_ISA
 =ğ
ALPHA_ISA


1035 
this
->
	`£tMiscRegNoEfãù
(
AÍhaISA
::
MISCREG_LOCKFLAG
, 
çl£
, 
tid
);

1037 
this
->
th»ad
[
tid
]->
k”ÃlSts
->
	`hw»i
();

1041  
NoFauÉ
;

1042 
	}
}

1044 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1045 
boŞ


1046 
	gFuÎO3CPU
<
	gIm¶
>::
	$simP®Check
(
·lFunc
, 
Th»adID
 
tid
)

1048 #ià
THE_ISA
 =ğ
ALPHA_ISA


1049 ià(
this
->
th»ad
[
tid
]->
k”ÃlSts
)

1050 
this
->
th»ad
[
tid
]->
k”ÃlSts
->
	`ÿÎ·l
(
·lFunc
,

1051 
this
->
th»adCÚ‹xts
[
tid
]);

1053 
·lFunc
) {

1054 
PAL
::
h®t
:

1055 
	`h®t
();

1056 ià(--
Sy¡em
::
numSy¡emsRuÂšg
 == 0)

1057 
	`ex™SimLoİ
("all cpus halted");

1060 
PAL
::
b±
:

1061 
PAL
::
bugchk
:

1062 ià(
this
->
sy¡em
->
	`b»akpošt
())

1063  
çl£
;

1067  
Œue
;

1068 
	}
}

1070 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1071 
FauÉ


1072 
	gFuÎO3CPU
<
	gIm¶
>::
	$g‘IÁ”ru±s
()

1075  
this
->
š‹¼u±s
->
	`g‘IÁ”ru±
Ñhis->
th»adCÚ‹xts
[0]);

1076 
	}
}

1078 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1080 
	gFuÎO3CPU
<
	gIm¶
>::
	$´oûssIÁ”ru±s
(
FauÉ
 
š‹¼u±
)

1088 
	`as£¹
(
š‹¼u±
 !ğ
NoFauÉ
);

1089 
this
->
š‹¼u±s
->
	`upd©eIÁrInfo
Ñhis->
th»adCÚ‹xts
[0]);

1091 
	`DPRINTF
(
O3CPU
, "IÁ”ru± % bešg hªdËd\n", 
š‹¼u±
->
	`Çme
());

1092 
this
->
	`Œ­
(
š‹¼u±
, 0, 
NULL
);

1093 
	}
}

1095 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1097 
	gFuÎO3CPU
<
	gIm¶
>::
	$Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
SticIn¡PŒ
 
š¡
)

1100 
çuÉ
->
	`švoke
(
this
->
th»adCÚ‹xts
[
tid
], 
š¡
);

1101 
	}
}

1103 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1105 
	gFuÎO3CPU
<
	gIm¶
>::
	$sysÿÎ
(
št64_t
 
ÿÎnum
, 
Th»adID
 
tid
)

1107 
	`DPRINTF
(
O3CPU
, "[tid:%i] Executšg sysÿÎ().\n\n", 
tid
);

1109 
	`DPRINTF
(
Aùiv™y
,"Activity: syscall() called.\n");

1113 ++(
this
->
th»ad
[
tid
]->
funcExeIn¡
);

1116 
this
->
th»ad
[
tid
]->
	`sysÿÎ
(
ÿÎnum
);

1120 --(
this
->
th»ad
[
tid
]->
funcExeIn¡
);

1121 
	}
}

1123 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1125 
	gFuÎO3CPU
<
	gIm¶
>::
£rŸlizeTh»ad
(
¡d
::
o¡»am
 &
os
, 
Th»adID
 
tid
)

1127 
	gth»ad
[
tid
]->
£rŸlize
(
os
);

1130 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1132 
	gFuÎO3CPU
<
	gIm¶
>::
un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
,

1133 
Th»adID
 
tid
)

1135 
	gth»ad
[
tid
]->
un£rŸlize
(
ı
, 
£ùiÚ
);

1138 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1140 
	gFuÎO3CPU
<
	gIm¶
>::
	$d¿š
(
D¿šMªag”
 *
d¿š_mªag”
)

1143 ià(
	`sw™chedOut
()) {

1144 
	`£tD¿šS‹
(
D¿šabË
::
D¿šed
);

1148 
	`DPRINTF
(
D¿š
, "Draining...\n");

1149 
	`£tD¿šS‹
(
D¿šabË
::
D¿ššg
);

1157 
comm™
.
	`d¿š
();

1161 ià(!
	`isD¿šed
()) {

1162 
d¿šMªag”
 = 
d¿š_mªag”
;

1164 
	`wakeCPU
();

1165 
aùiv™yRec
.
	`aùiv™y
();

1167 
	`DPRINTF
(
D¿š
, "CPU‚ot drained\n");

1171 
	`£tD¿šS‹
(
D¿šabË
::
D¿šed
);

1172 
	`DPRINTF
(
D¿š
, "CPU is‡lready drained\n");

1173 ià(
tickEv’t
.
	`scheduËd
())

1174 
	`descheduË
(
tickEv’t
);

1180 
i
 = 0; i < 
timeBufãr
.
	`g‘Size
(); ++i) {

1181 
timeBufãr
.
	`advªû
();

1182 
ãtchQueue
.
	`advªû
();

1183 
decodeQueue
.
	`advªû
();

1184 
»ÇmeQueue
.
	`advªû
();

1185 
›wQueue
.
	`advªû
();

1188 
	`d¿šSª™yCheck
();

1191 
	}
}

1193 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1194 
boŞ


1195 
	gFuÎO3CPU
<
	gIm¶
>::
	$ŒyD¿š
()

1197 ià(!
d¿šMªag”
 || !
	`isD¿šed
())

1198  
çl£
;

1200 ià(
tickEv’t
.
	`scheduËd
())

1201 
	`descheduË
(
tickEv’t
);

1203 
	`DPRINTF
(
D¿š
, "CPU done draining,…rocessing drainƒvent\n");

1204 
d¿šMªag”
->
	`sigÇlD¿šDÚe
();

1205 
d¿šMªag”
 = 
NULL
;

1207  
Œue
;

1208 
	}
}

1210 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1212 
	gFuÎO3CPU
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

1214 
	`as£¹
(
	`isD¿šed
());

1215 
ãtch
.
	`d¿šSª™yCheck
();

1216 
decode
.
	`d¿šSª™yCheck
();

1217 
»Çme
.
	`d¿šSª™yCheck
();

1218 
›w
.
	`d¿šSª™yCheck
();

1219 
comm™
.
	`d¿šSª™yCheck
();

1220 
	}
}

1222 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1223 
boŞ


1224 
	gFuÎO3CPU
<
	gIm¶
>::
	$isD¿šed
() const

1226 
boŞ
 
	`d¿šed
(
Œue
);

1228 
Th»adID
 
i
 = 0; i < 
th»ad
.
	`size
(); ++i) {

1229 ià(
aùiv©eTh»adEv’t
[
i
].
	`scheduËd
()) {

1230 
	`DPRINTF
(
D¿š
, "CPU‚ot drained,read %i has‡ "

1231 "³ndšg‡ùiv©ev’t\n", 
i
);

1232 
d¿šed
 = 
çl£
;

1234 ià(
d—Îoÿ‹CÚ‹xtEv’t
[
i
].
	`scheduËd
()) {

1235 
	`DPRINTF
(
D¿š
, "CPU‚ot drained,read %i has‡ "

1236 "³ndšg d—Îoÿ‹ cÚ‹xˆev’t\n", 
i
);

1237 
d¿šed
 = 
çl£
;

1241 ià(!
š¡Li¡
.
	`em±y
(è|| !
»moveLi¡
.empty()) {

1242 
	`DPRINTF
(
D¿š
, "Main CPU structures‚ot drained.\n");

1243 
d¿šed
 = 
çl£
;

1246 ià(!
ãtch
.
	`isD¿šed
()) {

1247 
	`DPRINTF
(
D¿š
, "Fetch‚ot drained.\n");

1248 
d¿šed
 = 
çl£
;

1251 ià(!
decode
.
	`isD¿šed
()) {

1252 
	`DPRINTF
(
D¿š
, "Decode‚ot drained.\n");

1253 
d¿šed
 = 
çl£
;

1256 ià(!
»Çme
.
	`isD¿šed
()) {

1257 
	`DPRINTF
(
D¿š
, "Rename‚ot drained.\n");

1258 
d¿šed
 = 
çl£
;

1261 ià(!
›w
.
	`isD¿šed
()) {

1262 
	`DPRINTF
(
D¿š
, "IEW‚ot drained.\n");

1263 
d¿šed
 = 
çl£
;

1266 ià(!
comm™
.
	`isD¿šed
()) {

1267 
	`DPRINTF
(
D¿š
, "Commit‚ot drained.\n");

1268 
d¿šed
 = 
çl£
;

1271  
d¿šed
;

1272 
	}
}

1274 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1276 
	gFuÎO3CPU
<
	gIm¶
>::
	$comm™D¿šed
(
Th»adID
 
tid
)

1278 
ãtch
.
	`d¿šSÎ
(
tid
);

1279 
	}
}

1281 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1283 
	gFuÎO3CPU
<
	gIm¶
>::
	$d¿šResume
()

1285 
	`£tD¿šS‹
(
D¿šabË
::
RuÂšg
);

1286 ià(
	`sw™chedOut
())

1289 
	`DPRINTF
(
D¿š
, "Resuming...\n");

1290 
	`v”ifyMemÜyMode
();

1292 
ãtch
.
	`d¿šResume
();

1293 
comm™
.
	`d¿šResume
();

1295 
_¡©us
 = 
IdË
;

1296 
Th»adID
 
i
 = 0; i < 
th»ad
.
	`size
(); i++) {

1297 ià(
th»ad
[
i
]->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
) {

1298 
	`DPRINTF
(
D¿š
, "Aùiv©šgh»ad: %i\n", 
i
);

1299 
	`aùiv©eTh»ad
(
i
);

1300 
_¡©us
 = 
RuÂšg
;

1304 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

1305 ià(
_¡©us
 =ğ
RuÂšg
)

1306 
	`scheduË
(
tickEv’t
, 
	`ÃxtCyşe
());

1307 
	}
}

1309 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1311 
	gFuÎO3CPU
<
	gIm¶
>::
	$sw™chOut
()

1313 
	`DPRINTF
(
O3CPU
, "Switching out\n");

1314 
Ba£CPU
::
	`sw™chOut
();

1316 
aùiv™yRec
.
	`»£t
();

1318 
_¡©us
 = 
Sw™chedOut
;

1320 ià(
check”
)

1321 
check”
->
	`sw™chOut
();

1322 
	}
}

1324 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1326 
	gFuÎO3CPU
<
	gIm¶
>::
	$keOv”From
(
Ba£CPU
 *
ŞdCPU
)

1328 
Ba£CPU
::
	`keOv”From
(
ŞdCPU
);

1330 
ãtch
.
	`keOv”From
();

1331 
decode
.
	`keOv”From
();

1332 
»Çme
.
	`keOv”From
();

1333 
›w
.
	`keOv”From
();

1334 
comm™
.
	`keOv”From
();

1336 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

1338 
FuÎO3CPU
<
Im¶
> *
ŞdO3CPU
 = 
dyÇmic_ÿ¡
<FuÎO3CPU<Im¶>*>(
ŞdCPU
);

1339 ià(
ŞdO3CPU
)

1340 
glob®SeqNum
 = 
ŞdO3CPU
->globalSeqNum;

1342 
Ï¡RuÂšgCyşe
 = 
	`curCyşe
();

1343 
_¡©us
 = 
IdË
;

1344 
	}
}

1346 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1348 
	gFuÎO3CPU
<
	gIm¶
>::
	$v”ifyMemÜyMode
() const

1350 ià(!
sy¡em
->
	`isTimšgMode
()) {

1351 
	`çl
("The O3 CPU„equireshe memory systemo be in "

1354 
	}
}

1356 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1357 
	gTheISA
::
MiscReg


1358 
FuÎO3CPU
<
Im¶
>::
	$»adMiscRegNoEfãù
(
misc_»g
, 
Th»adID
 
tid
)

1360  
this
->
i§
[
tid
]->
	`»adMiscRegNoEfãù
(
misc_»g
);

1361 
	}
}

1363 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1364 
	gTheISA
::
MiscReg


1365 
FuÎO3CPU
<
Im¶
>::
	$»adMiscReg
(
misc_»g
, 
Th»adID
 
tid
)

1367 
miscRegfeR—ds
++;

1368  
this
->
i§
[
tid
]->
	`»adMiscReg
(
misc_»g
, 
	`tcBa£
(tid));

1369 
	}
}

1371 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1373 
	gFuÎO3CPU
<
	gIm¶
>::
£tMiscRegNoEfãù
(
misc_»g
,

1374 cÚ¡ 
TheISA
::
MiscReg
 &
v®
, 
Th»adID
 
tid
)

1376 
	gthis
->
	gi§
[
tid
]->
£tMiscRegNoEfãù
(
misc_»g
, 
v®
);

1379 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1381 
	gFuÎO3CPU
<
	gIm¶
>::
£tMiscReg
(
misc_»g
,

1382 cÚ¡ 
TheISA
::
MiscReg
 &
v®
, 
Th»adID
 
tid
)

1384 
	gmiscRegfeWr™es
++;

1385 
	gthis
->
	gi§
[
tid
]->
£tMiscReg
(
misc_»g
, 
v®
, 
tcBa£
(tid));

1388 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1389 
ušt64_t


1390 
	gFuÎO3CPU
<
	gIm¶
>::
	$»adIÁReg
(
»g_idx
)

1392 
štRegfeR—ds
++;

1393  
»gFe
.
	`»adIÁReg
(
»g_idx
);

1394 
	}
}

1396 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1397 
FlßtReg


1398 
	gFuÎO3CPU
<
	gIm¶
>::
	$»adFlßtReg
(
»g_idx
)

1400 
åRegfeR—ds
++;

1401  
»gFe
.
	`»adFlßtReg
(
»g_idx
);

1402 
	}
}

1404 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1405 
FlßtRegB™s


1406 
	gFuÎO3CPU
<
	gIm¶
>::
	$»adFlßtRegB™s
(
»g_idx
)

1408 
åRegfeR—ds
++;

1409  
»gFe
.
	`»adFlßtRegB™s
(
»g_idx
);

1410 
	}
}

1412 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1413 
CCReg


1414 
	gFuÎO3CPU
<
	gIm¶
>::
	$»adCCReg
(
»g_idx
)

1416 
ccRegfeR—ds
++;

1417  
»gFe
.
	`»adCCReg
(
»g_idx
);

1418 
	}
}

1420 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1422 
	gFuÎO3CPU
<
	gIm¶
>::
	$£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
)

1424 
štRegfeWr™es
++;

1425 
»gFe
.
	`£tIÁReg
(
»g_idx
, 
v®
);

1426 
	}
}

1428 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1430 
	gFuÎO3CPU
<
	gIm¶
>::
	$£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
)

1432 
åRegfeWr™es
++;

1433 
»gFe
.
	`£tFlßtReg
(
»g_idx
, 
v®
);

1434 
	}
}

1436 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1438 
	gFuÎO3CPU
<
	gIm¶
>::
	$£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
)

1440 
åRegfeWr™es
++;

1441 
»gFe
.
	`£tFlßtRegB™s
(
»g_idx
, 
v®
);

1442 
	}
}

1444 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1446 
	gFuÎO3CPU
<
	gIm¶
>::
	$£tCCReg
(
»g_idx
, 
CCReg
 
v®
)

1448 
ccRegfeWr™es
++;

1449 
»gFe
.
	`£tCCReg
(
»g_idx
, 
v®
);

1450 
	}
}

1452 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1453 
ušt64_t


1454 
	gFuÎO3CPU
<
	gIm¶
>::
	$»adArchIÁReg
(
»g_idx
, 
Th»adID
 
tid
)

1456 
štRegfeR—ds
++;

1457 
PhysRegIndex
 
phys_»g
 = 
comm™R’ameM­
[
tid
].
	`lookupIÁ
(
»g_idx
);

1459  
»gFe
.
	`»adIÁReg
(
phys_»g
);

1460 
	}
}

1462 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1464 
	gFuÎO3CPU
<
	gIm¶
>::
	$»adArchFlßtReg
(
»g_idx
, 
Th»adID
 
tid
)

1466 
åRegfeR—ds
++;

1467 
PhysRegIndex
 
phys_»g
 = 
comm™R’ameM­
[
tid
].
	`lookupFlßt
(
»g_idx
);

1469  
»gFe
.
	`»adFlßtReg
(
phys_»g
);

1470 
	}
}

1472 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1473 
ušt64_t


1474 
	gFuÎO3CPU
<
	gIm¶
>::
	$»adArchFlßtRegIÁ
(
»g_idx
, 
Th»adID
 
tid
)

1476 
åRegfeR—ds
++;

1477 
PhysRegIndex
 
phys_»g
 = 
comm™R’ameM­
[
tid
].
	`lookupFlßt
(
»g_idx
);

1479  
»gFe
.
	`»adFlßtRegB™s
(
phys_»g
);

1480 
	}
}

1482 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1483 
CCReg


1484 
	gFuÎO3CPU
<
	gIm¶
>::
	$»adArchCCReg
(
»g_idx
, 
Th»adID
 
tid
)

1486 
ccRegfeR—ds
++;

1487 
PhysRegIndex
 
phys_»g
 = 
comm™R’ameM­
[
tid
].
	`lookupCC
(
»g_idx
);

1489  
»gFe
.
	`»adCCReg
(
phys_»g
);

1490 
	}
}

1492 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1494 
	gFuÎO3CPU
<
	gIm¶
>::
	$£tArchIÁReg
(
»g_idx
, 
ušt64_t
 
v®
, 
Th»adID
 
tid
)

1496 
štRegfeWr™es
++;

1497 
PhysRegIndex
 
phys_»g
 = 
comm™R’ameM­
[
tid
].
	`lookupIÁ
(
»g_idx
);

1499 
»gFe
.
	`£tIÁReg
(
phys_»g
, 
v®
);

1500 
	}
}

1502 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1504 
	gFuÎO3CPU
<
	gIm¶
>::
	$£tArchFlßtReg
(
»g_idx
, 
v®
, 
Th»adID
 
tid
)

1506 
åRegfeWr™es
++;

1507 
PhysRegIndex
 
phys_»g
 = 
comm™R’ameM­
[
tid
].
	`lookupFlßt
(
»g_idx
);

1509 
»gFe
.
	`£tFlßtReg
(
phys_»g
, 
v®
);

1510 
	}
}

1512 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1514 
	gFuÎO3CPU
<
	gIm¶
>::
	$£tArchFlßtRegIÁ
(
»g_idx
, 
ušt64_t
 
v®
, 
Th»adID
 
tid
)

1516 
åRegfeWr™es
++;

1517 
PhysRegIndex
 
phys_»g
 = 
comm™R’ameM­
[
tid
].
	`lookupFlßt
(
»g_idx
);

1519 
»gFe
.
	`£tFlßtRegB™s
(
phys_»g
, 
v®
);

1520 
	}
}

1522 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1524 
	gFuÎO3CPU
<
	gIm¶
>::
	$£tArchCCReg
(
»g_idx
, 
CCReg
 
v®
, 
Th»adID
 
tid
)

1526 
ccRegfeWr™es
++;

1527 
PhysRegIndex
 
phys_»g
 = 
comm™R’ameM­
[
tid
].
	`lookupCC
(
»g_idx
);

1529 
»gFe
.
	`£tCCReg
(
phys_»g
, 
v®
);

1530 
	}
}

1532 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1533 
	gTheISA
::
PCS‹


1534 
FuÎO3CPU
<
Im¶
>::
	$pcS‹
(
Th»adID
 
tid
)

1536  
comm™
.
	`pcS‹
(
tid
);

1537 
	}
}

1539 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1541 
	gFuÎO3CPU
<
	gIm¶
>::
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
, 
Th»adID
 
tid
)

1543 
	gcomm™
.
pcS‹
(
v®
, 
tid
);

1546 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1547 
Addr


1548 
	gFuÎO3CPU
<
	gIm¶
>::
	$š¡Addr
(
Th»adID
 
tid
)

1550  
comm™
.
	`š¡Addr
(
tid
);

1551 
	}
}

1553 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1554 
Addr


1555 
	gFuÎO3CPU
<
	gIm¶
>::
	$ÃxtIn¡Addr
(
Th»adID
 
tid
)

1557  
comm™
.
	`ÃxtIn¡Addr
(
tid
);

1558 
	}
}

1560 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1561 
MiüoPC


1562 
	gFuÎO3CPU
<
	gIm¶
>::
	$miüoPC
(
Th»adID
 
tid
)

1564  
comm™
.
	`miüoPC
(
tid
);

1565 
	}
}

1567 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1569 
	gFuÎO3CPU
<
	gIm¶
>::
	$squashFromTC
(
Th»adID
 
tid
)

1571 
this
->
th»ad
[
tid
]->
noSquashFromTC
 = 
Œue
;

1572 
this
->
comm™
.
	`g’”©eTCEv’t
(
tid
);

1573 
	}
}

1575 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1576 
ty³Çme
 
	gFuÎO3CPU
<
	gIm¶
>::
Li¡It


1577 
FuÎO3CPU
<
Im¶
>::
	$addIn¡
(
DynIn¡PŒ
 &
š¡
)

1579 
š¡Li¡
.
	`push_back
(
š¡
);

1581  --(
š¡Li¡
.
	`’d
());

1582 
	}
}

1584 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1586 
	gFuÎO3CPU
<
	gIm¶
>::
	$š¡DÚe
(
Th»adID
 
tid
, 
DynIn¡PŒ
 &
š¡
)

1589 ià(!
š¡
->
	`isMiüoİ
(è|| in¡->
	`isLa¡Miüoİ
()) {

1590 
th»ad
[
tid
]->
numIn¡
++;

1591 
th»ad
[
tid
]->
numIn¡s
++;

1592 
comm™‹dIn¡s
[
tid
]++;

1593 
tÙ®Comm™‹dIn¡s
++;

1595 
th»ad
[
tid
]->
numOp
++;

1596 
th»ad
[
tid
]->
numOps
++;

1597 
comm™‹dOps
[
tid
]++;

1599 
sy¡em
->
tÙ®NumIn¡s
++;

1601 
comIn¡Ev’tQueue
[
tid
]->
	`£rviûEv’ts
(
th»ad
[tid]->
numIn¡
);

1602 
sy¡em
->
š¡Ev’tQueue
.
	`£rviûEv’ts
(sy¡em->
tÙ®NumIn¡s
);

1603 
	}
}

1605 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1607 
	gFuÎO3CPU
<
	gIm¶
>::
	$»moveFrÚtIn¡
(
DynIn¡PŒ
 &
š¡
)

1609 
	`DPRINTF
(
O3CPU
, "Removing committed instruction [tid:%i] PC %s "

1611 
š¡
->
th»adNumb”
, in¡->
	`pcS‹
(), in¡->
£qNum
);

1613 
»moveIn¡sThisCyşe
 = 
Œue
;

1616 
»moveLi¡
.
	`push
(
š¡
->
	`g‘In¡Li¡It
());

1617 
	}
}

1619 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1621 
	gFuÎO3CPU
<
	gIm¶
>::
	$»moveIn¡sNÙInROB
(
Th»adID
 
tid
)

1623 
	`DPRINTF
(
O3CPU
, "Thread %i: Deleting instructions from instruction"

1624 "†i¡.\n", 
tid
);

1626 
Li¡It
 
’d_™
;

1628 
boŞ
 
rob_em±y
 = 
çl£
;

1630 ià(
š¡Li¡
.
	`em±y
()) {

1632 } ià(
rob
.
	`isEm±y
( )) {

1633 
	`DPRINTF
(
O3CPU
, "ROB isƒmpty, squashing‡ll insts.\n");

1634 
’d_™
 = 
š¡Li¡
.
	`begš
();

1635 
rob_em±y
 = 
Œue
;

1637 
’d_™
 = (
rob
.
	`»adTaIn¡
(
tid
))->
	`g‘In¡Li¡It
();

1638 
	`DPRINTF
(
O3CPU
, "ROB is‚otƒmpty, squashing insts‚ot in ROB.\n");

1641 
»moveIn¡sThisCyşe
 = 
Œue
;

1643 
Li¡It
 
š¡_™
 = 
š¡Li¡
.
	`’d
();

1645 
š¡_™
--;

1649 
š¡_™
 !ğ
’d_™
) {

1650 
	`as£¹
(!
š¡Li¡
.
	`em±y
());

1652 
	`squashIn¡It
(
š¡_™
, 
tid
);

1654 
š¡_™
--;

1659 ià(
rob_em±y
) {

1660 
	`squashIn¡It
(
š¡_™
, 
tid
);

1662 
	}
}

1664 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1666 
	gFuÎO3CPU
<
	gIm¶
>::
	$»moveIn¡sUÁ
(cÚ¡ 
In¡SeqNum
 &
£q_num
, 
Th»adID
 
tid
)

1668 
	`as£¹
(!
š¡Li¡
.
	`em±y
());

1670 
»moveIn¡sThisCyşe
 = 
Œue
;

1672 
Li¡It
 
š¡_™”
 = 
š¡Li¡
.
	`’d
();

1674 
š¡_™”
--;

1676 
	`DPRINTF
(
O3CPU
, "Deleting instructions from instruction "

1678 
tid
, 
£q_num
, (*
š¡_™”
)->
£qNum
);

1680 (*
š¡_™”
)->
£qNum
 > 
£q_num
) {

1682 
boŞ
 
b»ak_loİ
 = (
š¡_™”
 =ğ
š¡Li¡
.
	`begš
());

1684 
	`squashIn¡It
(
š¡_™”
, 
tid
);

1686 
š¡_™”
--;

1688 ià(
b»ak_loİ
)

1691 
	}
}

1693 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1694 
šlše
 

1695 
	gFuÎO3CPU
<
	gIm¶
>::
	$squashIn¡It
(cÚ¡ 
Li¡It
 &
š¡It
, 
Th»adID
 
tid
)

1697 ià((*
š¡It
)->
th»adNumb”
 =ğ
tid
) {

1698 
	`DPRINTF
(
O3CPU
, "Squashing instruction, "

1700 (*
š¡It
)->
th»adNumb”
,

1701 (*
š¡It
)->
£qNum
,

1702 (*
š¡It
)->
	`pcS‹
());

1705 (*
š¡It
)->
	`£tSquashed
();

1710 
»moveLi¡
.
	`push
(
š¡It
);

1712 
	}
}

1714 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1716 
	gFuÎO3CPU
<
	gIm¶
>::
	$ş—nUpRemovedIn¡s
()

1718 !
»moveLi¡
.
	`em±y
()) {

1719 
	`DPRINTF
(
O3CPU
, "Removing instruction, "

1721 (*
»moveLi¡
.
	`äÚt
())->
th»adNumb”
,

1722 (*
»moveLi¡
.
	`äÚt
())->
£qNum
,

1723 (*
»moveLi¡
.
	`äÚt
())->
	`pcS‹
());

1725 
š¡Li¡
.
	`”a£
(
»moveLi¡
.
	`äÚt
());

1727 
»moveLi¡
.
	`pİ
();

1730 
»moveIn¡sThisCyşe
 = 
çl£
;

1731 
	}
}

1740 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1742 
	gFuÎO3CPU
<
	gIm¶
>::
	$dumpIn¡s
()

1744 
num
 = 0;

1746 
Li¡It
 
š¡_li¡_™
 = 
š¡Li¡
.
	`begš
();

1748 
	`ırštf
("Dumping Instruction List\n");

1750 
š¡_li¡_™
 !ğ
š¡Li¡
.
	`’d
()) {

1751 
	`ırštf
("Instruction:%i\nPC:%#x\n[tid:%i]\n[sn:%lli]\nIssued:%i\n"

1753 
num
, (*
š¡_li¡_™
)->
	`š¡Addr
(), (*š¡_li¡_™)->
th»adNumb”
,

1754 (*
š¡_li¡_™
)->
£qNum
, (*š¡_li¡_™)->
	`isIssued
(),

1755 (*
š¡_li¡_™
)->
	`isSquashed
());

1756 
š¡_li¡_™
++;

1757 ++
num
;

1759 
	}
}

1768 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1770 
	gFuÎO3CPU
<
	gIm¶
>::
	$wakeCPU
()

1772 ià(
aùiv™yRec
.
	`aùive
(è|| 
tickEv’t
.
	`scheduËd
()) {

1773 
	`DPRINTF
(
Aùiv™y
, "CPU‡lready„unning.\n");

1777 
	`DPRINTF
(
Aùiv™y
, "Waking up CPU\n");

1779 
Cyşes
 
	`cyşes
(
	`curCyşe
(è- 
Ï¡RuÂšgCyşe
);

1781 ià(
cyşes
 != 0)

1782 --
cyşes
;

1783 
idËCyşes
 +ğ
cyşes
;

1784 
numCyşes
 +ğ
cyşes
;

1786 
	`scheduË
(
tickEv’t
, 
	`şockEdge
());

1787 
	}
}

1789 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1791 
	gFuÎO3CPU
<
	gIm¶
>::
	$wakeup
()

1793 ià(
this
->
th»ad
[0]->
	`¡©us
(è!ğ
Th»adCÚ‹xt
::
Su¥’ded
)

1796 
this
->
	`wakeCPU
();

1798 
	`DPRINTF
(
Qu›sû
, "Suspended Processor woken\n");

1799 
this
->
th»adCÚ‹xts
[0]->
	`aùiv©e
();

1800 
	}
}

1802 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1803 
Th»adID


1804 
	gFuÎO3CPU
<
	gIm¶
>::
	$g‘F»eTid
()

1806 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

1807 ià(!
tids
[
tid
]) {

1808 
tids
[
tid
] = 
Œue
;

1809  
tid
;

1813  
Inv®idTh»adID
;

1814 
	}
}

1816 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1818 
	gFuÎO3CPU
<
	gIm¶
>::
	$doCÚ‹xtSw™ch
()

1820 ià(
cÚ‹xtSw™ch
) {

1824 
Th»adID
 
size
 = 
ıuWa™Li¡
.
	`size
();

1825 
Th»adID
 
tid
 = 0;id < 
size
;id++) {

1826 
	`aùiv©eWh’R—dy
(
tid
);

1829 ià(
ıuWa™Li¡
.
	`size
() == 0)

1830 
cÚ‹xtSw™ch
 = 
Œue
;

1832 
	}
}

1834 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1836 
	gFuÎO3CPU
<
	gIm¶
>::
	$upd©eTh»adPriÜ™y
()

1838 ià(
aùiveTh»ads
.
	`size
() > 1) {

1841 
li¡
<
Th»adID
>::
™”©Ü
 
li¡_begš
 = 
aùiveTh»ads
.
	`begš
();

1843 
high_th»ad
 = *
li¡_begš
;

1845 
aùiveTh»ads
.
	`”a£
(
li¡_begš
);

1847 
aùiveTh»ads
.
	`push_back
(
high_th»ad
);

1849 
	}
}

1852 
‹m¶©e
 
şass
 
	gFuÎO3CPU
<
	gO3CPUIm¶
>;

	@o3/cpu.hh

47 #iâdeà
__CPU_O3_CPU_HH__


48 
	#__CPU_O3_CPU_HH__


	)

50 
	~<io¡»am
>

51 
	~<li¡
>

52 
	~<queue
>

53 
	~<£t
>

54 
	~<veùÜ
>

56 
	~"¬ch/ty³s.hh
"

57 
	~"ba£/¡©i¡ics.hh
"

58 
	~"cÚfig/the_i§.hh
"

59 
	~"ıu/o3/comm.hh
"

60 
	~"ıu/o3/ıu_pŞicy.hh
"

61 
	~"ıu/o3/scÜebßrd.hh
"

62 
	~"ıu/o3/th»ad_¡©e.hh
"

63 
	~"ıu/aùiv™y.hh
"

64 
	~"ıu/ba£.hh
"

65 
	~"ıu/sim¶e_th»ad.hh
"

66 
	~"ıu/timebuf.hh
"

68 
	~"·¿ms/D”ivO3CPU.hh
"

69 
	~"sim/´oûss.hh
"

71 
	g‹m¶©e
 <
	gşass
>

72 
şass
 
	gCheck”
;

73 
şass
 
	gTh»adCÚ‹xt
;

74 
	g‹m¶©e
 <
	gşass
>

75 
şass
 
	gO3Th»adCÚ‹xt
;

77 
şass
 
	gCheckpošt
;

78 
şass
 
	gMemObjeù
;

79 
şass
 
	gProûss
;

81 
	gBa£CPUP¬ams
;

83 şas 
	cBa£O3CPU
 : 
public
 
Ba£CPU


86 
public
:

87 
Ba£O3CPU
(
Ba£CPUP¬ams
 *
·¿ms
);

89 
»gSts
();

97 
	g‹m¶©e
 <
şass
 
	gIm¶
>

98 şas 
	cFuÎO3CPU
 : 
public
 
Ba£O3CPU


100 
public
:

102 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
 
	tCPUPŞicy
;

103 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

104 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

106 
	mO3Th»adS‹
<
	tIm¶
> 
	tIm¶S‹
;

107 
	mO3Th»adS‹
<
	tIm¶
> 
	tTh»ad
;

109 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

111 
ä›nd
 
şass
 
	mO3Th»adCÚ‹xt
<
	mIm¶
>;

113 
	mpublic
:

114 
	eStus
 {

115 
RuÂšg
,

116 
	mIdË
,

117 
	mH®‹d
,

118 
	mBlocked
,

119 
	mSw™chedOut


122 
	gTheISA
::
TLB
 * 
™b
;

123 
	gTheISA
::
TLB
 * 
dtb
;

126 
Stus
 
	g_¡©us
;

128 
	g´iv©e
:

133 şas 
	cIÿchePÜt
 : 
public
 
Ma¡”PÜt


135 
´Ùeùed
:

137 
DeçuÉF‘ch
<
Im¶
> *
ãtch
;

139 
	gpublic
:

141 
IÿchePÜt
(
DeçuÉF‘ch
<
Im¶
> *
_ãtch
, 
FuÎO3CPU
<Im¶>* 
_ıu
)

142 : 
Ma¡”PÜt
(
_ıu
->
Çme
(è+ ".iÿche_pÜt", _ıu), 
ãtch
(
_ãtch
)

145 
	g´Ùeùed
:

149 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

150 
vœtu®
 
»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
) { }

153 
vœtu®
 
»cvR‘ry
();

159 şas 
	cDÿchePÜt
 : 
public
 
Ma¡”PÜt


161 
´Ùeùed
:

164 
LSQ
<
Im¶
> *
lsq
;

166 
	gpublic
:

168 
DÿchePÜt
(
LSQ
<
Im¶
> *
_lsq
, 
FuÎO3CPU
<Im¶>* 
_ıu
)

169 : 
Ma¡”PÜt
(
_ıu
->
Çme
(è+ ".dÿche_pÜt", _ıu), 
lsq
(
_lsq
)

172 
	g´Ùeùed
:

177 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

178 
vœtu®
 
»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
);

180 
vœtu®
 
»cvFunùiÚ®Snoİ
(
Pack‘PŒ
 
pkt
)

186 
vœtu®
 
»cvR‘ry
();

194 
vœtu®
 
boŞ
 
isSnoİšg
(ècÚ¡ {  
	gŒue
; }

197 şas 
	cTickEv’t
 : 
public
 
Ev’t


199 
´iv©e
:

201 
FuÎO3CPU
<
Im¶
> *
ıu
;

203 
	gpublic
:

205 
TickEv’t
(
FuÎO3CPU
<
Im¶
> *
c
);

208 
´oûss
();

210 cÚ¡ *
desütiÚ
() const;

214 
TickEv’t
 
	gtickEv’t
;

217 
	$scheduËTickEv’t
(
Cyşes
 
d–ay
)

219 ià(
tickEv’t
.
	`squashed
())

220 
	`»scheduË
(
tickEv’t
, 
	`şockEdge
(
d–ay
));

221 ià(!
tickEv’t
.
	`scheduËd
())

222 
	`scheduË
(
tickEv’t
, 
	`şockEdge
(
d–ay
));

223 
	}
}

226 
	$unscheduËTickEv’t
()

228 ià(
tickEv’t
.
	`scheduËd
())

229 
tickEv’t
.
	`squash
();

230 
	}
}

232 şas 
	cAùiv©eTh»adEv’t
 : 
public
 
Ev’t


234 
´iv©e
:

236 
Th»adID
 
tid
;

239 
	gFuÎO3CPU
<
	gIm¶
> *
	gıu
;

241 
	gpublic
:

243 
Aùiv©eTh»adEv’t
();

246 
š™
(
th»ad_num
, 
FuÎO3CPU
<
Im¶
> *
th»ad_ıu
);

249 
´oûss
();

252 cÚ¡ *
desütiÚ
() const;

257 
	$scheduËAùiv©eTh»adEv’t
(
Th»adID
 
tid
, 
Cyşes
 
d–ay
)

260 ià(
aùiv©eTh»adEv’t
[
tid
].
	`squashed
())

261 
	`»scheduË
(
aùiv©eTh»adEv’t
[
tid
],

262 
	`şockEdge
(
d–ay
));

263 ià(!
aùiv©eTh»adEv’t
[
tid
].
	`scheduËd
()) {

264 
Tick
 
wh’
 = 
	`şockEdge
(
d–ay
);

269 ià(
d—Îoÿ‹CÚ‹xtEv’t
[
tid
].
	`scheduËd
() &&

270 
d—Îoÿ‹CÚ‹xtEv’t
[
tid
].
	`wh’
(è=ğ
wh’
) {

271 
wh’
++;

274 
	`scheduË
(
aùiv©eTh»adEv’t
[
tid
], 
wh’
);

276 
	}
}

280 
	$unscheduËAùiv©eTh»adEv’t
(
Th»adID
 
tid
)

282 ià(
aùiv©eTh»adEv’t
[
tid
].
	`scheduËd
())

283 
aùiv©eTh»adEv’t
[
tid
].
	`squash
();

284 
	}
}

287 
Aùiv©eTh»adEv’t
 
	gaùiv©eTh»adEv’t
[
Im¶
::
MaxTh»ads
];

289 şas 
	cD—Îoÿ‹CÚ‹xtEv’t
 : 
public
 
Ev’t


291 
´iv©e
:

293 
Th»adID
 
tid
;

296 
boŞ
 
	g»move
;

299 
	gFuÎO3CPU
<
	gIm¶
> *
	gıu
;

301 
	gpublic
:

303 
D—Îoÿ‹CÚ‹xtEv’t
();

306 
š™
(
th»ad_num
, 
FuÎO3CPU
<
Im¶
> *
th»ad_ıu
);

309 
´oûss
();

312 
£tRemove
(
boŞ
 
_»move
è{ 
	g»move
 = _remove; }

315 cÚ¡ *
desütiÚ
() const;

320 
	$scheduËD—Îoÿ‹CÚ‹xtEv’t
(
Th»adID
 
tid
, 
boŞ
 
»move
, 
Cyşes
 
d–ay
)

323 ià(
d—Îoÿ‹CÚ‹xtEv’t
[
tid
].
	`squashed
())

324 
	`»scheduË
(
d—Îoÿ‹CÚ‹xtEv’t
[
tid
],

325 
	`şockEdge
(
d–ay
));

326 ià(!
d—Îoÿ‹CÚ‹xtEv’t
[
tid
].
	`scheduËd
())

327 
	`scheduË
(
d—Îoÿ‹CÚ‹xtEv’t
[
tid
],

328 
	`şockEdge
(
d–ay
));

329 
	}
}

333 
	$unscheduËD—Îoÿ‹CÚ‹xtEv’t
(
Th»adID
 
tid
)

335 ià(
d—Îoÿ‹CÚ‹xtEv’t
[
tid
].
	`scheduËd
())

336 
d—Îoÿ‹CÚ‹xtEv’t
[
tid
].
	`squash
();

337 
	}
}

340 
D—Îoÿ‹CÚ‹xtEv’t
 
	gd—Îoÿ‹CÚ‹xtEv’t
[
Im¶
::
MaxTh»ads
];

353 
boŞ
 
ŒyD¿š
();

364 
	$d¿šSª™yCheck
() const;

367 
boŞ
 
	$isD¿šed
() const;

369 
public
:

371 
	`FuÎO3CPU
(
D”ivO3CPUP¬ams
 *
·¿ms
);

373 ~
	`FuÎO3CPU
();

376 
	`»gSts
();

378 
	$dem­Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

380 
this
->
™b
->
	`dem­Page
(
vaddr
, 
a¢
);

381 
this
->
dtb
->
	`dem­Page
(
vaddr
, 
a¢
);

382 
	}
}

384 
	$dem­In¡Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

386 
this
->
™b
->
	`dem­Page
(
vaddr
, 
a¢
);

387 
	}
}

389 
	$dem­D©aPage
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

391 
this
->
dtb
->
	`dem­Page
(
vaddr
, 
a¢
);

392 
	}
}

397 
tick
();

400 
š™
();

402 
¡¬tup
();

405 
	$numAùiveTh»ads
()

406 {  
aùiveTh»ads
.
	`size
(); 
	}
}

409 
aùiv©eTh»ad
(
Th»adID
 
tid
);

412 
d—ùiv©eTh»ad
(
Th»adID
 
tid
);

415 
š£¹Th»ad
(
Th»adID
 
tid
);

418 
»moveTh»ad
(
Th»adID
 
tid
);

421 
vœtu®
 
CouÁ”
 
	$tÙ®In¡s
() const;

424 
vœtu®
 
CouÁ”
 
	$tÙ®Ops
() const;

427 
	`aùiv©eCÚ‹xt
(
Th»adID
 
tid
, 
Cyşes
 
d–ay
);

430 
	`su¥’dCÚ‹xt
(
Th»adID
 
tid
);

435 
boŞ
 
	`scheduËD—Îoÿ‹CÚ‹xt
(
Th»adID
 
tid
, boŞ 
»move
,

436 
Cyşes
 
d–ay
 = 
	`Cyşes
(1));

441 
	`h®tCÚ‹xt
(
Th»adID
 
tid
);

444 
	`aùiv©eWh’R—dy
(
Th»adID
 
tid
);

447 
	`doCÚ‹xtSw™ch
();

450 
	`upd©eTh»adPriÜ™y
();

453 
boŞ
 
	$isD¿ššg
(ècÚ¡ {  
	`g‘D¿šS‹
(è=ğ
D¿šabË
::
D¿ššg
; 
	}
}

455 
£rŸlizeTh»ad
(
¡d
::
o¡»am
 &
os
, 
Th»adID
 
tid
);

457 
un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
,

458 
Th»adID
 
tid
);

460 
	gpublic
:

464 
sysÿÎ
(
št64_t
 
ÿÎnum
, 
Th»adID
 
tid
);

468 
d¿š
(
D¿šMªag”
 *
d¿š_mªag”
);

471 
d¿šResume
();

480 
comm™D¿šed
(
Th»adID
 
tid
);

483 
vœtu®
 
sw™chOut
();

486 
vœtu®
 
keOv”From
(
Ba£CPU
 *
ŞdCPU
);

488 
	$v”ifyMemÜyMode
() const;

491 
In¡SeqNum
 
	$g‘AndInüem’tIn¡Seq
()

492 {  
glob®SeqNum
++; 
	}
}

495 
Œ­
(
FauÉ
 
çuÉ
, 
Th»adID
 
tid
, 
SticIn¡PŒ
 
š¡
);

498 
FauÉ
 
hw»i
(
Th»adID
 
tid
);

500 
boŞ
 
simP®Check
(
·lFunc
, 
Th»adID
 
tid
);

503 
FauÉ
 
g‘IÁ”ru±s
();

506 
´oûssIÁ”ru±s
(
FauÉ
 
š‹¼u±
);

509 
	$h®t
(è{ 
	`·nic
("H®ˆnÙ im¶em’‹d!\n"); 
	}
}

512 
boŞ
 
	$v®idIn¡Addr
(
Addr
 
addr
è{  
Œue
; 
	}
}

515 
boŞ
 
	$v®idD©aAddr
(
Addr
 
addr
è{  
Œue
; 
	}
}

520 
	gTheISA
::
MiscReg
 
»adMiscRegNoEfãù
(
misc_»g
, 
Th»adID
 
tid
);

525 
	gTheISA
::
MiscReg
 
»adMiscReg
(
misc_»g
, 
Th»adID
 
tid
);

528 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
TheISA
::
MiscReg
 &
v®
,

529 
Th»adID
 
tid
);

534 
£tMiscReg
(
misc_»g
, cÚ¡ 
TheISA
::
MiscReg
 &
v®
,

535 
Th»adID
 
tid
);

537 
ušt64_t
 
»adIÁReg
(
»g_idx
);

539 
	gTheISA
::
FlßtReg
 
»adFlßtReg
(
»g_idx
);

541 
	gTheISA
::
FlßtRegB™s
 
»adFlßtRegB™s
(
»g_idx
);

543 
	gTheISA
::
CCReg
 
»adCCReg
(
»g_idx
);

545 
£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
);

547 
£tFlßtReg
(
»g_idx
, 
TheISA
::
FlßtReg
 
v®
);

549 
£tFlßtRegB™s
(
»g_idx
, 
TheISA
::
FlßtRegB™s
 
v®
);

551 
£tCCReg
(
»g_idx
, 
TheISA
::
CCReg
 
v®
);

553 
ušt64_t
 
»adArchIÁReg
(
»g_idx
, 
Th»adID
 
tid
);

555 
»adArchFlßtReg
(
»g_idx
, 
Th»adID
 
tid
);

557 
ušt64_t
 
»adArchFlßtRegIÁ
(
»g_idx
, 
Th»adID
 
tid
);

559 
	gTheISA
::
CCReg
 
»adArchCCReg
(
»g_idx
, 
Th»adID
 
tid
);

566 
£tArchIÁReg
(
»g_idx
, 
ušt64_t
 
v®
, 
Th»adID
 
tid
);

568 
£tArchFlßtReg
(
»g_idx
, 
v®
, 
Th»adID
 
tid
);

570 
£tArchFlßtRegIÁ
(
»g_idx
, 
ušt64_t
 
v®
, 
Th»adID
 
tid
);

572 
£tArchCCReg
(
»g_idx
, 
TheISA
::
CCReg
 
v®
, 
Th»adID
 
tid
);

575 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
ÃwPCS‹
, 
Th»adID
 
tid
);

578 
	gTheISA
::
PCS‹
 
pcS‹
(
Th»adID
 
tid
);

581 
Addr
 
š¡Addr
(
Th»adID
 
tid
);

584 
MiüoPC
 
miüoPC
(
Th»adID
 
tid
);

587 
Addr
 
ÃxtIn¡Addr
(
Th»adID
 
tid
);

593 
squashFromTC
(
Th»adID
 
tid
);

598 
Li¡It
 
addIn¡
(
DynIn¡PŒ
 &
š¡
);

601 
š¡DÚe
(
Th»adID
 
tid
, 
DynIn¡PŒ
 &
š¡
);

606 
»moveFrÚtIn¡
(
DynIn¡PŒ
 &
š¡
);

610 
»moveIn¡sNÙInROB
(
Th»adID
 
tid
);

613 
»moveIn¡sUÁ
(cÚ¡ 
In¡SeqNum
 &
£q_num
, 
Th»adID
 
tid
);

616 
šlše
 
squashIn¡It
(cÚ¡ 
Li¡It
 &
š¡It
, 
Th»adID
 
tid
);

619 
ş—nUpRemovedIn¡s
();

622 
dumpIn¡s
();

624 
	gpublic
:

625 #iâdeà
NDEBUG


627 
š¡couÁ
;

631 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
;

636 
	g¡d
::
queue
<
Li¡It
> 
»moveLi¡
;

638 #ifdeà
DEBUG


642 
	g¡d
::
£t
<
In¡SeqNum
> 
¢Li¡
;

648 
boŞ
 
	g»moveIn¡sThisCyşe
;

650 
	g´Ùeùed
:

652 
ty³Çme
 
CPUPŞicy
::
F‘ch
 
ãtch
;

655 
ty³Çme
 
	gCPUPŞicy
::
Decode
 
decode
;

658 
ty³Çme
 
	gCPUPŞicy
::
R’ame
 
»Çme
;

661 
ty³Çme
 
	gCPUPŞicy
::
IEW
 
›w
;

664 
ty³Çme
 
	gCPUPŞicy
::
Comm™
 
comm™
;

667 
PhysRegFe
 
	g»gFe
;

670 
ty³Çme
 
	gCPUPŞicy
::
F»eLi¡
 
ä“Li¡
;

673 
ty³Çme
 
	gCPUPŞicy
::
R’ameM­
 
»ÇmeM­
[
Im¶
::
MaxTh»ads
];

676 
ty³Çme
 
	gCPUPŞicy
::
R’ameM­
 
comm™R’ameM­
[
Im¶
::
MaxTh»ads
];

679 
ty³Çme
 
	gCPUPŞicy
::
ROB
 
rob
;

682 
	g¡d
::
li¡
<
Th»adID
> 
aùiveTh»ads
;

685 
ScÜebßrd
 
	gscÜebßrd
;

687 
	g¡d
::
veùÜ
<
TheISA
::
ISA
 *> 
i§
;

690 
IÿchePÜt
 
	giÿchePÜt
;

693 
DÿchePÜt
 
	gdÿchePÜt
;

695 
	gpublic
:

700 
	eSgeIdx
 {

701 
F‘chIdx
,

702 
	gDecodeIdx
,

703 
	gR’ameIdx
,

704 
	gIEWIdx
,

705 
	gComm™Idx
,

706 
	gNumSges
 };

711 
ty³Çme
 
	tCPUPŞicy
::
	tTimeSŒuù
 TimeStruct;

713 
ty³Çme
 
	tCPUPŞicy
::
	tF‘chSŒuù
 FetchStruct;

715 
ty³Çme
 
	tCPUPŞicy
::
	tDecodeSŒuù
 DecodeStruct;

717 
ty³Çme
 
	tCPUPŞicy
::
	tR’ameSŒuù
 RenameStruct;

719 
ty³Çme
 
	tCPUPŞicy
::
	tIEWSŒuù
 IEWStruct;

722 
	gTimeBufãr
<
	gTimeSŒuù
> 
	gtimeBufãr
;

725 
	gTimeBufãr
<
	gF‘chSŒuù
> 
	gãtchQueue
;

728 
	gTimeBufãr
<
	gDecodeSŒuù
> 
	gdecodeQueue
;

731 
	gTimeBufãr
<
	gR’ameSŒuù
> 
	g»ÇmeQueue
;

734 
	gTimeBufãr
<
	gIEWSŒuù
> 
	g›wQueue
;

736 
	g´iv©e
:

741 
Aùiv™yRecÜd”
 
aùiv™yRec
;

743 
	gpublic
:

745 
	$aùiv™yThisCyşe
(è{ 
aùiv™yRec
.
	`aùiv™y
(); 
	}
}

748 
	$aùiv©eSge
(cÚ¡ 
SgeIdx
 
idx
)

749 { 
aùiv™yRec
.
	`aùiv©eSge
(
idx
); 
	}
}

752 
	$d—ùiv©eSge
(cÚ¡ 
SgeIdx
 
idx
)

753 { 
aùiv™yRec
.
	`d—ùiv©eSge
(
idx
); 
	}
}

756 
wakeCPU
();

758 
vœtu®
 
wakeup
();

761 
Th»adID
 
g‘F»eTid
();

763 
	gpublic
:

765 
Th»adCÚ‹xt
 *

766 
	$tcBa£
(
Th»adID
 
tid
)

768  
th»ad
[
tid
]->
	`g‘TC
();

769 
	}
}

772 
In¡SeqNum
 
	gglob®SeqNum
;

778 
	gCheck”
<
	gIm¶
> *
	gcheck”
;

781 
Sy¡em
 *
	gsy¡em
;

784 
D¿šMªag”
 *
	gd¿šMªag”
;

787 
	g¡d
::
veùÜ
<
Th»ad
 *> 
th»ad
;

790 
boŞ
 
	gcÚ‹xtSw™ch
;

793 
	g¡d
::
li¡
<> 
ıuWa™Li¡
;

796 
Cyşes
 
	gÏ¡RuÂšgCyşe
;

799 
Tick
 
	gÏ¡Aùiv©edCyşe
;

802 
	g¡d
::
m­
<
Th»adID
, > 
	gth»adM­
;

805 
	g¡d
::
veùÜ
<
Th»adID
> 
tids
;

808 
FauÉ
 
	$»ad
(
Reque¡PŒ
 &
»q
, Reque¡PŒ &
¤eqLow
, Reque¡PŒ &
¤eqHigh
,

809 
ušt8_t
 *
d©a
, 
lßd_idx
)

811  
this
->
›w
.
ld¡Queue
.
	`»ad
(
»q
, 
¤eqLow
, 
¤eqHigh
,

812 
d©a
, 
lßd_idx
);

813 
	}
}

816 
FauÉ
 
	$wr™e
(
Reque¡PŒ
 &
»q
, Reque¡PŒ &
¤eqLow
, Reque¡PŒ &
¤eqHigh
,

817 
ušt8_t
 *
d©a
, 
¡Üe_idx
)

819  
this
->
›w
.
ld¡Queue
.
	`wr™e
(
»q
, 
¤eqLow
, 
¤eqHigh
,

820 
d©a
, 
¡Üe_idx
);

821 
	}
}

824 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘In¡PÜt
(è{  
iÿchePÜt
; 
	}
}

827 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘D©aPÜt
(è{  
dÿchePÜt
; 
	}
}

830 
	gSts
::
SÿÏr
 
timesIdËd
;

832 
	gSts
::
SÿÏr
 
idËCyşes
;

835 
	gSts
::
SÿÏr
 
qu›sûCyşes
;

837 
	gSts
::
VeùÜ
 
comm™‹dIn¡s
;

839 
	gSts
::
VeùÜ
 
comm™‹dOps
;

841 
	gSts
::
SÿÏr
 
tÙ®Comm™‹dIn¡s
;

843 
	gSts
::
FÜmuÏ
 
ıi
;

845 
	gSts
::
FÜmuÏ
 
tÙ®Cpi
;

847 
	gSts
::
FÜmuÏ
 
c
;

849 
	gSts
::
FÜmuÏ
 
tÙ®Ipc
;

852 
	gSts
::
SÿÏr
 
štRegfeR—ds
;

853 
	gSts
::
SÿÏr
 
štRegfeWr™es
;

855 
	gSts
::
SÿÏr
 
åRegfeR—ds
;

856 
	gSts
::
SÿÏr
 
åRegfeWr™es
;

858 
	gSts
::
SÿÏr
 
ccRegfeR—ds
;

859 
	gSts
::
SÿÏr
 
ccRegfeWr™es
;

861 
	gSts
::
SÿÏr
 
miscRegfeR—ds
;

862 
	gSts
::
SÿÏr
 
miscRegfeWr™es
;

	@o3/cpu_policy.hh

32 #iâdeà
__CPU_O3_CPU_POLICY_HH__


33 
	#__CPU_O3_CPU_POLICY_HH__


	)

35 
	~"ıu/o3/comm.hh
"

36 
	~"ıu/o3/comm™.hh
"

37 
	~"ıu/o3/decode.hh
"

38 
	~"ıu/o3/ãtch.hh
"

39 
	~"ıu/o3/ä“_li¡.hh
"

40 
	~"ıu/o3/›w.hh
"

41 
	~"ıu/o3/š¡_queue.hh
"

42 
	~"ıu/o3/lsq.hh
"

43 
	~"ıu/o3/lsq_un™.hh
"

44 
	~"ıu/o3/mem_d•_un™.hh
"

45 
	~"ıu/o3/»gfe.hh
"

46 
	~"ıu/o3/»Çme.hh
"

47 
	~"ıu/o3/»Çme_m­.hh
"

48 
	~"ıu/o3/rob.hh
"

49 
	~"ıu/o3/¡Üe_£t.hh
"

60 
	g‹m¶©e
<
şass
 
	gIm¶
>

61 
	sSim¶eCPUPŞicy


64 
Unif›dF»eLi¡
 
	tF»eLi¡
;

66 
Unif›dR’ameM­
 
	tR’ameM­
;

68 ::
ROB
<
	tIm¶
> 
	tROB
;

70 
	mIn¡ruùiÚQueue
<
	tIm¶
> 
	tIQ
;

72 ::
MemD•Un™
<
	tStÜeS‘
, 
	tIm¶
> 
	tMemD•Un™
;

74 ::
LSQ
<
	tIm¶
> 
	tLSQ
;

76 ::
LSQUn™
<
	tIm¶
> 
	tLSQUn™
;

79 
	mDeçuÉF‘ch
<
	tIm¶
> 
	tF‘ch
;

81 
	mDeçuÉDecode
<
	tIm¶
> 
	tDecode
;

83 
	mDeçuÉR’ame
<
	tIm¶
> 
	tR’ame
;

85 
	mDeçuÉIEW
<
	tIm¶
> 
	tIEW
;

87 
	mDeçuÉComm™
<
	tIm¶
> 
	tComm™
;

90 
	mDeçuÉF‘chDeçuÉDecode
<
	tIm¶
> 
	tF‘chSŒuù
;

93 
	mDeçuÉDecodeDeçuÉR’ame
<
	tIm¶
> 
	tDecodeSŒuù
;

96 
	mDeçuÉR’ameDeçuÉIEW
<
	tIm¶
> 
	tR’ameSŒuù
;

99 
	mDeçuÉIEWDeçuÉComm™
<
	tIm¶
> 
	tIEWSŒuù
;

102 ::
IssueSŒuù
<
	tIm¶
> 
	tIssueSŒuù
;

105 
	mTimeBufSŒuù
<
	tIm¶
> 
	tTimeSŒuù
;

	@o3/decode.cc

31 
	~"ıu/o3/decode_im¶.hh
"

32 
	~"ıu/o3/i§_¥ecific.hh
"

34 
‹m¶©e
 
şass
 
	gDeçuÉDecode
<
	gO3CPUIm¶
>;

	@o3/decode.hh

43 #iâdeà
__CPU_O3_DECODE_HH__


44 
	#__CPU_O3_DECODE_HH__


	)

46 
	~<queue
>

48 
	~"ba£/¡©i¡ics.hh
"

49 
	~"ıu/timebuf.hh
"

51 
	gD”ivO3CPUP¬ams
;

60 
	g‹m¶©e
<
şass
 
	gIm¶
>

61 şas 
	cDeçuÉDecode


63 
	m´iv©e
:

65 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

66 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

67 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
 CPUPol;

70 
ty³Çme
 
	tCPUPŞ
::
	tF‘chSŒuù
 FetchStruct;

71 
ty³Çme
 
	tCPUPŞ
::
	tDecodeSŒuù
 DecodeStruct;

72 
ty³Çme
 
	tCPUPŞ
::
	tTimeSŒuù
 TimeStruct;

74 
	mpublic
:

78 
	eDecodeStus
 {

79 
Aùive
,

80 
	mIÇùive


84 
	eTh»adStus
 {

85 
	gRuÂšg
,

86 
	gIdË
,

87 
	gS¹Squash
,

88 
	gSquashšg
,

89 
	gBlocked
,

90 
	gUnblockšg


93 
	g´iv©e
:

95 
DecodeStus
 
_¡©us
;

98 
Th»adStus
 
	gdecodeStus
[
Im¶
::
MaxTh»ads
];

100 
	gpublic
:

102 
DeçuÉDecode
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
);

104 
¡¬tupSge
();

105 
»£tSge
();

108 
	g¡d
::
¡ršg
 
	$Çme
() const;

111 
	`»gSts
();

114 
	`£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
);

117 
	`£tDecodeQueue
(
TimeBufãr
<
DecodeSŒuù
> *
dq_±r
);

120 
	`£tF‘chQueue
(
TimeBufãr
<
F‘chSŒuù
> *
fq_±r
);

123 
	`£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

126 
	$d¿šSª™yCheck
() const;

129 
boŞ
 
	$isD¿šed
(ècÚ¡ {  
Œue
; 
	}
}

132 
	$keOv”From
(è{ 
	`»£tSge
(); 
	}
}

137 
tick
();

144 
decode
(
boŞ
 &
¡©us_chªge
, 
Th»adID
 
tid
);

151 
decodeIn¡s
(
Th»adID
 
tid
);

153 
	g´iv©e
:

157 
skidIn£¹
(
Th»adID
 
tid
);

160 
boŞ
 
skidsEm±y
();

163 
upd©eStus
();

168 
sÜtIn¡s
();

171 
»adSÎSigÇls
(
Th»adID
 
tid
);

174 
boŞ
 
checkSigÇlsAndUpd©e
(
Th»adID
 
tid
);

177 
boŞ
 
	$checkSÎ
(
Th»adID
 
tid
) const;

180 
šlše
 
boŞ
 
	`ãtchIn¡sV®id
();

186 
boŞ
 
	`block
(
Th»adID
 
tid
);

192 
boŞ
 
	`unblock
(
Th»adID
 
tid
);

197 
	`squash
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
);

199 
public
:

203 
	`squash
(
Th»adID
 
tid
);

205 
´iv©e
:

208 
O3CPU
 *
ıu
;

211 
TimeBufãr
<
TimeSŒuù
> *
timeBufãr
;

214 
ty³Çme
 
TimeBufãr
<
TimeSŒuù
>::
wœe
 
äomR’ame
;

217 
ty³Çme
 
TimeBufãr
<
TimeSŒuù
>::
wœe
 
äomIEW
;

220 
ty³Çme
 
TimeBufãr
<
TimeSŒuù
>::
wœe
 
äomComm™
;

224 
ty³Çme
 
TimeBufãr
<
TimeSŒuù
>::
wœe
 
toF‘ch
;

227 
TimeBufãr
<
DecodeSŒuù
> *
decodeQueue
;

230 
ty³Çme
 
TimeBufãr
<
DecodeSŒuù
>::
wœe
 
toR’ame
;

233 
TimeBufãr
<
F‘chSŒuù
> *
ãtchQueue
;

236 
ty³Çme
 
TimeBufãr
<
F‘chSŒuù
>::
wœe
 
äomF‘ch
;

239 
¡d
::
queue
<
DynIn¡PŒ
> 
š¡s
[
Im¶
::
MaxTh»ads
];

242 
¡d
::
queue
<
DynIn¡PŒ
> 
skidBufãr
[
Im¶
::
MaxTh»ads
];

247 
boŞ
 
wrÙeToTimeBufãr
;

250 
	sSÎs
 {

251 
boŞ
 
»Çme
;

252 
boŞ
 
›w
;

253 
boŞ
 
comm™
;

254 
	}
};

257 
SÎs
 
	g¡®ls
[
Im¶
::
MaxTh»ads
];

260 
Cyşes
 
	g»ÇmeToDecodeD–ay
;

263 
Cyşes
 
	g›wToDecodeD–ay
;

266 
Cyşes
 
	gcomm™ToDecodeD–ay
;

269 
Cyşes
 
	gãtchToDecodeD–ay
;

272 
	gdecodeWidth
;

275 
	gtoR’ameIndex
;

278 
Th»adID
 
	gnumTh»ads
;

281 
	g¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

284 
	gskidBufãrMax
;

287 
Addr
 
	gbd–ayDÚeSeqNum
[
Im¶
::
MaxTh»ads
];

290 
DynIn¡PŒ
 
	gsquashIn¡
[
Im¶
::
MaxTh»ads
];

296 
boŞ
 
	gsquashAá”D–aySlÙ
[
Im¶
::
MaxTh»ads
];

300 
	gSts
::
SÿÏr
 
decodeIdËCyşes
;

302 
	gSts
::
SÿÏr
 
decodeBlockedCyşes
;

304 
	gSts
::
SÿÏr
 
decodeRunCyşes
;

306 
	gSts
::
SÿÏr
 
decodeUnblockCyşes
;

308 
	gSts
::
SÿÏr
 
decodeSquashCyşes
;

310 
	gSts
::
SÿÏr
 
decodeB¿nchResŞved
;

312 
	gSts
::
SÿÏr
 
decodeB¿nchMi¥»d
;

316 
	gSts
::
SÿÏr
 
decodeCÚŒŞMi¥»d
;

318 
	gSts
::
SÿÏr
 
decodeDecodedIn¡s
;

320 
	gSts
::
SÿÏr
 
decodeSquashedIn¡s
;

	@o3/decode_impl.hh

43 #iâdeà
__CPU_O3_DECODE_IMPL_HH__


44 
	#__CPU_O3_DECODE_IMPL_HH__


	)

46 
	~"¬ch/ty³s.hh
"

47 
	~"ba£/Œaû.hh
"

48 
	~"cÚfig/the_i§.hh
"

49 
	~"ıu/o3/decode.hh
"

50 
	~"ıu/š¡_£q.hh
"

51 
	~"debug/Aùiv™y.hh
"

52 
	~"debug/Decode.hh
"

53 
	~"debug/O3PeV›w.hh
"

54 
	~"·¿ms/D”ivO3CPU.hh
"

55 
	~"sim/fuÎ_sy¡em.hh
"

59 
usšg
 
	g¡d
::
li¡
;

61 
	g‹m¶©e
<
şass
 
	gIm¶
>

62 
	gDeçuÉDecode
<
	gIm¶
>::
	$DeçuÉDecode
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
)

63 : 
	`ıu
(
_ıu
),

64 
	`»ÇmeToDecodeD–ay
(
·¿ms
->
»ÇmeToDecodeD–ay
),

65 
	`›wToDecodeD–ay
(
·¿ms
->
›wToDecodeD–ay
),

66 
	`comm™ToDecodeD–ay
(
·¿ms
->
comm™ToDecodeD–ay
),

67 
	`ãtchToDecodeD–ay
(
·¿ms
->
ãtchToDecodeD–ay
),

68 
	`decodeWidth
(
·¿ms
->
decodeWidth
),

69 
	`numTh»ads
(
·¿ms
->
numTh»ads
)

72 
skidBufãrMax
 = (
ãtchToDecodeD–ay
 + 1è* 
·¿ms
->
ãtchWidth
;

73 
	}
}

75 
	g‹m¶©e
<
şass
 
	gIm¶
>

77 
	gDeçuÉDecode
<
	gIm¶
>::
	$¡¬tupSge
()

79 
	`»£tSge
();

80 
	}
}

82 
	g‹m¶©e
<
şass
 
	gIm¶
>

84 
	gDeçuÉDecode
<
	gIm¶
>::
	$»£tSge
()

86 
_¡©us
 = 
IÇùive
;

89 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

90 
decodeStus
[
tid
] = 
IdË
;

92 
¡®ls
[
tid
].
»Çme
 = 
çl£
;

93 
¡®ls
[
tid
].
›w
 = 
çl£
;

94 
¡®ls
[
tid
].
comm™
 = 
çl£
;

96 
	}
}

98 
	g‹m¶©e
 <
şass
 
	gIm¶
>

99 
	g¡d
::
¡ršg


100 
DeçuÉDecode
<
Im¶
>::
	$Çme
() const

102  
ıu
->
	`Çme
() + ".decode";

103 
	}
}

105 
	g‹m¶©e
 <
şass
 
	gIm¶
>

107 
	gDeçuÉDecode
<
	gIm¶
>::
	$»gSts
()

109 
decodeIdËCyşes


110 .
	`Çme
(name() + ".IdleCycles")

111 .
	`desc
("Number of cycles decode is idle")

112 .
	`´”eq
(
decodeIdËCyşes
);

113 
decodeBlockedCyşes


114 .
	`Çme
(name() + ".BlockedCycles")

115 .
	`desc
("Number of cycles decode is blocked")

116 .
	`´”eq
(
decodeBlockedCyşes
);

117 
decodeRunCyşes


118 .
	`Çme
(name() + ".RunCycles")

119 .
	`desc
("Number of cycles decode is„unning")

120 .
	`´”eq
(
decodeRunCyşes
);

121 
decodeUnblockCyşes


122 .
	`Çme
(name() + ".UnblockCycles")

123 .
	`desc
("Number of cycles decode is unblocking")

124 .
	`´”eq
(
decodeUnblockCyşes
);

125 
decodeSquashCyşes


126 .
	`Çme
(name() + ".SquashCycles")

127 .
	`desc
("Number of cycles decode is squashing")

128 .
	`´”eq
(
decodeSquashCyşes
);

129 
decodeB¿nchResŞved


130 .
	`Çme
(name() + ".BranchResolved")

131 .
	`desc
("Number ofimes decode„esolved‡ branch")

132 .
	`´”eq
(
decodeB¿nchResŞved
);

133 
decodeB¿nchMi¥»d


134 .
	`Çme
(name() + ".BranchMispred")

135 .
	`desc
("Number ofimes decode detected‡ branch misprediction")

136 .
	`´”eq
(
decodeB¿nchMi¥»d
);

137 
decodeCÚŒŞMi¥»d


138 .
	`Çme
(name() + ".ControlMispred")

139 .
	`desc
("Number ofimes decode detected‡n instruction incorrectly"

141 .
	`´”eq
(
decodeCÚŒŞMi¥»d
);

142 
decodeDecodedIn¡s


143 .
	`Çme
(name() + ".DecodedInsts")

144 .
	`desc
("Number of instructions handled by decode")

145 .
	`´”eq
(
decodeDecodedIn¡s
);

146 
decodeSquashedIn¡s


147 .
	`Çme
(name() + ".SquashedInsts")

148 .
	`desc
("Number of squashed instructions handled by decode")

149 .
	`´”eq
(
decodeSquashedIn¡s
);

150 
	}
}

152 
	g‹m¶©e
<
şass
 
	gIm¶
>

154 
	gDeçuÉDecode
<
	gIm¶
>::
£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
)

156 
timeBufãr
 = 
tb_±r
;

159 
	gtoF‘ch
 = 
timeBufãr
->
g‘Wœe
(0);

162 
	gäomR’ame
 = 
timeBufãr
->
g‘Wœe
(-
»ÇmeToDecodeD–ay
);

163 
	gäomIEW
 = 
timeBufãr
->
g‘Wœe
(-
›wToDecodeD–ay
);

164 
	gäomComm™
 = 
timeBufãr
->
g‘Wœe
(-
comm™ToDecodeD–ay
);

167 
	g‹m¶©e
<
şass
 
	gIm¶
>

169 
	gDeçuÉDecode
<
	gIm¶
>::
£tDecodeQueue
(
TimeBufãr
<
DecodeSŒuù
> *
dq_±r
)

171 
decodeQueue
 = 
dq_±r
;

174 
	gtoR’ame
 = 
decodeQueue
->
g‘Wœe
(0);

177 
	g‹m¶©e
<
şass
 
	gIm¶
>

179 
	gDeçuÉDecode
<
	gIm¶
>::
£tF‘chQueue
(
TimeBufãr
<
F‘chSŒuù
> *
fq_±r
)

181 
ãtchQueue
 = 
fq_±r
;

184 
	gäomF‘ch
 = 
ãtchQueue
->
g‘Wœe
(-
ãtchToDecodeD–ay
);

187 
	g‹m¶©e
<
şass
 
	gIm¶
>

189 
	gDeçuÉDecode
<
	gIm¶
>::
£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
)

191 
aùiveTh»ads
 = 
©_±r
;

194 
	g‹m¶©e
 <
şass
 
	gIm¶
>

196 
	gDeçuÉDecode
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

198 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

199 
	`as£¹
(
š¡s
[
tid
].
	`em±y
());

200 
	`as£¹
(
skidBufãr
[
tid
].
	`em±y
());

202 
	}
}

204 
	g‹m¶©e
<
şass
 
	gIm¶
>

205 
boŞ


206 
	gDeçuÉDecode
<
	gIm¶
>::
	$checkSÎ
(
Th»adID
 
tid
) const

208 
boŞ
 
»t_v®
 = 
çl£
;

210 ià(
¡®ls
[
tid
].
»Çme
) {

211 
	`DPRINTF
(
Decode
,"[tid:%i]: SÎ fom R’am¡agd‘eùed.\n", 
tid
);

212 
»t_v®
 = 
Œue
;

213 } ià(
¡®ls
[
tid
].
›w
) {

214 
	`DPRINTF
(
Decode
,"[tid:%i]: SÎ fom IEW sgd‘eùed.\n", 
tid
);

215 
»t_v®
 = 
Œue
;

216 } ià(
¡®ls
[
tid
].
comm™
) {

217 
	`DPRINTF
(
Decode
,"[tid:%i]: SÎ fom Comm™ sgd‘eùed.\n", 
tid
);

218 
»t_v®
 = 
Œue
;

221  
»t_v®
;

222 
	}
}

224 
	g‹m¶©e
<
şass
 
	gIm¶
>

225 
šlše
 
boŞ


226 
	gDeçuÉDecode
<
	gIm¶
>::
	$ãtchIn¡sV®id
()

228  
äomF‘ch
->
size
 > 0;

229 
	}
}

231 
	g‹m¶©e
<
şass
 
	gIm¶
>

232 
boŞ


233 
	gDeçuÉDecode
<
	gIm¶
>::
	$block
(
Th»adID
 
tid
)

235 
	`DPRINTF
(
Decode
, "[tid:%u]: Blockšg.\n", 
tid
);

239 
	`skidIn£¹
(
tid
);

244 ià(
decodeStus
[
tid
] !ğ
Blocked
) {

246 
decodeStus
[
tid
] = 
Blocked
;

248 ià(
toF‘ch
->
decodeUnblock
[
tid
]) {

249 
toF‘ch
->
decodeUnblock
[
tid
] = 
çl£
;

251 
toF‘ch
->
decodeBlock
[
tid
] = 
Œue
;

252 
wrÙeToTimeBufãr
 = 
Œue
;

255  
Œue
;

258  
çl£
;

259 
	}
}

261 
	g‹m¶©e
<
şass
 
	gIm¶
>

262 
boŞ


263 
	gDeçuÉDecode
<
	gIm¶
>::
	$unblock
(
Th»adID
 
tid
)

266 ià(
skidBufãr
[
tid
].
	`em±y
()) {

267 
	`DPRINTF
(
Decode
, "[tid:%u]: DÚunblockšg.\n", 
tid
);

268 
toF‘ch
->
decodeUnblock
[
tid
] = 
Œue
;

269 
wrÙeToTimeBufãr
 = 
Œue
;

271 
decodeStus
[
tid
] = 
RuÂšg
;

272  
Œue
;

275 
	`DPRINTF
(
Decode
, "[tid:%u]: Cu¼’y unblockšg.\n", 
tid
);

277  
çl£
;

278 
	}
}

280 
	g‹m¶©e
<
şass
 
	gIm¶
>

282 
	gDeçuÉDecode
<
	gIm¶
>::
	$squash
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
)

284 
	`DPRINTF
(
Decode
, "[tid:%i]: [sn:%i] Squashing dueo incorrect branch "

285 "´ediùiÚ d‘eùed‡ˆdecode.\n", 
tid
, 
š¡
->
£qNum
);

288 
toF‘ch
->
decodeInfo
[
tid
].
b¿nchMi¥»diù
 = 
Œue
;

289 
toF‘ch
->
decodeInfo
[
tid
].
´edIncÜ»ù
 = 
Œue
;

290 
toF‘ch
->
decodeInfo
[
tid
].
mi¥»diùIn¡
 = 
š¡
;

291 
toF‘ch
->
decodeInfo
[
tid
].
squash
 = 
Œue
;

292 
toF‘ch
->
decodeInfo
[
tid
].
dÚeSeqNum
 = 
š¡
->
£qNum
;

293 
toF‘ch
->
decodeInfo
[
tid
].
ÃxtPC
 = 
š¡
->
	`b¿nchT¬g‘
();

294 
toF‘ch
->
decodeInfo
[
tid
].
b¿nchTak’
 = 
š¡
->
	`pcS‹
().
	`b¿nchšg
();

295 
toF‘ch
->
decodeInfo
[
tid
].
squashIn¡
 = 
š¡
;

296 ià(
toF‘ch
->
decodeInfo
[
tid
].
mi¥»diùIn¡
->
	`isUncÚdCŒl
()) {

297 
toF‘ch
->
decodeInfo
[
tid
].
b¿nchTak’
 = 
Œue
;

300 
In¡SeqNum
 
squash_£q_num
 = 
š¡
->
£qNum
;

303 ià(
decodeStus
[
tid
] =ğ
Blocked
 ||

304 
decodeStus
[
tid
] =ğ
Unblockšg
) {

305 
toF‘ch
->
decodeUnblock
[
tid
] = 1;

309 
decodeStus
[
tid
] = 
Squashšg
;

311 
i
=0; i<
äomF‘ch
->
size
; i++) {

312 ià(
äomF‘ch
->
š¡s
[
i
]->
th»adNumb”
 =ğ
tid
 &&

313 
äomF‘ch
->
š¡s
[
i
]->
£qNum
 > 
squash_£q_num
) {

314 
äomF‘ch
->
š¡s
[
i
]->
	`£tSquashed
();

320 !
š¡s
[
tid
].
	`em±y
()) {

321 
š¡s
[
tid
].
	`pİ
();

324 !
skidBufãr
[
tid
].
	`em±y
()) {

325 
skidBufãr
[
tid
].
	`pİ
();

329 
ıu
->
	`»moveIn¡sUÁ
(
squash_£q_num
, 
tid
);

330 
	}
}

332 
	g‹m¶©e
<
şass
 
	gIm¶
>

334 
	gDeçuÉDecode
<
	gIm¶
>::
	$squash
(
Th»adID
 
tid
)

336 
	`DPRINTF
(
Decode
, "[tid:%i]: Squashšg.\n",
tid
);

338 ià(
decodeStus
[
tid
] =ğ
Blocked
 ||

339 
decodeStus
[
tid
] =ğ
Unblockšg
) {

340 ià(
FuÎSy¡em
) {

341 
toF‘ch
->
decodeUnblock
[
tid
] = 1;

347 ià(
toF‘ch
->
decodeBlock
[
tid
])

348 
toF‘ch
->
decodeBlock
[
tid
] = 0;

350 
toF‘ch
->
decodeUnblock
[
tid
] = 1;

355 
decodeStus
[
tid
] = 
Squashšg
;

358 
squash_couÁ
 = 0;

360 
i
=0; i<
äomF‘ch
->
size
; i++) {

361 ià(
äomF‘ch
->
š¡s
[
i
]->
th»adNumb”
 =ğ
tid
) {

362 
äomF‘ch
->
š¡s
[
i
]->
	`£tSquashed
();

363 
squash_couÁ
++;

369 !
š¡s
[
tid
].
	`em±y
()) {

370 
š¡s
[
tid
].
	`pİ
();

373 !
skidBufãr
[
tid
].
	`em±y
()) {

374 
skidBufãr
[
tid
].
	`pİ
();

377  
squash_couÁ
;

378 
	}
}

380 
	g‹m¶©e
<
şass
 
	gIm¶
>

382 
	gDeçuÉDecode
<
	gIm¶
>::
	$skidIn£¹
(
Th»adID
 
tid
)

384 
DynIn¡PŒ
 
š¡
 = 
NULL
;

386 !
š¡s
[
tid
].
	`em±y
()) {

387 
š¡
 = 
š¡s
[
tid
].
	`äÚt
();

389 
š¡s
[
tid
].
	`pİ
();

391 
	`as£¹
(
tid
 =ğ
š¡
->
th»adNumb”
);

393 
	`DPRINTF
(
Decode
,"Inserting [sn:%lli] PC: %s into decode skidBuffer %i\n",

394 
š¡
->
£qNum
, in¡->
	`pcS‹
(), in¡->
th»adNumb”
);

396 
skidBufãr
[
tid
].
	`push
(
š¡
);

401 
	`as£¹
(
skidBufãr
[
tid
].
	`size
(è<ğ
skidBufãrMax
);

402 
	}
}

404 
	g‹m¶©e
<
şass
 
	gIm¶
>

405 
boŞ


406 
	gDeçuÉDecode
<
	gIm¶
>::
	$skidsEm±y
()

408 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

409 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

411 
th»ads
 !ğ
’d
) {

412 
Th»adID
 
tid
 = *
th»ads
++;

413 ià(!
skidBufãr
[
tid
].
	`em±y
())

414  
çl£
;

417  
Œue
;

418 
	}
}

420 
	g‹m¶©e
<
şass
 
	gIm¶
>

422 
	gDeçuÉDecode
<
	gIm¶
>::
	$upd©eStus
()

424 
boŞ
 
ªy_unblockšg
 = 
çl£
;

426 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

427 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

429 
th»ads
 !ğ
’d
) {

430 
Th»adID
 
tid
 = *
th»ads
++;

432 ià(
decodeStus
[
tid
] =ğ
Unblockšg
) {

433 
ªy_unblockšg
 = 
Œue
;

439 ià(
ªy_unblockšg
) {

440 ià(
_¡©us
 =ğ
IÇùive
) {

441 
_¡©us
 = 
Aùive
;

443 
	`DPRINTF
(
Aùiv™y
, "Activating stage.\n");

445 
ıu
->
	`aùiv©eSge
(
O3CPU
::
DecodeIdx
);

450 ià(
_¡©us
 =ğ
Aùive
) {

451 
_¡©us
 = 
IÇùive
;

452 
	`DPRINTF
(
Aùiv™y
, "Deactivating stage.\n");

454 
ıu
->
	`d—ùiv©eSge
(
O3CPU
::
DecodeIdx
);

457 
	}
}

459 
	g‹m¶©e
 <
şass
 
	gIm¶
>

461 
	gDeçuÉDecode
<
	gIm¶
>::
	$sÜtIn¡s
()

463 
š¡s_äom_ãtch
 = 
äomF‘ch
->
size
;

464 
i
 = 0; i < 
š¡s_äom_ãtch
; ++i) {

465 
š¡s
[
äomF‘ch
->š¡s[
i
]->
th»adNumb”
].
	`push
(fromFetch->insts[i]);

467 
	}
}

469 
	g‹m¶©e
<
şass
 
	gIm¶
>

471 
	gDeçuÉDecode
<
	gIm¶
>::
	$»adSÎSigÇls
(
Th»adID
 
tid
)

473 ià(
äomR’ame
->
»ÇmeBlock
[
tid
]) {

474 
¡®ls
[
tid
].
»Çme
 = 
Œue
;

477 ià(
äomR’ame
->
»ÇmeUnblock
[
tid
]) {

478 
	`as£¹
(
¡®ls
[
tid
].
»Çme
);

479 
¡®ls
[
tid
].
»Çme
 = 
çl£
;

482 ià(
äomIEW
->
›wBlock
[
tid
]) {

483 
¡®ls
[
tid
].
›w
 = 
Œue
;

486 ià(
äomIEW
->
›wUnblock
[
tid
]) {

487 
	`as£¹
(
¡®ls
[
tid
].
›w
);

488 
¡®ls
[
tid
].
›w
 = 
çl£
;

491 ià(
äomComm™
->
comm™Block
[
tid
]) {

492 
¡®ls
[
tid
].
comm™
 = 
Œue
;

495 ià(
äomComm™
->
comm™Unblock
[
tid
]) {

496 
	`as£¹
(
¡®ls
[
tid
].
comm™
);

497 
¡®ls
[
tid
].
comm™
 = 
çl£
;

499 
	}
}

501 
	g‹m¶©e
 <
şass
 
	gIm¶
>

502 
boŞ


503 
	gDeçuÉDecode
<
	gIm¶
>::
	$checkSigÇlsAndUpd©e
(
Th»adID
 
tid
)

514 
	`»adSÎSigÇls
(
tid
);

517 ià(
äomComm™
->
comm™Info
[
tid
].
squash
) {

519 
	`DPRINTF
(
Decode
, "[tid:%u]: Squashing instructions dueo squash "

520 "äom comm™.\n", 
tid
);

522 
	`squash
(
tid
);

524  
Œue
;

528 ià(
äomComm™
->
comm™Info
[
tid
].
robSquashšg
) {

529 
	`DPRINTF
(
Decode
, "[tid:%u]: ROB i ¡Èsquashšg.\n", 
tid
);

532 
decodeStus
[
tid
] = 
Squashšg
;

534  
Œue
;

537 ià(
	`checkSÎ
(
tid
)) {

538  
	`block
(
tid
);

541 ià(
decodeStus
[
tid
] =ğ
Blocked
) {

542 
	`DPRINTF
(
Decode
, "[tid:%u]: Done blocking, switchingo unblocking.\n",

543 
tid
);

545 
decodeStus
[
tid
] = 
Unblockšg
;

547 
	`unblock
(
tid
);

549  
Œue
;

552 ià(
decodeStus
[
tid
] =ğ
Squashšg
) {

555 
	`DPRINTF
(
Decode
, "[tid:%u]: Done squashing, switchingo„unning.\n",

556 
tid
);

558 
decodeStus
[
tid
] = 
RuÂšg
;

560  
çl£
;

565  
çl£
;

566 
	}
}

568 
	g‹m¶©e
<
şass
 
	gIm¶
>

570 
	gDeçuÉDecode
<
	gIm¶
>::
	$tick
()

572 
wrÙeToTimeBufãr
 = 
çl£
;

574 
boŞ
 
¡©us_chªge
 = 
çl£
;

576 
toR’ameIndex
 = 0;

578 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

579 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

581 
	`sÜtIn¡s
();

584 
th»ads
 !ğ
’d
) {

585 
Th»adID
 
tid
 = *
th»ads
++;

587 
	`DPRINTF
(
Decode
,"Proûssšg [tid:%i]\n",
tid
);

588 
¡©us_chªge
 = 
	`checkSigÇlsAndUpd©e
(
tid
) || status_change;

590 
	`decode
(
¡©us_chªge
, 
tid
);

593 ià(
¡©us_chªge
) {

594 
	`upd©eStus
();

597 ià(
wrÙeToTimeBufãr
) {

598 
	`DPRINTF
(
Aùiv™y
, "Activityhis cycle.\n");

600 
ıu
->
	`aùiv™yThisCyşe
();

602 
	}
}

604 
	g‹m¶©e
<
şass
 
	gIm¶
>

606 
	gDeçuÉDecode
<
	gIm¶
>::
	$decode
(
boŞ
 &
¡©us_chªge
, 
Th»adID
 
tid
)

615 ià(
decodeStus
[
tid
] =ğ
Blocked
) {

616 ++
decodeBlockedCyşes
;

617 } ià(
decodeStus
[
tid
] =ğ
Squashšg
) {

618 ++
decodeSquashCyşes
;

623 ià(
decodeStus
[
tid
] =ğ
RuÂšg
 ||

624 
decodeStus
[
tid
] =ğ
IdË
) {

625 
	`DPRINTF
(
Decode
, "[tid:%u]: Not blocked, so‡ttemptingo„un "

626 "¡age.\n",
tid
);

628 
	`decodeIn¡s
(
tid
);

629 } ià(
decodeStus
[
tid
] =ğ
Unblockšg
) {

632 
	`as£¹
(!
	`skidsEm±y
());

637 
	`decodeIn¡s
(
tid
);

639 ià(
	`ãtchIn¡sV®id
()) {

642 
	`skidIn£¹
(
tid
);

645 
¡©us_chªge
 = 
	`unblock
(
tid
) || status_change;

647 
	}
}

649 
	g‹m¶©e
 <
şass
 
	gIm¶
>

651 
	gDeçuÉDecode
<
	gIm¶
>::
	$decodeIn¡s
(
Th»adID
 
tid
)

655 
š¡s_avaabË
 = 
decodeStus
[
tid
] =ğ
Unblockšg
 ?

656 
skidBufãr
[
tid
].
	`size
(è: 
š¡s
[tid].size();

658 ià(
š¡s_avaabË
 == 0) {

659 
	`DPRINTF
(
Decode
, "[tid:%u] Nothingo do, breaking out"

660 "ƒ¬ly.\n",
tid
);

662 ++
decodeIdËCyşes
;

664 } ià(
decodeStus
[
tid
] =ğ
Unblockšg
) {

665 
	`DPRINTF
(
Decode
, "[tid:%u] Unblocking,„emoving insts from skid "

666 "bufãr.\n",
tid
);

667 ++
decodeUnblockCyşes
;

668 } ià(
decodeStus
[
tid
] =ğ
RuÂšg
) {

669 ++
decodeRunCyşes
;

672 
DynIn¡PŒ
 
š¡
;

674 
¡d
::
queue
<
DynIn¡PŒ
>

675 &
š¡s_to_decode
 = 
decodeStus
[
tid
] =ğ
Unblockšg
 ?

676 
skidBufãr
[
tid
] : 
š¡s
[tid];

678 
	`DPRINTF
(
Decode
, "[tid:%u]: S’dšg in¡ruùiÚØ»Çme.\n",
tid
);

680 
š¡s_avaabË
 > 0 && 
toR’ameIndex
 < 
decodeWidth
) {

681 
	`as£¹
(!
š¡s_to_decode
.
	`em±y
());

683 
š¡
 = 
š¡s_to_decode
.
	`äÚt
();

685 
š¡s_to_decode
.
	`pİ
();

687 
	`DPRINTF
(
Decode
, "[tid:%u]: Processing instruction [sn:%lli] with "

688 "PC %s\n", 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

690 ià(
š¡
->
	`isSquashed
()) {

691 
	`DPRINTF
(
Decode
, "[tid:%u]: Instruction %i with PC %s is "

693 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

695 ++
decodeSquashedIn¡s
;

697 --
š¡s_avaabË
;

706 ià(
š¡
->
	`numSrcRegs
() == 0) {

707 
š¡
->
	`£tCªIssue
();

713 
toR’ame
->
š¡s
[
toR’ameIndex
] = 
š¡
;

715 ++(
toR’ame
->
size
);

716 ++
toR’ameIndex
;

717 ++
decodeDecodedIn¡s
;

718 --
š¡s_avaabË
;

720 #ià
TRACING_ON


721 ià(
	`DTRACE
(
O3PeV›w
)) {

722 
š¡
->
decodeTick
 = 
	`curTick
(è- in¡->
ãtchTick
;

728 ià(
š¡
->
	`»adP»dTak’
(è&& !š¡->
	`isCÚŒŞ
()) {

729 
	`·nic
("Instruction…redicted‡s‡ branch!");

731 ++
decodeCÚŒŞMi¥»d
;

735 
	`squash
(
š¡
, in¡->
th»adNumb”
);

741 ià(
š¡
->
	`isDœeùCŒl
(è&& in¡->
	`isUncÚdCŒl
()) {

742 ++
decodeB¿nchResŞved
;

744 ià(!(
š¡
->
	`b¿nchT¬g‘
(è=ğš¡->
	`»adP»dT¬g
())) {

745 ++
decodeB¿nchMi¥»d
;

749 
	`squash
(
š¡
, in¡->
th»adNumb”
);

750 
TheISA
::
PCS‹
 
rg‘
 = 
š¡
->
	`b¿nchT¬g‘
();

752 
	`DPRINTF
(
Decode
, "[sn:%i]: Updating…redictions: PredPC: %s\n",

753 
š¡
->
£qNum
, 
rg‘
);

755 
š¡
->
	`£tP»dT¬g
(
rg‘
);

763 ià(!
š¡s_to_decode
.
	`em±y
()) {

764 
	`block
(
tid
);

769 ià(
toR’ameIndex
) {

770 
wrÙeToTimeBufãr
 = 
Œue
;

772 
	}
}

	@o3/dep_graph.hh

43 #iâdeà
__CPU_O3_DEP_GRAPH_HH__


44 
	#__CPU_O3_DEP_GRAPH_HH__


	)

46 
	~"ıu/o3/comm.hh
"

49 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

50 şas 
	cD•’d’cyEÁry


52 
	mpublic
:

53 
	$D•’d’cyEÁry
()

54 : 
	`š¡
(
NULL
), 
	$Ãxt
(
NULL
)

57 
DynIn¡PŒ
 
š¡
;

60 
D•’d’cyEÁry
<
DynIn¡PŒ
> *
Ãxt
;

61 
	}
};

72 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

73 şas 
	cD•’d’cyG¿ph


75 
	mpublic
:

76 
D•’d’cyEÁry
<
	tDynIn¡PŒ
> 
	tD•EÁry
;

79 
	$D•’d’cyG¿ph
()

80 : 
	`numEÁr›s
(0), 
	`memAÎocCouÁ”
(0), 
	`nodesT¿v”£d
(0), 
	$nodesRemoved
(0)

83 ~
	`D•’d’cyG¿ph
();

86 
	`»size
(
num_’Œ›s
);

89 
	`»£t
();

92 
	`š£¹
(
PhysRegIndex
 
idx
, 
DynIn¡PŒ
 &
Ãw_š¡
);

95 
	$£tIn¡
(
PhysRegIndex
 
idx
, 
DynIn¡PŒ
 &
Ãw_š¡
)

96 { 
d•’dG¿ph
[
idx
].
š¡
 = 
Ãw_š¡
; 
	}
}

99 
	$ş—rIn¡
(
PhysRegIndex
 
idx
)

100 { 
d•’dG¿ph
[
idx
].
š¡
 = 
NULL
; 
	}
}

103 
»move
(
PhysRegIndex
 
idx
, 
DynIn¡PŒ
 &
š¡_to_»move
);

106 
DynIn¡PŒ
 
pİ
(
PhysRegIndex
 
idx
);

109 
boŞ
 
	$em±y
() const;

112 
boŞ
 
	$em±y
(
PhysRegIndex
 
idx
ècÚ¡ {  !
d•’dG¿ph
[idx].
Ãxt
; 
	}
}

116 
dump
();

118 
	g´iv©e
:

125 
D•EÁry
 *
d•’dG¿ph
;

128 
	gnumEÁr›s
;

131 
	gmemAÎocCouÁ”
;

133 
	gpublic
:

135 
ušt64_t
 
nodesT¿v”£d
;

137 
ušt64_t
 
	gnodesRemoved
;

140 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

141 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
>::~
	$D•’d’cyG¿ph
()

143 
d–‘e
 [] 
d•’dG¿ph
;

144 
	}
}

146 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

148 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
>::
	$»size
(
num_’Œ›s
)

150 
numEÁr›s
 = 
num_’Œ›s
;

151 
d•’dG¿ph
 = 
Ãw
 
D•EÁry
[
numEÁr›s
];

152 
	}
}

154 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

156 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
>::
	$»£t
()

159 
D•EÁry
 *
cu¼
;

160 
D•EÁry
 *
´ev
;

162 
i
 = 0; i < 
numEÁr›s
; ++i) {

163 
cu¼
 = 
d•’dG¿ph
[
i
].
Ãxt
;

165 
cu¼
) {

166 
memAÎocCouÁ”
--;

168 
´ev
 = 
cu¼
;

169 
cu¼
 = 
´ev
->
Ãxt
;

170 
´ev
->
š¡
 = 
NULL
;

172 
d–‘e
 
´ev
;

175 ià(
d•’dG¿ph
[
i
].
š¡
) {

176 
d•’dG¿ph
[
i
].
š¡
 = 
NULL
;

179 
d•’dG¿ph
[
i
].
Ãxt
 = 
NULL
;

181 
	}
}

183 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

185 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
>::
	$š£¹
(
PhysRegIndex
 
idx
, 
DynIn¡PŒ
 &
Ãw_š¡
)

192 
D•EÁry
 *
Ãw_’Œy
 = 
Ãw
 DepEntry;

193 
Ãw_’Œy
->
Ãxt
 = 
d•’dG¿ph
[
idx
].next;

194 
Ãw_’Œy
->
š¡
 = 
Ãw_š¡
;

197 
d•’dG¿ph
[
idx
].
Ãxt
 = 
Ãw_’Œy
;

199 ++
memAÎocCouÁ”
;

200 
	}
}

203 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

205 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
>::
	$»move
(
PhysRegIndex
 
idx
,

206 
DynIn¡PŒ
 &
š¡_to_»move
)

208 
D•EÁry
 *
´ev
 = &
d•’dG¿ph
[
idx
];

209 
D•EÁry
 *
cu¼
 = 
d•’dG¿ph
[
idx
].
Ãxt
;

215 ià(
cu¼
 =ğ
NULL
) {

219 
nodesRemoved
++;

222 
cu¼
->
š¡
 !ğ
š¡_to_»move
) {

223 
´ev
 = 
cu¼
;

224 
cu¼
 = cu¼->
Ãxt
;

225 
nodesT¿v”£d
++;

227 
	`as£¹
(
cu¼
 !ğ
NULL
);

231 
´ev
->
Ãxt
 = 
cu¼
->next;

233 --
memAÎocCouÁ”
;

236 
cu¼
->
š¡
 = 
NULL
;

238 
d–‘e
 
cu¼
;

239 
	}
}

241 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

242 
DynIn¡PŒ


243 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
>::
	$pİ
(
PhysRegIndex
 
idx
)

245 
D•EÁry
 *
node
;

246 
node
 = 
d•’dG¿ph
[
idx
].
Ãxt
;

247 
DynIn¡PŒ
 
š¡
 = 
NULL
;

248 ià(
node
) {

249 
š¡
 = 
node
->inst;

250 
d•’dG¿ph
[
idx
].
Ãxt
 = 
node
->next;

251 
node
->
š¡
 = 
NULL
;

252 
memAÎocCouÁ”
--;

253 
d–‘e
 
node
;

255  
š¡
;

256 
	}
}

258 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

259 
boŞ


260 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
>::
	$em±y
() const

262 
i
 = 0; i < 
numEÁr›s
; ++i) {

263 ià(!
	`em±y
(
i
))

264  
çl£
;

266  
Œue
;

267 
	}
}

269 
	g‹m¶©e
 <
şass
 
	gDynIn¡PŒ
>

271 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
>::
	$dump
()

273 
D•EÁry
 *
cu¼
;

275 
i
 = 0; i < 
numEÁr›s
; ++i)

277 
cu¼
 = &
d•’dG¿ph
[
i
];

279 ià(
cu¼
->
š¡
) {

280 
	`ırštf
("dependGraph[%i]:…roducer: %s [sn:%lli] consumer: ",

281 
i
, 
cu¼
->
š¡
->
	`pcS‹
(), cu¼->š¡->
£qNum
);

283 
	`ırštf
("d•’dG¿ph[%i]: NØ´oduûr. cÚsum”: ", 
i
);

286 
cu¼
->
Ãxt
 !ğ
NULL
) {

287 
cu¼
 = cu¼->
Ãxt
;

289 
	`ırštf
("%s [sn:%lli] ",

290 
cu¼
->
š¡
->
	`pcS‹
(), cu¼->š¡->
£qNum
);

293 
	`ırštf
("\n");

295 
	`ırštf
("memAÎocCouÁ”: %i\n", 
memAÎocCouÁ”
);

296 
	}
}

	@o3/deriv.cc

31 
	~<¡ršg
>

33 
	~"ıu/o3/d”iv.hh
"

34 
	~"·¿ms/D”ivO3CPU.hh
"

36 
D”ivO3CPU
 *

37 
	gD”ivO3CPUP¬ams
::
	$ü—‹
()

39 
Th»adID
 
aùu®_num_th»ads
;

40 ià(
FuÎSy¡em
) {

42 
aùu®_num_th»ads
 = 1;

44 ià(
wÜklßd
.
	`size
(è> 
numTh»ads
) {

45 
	`çl
("Workload Size (%i) > Max Supported Threads (%i) on This CPU",

46 
wÜklßd
.
	`size
(), 
numTh»ads
);

47 } ià(
wÜklßd
.
	`size
() == 0) {

48 
	`çl
("Must specify‡t†east one workload!");

53 
aùu®_num_th»ads
 =

54 (
numTh»ads
 >ğ
wÜklßd
.
	`size
()) ?‚umThreads : workload.size();

57 
numTh»ads
 = 
aùu®_num_th»ads
;

60 
¡d
::
¡ršg
 
round_robš_pŞicy
 = "RoundRobin";

61 
¡d
::
¡ršg
 
sšgË_th»ad
 = "SingleThread";

63 ià(
aùu®_num_th»ads
 > 1 && 
sšgË_th»ad
.
	`com·»
(
smtF‘chPŞicy
) == 0)

64 
smtF‘chPŞicy
 = 
round_robš_pŞicy
;

66 
smtF‘chPŞicy
 = smtFetchPolicy;

68  
Ãw
 
	`D”ivO3CPU
(
this
);

69 
	}
}

	@o3/deriv.hh

31 #iâdeà
__CPU_O3_DERIV_HH__


32 
	#__CPU_O3_DERIV_HH__


	)

34 
	~"ıu/o3/ıu.hh
"

35 
	~"ıu/o3/im¶.hh
"

36 
	~"·¿ms/D”ivO3CPU.hh
"

38 
şass
 
	gD”ivO3CPU
 : 
public
 
FuÎO3CPU
<
O3CPUIm¶
>

40 
public
:

41 
D”ivO3CPU
(
D”ivO3CPUP¬ams
 *
p
)

42 : 
FuÎO3CPU
<
O3CPUIm¶
>(
p
)

	@o3/dyn_inst.cc

31 
	~"ıu/o3/dyn_š¡_im¶.hh
"

32 
	~"ıu/o3/im¶.hh
"

36 
‹m¶©e
 
şass
 
	gBa£O3DynIn¡
<
	gO3CPUIm¶
>;

	@o3/dyn_inst.hh

44 #iâdeà
__CPU_O3_DYN_INST_HH__


45 
	#__CPU_O3_DYN_INST_HH__


	)

47 
	~"¬ch/i§_Œa™s.hh
"

48 
	~"cÚfig/the_i§.hh
"

49 
	~"ıu/o3/ıu.hh
"

50 
	~"ıu/o3/i§_¥ecific.hh
"

51 
	~"ıu/ba£_dyn_š¡.hh
"

52 
	~"ıu/š¡_£q.hh
"

53 
	~"ıu/»g_şass.hh
"

55 
şass
 
	gPack‘
;

64 
	g‹m¶©e
 <
şass
 
	gIm¶
>

65 
şass
 
	gBa£O3DynIn¡
 : 
public
 
Ba£DynIn¡
<
Im¶
>

67 
public
:

69 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

72 
	gTheISA
::
	tMachIn¡
 MachInst;

74 
	gTheISA
::
	tExtMachIn¡
 ExtMachInst;

76 
	gTheISA
::
	tRegIndex
 RegIndex;

78 
	gTheISA
::
	tIÁReg
 IntReg;

79 
	gTheISA
::
	tFlßtReg
 FloatReg;

80 
	gTheISA
::
	tFlßtRegB™s
 FloatRegBits;

81 #ifdeà
ISA_HAS_CC_REGS


82 
	gTheISA
::
	tCCReg
 CCReg;

85 
	gTheISA
::
	tMiscReg
 MiscReg;

88 
	gMaxIn¡SrcRegs
 = 
TheISA
::
MaxIn¡SrcRegs
,

89 
	gMaxIn¡De¡Regs
 = 
TheISA
::
MaxIn¡De¡Regs


92 
	gpublic
:

94 
Ba£O3DynIn¡
(
SticIn¡PŒ
 
¡©icIn¡
, SticIn¡PŒ 
maüoİ
,

95 
TheISA
::
PCS‹
 
pc
, TheISA::PCS‹ 
´edPC
,

96 
In¡SeqNum
 
£q_num
, 
O3CPU
 *
ıu
);

99 
Ba£O3DynIn¡
(
SticIn¡PŒ
 
_¡©icIn¡
, SticIn¡PŒ 
_maüoİ
);

101 ~
Ba£O3DynIn¡
();

104 
FauÉ
 
execu‹
();

107 
FauÉ
 
š™Ÿ‹Acc
();

110 
FauÉ
 
com¶‘eAcc
(
Pack‘PŒ
 
pkt
);

112 
	g´iv©e
:

114 
š™V¬s
();

116 
	g´Ùeùed
:

118 
MiscReg
 
_de¡MiscRegV®
[
TheISA
::
MaxMiscDe¡Regs
];

124 
	g_de¡MiscRegIdx
[
TheISA
::
MaxMiscDe¡Regs
];

127 
ušt8_t
 
	g_numDe¡MiscRegs
;

130 
	gpublic
:

131 #ià
TRACING_ON


133 
Tick
 
ãtchTick
;

134 
št32_t
 
	gdecodeTick
;

135 
št32_t
 
	g»ÇmeTick
;

136 
št32_t
 
	gdi¥©chTick
;

137 
št32_t
 
	gissueTick
;

138 
št32_t
 
	gcom¶‘eTick
;

139 
št32_t
 
	gcomm™Tick
;

140 
št32_t
 
	g¡ÜeTick
;

146 
MiscReg
 
»adMiscReg
(
misc_»g
)

148  
	gthis
->
	gıu
->
»adMiscReg
(
misc_»g
, 
this
->
th»adNumb”
);

154 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

162 
	gidx
 = 0; idx < 
	g_numDe¡MiscRegs
; idx++) {

163 ià(
	g_de¡MiscRegIdx
[
idx
] =ğ
misc_»g
) {

164 
_de¡MiscRegV®
[
idx
] = 
v®
;

169 
as£¹
(
_numDe¡MiscRegs
 < 
TheISA
::
MaxMiscDe¡Regs
);

170 
	g_de¡MiscRegIdx
[
_numDe¡MiscRegs
] = 
misc_»g
;

171 
	g_de¡MiscRegV®
[
_numDe¡MiscRegs
] = 
v®
;

172 
	g_numDe¡MiscRegs
++;

178 
	gTheISA
::
MiscReg
 
»adMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

180  
	gthis
->
	gıu
->
»adMiscReg
(

181 
si
->
¤cRegIdx
(
idx
è- 
TheISA
::
Misc_Reg_Ba£
,

182 
this
->
th»adNumb”
);

188 
£tMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

189 cÚ¡ 
MiscReg
 &
v®
)

191 
	gmisc_»g
 = 
si
->
de¡RegIdx
(
idx
è- 
TheISA
::
Misc_Reg_Ba£
;

192 
£tMiscReg
(
misc_»g
, 
v®
);

196 
upd©eMiscRegs
()

202 
boŞ
 
	gno_squash_äom_TC
 = 
this
->
th»ad
->
noSquashFromTC
;

203 
	gthis
->
	gth»ad
->
	gnoSquashFromTC
 = 
Œue
;

205 
	gi
 = 0; i < 
	g_numDe¡MiscRegs
; i++)

206 
	gthis
->
	gıu
->
£tMiscReg
(

207 
_de¡MiscRegIdx
[
i
], 
_de¡MiscRegV®
[i], 
this
->
th»adNumb”
);

209 
	gthis
->
	gth»ad
->
	gnoSquashFromTC
 = 
no_squash_äom_TC
;

212 
fÜw¬dOldRegs
()

215 
	gidx
 = 0; idx < 
	gthis
->
numDe¡Regs
(); idx++) {

216 
PhysRegIndex
 
	g´ev_phys_»g
 = 
this
->
´evDe¡RegIdx
(
idx
);

217 
	gTheISA
::
RegIndex
 
Üigš®_de¡_»g
 =

218 
this
->
¡©icIn¡
->
de¡RegIdx
(
idx
);

219 
»gIdxToCÏss
(
Üigš®_de¡_»g
)) {

220 
	gIÁRegCÏss
:

221 
this
->
£tIÁRegO³¿nd
Ñhis->
¡©icIn¡
.
g‘
(), 
idx
,

222 
this
->
ıu
->
»adIÁReg
(
´ev_phys_»g
));

224 
	gFlßtRegCÏss
:

225 
this
->
£tFlßtRegO³¿ndB™s
Ñhis->
¡©icIn¡
.
g‘
(), 
idx
,

226 
this
->
ıu
->
»adFlßtRegB™s
(
´ev_phys_»g
));

228 
	gCCRegCÏss
:

229 
this
->
£tCCRegO³¿nd
Ñhis->
¡©icIn¡
.
g‘
(), 
idx
,

230 
this
->
ıu
->
»adCCReg
(
´ev_phys_»g
));

232 
	gMiscRegCÏss
:

239 
FauÉ
 
hw»i
();

241 
Œ­
(
FauÉ
 
çuÉ
);

242 
boŞ
 
simP®Check
(
·lFunc
);

245 
sysÿÎ
(
št64_t
 
ÿÎnum
);

247 
	gpublic
:

260 
ušt64_t
 
»adIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

262  
	gthis
->
	gıu
->
»adIÁReg
(
this
->
_¤cRegIdx
[
idx
]);

265 
FlßtReg
 
»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

267  
	gthis
->
	gıu
->
»adFlßtReg
(
this
->
_¤cRegIdx
[
idx
]);

270 
FlßtRegB™s
 
»adFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

272  
	gthis
->
	gıu
->
»adFlßtRegB™s
(
this
->
_¤cRegIdx
[
idx
]);

275 
ušt64_t
 
»adCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

277  
	gthis
->
	gıu
->
»adCCReg
(
this
->
_¤cRegIdx
[
idx
]);

283 
£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

285 
	gthis
->
	gıu
->
£tIÁReg
(
this
->
_de¡RegIdx
[
idx
], 
v®
);

286 
	gBa£DynIn¡
<
	gIm¶
>::
£tIÁRegO³¿nd
(
si
, 
idx
, 
v®
);

289 
£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
)

291 
	gthis
->
	gıu
->
£tFlßtReg
(
this
->
_de¡RegIdx
[
idx
], 
v®
);

292 
	gBa£DynIn¡
<
	gIm¶
>::
£tFlßtRegO³¿nd
(
si
, 
idx
, 
v®
);

295 
£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

296 
FlßtRegB™s
 
v®
)

298 
	gthis
->
	gıu
->
£tFlßtRegB™s
(
this
->
_de¡RegIdx
[
idx
], 
v®
);

299 
	gBa£DynIn¡
<
	gIm¶
>::
£tFlßtRegO³¿ndB™s
(
si
, 
idx
, 
v®
);

302 
£tCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

304 
	gthis
->
	gıu
->
£tCCReg
(
this
->
_de¡RegIdx
[
idx
], 
v®
);

305 
	gBa£DynIn¡
<
	gIm¶
>::
£tCCRegO³¿nd
(
si
, 
idx
, 
v®
);

308 #ià
THE_ISA
 =ğ
MIPS_ISA


309 
ušt64_t
 
»adRegOth”Th»ad
(
misc_»g
)

311 
·nic
("MIPS MT‚ot defined for O3 CPU.\n");

315 
£tRegOth”Th»ad
(
misc_»g
, cÚ¡ 
TheISA
::
MiscReg
 &
v®
)

317 
·nic
("MIPS MT‚ot defined for O3 CPU.\n");

321 
	gpublic
:

326 
FauÉ
 
ÿlcEA
()

328  
this
->
¡©icIn¡
->
—CompIn¡
()->
execu‹
Ñhis,his->
ŒaûD©a
);

335 
FauÉ
 
memAcûss
()

337  
	gthis
->
	g¡©icIn¡
->
memAccIn¡
()->
execu‹
(
this
,his->
ŒaûD©a
);

	@o3/dyn_inst_impl.hh

43 #iâdeà
__CPU_O3_DYN_INST_IMPL_HH__


44 
	#__CPU_O3_DYN_INST_IMPL_HH__


	)

46 
	~"ba£/ı_ªnÙ©e.hh
"

47 
	~"ıu/o3/dyn_š¡.hh
"

48 
	~"sim/fuÎ_sy¡em.hh
"

49 
	~"debug/O3PeV›w.hh
"

51 
	g‹m¶©e
 <
şass
 
	gIm¶
>

52 
	gBa£O3DynIn¡
<
	gIm¶
>::
Ba£O3DynIn¡
(
SticIn¡PŒ
 
¡©icIn¡
,

53 
SticIn¡PŒ
 
maüoİ
,

54 
TheISA
::
PCS‹
 
pc
, TheISA::PCS‹ 
´edPC
,

55 
In¡SeqNum
 
£q_num
, 
O3CPU
 *
ıu
)

56 : 
Ba£DynIn¡
<
Im¶
>(
¡©icIn¡
, 
	gmaüoİ
, 
	gpc
, 
	g´edPC
, 
	g£q_num
, 
	gıu
)

58 
š™V¬s
();

61 
	g‹m¶©e
 <
şass
 
	gIm¶
>

62 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$Ba£O3DynIn¡
(
SticIn¡PŒ
 
_¡©icIn¡
,

63 
SticIn¡PŒ
 
_maüoİ
)

64 : 
Ba£DynIn¡
<
Im¶
>(
_¡©icIn¡
, 
_maüoİ
)

66 
	`š™V¬s
();

67 
	}
}

69 
	g‹m¶©e
 <
şass
 
	gIm¶
>
	gBa£O3DynIn¡
<Im¶>::~
	$Ba£O3DynIn¡
()

71 #ià
TRACING_ON


72 ià(
	`DTRACE
(
O3PeV›w
)) {

73 
Tick
 
ãtch
 = 
this
->
ãtchTick
;

75 ià(
ãtch
 != -1) {

76 
Tick
 
v®
;

78 
	`DPRINTFR
(
O3PeV›w
, "O3PipeView:fetch:%llu:0x%08llx:%d:%llu:%s\n",

79 
ãtch
,

80 
this
->
	`š¡Addr
(),

81 
this
->
	`miüoPC
(),

82 
this
->
£qNum
,

83 
this
->
¡©icIn¡
->
	`di§s£mbË
Ñhis->
	`š¡Addr
()));

85 
v®
 = (
this
->
decodeTick
 =ğ-1è? 0 : 
ãtch
 +his->decodeTick;

86 
	`DPRINTFR
(
O3PeV›w
, "O3PeV›w:decode:%Îu\n", 
v®
);

87 
v®
 = (
this
->
»ÇmeTick
 =ğ-1è? 0 : 
ãtch
 +his->renameTick;

88 
	`DPRINTFR
(
O3PeV›w
, "O3PeV›w:»Çme:%Îu\n", 
v®
);

89 
v®
 = (
this
->
di¥©chTick
 =ğ-1è? 0 : 
ãtch
 +his->dispatchTick;

90 
	`DPRINTFR
(
O3PeV›w
, "O3PeV›w:di¥©ch:%Îu\n", 
v®
);

91 
v®
 = (
this
->
issueTick
 =ğ-1è? 0 : 
ãtch
 +his->issueTick;

92 
	`DPRINTFR
(
O3PeV›w
, "O3PeV›w:issue:%Îu\n", 
v®
);

93 
v®
 = (
this
->
com¶‘eTick
 =ğ-1è? 0 : 
ãtch
 +his->completeTick;

94 
	`DPRINTFR
(
O3PeV›w
, "O3PeV›w:com¶‘e:%Îu\n", 
v®
);

95 
v®
 = (
this
->
comm™Tick
 =ğ-1è? 0 : 
ãtch
 +his->commitTick;

97 
Tick
 
v®S
 = (
this
->
¡ÜeTick
 =ğ-1è? 0 : 
ãtch
 +his->storeTick;

98 
	`DPRINTFR
(
O3PeV›w
, "O3PeV›w:»tœe:%Îu:¡Üe:%Îu\n", 
v®
, 
v®S
);

102 
	}
};

105 
	g‹m¶©e
 <
şass
 
	gIm¶
>

107 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$š™V¬s
()

112 
i
 = 0; i < 
this
->
¡©icIn¡
->
	`numDe¡Regs
(); i++) {

113 
this
->
_de¡RegIdx
[
i
] =his->
¡©icIn¡
->
	`de¡RegIdx
(i);

116 
i
 = 0; i < 
this
->
¡©icIn¡
->
	`numSrcRegs
(); i++) {

117 
this
->
_¤cRegIdx
[
i
] =his->
¡©icIn¡
->
	`¤cRegIdx
(i);

120 
this
->
_»adySrcRegIdx
.
	`»£t
();

122 
_numDe¡MiscRegs
 = 0;

124 #ià
TRACING_ON


127 
ãtchTick
 = -1;

128 
decodeTick
 = -1;

129 
»ÇmeTick
 = -1;

130 
di¥©chTick
 = -1;

131 
issueTick
 = -1;

132 
com¶‘eTick
 = -1;

133 
comm™Tick
 = -1;

134 
¡ÜeTick
 = -1;

136 
	}
}

138 
	g‹m¶©e
 <
şass
 
	gIm¶
>

139 
FauÉ


140 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$execu‹
()

146 
boŞ
 
no_squash_äom_TC
 = 
this
->
th»ad
->
noSquashFromTC
;

147 
this
->
th»ad
->
noSquashFromTC
 = 
Œue
;

149 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`execu‹
Ñhis,his->
ŒaûD©a
);

151 
this
->
th»ad
->
noSquashFromTC
 = 
no_squash_äom_TC
;

153  
this
->
çuÉ
;

154 
	}
}

156 
	g‹m¶©e
 <
şass
 
	gIm¶
>

157 
FauÉ


158 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$š™Ÿ‹Acc
()

164 
boŞ
 
no_squash_äom_TC
 = 
this
->
th»ad
->
noSquashFromTC
;

165 
this
->
th»ad
->
noSquashFromTC
 = 
Œue
;

167 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`š™Ÿ‹Acc
Ñhis,his->
ŒaûD©a
);

169 
this
->
th»ad
->
noSquashFromTC
 = 
no_squash_äom_TC
;

171  
this
->
çuÉ
;

172 
	}
}

174 
	g‹m¶©e
 <
şass
 
	gIm¶
>

175 
FauÉ


176 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$com¶‘eAcc
(
Pack‘PŒ
 
pkt
)

182 
boŞ
 
no_squash_äom_TC
 = 
this
->
th»ad
->
noSquashFromTC
;

183 
this
->
th»ad
->
noSquashFromTC
 = 
Œue
;

185 ià(
this
->
ıu
->
check”
) {

186 ià(
this
->
	`isStÜeCÚd™iÚ®
()) {

187 
this
->
»qToV”ify
->
	`£tExŒaD©a
(
pkt
->
»q
->
	`g‘ExŒaD©a
());

191 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`com¶‘eAcc
(
pkt
,his,his->
ŒaûD©a
);

193 
this
->
th»ad
->
noSquashFromTC
 = 
no_squash_äom_TC
;

195  
this
->
çuÉ
;

196 
	}
}

198 
	g‹m¶©e
 <
şass
 
	gIm¶
>

199 
FauÉ


200 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$hw»i
()

202 #ià
THE_ISA
 =ğ
ALPHA_ISA


204 ià(!(
this
->
	`š¡Addr
() & 0x3))

205  
Ãw
 
AÍhaISA
::
Unim¶em’‹dOpcodeFauÉ
;

208 
AÍhaISA
::
PCS‹
 
pc
 = 
this
->
	`pcS‹
();

209 
pc
.
	`Åc
(
this
->
ıu
->
	`»adMiscRegNoEfãù
(
AÍhaISA
::
IPR_EXC_ADDR
,

210 
this
->
th»adNumb”
));

211 
this
->
	`pcS‹
(
pc
);

212 ià(
CPA
::
	`avaabË
()) {

213 
Th»adCÚ‹xt
 *
tc
 = 
this
->
ıu
->
	`tcBa£
Ñhis->
th»adNumb”
);

214 
CPA
::
	`ıa
()->
	`swAutoBegš
(
tc
, 
this
->
	`ÃxtIn¡Addr
());

218 
this
->
ıu
->
	`hw»i
Ñhis->
th»adNumb”
);

223  
NoFauÉ
;

224 
	}
}

226 
	g‹m¶©e
 <
şass
 
	gIm¶
>

228 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$Œ­
(
FauÉ
 
çuÉ
)

230 
this
->
ıu
->
	`Œ­
(
çuÉ
,his->
th»adNumb”
,his->
¡©icIn¡
);

231 
	}
}

233 
	g‹m¶©e
 <
şass
 
	gIm¶
>

234 
boŞ


235 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$simP®Check
(
·lFunc
)

237 #ià
THE_ISA
 !ğ
ALPHA_ISA


238 
	`·nic
("simPalCheck called, but PAL onlyƒxists in Alpha!\n");

240  
this
->
ıu
->
	`simP®Check
(
·lFunc
,his->
th»adNumb”
);

241 
	}
}

243 
	g‹m¶©e
 <
şass
 
	gIm¶
>

245 
	gBa£O3DynIn¡
<
	gIm¶
>::
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

247 ià(
FuÎSy¡em
)

248 
	`·nic
("Syscallƒmulation isn't‡vailable in FS mode.\n");

253 
TheISA
::
PCS‹
 
curPC
 = 
this
->
ıu
->
	`pcS‹
Ñhis->
th»adNumb”
);

254 
this
->
ıu
->
	`sysÿÎ
(
ÿÎnum
,his->
th»adNumb”
);

255 
TheISA
::
PCS‹
 
ÃwPC
 = 
this
->
ıu
->
	`pcS‹
Ñhis->
th»adNumb”
);

256 ià(!(
curPC
 =ğ
ÃwPC
)) {

257 
this
->
	`pcS‹
(
ÃwPC
);

259 
	}
}

	@o3/fetch.cc

31 
	~"ıu/o3/ãtch_im¶.hh
"

32 
	~"ıu/o3/i§_¥ecific.hh
"

34 
‹m¶©e
 
şass
 
	gDeçuÉF‘ch
<
	gO3CPUIm¶
>;

	@o3/fetch.hh

44 #iâdeà
__CPU_O3_FETCH_HH__


45 
	#__CPU_O3_FETCH_HH__


	)

47 
	~"¬ch/decod”.hh
"

48 
	~"¬ch/ut™y.hh
"

49 
	~"ba£/¡©i¡ics.hh
"

50 
	~"cÚfig/the_i§.hh
"

51 
	~"ıu/pc_ev’t.hh
"

52 
	~"ıu/´ed/b´ed_un™.hh
"

53 
	~"ıu/timebuf.hh
"

54 
	~"ıu/Œª¦©iÚ.hh
"

55 
	~"mem/·ck‘.hh
"

56 
	~"mem/pÜt.hh
"

57 
	~"sim/ev’tq.hh
"

59 
	gD”ivO3CPUP¬ams
;

69 
	g‹m¶©e
 <
şass
 
	gIm¶
>

70 şas 
	cDeçuÉF‘ch


72 
	mpublic
:

74 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
 CPUPol;

75 
ty³Çme
 
	tIm¶
::
	tDynIn¡
 DynInst;

76 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

77 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

80 
ty³Çme
 
	tCPUPŞ
::
	tF‘chSŒuù
 FetchStruct;

81 
ty³Çme
 
	tCPUPŞ
::
	tTimeSŒuù
 TimeStruct;

84 
	mTheISA
::
	tMachIn¡
 MachInst;

85 
	mTheISA
::
	tExtMachIn¡
 ExtMachInst;

87 şas 
	cF‘chT¿n¦©iÚ
 : 
public
 
Ba£TLB
::
T¿n¦©iÚ


89 
´Ùeùed
:

90 
DeçuÉF‘ch
<
Im¶
> *
ãtch
;

92 
	mpublic
:

93 
F‘chT¿n¦©iÚ
(
DeçuÉF‘ch
<
Im¶
> *
_ãtch
)

94 : 
ãtch
(
_ãtch
)

98 
m¬kD–ayed
()

102 
fšish
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
,

103 
Ba£TLB
::
Mode
 
mode
)

105 
as£¹
(
mode
 =ğ
Ba£TLB
::
Execu‹
);

106 
	mãtch
->
fšishT¿n¦©iÚ
(
çuÉ
, 
»q
);

107 
d–‘e
 
	mthis
;

111 
	g´iv©e
:

115 şas 
	cFšishT¿n¦©iÚEv’t
 : 
public
 
Ev’t


117 
´iv©e
:

118 
DeçuÉF‘ch
<
Im¶
> *
ãtch
;

119 
FauÉ
 
	gçuÉ
;

120 
Reque¡PŒ
 
	g»q
;

122 
	gpublic
:

123 
FšishT¿n¦©iÚEv’t
(
DeçuÉF‘ch
<
Im¶
> *
_ãtch
)

124 : 
ãtch
(
_ãtch
)

127 
£tFauÉ
(
FauÉ
 
_çuÉ
)

129 
çuÉ
 = 
_çuÉ
;

132 
£tReq
(
Reque¡PŒ
 
_»q
)

134 
	g»q
 = 
_»q
;

138 
´oûss
()

140 
as£¹
(
ãtch
->
numIn¡
 < f‘ch->
ãtchWidth
);

141 
	gãtch
->
fšishT¿n¦©iÚ
(
çuÉ
, 
»q
);

144 cÚ¡ *
desütiÚ
() const

150 
	gpublic
:

154 
	eF‘chStus
 {

155 
Aùive
,

156 
	gIÇùive


160 
	eTh»adStus
 {

161 
	gRuÂšg
,

162 
	gIdË
,

163 
	gSquashšg
,

164 
	gBlocked
,

165 
	gF‘chšg
,

166 
	gT¿pP’dšg
,

167 
	gQu›sûP’dšg
,

168 
	gIbWa™
,

169 
	gIÿcheWa™Re¥Ú£
,

170 
	gIÿcheWa™R‘ry
,

171 
	gIÿcheAcûssCom¶‘e
,

172 
	gNoGoodAddr


176 
	eF‘chPriÜ™y
 {

177 
	gSšgËTh»ad
,

178 
	gRoundRobš
,

179 
	gB¿nch
,

180 
	gIQ
,

181 
	gLSQ


184 
	g´iv©e
:

186 
F‘chStus
 
_¡©us
;

189 
Th»adStus
 
	gãtchStus
[
Im¶
::
MaxTh»ads
];

192 
F‘chPriÜ™y
 
	gãtchPŞicy
;

195 
	g¡d
::
li¡
<
Th»adID
> 
´iÜ™yLi¡
;

197 
	gpublic
:

199 
DeçuÉF‘ch
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
);

202 
	g¡d
::
¡ršg
 
	$Çme
() const;

205 
	`»gSts
();

208 
	`£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
time_bufãr
);

211 
	`£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

214 
	`£tF‘chQueue
(
TimeBufãr
<
F‘chSŒuù
> *
fq_±r
);

217 
	`¡¬tupSge
();

220 
	`»cvR‘ry
();

223 
	`´oûssCacheCom¶‘iÚ
(
Pack‘PŒ
 
pkt
);

226 
	`d¿šResume
();

229 
	$d¿šSª™yCheck
() const;

232 
boŞ
 
	$isD¿šed
() const;

235 
	`keOv”From
();

246 
	`d¿šSÎ
(
Th»adID
 
tid
);

249 
	`wakeFromQu›sû
();

251 
´iv©e
:

253 
	`»£tSge
();

258 
šlše
 
	`sw™chToAùive
();

263 
šlše
 
	`sw™chToIÇùive
();

274 
boŞ
 
	`lookupAndUpd©eNextPC
(
DynIn¡PŒ
 &
š¡
, 
TheISA
::
PCS‹
 &
pc
);

287 
boŞ
 
	`ãtchCacheLše
(
Addr
 
vaddr
, 
Th»adID
 
tid
, Add¸
pc
);

288 
	`fšishT¿n¦©iÚ
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
mem_»q
);

293 
boŞ


294 
	$checkIÁ”ru±
(
Addr
 
pc
)

296  (
š‹¼u±P’dšg
 && (
THE_ISA
 !ğ
ALPHA_ISA
 || !(
pc
 & 0x3)));

297 
	}
}

300 
šlše
 
doSquash
(cÚ¡ 
TheISA
::
PCS‹
 &
ÃwPC
,

301 cÚ¡ 
DynIn¡PŒ
 
squashIn¡
, 
Th»adID
 
tid
);

306 
squashFromDecode
(cÚ¡ 
TheISA
::
PCS‹
 &
ÃwPC
,

307 cÚ¡ 
DynIn¡PŒ
 
squashIn¡
,

308 cÚ¡ 
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
);

311 
boŞ
 
	$checkSÎ
(
Th»adID
 
tid
) const;

315 
F‘chStus
 
	`upd©eF‘chStus
();

317 
public
:

322 
	`squash
(cÚ¡ 
TheISA
::
PCS‹
 &
ÃwPC
, cÚ¡ 
In¡SeqNum
 
£q_num
,

323 
DynIn¡PŒ
 
squashIn¡
, 
Th»adID
 
tid
);

328 
	`tick
();

333 
boŞ
 
	`checkSigÇlsAndUpd©e
(
Th»adID
 
tid
);

340 
	`ãtch
(
boŞ
 &
¡©us_chªge
);

343 
Addr
 
	$ãtchBufãrAlignPC
(
Addr
 
addr
)

345  (
addr
 & ~(
ãtchBufãrMask
));

346 
	}
}

349 
	gTheISA
::
Decod”
 *
decod”
[
Im¶
::
MaxTh»ads
];

351 
	g´iv©e
:

352 
DynIn¡PŒ
 
budIn¡
(
Th»adID
 
tid
, 
SticIn¡PŒ
 
¡©icIn¡
,

353 
SticIn¡PŒ
 
curMaüoİ
, 
TheISA
::
PCS‹
 
thisPC
,

354 
TheISA
::
PCS‹
 
ÃxtPC
, 
boŞ
 
Œaû
);

357 
Th»adID
 
g‘F‘chšgTh»ad
(
F‘chPriÜ™y
 &
ãtch_´iÜ™y
);

360 
Th»adID
 
roundRobš
();

363 
Th»adID
 
iqCouÁ
();

366 
Th»adID
 
lsqCouÁ
();

370 
Th»adID
 
b¿nchCouÁ
();

373 
p–šeIÿcheAcûs£s
(
Th»adID
 
tid
);

376 
´ofeSÎ
(
Th»adID
 
tid
);

378 
	g´iv©e
:

380 
O3CPU
 *
ıu
;

383 
	gTimeBufãr
<
	gTimeSŒuù
> *
	gtimeBufãr
;

386 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomDecode
;

389 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomR’ame
;

392 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomIEW
;

395 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomComm™
;

398 
	gTimeBufãr
<
	gF‘chSŒuù
> *
	gãtchQueue
;

402 
ty³Çme
 
	gTimeBufãr
<
	gF‘chSŒuù
>::
wœe
 
toDecode
;

405 
BP»dUn™
 *
	gb¿nchP»d
;

407 
	gTheISA
::
PCS‹
 
pc
[
Im¶
::
MaxTh»ads
];

409 
Addr
 
	gãtchOff£t
[
Im¶
::
MaxTh»ads
];

411 
SticIn¡PŒ
 
	gmaüoİ
[
Im¶
::
MaxTh»ads
];

414 
boŞ
 
	gd–ayedComm™
[
Im¶
::
MaxTh»ads
];

417 
Reque¡PŒ
 
	gmemReq
[
Im¶
::
MaxTh»ads
];

422 
boŞ
 
	gwrÙeToTimeBufãr
;

425 
	gnumIn¡
;

428 
	sSÎs
 {

429 
boŞ
 
	gdecode
;

430 
boŞ
 
	g»Çme
;

431 
boŞ
 
	g›w
;

432 
boŞ
 
	gcomm™
;

433 
boŞ
 
	gd¿š
;

437 
SÎs
 
	g¡®ls
[
Im¶
::
MaxTh»ads
];

440 
Cyşes
 
	gdecodeToF‘chD–ay
;

443 
Cyşes
 
	g»ÇmeToF‘chD–ay
;

446 
Cyşes
 
	g›wToF‘chD–ay
;

449 
Cyşes
 
	gcomm™ToF‘chD–ay
;

452 
	gãtchWidth
;

455 
boŞ
 
	gÿcheBlocked
;

458 
Pack‘PŒ
 
	g»ŒyPkt
;

461 
Th»adID
 
	g»ŒyTid
;

464 
	gÿcheBlkSize
;

469 
	gãtchBufãrSize
;

472 
Addr
 
	gãtchBufãrMask
;

475 
ušt8_t
 *
	gãtchBufãr
[
Im¶
::
MaxTh»ads
];

478 
Addr
 
	gãtchBufãrPC
[
Im¶
::
MaxTh»ads
];

481 
boŞ
 
	gãtchBufãrV®id
[
Im¶
::
MaxTh»ads
];

484 
	gš¡Size
;

487 
CouÁ”
 
	gÏ¡IÿcheSÎ
[
Im¶
::
MaxTh»ads
];

490 
	g¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

493 
Th»adID
 
	gnumTh»ads
;

496 
Th»adID
 
	gnumF‘chšgTh»ads
;

499 
Th»adID
 
	gth»adF‘ched
;

504 
boŞ
 
	gš‹¼u±P’dšg
;

507 
boŞ
 
	gissueP–šedIãtch
[
Im¶
::
MaxTh»ads
];

510 
FšishT¿n¦©iÚEv’t
 
	gfšishT¿n¦©iÚEv’t
;

514 
	gSts
::
SÿÏr
 
iÿcheSÎCyşes
;

516 
	gSts
::
SÿÏr
 
ãtchedIn¡s
;

518 
	gSts
::
SÿÏr
 
ãtchedB¿nches
;

520 
	gSts
::
SÿÏr
 
´ediùedB¿nches
;

522 
	gSts
::
SÿÏr
 
ãtchCyşes
;

524 
	gSts
::
SÿÏr
 
ãtchSquashCyşes
;

526 
	gSts
::
SÿÏr
 
ãtchTlbCyşes
;

530 
	gSts
::
SÿÏr
 
ãtchIdËCyşes
;

532 
	gSts
::
SÿÏr
 
ãtchBlockedCyşes
;

534 
	gSts
::
SÿÏr
 
ãtchMiscSÎCyşes
;

536 
	gSts
::
SÿÏr
 
ãtchP’dšgD¿šCyşes
;

538 
	gSts
::
SÿÏr
 
ãtchNoAùiveTh»adSÎCyşes
;

540 
	gSts
::
SÿÏr
 
ãtchP’dšgT¿pSÎCyşes
;

542 
	gSts
::
SÿÏr
 
ãtchP’dšgQu›sûSÎCyşes
;

544 
	gSts
::
SÿÏr
 
ãtchIÿcheWa™R‘rySÎCyşes
;

546 
	gSts
::
SÿÏr
 
ãtchedCacheLšes
;

550 
	gSts
::
SÿÏr
 
ãtchIÿcheSquashes
;

554 
	gSts
::
SÿÏr
 
ãtchTlbSquashes
;

556 
	gSts
::
Di¡ributiÚ
 
ãtchNi¢Di¡
;

558 
	gSts
::
FÜmuÏ
 
idËR©e
;

560 
	gSts
::
FÜmuÏ
 
b¿nchR©e
;

562 
	gSts
::
FÜmuÏ
 
ãtchR©e
;

	@o3/fetch_impl.hh

44 #iâdeà
__CPU_O3_FETCH_IMPL_HH__


45 
	#__CPU_O3_FETCH_IMPL_HH__


	)

47 
	~<®gÜ™hm
>

48 
	~<c¡ršg
>

49 
	~<li¡
>

50 
	~<m­
>

51 
	~<queue
>

53 
	~"¬ch/i§_Œa™s.hh
"

54 
	~"¬ch/b.hh
"

55 
	~"¬ch/ut™y.hh
"

56 
	~"¬ch/vtİhys.hh
"

57 
	~"ba£/ty³s.hh
"

58 
	~"cÚfig/the_i§.hh
"

59 
	~"ıu/ba£.hh
"

61 
	~"ıu/o3/ãtch.hh
"

62 
	~"ıu/ex‘¿û.hh
"

63 
	~"debug/Aùiv™y.hh
"

64 
	~"debug/D¿š.hh
"

65 
	~"debug/F‘ch.hh
"

66 
	~"debug/O3PeV›w.hh
"

67 
	~"mem/·ck‘.hh
"

68 
	~"·¿ms/D”ivO3CPU.hh
"

69 
	~"sim/by‹sw­.hh
"

70 
	~"sim/cÜe.hh
"

71 
	~"sim/ev’tq.hh
"

72 
	~"sim/fuÎ_sy¡em.hh
"

73 
	~"sim/sy¡em.hh
"

75 
usšg
 
Çme¥aû
 
	g¡d
;

77 
	g‹m¶©e
<
şass
 
	gIm¶
>

78 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$DeçuÉF‘ch
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
)

79 : 
	`ıu
(
_ıu
),

80 
	`decodeToF‘chD–ay
(
·¿ms
->
decodeToF‘chD–ay
),

81 
	`»ÇmeToF‘chD–ay
(
·¿ms
->
»ÇmeToF‘chD–ay
),

82 
	`›wToF‘chD–ay
(
·¿ms
->
›wToF‘chD–ay
),

83 
	`comm™ToF‘chD–ay
(
·¿ms
->
comm™ToF‘chD–ay
),

84 
	`ãtchWidth
(
·¿ms
->
ãtchWidth
),

85 
	`»ŒyPkt
(
NULL
),

86 
	`»ŒyTid
(
Inv®idTh»adID
),

87 
	`ÿcheBlkSize
(
ıu
->
	`ÿcheLšeSize
()),

88 
	`ãtchBufãrSize
(
·¿ms
->
ãtchBufãrSize
),

89 
	`ãtchBufãrMask
(
ãtchBufãrSize
 - 1),

90 
	`numTh»ads
(
·¿ms
->
numTh»ads
),

91 
	`numF‘chšgTh»ads
(
·¿ms
->
smtNumF‘chšgTh»ads
),

92 
	$fšishT¿n¦©iÚEv’t
(
this
)

94 ià(
numTh»ads
 > 
Im¶
::
MaxTh»ads
)

95 
	`çl
("numThreads (%d) is†argerhan compiled†imit (%d),\n"

97 
numTh»ads
, 
¡©ic_ÿ¡
<>(
Im¶
::
MaxTh»ads
));

98 ià(
ãtchWidth
 > 
Im¶
::
MaxWidth
)

99 
	`çl
("fetchWidth (%d) is†argerhan compiled†imit (%d),\n"

101 
ãtchWidth
, 
¡©ic_ÿ¡
<>(
Im¶
::
MaxWidth
));

102 ià(
ãtchBufãrSize
 > 
ÿcheBlkSize
)

103 
	`çl
("fetch buffer size (%u bytes) is greaterhanhe cache "

104 "block siz(%u by‹s)\n", 
ãtchBufãrSize
, 
ÿcheBlkSize
);

105 ià(
ÿcheBlkSize
 % 
ãtchBufãrSize
)

106 
	`çl
("cache block (%u bytes) is‚ot‡ multiple ofhe "

107 "ãtch bufã¸(%u by‹s)\n", 
ÿcheBlkSize
, 
ãtchBufãrSize
);

109 
¡d
::
¡ršg
 
pŞicy
 = 
·¿ms
->
smtF‘chPŞicy
;

112 
¡d
::
	`ŒªsfÜm
(
pŞicy
.
	`begš
(),…Şicy.
	`’d
(),…olicy.begin(),

113 ((*)()è
tŞow”
);

116 ià(
pŞicy
 == "singlethread") {

117 
ãtchPŞicy
 = 
SšgËTh»ad
;

118 ià(
numTh»ads
 > 1)

119 
	`·nic
("Invalid Fetch Policy for‡ SMT workload.");

120 } ià(
pŞicy
 == "roundrobin") {

121 
ãtchPŞicy
 = 
RoundRobš
;

122 
	`DPRINTF
(
F‘ch
, "Fetch…olicy seto Round Robin\n");

123 } ià(
pŞicy
 == "branch") {

124 
ãtchPŞicy
 = 
B¿nch
;

125 
	`DPRINTF
(
F‘ch
, "Fetch…olicy seto Branch Count\n");

126 } ià(
pŞicy
 == "iqcount") {

127 
ãtchPŞicy
 = 
IQ
;

128 
	`DPRINTF
(
F‘ch
, "Fetch…olicy seto IQ count\n");

129 } ià(
pŞicy
 == "lsqcount") {

130 
ãtchPŞicy
 = 
LSQ
;

131 
	`DPRINTF
(
F‘ch
, "Fetch…olicy seto LSQ count\n");

133 
	`çl
("Invalid Fetch Policy. Options Are: {SingleThread,"

138 
š¡Size
 = (
TheISA
::
MachIn¡
);

140 
i
 = 0; i < 
Im¶
::
MaxTh»ads
; i++) {

141 
decod”
[
i
] = 
NULL
;

142 
ãtchBufãr
[
i
] = 
NULL
;

143 
ãtchBufãrPC
[
i
] = 0;

144 
ãtchBufãrV®id
[
i
] = 
çl£
;

147 
b¿nchP»d
 = 
·¿ms
->branchPred;

149 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

150 
decod”
[
tid
] = 
Ãw
 
TheISA
::
Decod”
;

153 
ãtchBufãr
[
tid
] = 
Ãw
 
ušt8_t
[
ãtchBufãrSize
];

155 
	}
}

157 
	g‹m¶©e
 <
şass
 
	gIm¶
>

158 
	g¡d
::
¡ršg


159 
DeçuÉF‘ch
<
Im¶
>::
	$Çme
() const

161  
ıu
->
	`Çme
() + ".fetch";

162 
	}
}

164 
	g‹m¶©e
 <
şass
 
	gIm¶
>

166 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$»gSts
()

168 
iÿcheSÎCyşes


169 .
	`Çme
(name() + ".icacheStallCycles")

170 .
	`desc
("Number of cycles fetch is stalled on‡n Icache miss")

171 .
	`´”eq
(
iÿcheSÎCyşes
);

173 
ãtchedIn¡s


174 .
	`Çme
(name() + ".Insts")

175 .
	`desc
("Number of instructions fetch has…rocessed")

176 .
	`´”eq
(
ãtchedIn¡s
);

178 
ãtchedB¿nches


179 .
	`Çme
(name() + ".Branches")

180 .
	`desc
("Number of brancheshat fetchƒncountered")

181 .
	`´”eq
(
ãtchedB¿nches
);

183 
´ediùedB¿nches


184 .
	`Çme
(name() + ".predictedBranches")

185 .
	`desc
("Number of brancheshat fetch has…redictedaken")

186 .
	`´”eq
(
´ediùedB¿nches
);

188 
ãtchCyşes


189 .
	`Çme
(name() + ".Cycles")

190 .
	`desc
("Number of cycles fetch has„un‡nd was‚ot squashing or"

192 .
	`´”eq
(
ãtchCyşes
);

194 
ãtchSquashCyşes


195 .
	`Çme
(name() + ".SquashCycles")

196 .
	`desc
("Number of cycles fetch has spent squashing")

197 .
	`´”eq
(
ãtchSquashCyşes
);

199 
ãtchTlbCyşes


200 .
	`Çme
(name() + ".TlbCycles")

201 .
	`desc
("Number of cycles fetch has spent waiting forlb")

202 .
	`´”eq
(
ãtchTlbCyşes
);

204 
ãtchIdËCyşes


205 .
	`Çme
(name() + ".IdleCycles")

206 .
	`desc
("Number of cycles fetch was idle")

207 .
	`´”eq
(
ãtchIdËCyşes
);

209 
ãtchBlockedCyşes


210 .
	`Çme
(name() + ".BlockedCycles")

211 .
	`desc
("Number of cycles fetch has spent blocked")

212 .
	`´”eq
(
ãtchBlockedCyşes
);

214 
ãtchedCacheLšes


215 .
	`Çme
(name() + ".CacheLines")

216 .
	`desc
("Number of cache†ines fetched")

217 .
	`´”eq
(
ãtchedCacheLšes
);

219 
ãtchMiscSÎCyşes


220 .
	`Çme
(name() + ".MiscStallCycles")

221 .
	`desc
("Number of cycles fetch has spent waiting on interrupts, or "

223 .
	`´”eq
(
ãtchMiscSÎCyşes
);

225 
ãtchP’dšgD¿šCyşes


226 .
	`Çme
(name() + ".PendingDrainCycles")

227 .
	`desc
("Number of cycles fetch has spent waiting on…ipeso drain")

228 .
	`´”eq
(
ãtchP’dšgD¿šCyşes
);

230 
ãtchNoAùiveTh»adSÎCyşes


231 .
	`Çme
(name() + ".NoActiveThreadStallCycles")

232 .
	`desc
("Number of stall cycles dueo‚o‡ctivehreado fetch from")

233 .
	`´”eq
(
ãtchNoAùiveTh»adSÎCyşes
);

235 
ãtchP’dšgT¿pSÎCyşes


236 .
	`Çme
(name() + ".PendingTrapStallCycles")

237 .
	`desc
("Number of stall cycles dueo…endingraps")

238 .
	`´”eq
(
ãtchP’dšgT¿pSÎCyşes
);

240 
ãtchP’dšgQu›sûSÎCyşes


241 .
	`Çme
(name() + ".PendingQuiesceStallCycles")

242 .
	`desc
("Number of stall cycles dueo…ending quiesce instructions")

243 .
	`´”eq
(
ãtchP’dšgQu›sûSÎCyşes
);

245 
ãtchIÿcheWa™R‘rySÎCyşes


246 .
	`Çme
(name() + ".IcacheWaitRetryStallCycles")

247 .
	`desc
("Number of stall cycles dueo full MSHR")

248 .
	`´”eq
(
ãtchIÿcheWa™R‘rySÎCyşes
);

250 
ãtchIÿcheSquashes


251 .
	`Çme
(name() + ".IcacheSquashes")

252 .
	`desc
("Number of outstanding Icache misseshat were squashed")

253 .
	`´”eq
(
ãtchIÿcheSquashes
);

255 
ãtchTlbSquashes


256 .
	`Çme
(name() + ".ItlbSquashes")

257 .
	`desc
("Number of outstanding ITLB misseshat were squashed")

258 .
	`´”eq
(
ãtchTlbSquashes
);

260 
ãtchNi¢Di¡


261 .
	`š™
( 0,

262  
ãtchWidth
,

264 .
	`Çme
(name() + ".rateDist")

265 .
	`desc
("Number of instructions fetchedƒach cycle (Total)")

266 .
	`æags
(
Sts
::
pdf
);

268 
idËR©e


269 .
	`Çme
(name() + ".idleRate")

270 .
	`desc
("Percent of cycles fetch was idle")

271 .
	`´”eq
(
idËR©e
);

272 
idËR©e
 = 
ãtchIdËCyşes
 * 100 / 
ıu
->
numCyşes
;

274 
b¿nchR©e


275 .
	`Çme
(name() + ".branchRate")

276 .
	`desc
("Number of branch fetches…er cycle")

277 .
	`æags
(
Sts
::
tÙ®
);

278 
b¿nchR©e
 = 
ãtchedB¿nches
 / 
ıu
->
numCyşes
;

280 
ãtchR©e


281 .
	`Çme
(name() + ".rate")

282 .
	`desc
("Number of inst fetches…er cycle")

283 .
	`æags
(
Sts
::
tÙ®
);

284 
ãtchR©e
 = 
ãtchedIn¡s
 / 
ıu
->
numCyşes
;

285 
	}
}

287 
	g‹m¶©e
<
şass
 
	gIm¶
>

289 
	gDeçuÉF‘ch
<
	gIm¶
>::
£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
time_bufãr
)

291 
timeBufãr
 = 
time_bufãr
;

294 
	gäomDecode
 = 
timeBufãr
->
g‘Wœe
(-
decodeToF‘chD–ay
);

295 
	gäomR’ame
 = 
timeBufãr
->
g‘Wœe
(-
»ÇmeToF‘chD–ay
);

296 
	gäomIEW
 = 
timeBufãr
->
g‘Wœe
(-
›wToF‘chD–ay
);

297 
	gäomComm™
 = 
timeBufãr
->
g‘Wœe
(-
comm™ToF‘chD–ay
);

300 
	g‹m¶©e
<
şass
 
	gIm¶
>

302 
	gDeçuÉF‘ch
<
	gIm¶
>::
£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
)

304 
aùiveTh»ads
 = 
©_±r
;

307 
	g‹m¶©e
<
şass
 
	gIm¶
>

309 
	gDeçuÉF‘ch
<
	gIm¶
>::
£tF‘chQueue
(
TimeBufãr
<
F‘chSŒuù
> *
fq_±r
)

311 
ãtchQueue
 = 
fq_±r
;

314 
	gtoDecode
 = 
ãtchQueue
->
g‘Wœe
(0);

317 
	g‹m¶©e
<
şass
 
	gIm¶
>

319 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$¡¬tupSge
()

321 
	`as£¹
(
´iÜ™yLi¡
.
	`em±y
());

322 
	`»£tSge
();

326 
	`sw™chToAùive
();

327 
	}
}

329 
	g‹m¶©e
<
şass
 
	gIm¶
>

331 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$»£tSge
()

333 
numIn¡
 = 0;

334 
š‹¼u±P’dšg
 = 
çl£
;

335 
ÿcheBlocked
 = 
çl£
;

337 
´iÜ™yLi¡
.
	`ş—r
();

340 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

341 
ãtchStus
[
tid
] = 
RuÂšg
;

342 
pc
[
tid
] = 
ıu
->
	`pcS‹
(tid);

343 
ãtchOff£t
[
tid
] = 0;

344 
maüoİ
[
tid
] = 
NULL
;

346 
d–ayedComm™
[
tid
] = 
çl£
;

347 
memReq
[
tid
] = 
NULL
;

349 
¡®ls
[
tid
].
decode
 = 
çl£
;

350 
¡®ls
[
tid
].
»Çme
 = 
çl£
;

351 
¡®ls
[
tid
].
›w
 = 
çl£
;

352 
¡®ls
[
tid
].
comm™
 = 
çl£
;

353 
¡®ls
[
tid
].
d¿š
 = 
çl£
;

355 
ãtchBufãrPC
[
tid
] = 0;

356 
ãtchBufãrV®id
[
tid
] = 
çl£
;

358 
´iÜ™yLi¡
.
	`push_back
(
tid
);

361 
wrÙeToTimeBufãr
 = 
çl£
;

362 
_¡©us
 = 
IÇùive
;

363 
	}
}

365 
	g‹m¶©e
<
şass
 
	gIm¶
>

367 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$´oûssCacheCom¶‘iÚ
(
Pack‘PŒ
 
pkt
)

369 
Th»adID
 
tid
 = 
pkt
->
»q
->
	`th»adId
();

371 
	`DPRINTF
(
F‘ch
, "[tid:%u] Wakšg u°äom cachmiss.\n", 
tid
);

372 
	`as£¹
(!
ıu
->
	`sw™chedOut
());

376 ià(
ãtchStus
[
tid
] !ğ
IÿcheWa™Re¥Ú£
 ||

377 
pkt
->
»q
 !ğ
memReq
[
tid
]) {

378 ++
ãtchIÿcheSquashes
;

379 
d–‘e
 
pkt
->
»q
;

380 
d–‘e
 
pkt
;

384 
	`memıy
(
ãtchBufãr
[
tid
], 
pkt
->
g‘PŒ
<
ušt8_t
>(), 
ãtchBufãrSize
);

385 
ãtchBufãrV®id
[
tid
] = 
Œue
;

389 
ıu
->
	`wakeCPU
();

391 
	`DPRINTF
(
Aùiv™y
, "[tid:%u] Activating fetch dueo cache completion\n",

392 
tid
);

394 
	`sw™chToAùive
();

397 ià(
	`checkSÎ
(
tid
)) {

398 
ãtchStus
[
tid
] = 
Blocked
;

400 
ãtchStus
[
tid
] = 
IÿcheAcûssCom¶‘e
;

404 
d–‘e
 
pkt
->
»q
;

405 
d–‘e
 
pkt
;

406 
memReq
[
tid
] = 
NULL
;

407 
	}
}

409 
	g‹m¶©e
 <
şass
 
	gIm¶
>

411 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$d¿šResume
()

413 
Th»adID
 
i
 = 0; i < 
Im¶
::
MaxTh»ads
; ++i)

414 
¡®ls
[
i
].
d¿š
 = 
çl£
;

415 
	}
}

417 
	g‹m¶©e
 <
şass
 
	gIm¶
>

419 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

421 
	`as£¹
(
	`isD¿šed
());

422 
	`as£¹
(
»ŒyPkt
 =ğ
NULL
);

423 
	`as£¹
(
»ŒyTid
 =ğ
Inv®idTh»adID
);

424 
	`as£¹
(
ÿcheBlocked
 =ğ
çl£
);

425 
	`as£¹
(
š‹¼u±P’dšg
 =ğ
çl£
);

427 
Th»adID
 
i
 = 0; i < 
numTh»ads
; ++i) {

428 
	`as£¹
(!
memReq
[
i
]);

429 
	`as£¹
(!
¡®ls
[
i
].
decode
);

430 
	`as£¹
(!
¡®ls
[
i
].
»Çme
);

431 
	`as£¹
(!
¡®ls
[
i
].
›w
);

432 
	`as£¹
(!
¡®ls
[
i
].
comm™
);

433 
	`as£¹
(
ãtchStus
[
i
] =ğ
IdË
 || 
¡®ls
[i].
d¿š
);

436 
b¿nchP»d
->
	`d¿šSª™yCheck
();

437 
	}
}

439 
	g‹m¶©e
 <
şass
 
	gIm¶
>

440 
boŞ


441 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$isD¿šed
() const

449 
Th»adID
 
i
 = 0; i < 
numTh»ads
; ++i) {

450 ià(!(
ãtchStus
[
i
] =ğ
IdË
 ||

451 (
ãtchStus
[
i
] =ğ
Blocked
 && 
¡®ls
[i].
d¿š
)))

452  
çl£
;

459  !
fšishT¿n¦©iÚEv’t
.
	`scheduËd
();

460 
	}
}

462 
	g‹m¶©e
 <
şass
 
	gIm¶
>

464 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$keOv”From
()

466 
	`as£¹
(
ıu
->
	`g‘In¡PÜt
().
	`isCÚÃùed
());

467 
	`»£tSge
();

469 
	}
}

471 
	g‹m¶©e
 <
şass
 
	gIm¶
>

473 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$d¿šSÎ
(
Th»adID
 
tid
)

475 
	`as£¹
(
ıu
->
	`isD¿ššg
());

476 
	`as£¹
(!
¡®ls
[
tid
].
d¿š
);

477 
	`DPRINTF
(
D¿š
, "%i: Th»ad d¿šed.\n", 
tid
);

478 
¡®ls
[
tid
].
d¿š
 = 
Œue
;

479 
	}
}

481 
	g‹m¶©e
 <
şass
 
	gIm¶
>

483 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$wakeFromQu›sû
()

485 
	`DPRINTF
(
F‘ch
, "Waking up from quiesce\n");

488 
ãtchStus
[0] = 
RuÂšg
;

489 
	}
}

491 
	g‹m¶©e
 <
şass
 
	gIm¶
>

492 
šlše
 

493 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$sw™chToAùive
()

495 ià(
_¡©us
 =ğ
IÇùive
) {

496 
	`DPRINTF
(
Aùiv™y
, "Activating stage.\n");

498 
ıu
->
	`aùiv©eSge
(
O3CPU
::
F‘chIdx
);

500 
_¡©us
 = 
Aùive
;

502 
	}
}

504 
	g‹m¶©e
 <
şass
 
	gIm¶
>

505 
šlše
 

506 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$sw™chToIÇùive
()

508 ià(
_¡©us
 =ğ
Aùive
) {

509 
	`DPRINTF
(
Aùiv™y
, "Deactivating stage.\n");

511 
ıu
->
	`d—ùiv©eSge
(
O3CPU
::
F‘chIdx
);

513 
_¡©us
 = 
IÇùive
;

515 
	}
}

517 
	g‹m¶©e
 <
şass
 
	gIm¶
>

518 
boŞ


519 
	gDeçuÉF‘ch
<
	gIm¶
>::
lookupAndUpd©eNextPC
(

520 
DynIn¡PŒ
 &
š¡
, 
TheISA
::
PCS‹
 &
ÃxtPC
)

525 
boŞ
 
´ediù_k’
;

527 ià(!
	gš¡
->
isCÚŒŞ
()) {

528 
	gTheISA
::
advªûPC
(
ÃxtPC
, 
š¡
->
¡©icIn¡
);

529 
	gš¡
->
£tP»dT¬g
(
ÃxtPC
);

530 
	gš¡
->
£tP»dTak’
(
çl£
);

531  
	gçl£
;

534 
Th»adID
 
	gtid
 = 
š¡
->
th»adNumb”
;

535 
	g´ediù_k’
 = 
b¿nchP»d
->
´ediù
(
š¡
->
¡©icIn¡
, in¡->
£qNum
,

536 
ÃxtPC
, 
tid
);

538 ià(
	g´ediù_k’
) {

539 
DPRINTF
(
F‘ch
, "[tid:%i]: [sn:%i]: Branch…redictedo beakeno %s.\n",

540 
tid
, 
š¡
->
£qNum
, 
ÃxtPC
);

542 
DPRINTF
(
F‘ch
, "[tid:%i]: [sn:%i]:Branch…redictedo be‚otaken.\n",

543 
tid
, 
š¡
->
£qNum
);

546 
DPRINTF
(
F‘ch
, "[tid:%i]: [sn:%i] Branch…redictedo goo %s.\n",

547 
tid
, 
š¡
->
£qNum
, 
ÃxtPC
);

548 
	gš¡
->
£tP»dT¬g
(
ÃxtPC
);

549 
	gš¡
->
£tP»dTak’
(
´ediù_k’
);

551 ++
	gãtchedB¿nches
;

553 ià(
	g´ediù_k’
) {

554 ++
	g´ediùedB¿nches
;

557  
	g´ediù_k’
;

560 
	g‹m¶©e
 <
şass
 
	gIm¶
>

561 
boŞ


562 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$ãtchCacheLše
(
Addr
 
vaddr
, 
Th»adID
 
tid
, Add¸
pc
)

564 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

566 
	`as£¹
(!
ıu
->
	`sw™chedOut
());

570 ià(
ÿcheBlocked
) {

571 
	`DPRINTF
(
F‘ch
, "[tid:%i] Can't fetch cache†ine, cache blocked\n",

572 
tid
);

573  
çl£
;

574 } ià(
	`checkIÁ”ru±
(
pc
è&& !
d–ayedComm™
[
tid
]) {

579 
	`DPRINTF
(
F‘ch
, "[tid:%i] Can't fetch cache†ine, interrupt…ending\n",

580 
tid
);

581  
çl£
;

585 
Addr
 
ãtchBufãrBlockPC
 = 
	`ãtchBufãrAlignPC
(
vaddr
);

587 
	`DPRINTF
(
F‘ch
, "[tid:%i] Fetching cache†ine %#x for‡ddr %#x\n",

588 
tid
, 
ãtchBufãrBlockPC
, 
vaddr
);

593 
Reque¡PŒ
 
mem_»q
 =

594 
Ãw
 
	`Reque¡
(
tid
, 
ãtchBufãrBlockPC
, 
ãtchBufãrSize
,

595 
Reque¡
::
INST_FETCH
, 
ıu
->
	`š¡Ma¡”Id
(), 
pc
,

596 
ıu
->
th»ad
[
tid
]->
	`cÚ‹xtId
(),id);

598 
memReq
[
tid
] = 
mem_»q
;

601 
ãtchStus
[
tid
] = 
IbWa™
;

602 
F‘chT¿n¦©iÚ
 *
Œªs
 = 
Ãw
 
	`F‘chT¿n¦©iÚ
(
this
);

603 
ıu
->
™b
->
	`Œª¦©eTimšg
(
mem_»q
, cpu->
th»ad
[
tid
]->
	`g‘TC
(),

604 
Œªs
, 
Ba£TLB
::
Execu‹
);

605  
Œue
;

606 
	}
}

608 
	g‹m¶©e
 <
şass
 
	gIm¶
>

610 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$fšishT¿n¦©iÚ
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
mem_»q
)

612 
Th»adID
 
tid
 = 
mem_»q
->
	`th»adId
();

613 
Addr
 
ãtchBufãrBlockPC
 = 
mem_»q
->
	`g‘Vaddr
();

615 
	`as£¹
(!
ıu
->
	`sw™chedOut
());

618 
ıu
->
	`wakeCPU
();

620 ià(
ãtchStus
[
tid
] !ğ
IbWa™
 || 
mem_»q
 !ğ
memReq
[tid] ||

621 
mem_»q
->
	`g‘Vaddr
(è!ğ
memReq
[
tid
]->getVaddr()) {

622 
	`DPRINTF
(
F‘ch
, "[tid:%i] Ignoring itlb completed‡fter squash\n",

623 
tid
);

624 ++
ãtchTlbSquashes
;

625 
d–‘e
 
mem_»q
;

631 ià(
çuÉ
 =ğ
NoFauÉ
) {

635 ià(!
ıu
->
sy¡em
->
	`isMemAddr
(
mem_»q
->
	`g‘Paddr
())) {

636 
	`w¬n
("Address %#x is outside of…hysical memory, stopping fetch\n",

637 
mem_»q
->
	`g‘Paddr
());

638 
ãtchStus
[
tid
] = 
NoGoodAddr
;

639 
d–‘e
 
mem_»q
;

640 
memReq
[
tid
] = 
NULL
;

645 
Pack‘PŒ
 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
mem_»q
, 
MemCmd
::
R—dReq
);

646 
d©a_pkt
->
	`d©aDyÇmicA¼ay
(
Ãw
 
ušt8_t
[
ãtchBufãrSize
]);

648 
ãtchBufãrPC
[
tid
] = 
ãtchBufãrBlockPC
;

649 
ãtchBufãrV®id
[
tid
] = 
çl£
;

650 
	`DPRINTF
(
F‘ch
, "Fetch: Doing instruction„ead.\n");

652 
ãtchedCacheLšes
++;

655 ià(!
ıu
->
	`g‘In¡PÜt
().
	`£ndTimšgReq
(
d©a_pkt
)) {

656 
	`as£¹
(
»ŒyPkt
 =ğ
NULL
);

657 
	`as£¹
(
»ŒyTid
 =ğ
Inv®idTh»adID
);

658 
	`DPRINTF
(
F‘ch
, "[tid:%i] OuˆoàMSHRs!\n", 
tid
);

660 
ãtchStus
[
tid
] = 
IÿcheWa™R‘ry
;

661 
»ŒyPkt
 = 
d©a_pkt
;

662 
»ŒyTid
 = 
tid
;

663 
ÿcheBlocked
 = 
Œue
;

665 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Došg Iÿchacûss.\n", 
tid
);

666 
	`DPRINTF
(
Aùiv™y
, "[tid:%i]: Activity: Waiting on I-cache "

667 "»¥Ú£.\n", 
tid
);

669 
Ï¡IÿcheSÎ
[
tid
] = 
	`curTick
();

670 
ãtchStus
[
tid
] = 
IÿcheWa™Re¥Ú£
;

673 ià(!(
numIn¡
 < 
ãtchWidth
)) {

674 
	`as£¹
(!
fšishT¿n¦©iÚEv’t
.
	`scheduËd
());

675 
fšishT¿n¦©iÚEv’t
.
	`£tFauÉ
(
çuÉ
);

676 
fšishT¿n¦©iÚEv’t
.
	`£tReq
(
mem_»q
);

677 
ıu
->
	`scheduË
(
fšishT¿n¦©iÚEv’t
,

678 
ıu
->
	`şockEdge
(
	`Cyşes
(1)));

681 
	`DPRINTF
(
F‘ch
, "[tid:%i] Got back„eq with‡ddr %#x butƒxpected %#x\n",

682 
tid
, 
mem_»q
->
	`g‘Vaddr
(), 
memReq
[tid]->getVaddr());

684 
d–‘e
 
mem_»q
;

685 
memReq
[
tid
] = 
NULL
;

690 
TheISA
::
PCS‹
 
ãtchPC
 = 
pc
[
tid
];

692 
	`DPRINTF
(
F‘ch
, "[tid:%i]: T¿n¦©iÚ fauÉed, budšg‚oİ.\n", 
tid
);

694 
DynIn¡PŒ
 
š¡ruùiÚ
 = 
	`budIn¡
(
tid
,

695 
decod”
[
tid
]->
	`decode
(
TheISA
::
NoİMachIn¡
, 
ãtchPC
.
	`š¡Addr
()),

696 
NULL
, 
ãtchPC
, f‘chPC, 
çl£
);

698 
š¡ruùiÚ
->
	`£tP»dT¬g
(
ãtchPC
);

699 
š¡ruùiÚ
->
çuÉ
 = fault;

700 
wrÙeToTimeBufãr
 = 
Œue
;

702 
	`DPRINTF
(
Aùiv™y
, "Activityhis cycle.\n");

703 
ıu
->
	`aùiv™yThisCyşe
();

705 
ãtchStus
[
tid
] = 
T¿pP’dšg
;

707 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Blocked,‚“dØhªdËhŒ­.\n", 
tid
);

708 
	`DPRINTF
(
F‘ch
, "[tid:%i]: fault (%s) detected @ PC %s.\n",

709 
tid
, 
çuÉ
->
	`Çme
(), 
pc
[tid]);

711 
_¡©us
 = 
	`upd©eF‘chStus
();

712 
	}
}

714 
	g‹m¶©e
 <
şass
 
	gIm¶
>

715 
šlše
 

716 
	gDeçuÉF‘ch
<
	gIm¶
>::
doSquash
(cÚ¡ 
TheISA
::
PCS‹
 &
ÃwPC
,

717 cÚ¡ 
DynIn¡PŒ
 
squashIn¡
, 
Th»adID
 
tid
)

719 
DPRINTF
(
F‘ch
, "[tid:%i]: Squashing, setting PCo: %s.\n",

720 
tid
, 
ÃwPC
);

722 
	gpc
[
tid
] = 
ÃwPC
;

723 
	gãtchOff£t
[
tid
] = 0;

724 ià(
	gsquashIn¡
 && squashIn¡->
pcS‹
().
š¡Addr
(è=ğ
ÃwPC
.instAddr())

725 
maüoİ
[
tid
] = 
squashIn¡
->macroop;

727 
	gmaüoİ
[
tid
] = 
NULL
;

728 
	gdecod”
[
tid
]->
»£t
();

731 ià(
	gãtchStus
[
tid
] =ğ
IÿcheWa™Re¥Ú£
) {

732 
DPRINTF
(
F‘ch
, "[tid:%i]: Squashing outstanding Icache miss.\n",

733 
tid
);

734 
	gmemReq
[
tid
] = 
NULL
;

735 } ià(
	gãtchStus
[
tid
] =ğ
IbWa™
) {

736 
DPRINTF
(
F‘ch
, "[tid:%i]: Squashing outstanding ITLB miss.\n",

737 
tid
);

738 
	gmemReq
[
tid
] = 
NULL
;

742 ià(
	g»ŒyTid
 =ğ
tid
) {

743 
as£¹
(
ÿcheBlocked
);

744 ià(
	g»ŒyPkt
) {

745 
d–‘e
 
	g»ŒyPkt
->
	g»q
;

746 
d–‘e
 
	g»ŒyPkt
;

748 
	g»ŒyPkt
 = 
NULL
;

749 
	g»ŒyTid
 = 
Inv®idTh»adID
;

752 
	gãtchStus
[
tid
] = 
Squashšg
;

759 
	gd–ayedComm™
[
tid
] = 
Œue
;

761 ++
	gãtchSquashCyşes
;

764 
	g‹m¶©e
<
şass
 
	gIm¶
>

766 
	gDeçuÉF‘ch
<
	gIm¶
>::
squashFromDecode
(cÚ¡ 
TheISA
::
PCS‹
 &
ÃwPC
,

767 cÚ¡ 
DynIn¡PŒ
 
squashIn¡
,

768 cÚ¡ 
In¡SeqNum
 
£q_num
, 
Th»adID
 
tid
)

770 
DPRINTF
(
F‘ch
, "[tid:%i]: Squashšg from decode.\n", 
tid
);

772 
doSquash
(
ÃwPC
, 
squashIn¡
, 
tid
);

776 
	gıu
->
»moveIn¡sUÁ
(
£q_num
, 
tid
);

779 
	g‹m¶©e
<
şass
 
	gIm¶
>

780 
boŞ


781 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$checkSÎ
(
Th»adID
 
tid
) const

783 
boŞ
 
»t_v®
 = 
çl£
;

785 ià(
ıu
->
cÚ‹xtSw™ch
) {

786 
	`DPRINTF
(
F‘ch
,"[tid:%i]: SÎšg fÜ‡ cÚ‹xˆsw™ch.\n",
tid
);

787 
»t_v®
 = 
Œue
;

788 } ià(
¡®ls
[
tid
].
d¿š
) {

789 
	`as£¹
(
ıu
->
	`isD¿ššg
());

790 
	`DPRINTF
(
F‘ch
,"[tid:%i]: D¿š sÎ d‘eùed.\n",
tid
);

791 
»t_v®
 = 
Œue
;

792 } ià(
¡®ls
[
tid
].
decode
) {

793 
	`DPRINTF
(
F‘ch
,"[tid:%i]: SÎ from Decod¡agd‘eùed.\n",
tid
);

794 
»t_v®
 = 
Œue
;

795 } ià(
¡®ls
[
tid
].
»Çme
) {

796 
	`DPRINTF
(
F‘ch
,"[tid:%i]: SÎ from R’am¡agd‘eùed.\n",
tid
);

797 
»t_v®
 = 
Œue
;

798 } ià(
¡®ls
[
tid
].
›w
) {

799 
	`DPRINTF
(
F‘ch
,"[tid:%i]: SÎ from IEW sgd‘eùed.\n",
tid
);

800 
»t_v®
 = 
Œue
;

801 } ià(
¡®ls
[
tid
].
comm™
) {

802 
	`DPRINTF
(
F‘ch
,"[tid:%i]: SÎ from Comm™ sgd‘eùed.\n",
tid
);

803 
»t_v®
 = 
Œue
;

806  
»t_v®
;

807 
	}
}

809 
	g‹m¶©e
<
şass
 
	gIm¶
>

810 
ty³Çme
 
	gDeçuÉF‘ch
<
	gIm¶
>::
F‘chStus


811 
DeçuÉF‘ch
<
Im¶
>::
	$upd©eF‘chStus
()

814 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

815 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

817 
th»ads
 !ğ
’d
) {

818 
Th»adID
 
tid
 = *
th»ads
++;

820 ià(
ãtchStus
[
tid
] =ğ
RuÂšg
 ||

821 
ãtchStus
[
tid
] =ğ
Squashšg
 ||

822 
ãtchStus
[
tid
] =ğ
IÿcheAcûssCom¶‘e
) {

824 ià(
_¡©us
 =ğ
IÇùive
) {

825 
	`DPRINTF
(
Aùiv™y
, "[tid:%i]: Aùiv©šg sge.\n",
tid
);

827 ià(
ãtchStus
[
tid
] =ğ
IÿcheAcûssCom¶‘e
) {

828 
	`DPRINTF
(
Aùiv™y
, "[tid:%i]: Activating fetch dueo cache"

829 "com¶‘iÚ\n",
tid
);

832 
ıu
->
	`aùiv©eSge
(
O3CPU
::
F‘chIdx
);

835  
Aùive
;

840 ià(
_¡©us
 =ğ
Aùive
) {

841 
	`DPRINTF
(
Aùiv™y
, "Deactivating stage.\n");

843 
ıu
->
	`d—ùiv©eSge
(
O3CPU
::
F‘chIdx
);

846  
IÇùive
;

847 
	}
}

849 
	g‹m¶©e
 <
şass
 
	gIm¶
>

851 
	gDeçuÉF‘ch
<
	gIm¶
>::
squash
(cÚ¡ 
TheISA
::
PCS‹
 &
ÃwPC
,

852 cÚ¡ 
In¡SeqNum
 
£q_num
, 
DynIn¡PŒ
 
squashIn¡
,

853 
Th»adID
 
tid
)

855 
DPRINTF
(
F‘ch
, "[tid:%u]: Squash from comm™.\n", 
tid
);

857 
doSquash
(
ÃwPC
, 
squashIn¡
, 
tid
);

860 
	gıu
->
»moveIn¡sNÙInROB
(
tid
);

863 
	g‹m¶©e
 <
şass
 
	gIm¶
>

865 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$tick
()

867 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

868 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

869 
boŞ
 
¡©us_chªge
 = 
çl£
;

871 
wrÙeToTimeBufãr
 = 
çl£
;

873 
Th»adID
 
i
 = 0; i < 
Im¶
::
MaxTh»ads
; ++i) {

874 
issueP–šedIãtch
[
i
] = 
çl£
;

877 
th»ads
 !ğ
’d
) {

878 
Th»adID
 
tid
 = *
th»ads
++;

882 
boŞ
 
upd©ed_¡©us
 = 
	`checkSigÇlsAndUpd©e
(
tid
);

883 
¡©us_chªge
 = stus_chªg|| 
upd©ed_¡©us
;

886 
	`DPRINTF
(
F‘ch
, "Running stage.\n");

888 ià(
FuÎSy¡em
) {

889 ià(
äomComm™
->
comm™Info
[0].
š‹¼u±P’dšg
) {

890 
š‹¼u±P’dšg
 = 
Œue
;

893 ià(
äomComm™
->
comm™Info
[0].
ş—rIÁ”ru±
) {

894 
š‹¼u±P’dšg
 = 
çl£
;

898 
th»adF‘ched
 = 0;h»adF‘ched < 
numF‘chšgTh»ads
;

899 
th»adF‘ched
++) {

901 
	`ãtch
(
¡©us_chªge
);

905 
ãtchNi¢Di¡
.
	`§m¶e
(
numIn¡
);

907 ià(
¡©us_chªge
) {

909 
_¡©us
 = 
	`upd©eF‘chStus
();

913 ià(
wrÙeToTimeBufãr
 || 
ıu
->
cÚ‹xtSw™ch
) {

914 
	`DPRINTF
(
Aùiv™y
, "Activityhis cycle.\n");

916 
ıu
->
	`aùiv™yThisCyşe
();

920 
Th»adID
 
i
 = 0; i < 
Im¶
::
MaxTh»ads
; ++i) {

921 ià(
issueP–šedIãtch
[
i
]) {

922 
	`p–šeIÿcheAcûs£s
(
i
);

927 
numIn¡
 = 0;

928 
	}
}

930 
	g‹m¶©e
 <
şass
 
	gIm¶
>

931 
boŞ


932 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$checkSigÇlsAndUpd©e
(
Th»adID
 
tid
)

935 ià(
äomDecode
->
decodeBlock
[
tid
]) {

936 
¡®ls
[
tid
].
decode
 = 
Œue
;

939 ià(
äomDecode
->
decodeUnblock
[
tid
]) {

940 
	`as£¹
(
¡®ls
[
tid
].
decode
);

941 
	`as£¹
(!
äomDecode
->
decodeBlock
[
tid
]);

942 
¡®ls
[
tid
].
decode
 = 
çl£
;

945 ià(
äomR’ame
->
»ÇmeBlock
[
tid
]) {

946 
¡®ls
[
tid
].
»Çme
 = 
Œue
;

949 ià(
äomR’ame
->
»ÇmeUnblock
[
tid
]) {

950 
	`as£¹
(
¡®ls
[
tid
].
»Çme
);

951 
	`as£¹
(!
äomR’ame
->
»ÇmeBlock
[
tid
]);

952 
¡®ls
[
tid
].
»Çme
 = 
çl£
;

955 ià(
äomIEW
->
›wBlock
[
tid
]) {

956 
¡®ls
[
tid
].
›w
 = 
Œue
;

959 ià(
äomIEW
->
›wUnblock
[
tid
]) {

960 
	`as£¹
(
¡®ls
[
tid
].
›w
);

961 
	`as£¹
(!
äomIEW
->
›wBlock
[
tid
]);

962 
¡®ls
[
tid
].
›w
 = 
çl£
;

965 ià(
äomComm™
->
comm™Block
[
tid
]) {

966 
¡®ls
[
tid
].
comm™
 = 
Œue
;

969 ià(
äomComm™
->
comm™Unblock
[
tid
]) {

970 
	`as£¹
(
¡®ls
[
tid
].
comm™
);

971 
	`as£¹
(!
äomComm™
->
comm™Block
[
tid
]);

972 
¡®ls
[
tid
].
comm™
 = 
çl£
;

976 ià(
äomComm™
->
comm™Info
[
tid
].
squash
) {

978 
	`DPRINTF
(
F‘ch
, "[tid:%u]: Squashing instructions dueo squash "

979 "äom comm™.\n",
tid
);

981 
	`squash
(
äomComm™
->
comm™Info
[
tid
].
pc
,

982 
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,

983 
äomComm™
->
comm™Info
[
tid
].
squashIn¡
,id);

988 ià(
äomComm™
->
comm™Info
[
tid
].
mi¥»diùIn¡
 &&

989 
äomComm™
->
comm™Info
[
tid
].
mi¥»diùIn¡
->
	`isCÚŒŞ
()) {

990 
b¿nchP»d
->
	`squash
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,

991 
äomComm™
->
comm™Info
[
tid
].
pc
,

992 
äomComm™
->
comm™Info
[
tid
].
b¿nchTak’
,

993 
tid
);

995 
b¿nchP»d
->
	`squash
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,

996 
tid
);

999  
Œue
;

1000 } ià(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
) {

1003 
b¿nchP»d
->
	`upd©e
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,id);

1007 ià(
äomComm™
->
comm™Info
[
tid
].
robSquashšg
) {

1008 
	`DPRINTF
(
F‘ch
, "[tid:%u]: ROB i ¡Èsquashšg.\n", 
tid
);

1011 
ãtchStus
[
tid
] = 
Squashšg
;

1013  
Œue
;

1017 ià(
äomDecode
->
decodeInfo
[
tid
].
squash
) {

1018 
	`DPRINTF
(
F‘ch
, "[tid:%u]: Squashing instructions dueo squash "

1019 "äom decode.\n",
tid
);

1022 ià(
äomDecode
->
decodeInfo
[
tid
].
b¿nchMi¥»diù
) {

1023 
b¿nchP»d
->
	`squash
(
äomDecode
->
decodeInfo
[
tid
].
dÚeSeqNum
,

1024 
äomDecode
->
decodeInfo
[
tid
].
ÃxtPC
,

1025 
äomDecode
->
decodeInfo
[
tid
].
b¿nchTak’
,

1026 
tid
);

1028 
b¿nchP»d
->
	`squash
(
äomDecode
->
decodeInfo
[
tid
].
dÚeSeqNum
,

1029 
tid
);

1032 ià(
ãtchStus
[
tid
] !ğ
Squashšg
) {

1034 
	`DPRINTF
(
F‘ch
, "Squashing from decode with PC = %s\n",

1035 
äomDecode
->
decodeInfo
[
tid
].
ÃxtPC
);

1037 
	`squashFromDecode
(
äomDecode
->
decodeInfo
[
tid
].
ÃxtPC
,

1038 
äomDecode
->
decodeInfo
[
tid
].
squashIn¡
,

1039 
äomDecode
->
decodeInfo
[
tid
].
dÚeSeqNum
,

1040 
tid
);

1042  
Œue
;

1046 ià(
	`checkSÎ
(
tid
) &&

1047 
ãtchStus
[
tid
] !ğ
IÿcheWa™Re¥Ú£
 &&

1048 
ãtchStus
[
tid
] !ğ
IÿcheWa™R‘ry
 &&

1049 
ãtchStus
[
tid
] !ğ
IbWa™
 &&

1050 
ãtchStus
[
tid
] !ğ
Qu›sûP’dšg
) {

1051 
	`DPRINTF
(
F‘ch
, "[tid:%i]: S‘tšgØblocked\n",
tid
);

1053 
ãtchStus
[
tid
] = 
Blocked
;

1055  
Œue
;

1058 ià(
ãtchStus
[
tid
] =ğ
Blocked
 ||

1059 
ãtchStus
[
tid
] =ğ
Squashšg
) {

1062 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Done squashing, switchingo„unning.\n",

1063 
tid
);

1065 
ãtchStus
[
tid
] = 
RuÂšg
;

1067  
Œue
;

1072  
çl£
;

1073 
	}
}

1075 
	g‹m¶©e
<
şass
 
	gIm¶
>

1076 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


1077 
DeçuÉF‘ch
<
Im¶
>::
budIn¡
(
Th»adID
 
tid
, 
SticIn¡PŒ
 
¡©icIn¡
,

1078 
SticIn¡PŒ
 
curMaüoİ
, 
TheISA
::
PCS‹
 
thisPC
,

1079 
TheISA
::
PCS‹
 
ÃxtPC
, 
boŞ
 
Œaû
)

1082 
In¡SeqNum
 
	g£q
 = 
ıu
->
g‘AndInüem’tIn¡Seq
();

1085 
DynIn¡PŒ
 
	gš¡ruùiÚ
 =

1086 
Ãw
 
DynIn¡
(
¡©icIn¡
, 
curMaüoİ
, 
thisPC
, 
ÃxtPC
, 
£q
, 
ıu
);

1087 
	gš¡ruùiÚ
->
£tTid
(
tid
);

1089 
	gš¡ruùiÚ
->
£tASID
(
tid
);

1091 
	gš¡ruùiÚ
->
£tTh»adS‹
(
ıu
->
th»ad
[
tid
]);

1093 
DPRINTF
(
F‘ch
, "[tid:%i]: Instruction PC %#x (%d) created "

1094 "[¢:%Îi].\n", 
tid
, 
thisPC
.
š¡Addr
(),

1095 
thisPC
.
miüoPC
(), 
£q
);

1097 
DPRINTF
(
F‘ch
, "[tid:%i]: In¡ruùiÚ is: %s\n", 
tid
,

1098 
š¡ruùiÚ
->
¡©icIn¡
->

1099 
di§s£mbË
(
thisPC
.
š¡Addr
()));

1101 #ià
TRACING_ON


1102 ià(
	gŒaû
) {

1103 
	gš¡ruùiÚ
->
	gŒaûD©a
 =

1104 
ıu
->
g‘T¿ûr
()->
g‘In¡RecÜd
(
curTick
(), cpu->
tcBa£
(
tid
),

1105 
š¡ruùiÚ
->
¡©icIn¡
, 
thisPC
, 
curMaüoİ
);

1108 
	gš¡ruùiÚ
->
	gŒaûD©a
 = 
NULL
;

1112 
	gš¡ruùiÚ
->
£tIn¡Li¡It
(
ıu
->
addIn¡
(
š¡ruùiÚ
));

1116 
as£¹
(
numIn¡
 < 
ãtchWidth
);

1117 
	gtoDecode
->
	gš¡s
[
toDecode
->
size
++] = 
š¡ruùiÚ
;

1120 
	gd–ayedComm™
[
tid
] = 
š¡ruùiÚ
->
isD–ayedComm™
();

1122  
	gš¡ruùiÚ
;

1125 
	g‹m¶©e
<
şass
 
	gIm¶
>

1127 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$ãtch
(
boŞ
 &
¡©us_chªge
)

1132 
Th»adID
 
tid
 = 
	`g‘F‘chšgTh»ad
(
ãtchPŞicy
);

1134 
	`as£¹
(!
ıu
->
	`sw™chedOut
());

1136 ià(
tid
 =ğ
Inv®idTh»adID
) {

1138 
th»adF‘ched
 = 
numF‘chšgTh»ads
;

1140 ià(
numTh»ads
 == 1) {

1141 
	`´ofeSÎ
(0);

1147 
	`DPRINTF
(
F‘ch
, "A‰em±šgØãtch from [tid:%i]\n", 
tid
);

1150 
TheISA
::
PCS‹
 
thisPC
 = 
pc
[
tid
];

1152 
Addr
 
pcOff£t
 = 
ãtchOff£t
[
tid
];

1153 
Addr
 
ãtchAddr
 = (
thisPC
.
	`š¡Addr
(è+ 
pcOff£t
è& 
Ba£CPU
::
PCMask
;

1155 
boŞ
 
šRom
 = 
	`isRomMiüoPC
(
thisPC
.
	`miüoPC
());

1160 ià(
ãtchStus
[
tid
] =ğ
IÿcheAcûssCom¶‘e
) {

1161 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Iÿchmis i com¶‘e.\n", 
tid
);

1163 
ãtchStus
[
tid
] = 
RuÂšg
;

1164 
¡©us_chªge
 = 
Œue
;

1165 } ià(
ãtchStus
[
tid
] =ğ
RuÂšg
) {

1167 
Addr
 
ãtchBufãrBlockPC
 = 
	`ãtchBufãrAlignPC
(
ãtchAddr
);

1172 ià(!(
ãtchBufãrV®id
[
tid
] && 
ãtchBufãrBlockPC
 =ğ
ãtchBufãrPC
[tid])

1173 && !
šRom
 && !
maüoİ
[
tid
]) {

1174 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Attemptingoranslate‡nd„ead "

1175 "š¡ruùiÚ, s¹šg‡ˆPC %s.\n", 
tid
, 
thisPC
);

1177 
	`ãtchCacheLše
(
ãtchAddr
, 
tid
, 
thisPC
.
	`š¡Addr
());

1179 ià(
ãtchStus
[
tid
] =ğ
IÿcheWa™Re¥Ú£
)

1180 ++
iÿcheSÎCyşes
;

1181 ià(
ãtchStus
[
tid
] =ğ
IbWa™
)

1182 ++
ãtchTlbCyşes
;

1184 ++
ãtchMiscSÎCyşes
;

1186 } ià((
	`checkIÁ”ru±
(
thisPC
.
	`š¡Addr
()è&& !
d–ayedComm™
[
tid
])) {

1190 ++
ãtchMiscSÎCyşes
;

1191 
	`DPRINTF
(
F‘ch
, "[tid:%i]: F‘ch i ¡®Ëd!\n", 
tid
);

1195 ià(
ãtchStus
[
tid
] =ğ
IdË
) {

1196 ++
ãtchIdËCyşes
;

1197 
	`DPRINTF
(
F‘ch
, "[tid:%i]: F‘ch i idË!\n", 
tid
);

1204 ++
ãtchCyşes
;

1206 
TheISA
::
PCS‹
 
ÃxtPC
 = 
thisPC
;

1208 
SticIn¡PŒ
 
¡©icIn¡
 = 
NULL
;

1209 
SticIn¡PŒ
 
curMaüoİ
 = 
maüoİ
[
tid
];

1215 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Adding instructionso queueo "

1216 "decode.\n", 
tid
);

1220 
boŞ
 
´ediùedB¿nch
 = 
çl£
;

1222 
TheISA
::
MachIn¡
 *
ÿcheIn¡s
 =

1223 
»š‹½»t_ÿ¡
<
TheISA
::
MachIn¡
 *>(
ãtchBufãr
[
tid
]);

1225 cÚ¡ 
numIn¡s
 = 
ãtchBufãrSize
 / 
š¡Size
;

1226 
blkOff£t
 = (
ãtchAddr
 - 
ãtchBufãrPC
[
tid
]è/ 
š¡Size
;

1231 
numIn¡
 < 
ãtchWidth
 && !
´ediùedB¿nch
) {

1236 
boŞ
 
ÃedMem
 = !
šRom
 && !
curMaüoİ
 &&

1237 !
decod”
[
tid
]->
	`š¡R—dy
();

1238 
ãtchAddr
 = (
thisPC
.
	`š¡Addr
(è+ 
pcOff£t
è& 
Ba£CPU
::
PCMask
;

1239 
Addr
 
ãtchBufãrBlockPC
 = 
	`ãtchBufãrAlignPC
(
ãtchAddr
);

1241 ià(
ÃedMem
) {

1244 ià(!
ãtchBufãrV®id
[
tid
] ||

1245 
ãtchBufãrBlockPC
 !ğ
ãtchBufãrPC
[
tid
])

1248 ià(
blkOff£t
 >ğ
numIn¡s
) {

1254 ià(
ISA_HAS_DELAY_SLOT
 && 
pcOff£t
 == 0) {

1256 
Addr
 
pcAddr
 = 
thisPC
.
	`š¡Addr
(è& 
Ba£CPU
::
PCMask
;

1257 
ãtchAddr
 !ğ
pcAddr
 && 
blkOff£t
 < 
numIn¡s
) {

1258 
blkOff£t
++;

1259 
ãtchAddr
 +ğ
š¡Size
;

1261 ià(
blkOff£t
 >ğ
numIn¡s
)

1265 
MachIn¡
 
š¡
 = 
TheISA
::
	`gtoh
(
ÿcheIn¡s
[
blkOff£t
]);

1266 
decod”
[
tid
]->
	`mÜeBy‹s
(
thisPC
, 
ãtchAddr
, 
š¡
);

1268 ià(
decod”
[
tid
]->
	`ÃedMÜeBy‹s
()) {

1269 
blkOff£t
++;

1270 
ãtchAddr
 +ğ
š¡Size
;

1271 
pcOff£t
 +ğ
š¡Size
;

1278 ià(!(
curMaüoİ
 || 
šRom
)) {

1279 ià(
decod”
[
tid
]->
	`š¡R—dy
()) {

1280 
¡©icIn¡
 = 
decod”
[
tid
]->
	`decode
(
thisPC
);

1283 ++
ãtchedIn¡s
;

1285 ià(
¡©icIn¡
->
	`isMaüoİ
()) {

1286 
curMaüoİ
 = 
¡©icIn¡
;

1288 
pcOff£t
 = 0;

1299 
boŞ
 
ÃwMaüo
 = 
çl£
;

1300 ià(
curMaüoİ
 || 
šRom
) {

1301 ià(
šRom
) {

1302 
¡©icIn¡
 = 
ıu
->
miüocodeRom
.
	`ãtchMiüoİ
(

1303 
thisPC
.
	`miüoPC
(), 
curMaüoİ
);

1305 
¡©icIn¡
 = 
curMaüoİ
->
	`ãtchMiüoİ
(
thisPC
.
	`miüoPC
());

1307 
ÃwMaüo
 |ğ
¡©icIn¡
->
	`isLa¡Miüoİ
();

1310 
DynIn¡PŒ
 
š¡ruùiÚ
 =

1311 
	`budIn¡
(
tid
, 
¡©icIn¡
, 
curMaüoİ
,

1312 
thisPC
, 
ÃxtPC
, 
Œue
);

1314 
numIn¡
++;

1316 #ià
TRACING_ON


1317 ià(
	`DTRACE
(
O3PeV›w
)) {

1318 
š¡ruùiÚ
->
ãtchTick
 = 
	`curTick
();

1322 
ÃxtPC
 = 
thisPC
;

1326 
´ediùedB¿nch
 |ğ
thisPC
.
	`b¿nchšg
();

1327 
´ediùedB¿nch
 |=

1328 
	`lookupAndUpd©eNextPC
(
š¡ruùiÚ
, 
ÃxtPC
);

1329 ià(
´ediùedB¿nch
) {

1330 
	`DPRINTF
(
F‘ch
, "B¿nch d‘eùed w™h PC = %s\n", 
thisPC
);

1333 
ÃwMaüo
 |ğ
thisPC
.
	`š¡Addr
(è!ğ
ÃxtPC
.instAddr();

1336 
thisPC
 = 
ÃxtPC
;

1337 
šRom
 = 
	`isRomMiüoPC
(
thisPC
.
	`miüoPC
());

1339 ià(
ÃwMaüo
) {

1340 
ãtchAddr
 = 
thisPC
.
	`š¡Addr
(è& 
Ba£CPU
::
PCMask
;

1341 
blkOff£t
 = (
ãtchAddr
 - 
ãtchBufãrPC
[
tid
]è/ 
š¡Size
;

1342 
pcOff£t
 = 0;

1343 
curMaüoİ
 = 
NULL
;

1346 ià(
š¡ruùiÚ
->
	`isQu›sû
()) {

1347 
	`DPRINTF
(
F‘ch
,

1349 
ãtchStus
[
tid
] = 
Qu›sûP’dšg
;

1350 
¡©us_chªge
 = 
Œue
;

1353 } (
curMaüoİ
 || 
decod”
[
tid
]->
	`š¡R—dy
()) &&

1354 
numIn¡
 < 
ãtchWidth
);

1357 ià(
´ediùedB¿nch
) {

1358 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Done fetching,…redicted branch "

1359 "š¡ruùiÚƒncouÁ”ed.\n", 
tid
);

1360 } ià(
numIn¡
 >ğ
ãtchWidth
) {

1361 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Done fetching,„eached fetch bandwidth "

1362 "fÜhi cyşe.\n", 
tid
);

1363 } ià(
blkOff£t
 >ğ
ãtchBufãrSize
) {

1364 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Done fetching,„eachedheƒnd ofhe"

1365 "ãtch bufãr.\n", 
tid
);

1368 
maüoİ
[
tid
] = 
curMaüoİ
;

1369 
ãtchOff£t
[
tid
] = 
pcOff£t
;

1371 ià(
numIn¡
 > 0) {

1372 
wrÙeToTimeBufãr
 = 
Œue
;

1375 
pc
[
tid
] = 
thisPC
;

1379 
ãtchAddr
 = (
thisPC
.
	`š¡Addr
(è+ 
pcOff£t
è& 
Ba£CPU
::
PCMask
;

1380 
Addr
 
ãtchBufãrBlockPC
 = 
	`ãtchBufãrAlignPC
(
ãtchAddr
);

1381 
issueP–šedIãtch
[
tid
] = 
ãtchBufãrBlockPC
 !ğ
ãtchBufãrPC
[tid] &&

1382 
ãtchStus
[
tid
] !ğ
IÿcheWa™Re¥Ú£
 &&

1383 
ãtchStus
[
tid
] !ğ
IbWa™
 &&

1384 
ãtchStus
[
tid
] !ğ
IÿcheWa™R‘ry
 &&

1385 
ãtchStus
[
tid
] !ğ
Qu›sûP’dšg
 &&

1386 !
curMaüoİ
;

1387 
	}
}

1389 
	g‹m¶©e
<
şass
 
	gIm¶
>

1391 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$»cvR‘ry
()

1393 ià(
»ŒyPkt
 !ğ
NULL
) {

1394 
	`as£¹
(
ÿcheBlocked
);

1395 
	`as£¹
(
»ŒyTid
 !ğ
Inv®idTh»adID
);

1396 
	`as£¹
(
ãtchStus
[
»ŒyTid
] =ğ
IÿcheWa™R‘ry
);

1398 ià(
ıu
->
	`g‘In¡PÜt
().
	`£ndTimšgReq
(
»ŒyPkt
)) {

1399 
ãtchStus
[
»ŒyTid
] = 
IÿcheWa™Re¥Ú£
;

1400 
»ŒyPkt
 = 
NULL
;

1401 
»ŒyTid
 = 
Inv®idTh»adID
;

1402 
ÿcheBlocked
 = 
çl£
;

1405 
	`as£¹
(
»ŒyTid
 =ğ
Inv®idTh»adID
);

1408 
ÿcheBlocked
 = 
çl£
;

1410 
	}
}

1417 
	g‹m¶©e
<
şass
 
	gIm¶
>

1418 
Th»adID


1419 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$g‘F‘chšgTh»ad
(
F‘chPriÜ™y
 &
ãtch_´iÜ™y
)

1421 ià(
numTh»ads
 > 1) {

1422 
ãtch_´iÜ™y
) {

1424 
SšgËTh»ad
:

1427 
RoundRobš
:

1428  
	`roundRobš
();

1430 
IQ
:

1431  
	`iqCouÁ
();

1433 
LSQ
:

1434  
	`lsqCouÁ
();

1436 
B¿nch
:

1437  
	`b¿nchCouÁ
();

1440  
Inv®idTh»adID
;

1443 
li¡
<
Th»adID
>::
™”©Ü
 
th»ad
 = 
aùiveTh»ads
->
	`begš
();

1444 ià(
th»ad
 =ğ
aùiveTh»ads
->
	`’d
()) {

1445  
Inv®idTh»adID
;

1448 
Th»adID
 
tid
 = *
th»ad
;

1450 ià(
ãtchStus
[
tid
] =ğ
RuÂšg
 ||

1451 
ãtchStus
[
tid
] =ğ
IÿcheAcûssCom¶‘e
 ||

1452 
ãtchStus
[
tid
] =ğ
IdË
) {

1453  
tid
;

1455  
Inv®idTh»adID
;

1458 
	}
}

1461 
	g‹m¶©e
<
şass
 
	gIm¶
>

1462 
Th»adID


1463 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$roundRobš
()

1465 
li¡
<
Th»adID
>::
™”©Ü
 
´i_™”
 = 
´iÜ™yLi¡
.
	`begš
();

1466 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
´iÜ™yLi¡
.
	`’d
();

1468 
Th»adID
 
high_´i
;

1470 
´i_™”
 !ğ
’d
) {

1471 
high_´i
 = *
´i_™”
;

1473 
	`as£¹
(
high_´i
 <ğ
numTh»ads
);

1475 ià(
ãtchStus
[
high_´i
] =ğ
RuÂšg
 ||

1476 
ãtchStus
[
high_´i
] =ğ
IÿcheAcûssCom¶‘e
 ||

1477 
ãtchStus
[
high_´i
] =ğ
IdË
) {

1479 
´iÜ™yLi¡
.
	`”a£
(
´i_™”
);

1480 
´iÜ™yLi¡
.
	`push_back
(
high_´i
);

1482  
high_´i
;

1485 
´i_™”
++;

1488  
Inv®idTh»adID
;

1489 
	}
}

1491 
	g‹m¶©e
<
şass
 
	gIm¶
>

1492 
Th»adID


1493 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$iqCouÁ
()

1495 
¡d
::
´iÜ™y_queue
<> 
PQ
;

1496 
¡d
::
m­
<, 
Th»adID
> 
th»adM­
;

1498 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

1499 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

1501 
th»ads
 !ğ
’d
) {

1502 
Th»adID
 
tid
 = *
th»ads
++;

1503 
iqCouÁ
 = 
äomIEW
->
›wInfo
[
tid
].iqCount;

1505 
PQ
.
	`push
(
iqCouÁ
);

1506 
th»adM­
[
iqCouÁ
] = 
tid
;

1509 !
PQ
.
	`em±y
()) {

1510 
Th»adID
 
high_´i
 = 
th»adM­
[
PQ
.
	`tİ
()];

1512 ià(
ãtchStus
[
high_´i
] =ğ
RuÂšg
 ||

1513 
ãtchStus
[
high_´i
] =ğ
IÿcheAcûssCom¶‘e
 ||

1514 
ãtchStus
[
high_´i
] =ğ
IdË
)

1515  
high_´i
;

1517 
PQ
.
	`pİ
();

1521  
Inv®idTh»adID
;

1522 
	}
}

1524 
	g‹m¶©e
<
şass
 
	gIm¶
>

1525 
Th»adID


1526 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$lsqCouÁ
()

1528 
¡d
::
´iÜ™y_queue
<> 
PQ
;

1529 
¡d
::
m­
<, 
Th»adID
> 
th»adM­
;

1531 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

1532 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

1534 
th»ads
 !ğ
’d
) {

1535 
Th»adID
 
tid
 = *
th»ads
++;

1536 
ld¡qCouÁ
 = 
äomIEW
->
›wInfo
[
tid
].ldstqCount;

1538 
PQ
.
	`push
(
ld¡qCouÁ
);

1539 
th»adM­
[
ld¡qCouÁ
] = 
tid
;

1542 !
PQ
.
	`em±y
()) {

1543 
Th»adID
 
high_´i
 = 
th»adM­
[
PQ
.
	`tİ
()];

1545 ià(
ãtchStus
[
high_´i
] =ğ
RuÂšg
 ||

1546 
ãtchStus
[
high_´i
] =ğ
IÿcheAcûssCom¶‘e
 ||

1547 
ãtchStus
[
high_´i
] =ğ
IdË
)

1548  
high_´i
;

1550 
PQ
.
	`pİ
();

1553  
Inv®idTh»adID
;

1554 
	}
}

1556 
	g‹m¶©e
<
şass
 
	gIm¶
>

1557 
Th»adID


1558 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$b¿nchCouÁ
()

1561 
li¡
<
Th»adID
>::
™”©Ü
 
th»ad
 = 
aùiveTh»ads
->
	`begš
();

1562 
	`as£¹
(
th»ad
 !ğ
aùiveTh»ads
->
	`’d
());

1563 
Th»adID
 
tid
 = *
th»ad
;

1566 
	`·nic
("Branch Count Fetch…olicy unimplemented\n");

1567  
Inv®idTh»adID
;

1568 
	}
}

1570 
	g‹m¶©e
<
şass
 
	gIm¶
>

1572 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$p–šeIÿcheAcûs£s
(
Th»adID
 
tid
)

1574 ià(!
issueP–šedIãtch
[
tid
]) {

1579 
TheISA
::
PCS‹
 
thisPC
 = 
pc
[
tid
];

1581 ià(
	`isRomMiüoPC
(
thisPC
.
	`miüoPC
())) {

1585 
Addr
 
pcOff£t
 = 
ãtchOff£t
[
tid
];

1586 
Addr
 
ãtchAddr
 = (
thisPC
.
	`š¡Addr
(è+ 
pcOff£t
è& 
Ba£CPU
::
PCMask
;

1589 
Addr
 
ãtchBufãrBlockPC
 = 
	`ãtchBufãrAlignPC
(
ãtchAddr
);

1592 ià(!(
ãtchBufãrV®id
[
tid
] && 
ãtchBufãrBlockPC
 =ğ
ãtchBufãrPC
[tid])) {

1593 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Issuing‡…ipelined I-cache‡ccess, "

1594 "¡¬tšg‡ˆPC %s.\n", 
tid
, 
thisPC
);

1596 
	`ãtchCacheLše
(
ãtchAddr
, 
tid
, 
thisPC
.
	`š¡Addr
());

1598 
	}
}

1600 
	g‹m¶©e
<
şass
 
	gIm¶
>

1602 
	gDeçuÉF‘ch
<
	gIm¶
>::
	$´ofeSÎ
(
Th»adID
 
tid
) {

1603 
	`DPRINTF
(
F‘ch
,"There‡re‚o morehreads‡vailableo fetch from.\n");

1607 ià(
¡®ls
[
tid
].
d¿š
) {

1608 ++
ãtchP’dšgD¿šCyşes
;

1609 
	`DPRINTF
(
F‘ch
, "Fetch is waiting for‡ drain!\n");

1610 } ià(
aùiveTh»ads
->
	`em±y
()) {

1611 ++
ãtchNoAùiveTh»adSÎCyşes
;

1612 
	`DPRINTF
(
F‘ch
, "Fetch has‚o‡ctivehread!\n");

1613 } ià(
ãtchStus
[
tid
] =ğ
Blocked
) {

1614 ++
ãtchBlockedCyşes
;

1615 
	`DPRINTF
(
F‘ch
, "[tid:%i]: F‘ch i blocked!\n", 
tid
);

1616 } ià(
ãtchStus
[
tid
] =ğ
Squashšg
) {

1617 ++
ãtchSquashCyşes
;

1618 
	`DPRINTF
(
F‘ch
, "[tid:%i]: F‘ch i squashšg!\n", 
tid
);

1619 } ià(
ãtchStus
[
tid
] =ğ
IÿcheWa™Re¥Ú£
) {

1620 ++
iÿcheSÎCyşes
;

1621 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Fetch is waiting cache„esponse!\n",

1622 
tid
);

1623 } ià(
ãtchStus
[
tid
] =ğ
IbWa™
) {

1624 ++
ãtchTlbCyşes
;

1625 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Fetch is waiting ITLB walko "

1626 "fšish!\n", 
tid
);

1627 } ià(
ãtchStus
[
tid
] =ğ
T¿pP’dšg
) {

1628 ++
ãtchP’dšgT¿pSÎCyşes
;

1629 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Fetch is waiting for‡…endingrap!\n",

1630 
tid
);

1631 } ià(
ãtchStus
[
tid
] =ğ
Qu›sûP’dšg
) {

1632 ++
ãtchP’dšgQu›sûSÎCyşes
;

1633 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Fetch is waiting for‡…ending quiesce "

1634 "š¡ruùiÚ!\n", 
tid
);

1635 } ià(
ãtchStus
[
tid
] =ğ
IÿcheWa™R‘ry
) {

1636 ++
ãtchIÿcheWa™R‘rySÎCyşes
;

1637 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Fetch is waiting for‡n I-cache„etry!\n",

1638 
tid
);

1639 } ià(
ãtchStus
[
tid
] =ğ
NoGoodAddr
) {

1640 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Fetch…redicted‚on-executable‡ddress\n",

1641 
tid
);

1643 
	`DPRINTF
(
F‘ch
, "[tid:%i]: Unexpected fetch stall„eason (Status: %i).\n",

1644 
tid
, 
ãtchStus
[tid]);

1646 
	}
}

	@o3/free_list.cc

32 
	~"¬ch/»gi¡”s.hh
"

33 
	~"ba£/Œaû.hh
"

34 
	~"cÚfig/the_i§.hh
"

35 
	~"ıu/o3/ä“_li¡.hh
"

36 
	~"debug/F»eLi¡.hh
"

38 
	gUnif›dF»eLi¡
::
Unif›dF»eLi¡
(cÚ¡ 
¡d
::
¡ršg
 &
_my_Çme
,

39 
PhysRegFe
 *
_»gFe
)

40 : 
_Çme
(
_my_Çme
), 
	$»gFe
(
_»gFe
)

42 
	`DPRINTF
(
F»eLi¡
, "Creating‚ew free†ist object.\n");

46 
»gFe
->
	`š™F»eLi¡
(
this
);

47 
	}
}

	@o3/free_list.hh

32 #iâdeà
__CPU_O3_FREE_LIST_HH__


33 
	#__CPU_O3_FREE_LIST_HH__


	)

35 
	~<io¡»am
>

36 
	~<queue
>

38 
	~"ba£/misc.hh
"

39 
	~"ba£/Œaû.hh
"

40 
	~"ıu/o3/comm.hh
"

41 
	~"ıu/o3/»gfe.hh
"

42 
	~"debug/F»eLi¡.hh
"

51 şas 
	cSim¶eF»eLi¡


53 
	m´iv©e
:

56 
¡d
::
queue
<
PhysRegIndex
> 
ä“Regs
;

58 
	mpublic
:

60 
	$Sim¶eF»eLi¡
() {};

63 
	$addReg
(
PhysRegIndex
 
»g
è{ 
ä“Regs
.
	`push
Ôeg); 
	}
}

66 
PhysRegIndex
 
	$g‘Reg
()

68 
	`as£¹
(!
ä“Regs
.
	`em±y
());

69 
PhysRegIndex
 
ä“_»g
 = 
ä“Regs
.
	`äÚt
();

70 
ä“Regs
.
	`pİ
();

71  
ä“_»g
;

72 
	}
}

75 
	$numF»eRegs
(ècÚ¡ {  
ä“Regs
.
	`size
(); 
	}
}

78 
boŞ
 
	$hasF»eRegs
(ècÚ¡ {  !
ä“Regs
.
	`em±y
(); 
	}
}

95 şas 
	cUnif›dF»eLi¡


97 
	m´iv©e
:

101 cÚ¡ 
¡d
::
¡ršg
 
_Çme
;

104 
Sim¶eF»eLi¡
 
	mštLi¡
;

107 
Sim¶eF»eLi¡
 
	mæßtLi¡
;

110 
Sim¶eF»eLi¡
 
	mccLi¡
;

116 
PhysRegFe
 *
	m»gFe
;

123 
ä›nd
 
şass
 
	mUnif›dR’ameM­
;

125 
	mpublic
:

134 
Unif›dF»eLi¡
(cÚ¡ 
¡d
::
¡ršg
 &
_my_Çme
, 
PhysRegFe
 *
_»gFe
);

137 
	m¡d
::
¡ršg
 
	$Çme
(ècÚ¡ {  
_Çme
; };

140 
Sim¶eF»eLi¡
 *
	$g‘CCLi¡
(è{  &
ccLi¡
; 
	}
}

143 
PhysRegIndex
 
	$g‘IÁReg
(è{  
štLi¡
.
	`g‘Reg
(); 
	}
}

146 
PhysRegIndex
 
	$g‘FlßtReg
(è{  
æßtLi¡
.
	`g‘Reg
(); 
	}
}

149 
PhysRegIndex
 
	$g‘CCReg
(è{  
ccLi¡
.
	`g‘Reg
(); 
	}
}

152 
addReg
(
PhysRegIndex
 
ä“d_»g
);

155 
	$addIÁReg
(
PhysRegIndex
 
ä“d_»g
è{ 
štLi¡
.
	`addReg
(ä“d_»g); 
	}
}

158 
	$addFlßtReg
(
PhysRegIndex
 
ä“d_»g
è{ 
æßtLi¡
.
	`addReg
(ä“d_»g); 
	}
}

161 
	$addCCReg
(
PhysRegIndex
 
ä“d_»g
è{ 
ccLi¡
.
	`addReg
(ä“d_»g); 
	}
}

164 
boŞ
 
	$hasF»eIÁRegs
(ècÚ¡ {  
štLi¡
.
	`hasF»eRegs
(); 
	}
}

167 
boŞ
 
	$hasF»eFlßtRegs
(ècÚ¡ {  
æßtLi¡
.
	`hasF»eRegs
(); 
	}
}

170 
boŞ
 
	$hasF»eCCRegs
(ècÚ¡ {  
ccLi¡
.
	`hasF»eRegs
(); 
	}
}

173 
	$numF»eIÁRegs
(ècÚ¡ {  
štLi¡
.
	`numF»eRegs
(); 
	}
}

176 
	$numF»eFlßtRegs
(ècÚ¡ {  
æßtLi¡
.
	`numF»eRegs
(); 
	}
}

179 
	$numF»eCCRegs
(ècÚ¡ {  
ccLi¡
.
	`numF»eRegs
(); 
	}
}

182 
šlše
 

183 
	gUnif›dF»eLi¡
::
	$addReg
(
PhysRegIndex
 
ä“d_»g
)

185 
	`DPRINTF
(
F»eLi¡
,"F»ešg„egi¡” %i.\n", 
ä“d_»g
);

188 ià(
»gFe
->
	`isIÁPhysReg
(
ä“d_»g
)) {

189 
štLi¡
.
	`addReg
(
ä“d_»g
);

190 } ià(
»gFe
->
	`isFlßtPhysReg
(
ä“d_»g
)) {

191 
æßtLi¡
.
	`addReg
(
ä“d_»g
);

193 
	`as£¹
(
»gFe
->
	`isCCPhysReg
(
ä“d_»g
));

194 
ccLi¡
.
	`addReg
(
ä“d_»g
);

208 
	}
}

	@o3/fu_pool.cc

43 
	~<s¡»am
>

45 
	~"ıu/o3/fu_poŞ.hh
"

46 
	~"ıu/func_un™.hh
"

48 
usšg
 
Çme¥aû
 
	g¡d
;

55 
šlše
 

56 
	gFUPoŞ
::
FUIdxQueue
::
	$addFU
(
fu_idx
)

58 
funcUn™sIdx
.
	`push_back
(
fu_idx
);

59 ++
size
;

60 
	}
}

62 
šlše
 

63 
	gFUPoŞ
::
FUIdxQueue
::
	$g‘FU
()

65 
»tv®
 = 
funcUn™sIdx
[
idx
++];

67 ià(
idx
 =ğ
size
)

68 
idx
 = 0;

70  
»tv®
;

71 
	}
}

73 
	gFUPoŞ
::~
	$FUPoŞ
()

75 
fuLi¡I‹¿tÜ
 
i
 = 
funcUn™s
.
	`begš
();

76 
fuLi¡I‹¿tÜ
 
’d
 = 
funcUn™s
.
	`’d
();

77 ; 
i
 !ğ
’d
; ++i)

78 
d–‘e
 *
i
;

79 
	}
}

83 
	gFUPoŞ
::
	$FUPoŞ
(cÚ¡ 
P¬ams
 *
p
)

84 : 
	$SimObjeù
(
p
)

86 
numFU
 = 0;

88 
funcUn™s
.
	`ş—r
();

90 
i
 = 0; i < 
Num_OpCÏs£s
; ++i) {

91 
maxOpL©’c›s
[
i
] = 
	`Cyşes
(0);

92 
maxIssueL©’c›s
[
i
] = 
	`Cyşes
(0);

98 cÚ¡ 
veùÜ
<
FUDesc
 *> &
·¿mLi¡
 = 
p
->
FULi¡
;

99 
FUDD™”©Ü
 
i
 = 
·¿mLi¡
.
	`begš
(); i !ğ·¿mLi¡.
	`’d
(); ++i) {

104 ià((*
i
)->
numb”
) {

112 
FuncUn™
 *
fu
 = 
Ãw
 FuncUnit;

114 
OPDD™”©Ü
 
j
 = (*
i
)->
İDescLi¡
.
	`begš
();

115 
OPDD™”©Ü
 
’d
 = (*
i
)->
İDescLi¡
.
	`’d
();

116 ; 
j
 !ğ
’d
; ++j) {

118 
ÿ·b™yLi¡
.
	`£t
((*
j
)->
İCÏss
);

122 
k
 = 0; k < (*
i
)->
numb”
; ++k)

123 
fuP”C­Li¡
[(*
j
)->
İCÏss
].
	`addFU
(
numFU
 + 
k
);

126 
fu
->
	`addC­ab™y
((*
j
)->
İCÏss
, (*j)->
İL©
, (*j)->
issueL©
);

128 ià((*
j
)->
İL©
 > 
maxOpL©’c›s
[(*j)->
İCÏss
])

129 
maxOpL©’c›s
[(*
j
)->
İCÏss
] = (*j)->
İL©
;

131 ià((*
j
)->
issueL©
 > 
maxIssueL©’c›s
[(*j)->
İCÏss
])

132 
maxIssueL©’c›s
[(*
j
)->
İCÏss
] = (*j)->
issueL©
;

135 
numFU
++;

138 
fu
->
Çme
 = (*
i
)->
	`Çme
() + "(0)";

139 
funcUn™s
.
	`push_back
(
fu
);

141 
c
 = 1; c < (*
i
)->
numb”
; ++c) {

142 
o¡ršg¡»am
 
s
;

143 
numFU
++;

144 
FuncUn™
 *
fu2
 = 
Ãw
 
	`FuncUn™
(*
fu
);

146 
s
 << (*
i
)->
	`Çme
(è<< "(" << 
c
 << ")";

147 
fu2
->
Çme
 = 
s
.
	`¡r
();

148 
funcUn™s
.
	`push_back
(
fu2
);

153 
un™Busy
.
	`»size
(
numFU
);

155 
i
 = 0; i < 
numFU
; i++) {

156 
un™Busy
[
i
] = 
çl£
;

158 
	}
}

161 
	gFUPoŞ
::
	$ªnÙ©eMemÜyUn™s
(
Cyşes
 
h™_Ï‹ncy
)

163 
maxOpL©’c›s
[
MemR—dOp
] = 
h™_Ï‹ncy
;

165 
fuLi¡I‹¿tÜ
 
i
 = 
funcUn™s
.
	`begš
();

166 
fuLi¡I‹¿tÜ
 
›nd
 = 
funcUn™s
.
	`’d
();

167 ; 
i
 !ğ
›nd
; ++i) {

168 ià((*
i
)->
	`´ovides
(
MemR—dOp
))

169 (*
i
)->
	`İL©’cy
(
MemR—dOp
èğ
h™_Ï‹ncy
;

171 ià((*
i
)->
	`´ovides
(
MemWr™eOp
))

172 (*
i
)->
	`İL©’cy
(
MemWr™eOp
èğ
h™_Ï‹ncy
;

174 
	}
}

177 
	gFUPoŞ
::
	$g‘Un™
(
OpCÏss
 
ÿ·b™y
)

181 ià(!
ÿ·b™yLi¡
[
ÿ·b™y
])

184 
fu_idx
 = 
fuP”C­Li¡
[
ÿ·b™y
].
	`g‘FU
();

185 
¡¬t_idx
 = 
fu_idx
;

189 
un™Busy
[
fu_idx
]) {

190 
fu_idx
 = 
fuP”C­Li¡
[
ÿ·b™y
].
	`g‘FU
();

191 ià(
fu_idx
 =ğ
¡¬t_idx
) {

197 
	`as£¹
(
fu_idx
 < 
numFU
);

199 
un™Busy
[
fu_idx
] = 
Œue
;

201  
fu_idx
;

202 
	}
}

205 
	gFUPoŞ
::
	$ä“Un™NextCyşe
(
fu_idx
)

207 
	`as£¹
(
un™Busy
[
fu_idx
]);

208 
un™sToBeF»ed
.
	`push_back
(
fu_idx
);

209 
	}
}

212 
	gFUPoŞ
::
	$´oûssF»eUn™s
()

214 !
un™sToBeF»ed
.
	`em±y
()) {

215 
fu_idx
 = 
un™sToBeF»ed
.
	`back
();

216 
un™sToBeF»ed
.
	`pİ_back
();

218 
	`as£¹
(
un™Busy
[
fu_idx
]);

220 
un™Busy
[
fu_idx
] = 
çl£
;

222 
	}
}

225 
	gFUPoŞ
::
	$dump
()

227 
cout
 << "FunùiÚ Un™ PoŞ (" << 
	`Çme
() << ")\n";

228 
cout
 << "======================================\n";

229 
cout
 << "Free List:\n";

231 
i
 = 0; i < 
numFU
; ++i) {

232 ià(
un™Busy
[
i
]) {

236 
cout
 << " [" << 
i
 << "] : ";

238 
cout
 << 
funcUn™s
[
i
]->
Çme
 << " ";

240 
cout
 << "\n";

243 
cout
 << "======================================\n";

244 
cout
 << "Busy List:\n";

245 
i
 = 0; i < 
numFU
; ++i) {

246 ià(!
un™Busy
[
i
]) {

250 
cout
 << " [" << 
i
 << "] : ";

252 
cout
 << 
funcUn™s
[
i
]->
Çme
 << " ";

254 
cout
 << "\n";

256 
	}
}

258 
boŞ


259 
	gFUPoŞ
::
	$isD¿šed
() const

261 
boŞ
 
is_d¿šed
 = 
Œue
;

262 
i
 = 0; i < 
numFU
; i++)

263 
is_d¿šed
 = is_d¿šed && !
un™Busy
[
i
];

265  
is_d¿šed
;

266 
	}
}

283 
FUPoŞ
 *

284 
	gFUPoŞP¬ams
::
	$ü—‹
()

286  
Ãw
 
	`FUPoŞ
(
this
);

287 
	}
}

	@o3/fu_pool.hh

43 #iâdeà
__CPU_O3_FU_POOL_HH__


44 
	#__CPU_O3_FU_POOL_HH__


	)

46 
	~<b™£t
>

47 
	~<li¡
>

48 
	~<¡ršg
>

49 
	~<veùÜ
>

51 
	~"ıu/İ_şass.hh
"

52 
	~"·¿ms/FUPoŞ.hh
"

53 
	~"sim/sim_objeù.hh
"

55 
şass
 
	gFUDesc
;

56 
şass
 
	gFuncUn™
;

70 şas 
	cFUPoŞ
 : 
public
 
SimObjeù


72 
´iv©e
:

74 
Cyşes
 
maxOpL©’c›s
[
Num_OpCÏs£s
];

76 
Cyşes
 
	mmaxIssueL©’c›s
[
Num_OpCÏs£s
];

79 
	m¡d
::
b™£t
<
Num_OpCÏs£s
> 
ÿ·b™yLi¡
;

82 
	m¡d
::
veùÜ
<
boŞ
> 
un™Busy
;

85 
	m¡d
::
veùÜ
<> 
un™sToBeF»ed
;

93 şas 
	cFUIdxQueue
 {

94 
	mpublic
:

96 
FUIdxQueue
()

97 : 
idx
(0), 
size
(0)

101 
šlše
 
addFU
(
fu_idx
);

106 
šlše
 
g‘FU
();

108 
	m´iv©e
:

110 
idx
;

113 
	msize
;

116 
	m¡d
::
veùÜ
<> 
funcUn™sIdx
;

120 
FUIdxQueue
 
	gfuP”C­Li¡
[
Num_OpCÏs£s
];

123 
	gnumFU
;

126 
	g¡d
::
veùÜ
<
FuncUn™
 *> 
funcUn™s
;

128 
	g¡d
::
	tveùÜ
<
	tFuncUn™
 *>::
	t™”©Ü
 
	tfuLi¡I‹¿tÜ
;

130 
	gpublic
:

131 
FUPoŞP¬ams
 
	tP¬ams
;

133 
FUPoŞ
(cÚ¡ 
P¬ams
 *
p
);

134 ~
FUPoŞ
();

139 
ªnÙ©eMemÜyUn™s
(
Cyşes
 
h™_Ï‹ncy
);

148 
g‘Un™
(
OpCÏss
 
ÿ·b™y
);

151 
ä“Un™NextCyşe
(
fu_idx
);

154 
´oûssF»eUn™s
();

157 
	$size
(è{  
numFU
; 
	}
}

160 
dump
();

163 
Cyşes
 
	$g‘OpL©’cy
(
OpCÏss
 
ÿ·b™y
) {

164  
maxOpL©’c›s
[
ÿ·b™y
];

165 
	}
}

168 
Cyşes
 
	$g‘IssueL©’cy
(
OpCÏss
 
ÿ·b™y
) {

169  
maxIssueL©’c›s
[
ÿ·b™y
];

170 
	}
}

173 
boŞ
 
	$isD¿šed
() const;

176 
	$keOv”From
(è{
	}
};

	@o3/iew.cc

31 
	~"ıu/o3/›w_im¶.hh
"

32 
	~"ıu/o3/š¡_queue.hh
"

33 
	~"ıu/o3/i§_¥ecific.hh
"

35 
‹m¶©e
 
şass
 
	gDeçuÉIEW
<
	gO3CPUIm¶
>;

	@o3/iew.hh

43 #iâdeà
__CPU_O3_IEW_HH__


44 
	#__CPU_O3_IEW_HH__


	)

46 
	~<queue
>

47 
	~<£t
>

49 
	~"ba£/¡©i¡ics.hh
"

50 
	~"ıu/o3/comm.hh
"

51 
	~"ıu/o3/lsq.hh
"

52 
	~"ıu/o3/scÜebßrd.hh
"

53 
	~"ıu/timebuf.hh
"

54 
	~"debug/IEW.hh
"

56 
	gD”ivO3CPUP¬ams
;

57 
şass
 
	gFUPoŞ
;

78 
	g‹m¶©e
<
şass
 
	gIm¶
>

79 şas 
	cDeçuÉIEW


81 
	m´iv©e
:

83 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
 CPUPol;

84 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

85 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

87 
ty³Çme
 
	tCPUPŞ
::
	tIQ
 IQ;

88 
ty³Çme
 
	tCPUPŞ
::
	tR’ameM­
 RenameMap;

89 
ty³Çme
 
	tCPUPŞ
::
	tLSQ
 LSQ;

91 
ty³Çme
 
	tCPUPŞ
::
	tTimeSŒuù
 TimeStruct;

92 
ty³Çme
 
	tCPUPŞ
::
	tIEWSŒuù
 IEWStruct;

93 
ty³Çme
 
	tCPUPŞ
::
	tR’ameSŒuù
 RenameStruct;

94 
ty³Çme
 
	tCPUPŞ
::
	tIssueSŒuù
 IssueStruct;

96 
	mpublic
:

100 
	eStus
 {

101 
Aùive
,

102 
	mIÇùive


106 
	eSgeStus
 {

107 
	gRuÂšg
,

108 
	gBlocked
,

109 
	gIdË
,

110 
	gS¹Squash
,

111 
	gSquashšg
,

112 
	gUnblockšg


115 
	g´iv©e
:

117 
Stus
 
_¡©us
;

119 
SgeStus
 
	gdi¥©chStus
[
Im¶
::
MaxTh»ads
];

121 
SgeStus
 
	gexeStus
;

123 
SgeStus
 
	gwbStus
;

125 
	gpublic
:

127 
DeçuÉIEW
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
);

130 
	g¡d
::
¡ršg
 
	$Çme
() const;

133 
	`»gSts
();

136 
	`¡¬tupSge
();

139 
	`£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
);

142 
	`£tR’ameQueue
(
TimeBufãr
<
R’ameSŒuù
> *
rq_±r
);

145 
	`£tIEWQueue
(
TimeBufãr
<
IEWSŒuù
> *
iq_±r
);

148 
	`£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

151 
	`£tScÜebßrd
(
ScÜebßrd
 *
sb_±r
);

154 
	$d¿šSª™yCheck
() const;

157 
boŞ
 
	$isD¿šed
() const;

160 
	`keOv”From
();

163 
	`squash
(
Th»adID
 
tid
);

166 
	`wakeD•’d’ts
(
DynIn¡PŒ
 &
š¡
);

171 
	`»scheduËMemIn¡
(
DynIn¡PŒ
 &
š¡
);

174 
	`»¶ayMemIn¡
(
DynIn¡PŒ
 &
š¡
);

177 
	`š¡ToComm™
(
DynIn¡PŒ
 &
š¡
);

180 
	`skidIn£¹
(
Th»adID
 
tid
);

183 
	`skidCouÁ
();

186 
boŞ
 
	`skidsEm±y
();

189 
	`upd©eStus
();

192 
	`»£tEÁr›s
();

197 
	`wakeCPU
();

200 
	`aùiv™yThisCyşe
();

203 
šlše
 
	`aùiv©eSge
();

206 
šlše
 
	`d—ùiv©eSge
();

209 
boŞ
 
	$hasStÜesToWB
(è{  
ld¡Queue
.
	`hasStÜesToWB
(); 
	}
}

212 
boŞ
 
	$hasStÜesToWB
(
Th»adID
 
tid
è{  
ld¡Queue
.
	`hasStÜesToWB
Ñid); 
	}
}

214 
	$šüWb
(
In¡SeqNum
 &
¢
)

216 ++
wbOut¡ªdšg
;

217 ià(
wbOut¡ªdšg
 =ğ
wbMax
)

218 
abËToIssue
 = 
çl£
;

219 
	`DPRINTF
(
IEW
, "wbOut¡ªdšg: %˜[¢:%Îi]\n", 
wbOut¡ªdšg
, 
¢
);

220 
	`as£¹
(
wbOut¡ªdšg
 <ğ
wbMax
);

221 #ifdeà
DEBUG


222 
wbLi¡
.
	`š£¹
(
¢
);

224 
	}
}

226 
	$deüWb
(
In¡SeqNum
 &
¢
)

228 ià(
wbOut¡ªdšg
 =ğ
wbMax
)

229 
abËToIssue
 = 
Œue
;

230 
wbOut¡ªdšg
--;

231 
	`DPRINTF
(
IEW
, "wbOut¡ªdšg: %˜[¢:%Îi]\n", 
wbOut¡ªdšg
, 
¢
);

232 
	`as£¹
(
wbOut¡ªdšg
 >= 0);

233 #ifdeà
DEBUG


234 
	`as£¹
(
wbLi¡
.
	`fšd
(
¢
è!ğwbLi¡.
	`’d
());

235 
wbLi¡
.
	`”a£
(
¢
);

237 
	}
}

239 #ifdeà
DEBUG


240 
	g¡d
::
£t
<
In¡SeqNum
> 
wbLi¡
;

242 
	$dumpWb
()

244 
¡d
::
£t
<
In¡SeqNum
>::
™”©Ü
 
wb_™
 = 
wbLi¡
.
	`begš
();

245 
wb_™
 !ğ
wbLi¡
.
	`’d
()) {

246 
	`ırštf
("[sn:%lli]\n",

247 (*
wb_™
));

248 
wb_™
++;

250 
	}
}

253 
boŞ
 
	$ÿnIssue
(è{  
abËToIssue
; 
	}
}

255 
boŞ
 
	gabËToIssue
;

258 
checkMi¥»diùiÚ
(
DynIn¡PŒ
 &
š¡
);

260 
	g´iv©e
:

264 
squashDueToB¿nch
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
);

269 
squashDueToMemOrd”
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
);

274 
squashDueToMemBlocked
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
);

277 
block
(
Th»adID
 
tid
);

282 
unblock
(
Th»adID
 
tid
);

285 
di¥©ch
(
Th»adID
 
tid
);

288 
di¥©chIn¡s
(
Th»adID
 
tid
);

294 
execu‹In¡s
();

301 
wr™ebackIn¡s
();

306 
v®idIn¡sFromR’ame
();

309 
»adSÎSigÇls
(
Th»adID
 
tid
);

312 
boŞ
 
checkSÎ
(
Th»adID
 
tid
);

315 
checkSigÇlsAndUpd©e
(
Th»adID
 
tid
);

318 
em±yR’ameIn¡s
(
Th»adID
 
tid
);

321 
sÜtIn¡s
();

323 
	gpublic
:

327 
tick
();

329 
	g´iv©e
:

331 
upd©eExeIn¡Sts
(
DynIn¡PŒ
 &
š¡
);

334 
	gTimeBufãr
<
	gTimeSŒuù
> *
	gtimeBufãr
;

337 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
toF‘ch
;

340 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomComm™
;

343 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
toR’ame
;

346 
	gTimeBufãr
<
	gR’ameSŒuù
> *
	g»ÇmeQueue
;

349 
ty³Çme
 
	gTimeBufãr
<
	gR’ameSŒuù
>::
wœe
 
äomR’ame
;

352 
	gTimeBufãr
<
	gIssueSŒuù
> 
	gissueToExecQueue
;

355 
ty³Çme
 
	gTimeBufãr
<
	gIssueSŒuù
>::
wœe
 
äomIssue
;

361 
	gTimeBufãr
<
	gIEWSŒuù
> *
	g›wQueue
;

364 
ty³Çme
 
	gTimeBufãr
<
	gIEWSŒuù
>::
wœe
 
toComm™
;

367 
	g¡d
::
queue
<
DynIn¡PŒ
> 
š¡s
[
Im¶
::
MaxTh»ads
];

370 
	g¡d
::
queue
<
DynIn¡PŒ
> 
skidBufãr
[
Im¶
::
MaxTh»ads
];

373 
ScÜebßrd
* 
	gscÜebßrd
;

375 
	g´iv©e
:

377 
O3CPU
 *
ıu
;

382 
boŞ
 
	gwrÙeToTimeBufãr
;

385 
	sSÎs
 {

386 
boŞ
 
	gcomm™
;

390 
SÎs
 
	g¡®ls
[
Im¶
::
MaxTh»ads
];

393 
´štAvaabËIn¡s
();

395 
	gpublic
:

397 
IQ
 
š¡Queue
;

400 
LSQ
 
	gld¡Queue
;

403 
FUPoŞ
 *
	gfuPoŞ
;

407 
boŞ
 
	gupd©eLSQNextCyşe
;

409 
	g´iv©e
:

411 
boŞ
 
ãtchRedœeù
[
Im¶
::
MaxTh»ads
];

416 
boŞ
 
	gupd©edQueues
;

419 
Cyşes
 
	gcomm™ToIEWD–ay
;

422 
Cyşes
 
	g»ÇmeToIEWD–ay
;

429 
Cyşes
 
	gissueToExecu‹D–ay
;

432 
	gdi¥©chWidth
;

435 
	gissueWidth
;

438 
	gwbNumIn¡
;

445 
	gwbCyşe
;

450 
	gwbOut¡ªdšg
;

453 
	gwbWidth
;

458 
	gwbMax
;

461 
Th»adID
 
	gnumTh»ads
;

464 
	g¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

467 
	gskidBufãrMax
;

470 
	gSts
::
SÿÏr
 
›wIdËCyşes
;

472 
	gSts
::
SÿÏr
 
›wSquashCyşes
;

474 
	gSts
::
SÿÏr
 
›wBlockCyşes
;

476 
	gSts
::
SÿÏr
 
›wUnblockCyşes
;

478 
	gSts
::
SÿÏr
 
›wDi¥©chedIn¡s
;

480 
	gSts
::
SÿÏr
 
›wDi¥SquashedIn¡s
;

482 
	gSts
::
SÿÏr
 
›wDi¥LßdIn¡s
;

484 
	gSts
::
SÿÏr
 
›wDi¥StÜeIn¡s
;

486 
	gSts
::
SÿÏr
 
›wDi¥NÚS³cIn¡s
;

488 
	gSts
::
SÿÏr
 
›wIQFuÎEv’ts
;

490 
	gSts
::
SÿÏr
 
›wLSQFuÎEv’ts
;

492 
	gSts
::
SÿÏr
 
memOrd”ViŞ©iÚEv’ts
;

494 
	gSts
::
SÿÏr
 
´ediùedTak’IncÜ»ù
;

496 
	gSts
::
SÿÏr
 
´ediùedNÙTak’IncÜ»ù
;

498 
	gSts
::
FÜmuÏ
 
b¿nchMi¥»diùs
;

501 
	gSts
::
SÿÏr
 
›wExecu‹dIn¡s
;

503 
	gSts
::
VeùÜ
 
›wExecLßdIn¡s
;

507 
	gSts
::
SÿÏr
 
›wExecSquashedIn¡s
;

509 
	gSts
::
VeùÜ
 
›wExecu‹dSwp
;

511 
	gSts
::
VeùÜ
 
›wExecu‹dNİ
;

513 
	gSts
::
VeùÜ
 
›wExecu‹dRefs
;

515 
	gSts
::
VeùÜ
 
›wExecu‹dB¿nches
;

517 
	gSts
::
FÜmuÏ
 
›wExecStÜeIn¡s
;

519 
	gSts
::
FÜmuÏ
 
›wExecR©e
;

522 
	gSts
::
VeùÜ
 
›wIn¡sToComm™
;

524 
	gSts
::
VeùÜ
 
wr™ebackCouÁ
;

526 
	gSts
::
VeùÜ
 
´oduûrIn¡
;

528 
	gSts
::
VeùÜ
 
cÚsum”In¡
;

532 
	gSts
::
VeùÜ
 
wbP’®ized
;

534 
	gSts
::
FÜmuÏ
 
wbR©e
;

536 
	gSts
::
FÜmuÏ
 
wbFªout
;

538 
	gSts
::
FÜmuÏ
 
wbP’®izedR©e
;

	@o3/iew_impl.hh

43 #iâdeà
__CPU_O3_IEW_IMPL_IMPL_HH__


44 
	#__CPU_O3_IEW_IMPL_IMPL_HH__


	)

50 
	~<queue
>

52 
	~"¬ch/ut™y.hh
"

53 
	~"cÚfig/the_i§.hh
"

54 
	~"ıu/check”/ıu.hh
"

55 
	~"ıu/o3/fu_poŞ.hh
"

56 
	~"ıu/o3/›w.hh
"

57 
	~"ıu/timebuf.hh
"

58 
	~"debug/Aùiv™y.hh
"

59 
	~"debug/D¿š.hh
"

60 
	~"debug/IEW.hh
"

61 
	~"debug/O3PeV›w.hh
"

62 
	~"·¿ms/D”ivO3CPU.hh
"

64 
usšg
 
Çme¥aû
 
	g¡d
;

66 
	g‹m¶©e
<
şass
 
	gIm¶
>

67 
	gDeçuÉIEW
<
	gIm¶
>::
	$DeçuÉIEW
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
)

68 : 
	`issueToExecQueue
(
·¿ms
->
backComSize
,…¬ams->
fÜw¬dComSize
),

69 
	`ıu
(
_ıu
),

70 
	`š¡Queue
(
_ıu
, 
this
, 
·¿ms
),

71 
	`ld¡Queue
(
_ıu
, 
this
, 
·¿ms
),

72 
	`fuPoŞ
(
·¿ms
->
fuPoŞ
),

73 
	`comm™ToIEWD–ay
(
·¿ms
->
comm™ToIEWD–ay
),

74 
	`»ÇmeToIEWD–ay
(
·¿ms
->
»ÇmeToIEWD–ay
),

75 
	`issueToExecu‹D–ay
(
·¿ms
->
issueToExecu‹D–ay
),

76 
	`di¥©chWidth
(
·¿ms
->
di¥©chWidth
),

77 
	`issueWidth
(
·¿ms
->
issueWidth
),

78 
	`wbOut¡ªdšg
(0),

79 
	`wbWidth
(
·¿ms
->
wbWidth
),

80 
	`numTh»ads
(
·¿ms
->
numTh»ads
)

82 
_¡©us
 = 
Aùive
;

83 
exeStus
 = 
RuÂšg
;

84 
wbStus
 = 
IdË
;

87 
äomIssue
 = 
issueToExecQueue
.
	`g‘Wœe
(-
issueToExecu‹D–ay
);

90 
š¡Queue
.
	`£tIssueToExecu‹Queue
(&
issueToExecQueue
);

92 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

93 
di¥©chStus
[
tid
] = 
RuÂšg
;

94 
¡®ls
[
tid
].
comm™
 = 
çl£
;

95 
ãtchRedœeù
[
tid
] = 
çl£
;

98 
wbMax
 = 
wbWidth
 * 
·¿ms
->
wbD•th
;

100 
upd©eLSQNextCyşe
 = 
çl£
;

102 
abËToIssue
 = 
Œue
;

104 
skidBufãrMax
 = (3 * (
»ÇmeToIEWD–ay
 * 
·¿ms
->
»ÇmeWidth
)è+ 
issueWidth
;

105 
	}
}

107 
	g‹m¶©e
 <
şass
 
	gIm¶
>

108 
	g¡d
::
¡ršg


109 
DeçuÉIEW
<
Im¶
>::
	$Çme
() const

111  
ıu
->
	`Çme
() + ".iew";

112 
	}
}

114 
	g‹m¶©e
 <
şass
 
	gIm¶
>

116 
	gDeçuÉIEW
<
	gIm¶
>::
	$»gSts
()

118 
usšg
 
Çme¥aû
 
Sts
;

120 
š¡Queue
.
	`»gSts
();

121 
ld¡Queue
.
	`»gSts
();

123 
›wIdËCyşes


124 .
	`Çme
(name() + ".iewIdleCycles")

125 .
	`desc
("Number of cycles IEW is idle");

127 
›wSquashCyşes


128 .
	`Çme
(name() + ".iewSquashCycles")

129 .
	`desc
("Number of cycles IEW is squashing");

131 
›wBlockCyşes


132 .
	`Çme
(name() + ".iewBlockCycles")

133 .
	`desc
("Number of cycles IEW is blocking");

135 
›wUnblockCyşes


136 .
	`Çme
(name() + ".iewUnblockCycles")

137 .
	`desc
("Number of cycles IEW is unblocking");

139 
›wDi¥©chedIn¡s


140 .
	`Çme
(name() + ".iewDispatchedInsts")

141 .
	`desc
("Number of instructions dispatchedo IQ");

143 
›wDi¥SquashedIn¡s


144 .
	`Çme
(name() + ".iewDispSquashedInsts")

145 .
	`desc
("Number of squashed instructions skipped by dispatch");

147 
›wDi¥LßdIn¡s


148 .
	`Çme
(name() + ".iewDispLoadInsts")

149 .
	`desc
("Number of dispatched†oad instructions");

151 
›wDi¥StÜeIn¡s


152 .
	`Çme
(name() + ".iewDispStoreInsts")

153 .
	`desc
("Number of dispatched store instructions");

155 
›wDi¥NÚS³cIn¡s


156 .
	`Çme
(name() + ".iewDispNonSpecInsts")

157 .
	`desc
("Number of dispatched‚on-speculative instructions");

159 
›wIQFuÎEv’ts


160 .
	`Çme
(name() + ".iewIQFullEvents")

161 .
	`desc
("Number ofimeshe IQ has become full, causing‡ stall");

163 
›wLSQFuÎEv’ts


164 .
	`Çme
(name() + ".iewLSQFullEvents")

165 .
	`desc
("Number ofimeshe LSQ has become full, causing‡ stall");

167 
memOrd”ViŞ©iÚEv’ts


168 .
	`Çme
(name() + ".memOrderViolationEvents")

169 .
	`desc
("Number of memory order violations");

171 
´ediùedTak’IncÜ»ù


172 .
	`Çme
(name() + ".predictedTakenIncorrect")

173 .
	`desc
("Number of brancheshat were…redictedaken incorrectly");

175 
´ediùedNÙTak’IncÜ»ù


176 .
	`Çme
(name() + ".predictedNotTakenIncorrect")

177 .
	`desc
("Number of brancheshat were…redicted‚otaken incorrectly");

179 
b¿nchMi¥»diùs


180 .
	`Çme
(name() + ".branchMispredicts")

181 .
	`desc
("Number of branch mispredicts detected‡tƒxecute");

183 
b¿nchMi¥»diùs
 = 
´ediùedTak’IncÜ»ù
 + 
´ediùedNÙTak’IncÜ»ù
;

185 
›wExecu‹dIn¡s


186 .
	`Çme
(name() + ".iewExecutedInsts")

187 .
	`desc
("Number ofƒxecuted instructions");

189 
›wExecLßdIn¡s


190 .
	`š™
(
ıu
->
numTh»ads
)

191 .
	`Çme
(name() + ".iewExecLoadInsts")

192 .
	`desc
("Number of†oad instructionsƒxecuted")

193 .
	`æags
(
tÙ®
);

195 
›wExecSquashedIn¡s


196 .
	`Çme
(name() + ".iewExecSquashedInsts")

197 .
	`desc
("Number of squashed instructions skipped inƒxecute");

199 
›wExecu‹dSwp


200 .
	`š™
(
ıu
->
numTh»ads
)

201 .
	`Çme
(name() + ".exec_swp")

202 .
	`desc
("number of swp instsƒxecuted")

203 .
	`æags
(
tÙ®
);

205 
›wExecu‹dNİ


206 .
	`š™
(
ıu
->
numTh»ads
)

207 .
	`Çme
(name() + ".exec_nop")

208 .
	`desc
("number of‚op instsƒxecuted")

209 .
	`æags
(
tÙ®
);

211 
›wExecu‹dRefs


212 .
	`š™
(
ıu
->
numTh»ads
)

213 .
	`Çme
(name() + ".exec_refs")

214 .
	`desc
("number of memory„eference instsƒxecuted")

215 .
	`æags
(
tÙ®
);

217 
›wExecu‹dB¿nches


218 .
	`š™
(
ıu
->
numTh»ads
)

219 .
	`Çme
(name() + ".exec_branches")

220 .
	`desc
("Number of branchesƒxecuted")

221 .
	`æags
(
tÙ®
);

223 
›wExecStÜeIn¡s


224 .
	`Çme
(name() + ".exec_stores")

225 .
	`desc
("Number of storesƒxecuted")

226 .
	`æags
(
tÙ®
);

227 
›wExecStÜeIn¡s
 = 
›wExecu‹dRefs
 - 
›wExecLßdIn¡s
;

229 
›wExecR©e


230 .
	`Çme
(name() + ".exec_rate")

231 .
	`desc
("Instƒxecution„ate")

232 .
	`æags
(
tÙ®
);

234 
›wExecR©e
 = 
›wExecu‹dIn¡s
 / 
ıu
->
numCyşes
;

236 
›wIn¡sToComm™


237 .
	`š™
(
ıu
->
numTh»ads
)

238 .
	`Çme
(name() + ".wb_sent")

239 .
	`desc
("cumulative count of insts sento commit")

240 .
	`æags
(
tÙ®
);

242 
wr™ebackCouÁ


243 .
	`š™
(
ıu
->
numTh»ads
)

244 .
	`Çme
(name() + ".wb_count")

245 .
	`desc
("cumulative count of insts written-back")

246 .
	`æags
(
tÙ®
);

248 
´oduûrIn¡


249 .
	`š™
(
ıu
->
numTh»ads
)

250 .
	`Çme
(name() + ".wb_producers")

251 .
	`desc
("num instructions…roducing‡ value")

252 .
	`æags
(
tÙ®
);

254 
cÚsum”In¡


255 .
	`š™
(
ıu
->
numTh»ads
)

256 .
	`Çme
(name() + ".wb_consumers")

257 .
	`desc
("num instructions consuming‡ value")

258 .
	`æags
(
tÙ®
);

260 
wbP’®ized


261 .
	`š™
(
ıu
->
numTh»ads
)

262 .
	`Çme
(name() + ".wb_penalized")

263 .
	`desc
("number of instrctions„equiredo writeo 'other' IQ")

264 .
	`æags
(
tÙ®
);

266 
wbP’®izedR©e


267 .
	`Çme
(name() + ".wb_penalized_rate")

268 .
	`desc
 ("fraction of instructions written-backhat wroteo 'other' IQ")

269 .
	`æags
(
tÙ®
);

271 
wbP’®izedR©e
 = 
wbP’®ized
 / 
wr™ebackCouÁ
;

273 
wbFªout


274 .
	`Çme
(name() + ".wb_fanout")

275 .
	`desc
("average fanout of values written-back")

276 .
	`æags
(
tÙ®
);

278 
wbFªout
 = 
´oduûrIn¡
 / 
cÚsum”In¡
;

280 
wbR©e


281 .
	`Çme
(name() + ".wb_rate")

282 .
	`desc
("insts written-back…er cycle")

283 .
	`æags
(
tÙ®
);

284 
wbR©e
 = 
wr™ebackCouÁ
 / 
ıu
->
numCyşes
;

285 
	}
}

287 
	g‹m¶©e
<
şass
 
	gIm¶
>

289 
	gDeçuÉIEW
<
	gIm¶
>::
	$¡¬tupSge
()

291 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

292 
toR’ame
->
›wInfo
[
tid
].
u£dIQ
 = 
Œue
;

293 
toR’ame
->
›wInfo
[
tid
].
ä“IQEÁr›s
 =

294 
š¡Queue
.
	`numF»eEÁr›s
(
tid
);

296 
toR’ame
->
›wInfo
[
tid
].
u£dLSQ
 = 
Œue
;

297 
toR’ame
->
›wInfo
[
tid
].
ä“LSQEÁr›s
 =

298 
ld¡Queue
.
	`numF»eEÁr›s
(
tid
);

302 ià(
ıu
->
check”
) {

303 
ıu
->
check”
->
	`£tDÿchePÜt
(&ıu->
	`g‘D©aPÜt
());

306 
ıu
->
	`aùiv©eSge
(
O3CPU
::
IEWIdx
);

307 
	}
}

309 
	g‹m¶©e
<
şass
 
	gIm¶
>

311 
	gDeçuÉIEW
<
	gIm¶
>::
£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
)

313 
timeBufãr
 = 
tb_±r
;

316 
	gäomComm™
 = 
timeBufãr
->
g‘Wœe
(-
comm™ToIEWD–ay
);

319 
	gtoR’ame
 = 
timeBufãr
->
g‘Wœe
(0);

321 
	gtoF‘ch
 = 
timeBufãr
->
g‘Wœe
(0);

324 
	gš¡Queue
.
£tTimeBufãr
(
tb_±r
);

327 
	g‹m¶©e
<
şass
 
	gIm¶
>

329 
	gDeçuÉIEW
<
	gIm¶
>::
£tR’ameQueue
(
TimeBufãr
<
R’ameSŒuù
> *
rq_±r
)

331 
»ÇmeQueue
 = 
rq_±r
;

334 
	gäomR’ame
 = 
»ÇmeQueue
->
g‘Wœe
(-
»ÇmeToIEWD–ay
);

337 
	g‹m¶©e
<
şass
 
	gIm¶
>

339 
	gDeçuÉIEW
<
	gIm¶
>::
£tIEWQueue
(
TimeBufãr
<
IEWSŒuù
> *
iq_±r
)

341 
›wQueue
 = 
iq_±r
;

344 
	gtoComm™
 = 
›wQueue
->
g‘Wœe
(0);

347 
	g‹m¶©e
<
şass
 
	gIm¶
>

349 
	gDeçuÉIEW
<
	gIm¶
>::
£tAùiveTh»ads
(
li¡
<
Th»adID
> *
©_±r
)

351 
aùiveTh»ads
 = 
©_±r
;

353 
	gld¡Queue
.
£tAùiveTh»ads
(
©_±r
);

354 
	gš¡Queue
.
£tAùiveTh»ads
(
©_±r
);

357 
	g‹m¶©e
<
şass
 
	gIm¶
>

359 
	gDeçuÉIEW
<
	gIm¶
>::
	$£tScÜebßrd
(
ScÜebßrd
 *
sb_±r
)

361 
scÜebßrd
 = 
sb_±r
;

362 
	}
}

364 
	g‹m¶©e
 <
şass
 
	gIm¶
>

365 
boŞ


366 
	gDeçuÉIEW
<
	gIm¶
>::
	$isD¿šed
() const

368 
boŞ
 
	`d¿šed
(
ld¡Queue
.
	`isD¿šed
());

370 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

371 ià(!
š¡s
[
tid
].
	`em±y
()) {

372 
	`DPRINTF
(
D¿š
, "%i: In¡ nÙƒm±y.\n", 
tid
);

373 
d¿šed
 = 
çl£
;

375 ià(!
skidBufãr
[
tid
].
	`em±y
()) {

376 
	`DPRINTF
(
D¿š
, "%i: Skid bufã¸nÙƒm±y.\n", 
tid
);

377 
d¿šed
 = 
çl£
;

384 ià(
d¿šed
 && !
fuPoŞ
->
	`isD¿šed
()) {

385 
	`DPRINTF
(
D¿š
, "FU…ool still busy.\n");

386 
d¿šed
 = 
çl£
;

389  
d¿šed
;

390 
	}
}

392 
	g‹m¶©e
 <
şass
 
	gIm¶
>

394 
	gDeçuÉIEW
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

396 
	`as£¹
(
	`isD¿šed
());

398 
š¡Queue
.
	`d¿šSª™yCheck
();

399 
ld¡Queue
.
	`d¿šSª™yCheck
();

400 
	}
}

402 
	g‹m¶©e
 <
şass
 
	gIm¶
>

404 
	gDeçuÉIEW
<
	gIm¶
>::
	$keOv”From
()

407 
_¡©us
 = 
Aùive
;

408 
exeStus
 = 
RuÂšg
;

409 
wbStus
 = 
IdË
;

411 
š¡Queue
.
	`keOv”From
();

412 
ld¡Queue
.
	`keOv”From
();

413 
fuPoŞ
->
	`keOv”From
();

415 
	`¡¬tupSge
();

416 
ıu
->
	`aùiv™yThisCyşe
();

418 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

419 
di¥©chStus
[
tid
] = 
RuÂšg
;

420 
¡®ls
[
tid
].
comm™
 = 
çl£
;

421 
ãtchRedœeù
[
tid
] = 
çl£
;

424 
upd©eLSQNextCyşe
 = 
çl£
;

426 
i
 = 0; i < 
issueToExecQueue
.
	`g‘Size
(); ++i) {

427 
issueToExecQueue
.
	`advªû
();

429 
	}
}

431 
	g‹m¶©e
<
şass
 
	gIm¶
>

433 
	gDeçuÉIEW
<
	gIm¶
>::
	$squash
(
Th»adID
 
tid
)

435 
	`DPRINTF
(
IEW
, "[tid:%i]: Squashšg‡Î in¡ruùiÚs.\n", 
tid
);

438 
š¡Queue
.
	`squash
(
tid
);

441 
ld¡Queue
.
	`squash
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,id);

442 
upd©edQueues
 = 
Œue
;

445 
	`DPRINTF
(
IEW
, "[tid:%i]: Removing skidbuffer instructions until [sn:%i].\n",

446 
tid
, 
äomComm™
->
comm™Info
[tid].
dÚeSeqNum
);

448 !
skidBufãr
[
tid
].
	`em±y
()) {

449 ià(
skidBufãr
[
tid
].
	`äÚt
()->
	`isLßd
() ||

450 
skidBufãr
[
tid
].
	`äÚt
()->
	`isStÜe
() ) {

451 
toR’ame
->
›wInfo
[
tid
].
di¥©chedToLSQ
++;

454 
toR’ame
->
›wInfo
[
tid
].
di¥©ched
++;

456 
skidBufãr
[
tid
].
	`pİ
();

459 
	`em±yR’ameIn¡s
(
tid
);

460 
	}
}

462 
	g‹m¶©e
<
şass
 
	gIm¶
>

464 
	gDeçuÉIEW
<
	gIm¶
>::
	$squashDueToB¿nch
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
)

466 
	`DPRINTF
(
IEW
, "[tid:%i]: Squashing from‡ specific instruction, PC: %s "

467 "[¢:%i].\n", 
tid
, 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

469 ià(
toComm™
->
squash
[
tid
] =ğ
çl£
 ||

470 
š¡
->
£qNum
 < 
toComm™
->
squashedSeqNum
[
tid
]) {

471 
toComm™
->
squash
[
tid
] = 
Œue
;

472 
toComm™
->
squashedSeqNum
[
tid
] = 
š¡
->
£qNum
;

473 
toComm™
->
b¿nchTak’
[
tid
] = 
š¡
->
	`pcS‹
().
	`b¿nchšg
();

475 
TheISA
::
PCS‹
 
pc
 = 
š¡
->
	`pcS‹
();

476 
TheISA
::
	`advªûPC
(
pc
, 
š¡
->
¡©icIn¡
);

478 
toComm™
->
pc
[
tid
] =…c;

479 
toComm™
->
mi¥»diùIn¡
[
tid
] = 
š¡
;

480 
toComm™
->
šşudeSquashIn¡
[
tid
] = 
çl£
;

482 
wrÙeToTimeBufãr
 = 
Œue
;

485 
	}
}

487 
	g‹m¶©e
<
şass
 
	gIm¶
>

489 
	gDeçuÉIEW
<
	gIm¶
>::
	$squashDueToMemOrd”
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
)

491 
	`DPRINTF
(
IEW
, "[tid:%i]: Memory violation, squashing violator‡nd younger "

492 "š¡s, PC: % [¢:%i].\n", 
tid
, 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

499 ià(
toComm™
->
squash
[
tid
] =ğ
çl£
 ||

500 
š¡
->
£qNum
 <ğ
toComm™
->
squashedSeqNum
[
tid
]) {

501 
toComm™
->
squash
[
tid
] = 
Œue
;

503 
toComm™
->
squashedSeqNum
[
tid
] = 
š¡
->
£qNum
;

504 
toComm™
->
pc
[
tid
] = 
š¡
->
	`pcS‹
();

505 
toComm™
->
mi¥»diùIn¡
[
tid
] = 
NULL
;

508 
toComm™
->
šşudeSquashIn¡
[
tid
] = 
Œue
;

510 
wrÙeToTimeBufãr
 = 
Œue
;

512 
	}
}

514 
	g‹m¶©e
<
şass
 
	gIm¶
>

516 
	gDeçuÉIEW
<
	gIm¶
>::
	$squashDueToMemBlocked
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
)

518 
	`DPRINTF
(
IEW
, "[tid:%i]: Memory blocked, squashing†oad‡nd younger insts, "

519 "PC: % [¢:%i].\n", 
tid
, 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

520 ià(
toComm™
->
squash
[
tid
] =ğ
çl£
 ||

521 
š¡
->
£qNum
 < 
toComm™
->
squashedSeqNum
[
tid
]) {

522 
toComm™
->
squash
[
tid
] = 
Œue
;

524 
toComm™
->
squashedSeqNum
[
tid
] = 
š¡
->
£qNum
;

525 
toComm™
->
pc
[
tid
] = 
š¡
->
	`pcS‹
();

526 
toComm™
->
mi¥»diùIn¡
[
tid
] = 
NULL
;

529 
toComm™
->
šşudeSquashIn¡
[
tid
] = 
Œue
;

531 
ld¡Queue
.
	`£tLßdBlockedHªdËd
(
tid
);

533 
wrÙeToTimeBufãr
 = 
Œue
;

535 
	}
}

537 
	g‹m¶©e
<
şass
 
	gIm¶
>

539 
	gDeçuÉIEW
<
	gIm¶
>::
	$block
(
Th»adID
 
tid
)

541 
	`DPRINTF
(
IEW
, "[tid:%u]: Blockšg.\n", 
tid
);

543 ià(
di¥©chStus
[
tid
] !ğ
Blocked
 &&

544 
di¥©chStus
[
tid
] !ğ
Unblockšg
) {

545 
toR’ame
->
›wBlock
[
tid
] = 
Œue
;

546 
wrÙeToTimeBufãr
 = 
Œue
;

551 
	`skidIn£¹
(
tid
);

553 
di¥©chStus
[
tid
] = 
Blocked
;

554 
	}
}

556 
	g‹m¶©e
<
şass
 
	gIm¶
>

558 
	gDeçuÉIEW
<
	gIm¶
>::
	$unblock
(
Th»adID
 
tid
)

560 
	`DPRINTF
(
IEW
, "[tid:%i]: Reading instructions out ofhe skid "

561 "bufã¸%u.\n",
tid
,id);

565 ià(
skidBufãr
[
tid
].
	`em±y
()) {

566 
toR’ame
->
›wUnblock
[
tid
] = 
Œue
;

567 
wrÙeToTimeBufãr
 = 
Œue
;

568 
	`DPRINTF
(
IEW
, "[tid:%i]: DÚunblockšg.\n",
tid
);

569 
di¥©chStus
[
tid
] = 
RuÂšg
;

571 
	}
}

573 
	g‹m¶©e
<
şass
 
	gIm¶
>

575 
	gDeçuÉIEW
<
	gIm¶
>::
	$wakeD•’d’ts
(
DynIn¡PŒ
 &
š¡
)

577 
š¡Queue
.
	`wakeD•’d’ts
(
š¡
);

578 
	}
}

580 
	g‹m¶©e
<
şass
 
	gIm¶
>

582 
	gDeçuÉIEW
<
	gIm¶
>::
	$»scheduËMemIn¡
(
DynIn¡PŒ
 &
š¡
)

584 
š¡Queue
.
	`»scheduËMemIn¡
(
š¡
);

585 
	}
}

587 
	g‹m¶©e
<
şass
 
	gIm¶
>

589 
	gDeçuÉIEW
<
	gIm¶
>::
	$»¶ayMemIn¡
(
DynIn¡PŒ
 &
š¡
)

591 
š¡Queue
.
	`»¶ayMemIn¡
(
š¡
);

592 
	}
}

594 
	g‹m¶©e
<
şass
 
	gIm¶
>

596 
	gDeçuÉIEW
<
	gIm¶
>::
	$š¡ToComm™
(
DynIn¡PŒ
 &
š¡
)

608 (*
›wQueue
)[
wbCyşe
].
š¡s
[
wbNumIn¡
]) {

609 ++
wbNumIn¡
;

610 ià(
wbNumIn¡
 =ğ
wbWidth
) {

611 ++
wbCyşe
;

612 
wbNumIn¡
 = 0;

615 
	`as£¹
((
wbCyşe
 * 
wbWidth
 + 
wbNumIn¡
è<ğ
wbMax
);

618 
	`DPRINTF
(
IEW
, "Current wb cycle: %i, width: %i,‚umInst: %i\nwbActual:%i\n",

619 
wbCyşe
, 
wbWidth
, 
wbNumIn¡
, wbCycle * wbWidth + wbNumInst);

621 (*
›wQueue
)[
wbCyşe
].
š¡s
[
wbNumIn¡
] = 
š¡
;

622 (*
›wQueue
)[
wbCyşe
].
size
++;

623 
	}
}

625 
	g‹m¶©e
 <
şass
 
	gIm¶
>

627 
	gDeçuÉIEW
<
	gIm¶
>::
	$v®idIn¡sFromR’ame
()

629 
š¡_couÁ
 = 0;

631 
i
=0; i<
äomR’ame
->
size
; i++) {

632 ià(!
äomR’ame
->
š¡s
[
i
]->
	`isSquashed
())

633 
š¡_couÁ
++;

636  
š¡_couÁ
;

637 
	}
}

639 
	g‹m¶©e
<
şass
 
	gIm¶
>

641 
	gDeçuÉIEW
<
	gIm¶
>::
	$skidIn£¹
(
Th»adID
 
tid
)

643 
DynIn¡PŒ
 
š¡
 = 
NULL
;

645 !
š¡s
[
tid
].
	`em±y
()) {

646 
š¡
 = 
š¡s
[
tid
].
	`äÚt
();

648 
š¡s
[
tid
].
	`pİ
();

650 
	`DPRINTF
(
IEW
,"[tid:%i]: Inserting [sn:%lli] PC:%s into "

651 "di¥©ch skidBufã¸%i\n",
tid
, 
š¡
->
£qNum
,

652 
š¡
->
	`pcS‹
(),
tid
);

654 
skidBufãr
[
tid
].
	`push
(
š¡
);

657 
	`as£¹
(
skidBufãr
[
tid
].
	`size
(è<ğ
skidBufãrMax
 &&

659 
	}
}

661 
	g‹m¶©e
<
şass
 
	gIm¶
>

663 
	gDeçuÉIEW
<
	gIm¶
>::
	$skidCouÁ
()

665 
max
=0;

667 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

668 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

670 
th»ads
 !ğ
’d
) {

671 
Th»adID
 
tid
 = *
th»ads
++;

672 
th»ad_couÁ
 = 
skidBufãr
[
tid
].
	`size
();

673 ià(
max
 < 
th»ad_couÁ
)

674 
max
 = 
th»ad_couÁ
;

677  
max
;

678 
	}
}

680 
	g‹m¶©e
<
şass
 
	gIm¶
>

681 
boŞ


682 
	gDeçuÉIEW
<
	gIm¶
>::
	$skidsEm±y
()

684 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

685 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

687 
th»ads
 !ğ
’d
) {

688 
Th»adID
 
tid
 = *
th»ads
++;

690 ià(!
skidBufãr
[
tid
].
	`em±y
())

691  
çl£
;

694  
Œue
;

695 
	}
}

697 
	g‹m¶©e
 <
şass
 
	gIm¶
>

699 
	gDeçuÉIEW
<
	gIm¶
>::
	$upd©eStus
()

701 
boŞ
 
ªy_unblockšg
 = 
çl£
;

703 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

704 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

706 
th»ads
 !ğ
’d
) {

707 
Th»adID
 
tid
 = *
th»ads
++;

709 ià(
di¥©chStus
[
tid
] =ğ
Unblockšg
) {

710 
ªy_unblockšg
 = 
Œue
;

718 
š¡Queue
.
štIn¡QueueR—ds
++;

719 ià(
_¡©us
 =ğ
Aùive
 && !
š¡Queue
.
	`hasR—dyIn¡s
() &&

720 !
ld¡Queue
.
	`wlWB
(è&& !
ªy_unblockšg
) {

721 
	`DPRINTF
(
IEW
, "IEW switchingo idle\n");

723 
	`d—ùiv©eSge
();

725 
_¡©us
 = 
IÇùive
;

726 } ià(
_¡©us
 =ğ
IÇùive
 && (
š¡Queue
.
	`hasR—dyIn¡s
() ||

727 
ld¡Queue
.
	`wlWB
() ||

728 
ªy_unblockšg
)) {

730 
	`DPRINTF
(
IEW
, "IEW switchingo‡ctive\n");

732 
	`aùiv©eSge
();

734 
_¡©us
 = 
Aùive
;

736 
	}
}

738 
	g‹m¶©e
 <
şass
 
	gIm¶
>

740 
	gDeçuÉIEW
<
	gIm¶
>::
	$»£tEÁr›s
()

742 
š¡Queue
.
	`»£tEÁr›s
();

743 
ld¡Queue
.
	`»£tEÁr›s
();

744 
	}
}

746 
	g‹m¶©e
 <
şass
 
	gIm¶
>

748 
	gDeçuÉIEW
<
	gIm¶
>::
	$»adSÎSigÇls
(
Th»adID
 
tid
)

750 ià(
äomComm™
->
comm™Block
[
tid
]) {

751 
¡®ls
[
tid
].
comm™
 = 
Œue
;

754 ià(
äomComm™
->
comm™Unblock
[
tid
]) {

755 
	`as£¹
(
¡®ls
[
tid
].
comm™
);

756 
¡®ls
[
tid
].
comm™
 = 
çl£
;

758 
	}
}

760 
	g‹m¶©e
 <
şass
 
	gIm¶
>

761 
boŞ


762 
	gDeçuÉIEW
<
	gIm¶
>::
	$checkSÎ
(
Th»adID
 
tid
)

764 
boŞ
 
	`»t_v®
(
çl£
);

766 ià(
¡®ls
[
tid
].
comm™
) {

767 
	`DPRINTF
(
IEW
,"[tid:%i]: SÎ from Comm™ sgd‘eùed.\n",
tid
);

768 
»t_v®
 = 
Œue
;

769 } ià(
š¡Queue
.
	`isFuÎ
(
tid
)) {

770 
	`DPRINTF
(
IEW
,"[tid:%i]: SÎ: IQ i fuÎ.\n",
tid
);

771 
»t_v®
 = 
Œue
;

772 } ià(
ld¡Queue
.
	`isFuÎ
(
tid
)) {

773 
	`DPRINTF
(
IEW
,"[tid:%i]: SÎ: LSQ i fuÎ\n",
tid
);

775 ià(
ld¡Queue
.
	`numLßds
(
tid
) > 0 ) {

777 
	`DPRINTF
(
IEW
,"[tid:%i]: LSQ oldest†oad: [sn:%i] \n",

778 
tid
,
ld¡Queue
.
	`g‘LßdH—dSeqNum
(tid));

781 ià(
ld¡Queue
.
	`numStÜes
(
tid
) > 0) {

783 
	`DPRINTF
(
IEW
,"[tid:%i]: LSQ oldest store: [sn:%i] \n",

784 
tid
,
ld¡Queue
.
	`g‘StÜeH—dSeqNum
(tid));

787 
»t_v®
 = 
Œue
;

788 } ià(
ld¡Queue
.
	`isSÎed
(
tid
)) {

789 
	`DPRINTF
(
IEW
,"[tid:%i]: SÎ: LSQ sÎ d‘eùed.\n",
tid
);

790 
»t_v®
 = 
Œue
;

793  
»t_v®
;

794 
	}
}

796 
	g‹m¶©e
 <
şass
 
	gIm¶
>

798 
	gDeçuÉIEW
<
	gIm¶
>::
	$checkSigÇlsAndUpd©e
(
Th»adID
 
tid
)

807 
	`»adSÎSigÇls
(
tid
);

809 ià(
äomComm™
->
comm™Info
[
tid
].
squash
) {

810 
	`squash
(
tid
);

812 ià(
di¥©chStus
[
tid
] =ğ
Blocked
 ||

813 
di¥©chStus
[
tid
] =ğ
Unblockšg
) {

814 
toR’ame
->
›wUnblock
[
tid
] = 
Œue
;

815 
wrÙeToTimeBufãr
 = 
Œue
;

818 
di¥©chStus
[
tid
] = 
Squashšg
;

819 
ãtchRedœeù
[
tid
] = 
çl£
;

823 ià(
äomComm™
->
comm™Info
[
tid
].
robSquashšg
) {

824 
	`DPRINTF
(
IEW
, "[tid:%i]: ROB i ¡Èsquashšg.\n", 
tid
);

826 
di¥©chStus
[
tid
] = 
Squashšg
;

827 
	`em±yR’ameIn¡s
(
tid
);

828 
wrÙeToTimeBufãr
 = 
Œue
;

832 ià(
	`checkSÎ
(
tid
)) {

833 
	`block
(
tid
);

834 
di¥©chStus
[
tid
] = 
Blocked
;

838 ià(
di¥©chStus
[
tid
] =ğ
Blocked
) {

841 
	`DPRINTF
(
IEW
, "[tid:%i]: Done blocking, switchingo unblocking.\n",

842 
tid
);

844 
di¥©chStus
[
tid
] = 
Unblockšg
;

846 
	`unblock
(
tid
);

851 ià(
di¥©chStus
[
tid
] =ğ
Squashšg
) {

854 
	`DPRINTF
(
IEW
, "[tid:%i]: Done squashing, switchingo„unning.\n",

855 
tid
);

857 
di¥©chStus
[
tid
] = 
RuÂšg
;

861 
	}
}

863 
	g‹m¶©e
 <
şass
 
	gIm¶
>

865 
	gDeçuÉIEW
<
	gIm¶
>::
	$sÜtIn¡s
()

867 
š¡s_äom_»Çme
 = 
äomR’ame
->
size
;

868 #ifdeà
DEBUG


869 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++)

870 
	`as£¹
(
š¡s
[
tid
].
	`em±y
());

872 
i
 = 0; i < 
š¡s_äom_»Çme
; ++i) {

873 
š¡s
[
äomR’ame
->š¡s[
i
]->
th»adNumb”
].
	`push
(fromRename->insts[i]);

875 
	}
}

877 
	g‹m¶©e
 <
şass
 
	gIm¶
>

879 
	gDeçuÉIEW
<
	gIm¶
>::
	$em±yR’ameIn¡s
(
Th»adID
 
tid
)

881 
	`DPRINTF
(
IEW
, "[tid:%i]: Removšg incomšg„’amš¡ruùiÚs\n", 
tid
);

883 !
š¡s
[
tid
].
	`em±y
()) {

885 ià(
š¡s
[
tid
].
	`äÚt
()->
	`isLßd
() ||

886 
š¡s
[
tid
].
	`äÚt
()->
	`isStÜe
() ) {

887 
toR’ame
->
›wInfo
[
tid
].
di¥©chedToLSQ
++;

890 
toR’ame
->
›wInfo
[
tid
].
di¥©ched
++;

892 
š¡s
[
tid
].
	`pİ
();

894 
	}
}

896 
	g‹m¶©e
 <
şass
 
	gIm¶
>

898 
	gDeçuÉIEW
<
	gIm¶
>::
	$wakeCPU
()

900 
ıu
->
	`wakeCPU
();

901 
	}
}

903 
	g‹m¶©e
 <
şass
 
	gIm¶
>

905 
	gDeçuÉIEW
<
	gIm¶
>::
	$aùiv™yThisCyşe
()

907 
	`DPRINTF
(
Aùiv™y
, "Activityhis cycle.\n");

908 
ıu
->
	`aùiv™yThisCyşe
();

909 
	}
}

911 
	g‹m¶©e
 <
şass
 
	gIm¶
>

912 
šlše
 

913 
	gDeçuÉIEW
<
	gIm¶
>::
	$aùiv©eSge
()

915 
	`DPRINTF
(
Aùiv™y
, "Activating stage.\n");

916 
ıu
->
	`aùiv©eSge
(
O3CPU
::
IEWIdx
);

917 
	}
}

919 
	g‹m¶©e
 <
şass
 
	gIm¶
>

920 
šlše
 

921 
	gDeçuÉIEW
<
	gIm¶
>::
	$d—ùiv©eSge
()

923 
	`DPRINTF
(
Aùiv™y
, "Deactivating stage.\n");

924 
ıu
->
	`d—ùiv©eSge
(
O3CPU
::
IEWIdx
);

925 
	}
}

927 
	g‹m¶©e
<
şass
 
	gIm¶
>

929 
	gDeçuÉIEW
<
	gIm¶
>::
	$di¥©ch
(
Th»adID
 
tid
)

938 ià(
di¥©chStus
[
tid
] =ğ
Blocked
) {

939 ++
›wBlockCyşes
;

941 } ià(
di¥©chStus
[
tid
] =ğ
Squashšg
) {

942 ++
›wSquashCyşes
;

947 ià(
di¥©chStus
[
tid
] =ğ
RuÂšg
 ||

948 
di¥©chStus
[
tid
] =ğ
IdË
) {

949 
	`DPRINTF
(
IEW
, "[tid:%i] Not blocked, so‡ttemptingo„un "

950 "di¥©ch.\n", 
tid
);

952 
	`di¥©chIn¡s
(
tid
);

953 } ià(
di¥©chStus
[
tid
] =ğ
Unblockšg
) {

956 
	`as£¹
(!
	`skidsEm±y
());

961 
	`di¥©chIn¡s
(
tid
);

963 ++
›wUnblockCyşes
;

965 ià(
	`v®idIn¡sFromR’ame
()) {

968 
	`skidIn£¹
(
tid
);

971 
	`unblock
(
tid
);

973 
	}
}

975 
	g‹m¶©e
 <
şass
 
	gIm¶
>

977 
	gDeçuÉIEW
<
	gIm¶
>::
	$di¥©chIn¡s
(
Th»adID
 
tid
)

981 
¡d
::
queue
<
DynIn¡PŒ
> &
š¡s_to_di¥©ch
 =

982 
di¥©chStus
[
tid
] =ğ
Unblockšg
 ?

983 
skidBufãr
[
tid
] : 
š¡s
[tid];

985 
š¡s_to_add
 = 
š¡s_to_di¥©ch
.
	`size
();

987 
DynIn¡PŒ
 
š¡
;

988 
boŞ
 
add_to_iq
 = 
çl£
;

989 
dis_num_š¡
 = 0;

993  ; 
dis_num_š¡
 < 
š¡s_to_add
 &&

994 
dis_num_š¡
 < 
di¥©chWidth
;

995 ++
dis_num_š¡
)

997 
š¡
 = 
š¡s_to_di¥©ch
.
	`äÚt
();

999 ià(
di¥©chStus
[
tid
] =ğ
Unblockšg
) {

1000 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: Examining instruction from skid "

1001 "bufãr\n", 
tid
);

1005 
	`as£¹
(
š¡
);

1007 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: Adding PC %s [sn:%lli] [tid:%i]o "

1009 
tid
, 
š¡
->
	`pcS‹
(), in¡->
£qNum
, in¡->
th»adNumb”
);

1016 ià(
š¡
->
	`isSquashed
()) {

1017 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: Squashed instructionƒncountered, "

1018 "nÙ‡ddšgØIQ.\n", 
tid
);

1020 ++
›wDi¥SquashedIn¡s
;

1022 
š¡s_to_di¥©ch
.
	`pİ
();

1025 ià(
š¡
->
	`isLßd
(è|| in¡->
	`isStÜe
()) {

1026 
toR’ame
->
›wInfo
[
tid
].
di¥©chedToLSQ
++;

1028 
toR’ame
->
›wInfo
[
tid
].
di¥©ched
++;

1034 ià(
š¡Queue
.
	`isFuÎ
(
tid
)) {

1035 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: IQ ha becomfuÎ.\n", 
tid
);

1038 
	`block
(
tid
);

1043 
toR’ame
->
›wUnblock
[
tid
] = 
çl£
;

1045 ++
›wIQFuÎEv’ts
;

1047 } ià(
ld¡Queue
.
	`isFuÎ
(
tid
)) {

1048 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: LSQ ha becomfuÎ.\n",
tid
);

1051 
	`block
(
tid
);

1056 
toR’ame
->
›wUnblock
[
tid
] = 
çl£
;

1058 ++
›wLSQFuÎEv’ts
;

1063 ià(
š¡
->
	`isLßd
()) {

1064 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: Memory instruction "

1065 "’couÁ”ed,‡ddšgØLSQ.\n", 
tid
);

1069 
ld¡Queue
.
	`š£¹Lßd
(
š¡
);

1071 ++
›wDi¥LßdIn¡s
;

1073 
add_to_iq
 = 
Œue
;

1075 
toR’ame
->
›wInfo
[
tid
].
di¥©chedToLSQ
++;

1076 } ià(
š¡
->
	`isStÜe
()) {

1077 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: Memory instruction "

1078 "’couÁ”ed,‡ddšgØLSQ.\n", 
tid
);

1080 
ld¡Queue
.
	`š£¹StÜe
(
š¡
);

1082 ++
›wDi¥StÜeIn¡s
;

1084 ià(
š¡
->
	`isStÜeCÚd™iÚ®
()) {

1089 
š¡
->
	`£tCªComm™
();

1090 
š¡Queue
.
	`š£¹NÚS³c
(
š¡
);

1091 
add_to_iq
 = 
çl£
;

1093 ++
›wDi¥NÚS³cIn¡s
;

1095 
add_to_iq
 = 
Œue
;

1098 
toR’ame
->
›wInfo
[
tid
].
di¥©chedToLSQ
++;

1099 } ià(
š¡
->
	`isMemB¬r›r
(è|| in¡->
	`isWr™eB¬r›r
()) {

1101 
š¡
->
	`£tCªComm™
();

1102 
š¡Queue
.
	`š£¹B¬r›r
(
š¡
);

1103 
add_to_iq
 = 
çl£
;

1104 } ià(
š¡
->
	`isNİ
()) {

1105 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: Nop instructionƒncountered, "

1106 "skpšg.\n", 
tid
);

1108 
š¡
->
	`£tIssued
();

1109 
š¡
->
	`£tExecu‹d
();

1110 
š¡
->
	`£tCªComm™
();

1112 
š¡Queue
.
	`»cÜdProduûr
(
š¡
);

1114 
›wExecu‹dNİ
[
tid
]++;

1116 
add_to_iq
 = 
çl£
;

1117 } ià(
š¡
->
	`isExecu‹d
()) {

1118 
	`as£¹
(0 && "Instruction shouldn't beƒxecuted.\n");

1119 
	`DPRINTF
(
IEW
, "Issue: Executed branchƒncountered, "

1122 
š¡
->
	`£tIssued
();

1123 
š¡
->
	`£tCªComm™
();

1125 
š¡Queue
.
	`»cÜdProduûr
(
š¡
);

1127 
add_to_iq
 = 
çl£
;

1129 
add_to_iq
 = 
Œue
;

1131 ià(
š¡
->
	`isNÚS³cuÏtive
()) {

1132 
	`DPRINTF
(
IEW
, "[tid:%i]: Issue: Nonspeculative instruction "

1133 "’couÁ”ed, skpšg.\n", 
tid
);

1136 
š¡
->
	`£tCªComm™
();

1139 
š¡Queue
.
	`š£¹NÚS³c
(
š¡
);

1141 ++
›wDi¥NÚS³cIn¡s
;

1143 
add_to_iq
 = 
çl£
;

1148 ià(
add_to_iq
) {

1149 
š¡Queue
.
	`š£¹
(
š¡
);

1152 
š¡s_to_di¥©ch
.
	`pİ
();

1154 
toR’ame
->
›wInfo
[
tid
].
di¥©ched
++;

1156 ++
›wDi¥©chedIn¡s
;

1158 #ià
TRACING_ON


1159 
š¡
->
di¥©chTick
 = 
	`curTick
(è- in¡->
ãtchTick
;

1163 ià(!
š¡s_to_di¥©ch
.
	`em±y
()) {

1164 
	`DPRINTF
(
IEW
,"[tid:%i]: Issue: Bªdwidth FuÎ. Blockšg.\n", 
tid
);

1165 
	`block
(
tid
);

1166 
toR’ame
->
›wUnblock
[
tid
] = 
çl£
;

1169 ià(
di¥©chStus
[
tid
] =ğ
IdË
 && 
dis_num_š¡
) {

1170 
di¥©chStus
[
tid
] = 
RuÂšg
;

1172 
upd©edQueues
 = 
Œue
;

1175 
dis_num_š¡
 = 0;

1176 
	}
}

1178 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1180 
	gDeçuÉIEW
<
	gIm¶
>::
	$´štAvaabËIn¡s
()

1182 
š¡
 = 0;

1184 
¡d
::
cout
 << "Available Instructions: ";

1186 
äomIssue
->
š¡s
[
š¡
]) {

1188 ià(
š¡
%3==0è
¡d
::
cout
 << "\n\t";

1190 
¡d
::
cout
 << "PC: " << 
äomIssue
->
š¡s
[
š¡
]->
	`pcS‹
()

1191 << " TN: " << 
äomIssue
->
š¡s
[
š¡
]->
th»adNumb”


1192 << " SN: " << 
äomIssue
->
š¡s
[
š¡
]->
£qNum
 << " | ";

1194 
š¡
++;

1198 
¡d
::
cout
 << "\n";

1199 
	}
}

1201 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1203 
	gDeçuÉIEW
<
	gIm¶
>::
	$execu‹In¡s
()

1205 
wbNumIn¡
 = 0;

1206 
wbCyşe
 = 0;

1208 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

1209 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

1211 
th»ads
 !ğ
’d
) {

1212 
Th»adID
 
tid
 = *
th»ads
++;

1213 
ãtchRedœeù
[
tid
] = 
çl£
;

1221 
š¡s_to_execu‹
 = 
äomIssue
->
size
;

1222 
š¡_num
 = 0;

1223 ; 
š¡_num
 < 
š¡s_to_execu‹
;

1224 ++
š¡_num
) {

1226 
	`DPRINTF
(
IEW
, "Execute: Executing instructions from IQ.\n");

1228 
DynIn¡PŒ
 
š¡
 = 
š¡Queue
.
	`g‘In¡ToExecu‹
();

1230 
	`DPRINTF
(
IEW
, "Execute: Processing PC %s, [tid:%i] [sn:%i].\n",

1231 
š¡
->
	`pcS‹
(), in¡->
th»adNumb”
,š¡->
£qNum
);

1234 ià(
š¡
->
	`isSquashed
()) {

1235 
	`DPRINTF
(
IEW
, "Execute: Instruction was squashed. PC: %s, [tid:%i]"

1236 " [¢:%i]\n", 
š¡
->
	`pcS‹
(), in¡->
th»adNumb”
,

1237 
š¡
->
£qNum
);

1241 
š¡
->
	`£tExecu‹d
();

1245 
š¡
->
	`£tCªComm™
();

1247 ++
›wExecSquashedIn¡s
;

1249 
	`deüWb
(
š¡
->
£qNum
);

1253 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

1258 ià(
š¡
->
	`isMemRef
()) {

1259 
	`DPRINTF
(
IEW
, "Execute: Calculating‡ddress for memory "

1263 ià(
š¡
->
	`isLßd
()) {

1266 
çuÉ
 = 
ld¡Queue
.
	`execu‹Lßd
(
š¡
);

1268 ià(
š¡
->
	`isT¿n¦©iÚD–ayed
() &&

1269 
çuÉ
 =ğ
NoFauÉ
) {

1272 
	`DPRINTF
(
IEW
, "Execute: Delayedranslation, deferring "

1274 
š¡Queue
.
	`deãrMemIn¡
(
š¡
);

1278 ià(
š¡
->
	`isD©aP»ãtch
(è|| in¡->
	`isIn¡P»ãtch
()) {

1279 
š¡
->
çuÉ
 = 
NoFauÉ
;

1281 } ià(
š¡
->
	`isStÜe
()) {

1282 
çuÉ
 = 
ld¡Queue
.
	`execu‹StÜe
(
š¡
);

1284 ià(
š¡
->
	`isT¿n¦©iÚD–ayed
() &&

1285 
çuÉ
 =ğ
NoFauÉ
) {

1288 
	`DPRINTF
(
IEW
, "Execute: Delayedranslation, deferring "

1290 
š¡Queue
.
	`deãrMemIn¡
(
š¡
);

1295 ià(
çuÉ
 !ğ
NoFauÉ
 || 
š¡
->
	`»adP»diÿ‹
(è=ğ
çl£
 ||

1296 !
š¡
->
	`isStÜeCÚd™iÚ®
()) {

1301 
š¡
->
	`£tExecu‹d
();

1302 
	`š¡ToComm™
(
š¡
);

1303 
	`aùiv™yThisCyşe
();

1310 
	`·nic
("Unexpected memoryype!\n");

1318 ià(
š¡
->
	`g‘FauÉ
(è=ğ
NoFauÉ
) {

1319 
š¡
->
	`execu‹
();

1320 ià(
š¡
->
	`»adP»diÿ‹
(è=ğ
çl£
)

1321 
š¡
->
	`fÜw¬dOldRegs
();

1324 
š¡
->
	`£tExecu‹d
();

1326 
	`š¡ToComm™
(
š¡
);

1329 
	`upd©eExeIn¡Sts
(
š¡
);

1339 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1341 ià(!
ãtchRedœeù
[
tid
] ||

1342 !
toComm™
->
squash
[
tid
] ||

1343 
toComm™
->
squashedSeqNum
[
tid
] > 
š¡
->
£qNum
) {

1347 
boŞ
 
lßdNÙExecu‹d
 = !
š¡
->
	`isExecu‹d
(è&& in¡->
	`isLßd
();

1349 ià(
š¡
->
	`mi¥»diùed
(è&& !
lßdNÙExecu‹d
) {

1350 
ãtchRedœeù
[
tid
] = 
Œue
;

1352 
	`DPRINTF
(
IEW
, "Execute: Branch mispredict detected.\n");

1353 
	`DPRINTF
(
IEW
, "Predictedarget was PC: %s.\n",

1354 
š¡
->
	`»adP»dT¬g
());

1355 
	`DPRINTF
(
IEW
, "Execute: Redirecting fetcho PC: %s.\n",

1356 
š¡
->
	`pcS‹
());

1358 
	`squashDueToB¿nch
(
š¡
, 
tid
);

1360 ià(
š¡
->
	`»adP»dTak’
()) {

1361 
´ediùedTak’IncÜ»ù
++;

1363 
´ediùedNÙTak’IncÜ»ù
++;

1365 } ià(
ld¡Queue
.
	`viŞ©iÚ
(
tid
)) {

1366 
	`as£¹
(
š¡
->
	`isMemRef
());

1370 
DynIn¡PŒ
 
viŞ©Ü
;

1371 
viŞ©Ü
 = 
ld¡Queue
.
	`g‘MemD•ViŞ©Ü
(
tid
);

1373 
	`DPRINTF
(
IEW
, "LDSTQ detected‡ violation. Violator PC: %s "

1375 
viŞ©Ü
->
	`pcS‹
(), viŞ©Ü->
£qNum
,

1376 
š¡
->
	`pcS‹
(), in¡->
£qNum
, in¡->
physEffAddr
);

1378 
ãtchRedœeù
[
tid
] = 
Œue
;

1381 
š¡Queue
.
	`viŞ©iÚ
(
š¡
, 
viŞ©Ü
);

1384 
	`squashDueToMemOrd”
(
viŞ©Ü
, 
tid
);

1386 ++
memOrd”ViŞ©iÚEv’ts
;

1387 } ià(
ld¡Queue
.
	`lßdBlocked
(
tid
) &&

1388 !
ld¡Queue
.
	`isLßdBlockedHªdËd
(
tid
)) {

1389 
ãtchRedœeù
[
tid
] = 
Œue
;

1391 
	`DPRINTF
(
IEW
, "Load operation couldn'tƒxecute becausehe "

1393 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

1395 
	`squashDueToMemBlocked
(
š¡
, 
tid
);

1400 ià(
ld¡Queue
.
	`viŞ©iÚ
(
tid
)) {

1401 
	`as£¹
(
š¡
->
	`isMemRef
());

1403 
DynIn¡PŒ
 
viŞ©Ü
 = 
ld¡Queue
.
	`g‘MemD•ViŞ©Ü
(
tid
);

1405 
	`DPRINTF
(
IEW
, "LDSTQ detected‡ violation. Violator PC: "

1407 
viŞ©Ü
->
	`pcS‹
(), 
š¡
->pcState(),

1408 
š¡
->
physEffAddr
);

1409 
	`DPRINTF
(
IEW
, "Violation will‚ot be handled because "

1412 ++
memOrd”ViŞ©iÚEv’ts
;

1414 ià(
ld¡Queue
.
	`lßdBlocked
(
tid
) &&

1415 !
ld¡Queue
.
	`isLßdBlockedHªdËd
(
tid
)) {

1416 
	`DPRINTF
(
IEW
, "Load operation couldn'tƒxecute becausehe "

1418 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

1419 
	`DPRINTF
(
IEW
, "Blocked†oad will‚ot be handled because "

1422 
ld¡Queue
.
	`£tLßdBlockedHªdËd
(
tid
);

1429 ià(
š¡_num
) {

1430 ià(
exeStus
 =ğ
IdË
) {

1431 
exeStus
 = 
RuÂšg
;

1434 
upd©edQueues
 = 
Œue
;

1436 
ıu
->
	`aùiv™yThisCyşe
();

1442 
wbNumIn¡
 = 0;

1444 
	}
}

1446 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1448 
	gDeçuÉIEW
<
	gIm¶
>::
	$wr™ebackIn¡s
()

1455 
š¡_num
 = 0; in¡_num < 
wbWidth
 &&

1456 
toComm™
->
š¡s
[
š¡_num
]; inst_num++) {

1457 
DynIn¡PŒ
 
š¡
 = 
toComm™
->
š¡s
[
š¡_num
];

1458 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1460 
	`DPRINTF
(
IEW
, "Sending instructionso commit, [sn:%lli] PC %s.\n",

1461 
š¡
->
£qNum
, in¡->
	`pcS‹
());

1463 
›wIn¡sToComm™
[
tid
]++;

1470 ià(!
š¡
->
	`isSquashed
(è&& in¡->
	`isExecu‹d
(è&& in¡->
	`g‘FauÉ
(è=ğ
NoFauÉ
) {

1471 
d•’d’ts
 = 
š¡Queue
.
	`wakeD•’d’ts
(
š¡
);

1473 
i
 = 0; i < 
š¡
->
	`numDe¡Regs
(); i++) {

1475 
	`DPRINTF
(
IEW
,"Setting Destination Register %i\n",

1476 
š¡
->
	`»ÇmedDe¡RegIdx
(
i
));

1477 
scÜebßrd
->
	`£tReg
(
š¡
->
	`»ÇmedDe¡RegIdx
(
i
));

1480 ià(
d•’d’ts
) {

1481 
´oduûrIn¡
[
tid
]++;

1482 
cÚsum”In¡
[
tid
]+ğ
d•’d’ts
;

1484 
wr™ebackCouÁ
[
tid
]++;

1487 
	`deüWb
(
š¡
->
£qNum
);

1489 
	}
}

1491 
	g‹m¶©e
<
şass
 
	gIm¶
>

1493 
	gDeçuÉIEW
<
	gIm¶
>::
	$tick
()

1495 
wbNumIn¡
 = 0;

1496 
wbCyşe
 = 0;

1498 
wrÙeToTimeBufãr
 = 
çl£
;

1499 
upd©edQueues
 = 
çl£
;

1501 
	`sÜtIn¡s
();

1504 
fuPoŞ
->
	`´oûssF»eUn™s
();

1506 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

1507 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

1510 
th»ads
 !ğ
’d
) {

1511 
Th»adID
 
tid
 = *
th»ads
++;

1513 
	`DPRINTF
(
IEW
,"Issue: Proûssšg [tid:%i]\n",
tid
);

1515 
	`checkSigÇlsAndUpd©e
(
tid
);

1516 
	`di¥©ch
(
tid
);

1519 ià(
exeStus
 !ğ
Squashšg
) {

1520 
	`execu‹In¡s
();

1522 
	`wr™ebackIn¡s
();

1527 
š¡Queue
.
	`scheduËR—dyIn¡s
();

1531 
issueToExecQueue
.
	`advªû
();

1534 
boŞ
 
brßdÿ¡_ä“_’Œ›s
 = 
çl£
;

1536 ià(
upd©edQueues
 || 
exeStus
 =ğ
RuÂšg
 || 
upd©eLSQNextCyşe
) {

1537 
exeStus
 = 
IdË
;

1538 
upd©eLSQNextCyşe
 = 
çl£
;

1540 
brßdÿ¡_ä“_’Œ›s
 = 
Œue
;

1544 
ld¡Queue
.
	`wr™ebackStÜes
();

1551 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

1552 
th»ads
 !ğ
’d
) {

1553 
Th»adID
 
tid
 = (*
th»ads
++);

1555 
	`DPRINTF
(
IEW
,"Proûssšg [tid:%i]\n",
tid
);

1558 ià(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
 != 0 &&

1559 !
äomComm™
->
comm™Info
[
tid
].
squash
 &&

1560 !
äomComm™
->
comm™Info
[
tid
].
robSquashšg
) {

1562 
ld¡Queue
.
	`comm™StÜes
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,tid);

1564 
ld¡Queue
.
	`comm™Lßds
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,tid);

1566 
upd©eLSQNextCyşe
 = 
Œue
;

1567 
š¡Queue
.
	`comm™
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,tid);

1570 ià(
äomComm™
->
comm™Info
[
tid
].
nÚS³cSeqNum
 != 0) {

1573 ià(
äomComm™
->
comm™Info
[
tid
].
unÿched
) {

1574 
š¡Queue
.
	`»¶ayMemIn¡
(
äomComm™
->
comm™Info
[
tid
].
unÿchedLßd
);

1575 
äomComm™
->
comm™Info
[
tid
].
unÿchedLßd
->
	`£tAtComm™
();

1577 
š¡Queue
.
	`scheduËNÚS³c
(

1578 
äomComm™
->
comm™Info
[
tid
].
nÚS³cSeqNum
);

1582 ià(
brßdÿ¡_ä“_’Œ›s
) {

1583 
toF‘ch
->
›wInfo
[
tid
].
iqCouÁ
 =

1584 
š¡Queue
.
	`g‘CouÁ
(
tid
);

1585 
toF‘ch
->
›wInfo
[
tid
].
ld¡qCouÁ
 =

1586 
ld¡Queue
.
	`g‘CouÁ
(
tid
);

1588 
toR’ame
->
›wInfo
[
tid
].
u£dIQ
 = 
Œue
;

1589 
toR’ame
->
›wInfo
[
tid
].
ä“IQEÁr›s
 =

1590 
š¡Queue
.
	`numF»eEÁr›s
();

1591 
toR’ame
->
›wInfo
[
tid
].
u£dLSQ
 = 
Œue
;

1592 
toR’ame
->
›wInfo
[
tid
].
ä“LSQEÁr›s
 =

1593 
ld¡Queue
.
	`numF»eEÁr›s
(
tid
);

1595 
wrÙeToTimeBufãr
 = 
Œue
;

1598 
	`DPRINTF
(
IEW
, "[tid:%i], Dispatch dispatched %i instructions.\n",

1599 
tid
, 
toR’ame
->
›wInfo
[tid].
di¥©ched
);

1602 
	`DPRINTF
(
IEW
, "IQ has %i freeƒntries (Can schedule: %i). "

1604 
š¡Queue
.
	`numF»eEÁr›s
(), in¡Queue.
	`hasR—dyIn¡s
(),

1605 
ld¡Queue
.
	`numF»eEÁr›s
());

1607 
	`upd©eStus
();

1609 ià(
wrÙeToTimeBufãr
) {

1610 
	`DPRINTF
(
Aùiv™y
, "Activityhis cycle.\n");

1611 
ıu
->
	`aùiv™yThisCyşe
();

1613 
	}
}

1615 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1617 
	gDeçuÉIEW
<
	gIm¶
>::
	$upd©eExeIn¡Sts
(
DynIn¡PŒ
 &
š¡
)

1619 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1621 
›wExecu‹dIn¡s
++;

1623 #ià
TRACING_ON


1624 ià(
	`DTRACE
(
O3PeV›w
)) {

1625 
š¡
->
com¶‘eTick
 = 
	`curTick
(è- in¡->
ãtchTick
;

1632 ià(
š¡
->
	`isCÚŒŞ
())

1633 
›wExecu‹dB¿nches
[
tid
]++;

1638 ià(
š¡
->
	`isMemRef
()) {

1639 
›wExecu‹dRefs
[
tid
]++;

1641 ià(
š¡
->
	`isLßd
()) {

1642 
›wExecLßdIn¡s
[
tid
]++;

1645 
	}
}

1647 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1649 
	gDeçuÉIEW
<
	gIm¶
>::
	$checkMi¥»diùiÚ
(
DynIn¡PŒ
 &
š¡
)

1651 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1653 ià(!
ãtchRedœeù
[
tid
] ||

1654 !
toComm™
->
squash
[
tid
] ||

1655 
toComm™
->
squashedSeqNum
[
tid
] > 
š¡
->
£qNum
) {

1657 ià(
š¡
->
	`mi¥»diùed
()) {

1658 
ãtchRedœeù
[
tid
] = 
Œue
;

1660 
	`DPRINTF
(
IEW
, "Execute: Branch mispredict detected.\n");

1661 
	`DPRINTF
(
IEW
, "Predictedarget was PC:%#x, NPC:%#x.\n",

1662 
š¡
->
	`´edIn¡Addr
(), in¡->
	`´edNextIn¡Addr
());

1663 
	`DPRINTF
(
IEW
, "Execute: Redirecting fetcho PC: %#x,"

1664 " NPC: %#x.\n", 
š¡
->
	`ÃxtIn¡Addr
(),

1665 
š¡
->
	`ÃxtIn¡Addr
());

1667 
	`squashDueToB¿nch
(
š¡
, 
tid
);

1669 ià(
š¡
->
	`»adP»dTak’
()) {

1670 
´ediùedTak’IncÜ»ù
++;

1672 
´ediùedNÙTak’IncÜ»ù
++;

1676 
	}
}

	@o3/impl.hh

31 #iâdeà
__CPU_O3_IMPL_HH__


32 
	#__CPU_O3_IMPL_HH__


	)

34 
	~"¬ch/i§_Œa™s.hh
"

35 
	~"cÚfig/the_i§.hh
"

36 
	~"ıu/o3/ıu_pŞicy.hh
"

39 
	g‹m¶©e
 <
şass
 
	gIm¶
>

40 
şass
 
	gBa£O3DynIn¡
;

42 
	g‹m¶©e
 <
şass
 
	gIm¶
>

43 
şass
 
	gFuÎO3CPU
;

53 
	sO3CPUIm¶


56 
	mTheISA
::
	tMachIn¡
 MachInst;

59 
	mSim¶eCPUPŞicy
<
	tO3CPUIm¶
> 
	tCPUPŞ
;

62 
	mBa£O3DynIn¡
<
	tO3CPUIm¶
> 
	tDynIn¡
;

67 
	mRefCouÁšgPŒ
<
	tDynIn¡
> 
	tDynIn¡PŒ
;

70 
	mFuÎO3CPU
<
	tO3CPUIm¶
> 
	tO3CPU
;

76 
O3CPU
 
	tCPUTy³
;

79 
	mMaxWidth
 = 8,

80 
	mMaxTh»ads
 = 4

	@o3/inst_queue.cc

31 
	~"ıu/o3/š¡_queue_im¶.hh
"

32 
	~"ıu/o3/i§_¥ecific.hh
"

35 
‹m¶©e
 
şass
 
	gIn¡ruùiÚQueue
<
	gO3CPUIm¶
>;

	@o3/inst_queue.hh

44 #iâdeà
__CPU_O3_INST_QUEUE_HH__


45 
	#__CPU_O3_INST_QUEUE_HH__


	)

47 
	~<li¡
>

48 
	~<m­
>

49 
	~<queue
>

50 
	~<veùÜ
>

52 
	~"ba£/¡©i¡ics.hh
"

53 
	~"ba£/ty³s.hh
"

54 
	~"ıu/o3/d•_g¿ph.hh
"

55 
	~"ıu/š¡_£q.hh
"

56 
	~"ıu/İ_şass.hh
"

57 
	~"ıu/timebuf.hh
"

58 
	~"sim/ev’tq.hh
"

60 
	gD”ivO3CPUP¬ams
;

61 
şass
 
	gFUPoŞ
;

62 
şass
 
	gMemIÁ”çû
;

81 
	g‹m¶©e
 <
şass
 
	gIm¶
>

82 şas 
	cIn¡ruùiÚQueue


84 
	mpublic
:

86 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

87 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

89 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tIEW
 IEW;

90 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tMemD•Un™
 MemDepUnit;

91 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tIssueSŒuù
 IssueStruct;

92 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tTimeSŒuù
 TimeStruct;

95 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

98 şas 
	cFUCom¶‘iÚ
 : 
public
 
Ev’t
 {

99 
´iv©e
:

101 
DynIn¡PŒ
 
š¡
;

104 
	mfuIdx
;

107 
	mIn¡ruùiÚQueue
<
	mIm¶
> *
	miqPŒ
;

112 
boŞ
 
	mä“FU
;

114 
	mpublic
:

116 
FUCom¶‘iÚ
(
DynIn¡PŒ
 &
_š¡
, 
fu_idx
,

117 
In¡ruùiÚQueue
<
Im¶
> *
iq_±r
);

119 
vœtu®
 
´oûss
();

120 
vœtu®
 cÚ¡ *
desütiÚ
() const;

121 
£tF»eFU
(è{ 
	mä“FU
 = 
Œue
; }

125 
In¡ruùiÚQueue
(
O3CPU
 *
ıu_±r
, 
IEW
 *
›w_±r
, 
D”ivO3CPUP¬ams
 *
·¿ms
);

128 ~
In¡ruùiÚQueue
();

131 
	g¡d
::
¡ršg
 
	$Çme
() const;

134 
	`»gSts
();

137 
	`»£tS‹
();

140 
	`£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

143 
	`£tIssueToExecu‹Queue
(
TimeBufãr
<
IssueSŒuù
> *
i2eQueue
);

146 
	`£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
);

149 
	$d¿šSª™yCheck
() const;

152 
	`keOv”From
();

155 
	`’ŒyAmouÁ
(
Th»adID
 
num_th»ads
);

158 
	`»£tEÁr›s
();

161 
	`numF»eEÁr›s
();

164 
	`numF»eEÁr›s
(
Th»adID
 
tid
);

167 
boŞ
 
	`isFuÎ
();

170 
boŞ
 
	`isFuÎ
(
Th»adID
 
tid
);

173 
boŞ
 
	`hasR—dyIn¡s
();

176 
	`š£¹
(
DynIn¡PŒ
 &
Ãw_š¡
);

179 
	`š£¹NÚS³c
(
DynIn¡PŒ
 &
Ãw_š¡
);

184 
	`š£¹B¬r›r
(
DynIn¡PŒ
 &
b¬r_š¡
);

189 
DynIn¡PŒ
 
	`g‘In¡ToExecu‹
();

194 
DynIn¡PŒ
 
	`g‘Deã¼edMemIn¡ToExecu‹
();

200 
	$»cÜdProduûr
(
DynIn¡PŒ
 &
š¡
)

201 { 
	`addToProduûrs
(
š¡
); 
	}
}

204 
´oûssFUCom¶‘iÚ
(
DynIn¡PŒ
 &
š¡
, 
fu_idx
);

210 
scheduËR—dyIn¡s
();

213 
scheduËNÚS³c
(cÚ¡ 
In¡SeqNum
 &
š¡
);

219 
comm™
(cÚ¡ 
In¡SeqNum
 &
š¡
, 
Th»adID
 
tid
 = 0);

222 
wakeD•’d’ts
(
DynIn¡PŒ
 &
com¶‘ed_š¡
);

225 
addR—dyMemIn¡
(
DynIn¡PŒ
 &
»ady_š¡
);

231 
»scheduËMemIn¡
(
DynIn¡PŒ
 &
»sched_š¡
);

234 
»¶ayMemIn¡
(
DynIn¡PŒ
 &
»¶ay_š¡
);

237 
com¶‘eMemIn¡
(
DynIn¡PŒ
 &
com¶‘ed_š¡
);

243 
deãrMemIn¡
(
DynIn¡PŒ
 &
deã¼ed_š¡
);

246 
viŞ©iÚ
(
DynIn¡PŒ
 &
¡Üe
, DynIn¡PŒ &
çuÉšg_lßd
);

252 
squash
(
Th»adID
 
tid
);

255 
	$g‘CouÁ
(
Th»adID
 
tid
è{  
couÁ
[tid]; 
	}
};

258 
´štIn¡s
();

260 
	g´iv©e
:

262 
doSquash
(
Th»adID
 
tid
);

269 
O3CPU
 *
	gıu
;

272 
MemIÁ”çû
 *
	gdÿcheIÁ”çû
;

275 
IEW
 *
	g›wSge
;

280 
MemD•Un™
 
	gmemD•Un™
[
Im¶
::
MaxTh»ads
];

285 
	gTimeBufãr
<
	gIssueSŒuù
> *
	gissueToExecu‹Queue
;

288 
	gTimeBufãr
<
	gTimeSŒuù
> *
	gtimeBufãr
;

291 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomComm™
;

294 
FUPoŞ
 *
	gfuPoŞ
;

301 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
[
Im¶
::
MaxTh»ads
];

304 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡sToExecu‹
;

309 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
deã¼edMemIn¡s
;

318 
	spqCom·»
 {

319 
boŞ
 
İ”©Ü
(è(cÚ¡ 
	gDynIn¡PŒ
 &
	glhs
, cÚ¡ DynIn¡PŒ &
	grhs
) const

321  
	glhs
->
	g£qNum
 > 
	grhs
->seqNum;

325 
	g¡d
::
	t´iÜ™y_queue
<
	tDynIn¡PŒ
, 
	t¡d
::
	tveùÜ
<DynIn¡PŒ>, 
	tpqCom·»
>

326 
	tR—dyIn¡Queue
;

331 
R—dyIn¡Queue
 
	g»adyIn¡s
[
Num_OpCÏs£s
];

340 
	g¡d
::
m­
<
In¡SeqNum
, 
	gDynIn¡PŒ
> 
	gnÚS³cIn¡s
;

342 
ty³Çme
 
	t¡d
::
	tm­
<
	tIn¡SeqNum
, 
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tNÚS³cM­It
;

345 
	sLi¡Ord”EÁry
 {

346 
OpCÏss
 
	gqueueTy³
;

347 
In¡SeqNum
 
	gŞde¡In¡
;

357 
	g¡d
::
li¡
<
Li¡Ord”EÁry
> 
li¡Ord”
;

359 
ty³Çme
 
	t¡d
::
	tli¡
<
	tLi¡Ord”EÁry
>::
	t™”©Ü
 
	tLi¡Ord”It
;

362 
boŞ
 
	gqueueOnLi¡
[
Num_OpCÏs£s
];

367 
Li¡Ord”It
 
	g»adyIt
[
Num_OpCÏs£s
];

370 
addToOrd”Li¡
(
OpCÏss
 
İ_şass
);

376 
moveToYoung”In¡
(
Li¡Ord”It
 
age_Üd”_™
);

378 
	gD•’d’cyG¿ph
<
	gDynIn¡PŒ
> 
	gd•’dG¿ph
;

385 
	eIQPŞicy
 {

386 
	gDyÇmic
,

387 
	gP¬t™iÚed
,

388 
	gTh»shŞd


392 
IQPŞicy
 
	giqPŞicy
;

395 
Th»adID
 
	gnumTh»ads
;

398 
	g¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

401 
	gcouÁ
[
Im¶
::
MaxTh»ads
];

404 
	gmaxEÁr›s
[
Im¶
::
MaxTh»ads
];

407 
	gä“EÁr›s
;

410 
	gnumEÁr›s
;

413 
	gtÙ®Width
;

416 
	gnumPhysRegs
;

421 
Cyşes
 
	gcomm™ToIEWD–ay
;

424 
In¡SeqNum
 
	gsquashedSeqNum
[
Im¶
::
MaxTh»ads
];

432 
	g¡d
::
veùÜ
<
boŞ
> 
»gScÜebßrd
;

435 
boŞ
 
addToD•’d’ts
(
DynIn¡PŒ
 &
Ãw_š¡
);

438 
addToProduûrs
(
DynIn¡PŒ
 &
Ãw_š¡
);

441 
addIfR—dy
(
DynIn¡PŒ
 &
š¡
);

447 
couÁIn¡s
();

453 
dumpLi¡s
();

458 
dumpIn¡s
();

461 
	gSts
::
SÿÏr
 
iqIn¡sAdded
;

463 
	gSts
::
SÿÏr
 
iqNÚS³cIn¡sAdded
;

465 
	gSts
::
SÿÏr
 
iqIn¡sIssued
;

467 
	gSts
::
SÿÏr
 
iqIÁIn¡sIssued
;

469 
	gSts
::
SÿÏr
 
iqFlßtIn¡sIssued
;

471 
	gSts
::
SÿÏr
 
iqB¿nchIn¡sIssued
;

473 
	gSts
::
SÿÏr
 
iqMemIn¡sIssued
;

475 
	gSts
::
SÿÏr
 
iqMiscIn¡sIssued
;

477 
	gSts
::
SÿÏr
 
iqSquashedIn¡sIssued
;

479 
	gSts
::
SÿÏr
 
iqSquashedIn¡sExamšed
;

483 
	gSts
::
SÿÏr
 
iqSquashedO³¿ndsExamšed
;

486 
	gSts
::
SÿÏr
 
iqSquashedNÚS³cRemoved
;

494 
	gSts
::
Di¡ributiÚ
 
numIssuedDi¡
;

503 
	gSts
::
VeùÜ
 
¡©FuBusy
;

506 
	gSts
::
VeùÜ2d
 
¡©IssuedIn¡Ty³
;

509 
	gSts
::
FÜmuÏ
 
issueR©e
;

512 
	gSts
::
VeùÜ
 
fuBusy
;

514 
	gSts
::
FÜmuÏ
 
fuBusyR©e
;

515 
	gpublic
:

516 
Sts
::
SÿÏr
 
štIn¡QueueR—ds
;

517 
	gSts
::
SÿÏr
 
štIn¡QueueWr™es
;

518 
	gSts
::
SÿÏr
 
štIn¡QueueWakeupAcûs£s
;

519 
	gSts
::
SÿÏr
 
åIn¡QueueR—ds
;

520 
	gSts
::
SÿÏr
 
åIn¡QueueWr™es
;

521 
	gSts
::
SÿÏr
 
åIn¡QueueWakeupQcûs£s
;

523 
	gSts
::
SÿÏr
 
štAluAcûs£s
;

524 
	gSts
::
SÿÏr
 
åAluAcûs£s
;

	@o3/inst_queue_impl.hh

45 #iâdeà
__CPU_O3_INST_QUEUE_IMPL_HH__


46 
	#__CPU_O3_INST_QUEUE_IMPL_HH__


	)

48 
	~<lim™s
>

49 
	~<veùÜ
>

51 
	~"ıu/o3/fu_poŞ.hh
"

52 
	~"ıu/o3/š¡_queue.hh
"

53 
	~"debug/IQ.hh
"

54 
	~"’ums/OpCÏss.hh
"

55 
	~"·¿ms/D”ivO3CPU.hh
"

56 
	~"sim/cÜe.hh
"

60 
usšg
 
	g¡d
::
li¡
;

62 
	g‹m¶©e
 <
şass
 
	gIm¶
>

63 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
FUCom¶‘iÚ
::FUCom¶‘iÚ(
DynIn¡PŒ
 &
_š¡
,

64 
fu_idx
, 
In¡ruùiÚQueue
<
Im¶
> *
iq_±r
)

65 : 
Ev’t
(
St_Ev’t_Pri
, 
AutoD–‘e
),

66 
š¡
(
_š¡
), 
fuIdx
(
fu_idx
), 
iqPŒ
(
iq_±r
), 
	$ä“FU
(
çl£
)

68 
	}
}

70 
	g‹m¶©e
 <
şass
 
	gIm¶
>

72 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
FUCom¶‘iÚ
::
	$´oûss
()

74 
iqPŒ
->
	`´oûssFUCom¶‘iÚ
(
š¡
, 
ä“FU
 ? 
fuIdx
 : -1);

75 
š¡
 = 
NULL
;

76 
	}
}

79 
	g‹m¶©e
 <
şass
 
	gIm¶
>

81 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
FUCom¶‘iÚ
::
	$desütiÚ
() const

84 
	}
}

86 
	g‹m¶©e
 <
şass
 
	gIm¶
>

87 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$In¡ruùiÚQueue
(
O3CPU
 *
ıu_±r
, 
IEW
 *
›w_±r
,

88 
D”ivO3CPUP¬ams
 *
·¿ms
)

89 : 
	`ıu
(
ıu_±r
),

90 
	`›wSge
(
›w_±r
),

91 
	`fuPoŞ
(
·¿ms
->
fuPoŞ
),

92 
	`numEÁr›s
(
·¿ms
->
numIQEÁr›s
),

93 
	`tÙ®Width
(
·¿ms
->
issueWidth
),

94 
	`comm™ToIEWD–ay
(
·¿ms
->
comm™ToIEWD–ay
)

96 
	`as£¹
(
fuPoŞ
);

98 
numTh»ads
 = 
·¿ms
->numThreads;

101 
numPhysRegs
 = 
·¿ms
->
numPhysIÁRegs
 +…¬ams->
numPhysFlßtRegs
 +

102 
·¿ms
->
numPhysCCRegs
;

106 
d•’dG¿ph
.
	`»size
(
numPhysRegs
);

109 
»gScÜebßrd
.
	`»size
(
numPhysRegs
);

112 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

113 
memD•Un™
[
tid
].
	`š™
(
·¿ms
,id);

114 
memD•Un™
[
tid
].
	`£tIQ
(
this
);

117 
	`»£tS‹
();

119 
¡d
::
¡ršg
 
pŞicy
 = 
·¿ms
->
smtIQPŞicy
;

122 
¡d
::
	`ŒªsfÜm
(
pŞicy
.
	`begš
(),…Şicy.
	`’d
(),…olicy.begin(),

123 ((*)()è
tŞow”
);

126 ià(
pŞicy
 == "dynamic") {

127 
iqPŞicy
 = 
DyÇmic
;

130 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

131 
maxEÁr›s
[
tid
] = 
numEÁr›s
;

134 } ià(
pŞicy
 == "partitioned") {

135 
iqPŞicy
 = 
P¬t™iÚed
;

138 
·¹_amt
 = 
numEÁr›s
 / 
numTh»ads
;

141 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

142 
maxEÁr›s
[
tid
] = 
·¹_amt
;

145 
	`DPRINTF
(
IQ
, "IQ sharing…olicy seto Partitioned:"

146 "%˜’Œ› ³¸th»ad.\n",
·¹_amt
);

147 } ià(
pŞicy
 == "threshold") {

148 
iqPŞicy
 = 
Th»shŞd
;

150 
th»shŞd
 = ()
·¿ms
->
smtIQTh»shŞd
 / 100;

152 
th»shŞdIQ
 = ()(()
th»shŞd
 * 
numEÁr›s
);

155 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

156 
maxEÁr›s
[
tid
] = 
th»shŞdIQ
;

159 
	`DPRINTF
(
IQ
, "IQ sharing…olicy seto Threshold:"

160 "%˜’Œ› ³¸th»ad.\n",
th»shŞdIQ
);

162 
	`as£¹
(0 && "Invalid IQ Sharing Policy.Options Are:{Dynamic,"

165 
	}
}

167 
	g‹m¶©e
 <
şass
 
	gIm¶
>

168 
	gIn¡ruùiÚQueue
<
	gIm¶
>::~
	$In¡ruùiÚQueue
()

170 
d•’dG¿ph
.
	`»£t
();

171 #ifdeà
DEBUG


172 
	`ırštf
("Nodesraversed: %i,„emoved: %i\n",

173 
d•’dG¿ph
.
nodesT¿v”£d
, d•’dG¿ph.
nodesRemoved
);

175 
	}
}

177 
	g‹m¶©e
 <
şass
 
	gIm¶
>

178 
	g¡d
::
¡ršg


179 
In¡ruùiÚQueue
<
Im¶
>::
	$Çme
() const

181  
ıu
->
	`Çme
() + ".iq";

182 
	}
}

184 
	g‹m¶©e
 <
şass
 
	gIm¶
>

186 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$»gSts
()

188 
usšg
 
Çme¥aû
 
Sts
;

189 
iqIn¡sAdded


190 .
	`Çme
(name() + ".iqInstsAdded")

191 .
	`desc
("Number of instructions‡ddedohe IQ (excludes‚on-spec)")

192 .
	`´”eq
(
iqIn¡sAdded
);

194 
iqNÚS³cIn¡sAdded


195 .
	`Çme
(name() + ".iqNonSpecInstsAdded")

196 .
	`desc
("Number of‚on-speculative instructions‡ddedohe IQ")

197 .
	`´”eq
(
iqNÚS³cIn¡sAdded
);

199 
iqIn¡sIssued


200 .
	`Çme
(name() + ".iqInstsIssued")

201 .
	`desc
("Number of instructions issued")

202 .
	`´”eq
(
iqIn¡sIssued
);

204 
iqIÁIn¡sIssued


205 .
	`Çme
(name() + ".iqIntInstsIssued")

206 .
	`desc
("Number of integer instructions issued")

207 .
	`´”eq
(
iqIÁIn¡sIssued
);

209 
iqFlßtIn¡sIssued


210 .
	`Çme
(name() + ".iqFloatInstsIssued")

211 .
	`desc
("Number of float instructions issued")

212 .
	`´”eq
(
iqFlßtIn¡sIssued
);

214 
iqB¿nchIn¡sIssued


215 .
	`Çme
(name() + ".iqBranchInstsIssued")

216 .
	`desc
("Number of branch instructions issued")

217 .
	`´”eq
(
iqB¿nchIn¡sIssued
);

219 
iqMemIn¡sIssued


220 .
	`Çme
(name() + ".iqMemInstsIssued")

221 .
	`desc
("Number of memory instructions issued")

222 .
	`´”eq
(
iqMemIn¡sIssued
);

224 
iqMiscIn¡sIssued


225 .
	`Çme
(name() + ".iqMiscInstsIssued")

226 .
	`desc
("Number of miscellaneous instructions issued")

227 .
	`´”eq
(
iqMiscIn¡sIssued
);

229 
iqSquashedIn¡sIssued


230 .
	`Çme
(name() + ".iqSquashedInstsIssued")

231 .
	`desc
("Number of squashed instructions issued")

232 .
	`´”eq
(
iqSquashedIn¡sIssued
);

234 
iqSquashedIn¡sExamšed


235 .
	`Çme
(name() + ".iqSquashedInstsExamined")

236 .
	`desc
("Number of squashed instructions iterated over during squash;"

238 .
	`´”eq
(
iqSquashedIn¡sExamšed
);

240 
iqSquashedO³¿ndsExamšed


241 .
	`Çme
(name() + ".iqSquashedOperandsExamined")

242 .
	`desc
("Number of squashed operandshat‡reƒxamined‡nd…ossibly "

244 .
	`´”eq
(
iqSquashedO³¿ndsExamšed
);

246 
iqSquashedNÚS³cRemoved


247 .
	`Çme
(name() + ".iqSquashedNonSpecRemoved")

248 .
	`desc
("Number of squashed‚on-spec instructionshat were„emoved")

249 .
	`´”eq
(
iqSquashedNÚS³cRemoved
);

261 
numIssuedDi¡


262 .
	`š™
(0,
tÙ®Width
,1)

263 .
	`Çme
(name() + ".issued_per_cycle")

264 .
	`desc
("Number of insts issuedƒach cycle")

265 .
	`æags
(
pdf
)

278 
¡©IssuedIn¡Ty³


279 .
	`š™
(
numTh»ads
,
Enums
::
Num_OpCÏss
)

280 .
	`Çme
(name() + ".FU_type")

281 .
	`desc
("Type of FU issued")

282 .
	`æags
(
tÙ®
 | 
pdf
 | 
di¡
)

284 
¡©IssuedIn¡Ty³
.
	`ysubÇmes
(
Enums
::
OpCÏssSŒšgs
);

303 
issueR©e


304 .
	`Çme
(name() + ".rate")

305 .
	`desc
("Inst issue„ate")

306 .
	`æags
(
tÙ®
)

308 
issueR©e
 = 
iqIn¡sIssued
 / 
ıu
->
numCyşes
;

310 
¡©FuBusy


311 .
	`š™
(
Num_OpCÏs£s
)

312 .
	`Çme
(name() + ".fu_full")

313 .
	`desc
("attemptso use FU when‚one‡vailable")

314 .
	`æags
(
pdf
 | 
di¡
)

316 
i
=0; i < 
Num_OpCÏs£s
; ++i) {

317 
¡©FuBusy
.
	`subÇme
(
i
, 
Enums
::
OpCÏssSŒšgs
[i]);

320 
fuBusy


321 .
	`š™
(
numTh»ads
)

322 .
	`Çme
(name() + ".fu_busy_cnt")

323 .
	`desc
("FU busy when„equested")

324 .
	`æags
(
tÙ®
)

327 
fuBusyR©e


328 .
	`Çme
(name() + ".fu_busy_rate")

329 .
	`desc
("FU busy„ate (busyƒvents/executed inst)")

330 .
	`æags
(
tÙ®
)

332 
fuBusyR©e
 = 
fuBusy
 / 
iqIn¡sIssued
;

334 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

336 
memD•Un™
[
tid
].
	`»gSts
();

339 
štIn¡QueueR—ds


340 .
	`Çme
(name() + ".int_inst_queue_reads")

341 .
	`desc
("Number of integer instruction queue„eads")

342 .
	`æags
(
tÙ®
);

344 
štIn¡QueueWr™es


345 .
	`Çme
(name() + ".int_inst_queue_writes")

346 .
	`desc
("Number of integer instruction queue writes")

347 .
	`æags
(
tÙ®
);

349 
štIn¡QueueWakeupAcûs£s


350 .
	`Çme
(name() + ".int_inst_queue_wakeup_accesses")

351 .
	`desc
("Number of integer instruction queue wakeup‡ccesses")

352 .
	`æags
(
tÙ®
);

354 
åIn¡QueueR—ds


355 .
	`Çme
(name() + ".fp_inst_queue_reads")

356 .
	`desc
("Number of floating instruction queue„eads")

357 .
	`æags
(
tÙ®
);

359 
åIn¡QueueWr™es


360 .
	`Çme
(name() + ".fp_inst_queue_writes")

361 .
	`desc
("Number of floating instruction queue writes")

362 .
	`æags
(
tÙ®
);

364 
åIn¡QueueWakeupQcûs£s


365 .
	`Çme
(name() + ".fp_inst_queue_wakeup_accesses")

366 .
	`desc
("Number of floating instruction queue wakeup‡ccesses")

367 .
	`æags
(
tÙ®
);

369 
štAluAcûs£s


370 .
	`Çme
(name() + ".int_alu_accesses")

371 .
	`desc
("Number of integer‡lu‡ccesses")

372 .
	`æags
(
tÙ®
);

374 
åAluAcûs£s


375 .
	`Çme
(name() + ".fp_alu_accesses")

376 .
	`desc
("Number of floating…oint‡lu‡ccesses")

377 .
	`æags
(
tÙ®
);

379 
	}
}

381 
	g‹m¶©e
 <
şass
 
	gIm¶
>

383 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$»£tS‹
()

386 
Th»adID
 
tid
 = 0;id <
numTh»ads
;id++) {

387 
couÁ
[
tid
] = 0;

388 
š¡Li¡
[
tid
].
	`ş—r
();

392 
ä“EÁr›s
 = 
numEÁr›s
;

399 
i
 = 0; i < 
numPhysRegs
; ++i) {

400 
»gScÜebßrd
[
i
] = 
çl£
;

403 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

404 
squashedSeqNum
[
tid
] = 0;

407 
i
 = 0; i < 
Num_OpCÏs£s
; ++i) {

408 !
»adyIn¡s
[
i
].
	`em±y
())

409 
»adyIn¡s
[
i
].
	`pİ
();

410 
queueOnLi¡
[
i
] = 
çl£
;

411 
»adyIt
[
i
] = 
li¡Ord”
.
	`’d
();

413 
nÚS³cIn¡s
.
	`ş—r
();

414 
li¡Ord”
.
	`ş—r
();

415 
deã¼edMemIn¡s
.
	`ş—r
();

416 
	}
}

418 
	g‹m¶©e
 <
şass
 
	gIm¶
>

420 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
£tAùiveTh»ads
(
li¡
<
Th»adID
> *
©_±r
)

422 
aùiveTh»ads
 = 
©_±r
;

425 
	g‹m¶©e
 <
şass
 
	gIm¶
>

427 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
£tIssueToExecu‹Queue
(
TimeBufãr
<
IssueSŒuù
> *
i2e_±r
)

429 
issueToExecu‹Queue
 = 
i2e_±r
;

432 
	g‹m¶©e
 <
şass
 
	gIm¶
>

434 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
)

436 
timeBufãr
 = 
tb_±r
;

438 
	gäomComm™
 = 
timeBufãr
->
g‘Wœe
(-
comm™ToIEWD–ay
);

441 
	g‹m¶©e
 <
şass
 
	gIm¶
>

443 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

445 
	`as£¹
(
d•’dG¿ph
.
	`em±y
());

446 
	`as£¹
(
š¡sToExecu‹
.
	`em±y
());

447 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid)

448 
memD•Un™
[
tid
].
	`d¿šSª™yCheck
();

449 
	}
}

451 
	g‹m¶©e
 <
şass
 
	gIm¶
>

453 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$keOv”From
()

455 
	`»£tS‹
();

456 
	}
}

458 
	g‹m¶©e
 <
şass
 
	gIm¶
>

460 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$’ŒyAmouÁ
(
Th»adID
 
num_th»ads
)

462 ià(
iqPŞicy
 =ğ
P¬t™iÚed
) {

463  
numEÁr›s
 / 
num_th»ads
;

467 
	}
}

470 
	g‹m¶©e
 <
şass
 
	gIm¶
>

472 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$»£tEÁr›s
()

474 ià(
iqPŞicy
 !ğ
DyÇmic
 || 
numTh»ads
 > 1) {

475 
aùive_th»ads
 = 
aùiveTh»ads
->
	`size
();

477 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

478 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

480 
th»ads
 !ğ
’d
) {

481 
Th»adID
 
tid
 = *
th»ads
++;

483 ià(
iqPŞicy
 =ğ
P¬t™iÚed
) {

484 
maxEÁr›s
[
tid
] = 
numEÁr›s
 / 
aùive_th»ads
;

485 } if(
iqPŞicy
 =ğ
Th»shŞd
 && 
aùive_th»ads
 == 1) {

486 
maxEÁr›s
[
tid
] = 
numEÁr›s
;

490 
	}
}

492 
	g‹m¶©e
 <
şass
 
	gIm¶
>

494 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$numF»eEÁr›s
()

496  
ä“EÁr›s
;

497 
	}
}

499 
	g‹m¶©e
 <
şass
 
	gIm¶
>

501 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$numF»eEÁr›s
(
Th»adID
 
tid
)

503  
maxEÁr›s
[
tid
] - 
couÁ
[tid];

504 
	}
}

508 
	g‹m¶©e
 <
şass
 
	gIm¶
>

509 
boŞ


510 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$isFuÎ
()

512 ià(
ä“EÁr›s
 == 0) {

513 (
Œue
);

515 (
çl£
);

517 
	}
}

519 
	g‹m¶©e
 <
şass
 
	gIm¶
>

520 
boŞ


521 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$isFuÎ
(
Th»adID
 
tid
)

523 ià(
	`numF»eEÁr›s
(
tid
) == 0) {

524 (
Œue
);

526 (
çl£
);

528 
	}
}

530 
	g‹m¶©e
 <
şass
 
	gIm¶
>

531 
boŞ


532 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$hasR—dyIn¡s
()

534 ià(!
li¡Ord”
.
	`em±y
()) {

535  
Œue
;

538 
i
 = 0; i < 
Num_OpCÏs£s
; ++i) {

539 ià(!
»adyIn¡s
[
i
].
	`em±y
()) {

540  
Œue
;

544  
çl£
;

545 
	}
}

547 
	g‹m¶©e
 <
şass
 
	gIm¶
>

549 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$š£¹
(
DynIn¡PŒ
 &
Ãw_š¡
)

551 
Ãw_š¡
->
	`isFlßtšg
(è? 
åIn¡QueueWr™es
++ : 
štIn¡QueueWr™es
++;

553 
	`as£¹
(
Ãw_š¡
);

555 
	`DPRINTF
(
IQ
, "Adding instruction [sn:%lli] PC %sohe IQ.\n",

556 
Ãw_š¡
->
£qNum
,‚ew_š¡->
	`pcS‹
());

558 
	`as£¹
(
ä“EÁr›s
 != 0);

560 
š¡Li¡
[
Ãw_š¡
->
th»adNumb”
].
	`push_back
(new_inst);

562 --
ä“EÁr›s
;

564 
Ãw_š¡
->
	`£tInIQ
();

568 
	`addToD•’d’ts
(
Ãw_š¡
);

572 
	`addToProduûrs
(
Ãw_š¡
);

574 ià(
Ãw_š¡
->
	`isMemRef
()) {

575 
memD•Un™
[
Ãw_š¡
->
th»adNumb”
].
	`š£¹
(new_inst);

577 
	`addIfR—dy
(
Ãw_š¡
);

580 ++
iqIn¡sAdded
;

582 
couÁ
[
Ãw_š¡
->
th»adNumb”
]++;

584 
	`as£¹
(
ä“EÁr›s
 =ğ(
numEÁr›s
 - 
	`couÁIn¡s
()));

585 
	}
}

587 
	g‹m¶©e
 <
şass
 
	gIm¶
>

589 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$š£¹NÚS³c
(
DynIn¡PŒ
 &
Ãw_š¡
)

593 
Ãw_š¡
->
	`isFlßtšg
(è? 
åIn¡QueueWr™es
++ : 
štIn¡QueueWr™es
++;

595 
	`as£¹
(
Ãw_š¡
);

597 
nÚS³cIn¡s
[
Ãw_š¡
->
£qNum
] =‚ew_inst;

599 
	`DPRINTF
(
IQ
, "Adding‚on-speculative instruction [sn:%lli] PC %s "

601 
Ãw_š¡
->
£qNum
,‚ew_š¡->
	`pcS‹
());

603 
	`as£¹
(
ä“EÁr›s
 != 0);

605 
š¡Li¡
[
Ãw_š¡
->
th»adNumb”
].
	`push_back
(new_inst);

607 --
ä“EÁr›s
;

609 
Ãw_š¡
->
	`£tInIQ
();

613 
	`addToProduûrs
(
Ãw_š¡
);

617 ià(
Ãw_š¡
->
	`isMemRef
()) {

618 
memD•Un™
[
Ãw_š¡
->
th»adNumb”
].
	`š£¹NÚS³c
(new_inst);

621 ++
iqNÚS³cIn¡sAdded
;

623 
couÁ
[
Ãw_š¡
->
th»adNumb”
]++;

625 
	`as£¹
(
ä“EÁr›s
 =ğ(
numEÁr›s
 - 
	`couÁIn¡s
()));

626 
	}
}

628 
	g‹m¶©e
 <
şass
 
	gIm¶
>

630 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$š£¹B¬r›r
(
DynIn¡PŒ
 &
b¬r_š¡
)

632 
memD•Un™
[
b¬r_š¡
->
th»adNumb”
].
	`š£¹B¬r›r
(barr_inst);

634 
	`š£¹NÚS³c
(
b¬r_š¡
);

635 
	}
}

637 
	g‹m¶©e
 <
şass
 
	gIm¶
>

638 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


639 
In¡ruùiÚQueue
<
Im¶
>::
	$g‘In¡ToExecu‹
()

641 
	`as£¹
(!
š¡sToExecu‹
.
	`em±y
());

642 
DynIn¡PŒ
 
š¡
 = 
š¡sToExecu‹
.
	`äÚt
();

643 
š¡sToExecu‹
.
	`pİ_äÚt
();

644 ià(
š¡
->
	`isFlßtšg
()){

645 
åIn¡QueueR—ds
++;

647 
štIn¡QueueR—ds
++;

649  
š¡
;

650 
	}
}

652 
	g‹m¶©e
 <
şass
 
	gIm¶
>

654 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$addToOrd”Li¡
(
OpCÏss
 
İ_şass
)

656 
	`as£¹
(!
»adyIn¡s
[
İ_şass
].
	`em±y
());

658 
Li¡Ord”EÁry
 
queue_’Œy
;

660 
queue_’Œy
.
queueTy³
 = 
İ_şass
;

662 
queue_’Œy
.
Şde¡In¡
 = 
»adyIn¡s
[
İ_şass
].
	`tİ
()->
£qNum
;

664 
Li¡Ord”It
 
li¡_™
 = 
li¡Ord”
.
	`begš
();

665 
Li¡Ord”It
 
li¡_’d_™
 = 
li¡Ord”
.
	`’d
();

667 
li¡_™
 !ğ
li¡_’d_™
) {

668 ià((*
li¡_™
).
Şde¡In¡
 > 
queue_’Œy
.oldestInst) {

672 
li¡_™
++;

675 
»adyIt
[
İ_şass
] = 
li¡Ord”
.
	`š£¹
(
li¡_™
, 
queue_’Œy
);

676 
queueOnLi¡
[
İ_şass
] = 
Œue
;

677 
	}
}

679 
	g‹m¶©e
 <
şass
 
	gIm¶
>

681 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$moveToYoung”In¡
(
Li¡Ord”It
 
li¡_Üd”_™
)

688 
Li¡Ord”EÁry
 
queue_’Œy
;

689 
OpCÏss
 
İ_şass
 = (*
li¡_Üd”_™
).
queueTy³
;

690 
Li¡Ord”It
 
Ãxt_™
 = 
li¡_Üd”_™
;

692 ++
Ãxt_™
;

694 
queue_’Œy
.
queueTy³
 = 
İ_şass
;

695 
queue_’Œy
.
Şde¡In¡
 = 
»adyIn¡s
[
İ_şass
].
	`tİ
()->
£qNum
;

697 
Ãxt_™
 !ğ
li¡Ord”
.
	`’d
() &&

698 (*
Ãxt_™
).
Şde¡In¡
 < 
queue_’Œy
.oldestInst) {

699 ++
Ãxt_™
;

702 
»adyIt
[
İ_şass
] = 
li¡Ord”
.
	`š£¹
(
Ãxt_™
, 
queue_’Œy
);

703 
	}
}

705 
	g‹m¶©e
 <
şass
 
	gIm¶
>

707 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$´oûssFUCom¶‘iÚ
(
DynIn¡PŒ
 &
š¡
, 
fu_idx
)

709 
	`DPRINTF
(
IQ
, "Proûssšg FU com¶‘iÚ [¢:%Îi]\n", 
š¡
->
£qNum
);

710 
	`as£¹
(!
ıu
->
	`sw™chedOut
());

713 
›wSge
->
	`wakeCPU
();

715 ià(
fu_idx
 > -1)

716 
fuPoŞ
->
	`ä“Un™NextCyşe
(
fu_idx
);

721 
issueToExecu‹Queue
->
	`acûss
(-1)->
size
++;

722 
š¡sToExecu‹
.
	`push_back
(
š¡
);

723 
	}
}

728 
	g‹m¶©e
 <
şass
 
	gIm¶
>

730 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$scheduËR—dyIn¡s
()

732 
	`DPRINTF
(
IQ
, "Attemptingo schedule„eady instructions from "

735 
IssueSŒuù
 *
i2e_šfo
 = 
issueToExecu‹Queue
->
	`acûss
(0);

737 
DynIn¡PŒ
 
deã¼ed_mem_š¡
;

738 
tÙ®_deã¼ed_mem_issued
 = 0;

739 
tÙ®_deã¼ed_mem_issued
 < 
tÙ®Width
 &&

740 (
deã¼ed_mem_š¡
 = 
	`g‘Deã¼edMemIn¡ToExecu‹
()) != 0) {

741 
issueToExecu‹Queue
->
	`acûss
(0)->
size
++;

742 
š¡sToExecu‹
.
	`push_back
(
deã¼ed_mem_š¡
);

743 
tÙ®_deã¼ed_mem_issued
++;

754 
Li¡Ord”It
 
Üd”_™
 = 
li¡Ord”
.
	`begš
();

755 
Li¡Ord”It
 
Üd”_’d_™
 = 
li¡Ord”
.
	`’d
();

756 
tÙ®_issued
 = 0;

758 
tÙ®_issued
 < (
tÙ®Width
 - 
tÙ®_deã¼ed_mem_issued
) &&

759 
›wSge
->
	`ÿnIssue
() &&

760 
Üd”_™
 !ğ
Üd”_’d_™
) {

761 
OpCÏss
 
İ_şass
 = (*
Üd”_™
).
queueTy³
;

763 
	`as£¹
(!
»adyIn¡s
[
İ_şass
].
	`em±y
());

765 
DynIn¡PŒ
 
issušg_š¡
 = 
»adyIn¡s
[
İ_şass
].
	`tİ
();

767 
issušg_š¡
->
	`isFlßtšg
(è? 
åIn¡QueueR—ds
++ : 
štIn¡QueueR—ds
++;

769 
	`as£¹
(
issušg_š¡
->
£qNum
 =ğ(*
Üd”_™
).
Şde¡In¡
);

771 ià(
issušg_š¡
->
	`isSquashed
()) {

772 
»adyIn¡s
[
İ_şass
].
	`pİ
();

774 ià(!
»adyIn¡s
[
İ_şass
].
	`em±y
()) {

775 
	`moveToYoung”In¡
(
Üd”_™
);

777 
»adyIt
[
İ_şass
] = 
li¡Ord”
.
	`’d
();

778 
queueOnLi¡
[
İ_şass
] = 
çl£
;

781 
li¡Ord”
.
	`”a£
(
Üd”_™
++);

783 ++
iqSquashedIn¡sIssued
;

788 
idx
 = -2;

789 
Cyşes
 
İ_Ï‹ncy
 = 
	`Cyşes
(1);

790 
Th»adID
 
tid
 = 
issušg_š¡
->
th»adNumb”
;

792 ià(
İ_şass
 !ğ
No_OpCÏss
) {

793 
idx
 = 
fuPoŞ
->
	`g‘Un™
(
İ_şass
);

794 
issušg_š¡
->
	`isFlßtšg
(è? 
åAluAcûs£s
++ : 
štAluAcûs£s
++;

795 ià(
idx
 > -1) {

796 
İ_Ï‹ncy
 = 
fuPoŞ
->
	`g‘OpL©’cy
(
İ_şass
);

802 ià(
idx
 == -2 || idx != -1) {

803 ià(
İ_Ï‹ncy
 =ğ
	`Cyşes
(1)) {

804 
i2e_šfo
->
size
++;

805 
š¡sToExecu‹
.
	`push_back
(
issušg_š¡
);

809 ià(
idx
 >= 0)

810 
fuPoŞ
->
	`ä“Un™NextCyşe
(
idx
);

812 
Cyşes
 
issue_Ï‹ncy
 = 
fuPoŞ
->
	`g‘IssueL©’cy
(
İ_şass
);

814 
FUCom¶‘iÚ
 *
executiÚ
 = 
Ãw
 
	`FUCom¶‘iÚ
(
issušg_š¡
,

815 
idx
, 
this
);

817 
ıu
->
	`scheduË
(
executiÚ
,

818 
ıu
->
	`şockEdge
(
	`Cyşes
(
İ_Ï‹ncy
 - 1)));

821 ià(
issue_Ï‹ncy
 > 
	`Cyşes
(1)) {

824 
executiÚ
->
	`£tF»eFU
();

827 
fuPoŞ
->
	`ä“Un™NextCyşe
(
idx
);

831 
	`DPRINTF
(
IQ
, "Thread %i: Issuing instruction PC %s "

833 
tid
, 
issušg_š¡
->
	`pcS‹
(),

834 
issušg_š¡
->
£qNum
);

836 
»adyIn¡s
[
İ_şass
].
	`pİ
();

838 ià(!
»adyIn¡s
[
İ_şass
].
	`em±y
()) {

839 
	`moveToYoung”In¡
(
Üd”_™
);

841 
»adyIt
[
İ_şass
] = 
li¡Ord”
.
	`’d
();

842 
queueOnLi¡
[
İ_şass
] = 
çl£
;

845 
issušg_š¡
->
	`£tIssued
();

846 ++
tÙ®_issued
;

848 #ià
TRACING_ON


849 
issušg_š¡
->
issueTick
 = 
	`curTick
(è- issušg_š¡->
ãtchTick
;

852 ià(!
issušg_š¡
->
	`isMemRef
()) {

855 ++
ä“EÁr›s
;

856 
couÁ
[
tid
]--;

857 
issušg_š¡
->
	`ş—rInIQ
();

859 
memD•Un™
[
tid
].
	`issue
(
issušg_š¡
);

862 
li¡Ord”
.
	`”a£
(
Üd”_™
++);

863 
¡©IssuedIn¡Ty³
[
tid
][
İ_şass
]++;

864 
›wSge
->
	`šüWb
(
issušg_š¡
->
£qNum
);

866 
¡©FuBusy
[
İ_şass
]++;

867 
fuBusy
[
tid
]++;

868 ++
Üd”_™
;

872 
numIssuedDi¡
.
	`§m¶e
(
tÙ®_issued
);

873 
iqIn¡sIssued
+ğ
tÙ®_issued
;

879 ià(
tÙ®_issued
 || 
tÙ®_deã¼ed_mem_issued
 || 
deã¼edMemIn¡s
.
	`size
()) {

880 
ıu
->
	`aùiv™yThisCyşe
();

882 
	`DPRINTF
(
IQ
, "Not‡bleo schedule‡ny instructions.\n");

884 
	}
}

886 
	g‹m¶©e
 <
şass
 
	gIm¶
>

888 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$scheduËNÚS³c
(cÚ¡ 
In¡SeqNum
 &
š¡
)

890 
	`DPRINTF
(
IQ
, "Marking‚onspeculative instruction [sn:%lli]‡s„eady "

891 "tØexecu‹.\n", 
š¡
);

893 
NÚS³cM­It
 
š¡_™
 = 
nÚS³cIn¡s
.
	`fšd
(
š¡
);

895 
	`as£¹
(
š¡_™
 !ğ
nÚS³cIn¡s
.
	`’d
());

897 
Th»adID
 
tid
 = (*
š¡_™
).
£cÚd
->
th»adNumb”
;

899 (*
š¡_™
).
£cÚd
->
	`£tAtComm™
();

901 (*
š¡_™
).
£cÚd
->
	`£tCªIssue
();

903 ià(!(*
š¡_™
).
£cÚd
->
	`isMemRef
()) {

904 
	`addIfR—dy
((*
š¡_™
).
£cÚd
);

906 
memD•Un™
[
tid
].
	`nÚS³cIn¡R—dy
((*
š¡_™
).
£cÚd
);

909 (*
š¡_™
).
£cÚd
 = 
NULL
;

911 
nÚS³cIn¡s
.
	`”a£
(
š¡_™
);

912 
	}
}

914 
	g‹m¶©e
 <
şass
 
	gIm¶
>

916 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$comm™
(cÚ¡ 
In¡SeqNum
 &
š¡
, 
Th»adID
 
tid
)

918 
	`DPRINTF
(
IQ
, "[tid:%i]: Committing instructions olderhan [sn:%i]\n",

919 
tid
,
š¡
);

921 
Li¡It
 
iq_™
 = 
š¡Li¡
[
tid
].
	`begš
();

923 
iq_™
 !ğ
š¡Li¡
[
tid
].
	`’d
() &&

924 (*
iq_™
)->
£qNum
 <ğ
š¡
) {

925 ++
iq_™
;

926 
š¡Li¡
[
tid
].
	`pİ_äÚt
();

929 
	`as£¹
(
ä“EÁr›s
 =ğ(
numEÁr›s
 - 
	`couÁIn¡s
()));

930 
	}
}

932 
	g‹m¶©e
 <
şass
 
	gIm¶
>

934 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$wakeD•’d’ts
(
DynIn¡PŒ
 &
com¶‘ed_š¡
)

936 
d•’d’ts
 = 0;

939 ià(
com¶‘ed_š¡
->
	`isFlßtšg
()) {

940 
åIn¡QueueWakeupQcûs£s
++;

942 
štIn¡QueueWakeupAcûs£s
++;

945 
	`DPRINTF
(
IQ
, "Waking dependents of completed instruction.\n");

947 
	`as£¹
(!
com¶‘ed_š¡
->
	`isSquashed
());

955 ià(
com¶‘ed_š¡
->
	`isMemRef
()) {

956 
memD•Un™
[
com¶‘ed_š¡
->
th»adNumb”
].
	`wakeD•’d’ts
(completed_inst);

957 
	`com¶‘eMemIn¡
(
com¶‘ed_š¡
);

958 } ià(
com¶‘ed_š¡
->
	`isMemB¬r›r
() ||

959 
com¶‘ed_š¡
->
	`isWr™eB¬r›r
()) {

960 
memD•Un™
[
com¶‘ed_š¡
->
th»adNumb”
].
	`com¶‘eB¬r›r
(completed_inst);

963 
de¡_»g_idx
 = 0;

964 
de¡_»g_idx
 < 
com¶‘ed_š¡
->
	`numDe¡Regs
();

965 
de¡_»g_idx
++)

967 
PhysRegIndex
 
de¡_»g
 =

968 
com¶‘ed_š¡
->
	`»ÇmedDe¡RegIdx
(
de¡_»g_idx
);

973 ià(
de¡_»g
 >ğ
numPhysRegs
) {

974 
	`DPRINTF
(
IQ
, "de¡_»g :%d,‚umPhysRegs: %d\n", 
de¡_»g
,

975 
numPhysRegs
);

979 
	`DPRINTF
(
IQ
, "Waking‡ny dependents on„egister %i.\n",

980 (è
de¡_»g
);

984 
DynIn¡PŒ
 
d•_š¡
 = 
d•’dG¿ph
.
	`pİ
(
de¡_»g
);

986 
d•_š¡
) {

987 
	`DPRINTF
(
IQ
, "Waking up‡ dependent instruction, [sn:%lli] "

988 "PC %s.\n", 
d•_š¡
->
£qNum
, d•_š¡->
	`pcS‹
());

994 
d•_š¡
->
	`m¬kSrcRegR—dy
();

996 
	`addIfR—dy
(
d•_š¡
);

998 
d•_š¡
 = 
d•’dG¿ph
.
	`pİ
(
de¡_»g
);

1000 ++
d•’d’ts
;

1005 
	`as£¹
(
d•’dG¿ph
.
	`em±y
(
de¡_»g
));

1006 
d•’dG¿ph
.
	`ş—rIn¡
(
de¡_»g
);

1009 
»gScÜebßrd
[
de¡_»g
] = 
Œue
;

1011  
d•’d’ts
;

1012 
	}
}

1014 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1016 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$addR—dyMemIn¡
(
DynIn¡PŒ
 &
»ady_š¡
)

1018 
OpCÏss
 
İ_şass
 = 
»ady_š¡
->
	`İCÏss
();

1020 
»adyIn¡s
[
İ_şass
].
	`push
(
»ady_š¡
);

1024 ià(!
queueOnLi¡
[
İ_şass
]) {

1025 
	`addToOrd”Li¡
(
İ_şass
);

1026 } ià(
»adyIn¡s
[
İ_şass
].
	`tİ
()->
£qNum
 <

1027 (*
»adyIt
[
İ_şass
]).
Şde¡In¡
) {

1028 
li¡Ord”
.
	`”a£
(
»adyIt
[
İ_şass
]);

1029 
	`addToOrd”Li¡
(
İ_şass
);

1032 
	`DPRINTF
(
IQ
, "Instruction is„eadyo issue,…utting it onto "

1034 
»ady_š¡
->
	`pcS‹
(), 
İ_şass
,„—dy_š¡->
£qNum
);

1035 
	}
}

1037 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1039 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$»scheduËMemIn¡
(
DynIn¡PŒ
 &
»sched_š¡
)

1041 
	`DPRINTF
(
IQ
, "Reschedulšg mem in¡ [¢:%Îi]\n", 
»sched_š¡
->
£qNum
);

1044 
»sched_š¡
->
	`Œª¦©iÚS¹ed
(
çl£
);

1045 
»sched_š¡
->
	`Œª¦©iÚCom¶‘ed
(
çl£
);

1047 
»sched_š¡
->
	`ş—rCªIssue
();

1048 
memD•Un™
[
»sched_š¡
->
th»adNumb”
].
	`»scheduË
(resched_inst);

1049 
	}
}

1051 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1053 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$»¶ayMemIn¡
(
DynIn¡PŒ
 &
»¶ay_š¡
)

1055 
memD•Un™
[
»¶ay_š¡
->
th»adNumb”
].
	`»¶ay
(replay_inst);

1056 
	}
}

1058 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1060 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$com¶‘eMemIn¡
(
DynIn¡PŒ
 &
com¶‘ed_š¡
)

1062 
Th»adID
 
tid
 = 
com¶‘ed_š¡
->
th»adNumb”
;

1064 
	`DPRINTF
(
IQ
, "Completing mem instruction PC: %s [sn:%lli]\n",

1065 
com¶‘ed_š¡
->
	`pcS‹
(), com¶‘ed_š¡->
£qNum
);

1067 ++
ä“EÁr›s
;

1069 
com¶‘ed_š¡
->
	`memOpDÚe
(
Œue
);

1071 
memD•Un™
[
tid
].
	`com¶‘ed
(
com¶‘ed_š¡
);

1072 
couÁ
[
tid
]--;

1073 
	}
}

1075 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1077 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$deãrMemIn¡
(
DynIn¡PŒ
 &
deã¼ed_š¡
)

1079 
deã¼edMemIn¡s
.
	`push_back
(
deã¼ed_š¡
);

1080 
	}
}

1082 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1083 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


1084 
In¡ruùiÚQueue
<
Im¶
>::
	$g‘Deã¼edMemIn¡ToExecu‹
()

1086 
Li¡It
 
™
 = 
deã¼edMemIn¡s
.
	`begš
(); iˆ!ğdeã¼edMemIn¡s.
	`’d
();

1087 ++
™
) {

1088 ià((*
™
)->
	`Œª¦©iÚCom¶‘ed
(è|| (*™)->
	`isSquashed
()) {

1089 
DynIn¡PŒ
 
»t
 = *
™
;

1090 
deã¼edMemIn¡s
.
	`”a£
(
™
);

1091  
»t
;

1094  
NULL
;

1095 
	}
}

1097 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1099 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$viŞ©iÚ
(
DynIn¡PŒ
 &
¡Üe
,

1100 
DynIn¡PŒ
 &
çuÉšg_lßd
)

1102 
štIn¡QueueWr™es
++;

1103 
memD•Un™
[
¡Üe
->
th»adNumb”
].
	`viŞ©iÚ
(¡Üe, 
çuÉšg_lßd
);

1104 
	}
}

1106 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1108 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$squash
(
Th»adID
 
tid
)

1110 
	`DPRINTF
(
IQ
, "[tid:%i]: Startingo squash instructions in "

1111 "thIQ.\n", 
tid
);

1115 
squashedSeqNum
[
tid
] = 
äomComm™
->
comm™Info
[tid].
dÚeSeqNum
;

1118 ià(
couÁ
[
tid
] > 0) {

1119 
	`doSquash
(
tid
);

1123 
memD•Un™
[
tid
].
	`squash
(
squashedSeqNum
[tid],id);

1124 
	}
}

1126 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1128 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$doSquash
(
Th»adID
 
tid
)

1131 
Li¡It
 
squash_™
 = 
š¡Li¡
[
tid
].
	`’d
();

1132 --
squash_™
;

1134 
	`DPRINTF
(
IQ
, "[tid:%i]: Squashing until sequence‚umber %i!\n",

1135 
tid
, 
squashedSeqNum
[tid]);

1139 
squash_™
 !ğ
š¡Li¡
[
tid
].
	`’d
() &&

1140 (*
squash_™
)->
£qNum
 > 
squashedSeqNum
[
tid
]) {

1142 
DynIn¡PŒ
 
squashed_š¡
 = (*
squash_™
);

1143 
squashed_š¡
->
	`isFlßtšg
(è? 
åIn¡QueueWr™es
++ : 
štIn¡QueueWr™es
++;

1147 ià(
squashed_š¡
->
th»adNumb”
 !ğ
tid
 ||

1148 
squashed_š¡
->
	`isSquashedInIQ
()) {

1149 --
squash_™
;

1153 ià(!
squashed_š¡
->
	`isIssued
() ||

1154 (
squashed_š¡
->
	`isMemRef
() &&

1155 !
squashed_š¡
->
	`memOpDÚe
())) {

1157 
	`DPRINTF
(
IQ
, "[tid:%i]: Instruction [sn:%lli] PC %s squashed.\n",

1158 
tid
, 
squashed_š¡
->
£qNum
, squashed_š¡->
	`pcS‹
());

1161 ià(!
squashed_š¡
->
	`isNÚS³cuÏtive
() &&

1162 !
squashed_š¡
->
	`isStÜeCÚd™iÚ®
() &&

1163 !
squashed_š¡
->
	`isMemB¬r›r
() &&

1164 !
squashed_š¡
->
	`isWr™eB¬r›r
()) {

1166 
¤c_»g_idx
 = 0;

1167 
¤c_»g_idx
 < 
squashed_š¡
->
	`numSrcRegs
();

1168 
¤c_»g_idx
++)

1170 
PhysRegIndex
 
¤c_»g
 =

1171 
squashed_š¡
->
	`»ÇmedSrcRegIdx
(
¤c_»g_idx
);

1182 ià(!
squashed_š¡
->
	`isR—dySrcRegIdx
(
¤c_»g_idx
) &&

1183 
¤c_»g
 < 
numPhysRegs
) {

1184 
d•’dG¿ph
.
	`»move
(
¤c_»g
, 
squashed_š¡
);

1188 ++
iqSquashedO³¿ndsExamšed
;

1190 } ià(!
squashed_š¡
->
	`isStÜeCÚd™iÚ®
() ||

1191 !
squashed_š¡
->
	`isCom¶‘ed
()) {

1192 
NÚS³cM­It
 
ns_š¡_™
 =

1193 
nÚS³cIn¡s
.
	`fšd
(
squashed_š¡
->
£qNum
);

1195 ià(
ns_š¡_™
 =ğ
nÚS³cIn¡s
.
	`’d
()) {

1196 
	`as£¹
(
squashed_š¡
->
	`g‘FauÉ
(è!ğ
NoFauÉ
);

1199 (*
ns_š¡_™
).
£cÚd
 = 
NULL
;

1201 
nÚS³cIn¡s
.
	`”a£
(
ns_š¡_™
);

1203 ++
iqSquashedNÚS³cRemoved
;

1210 
squashed_š¡
->
	`£tSquashedInIQ
();

1214 
squashed_š¡
->
	`£tIssued
();

1215 
squashed_š¡
->
	`£tCªComm™
();

1216 
squashed_š¡
->
	`ş—rInIQ
();

1219 
couÁ
[
squashed_š¡
->
th»adNumb”
]--;

1221 ++
ä“EÁr›s
;

1224 
š¡Li¡
[
tid
].
	`”a£
(
squash_™
--);

1225 ++
iqSquashedIn¡sExamšed
;

1227 
	}
}

1229 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1230 
boŞ


1231 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$addToD•’d’ts
(
DynIn¡PŒ
 &
Ãw_š¡
)

1235 
št8_t
 
tÙ®_¤c_»gs
 = 
Ãw_š¡
->
	`numSrcRegs
();

1236 
boŞ
 
»tuº_v®
 = 
çl£
;

1238 
¤c_»g_idx
 = 0;

1239 
¤c_»g_idx
 < 
tÙ®_¤c_»gs
;

1240 
¤c_»g_idx
++)

1243 ià(!
Ãw_š¡
->
	`isR—dySrcRegIdx
(
¤c_»g_idx
)) {

1244 
PhysRegIndex
 
¤c_»g
 = 
Ãw_š¡
->
	`»ÇmedSrcRegIdx
(
¤c_»g_idx
);

1250 ià(
¤c_»g
 >ğ
numPhysRegs
) {

1252 } ià(
»gScÜebßrd
[
¤c_»g
] =ğ
çl£
) {

1253 
	`DPRINTF
(
IQ
, "Instruction PC %s has src„eg %ihat "

1255 
Ãw_š¡
->
	`pcS‹
(), 
¤c_»g
);

1257 
d•’dG¿ph
.
	`š£¹
(
¤c_»g
, 
Ãw_š¡
);

1261 
»tuº_v®
 = 
Œue
;

1263 
	`DPRINTF
(
IQ
, "Instruction PC %s has src„eg %ihat "

1265 
Ãw_š¡
->
	`pcS‹
(), 
¤c_»g
);

1267 
Ãw_š¡
->
	`m¬kSrcRegR—dy
(
¤c_»g_idx
);

1272  
»tuº_v®
;

1273 
	}
}

1275 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1277 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$addToProduûrs
(
DynIn¡PŒ
 &
Ãw_š¡
)

1283 
št8_t
 
tÙ®_de¡_»gs
 = 
Ãw_š¡
->
	`numDe¡Regs
();

1285 
de¡_»g_idx
 = 0;

1286 
de¡_»g_idx
 < 
tÙ®_de¡_»gs
;

1287 
de¡_»g_idx
++)

1289 
PhysRegIndex
 
de¡_»g
 = 
Ãw_š¡
->
	`»ÇmedDe¡RegIdx
(
de¡_»g_idx
);

1295 ià(
de¡_»g
 >ğ
numPhysRegs
) {

1299 ià(!
d•’dG¿ph
.
	`em±y
(
de¡_»g
)) {

1300 
d•’dG¿ph
.
	`dump
();

1301 
	`·nic
("D•’d’cy g¿ph %˜nÙƒm±y!", 
de¡_»g
);

1304 
d•’dG¿ph
.
	`£tIn¡
(
de¡_»g
, 
Ãw_š¡
);

1307 
»gScÜebßrd
[
de¡_»g
] = 
çl£
;

1309 
	}
}

1311 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1313 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$addIfR—dy
(
DynIn¡PŒ
 &
š¡
)

1317 ià(
š¡
->
	`»adyToIssue
()) {

1320 ià(
š¡
->
	`isMemRef
()) {

1322 
	`DPRINTF
(
IQ
, "Checking if memory instruction can issue.\n");

1326 
memD•Un™
[
š¡
->
th»adNumb”
].
	`»gsR—dy
(inst);

1331 
OpCÏss
 
İ_şass
 = 
š¡
->
	`İCÏss
();

1333 
	`DPRINTF
(
IQ
, "Instruction is„eadyo issue,…utting it onto "

1335 
š¡
->
	`pcS‹
(), 
İ_şass
, in¡->
£qNum
);

1337 
»adyIn¡s
[
İ_şass
].
	`push
(
š¡
);

1341 ià(!
queueOnLi¡
[
İ_şass
]) {

1342 
	`addToOrd”Li¡
(
İ_şass
);

1343 } ià(
»adyIn¡s
[
İ_şass
].
	`tİ
()->
£qNum
 <

1344 (*
»adyIt
[
İ_şass
]).
Şde¡In¡
) {

1345 
li¡Ord”
.
	`”a£
(
»adyIt
[
İ_şass
]);

1346 
	`addToOrd”Li¡
(
İ_şass
);

1349 
	}
}

1351 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1353 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$couÁIn¡s
()

1360 
tÙ®_š¡s
 = 0;

1362 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

1363 
Li¡It
 
couÁ_™
 = 
š¡Li¡
[
tid
].
	`begš
();

1365 
couÁ_™
 !ğ
š¡Li¡
[
tid
].
	`’d
()) {

1366 ià(!(*
couÁ_™
)->
	`isSquashed
(è&& !(*couÁ_™)->
	`isSquashedInIQ
()) {

1367 ià(!(*
couÁ_™
)->
	`isIssued
()) {

1368 ++
tÙ®_š¡s
;

1369 } ià((*
couÁ_™
)->
	`isMemRef
() &&

1370 !(*
couÁ_™
)->
memOpDÚe
) {

1373 ++
tÙ®_š¡s
;

1377 ++
couÁ_™
;

1381  
tÙ®_š¡s
;

1383  
numEÁr›s
 - 
ä“EÁr›s
;

1385 
	}
}

1387 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1389 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$dumpLi¡s
()

1391 
i
 = 0; i < 
Num_OpCÏs£s
; ++i) {

1392 
	`ırštf
("R—dy†i¡ %˜size: %i\n", 
i
, 
»adyIn¡s
[i].
	`size
());

1394 
	`ırštf
("\n");

1397 
	`ırštf
("NÚ s³cuÏtivli¡ size: %i\n", 
nÚS³cIn¡s
.
	`size
());

1399 
NÚS³cM­It
 
nÚ_¥ec_™
 = 
nÚS³cIn¡s
.
	`begš
();

1400 
NÚS³cM­It
 
nÚ_¥ec_’d_™
 = 
nÚS³cIn¡s
.
	`’d
();

1402 
	`ırštf
("Non speculative†ist: ");

1404 
nÚ_¥ec_™
 !ğ
nÚ_¥ec_’d_™
) {

1405 
	`ırštf
("% [¢:%Îi]", (*
nÚ_¥ec_™
).
£cÚd
->
	`pcS‹
(),

1406 (*
nÚ_¥ec_™
).
£cÚd
->
£qNum
);

1407 ++
nÚ_¥ec_™
;

1410 
	`ırštf
("\n");

1412 
Li¡Ord”It
 
li¡_Üd”_™
 = 
li¡Ord”
.
	`begš
();

1413 
Li¡Ord”It
 
li¡_Üd”_’d_™
 = 
li¡Ord”
.
	`’d
();

1414 
i
 = 1;

1416 
	`ırštf
("List order: ");

1418 
li¡_Üd”_™
 !ğ
li¡_Üd”_’d_™
) {

1419 
	`ırštf
("%˜OpCÏss:%˜[¢:%Îi] ", 
i
, (*
li¡_Üd”_™
).
queueTy³
,

1420 (*
li¡_Üd”_™
).
Şde¡In¡
);

1422 ++
li¡_Üd”_™
;

1423 ++
i
;

1426 
	`ırštf
("\n");

1427 
	}
}

1430 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1432 
	gIn¡ruùiÚQueue
<
	gIm¶
>::
	$dumpIn¡s
()

1434 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

1435 
num
 = 0;

1436 
v®id_num
 = 0;

1437 
Li¡It
 
š¡_li¡_™
 = 
š¡Li¡
[
tid
].
	`begš
();

1439 
š¡_li¡_™
 !ğ
š¡Li¡
[
tid
].
	`’d
()) {

1440 
	`ırštf
("In¡ruùiÚ:%i\n", 
num
);

1441 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

1442 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

1443 ++
v®id_num
;

1444 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1445 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

1446 !(*
š¡_li¡_™
)->
	`memOpDÚe
()) {

1449 ++
v®id_num
;

1450 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1454 
	`ırštf
("PC: %s\n[sn:%lli]\n[tid:%i]\n"

1456 (*
š¡_li¡_™
)->
	`pcS‹
(),

1457 (*
š¡_li¡_™
)->
£qNum
,

1458 (*
š¡_li¡_™
)->
th»adNumb”
,

1459 (*
š¡_li¡_™
)->
	`isIssued
(),

1460 (*
š¡_li¡_™
)->
	`isSquashed
());

1462 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

1463 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
	`memOpDÚe
());

1466 
	`ırštf
("\n");

1468 
š¡_li¡_™
++;

1469 ++
num
;

1473 
	`ırštf
("Instso Execute†ist:\n");

1475 
num
 = 0;

1476 
v®id_num
 = 0;

1477 
Li¡It
 
š¡_li¡_™
 = 
š¡sToExecu‹
.
	`begš
();

1479 
š¡_li¡_™
 !ğ
š¡sToExecu‹
.
	`’d
())

1481 
	`ırštf
("Instruction:%i\n",

1482 
num
);

1483 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

1484 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

1485 ++
v®id_num
;

1486 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1487 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

1488 !(*
š¡_li¡_™
)->
	`memOpDÚe
()) {

1491 ++
v®id_num
;

1492 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1496 
	`ırštf
("PC: %s\n[sn:%lli]\n[tid:%i]\n"

1498 (*
š¡_li¡_™
)->
	`pcS‹
(),

1499 (*
š¡_li¡_™
)->
£qNum
,

1500 (*
š¡_li¡_™
)->
th»adNumb”
,

1501 (*
š¡_li¡_™
)->
	`isIssued
(),

1502 (*
š¡_li¡_™
)->
	`isSquashed
());

1504 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

1505 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
	`memOpDÚe
());

1508 
	`ırštf
("\n");

1510 
š¡_li¡_™
++;

1511 ++
num
;

1513 
	}
}

	@o3/isa_specific.hh

31 
	~"ıu/o3/dyn_š¡.hh
"

32 
	~"ıu/o3/im¶.hh
"

33 
	~"ıu/ba£.hh
"

	@o3/lsq.cc

31 
	~"ıu/o3/i§_¥ecific.hh
"

32 
	~"ıu/o3/lsq_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gLSQ
<
	gO3CPUIm¶
>;

	@o3/lsq.hh

43 #iâdeà
__CPU_O3_LSQ_HH__


44 
	#__CPU_O3_LSQ_HH__


	)

46 
	~<m­
>

47 
	~<queue
>

49 
	~"ıu/o3/lsq_un™.hh
"

50 
	~"ıu/š¡_£q.hh
"

51 
	~"mem/pÜt.hh
"

52 
	~"sim/sim_objeù.hh
"

54 
	gD”ivO3CPUP¬ams
;

56 
	g‹m¶©e
 <
şass
 
	gIm¶
>

57 şas 
	cLSQ
 {

58 
	mpublic
:

59 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

60 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

61 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tIEW
 IEW;

62 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tLSQUn™
 LSQUnit;

65 
	eLSQPŞicy
 {

66 
	mDyÇmic
,

67 
	mP¬t™iÚed
,

68 
	mTh»shŞd


72 
LSQ
(
O3CPU
 *
ıu_±r
, 
IEW
 *
›w_±r
, 
D”ivO3CPUP¬ams
 *
·¿ms
);

73 ~
	$LSQ
() {

74 ià(
th»ad
è
d–‘e
 []hread;

75 
	}
}

78 
	g¡d
::
¡ršg
 
	$Çme
() const;

81 
	`»gSts
();

84 
	`£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

87 
	$d¿šSª™yCheck
() const;

89 
boŞ
 
	$isD¿šed
() const;

91 
	`keOv”From
();

94 
	`’ŒyAmouÁ
(
Th»adID
 
num_th»ads
);

95 
	`»moveEÁr›s
(
Th»adID
 
tid
);

97 
	`»£tEÁr›s
();

99 
	`»sizeEÁr›s
(
size
, 
Th»adID
 
tid
);

102 
	`tick
();

104 
	$tick
(
Th»adID
 
tid
)

105 { 
th»ad
[
tid
].
	`tick
(); 
	}
}

108 
š£¹Lßd
(
DynIn¡PŒ
 &
lßd_š¡
);

110 
š£¹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
);

113 
FauÉ
 
execu‹Lßd
(
DynIn¡PŒ
 &
š¡
);

116 
FauÉ
 
execu‹StÜe
(
DynIn¡PŒ
 &
š¡
);

121 
	$comm™Lßds
(
In¡SeqNum
 &
younge¡_š¡
, 
Th»adID
 
tid
)

122 { 
th»ad
[
tid
].
	`comm™Lßds
(
younge¡_š¡
); 
	}
}

127 
	$comm™StÜes
(
In¡SeqNum
 &
younge¡_š¡
, 
Th»adID
 
tid
)

128 { 
th»ad
[
tid
].
	`comm™StÜes
(
younge¡_š¡
); 
	}
}

134 
wr™ebackStÜes
();

136 
wr™ebackStÜes
(
Th»adID
 
tid
);

141 
	$squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
, 
Th»adID
 
tid
)

142 { 
th»ad
[
tid
].
	`squash
(
squashed_num
); 
	}
}

145 
boŞ
 
viŞ©iÚ
();

150 
boŞ
 
	$viŞ©iÚ
(
Th»adID
 
tid
)

151 {  
th»ad
[
tid
].
	`viŞ©iÚ
(); 
	}
}

156 
boŞ
 
	$lßdBlocked
(
Th»adID
 
tid
)

157 {  
th»ad
[
tid
].
	`lßdBlocked
(); 
	}
}

159 
boŞ
 
	$isLßdBlockedHªdËd
(
Th»adID
 
tid
)

160 {  
th»ad
[
tid
].
	`isLßdBlockedHªdËd
(); 
	}
}

162 
	$£tLßdBlockedHªdËd
(
Th»adID
 
tid
)

163 { 
th»ad
[
tid
].
	`£tLßdBlockedHªdËd
(); 
	}
}

166 
DynIn¡PŒ
 
	$g‘MemD•ViŞ©Ü
(
Th»adID
 
tid
)

167 {  
th»ad
[
tid
].
	`g‘MemD•ViŞ©Ü
(); 
	}
}

170 
	$g‘LßdH—d
(
Th»adID
 
tid
)

171 {  
th»ad
[
tid
].
	`g‘LßdH—d
(); 
	}
}

174 
In¡SeqNum
 
	$g‘LßdH—dSeqNum
(
Th»adID
 
tid
)

176  
th»ad
[
tid
].
	`g‘LßdH—dSeqNum
();

177 
	}
}

180 
	$g‘StÜeH—d
(
Th»adID
 
tid
)

181 {  
th»ad
[
tid
].
	`g‘StÜeH—d
(); 
	}
}

184 
In¡SeqNum
 
	$g‘StÜeH—dSeqNum
(
Th»adID
 
tid
)

186  
th»ad
[
tid
].
	`g‘StÜeH—dSeqNum
();

187 
	}
}

190 
g‘CouÁ
();

192 
	$g‘CouÁ
(
Th»adID
 
tid
)

193 {  
th»ad
[
tid
].
	`g‘CouÁ
(); 
	}
}

196 
numLßds
();

198 
	$numLßds
(
Th»adID
 
tid
)

199 {  
th»ad
[
tid
].
	`numLßds
(); 
	}
}

202 
numStÜes
();

204 
	$numStÜes
(
Th»adID
 
tid
)

205 {  
th»ad
[
tid
].
	`numStÜes
(); 
	}
}

208 
numF»eEÁr›s
();

210 
numF»eEÁr›s
(
Th»adID
 
tid
);

213 
boŞ
 
isFuÎ
();

218 
boŞ
 
isFuÎ
(
Th»adID
 
tid
);

221 
boŞ
 
	$isEm±y
() const;

223 
boŞ
 
	$lqEm±y
() const;

225 
boŞ
 
	$sqEm±y
() const;

228 
boŞ
 
	`lqFuÎ
();

230 
boŞ
 
	`lqFuÎ
(
Th»adID
 
tid
);

233 
boŞ
 
	`sqFuÎ
();

235 
boŞ
 
	`sqFuÎ
(
Th»adID
 
tid
);

241 
boŞ
 
	`isSÎed
();

246 
boŞ
 
	`isSÎed
(
Th»adID
 
tid
);

249 
boŞ
 
	`hasStÜesToWB
();

254 
boŞ
 
	$hasStÜesToWB
(
Th»adID
 
tid
)

255 {  
th»ad
[
tid
].
	`hasStÜesToWB
(); 
	}
}

258 
	$numStÜesToWB
(
Th»adID
 
tid
)

259 {  
th»ad
[
tid
].
	`numStÜesToWB
(); 
	}
}

262 
boŞ
 
wlWB
();

266 
boŞ
 
	$wlWB
(
Th»adID
 
tid
)

267 {  
th»ad
[
tid
].
	`wlWB
(); 
	}
}

270 
boŞ
 
	$ÿcheBlocked
() const

271 {  
»ŒyTid
 !ğ
Inv®idTh»adID
; 
	}
}

275 
	$£tR‘ryTid
(
Th»adID
 
tid
)

276 { 
»ŒyTid
 = 
tid
; 
	}
}

279 
	$dumpIn¡s
() const;

281 
	$dumpIn¡s
(
Th»adID
 
tid
) const

282 { 
th»ad
[
tid
].
	`dumpIn¡s
(); 
	}
}

287 
FauÉ
 
»ad
(
Reque¡PŒ
 
»q
, Reque¡PŒ 
¤eqLow
, Reque¡PŒ 
¤eqHigh
,

288 
ušt8_t
 *
d©a
, 
lßd_idx
);

293 
FauÉ
 
wr™e
(
Reque¡PŒ
 
»q
, Reque¡PŒ 
¤eqLow
, Reque¡PŒ 
¤eqHigh
,

294 
ušt8_t
 *
d©a
, 
¡Üe_idx
);

299 
»cvR‘ry
();

307 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

309 
»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
);

312 
O3CPU
 *
	gıu
;

315 
IEW
 *
	g›wSge
;

317 
	g´Ùeùed
:

319 
LSQPŞicy
 
lsqPŞicy
;

322 
LSQUn™
 *
	gth»ad
;

325 
	g¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

328 
	gLQEÁr›s
;

330 
	gSQEÁr›s
;

333 
	gmaxLQEÁr›s
;

336 
	gmaxSQEÁr›s
;

339 
Th»adID
 
	gnumTh»ads
;

343 
Th»adID
 
	g»ŒyTid
;

346 
	g‹m¶©e
 <
şass
 
	gIm¶
>

347 
FauÉ


348 
	gLSQ
<
	gIm¶
>::
	$»ad
(
Reque¡PŒ
 
»q
, Reque¡PŒ 
¤eqLow
, Reque¡PŒ 
¤eqHigh
,

349 
ušt8_t
 *
d©a
, 
lßd_idx
)

351 
Th»adID
 
tid
 = 
»q
->
	`th»adId
();

353  
th»ad
[
tid
].
	`»ad
(
»q
, 
¤eqLow
, 
¤eqHigh
, 
d©a
, 
lßd_idx
);

354 
	}
}

356 
	g‹m¶©e
 <
şass
 
	gIm¶
>

357 
FauÉ


358 
	gLSQ
<
	gIm¶
>::
	$wr™e
(
Reque¡PŒ
 
»q
, Reque¡PŒ 
¤eqLow
, Reque¡PŒ 
¤eqHigh
,

359 
ušt8_t
 *
d©a
, 
¡Üe_idx
)

361 
Th»adID
 
tid
 = 
»q
->
	`th»adId
();

363  
th»ad
[
tid
].
	`wr™e
(
»q
, 
¤eqLow
, 
¤eqHigh
, 
d©a
, 
¡Üe_idx
);

364 
	}
}

	@o3/lsq_impl.hh

43 #iâdeà
__CPU_O3_LSQ_IMPL_HH__


44 
	#__CPU_O3_LSQ_IMPL_HH__


	)

46 
	~<®gÜ™hm
>

47 
	~<li¡
>

48 
	~<¡ršg
>

50 
	~"ıu/o3/lsq.hh
"

51 
	~"debug/D¿š.hh
"

52 
	~"debug/F‘ch.hh
"

53 
	~"debug/LSQ.hh
"

54 
	~"debug/Wr™eback.hh
"

55 
	~"·¿ms/D”ivO3CPU.hh
"

57 
usšg
 
Çme¥aû
 
	g¡d
;

59 
	g‹m¶©e
 <
şass
 
	gIm¶
>

60 
	gLSQ
<
	gIm¶
>::
	$LSQ
(
O3CPU
 *
ıu_±r
, 
IEW
 *
›w_±r
, 
D”ivO3CPUP¬ams
 *
·¿ms
)

61 : 
	`ıu
(
ıu_±r
), 
	`›wSge
(
›w_±r
),

62 
	`LQEÁr›s
(
·¿ms
->
LQEÁr›s
),

63 
	`SQEÁr›s
(
·¿ms
->
SQEÁr›s
),

64 
	`numTh»ads
(
·¿ms
->
numTh»ads
),

65 
	`»ŒyTid
(-1)

67 
	`as£¹
(
numTh»ads
 > 0 &&‚umTh»ad <ğ
Im¶
::
MaxTh»ads
);

72 
¡d
::
¡ršg
 
pŞicy
 = 
·¿ms
->
smtLSQPŞicy
;

75 
¡d
::
	`ŒªsfÜm
(
pŞicy
.
	`begš
(),…Şicy.
	`’d
(),…olicy.begin(),

76 ((*)()è
tŞow”
);

79 ià(
pŞicy
 == "dynamic") {

80 
lsqPŞicy
 = 
DyÇmic
;

82 
maxLQEÁr›s
 = 
LQEÁr›s
;

83 
maxSQEÁr›s
 = 
SQEÁr›s
;

85 
	`DPRINTF
(
LSQ
, "LSQ sharing…olicy seto Dynamic\n");

86 } ià(
pŞicy
 == "partitioned") {

87 
lsqPŞicy
 = 
P¬t™iÚed
;

90 
maxLQEÁr›s
 = 
LQEÁr›s
 / 
numTh»ads
;

91 
maxSQEÁr›s
 = 
SQEÁr›s
 / 
numTh»ads
;

93 
	`DPRINTF
(
F‘ch
, "LSQ sharing…olicy seto Partitioned: "

95 
maxLQEÁr›s
,
maxSQEÁr›s
);

96 } ià(
pŞicy
 == "threshold") {

97 
lsqPŞicy
 = 
Th»shŞd
;

99 
	`as£¹
(
·¿ms
->
smtLSQTh»shŞd
 > 
LQEÁr›s
);

100 
	`as£¹
(
·¿ms
->
smtLSQTh»shŞd
 > 
SQEÁr›s
);

105 
maxLQEÁr›s
 = 
·¿ms
->
smtLSQTh»shŞd
;

106 
maxSQEÁr›s
 = 
·¿ms
->
smtLSQTh»shŞd
;

108 
	`DPRINTF
(
LSQ
, "LSQ sharing…olicy seto Threshold: "

110 
maxLQEÁr›s
,
maxSQEÁr›s
);

112 
	`as£¹
(0 && "Invalid LSQ Sharing Policy.Options Are:{Dynamic,"

117 
th»ad
 = 
Ãw
 
LSQUn™
[
numTh»ads
];

118 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

119 
th»ad
[
tid
].
	`š™
(
ıu
, 
›w_±r
, 
·¿ms
, 
this
,

120 
maxLQEÁr›s
, 
maxSQEÁr›s
, 
tid
);

121 
th»ad
[
tid
].
	`£tDÿchePÜt
(&
ıu_±r
->
	`g‘D©aPÜt
());

123 
	}
}

126 
	g‹m¶©e
<
şass
 
	gIm¶
>

127 
	g¡d
::
¡ršg


128 
LSQ
<
Im¶
>::
	$Çme
() const

130  
›wSge
->
	`Çme
() + ".lsq";

131 
	}
}

133 
	g‹m¶©e
<
şass
 
	gIm¶
>

135 
	gLSQ
<
	gIm¶
>::
	$»gSts
()

138 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

139 
th»ad
[
tid
].
	`»gSts
();

141 
	}
}

143 
	g‹m¶©e
<
şass
 
	gIm¶
>

145 
	gLSQ
<
	gIm¶
>::
£tAùiveTh»ads
(
li¡
<
Th»adID
> *
©_±r
)

147 
aùiveTh»ads
 = 
©_±r
;

148 
as£¹
(
aùiveTh»ads
 != 0);

151 
	g‹m¶©e
 <
şass
 
	gIm¶
>

153 
	gLSQ
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

155 
	`as£¹
(
	`isD¿šed
());

157 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++)

158 
th»ad
[
tid
].
	`d¿šSª™yCheck
();

159 
	}
}

161 
	g‹m¶©e
 <
şass
 
	gIm¶
>

162 
boŞ


163 
	gLSQ
<
	gIm¶
>::
	$isD¿šed
() const

165 
boŞ
 
	`d¿šed
(
Œue
);

167 ià(!
	`lqEm±y
()) {

168 
	`DPRINTF
(
D¿š
, "Not drained, LQ‚otƒmpty.\n");

169 
d¿šed
 = 
çl£
;

172 ià(!
	`sqEm±y
()) {

173 
	`DPRINTF
(
D¿š
, "Not drained, SQ‚otƒmpty.\n");

174 
d¿šed
 = 
çl£
;

177 ià(
»ŒyTid
 !ğ
Inv®idTh»adID
) {

178 
	`DPRINTF
(
D¿š
, "Not drained,he LSQ has blockedhe caches.\n");

179 
d¿šed
 = 
çl£
;

182  
d¿šed
;

183 
	}
}

185 
	g‹m¶©e
 <
şass
 
	gIm¶
>

187 
	gLSQ
<
	gIm¶
>::
	$keOv”From
()

189 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

190 
th»ad
[
tid
].
	`keOv”From
();

192 
	}
}

194 
	g‹m¶©e
 <
şass
 
	gIm¶
>

196 
	gLSQ
<
	gIm¶
>::
	$’ŒyAmouÁ
(
Th»adID
 
num_th»ads
)

198 ià(
lsqPŞicy
 =ğ
P¬t™iÚed
) {

199  
LQEÁr›s
 / 
num_th»ads
;

203 
	}
}

205 
	g‹m¶©e
 <
şass
 
	gIm¶
>

207 
	gLSQ
<
	gIm¶
>::
	$»£tEÁr›s
()

209 ià(
lsqPŞicy
 !ğ
DyÇmic
 || 
numTh»ads
 > 1) {

210 
aùive_th»ads
 = 
aùiveTh»ads
->
	`size
();

212 
maxEÁr›s
;

214 ià(
lsqPŞicy
 =ğ
P¬t™iÚed
) {

215 
maxEÁr›s
 = 
LQEÁr›s
 / 
aùive_th»ads
;

216 } ià(
lsqPŞicy
 =ğ
Th»shŞd
 && 
aùive_th»ads
 == 1) {

217 
maxEÁr›s
 = 
LQEÁr›s
;

219 
maxEÁr›s
 = 
LQEÁr›s
;

222 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

223 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

225 
th»ads
 !ğ
’d
) {

226 
Th»adID
 
tid
 = *
th»ads
++;

228 
	`»sizeEÁr›s
(
maxEÁr›s
, 
tid
);

231 
	}
}

233 
	g‹m¶©e
<
şass
 
	gIm¶
>

235 
	gLSQ
<
	gIm¶
>::
	$»moveEÁr›s
(
Th»adID
 
tid
)

237 
th»ad
[
tid
].
	`ş—rLQ
();

238 
th»ad
[
tid
].
	`ş—rSQ
();

239 
	}
}

241 
	g‹m¶©e
<
şass
 
	gIm¶
>

243 
	gLSQ
<
	gIm¶
>::
	$»sizeEÁr›s
(
size
, 
Th»adID
 
tid
)

245 
th»ad
[
tid
].
	`»sizeLQ
(
size
);

246 
th»ad
[
tid
].
	`»sizeSQ
(
size
);

247 
	}
}

249 
	g‹m¶©e
<
şass
 
	gIm¶
>

251 
	gLSQ
<
	gIm¶
>::
	$tick
()

253 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

254 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

256 
th»ads
 !ğ
’d
) {

257 
Th»adID
 
tid
 = *
th»ads
++;

259 
th»ad
[
tid
].
	`tick
();

261 
	}
}

263 
	g‹m¶©e
<
şass
 
	gIm¶
>

265 
	gLSQ
<
	gIm¶
>::
	$š£¹Lßd
(
DynIn¡PŒ
 &
lßd_š¡
)

267 
Th»adID
 
tid
 = 
lßd_š¡
->
th»adNumb”
;

269 
th»ad
[
tid
].
	`š£¹Lßd
(
lßd_š¡
);

270 
	}
}

272 
	g‹m¶©e
<
şass
 
	gIm¶
>

274 
	gLSQ
<
	gIm¶
>::
	$š£¹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
)

276 
Th»adID
 
tid
 = 
¡Üe_š¡
->
th»adNumb”
;

278 
th»ad
[
tid
].
	`š£¹StÜe
(
¡Üe_š¡
);

279 
	}
}

281 
	g‹m¶©e
<
şass
 
	gIm¶
>

282 
FauÉ


283 
	gLSQ
<
	gIm¶
>::
	$execu‹Lßd
(
DynIn¡PŒ
 &
š¡
)

285 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

287  
th»ad
[
tid
].
	`execu‹Lßd
(
š¡
);

288 
	}
}

290 
	g‹m¶©e
<
şass
 
	gIm¶
>

291 
FauÉ


292 
	gLSQ
<
	gIm¶
>::
	$execu‹StÜe
(
DynIn¡PŒ
 &
š¡
)

294 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

296  
th»ad
[
tid
].
	`execu‹StÜe
(
š¡
);

297 
	}
}

299 
	g‹m¶©e
<
şass
 
	gIm¶
>

301 
	gLSQ
<
	gIm¶
>::
	$wr™ebackStÜes
()

303 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

304 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

306 
th»ads
 !ğ
’d
) {

307 
Th»adID
 
tid
 = *
th»ads
++;

309 ià(
	`numStÜesToWB
(
tid
) > 0) {

310 
	`DPRINTF
(
Wr™eback
,"[tid:%i] Writing back stores. %i stores "

311 "avaabË fÜ Wr™eback.\n", 
tid
, 
	`numStÜesToWB
(tid));

314 
th»ad
[
tid
].
	`wr™ebackStÜes
();

316 
	}
}

318 
	g‹m¶©e
<
şass
 
	gIm¶
>

319 
boŞ


320 
	gLSQ
<
	gIm¶
>::
	$viŞ©iÚ
()

323 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

324 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

326 
th»ads
 !ğ
’d
) {

327 
Th»adID
 
tid
 = *
th»ads
++;

329 ià(
th»ad
[
tid
].
	`viŞ©iÚ
())

330  
Œue
;

333  
çl£
;

334 
	}
}

336 
	g‹m¶©e
 <
şass
 
	gIm¶
>

338 
	gLSQ
<
	gIm¶
>::
	$»cvR‘ry
()

340 ià(
»ŒyTid
 =ğ
Inv®idTh»adID
)

345 
cu¼_»Œy_tid
 = 
»ŒyTid
;

348 
»ŒyTid
 = -1;

349 
th»ad
[
cu¼_»Œy_tid
].
	`»cvR‘ry
();

350 
	}
}

352 
	g‹m¶©e
 <
şass
 
	gIm¶
>

353 
boŞ


354 
	gLSQ
<
	gIm¶
>::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

356 ià(
pkt
->
	`isE¼Ü
())

357 
	`DPRINTF
(
LSQ
, "Gotƒrror…acket back for‡ddress: %#X\n",

358 
pkt
->
	`g‘Addr
());

359 
th»ad
[
pkt
->
»q
->
	`th»adId
()].
	`com¶‘eD©aAcûss
(pkt);

360  
Œue
;

361 
	}
}

363 
	g‹m¶©e
 <
şass
 
	gIm¶
>

365 
	gLSQ
<
	gIm¶
>::
	$»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
)

367 
	`DPRINTF
(
LSQ
, "»ûived…kˆfÜ‡ddr:%#x %s\n", 
pkt
->
	`g‘Addr
(),

368 
pkt
->
	`cmdSŒšg
());

371 ià(
pkt
->
	`isInv®id©e
()) {

372 
	`DPRINTF
(
LSQ
, "received invalidation for‡ddr:%#x\n",

373 
pkt
->
	`g‘Addr
());

374 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

375 
th»ad
[
tid
].
	`checkSnoİ
(
pkt
);

378 
	}
}

380 
	g‹m¶©e
<
şass
 
	gIm¶
>

382 
	gLSQ
<
	gIm¶
>::
	$g‘CouÁ
()

384 
tÙ®
 = 0;

386 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

387 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

389 
th»ads
 !ğ
’d
) {

390 
Th»adID
 
tid
 = *
th»ads
++;

392 
tÙ®
 +ğ
	`g‘CouÁ
(
tid
);

395  
tÙ®
;

396 
	}
}

398 
	g‹m¶©e
<
şass
 
	gIm¶
>

400 
	gLSQ
<
	gIm¶
>::
	$numLßds
()

402 
tÙ®
 = 0;

404 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

405 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

407 
th»ads
 !ğ
’d
) {

408 
Th»adID
 
tid
 = *
th»ads
++;

410 
tÙ®
 +ğ
	`numLßds
(
tid
);

413  
tÙ®
;

414 
	}
}

416 
	g‹m¶©e
<
şass
 
	gIm¶
>

418 
	gLSQ
<
	gIm¶
>::
	$numStÜes
()

420 
tÙ®
 = 0;

422 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

423 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

425 
th»ads
 !ğ
’d
) {

426 
Th»adID
 
tid
 = *
th»ads
++;

428 
tÙ®
 +ğ
th»ad
[
tid
].
	`numStÜes
();

431  
tÙ®
;

432 
	}
}

434 
	g‹m¶©e
<
şass
 
	gIm¶
>

436 
	gLSQ
<
	gIm¶
>::
	$numF»eEÁr›s
()

438 
tÙ®
 = 0;

440 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

441 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

443 
th»ads
 !ğ
’d
) {

444 
Th»adID
 
tid
 = *
th»ads
++;

446 
tÙ®
 +ğ
th»ad
[
tid
].
	`numF»eEÁr›s
();

449  
tÙ®
;

450 
	}
}

452 
	g‹m¶©e
<
şass
 
	gIm¶
>

454 
	gLSQ
<
	gIm¶
>::
	$numF»eEÁr›s
(
Th»adID
 
tid
)

459  
th»ad
[
tid
].
	`numF»eEÁr›s
();

460 
	}
}

462 
	g‹m¶©e
<
şass
 
	gIm¶
>

463 
boŞ


464 
	gLSQ
<
	gIm¶
>::
	$isFuÎ
()

466 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

467 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

469 
th»ads
 !ğ
’d
) {

470 
Th»adID
 
tid
 = *
th»ads
++;

472 ià(!(
th»ad
[
tid
].
	`lqFuÎ
(è||h»ad[tid].
	`sqFuÎ
()))

473  
çl£
;

476  
Œue
;

477 
	}
}

479 
	g‹m¶©e
<
şass
 
	gIm¶
>

480 
boŞ


481 
	gLSQ
<
	gIm¶
>::
	$isFuÎ
(
Th»adID
 
tid
)

485 ià(
lsqPŞicy
 =ğ
DyÇmic
)

486  
	`isFuÎ
();

488  
th»ad
[
tid
].
	`lqFuÎ
(è||h»ad[tid].
	`sqFuÎ
();

489 
	}
}

491 
	g‹m¶©e
<
şass
 
	gIm¶
>

492 
boŞ


493 
	gLSQ
<
	gIm¶
>::
	$isEm±y
() const

495  
	`lqEm±y
(è&& 
	`sqEm±y
();

496 
	}
}

498 
	g‹m¶©e
<
şass
 
	gIm¶
>

499 
boŞ


500 
	gLSQ
<
	gIm¶
>::
	$lqEm±y
() const

502 
li¡
<
Th»adID
>::
cÚ¡_™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

503 
li¡
<
Th»adID
>::
cÚ¡_™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

505 
th»ads
 !ğ
’d
) {

506 
Th»adID
 
tid
 = *
th»ads
++;

508 ià(!
th»ad
[
tid
].
	`lqEm±y
())

509  
çl£
;

512  
Œue
;

513 
	}
}

515 
	g‹m¶©e
<
şass
 
	gIm¶
>

516 
boŞ


517 
	gLSQ
<
	gIm¶
>::
	$sqEm±y
() const

519 
li¡
<
Th»adID
>::
cÚ¡_™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

520 
li¡
<
Th»adID
>::
cÚ¡_™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

522 
th»ads
 !ğ
’d
) {

523 
Th»adID
 
tid
 = *
th»ads
++;

525 ià(!
th»ad
[
tid
].
	`sqEm±y
())

526  
çl£
;

529  
Œue
;

530 
	}
}

532 
	g‹m¶©e
<
şass
 
	gIm¶
>

533 
boŞ


534 
	gLSQ
<
	gIm¶
>::
	$lqFuÎ
()

536 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

537 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

539 
th»ads
 !ğ
’d
) {

540 
Th»adID
 
tid
 = *
th»ads
++;

542 ià(!
th»ad
[
tid
].
	`lqFuÎ
())

543  
çl£
;

546  
Œue
;

547 
	}
}

549 
	g‹m¶©e
<
şass
 
	gIm¶
>

550 
boŞ


551 
	gLSQ
<
	gIm¶
>::
	$lqFuÎ
(
Th»adID
 
tid
)

555 ià(
lsqPŞicy
 =ğ
DyÇmic
)

556  
	`lqFuÎ
();

558  
th»ad
[
tid
].
	`lqFuÎ
();

559 
	}
}

561 
	g‹m¶©e
<
şass
 
	gIm¶
>

562 
boŞ


563 
	gLSQ
<
	gIm¶
>::
	$sqFuÎ
()

565 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

566 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

568 
th»ads
 !ğ
’d
) {

569 
Th»adID
 
tid
 = *
th»ads
++;

571 ià(!
	`sqFuÎ
(
tid
))

572  
çl£
;

575  
Œue
;

576 
	}
}

578 
	g‹m¶©e
<
şass
 
	gIm¶
>

579 
boŞ


580 
	gLSQ
<
	gIm¶
>::
	$sqFuÎ
(
Th»adID
 
tid
)

584 ià(
lsqPŞicy
 =ğ
DyÇmic
)

585  
	`sqFuÎ
();

587  
th»ad
[
tid
].
	`sqFuÎ
();

588 
	}
}

590 
	g‹m¶©e
<
şass
 
	gIm¶
>

591 
boŞ


592 
	gLSQ
<
	gIm¶
>::
	$isSÎed
()

594 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

595 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

597 
th»ads
 !ğ
’d
) {

598 
Th»adID
 
tid
 = *
th»ads
++;

600 ià(!
th»ad
[
tid
].
	`isSÎed
())

601  
çl£
;

604  
Œue
;

605 
	}
}

607 
	g‹m¶©e
<
şass
 
	gIm¶
>

608 
boŞ


609 
	gLSQ
<
	gIm¶
>::
	$isSÎed
(
Th»adID
 
tid
)

611 ià(
lsqPŞicy
 =ğ
DyÇmic
)

612  
	`isSÎed
();

614  
th»ad
[
tid
].
	`isSÎed
();

615 
	}
}

617 
	g‹m¶©e
<
şass
 
	gIm¶
>

618 
boŞ


619 
	gLSQ
<
	gIm¶
>::
	$hasStÜesToWB
()

621 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

622 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

624 
th»ads
 !ğ
’d
) {

625 
Th»adID
 
tid
 = *
th»ads
++;

627 ià(
	`hasStÜesToWB
(
tid
))

628  
Œue
;

631  
çl£
;

632 
	}
}

634 
	g‹m¶©e
<
şass
 
	gIm¶
>

635 
boŞ


636 
	gLSQ
<
	gIm¶
>::
	$wlWB
()

638 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

639 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

641 
th»ads
 !ğ
’d
) {

642 
Th»adID
 
tid
 = *
th»ads
++;

644 ià(
	`wlWB
(
tid
))

645  
Œue
;

648  
çl£
;

649 
	}
}

651 
	g‹m¶©e
<
şass
 
	gIm¶
>

653 
	gLSQ
<
	gIm¶
>::
	$dumpIn¡s
() const

655 
li¡
<
Th»adID
>::
cÚ¡_™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

656 
li¡
<
Th»adID
>::
cÚ¡_™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

658 
th»ads
 !ğ
’d
) {

659 
Th»adID
 
tid
 = *
th»ads
++;

661 
th»ad
[
tid
].
	`dumpIn¡s
();

663 
	}
}

	@o3/lsq_unit.cc

32 
	~"ıu/o3/i§_¥ecific.hh
"

33 
	~"ıu/o3/lsq_un™_im¶.hh
"

36 
‹m¶©e
 
şass
 
	gLSQUn™
<
	gO3CPUIm¶
>;

	@o3/lsq_unit.hh

44 #iâdeà
__CPU_O3_LSQ_UNIT_HH__


45 
	#__CPU_O3_LSQ_UNIT_HH__


	)

47 
	~<®gÜ™hm
>

48 
	~<c¡ršg
>

49 
	~<m­
>

50 
	~<queue
>

52 
	~"¬ch/g’”ic/debugçuÉs.hh
"

53 
	~"¬ch/i§_Œa™s.hh
"

54 
	~"¬ch/locked_mem.hh
"

55 
	~"¬ch/mm­³d_r.hh
"

56 
	~"ba£/hashm­.hh
"

57 
	~"cÚfig/the_i§.hh
"

58 
	~"ıu/š¡_£q.hh
"

59 
	~"ıu/timebuf.hh
"

60 
	~"debug/LSQUn™.hh
"

61 
	~"mem/·ck‘.hh
"

62 
	~"mem/pÜt.hh
"

63 
	~"sim/çuÉ_fwd.hh
"

65 
	gD”ivO3CPUP¬ams
;

79 
	g‹m¶©e
 <
şass
 
	gIm¶
>

80 şas 
	cLSQUn™
 {

81 
	mpublic
:

82 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

83 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

84 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tIEW
 IEW;

85 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tLSQ
 LSQ;

86 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
::
	tIssueSŒuù
 IssueStruct;

88 
	mpublic
:

90 
LSQUn™
();

93 
š™
(
O3CPU
 *
ıu_±r
, 
IEW
 *
›w_±r
, 
D”ivO3CPUP¬ams
 *
·¿ms
,

94 
LSQ
 *
lsq_±r
, 
maxLQEÁr›s
, 
maxSQEÁr›s
,

95 
id
);

98 
	m¡d
::
¡ršg
 
	$Çme
() const;

101 
	`»gSts
();

104 
	`£tDÿchePÜt
(
Ma¡”PÜt
 *
dÿche_pÜt
);

107 
	$d¿šSª™yCheck
() const;

110 
	`keOv”From
();

117 
	$tick
(è{ 
u£dPÜts
 = 0; }

120 
	`š£¹
(
DynIn¡PŒ
 &
š¡
);

122 
	`š£¹Lßd
(
DynIn¡PŒ
 &
lßd_š¡
);

124 
	`š£¹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
);

132 
FauÉ
 
	`checkViŞ©iÚs
(
lßd_idx
, 
DynIn¡PŒ
 &
š¡
);

138 
	`checkSnoİ
(
Pack‘PŒ
 
pkt
);

141 
FauÉ
 
	`execu‹Lßd
(
DynIn¡PŒ
 &
š¡
);

143 
FauÉ
 
	$execu‹Lßd
(
lq_idx
è{ 
	`·nic
("NÙ im¶em’‹d");  
NoFauÉ
; 
	}
}

145 
FauÉ
 
execu‹StÜe
(
DynIn¡PŒ
 &
š¡
);

148 
comm™Lßd
();

150 
comm™Lßds
(
In¡SeqNum
 &
younge¡_š¡
);

153 
comm™StÜes
(
In¡SeqNum
 &
younge¡_š¡
);

156 
wr™ebackStÜes
();

160 
com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
);

163 
ş—rLQ
();

166 
ş—rSQ
();

169 
»sizeLQ
(
size
);

172 
»sizeSQ
(
size
);

175 
squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
);

180 
boŞ
 
	$viŞ©iÚ
(è{  
memD•ViŞ©Ü
; 
	}
}

183 
DynIn¡PŒ
 
g‘MemD•ViŞ©Ü
();

186 
boŞ
 
	$lßdBlocked
()

187 {  
isLßdBlocked
; 
	}
}

190 
	$ş—rLßdBlocked
()

191 { 
isLßdBlocked
 = 
çl£
; 
	}
}

194 
boŞ
 
	$isLßdBlockedHªdËd
()

195 {  
lßdBlockedHªdËd
; 
	}
}

198 
	$£tLßdBlockedHªdËd
()

199 { 
lßdBlockedHªdËd
 = 
Œue
; 
	}
}

202 
numF»eEÁr›s
();

205 
	$numLßds
(è{  
lßds
; 
	}
}

208 
	$numStÜes
(è{  
¡Ües
; 
	}
}

211 
boŞ
 
	$isFuÎ
(è{  
	`lqFuÎ
(è|| 
	`sqFuÎ
(); 
	}
}

214 
boŞ
 
	$isEm±y
(ècÚ¡ {  
	`lqEm±y
(è&& 
	`sqEm±y
(); 
	}
}

217 
boŞ
 
	$lqFuÎ
(è{  
lßds
 >ğ(
LQEÁr›s
 - 1); 
	}
}

220 
boŞ
 
	$sqFuÎ
(è{  
¡Ües
 >ğ(
SQEÁr›s
 - 1); 
	}
}

223 
boŞ
 
	$lqEm±y
(ècÚ¡ {  
lßds
 =ğ0; 
	}
}

226 
boŞ
 
	$sqEm±y
(ècÚ¡ {  
¡Ües
 =ğ0; 
	}
}

229 
	$g‘CouÁ
(è{  
lßds
 + 
¡Ües
; 
	}
}

232 
boŞ
 
	$hasStÜesToWB
(è{  
¡ÜesToWB
; 
	}
}

235 
	$numStÜesToWB
(è{  
¡ÜesToWB
; 
	}
}

238 
boŞ
 
	$wlWB
(è{  
¡ÜeQueue
[
¡ÜeWBIdx
].
ÿnWB
 &&

239 !
¡ÜeQueue
[
¡ÜeWBIdx
].
com¶‘ed
 &&

240 !
isStÜeBlocked
; 
	}
}

243 
»cvR‘ry
();

245 
	g´iv©e
:

247 
»£tS‹
();

250 
wr™eback
(
DynIn¡PŒ
 &
š¡
, 
Pack‘PŒ
 
pkt
);

253 
wr™ebackP’dšgStÜe
();

256 
¡ÜePo¡S’d
(
Pack‘PŒ
 
pkt
);

259 
com¶‘eStÜe
(
¡Üe_idx
);

262 
boŞ
 
£ndStÜe
(
Pack‘PŒ
 
d©a_pkt
);

265 
šlše
 
	$šüStIdx
(&
¡Üe_idx
) const;

267 
šlše
 
	$deüStIdx
(&
¡Üe_idx
) const;

269 
šlše
 
	$šüLdIdx
(&
lßd_idx
) const;

271 
šlše
 
	$deüLdIdx
(&
lßd_idx
) const;

273 
public
:

275 
	$dumpIn¡s
() const;

277 
´iv©e
:

279 
O3CPU
 *
ıu
;

282 
IEW
 *
›wSge
;

285 
LSQ
 *
lsq
;

288 
Ma¡”PÜt
 *
dÿchePÜt
;

291 şas 
	cLSQS’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


293 
public
:

295 
	`LSQS’d”S‹
()

296 : 
	`mašPkt
(
NULL
), 
	`³ndšgPack‘
(NULL), 
	`out¡ªdšg
(1),

297 
	`noWB
(
çl£
), 
	`isS¶™
(çl£), 
	`pktToS’d
(false)

301 
DynIn¡PŒ
 
š¡
;

303 
Pack‘PŒ
 
mašPkt
;

305 
Pack‘PŒ
 
³ndšgPack‘
;

307 
ušt8_t
 
idx
;

309 
ušt8_t
 
out¡ªdšg
;

311 
boŞ
 
isLßd
;

313 
boŞ
 
noWB
;

315 
boŞ
 
isS¶™
;

317 
boŞ
 
pktToS’d
;

320 
šlše
 
boŞ
 
	`com¶‘e
(è{  --
out¡ªdšg
 == 0; }

321 
	}
};

324 şas 
	cWr™ebackEv’t
 : 
public
 
Ev’t
 {

325 
public
:

327 
Wr™ebackEv’t
(
DynIn¡PŒ
 &
_š¡
, 
Pack‘PŒ
 
pkt
, 
LSQUn™
 *
lsq_±r
);

330 
´oûss
();

333 cÚ¡ *
desütiÚ
() const;

335 
	g´iv©e
:

337 
DynIn¡PŒ
 
š¡
;

340 
Pack‘PŒ
 
	gpkt
;

343 
	gLSQUn™
<
	gIm¶
> *
	glsqPŒ
;

346 
	gpublic
:

347 
	sSQEÁry
 {

349 
SQEÁry
()

350 : 
š¡
(
NULL
), 
»q
(NULL), 
size
(0),

351 
ÿnWB
(0), 
comm™‹d
(0), 
com¶‘ed
(0)

353 
	g¡d
::
mem£t
(
d©a
, 0, (data));

356 ~
SQEÁry
()

358 
	gš¡
 = 
NULL
;

362 
SQEÁry
(
DynIn¡PŒ
 &
_š¡
)

363 : 
š¡
(
_š¡
), 
»q
(
NULL
), 
¤eqLow
(NULL), 
¤eqHigh
(NULL), 
size
(0),

364 
isS¶™
(0), 
ÿnWB
(0), 
comm™‹d
(0), 
com¶‘ed
(0)

366 
	g¡d
::
mem£t
(
d©a
, 0, (data));

369 
	gd©a
[16];

371 
DynIn¡PŒ
 
	gš¡
;

373 
Reque¡PŒ
 
	g»q
;

375 
Reque¡PŒ
 
	g¤eqLow
;

376 
Reque¡PŒ
 
	g¤eqHigh
;

378 
ušt8_t
 
	gsize
;

380 
boŞ
 
	gisS¶™
;

382 
boŞ
 
	gÿnWB
;

384 
boŞ
 
	gcomm™‹d
;

386 
boŞ
 
	gcom¶‘ed
;

389 
	g´iv©e
:

391 
Th»adID
 
lsqID
;

394 
	g¡d
::
veùÜ
<
SQEÁry
> 
¡ÜeQueue
;

397 
	g¡d
::
veùÜ
<
DynIn¡PŒ
> 
lßdQueue
;

402 
	gLQEÁr›s
;

406 
	gSQEÁr›s
;

411 
	gd•CheckShiá
;

414 
boŞ
 
	gcheckLßds
;

417 
	glßds
;

419 
	g¡Ües
;

421 
	g¡ÜesToWB
;

424 
	glßdH—d
;

426 
	glßdTa
;

429 
	g¡ÜeH—d
;

433 
	g¡ÜeWBIdx
;

435 
	g¡ÜeTa
;

439 
	gÿchePÜts
;

442 
	gu£dPÜts
;

447 
Addr
 
	gÿcheBlockMask
;

450 
ty³Çme
 
	gTimeBufãr
<
	gIssueSŒuù
>::
wœe
 
äomIssue
;

453 
boŞ
 
	g¡®Ëd
;

457 
In¡SeqNum
 
	g¡®lšgStÜeI¢
;

459 
	g¡®lšgLßdIdx
;

462 
Pack‘PŒ
 
	g»ŒyPkt
;

465 
boŞ
 
	gisStÜeBlocked
;

468 
boŞ
 
	gisLßdBlocked
;

471 
boŞ
 
	glßdBlockedHªdËd
;

474 
boŞ
 
	g¡ÜeInFlight
;

477 
In¡SeqNum
 
	gblockedLßdSeqNum
;

480 
DynIn¡PŒ
 
	gmemD•ViŞ©Ü
;

484 
boŞ
 
	ghasP’dšgPkt
;

487 
Pack‘PŒ
 
	g³ndšgPkt
;

490 
boŞ
 
	gÃedsTSO
;

496 
	gSts
::
SÿÏr
 
lsqFÜwLßds
;

499 
	gSts
::
SÿÏr
 
švAddrLßds
;

502 
	gSts
::
SÿÏr
 
lsqSquashedLßds
;

506 
	gSts
::
SÿÏr
 
lsqIgnÜedRe¥Ú£s
;

509 
	gSts
::
SÿÏr
 
lsqMemOrd”ViŞ©iÚ
;

512 
	gSts
::
SÿÏr
 
lsqSquashedStÜes
;

515 
	gSts
::
SÿÏr
 
švAddrSwpfs
;

518 
	gSts
::
SÿÏr
 
lsqBlockedLßds
;

521 
	gSts
::
SÿÏr
 
lsqRescheduËdLßds
;

524 
	gSts
::
SÿÏr
 
lsqCacheBlocked
;

526 
	gpublic
:

528 
FauÉ
 
»ad
(
Reque¡
 *
»q
, Reque¡ *
¤eqLow
, Reque¡ *
¤eqHigh
,

529 
ušt8_t
 *
d©a
, 
lßd_idx
);

532 
FauÉ
 
wr™e
(
Reque¡
 *
»q
, Reque¡ *
¤eqLow
, Reque¡ *
¤eqHigh
,

533 
ušt8_t
 *
d©a
, 
¡Üe_idx
);

536 
	$g‘LßdH—d
(è{  
lßdH—d
; 
	}
}

538 
In¡SeqNum
 
	$g‘LßdH—dSeqNum
()

540 ià(
lßdQueue
[
lßdH—d
]) {

541  
lßdQueue
[
lßdH—d
]->
£qNum
;

546 
	}
}

549 
	$g‘StÜeH—d
(è{  
¡ÜeH—d
; 
	}
}

551 
In¡SeqNum
 
	$g‘StÜeH—dSeqNum
()

553 ià(
¡ÜeQueue
[
¡ÜeH—d
].
š¡
) {

554  
¡ÜeQueue
[
¡ÜeH—d
].
š¡
->
£qNum
;

559 
	}
}

562 
boŞ
 
	$isSÎed
(è{  
¡®Ëd
; 
	}
}

565 
	g‹m¶©e
 <
şass
 
	gIm¶
>

566 
FauÉ


567 
	gLSQUn™
<
	gIm¶
>::
	$»ad
(
Reque¡
 *
»q
, Reque¡ *
¤eqLow
, Reque¡ *
¤eqHigh
,

568 
ušt8_t
 *
d©a
, 
lßd_idx
)

570 
DynIn¡PŒ
 
lßd_š¡
 = 
lßdQueue
[
lßd_idx
];

572 
	`as£¹
(
lßd_š¡
);

574 
	`as£¹
(!
lßd_š¡
->
	`isExecu‹d
());

580 ià(
»q
->
	`isUnÿch—bË
() &&

581 (
lßd_idx
 !ğ
lßdH—d
 || !
lßd_š¡
->
	`isAtComm™
())) {

582 
›wSge
->
	`»scheduËMemIn¡
(
lßd_š¡
);

583 ++
lsqRescheduËdLßds
;

584 
	`DPRINTF
(
LSQUn™
, "Uncachable†oad [sn:%lli] PC %s\n",

585 
lßd_š¡
->
£qNum
,†ßd_š¡->
	`pcS‹
());

590 
d–‘e
 
»q
;

591 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¤eqLow
) {

592 
d–‘e
 
¤eqLow
;

593 
d–‘e
 
¤eqHigh
;

595  
Ãw
 
G’”icISA
::
	`M5PªicFauÉ
(

597 
lßd_š¡
->
£qNum
,†ßd_š¡->
	`pcS‹
());

601 
¡Üe_idx
 = 
lßd_š¡
->
sqIdx
;

603 
¡Üe_size
 = 0;

605 
	`DPRINTF
(
LSQUn™
, "Read called,†oad idx: %i, store idx: %i, "

607 
lßd_idx
, 
¡Üe_idx
, 
¡ÜeH—d
, 
»q
->
	`g‘Paddr
(),

608 
¤eqLow
 ? " split" : "");

610 ià(
»q
->
	`isLLSC
()) {

611 
	`as£¹
(!
¤eqLow
);

615 
lßd_š¡
->
	`»cÜdResuÉ
(
çl£
);

616 
TheISA
::
	`hªdËLockedR—d
(
lßd_š¡
.
	`g‘
(), 
»q
);

617 
lßd_š¡
->
	`»cÜdResuÉ
(
Œue
);

620 ià(
»q
->
	`isMm­³dI´
()) {

621 
	`as£¹
(!
lßd_š¡
->
memD©a
);

622 
lßd_š¡
->
memD©a
 = 
Ãw
 
ušt8_t
[64];

624 
Th»adCÚ‹xt
 *
th»ad
 = 
ıu
->
	`tcBa£
(
lsqID
);

625 
Cyşes
 
	`d–ay
(0);

626 
Pack‘PŒ
 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
MemCmd
::
R—dReq
);

628 ià(!
TheISA
::
HasUÇligÃdMemAcc
 || !
¤eqLow
) {

629 
d©a_pkt
->
	`d©aStic
(
lßd_š¡
->
memD©a
);

630 
d–ay
 = 
TheISA
::
	`hªdËI´R—d
(
th»ad
, 
d©a_pkt
);

632 
	`as£¹
(
¤eqLow
->
	`isMm­³dI´
(è&& 
¤eqHigh
->isMmappedIpr());

633 
Pack‘PŒ
 
f¡_d©a_pkt
 = 
Ãw
 
	`Pack‘
(
¤eqLow
, 
MemCmd
::
R—dReq
);

634 
Pack‘PŒ
 
¢d_d©a_pkt
 = 
Ãw
 
	`Pack‘
(
¤eqHigh
, 
MemCmd
::
R—dReq
);

636 
f¡_d©a_pkt
->
	`d©aStic
(
lßd_š¡
->
memD©a
);

637 
¢d_d©a_pkt
->
	`d©aStic
(
lßd_š¡
->
memD©a
 + 
¤eqLow
->
	`g‘Size
());

639 
d–ay
 = 
TheISA
::
	`hªdËI´R—d
(
th»ad
, 
f¡_d©a_pkt
);

640 
Cyşes
 
d–ay2
 = 
TheISA
::
	`hªdËI´R—d
(
th»ad
, 
¢d_d©a_pkt
);

641 ià(
d–ay2
 > 
d–ay
)

642 
d–ay
 = 
d–ay2
;

644 
d–‘e
 
¤eqLow
;

645 
d–‘e
 
¤eqHigh
;

646 
d–‘e
 
f¡_d©a_pkt
;

647 
d–‘e
 
¢d_d©a_pkt
;

649 
Wr™ebackEv’t
 *
wb
 = 
Ãw
 
	`Wr™ebackEv’t
(
lßd_š¡
, 
d©a_pkt
, 
this
);

650 
ıu
->
	`scheduË
(
wb
, cpu->
	`şockEdge
(
d–ay
));

651  
NoFauÉ
;

654 
¡Üe_idx
 != -1) {

656 ià(
¡Üe_idx
 =ğ
¡ÜeWBIdx
) {

661 ià(--
¡Üe_idx
 < 0)

662 
¡Üe_idx
 +ğ
SQEÁr›s
;

664 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

666 
¡Üe_size
 = 
¡ÜeQueue
[
¡Üe_idx
].
size
;

668 ià(
¡Üe_size
 == 0)

670 ià(
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`unÿch—bË
())

673 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`effAddrV®id
());

677 
boŞ
 
¡Üe_has_low”_lim™
 =

678 
»q
->
	`g‘Vaddr
(è>ğ
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
;

679 
boŞ
 
¡Üe_has_uµ”_lim™
 =

680 (
»q
->
	`g‘Vaddr
(è+„eq->
	`g‘Size
()) <=

681 (
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
 + 
¡Üe_size
);

682 
boŞ
 
low”_lßd_has_¡Üe_·¹
 =

683 
»q
->
	`g‘Vaddr
(è< (
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
 +

684 
¡Üe_size
);

685 
boŞ
 
uµ”_lßd_has_¡Üe_·¹
 =

686 (
»q
->
	`g‘Vaddr
(è+„eq->
	`g‘Size
()) >

687 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
;

690 ià((
¡Üe_has_low”_lim™
 && 
¡Üe_has_uµ”_lim™
)) {

692 
shiá_amt
 = 
»q
->
	`g‘Vaddr
(è- 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
;

694 
	`memıy
(
d©a
, 
¡ÜeQueue
[
¡Üe_idx
].d©¨+ 
shiá_amt
,

695 
»q
->
	`g‘Size
());

697 
	`as£¹
(!
lßd_š¡
->
memD©a
);

698 
lßd_š¡
->
memD©a
 = 
Ãw
 
ušt8_t
[64];

700 
	`memıy
(
lßd_š¡
->
memD©a
,

701 
¡ÜeQueue
[
¡Üe_idx
].
d©a
 + 
shiá_amt
, 
»q
->
	`g‘Size
());

703 
	`DPRINTF
(
LSQUn™
, "Forwarding from store idx %io†oado "

705 
¡Üe_idx
, 
»q
->
	`g‘Vaddr
(), 
d©a
);

707 
Pack‘PŒ
 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
MemCmd
::
R—dReq
);

708 
d©a_pkt
->
	`d©aStic
(
lßd_š¡
->
memD©a
);

710 
Wr™ebackEv’t
 *
wb
 = 
Ãw
 
	`Wr™ebackEv’t
(
lßd_š¡
, 
d©a_pkt
, 
this
);

715 
ıu
->
	`scheduË
(
wb
, 
	`curTick
());

718 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¤eqLow
) {

719 
d–‘e
 
¤eqLow
;

720 
d–‘e
 
¤eqHigh
;

723 ++
lsqFÜwLßds
;

724  
NoFauÉ
;

725 } ià((
¡Üe_has_low”_lim™
 && 
low”_lßd_has_¡Üe_·¹
) ||

726 (
¡Üe_has_uµ”_lim™
 && 
uµ”_lßd_has_¡Üe_·¹
) ||

727 (
low”_lßd_has_¡Üe_·¹
 && 
uµ”_lßd_has_¡Üe_·¹
)) {

733 ià(
¡ÜeQueue
[
¡Üe_idx
].
com¶‘ed
) {

734 
	`·nic
("Should‚ot check one ofhese");

740 ià(!
¡®Ëd
 ||

741 (
¡®Ëd
 &&

742 
lßd_š¡
->
£qNum
 <

743 
lßdQueue
[
¡®lšgLßdIdx
]->
£qNum
)) {

744 
¡®Ëd
 = 
Œue
;

745 
¡®lšgStÜeI¢
 = 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
;

746 
¡®lšgLßdIdx
 = 
lßd_idx
;

751 
›wSge
->
	`»scheduËMemIn¡
(
lßd_š¡
);

752 
›wSge
->
	`deüWb
(
lßd_š¡
->
£qNum
);

753 
lßd_š¡
->
	`ş—rIssued
();

754 ++
lsqRescheduËdLßds
;

758 
	`DPRINTF
(
LSQUn™
, "Load-store forwarding mis-match. "

760 
¡Üe_idx
, 
»q
->
	`g‘Vaddr
());

765 
d–‘e
 
»q
;

766 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¤eqLow
) {

767 
d–‘e
 
¤eqLow
;

768 
d–‘e
 
¤eqHigh
;

771  
NoFauÉ
;

776 
	`DPRINTF
(
LSQUn™
, "Doing memory‡ccess for inst [sn:%lli] PC %s\n",

777 
lßd_š¡
->
£qNum
,†ßd_š¡->
	`pcS‹
());

779 
	`as£¹
(!
lßd_š¡
->
memD©a
);

780 
lßd_š¡
->
memD©a
 = 
Ãw
 
ušt8_t
[64];

782 ++
u£dPÜts
;

785 
boŞ
 
com¶‘edFœ¡
 = 
çl£
;

786 ià(!
lsq
->
	`ÿcheBlocked
()) {

787 
MemCmd
 
commªd
 =

788 
»q
->
	`isLLSC
(è? 
MemCmd
::
LßdLockedReq
 : MemCmd::
R—dReq
;

789 
Pack‘PŒ
 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
commªd
);

790 
Pack‘PŒ
 
f¡_d©a_pkt
 = 
NULL
;

791 
Pack‘PŒ
 
¢d_d©a_pkt
 = 
NULL
;

793 
d©a_pkt
->
	`d©aStic
(
lßd_š¡
->
memD©a
);

795 
LSQS’d”S‹
 *
¡©e
 = 
Ãw
 LSQSenderState;

796 
¡©e
->
isLßd
 = 
Œue
;

797 
¡©e
->
idx
 = 
lßd_idx
;

798 
¡©e
->
š¡
 = 
lßd_š¡
;

799 
d©a_pkt
->
£nd”S‹
 = 
¡©e
;

801 ià(!
TheISA
::
HasUÇligÃdMemAcc
 || !
¤eqLow
) {

804 
f¡_d©a_pkt
 = 
d©a_pkt
;

808 
f¡_d©a_pkt
 = 
Ãw
 
	`Pack‘
(
¤eqLow
, 
commªd
);

809 
¢d_d©a_pkt
 = 
Ãw
 
	`Pack‘
(
¤eqHigh
, 
commªd
);

811 
f¡_d©a_pkt
->
	`d©aStic
(
lßd_š¡
->
memD©a
);

812 
¢d_d©a_pkt
->
	`d©aStic
(
lßd_š¡
->
memD©a
 + 
¤eqLow
->
	`g‘Size
());

814 
f¡_d©a_pkt
->
£nd”S‹
 = 
¡©e
;

815 
¢d_d©a_pkt
->
£nd”S‹
 = 
¡©e
;

817 
¡©e
->
isS¶™
 = 
Œue
;

818 
¡©e
->
out¡ªdšg
 = 2;

819 
¡©e
->
mašPkt
 = 
d©a_pkt
;

822 ià(!
dÿchePÜt
->
	`£ndTimšgReq
(
f¡_d©a_pkt
)) {

825 
d–‘e
 
¡©e
;

826 
d–‘e
 
d©a_pkt
->
»q
;

827 
d–‘e
 
d©a_pkt
;

828 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¤eqLow
) {

829 
d–‘e
 
f¡_d©a_pkt
->
»q
;

830 
d–‘e
 
f¡_d©a_pkt
;

831 
d–‘e
 
¢d_d©a_pkt
->
»q
;

832 
d–‘e
 
¢d_d©a_pkt
;

833 
¤eqLow
 = 
NULL
;

834 
¤eqHigh
 = 
NULL
;

837 
»q
 = 
NULL
;

841 
lsq
->
	`£tR‘ryTid
(
lsqID
);

842 } ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¤eqLow
) {

843 
com¶‘edFœ¡
 = 
Œue
;

850 ++
u£dPÜts
;

851 ià(!
dÿchePÜt
->
	`£ndTimšgReq
(
¢d_d©a_pkt
)) {

854 
d–‘e
 
¢d_d©a_pkt
->
»q
;

855 
d–‘e
 
¢d_d©a_pkt
;

857 
¡©e
->
	`com¶‘e
();

859 
»q
 = 
NULL
;

860 
¤eqHigh
 = 
NULL
;

862 
lsq
->
	`£tR‘ryTid
(
lsqID
);

869 ià(
lsq
->
	`ÿcheBlocked
()) {

870 ià(
»q
)

871 
d–‘e
 
»q
;

872 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¤eqLow
 && !
com¶‘edFœ¡
) {

873 
d–‘e
 
¤eqLow
;

874 
d–‘e
 
¤eqHigh
;

877 ++
lsqCacheBlocked
;

882 ià(!
com¶‘edFœ¡
)

883 
›wSge
->
	`deüWb
(
lßd_š¡
->
£qNum
);

886 ià(
isLßdBlocked
 && 
blockedLßdSeqNum
 < 
lßd_š¡
->
£qNum
)

887  
NoFauÉ
;

892 
isLßdBlocked
 = 
Œue
;

893 
lßdBlockedHªdËd
 = 
çl£
;

894 
blockedLßdSeqNum
 = 
lßd_š¡
->
£qNum
;

896  
NoFauÉ
;

899  
NoFauÉ
;

900 
	}
}

902 
	g‹m¶©e
 <
şass
 
	gIm¶
>

903 
FauÉ


904 
	gLSQUn™
<
	gIm¶
>::
	$wr™e
(
Reque¡
 *
»q
, Reque¡ *
¤eqLow
, Reque¡ *
¤eqHigh
,

905 
ušt8_t
 *
d©a
, 
¡Üe_idx
)

907 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

909 
	`DPRINTF
(
LSQUn™
, "Doing writeo store idx %i,‡ddr %#x data %#x"

911 
¡Üe_idx
, 
»q
->
	`g‘Paddr
(), 
d©a
, 
¡ÜeH—d
,

912 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
);

914 
¡ÜeQueue
[
¡Üe_idx
].
»q
 =„eq;

915 
¡ÜeQueue
[
¡Üe_idx
].
¤eqLow
 = sreqLow;

916 
¡ÜeQueue
[
¡Üe_idx
].
¤eqHigh
 = sreqHigh;

917 
size
 = 
»q
->
	`g‘Size
();

918 
¡ÜeQueue
[
¡Üe_idx
].
size
 = size;

919 
	`as£¹
(
size
 <ğ(
¡ÜeQueue
[
¡Üe_idx
].
d©a
));

923 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¤eqLow
) {

924 
¡ÜeQueue
[
¡Üe_idx
].
isS¶™
 = 
Œue
;

927 
	`memıy
(
¡ÜeQueue
[
¡Üe_idx
].
d©a
, d©a, 
size
);

931  
NoFauÉ
;

932 
	}
}

	@o3/lsq_unit_impl.hh

45 #iâdeà
__CPU_O3_LSQ_UNIT_IMPL_HH__


46 
	#__CPU_O3_LSQ_UNIT_IMPL_HH__


	)

48 
	~"¬ch/g’”ic/debugçuÉs.hh
"

49 
	~"¬ch/locked_mem.hh
"

50 
	~"ba£/¡r.hh
"

51 
	~"cÚfig/the_i§.hh
"

52 
	~"ıu/check”/ıu.hh
"

53 
	~"ıu/o3/lsq.hh
"

54 
	~"ıu/o3/lsq_un™.hh
"

55 
	~"debug/Aùiv™y.hh
"

56 
	~"debug/IEW.hh
"

57 
	~"debug/LSQUn™.hh
"

58 
	~"debug/O3PeV›w.hh
"

59 
	~"mem/·ck‘.hh
"

60 
	~"mem/»que¡.hh
"

62 
	g‹m¶©e
<
şass
 
	gIm¶
>

63 
	gLSQUn™
<
	gIm¶
>::
Wr™ebackEv’t
::
	$Wr™ebackEv’t
(
DynIn¡PŒ
 &
_š¡
, 
Pack‘PŒ
 
_pkt
,

64 
LSQUn™
 *
lsq_±r
)

65 : 
	`Ev’t
(
DeçuÉ_Pri
, 
AutoD–‘e
),

66 
	`š¡
(
_š¡
), 
	`pkt
(
_pkt
), 
	$lsqPŒ
(
lsq_±r
)

68 
	}
}

70 
	g‹m¶©e
<
şass
 
	gIm¶
>

72 
	gLSQUn™
<
	gIm¶
>::
Wr™ebackEv’t
::
	$´oûss
()

74 
	`as£¹
(!
lsqPŒ
->
ıu
->
	`sw™chedOut
());

76 
lsqPŒ
->
	`wr™eback
(
š¡
, 
pkt
);

78 ià(
pkt
->
£nd”S‹
)

79 
d–‘e
 
pkt
->
£nd”S‹
;

81 
d–‘e
 
pkt
->
»q
;

82 
d–‘e
 
pkt
;

83 
	}
}

85 
	g‹m¶©e
<
şass
 
	gIm¶
>

87 
	gLSQUn™
<
	gIm¶
>::
Wr™ebackEv’t
::
	$desütiÚ
() const

90 
	}
}

92 
	g‹m¶©e
<
şass
 
	gIm¶
>

94 
	gLSQUn™
<
	gIm¶
>::
	$com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
)

96 
LSQS’d”S‹
 *
¡©e
 = 
dyÇmic_ÿ¡
<LSQS’d”S‹ *>(
pkt
->
£nd”S‹
);

97 
DynIn¡PŒ
 
š¡
 = 
¡©e
->inst;

98 
	`DPRINTF
(
IEW
, "Wr™ebackƒv’ˆ[¢:%Îi].\n", 
š¡
->
£qNum
);

99 
	`DPRINTF
(
Aùiv™y
, "Aùiv™y: Wr™ebackƒv’ˆ[¢:%Îi].\n", 
š¡
->
£qNum
);

104 ià(
TheISA
::
HasUÇligÃdMemAcc
 && !
¡©e
->
	`com¶‘e
()) {

105 
d–‘e
 
pkt
->
»q
;

106 
d–‘e
 
pkt
;

110 
	`as£¹
(!
ıu
->
	`sw™chedOut
());

111 ià(
š¡
->
	`isSquashed
()) {

112 
›wSge
->
	`deüWb
(
š¡
->
£qNum
);

114 ià(!
¡©e
->
noWB
) {

115 ià(!
TheISA
::
HasUÇligÃdMemAcc
 || !
¡©e
->
isS¶™
 ||

116 !
¡©e
->
isLßd
) {

117 
	`wr™eback
(
š¡
, 
pkt
);

119 
	`wr™eback
(
š¡
, 
¡©e
->
mašPkt
);

123 ià(
š¡
->
	`isStÜe
()) {

124 
	`com¶‘eStÜe
(
¡©e
->
idx
);

128 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¡©e
->
isS¶™
 && s‹->
isLßd
) {

129 
d–‘e
 
¡©e
->
mašPkt
->
»q
;

130 
d–‘e
 
¡©e
->
mašPkt
;

132 
d–‘e
 
¡©e
;

133 
d–‘e
 
pkt
->
»q
;

134 
d–‘e
 
pkt
;

135 
	}
}

137 
	g‹m¶©e
 <
şass
 
	gIm¶
>

138 
	gLSQUn™
<
	gIm¶
>::
	$LSQUn™
()

139 : 
	`lßds
(0), 
	`¡Ües
(0), 
	`¡ÜesToWB
(0), 
	`ÿcheBlockMask
(0), 
	`¡®Ëd
(
çl£
),

140 
	`isStÜeBlocked
(
çl£
), 
	`isLßdBlocked
(false),

141 
	`lßdBlockedHªdËd
(
çl£
), 
	`¡ÜeInFlight
(çl£), 
	$hasP’dšgPkt
(
çl£
)

143 
	}
}

145 
	g‹m¶©e
<
şass
 
	gIm¶
>

147 
	gLSQUn™
<
	gIm¶
>::
	$š™
(
O3CPU
 *
ıu_±r
, 
IEW
 *
›w_±r
, 
D”ivO3CPUP¬ams
 *
·¿ms
,

148 
LSQ
 *
lsq_±r
, 
maxLQEÁr›s
, 
maxSQEÁr›s
,

149 
id
)

151 
ıu
 = 
ıu_±r
;

152 
›wSge
 = 
›w_±r
;

154 
	`DPRINTF
(
LSQUn™
, "C»©šg LSQUn™%˜objeù.\n",
id
);

156 
lsq
 = 
lsq_±r
;

158 
lsqID
 = 
id
;

161 
LQEÁr›s
 = 
maxLQEÁr›s
 + 1;

162 
SQEÁr›s
 = 
maxSQEÁr›s
 + 1;

165 
	`as£¹
(
LQEÁr›s
 <= 256);

166 
	`as£¹
(
SQEÁr›s
 <= 256);

168 
lßdQueue
.
	`»size
(
LQEÁr›s
);

169 
¡ÜeQueue
.
	`»size
(
SQEÁr›s
);

171 
d•CheckShiá
 = 
·¿ms
->
LSQD•CheckShiá
;

172 
checkLßds
 = 
·¿ms
->
LSQCheckLßds
;

173 
ÿchePÜts
 = 
·¿ms
->cachePorts;

174 
ÃedsTSO
 = 
·¿ms
->needsTSO;

176 
	`»£tS‹
();

177 
	}
}

180 
	g‹m¶©e
<
şass
 
	gIm¶
>

182 
	gLSQUn™
<
	gIm¶
>::
	$»£tS‹
()

184 
lßds
 = 
¡Ües
 = 
¡ÜesToWB
 = 0;

186 
lßdH—d
 = 
lßdTa
 = 0;

188 
¡ÜeH—d
 = 
¡ÜeWBIdx
 = 
¡ÜeTa
 = 0;

190 
u£dPÜts
 = 0;

192 
»ŒyPkt
 = 
NULL
;

193 
memD•ViŞ©Ü
 = 
NULL
;

195 
blockedLßdSeqNum
 = 0;

197 
¡®Ëd
 = 
çl£
;

198 
isLßdBlocked
 = 
çl£
;

199 
lßdBlockedHªdËd
 = 
çl£
;

201 
ÿcheBlockMask
 = ~(
ıu
->
	`ÿcheLšeSize
() - 1);

202 
	}
}

204 
	g‹m¶©e
<
şass
 
	gIm¶
>

205 
	g¡d
::
¡ršg


206 
LSQUn™
<
Im¶
>::
	$Çme
() const

208 ià(
Im¶
::
MaxTh»ads
 == 1) {

209  
›wSge
->
	`Çme
() + ".lsq";

211  
›wSge
->
	`Çme
(è+ ".lsq.th»ad" + 
	`to_¡ršg
(
lsqID
);

213 
	}
}

215 
	g‹m¶©e
<
şass
 
	gIm¶
>

217 
	gLSQUn™
<
	gIm¶
>::
	$»gSts
()

219 
lsqFÜwLßds


220 .
	`Çme
(name() + ".forwLoads")

221 .
	`desc
("Number of†oadshat had data forwarded from stores");

223 
švAddrLßds


224 .
	`Çme
(name() + ".invAddrLoads")

225 .
	`desc
("Number of†oads ignored dueo‡n invalid‡ddress");

227 
lsqSquashedLßds


228 .
	`Çme
(name() + ".squashedLoads")

229 .
	`desc
("Number of†oads squashed");

231 
lsqIgnÜedRe¥Ú£s


232 .
	`Çme
(name() + ".ignoredResponses")

233 .
	`desc
("Number of memory„esponses ignored becausehe instruction is squashed");

235 
lsqMemOrd”ViŞ©iÚ


236 .
	`Çme
(name() + ".memOrderViolation")

237 .
	`desc
("Number of memory ordering violations");

239 
lsqSquashedStÜes


240 .
	`Çme
(name() + ".squashedStores")

241 .
	`desc
("Number of stores squashed");

243 
švAddrSwpfs


244 .
	`Çme
(name() + ".invAddrSwpfs")

245 .
	`desc
("Number of software…refetches ignored dueo‡n invalid‡ddress");

247 
lsqBlockedLßds


248 .
	`Çme
(name() + ".blockedLoads")

249 .
	`desc
("Number of blocked†oads dueo…artial†oad-store forwarding");

251 
lsqRescheduËdLßds


252 .
	`Çme
(name() + ".rescheduledLoads")

253 .
	`desc
("Number of†oadshat were„escheduled");

255 
lsqCacheBlocked


256 .
	`Çme
(name() + ".cacheBlocked")

257 .
	`desc
("Number ofimes‡n‡ccesso memory failed dueohe cache being blocked");

258 
	}
}

260 
	g‹m¶©e
<
şass
 
	gIm¶
>

262 
	gLSQUn™
<
	gIm¶
>::
	$£tDÿchePÜt
(
Ma¡”PÜt
 *
dÿche_pÜt
)

264 
dÿchePÜt
 = 
dÿche_pÜt
;

265 
	}
}

267 
	g‹m¶©e
<
şass
 
	gIm¶
>

269 
	gLSQUn™
<
	gIm¶
>::
	$ş—rLQ
()

271 
lßdQueue
.
	`ş—r
();

272 
	}
}

274 
	g‹m¶©e
<
şass
 
	gIm¶
>

276 
	gLSQUn™
<
	gIm¶
>::
	$ş—rSQ
()

278 
¡ÜeQueue
.
	`ş—r
();

279 
	}
}

281 
	g‹m¶©e
<
şass
 
	gIm¶
>

283 
	gLSQUn™
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

285 
i
 = 0; i < 
lßdQueue
.
	`size
(); ++i)

286 
	`as£¹
(!
lßdQueue
[
i
]);

288 
	`as£¹
(
¡ÜesToWB
 == 0);

289 
	`as£¹
(!
»ŒyPkt
);

290 
	}
}

292 
	g‹m¶©e
<
şass
 
	gIm¶
>

294 
	gLSQUn™
<
	gIm¶
>::
	$keOv”From
()

296 
	`»£tS‹
();

297 
	}
}

299 
	g‹m¶©e
<
şass
 
	gIm¶
>

301 
	gLSQUn™
<
	gIm¶
>::
	$»sizeLQ
(
size
)

303 
size_¶us_£Áš–
 = 
size
 + 1;

304 
	`as£¹
(
size_¶us_£Áš–
 >ğ
LQEÁr›s
);

306 ià(
size_¶us_£Áš–
 > 
LQEÁr›s
) {

307 
size_¶us_£Áš–
 > 
lßdQueue
.
	`size
()) {

308 
DynIn¡PŒ
 
dummy
;

309 
lßdQueue
.
	`push_back
(
dummy
);

310 
LQEÁr›s
++;

313 
LQEÁr›s
 = 
size_¶us_£Áš–
;

316 
	`as£¹
(
LQEÁr›s
 <= 256);

317 
	}
}

319 
	g‹m¶©e
<
şass
 
	gIm¶
>

321 
	gLSQUn™
<
	gIm¶
>::
	$»sizeSQ
(
size
)

323 
size_¶us_£Áš–
 = 
size
 + 1;

324 ià(
size_¶us_£Áš–
 > 
SQEÁr›s
) {

325 
size_¶us_£Áš–
 > 
¡ÜeQueue
.
	`size
()) {

326 
SQEÁry
 
dummy
;

327 
¡ÜeQueue
.
	`push_back
(
dummy
);

328 
SQEÁr›s
++;

331 
SQEÁr›s
 = 
size_¶us_£Áš–
;

334 
	`as£¹
(
SQEÁr›s
 <= 256);

335 
	}
}

337 
	g‹m¶©e
 <
şass
 
	gIm¶
>

339 
	gLSQUn™
<
	gIm¶
>::
	$š£¹
(
DynIn¡PŒ
 &
š¡
)

341 
	`as£¹
(
š¡
->
	`isMemRef
());

343 
	`as£¹
(
š¡
->
	`isLßd
(è|| in¡->
	`isStÜe
());

345 ià(
š¡
->
	`isLßd
()) {

346 
	`š£¹Lßd
(
š¡
);

348 
	`š£¹StÜe
(
š¡
);

351 
š¡
->
	`£tInLSQ
();

352 
	}
}

354 
	g‹m¶©e
 <
şass
 
	gIm¶
>

356 
	gLSQUn™
<
	gIm¶
>::
	$š£¹Lßd
(
DynIn¡PŒ
 &
lßd_š¡
)

358 
	`as£¹
((
lßdTa
 + 1è% 
LQEÁr›s
 !ğ
lßdH—d
);

359 
	`as£¹
(
lßds
 < 
LQEÁr›s
);

361 
	`DPRINTF
(
LSQUn™
, "Inserting†oad PC %s, idx:%i [sn:%lli]\n",

362 
lßd_š¡
->
	`pcS‹
(), 
lßdTa
,†ßd_š¡->
£qNum
);

364 
lßd_š¡
->
lqIdx
 = 
lßdTa
;

366 ià(
¡Ües
 == 0) {

367 
lßd_š¡
->
sqIdx
 = -1;

369 
lßd_š¡
->
sqIdx
 = 
¡ÜeTa
;

372 
lßdQueue
[
lßdTa
] = 
lßd_š¡
;

374 
	`šüLdIdx
(
lßdTa
);

376 ++
lßds
;

377 
	}
}

379 
	g‹m¶©e
 <
şass
 
	gIm¶
>

381 
	gLSQUn™
<
	gIm¶
>::
	$š£¹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
)

384 
	`as£¹
((
¡ÜeTa
 + 1è% 
SQEÁr›s
 !ğ
¡ÜeH—d
);

385 
	`as£¹
(
¡Ües
 < 
SQEÁr›s
);

387 
	`DPRINTF
(
LSQUn™
, "Inserting store PC %s, idx:%i [sn:%lli]\n",

388 
¡Üe_š¡
->
	`pcS‹
(), 
¡ÜeTa
, stÜe_š¡->
£qNum
);

390 
¡Üe_š¡
->
sqIdx
 = 
¡ÜeTa
;

391 
¡Üe_š¡
->
lqIdx
 = 
lßdTa
;

393 
¡ÜeQueue
[
¡ÜeTa
] = 
	`SQEÁry
(
¡Üe_š¡
);

395 
	`šüStIdx
(
¡ÜeTa
);

397 ++
¡Ües
;

398 
	}
}

400 
	g‹m¶©e
 <
şass
 
	gIm¶
>

401 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


402 
LSQUn™
<
Im¶
>::
	$g‘MemD•ViŞ©Ü
()

404 
DynIn¡PŒ
 
‹mp
 = 
memD•ViŞ©Ü
;

406 
memD•ViŞ©Ü
 = 
NULL
;

408  
‹mp
;

409 
	}
}

411 
	g‹m¶©e
 <
şass
 
	gIm¶
>

413 
	gLSQUn™
<
	gIm¶
>::
	$numF»eEÁr›s
()

415 
ä“_lq_’Œ›s
 = 
LQEÁr›s
 - 
lßds
;

416 
ä“_sq_’Œ›s
 = 
SQEÁr›s
 - 
¡Ües
;

420 ià(
ä“_lq_’Œ›s
 < 
ä“_sq_’Œ›s
) {

421  
ä“_lq_’Œ›s
 - 1;

423  
ä“_sq_’Œ›s
 - 1;

425 
	}
}

427 
	g‹m¶©e
 <
şass
 
	gIm¶
>

429 
	gLSQUn™
<
	gIm¶
>::
	$checkSnoİ
(
Pack‘PŒ
 
pkt
)

431 
lßd_idx
 = 
lßdH—d
;

437 
x
 = 0; x < 
ıu
->
	`numAùiveTh»ads
(); x++) {

438 
Th»adCÚ‹xt
 *
tc
 = 
ıu
->
	`g‘CÚ‹xt
(
x
);

439 
boŞ
 
no_squash
 = 
ıu
->
th»ad
[
x
]->
noSquashFromTC
;

440 
ıu
->
th»ad
[
x
]->
noSquashFromTC
 = 
Œue
;

441 
TheISA
::
	`hªdËLockedSnoİ
(
tc
, 
pkt
, 
ÿcheBlockMask
);

442 
ıu
->
th»ad
[
x
]->
noSquashFromTC
 = 
no_squash
;

446 ià(
lßd_idx
 =ğ
lßdTa
)

448 
	`šüLdIdx
(
lßd_idx
);

450 
	`DPRINTF
(
LSQUn™
, "GÙ snoİ fÜ‡dd»s %#x\n", 
pkt
->
	`g‘Addr
());

451 
Addr
 
šv®id©e_addr
 = 
pkt
->
	`g‘Addr
(è& 
ÿcheBlockMask
;

452 
lßd_idx
 !ğ
lßdTa
) {

453 
DynIn¡PŒ
 
ld_š¡
 = 
lßdQueue
[
lßd_idx
];

455 ià(!
ld_š¡
->
	`effAddrV®id
(è||†d_š¡->
	`unÿch—bË
()) {

456 
	`šüLdIdx
(
lßd_idx
);

460 
Addr
 
lßd_addr
 = 
ld_š¡
->
physEffAddr
 & 
ÿcheBlockMask
;

461 
	`DPRINTF
(
LSQUn™
, "-- inst [sn:%lli]†oad_addr: %#xo…ktAddr:%#x\n",

462 
ld_š¡
->
£qNum
, 
lßd_addr
, 
šv®id©e_addr
);

464 ià(
lßd_addr
 =ğ
šv®id©e_addr
) {

465 ià(
ld_š¡
->
	`possibËLßdViŞ©iÚ
()) {

466 
	`DPRINTF
(
LSQUn™
, "Conflicting†oad‡t‡ddr %#x [sn:%lli]\n",

467 
ld_š¡
->
physEffAddr
, 
pkt
->
	`g‘Addr
(),†d_š¡->
£qNum
);

470 
ld_š¡
->
çuÉ
 = 
Ãw
 
ReExec
;

475 
ld_š¡
->
	`h™Ex‹º®Snoİ
(
Œue
);

478 
	`šüLdIdx
(
lßd_idx
);

481 
	}
}

483 
	g‹m¶©e
 <
şass
 
	gIm¶
>

484 
FauÉ


485 
	gLSQUn™
<
	gIm¶
>::
	$checkViŞ©iÚs
(
lßd_idx
, 
DynIn¡PŒ
 &
š¡
)

487 
Addr
 
š¡_eff_addr1
 = 
š¡
->
effAddr
 >> 
d•CheckShiá
;

488 
Addr
 
š¡_eff_addr2
 = (
š¡
->
effAddr
 + in¡->
effSize
 - 1è>> 
d•CheckShiá
;

495 
lßd_idx
 !ğ
lßdTa
) {

496 
DynIn¡PŒ
 
ld_š¡
 = 
lßdQueue
[
lßd_idx
];

497 ià(!
ld_š¡
->
	`effAddrV®id
(è||†d_š¡->
	`unÿch—bË
()) {

498 
	`šüLdIdx
(
lßd_idx
);

502 
Addr
 
ld_eff_addr1
 = 
ld_š¡
->
effAddr
 >> 
d•CheckShiá
;

503 
Addr
 
ld_eff_addr2
 =

504 (
ld_š¡
->
effAddr
 +†d_š¡->
effSize
 - 1è>> 
d•CheckShiá
;

506 ià(
š¡_eff_addr2
 >ğ
ld_eff_addr1
 && 
š¡_eff_addr1
 <ğ
ld_eff_addr2
) {

507 ià(
š¡
->
	`isLßd
()) {

511 ià(
ld_š¡
->
	`h™Ex‹º®Snoİ
()) {

512 ià(!
memD•ViŞ©Ü
 ||

513 
ld_š¡
->
£qNum
 < 
memD•ViŞ©Ü
->seqNum) {

514 
	`DPRINTF
(
LSQUn™
, "Detected fault with inst [sn:%lli] "

516 
š¡
->
£qNum
, 
ld_š¡
->£qNum, 
ld_eff_addr1
);

517 
memD•ViŞ©Ü
 = 
ld_š¡
;

519 ++
lsqMemOrd”ViŞ©iÚ
;

521  
Ãw
 
G’”icISA
::
	`M5PªicFauÉ
(

524 
š¡
->
£qNum
, 
ld_š¡
->£qNum, 
ld_eff_addr1
);

530 
ld_š¡
->
	`possibËLßdViŞ©iÚ
(
Œue
);

531 
	`DPRINTF
(
LSQUn™
, "Found…ossible†oad violaiton‡t‡ddr: %#x"

533 
š¡_eff_addr1
, 
š¡
->
£qNum
, 
ld_š¡
->seqNum);

538 ià(
memD•ViŞ©Ü
 && 
ld_š¡
->
£qNum
 > memDepViolator->seqNum)

541 
	`DPRINTF
(
LSQUn™
, "Detected fault with inst [sn:%lli]‡nd "

543 
š¡
->
£qNum
, 
ld_š¡
->£qNum, 
ld_eff_addr1
);

544 
memD•ViŞ©Ü
 = 
ld_š¡
;

546 ++
lsqMemOrd”ViŞ©iÚ
;

548  
Ãw
 
G’”icISA
::
	`M5PªicFauÉ
("Detected fault with "

550 
š¡
->
£qNum
, 
ld_š¡
->£qNum, 
ld_eff_addr1
);

554 
	`šüLdIdx
(
lßd_idx
);

556  
NoFauÉ
;

557 
	}
}

562 
	g‹m¶©e
 <
şass
 
	gIm¶
>

563 
FauÉ


564 
	gLSQUn™
<
	gIm¶
>::
	$execu‹Lßd
(
DynIn¡PŒ
 &
š¡
)

566 
usšg
 
Çme¥aû
 
TheISA
;

568 
FauÉ
 
lßd_çuÉ
 = 
NoFauÉ
;

570 
	`DPRINTF
(
LSQUn™
, "Executing†oad PC %s, [sn:%lli]\n",

571 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

573 
	`as£¹
(!
š¡
->
	`isSquashed
());

575 
lßd_çuÉ
 = 
š¡
->
	`š™Ÿ‹Acc
();

577 ià(
š¡
->
	`isT¿n¦©iÚD–ayed
() &&

578 
lßd_çuÉ
 =ğ
NoFauÉ
)

579  
lßd_çuÉ
;

583 ià(
lßd_çuÉ
 !ğ
NoFauÉ
 || 
š¡
->
	`»adP»diÿ‹
(è=ğ
çl£
) {

588 ià(
š¡
->
	`»adP»diÿ‹
(è=ğ
çl£
)

589 
š¡
->
	`fÜw¬dOldRegs
();

590 
	`DPRINTF
(
LSQUn™
, "Load [sn:%lli]‚otƒxecuted from %s\n",

591 
š¡
->
£qNum
,

592 (
lßd_çuÉ
 !ğ
NoFauÉ
 ? "fault" : "predication"));

593 ià(!(
š¡
->
	`hasReque¡
(è&& in¡->
	`unÿch—bË
()) ||

594 
š¡
->
	`isAtComm™
()) {

595 
š¡
->
	`£tExecu‹d
();

597 
›wSge
->
	`š¡ToComm™
(
š¡
);

598 
›wSge
->
	`aùiv™yThisCyşe
();

599 } ià(!
	`lßdBlocked
()) {

600 
	`as£¹
(
š¡
->
	`effAddrV®id
());

601 
lßd_idx
 = 
š¡
->
lqIdx
;

602 
	`šüLdIdx
(
lßd_idx
);

604 ià(
checkLßds
)

605  
	`checkViŞ©iÚs
(
lßd_idx
, 
š¡
);

608  
lßd_çuÉ
;

609 
	}
}

611 
	g‹m¶©e
 <
şass
 
	gIm¶
>

612 
FauÉ


613 
	gLSQUn™
<
	gIm¶
>::
	$execu‹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
)

615 
usšg
 
Çme¥aû
 
TheISA
;

617 
	`as£¹
(
¡Ües
 != 0);

619 
¡Üe_idx
 = 
¡Üe_š¡
->
sqIdx
;

621 
	`DPRINTF
(
LSQUn™
, "Executing store PC %s [sn:%lli]\n",

622 
¡Üe_š¡
->
	`pcS‹
(), stÜe_š¡->
£qNum
);

624 
	`as£¹
(!
¡Üe_š¡
->
	`isSquashed
());

628 
lßd_idx
 = 
¡Üe_š¡
->
lqIdx
;

630 
FauÉ
 
¡Üe_çuÉ
 = 
¡Üe_š¡
->
	`š™Ÿ‹Acc
();

632 ià(
¡Üe_š¡
->
	`isT¿n¦©iÚD–ayed
() &&

633 
¡Üe_çuÉ
 =ğ
NoFauÉ
)

634  
¡Üe_çuÉ
;

636 ià(
¡Üe_š¡
->
	`»adP»diÿ‹
(è=ğ
çl£
)

637 
¡Üe_š¡
->
	`fÜw¬dOldRegs
();

639 ià(
¡ÜeQueue
[
¡Üe_idx
].
size
 == 0) {

640 
	`DPRINTF
(
LSQUn™
,"Fault on Store PC %s, [sn:%lli], Size = 0\n",

641 
¡Üe_š¡
->
	`pcS‹
(), stÜe_š¡->
£qNum
);

643  
¡Üe_çuÉ
;

644 } ià(
¡Üe_š¡
->
	`»adP»diÿ‹
(è=ğ
çl£
) {

645 
	`DPRINTF
(
LSQUn™
, "Store [sn:%lli]‚otƒxecuted from…redication\n",

646 
¡Üe_š¡
->
£qNum
);

647  
¡Üe_çuÉ
;

650 
	`as£¹
(
¡Üe_çuÉ
 =ğ
NoFauÉ
);

652 ià(
¡Üe_š¡
->
	`isStÜeCÚd™iÚ®
()) {

655 
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
 = 
Œue
;

657 ++
¡ÜesToWB
;

660  
	`checkViŞ©iÚs
(
lßd_idx
, 
¡Üe_š¡
);

662 
	}
}

664 
	g‹m¶©e
 <
şass
 
	gIm¶
>

666 
	gLSQUn™
<
	gIm¶
>::
	$comm™Lßd
()

668 
	`as£¹
(
lßdQueue
[
lßdH—d
]);

670 
	`DPRINTF
(
LSQUn™
, "Committing head†oad instruction, PC %s\n",

671 
lßdQueue
[
lßdH—d
]->
	`pcS‹
());

673 
lßdQueue
[
lßdH—d
] = 
NULL
;

675 
	`šüLdIdx
(
lßdH—d
);

677 --
lßds
;

678 
	}
}

680 
	g‹m¶©e
 <
şass
 
	gIm¶
>

682 
	gLSQUn™
<
	gIm¶
>::
	$comm™Lßds
(
In¡SeqNum
 &
younge¡_š¡
)

684 
	`as£¹
(
lßds
 =ğ0 || 
lßdQueue
[
lßdH—d
]);

686 
lßds
 !ğ0 && 
lßdQueue
[
lßdH—d
]->
£qNum
 <ğ
younge¡_š¡
) {

687 
	`comm™Lßd
();

689 
	}
}

691 
	g‹m¶©e
 <
şass
 
	gIm¶
>

693 
	gLSQUn™
<
	gIm¶
>::
	$comm™StÜes
(
In¡SeqNum
 &
younge¡_š¡
)

695 
	`as£¹
(
¡Ües
 =ğ0 || 
¡ÜeQueue
[
¡ÜeH—d
].
š¡
);

697 
¡Üe_idx
 = 
¡ÜeH—d
;

699 
¡Üe_idx
 !ğ
¡ÜeTa
) {

700 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

703 ià(!
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
) {

704 ià(
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
 > 
younge¡_š¡
) {

707 
	`DPRINTF
(
LSQUn™
, "Marking store‡s‡bleo write back, PC "

709 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`pcS‹
(),

710 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
);

712 
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
 = 
Œue
;

714 ++
¡ÜesToWB
;

717 
	`šüStIdx
(
¡Üe_idx
);

719 
	}
}

721 
	g‹m¶©e
 <
şass
 
	gIm¶
>

723 
	gLSQUn™
<
	gIm¶
>::
	$wr™ebackP’dšgStÜe
()

725 ià(
hasP’dšgPkt
) {

726 
	`as£¹
(
³ndšgPkt
 !ğ
NULL
);

729 ià(
	`£ndStÜe
(
³ndšgPkt
)) {

730 
	`¡ÜePo¡S’d
(
³ndšgPkt
);

732 
³ndšgPkt
 = 
NULL
;

733 
hasP’dšgPkt
 = 
çl£
;

735 
	}
}

737 
	g‹m¶©e
 <
şass
 
	gIm¶
>

739 
	gLSQUn™
<
	gIm¶
>::
	$wr™ebackStÜes
()

743 ià(
TheISA
::
HasUÇligÃdMemAcc
) {

744 
	`wr™ebackP’dšgStÜe
();

747 
¡ÜesToWB
 > 0 &&

748 
¡ÜeWBIdx
 !ğ
¡ÜeTa
 &&

749 
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
 &&

750 
¡ÜeQueue
[
¡ÜeWBIdx
].
ÿnWB
 &&

751 ((!
ÃedsTSO
è|| (!
¡ÜeInFlight
)) &&

752 
u£dPÜts
 < 
ÿchePÜts
) {

754 ià(
isStÜeBlocked
 || 
lsq
->
	`ÿcheBlocked
()) {

755 
	`DPRINTF
(
LSQUn™
, "Unableo write back‡ny more stores, cache"

762 ià(
¡ÜeQueue
[
¡ÜeWBIdx
].
size
 == 0) {

763 
	`com¶‘eStÜe
(
¡ÜeWBIdx
);

765 
	`šüStIdx
(
¡ÜeWBIdx
);

770 ++
u£dPÜts
;

772 ià(
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
->
	`isD©aP»ãtch
()) {

773 
	`šüStIdx
(
¡ÜeWBIdx
);

778 
	`as£¹
(
¡ÜeQueue
[
¡ÜeWBIdx
].
»q
);

779 
	`as£¹
(!
¡ÜeQueue
[
¡ÜeWBIdx
].
comm™‹d
);

781 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¡ÜeQueue
[
¡ÜeWBIdx
].
isS¶™
) {

782 
	`as£¹
(
¡ÜeQueue
[
¡ÜeWBIdx
].
¤eqLow
);

783 
	`as£¹
(
¡ÜeQueue
[
¡ÜeWBIdx
].
¤eqHigh
);

786 
DynIn¡PŒ
 
š¡
 = 
¡ÜeQueue
[
¡ÜeWBIdx
].inst;

788 
Reque¡
 *
»q
 = 
¡ÜeQueue
[
¡ÜeWBIdx
].req;

789 
Reque¡PŒ
 
¤eqLow
 = 
¡ÜeQueue
[
¡ÜeWBIdx
].sreqLow;

790 
Reque¡PŒ
 
¤eqHigh
 = 
¡ÜeQueue
[
¡ÜeWBIdx
].sreqHigh;

792 
¡ÜeQueue
[
¡ÜeWBIdx
].
comm™‹d
 = 
Œue
;

794 
	`as£¹
(!
š¡
->
memD©a
);

795 
š¡
->
memD©a
 = 
Ãw
 
ušt8_t
[64];

797 
	`memıy
(
š¡
->
memD©a
, 
¡ÜeQueue
[
¡ÜeWBIdx
].
d©a
, 
»q
->
	`g‘Size
());

799 
MemCmd
 
commªd
 =

800 
»q
->
	`isSw­
(è? 
MemCmd
::
Sw­Req
 :

801 (
»q
->
	`isLLSC
(è? 
MemCmd
::
StÜeCÚdReq
 : MemCmd::
Wr™eReq
);

802 
Pack‘PŒ
 
d©a_pkt
;

803 
Pack‘PŒ
 
¢d_d©a_pkt
 = 
NULL
;

805 
LSQS’d”S‹
 *
¡©e
 = 
Ãw
 LSQSenderState;

806 
¡©e
->
isLßd
 = 
çl£
;

807 
¡©e
->
idx
 = 
¡ÜeWBIdx
;

808 
¡©e
->
š¡
 = inst;

810 ià(!
TheISA
::
HasUÇligÃdMemAcc
 || !
¡ÜeQueue
[
¡ÜeWBIdx
].
isS¶™
) {

813 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
commªd
);

814 
d©a_pkt
->
	`d©aStic
(
š¡
->
memD©a
);

815 
d©a_pkt
->
£nd”S‹
 = 
¡©e
;

818 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
¤eqLow
, 
commªd
);

819 
¢d_d©a_pkt
 = 
Ãw
 
	`Pack‘
(
¤eqHigh
, 
commªd
);

821 
d©a_pkt
->
	`d©aStic
(
š¡
->
memD©a
);

822 
¢d_d©a_pkt
->
	`d©aStic
(
š¡
->
memD©a
 + 
¤eqLow
->
	`g‘Size
());

824 
d©a_pkt
->
£nd”S‹
 = 
¡©e
;

825 
¢d_d©a_pkt
->
£nd”S‹
 = 
¡©e
;

827 
¡©e
->
isS¶™
 = 
Œue
;

828 
¡©e
->
out¡ªdšg
 = 2;

831 
d–‘e
 
»q
;

832 
»q
 = 
¤eqLow
;

835 
	`DPRINTF
(
LSQUn™
, "D-Cache: Writing back store idx:%i PC:%s "

837 
¡ÜeWBIdx
, 
š¡
->
	`pcS‹
(),

838 
»q
->
	`g‘Paddr
(), ()*(
š¡
->
memD©a
),

839 
š¡
->
£qNum
);

842 ià(
š¡
->
	`isStÜeCÚd™iÚ®
()) {

843 
	`as£¹
(!
¡ÜeQueue
[
¡ÜeWBIdx
].
isS¶™
);

847 
š¡
->
	`»cÜdResuÉ
(
çl£
);

848 
boŞ
 
sucûss
 = 
TheISA
::
	`hªdËLockedWr™e
(
š¡
.
	`g‘
(), 
»q
);

849 
š¡
->
	`»cÜdResuÉ
(
Œue
);

851 ià(!
sucûss
) {

853 
	`DPRINTF
(
LSQUn™
, "Store conditional [sn:%lli] failed. "

855 
š¡
->
£qNum
);

856 
Wr™ebackEv’t
 *
wb
 = 
Ãw
 
	`Wr™ebackEv’t
(
š¡
, 
d©a_pkt
, 
this
);

857 
ıu
->
	`scheduË
(
wb
, 
	`curTick
() + 1);

858 ià(
ıu
->
check”
) {

861 
š¡
->
»qToV”ify
->
	`£tExŒaD©a
(0);

862 
š¡
->
	`com¶‘eAcc
(
d©a_pkt
);

864 
	`com¶‘eStÜe
(
¡ÜeWBIdx
);

865 
	`šüStIdx
(
¡ÜeWBIdx
);

870 
¡©e
->
noWB
 = 
Œue
;

873 
boŞ
 
¥l™
 =

874 
TheISA
::
HasUÇligÃdMemAcc
 && 
¡ÜeQueue
[
¡ÜeWBIdx
].
isS¶™
;

876 
Th»adCÚ‹xt
 *
th»ad
 = 
ıu
->
	`tcBa£
(
lsqID
);

878 ià(
»q
->
	`isMm­³dI´
()) {

879 
	`as£¹
(!
š¡
->
	`isStÜeCÚd™iÚ®
());

880 
TheISA
::
	`hªdËI´Wr™e
(
th»ad
, 
d©a_pkt
);

881 
d–‘e
 
d©a_pkt
;

882 ià(
¥l™
) {

883 
	`as£¹
(
¢d_d©a_pkt
->
»q
->
	`isMm­³dI´
());

884 
TheISA
::
	`hªdËI´Wr™e
(
th»ad
, 
¢d_d©a_pkt
);

885 
d–‘e
 
¢d_d©a_pkt
;

886 
d–‘e
 
¤eqLow
;

887 
d–‘e
 
¤eqHigh
;

889 
d–‘e
 
¡©e
;

890 
d–‘e
 
»q
;

891 
	`com¶‘eStÜe
(
¡ÜeWBIdx
);

892 
	`šüStIdx
(
¡ÜeWBIdx
);

893 } ià(!
	`£ndStÜe
(
d©a_pkt
)) {

894 
	`DPRINTF
(
IEW
, "D-Cache became blocked when writing [sn:%lli], will"

896 
š¡
->
£qNum
);

899 ià(
¥l™
) {

900 
¡©e
->
pktToS’d
 = 
Œue
;

901 
¡©e
->
³ndšgPack‘
 = 
¢d_d©a_pkt
;

906 ià(
¥l™
) {

907 
	`as£¹
(
¢d_d©a_pkt
);

910 ià(
u£dPÜts
 < 
ÿchePÜts
) {

911 ++
u£dPÜts
;

912 ià(
	`£ndStÜe
(
¢d_d©a_pkt
)) {

913 
	`¡ÜePo¡S’d
(
¢d_d©a_pkt
);

915 
	`DPRINTF
(
IEW
, "D-Cache became blocked when writing"

917 
š¡
->
£qNum
);

922 
	`as£¹
(
³ndšgPkt
 =ğ
NULL
);

923 
³ndšgPkt
 = 
¢d_d©a_pkt
;

924 
hasP’dšgPkt
 = 
Œue
;

929 
	`¡ÜePo¡S’d
(
d©a_pkt
);

935 
u£dPÜts
 = 0;

937 
	`as£¹
(
¡Ües
 >ğ0 && 
¡ÜesToWB
 >= 0);

938 
	}
}

954 
	g‹m¶©e
 <
şass
 
	gIm¶
>

956 
	gLSQUn™
<
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
)

958 
	`DPRINTF
(
LSQUn™
, "Squashing until [sn:%lli]!"

959 "(Lßds:%˜StÜes:%i)\n", 
squashed_num
, 
lßds
, 
¡Ües
);

961 
lßd_idx
 = 
lßdTa
;

962 
	`deüLdIdx
(
lßd_idx
);

964 
lßds
 !ğ0 && 
lßdQueue
[
lßd_idx
]->
£qNum
 > 
squashed_num
) {

965 
	`DPRINTF
(
LSQUn™
,"Load Instruction PC %s squashed, "

967 
lßdQueue
[
lßd_idx
]->
	`pcS‹
(),

968 
lßdQueue
[
lßd_idx
]->
£qNum
);

970 ià(
	`isSÎed
(è&& 
lßd_idx
 =ğ
¡®lšgLßdIdx
) {

971 
¡®Ëd
 = 
çl£
;

972 
¡®lšgStÜeI¢
 = 0;

973 
¡®lšgLßdIdx
 = 0;

977 
lßdQueue
[
lßd_idx
]->
	`£tSquashed
();

978 
lßdQueue
[
lßd_idx
] = 
NULL
;

979 --
lßds
;

982 
lßdTa
 = 
lßd_idx
;

984 
	`deüLdIdx
(
lßd_idx
);

985 ++
lsqSquashedLßds
;

988 ià(
isLßdBlocked
) {

989 ià(
squashed_num
 < 
blockedLßdSeqNum
) {

990 
isLßdBlocked
 = 
çl£
;

991 
lßdBlockedHªdËd
 = 
çl£
;

992 
blockedLßdSeqNum
 = 0;

996 ià(
memD•ViŞ©Ü
 && 
squashed_num
 < memD•ViŞ©Ü->
£qNum
) {

997 
memD•ViŞ©Ü
 = 
NULL
;

1000 
¡Üe_idx
 = 
¡ÜeTa
;

1001 
	`deüStIdx
(
¡Üe_idx
);

1003 
¡Ües
 != 0 &&

1004 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
 > 
squashed_num
) {

1006 ià(
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
) {

1010 
	`DPRINTF
(
LSQUn™
,"Store Instruction PC %s squashed, "

1012 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`pcS‹
(),

1013 
¡Üe_idx
, 
¡ÜeQueue
[¡Üe_idx].
š¡
->
£qNum
);

1017 ià(
	`isSÎed
() &&

1018 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

1019 
	`·nic
("Is stalled should have been cleared by stalling†oad!\n");

1020 
¡®Ëd
 = 
çl£
;

1021 
¡®lšgStÜeI¢
 = 0;

1025 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`£tSquashed
();

1026 
¡ÜeQueue
[
¡Üe_idx
].
š¡
 = 
NULL
;

1027 
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
 = 0;

1032 
d–‘e
 
¡ÜeQueue
[
¡Üe_idx
].
»q
;

1033 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¡ÜeQueue
[
¡Üe_idx
].
isS¶™
) {

1034 
d–‘e
 
¡ÜeQueue
[
¡Üe_idx
].
¤eqLow
;

1035 
d–‘e
 
¡ÜeQueue
[
¡Üe_idx
].
¤eqHigh
;

1037 
¡ÜeQueue
[
¡Üe_idx
].
¤eqLow
 = 
NULL
;

1038 
¡ÜeQueue
[
¡Üe_idx
].
¤eqHigh
 = 
NULL
;

1041 
¡ÜeQueue
[
¡Üe_idx
].
»q
 = 
NULL
;

1042 --
¡Ües
;

1045 
¡ÜeTa
 = 
¡Üe_idx
;

1047 
	`deüStIdx
(
¡Üe_idx
);

1048 ++
lsqSquashedStÜes
;

1050 
	}
}

1052 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1054 
	gLSQUn™
<
	gIm¶
>::
	$¡ÜePo¡S’d
(
Pack‘PŒ
 
pkt
)

1056 ià(
	`isSÎed
() &&

1057 
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

1058 
	`DPRINTF
(
LSQUn™
, "Unstalling, stalling store [sn:%lli] "

1060 
¡®lšgStÜeI¢
, 
¡®lšgLßdIdx
);

1061 
¡®Ëd
 = 
çl£
;

1062 
¡®lšgStÜeI¢
 = 0;

1063 
›wSge
->
	`»¶ayMemIn¡
(
lßdQueue
[
¡®lšgLßdIdx
]);

1066 ià(!
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
->
	`isStÜeCÚd™iÚ®
()) {

1070 
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
->
	`£tCom¶‘ed
();

1072 ià(
ıu
->
check”
) {

1073 
ıu
->
check”
->
	`v”ify
(
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
);

1077 ià(
ÃedsTSO
) {

1078 
¡ÜeInFlight
 = 
Œue
;

1081 
	`šüStIdx
(
¡ÜeWBIdx
);

1082 
	}
}

1084 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1086 
	gLSQUn™
<
	gIm¶
>::
	$wr™eback
(
DynIn¡PŒ
 &
š¡
, 
Pack‘PŒ
 
pkt
)

1088 
›wSge
->
	`wakeCPU
();

1091 ià(
š¡
->
	`isSquashed
()) {

1092 
›wSge
->
	`deüWb
(
š¡
->
£qNum
);

1093 
	`as£¹
(!
š¡
->
	`isStÜe
());

1094 ++
lsqIgnÜedRe¥Ú£s
;

1098 ià(!
š¡
->
	`isExecu‹d
()) {

1099 
š¡
->
	`£tExecu‹d
();

1102 
š¡
->
	`com¶‘eAcc
(
pkt
);

1106 
›wSge
->
	`š¡ToComm™
(
š¡
);

1108 
›wSge
->
	`aùiv™yThisCyşe
();

1111 
›wSge
->
	`checkMi¥»diùiÚ
(
š¡
);

1112 
	}
}

1114 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1116 
	gLSQUn™
<
	gIm¶
>::
	$com¶‘eStÜe
(
¡Üe_idx
)

1118 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

1119 
¡ÜeQueue
[
¡Üe_idx
].
com¶‘ed
 = 
Œue
;

1120 --
¡ÜesToWB
;

1124 
ıu
->
	`wakeCPU
();

1125 
ıu
->
	`aùiv™yThisCyşe
();

1127 ià(
¡Üe_idx
 =ğ
¡ÜeH—d
) {

1129 
	`šüStIdx
(
¡ÜeH—d
);

1131 --
¡Ües
;

1132 } 
¡ÜeQueue
[
¡ÜeH—d
].
com¶‘ed
 &&

1133 
¡ÜeH—d
 !ğ
¡ÜeTa
);

1135 
›wSge
->
upd©eLSQNextCyşe
 = 
Œue
;

1138 
	`DPRINTF
(
LSQUn™
, "Completing store [sn:%lli], idx:%i, store head "

1140 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
, stÜe_idx, 
¡ÜeH—d
);

1142 #ià
TRACING_ON


1143 ià(
	`DTRACE
(
O3PeV›w
)) {

1144 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
¡ÜeTick
 =

1145 
	`curTick
(è- 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
ãtchTick
;

1149 ià(
	`isSÎed
() &&

1150 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

1151 
	`DPRINTF
(
LSQUn™
, "Unstalling, stalling store [sn:%lli] "

1153 
¡®lšgStÜeI¢
, 
¡®lšgLßdIdx
);

1154 
¡®Ëd
 = 
çl£
;

1155 
¡®lšgStÜeI¢
 = 0;

1156 
›wSge
->
	`»¶ayMemIn¡
(
lßdQueue
[
¡®lšgLßdIdx
]);

1159 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`£tCom¶‘ed
();

1161 ià(
ÃedsTSO
) {

1162 
¡ÜeInFlight
 = 
çl£
;

1168 ià(
ıu
->
check”
) {

1169 
ıu
->
check”
->
	`v”ify
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

1171 
	}
}

1173 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1174 
boŞ


1175 
	gLSQUn™
<
	gIm¶
>::
	$£ndStÜe
(
Pack‘PŒ
 
d©a_pkt
)

1177 ià(!
dÿchePÜt
->
	`£ndTimšgReq
(
d©a_pkt
)) {

1179 
isStÜeBlocked
 = 
Œue
;

1180 ++
lsqCacheBlocked
;

1181 
	`as£¹
(
»ŒyPkt
 =ğ
NULL
);

1182 
»ŒyPkt
 = 
d©a_pkt
;

1183 
lsq
->
	`£tR‘ryTid
(
lsqID
);

1184  
çl£
;

1186  
Œue
;

1187 
	}
}

1189 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1191 
	gLSQUn™
<
	gIm¶
>::
	$»cvR‘ry
()

1193 ià(
isStÜeBlocked
) {

1194 
	`DPRINTF
(
LSQUn™
, "Receiving„etry: store blocked\n");

1195 
	`as£¹
(
»ŒyPkt
 !ğ
NULL
);

1197 
LSQS’d”S‹
 *
¡©e
 =

1198 
dyÇmic_ÿ¡
<
LSQS’d”S‹
 *>(
»ŒyPkt
->
£nd”S‹
);

1200 ià(
dÿchePÜt
->
	`£ndTimšgReq
(
»ŒyPkt
)) {

1202 ià(!
TheISA
::
HasUÇligÃdMemAcc
 || !
¡©e
->
pktToS’d
 ||

1203 
¡©e
->
³ndšgPack‘
 =ğ
»ŒyPkt
) {

1204 
¡©e
->
pktToS’d
 = 
çl£
;

1205 
	`¡ÜePo¡S’d
(
»ŒyPkt
);

1207 
»ŒyPkt
 = 
NULL
;

1208 
isStÜeBlocked
 = 
çl£
;

1209 
lsq
->
	`£tR‘ryTid
(
Inv®idTh»adID
);

1212 ià(
TheISA
::
HasUÇligÃdMemAcc
 && 
¡©e
->
pktToS’d
) {

1213 
	`as£¹
(
¡©e
->
³ndšgPack‘
);

1214 ià(
	`£ndStÜe
(
¡©e
->
³ndšgPack‘
)) {

1215 
	`¡ÜePo¡S’d
(
¡©e
->
³ndšgPack‘
);

1220 ++
lsqCacheBlocked
;

1221 
lsq
->
	`£tR‘ryTid
(
lsqID
);

1223 } ià(
isLßdBlocked
) {

1224 
	`DPRINTF
(
LSQUn™
, "Loads squashhemselves‡nd‡ll younger insts, "

1227 
	`DPRINTF
(
LSQUn™
, "Retry„eceived but LSQ is‚o†onger blocked.\n");

1229 
	}
}

1231 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1232 
šlše
 

1233 
	gLSQUn™
<
	gIm¶
>::
	$šüStIdx
(&
¡Üe_idx
) const

1235 ià(++
¡Üe_idx
 >ğ
SQEÁr›s
)

1236 
¡Üe_idx
 = 0;

1237 
	}
}

1239 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1240 
šlše
 

1241 
	gLSQUn™
<
	gIm¶
>::
	$deüStIdx
(&
¡Üe_idx
) const

1243 ià(--
¡Üe_idx
 < 0)

1244 
¡Üe_idx
 +ğ
SQEÁr›s
;

1245 
	}
}

1247 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1248 
šlše
 

1249 
	gLSQUn™
<
	gIm¶
>::
	$šüLdIdx
(&
lßd_idx
) const

1251 ià(++
lßd_idx
 >ğ
LQEÁr›s
)

1252 
lßd_idx
 = 0;

1253 
	}
}

1255 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1256 
šlše
 

1257 
	gLSQUn™
<
	gIm¶
>::
	$deüLdIdx
(&
lßd_idx
) const

1259 ià(--
lßd_idx
 < 0)

1260 
lßd_idx
 +ğ
LQEÁr›s
;

1261 
	}
}

1263 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1265 
	gLSQUn™
<
	gIm¶
>::
	$dumpIn¡s
() const

1267 
	`ırštf
("Load store queue: Dumping instructions.\n");

1268 
	`ırštf
("Lßd queusize: %i\n", 
lßds
);

1269 
	`ırštf
("Load queue: ");

1271 
lßd_idx
 = 
lßdH—d
;

1273 
lßd_idx
 !ğ
lßdTa
 && 
lßdQueue
[load_idx]) {

1274 cÚ¡ 
DynIn¡PŒ
 &
	`š¡
(
lßdQueue
[
lßd_idx
]);

1275 
	`ırštf
("%s.[¢:%i] ", 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

1277 
	`šüLdIdx
(
lßd_idx
);

1279 
	`ırštf
("\n");

1281 
	`ırštf
("StÜqueusize: %i\n", 
¡Ües
);

1282 
	`ırštf
("Store queue: ");

1284 
¡Üe_idx
 = 
¡ÜeH—d
;

1286 
¡Üe_idx
 !ğ
¡ÜeTa
 && 
¡ÜeQueue
[¡Üe_idx].
š¡
) {

1287 cÚ¡ 
DynIn¡PŒ
 &
	`š¡
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

1288 
	`ırštf
("%s.[¢:%i] ", 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

1290 
	`šüStIdx
(
¡Üe_idx
);

1293 
	`ırštf
("\n");

1294 
	}
}

	@o3/mem_dep_unit.cc

31 
	~"ıu/o3/i§_¥ecific.hh
"

32 
	~"ıu/o3/mem_d•_un™_im¶.hh
"

33 
	~"ıu/o3/¡Üe_£t.hh
"

35 #ifdeà
DEBUG


36 
	g‹m¶©e
 <>

38 
	gMemD•Un™
<
	gStÜeS‘
, 
	gO3CPUIm¶
>::
MemD•EÁry
::
memd•_couÁ
 = 0;

39 
	g‹m¶©e
 <>

41 
	gMemD•Un™
<
	gStÜeS‘
, 
	gO3CPUIm¶
>::
MemD•EÁry
::
memd•_š£¹
 = 0;

42 
	g‹m¶©e
 <>

44 
	gMemD•Un™
<
	gStÜeS‘
, 
	gO3CPUIm¶
>::
MemD•EÁry
::
memd•_”a£
 = 0;

49 
‹m¶©e
 
şass
 
	gMemD•Un™
<
	gStÜeS‘
, 
	gO3CPUIm¶
>;

	@o3/mem_dep_unit.hh

43 #iâdeà
__CPU_O3_MEM_DEP_UNIT_HH__


44 
	#__CPU_O3_MEM_DEP_UNIT_HH__


	)

46 
	~<li¡
>

47 
	~<£t
>

49 
	~"ba£/hashm­.hh
"

50 
	~"ba£/»fút.hh
"

51 
	~"ba£/¡©i¡ics.hh
"

52 
	~"ıu/š¡_£q.hh
"

53 
	~"debug/MemD•Un™.hh
"

55 
	sSNHash
 {

56 
size_t
 
İ”©Ü
(è(cÚ¡ 
	mIn¡SeqNum
 &
	m£q_num
) const {

57 
	ma
 = ()
£q_num
;

58 
	mhash
 = (((
a
 >> 14) ^ ((a >> 2) & 0xffff))) & 0x7FFFFFFF;

60  
	mhash
;

64 
	gD”ivO3CPUP¬ams
;

66 
	g‹m¶©e
 <
şass
 
	gIm¶
>

67 
şass
 
	gIn¡ruùiÚQueue
;

80 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

81 şas 
	cMemD•Un™


83 
	m´Ùeùed
:

84 
¡d
::
¡ršg
 
_Çme
;

86 
	mpublic
:

87 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

90 
MemD•Un™
();

93 
MemD•Un™
(
D”ivO3CPUP¬ams
 *
·¿ms
);

96 ~
MemD•Un™
();

99 
	m¡d
::
¡ršg
 
	$Çme
(ècÚ¡ {  
_Çme
; }

102 
	`š™
(
D”ivO3CPUP¬ams
 *
·¿ms
, 
Th»adID
 
tid
);

105 
	`»gSts
();

108 
	$d¿šSª™yCheck
() const;

111 
	`keOv”From
();

114 
	`£tIQ
(
In¡ruùiÚQueue
<
Im¶
> *
iq_±r
);

117 
	`š£¹
(
DynIn¡PŒ
 &
š¡
);

120 
	`š£¹NÚS³c
(
DynIn¡PŒ
 &
š¡
);

123 
	`š£¹B¬r›r
(
DynIn¡PŒ
 &
b¬r_š¡
);

126 
	`»gsR—dy
(
DynIn¡PŒ
 &
š¡
);

129 
	`nÚS³cIn¡R—dy
(
DynIn¡PŒ
 &
š¡
);

132 
	`»scheduË
(
DynIn¡PŒ
 &
š¡
);

137 
	`»¶ay
(
DynIn¡PŒ
 &
š¡
);

140 
	`com¶‘ed
(
DynIn¡PŒ
 &
š¡
);

143 
	`com¶‘eB¬r›r
(
DynIn¡PŒ
 &
š¡
);

146 
	`wakeD•’d’ts
(
DynIn¡PŒ
 &
š¡
);

151 
	`squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
, 
Th»adID
 
tid
);

154 
	`viŞ©iÚ
(
DynIn¡PŒ
 &
¡Üe_š¡
, DynIn¡PŒ &
viŞ©šg_lßd
);

157 
	`issue
(
DynIn¡PŒ
 &
š¡
);

160 
	`dumpLi¡s
();

162 
´iv©e
:

163 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

165 
şass
 
MemD•EÁry
;

167 
RefCouÁšgPŒ
<
	tMemD•EÁry
> 
	tMemD•EÁryPŒ
;

173 şas 
	cMemD•EÁry
 : 
public
 
RefCouÁed
 {

174 
public
:

176 
	`MemD•EÁry
(
DynIn¡PŒ
 &
Ãw_š¡
)

177 : 
	`š¡
(
Ãw_š¡
), 
	`»gsR—dy
(
çl£
), 
	`memD•R—dy
(false),

178 
	`com¶‘ed
(
çl£
), 
	`squashed
(false)

180 #ifdeà
DEBUG


181 ++
memd•_couÁ
;

183 
	`DPRINTF
(
MemD•Un™
, "Memory dependencyƒntry created. "

184 "memd•_couÁ=%˜%s\n", 
memd•_couÁ
, 
š¡
->
	`pcS‹
());

189 ~
	`MemD•EÁry
()

191 
i
 = 0; i < 
d•’dIn¡s
.
	`size
(); ++i) {

192 
d•’dIn¡s
[
i
] = 
NULL
;

194 #ifdeà
DEBUG


195 --
memd•_couÁ
;

197 
	`DPRINTF
(
MemD•Un™
, "Memory dependencyƒntry deleted. "

198 "memd•_couÁ=%˜%s\n", 
memd•_couÁ
, 
š¡
->
	`pcS‹
());

203 
¡d
::
¡ršg
 
	`Çme
() const {  "memdepentry"; }

206 
DynIn¡PŒ
 
š¡
;

209 
Li¡It
 
li¡It
;

212 
¡d
::
veùÜ
<
MemD•EÁryPŒ
> 
d•’dIn¡s
;

215 
boŞ
 
»gsR—dy
;

217 
boŞ
 
memD•R—dy
;

219 
boŞ
 
com¶‘ed
;

221 
boŞ
 
squashed
;

224 #ifdeà
DEBUG


225 
memd•_couÁ
;

226 
memd•_š£¹
;

227 
memd•_”a£
;

229 
	}
};

232 
šlše
 
	gMemD•EÁryPŒ
 &
fšdInHash
(cÚ¡ 
DynIn¡PŒ
 &
š¡
);

235 
šlše
 
moveToR—dy
(
MemD•EÁryPŒ
 &
»ady_š¡_’Œy
);

237 
	gm5
::
	thash_m­
<
	tIn¡SeqNum
, 
	tMemD•EÁryPŒ
, 
	tSNHash
> 
	tMemD•Hash
;

239 
ty³Çme
 
	tMemD•Hash
::
	t™”©Ü
 
	tMemD•HashIt
;

242 
MemD•Hash
 
	gmemD•Hash
;

245 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
[
Im¶
::
MaxTh»ads
];

248 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡sToR•Ïy
;

255 
MemD•P»d
 
	gd•P»d
;

258 
boŞ
 
	glßdB¬r›r
;

260 
In¡SeqNum
 
	glßdB¬r›rSN
;

262 
boŞ
 
	g¡ÜeB¬r›r
;

264 
In¡SeqNum
 
	g¡ÜeB¬r›rSN
;

267 
	gIn¡ruùiÚQueue
<
	gIm¶
> *
	giqPŒ
;

270 
	gid
;

273 
	gSts
::
SÿÏr
 
š£¹edLßds
;

275 
	gSts
::
SÿÏr
 
š£¹edStÜes
;

277 
	gSts
::
SÿÏr
 
cÚæiùšgLßds
;

279 
	gSts
::
SÿÏr
 
cÚæiùšgStÜes
;

	@o3/mem_dep_unit_impl.hh

43 #iâdeà
__CPU_O3_MEM_DEP_UNIT_IMPL_HH__


44 
	#__CPU_O3_MEM_DEP_UNIT_IMPL_HH__


	)

46 
	~<m­
>

48 
	~"ıu/o3/š¡_queue.hh
"

49 
	~"ıu/o3/mem_d•_un™.hh
"

50 
	~"debug/MemD•Un™.hh
"

51 
	~"·¿ms/D”ivO3CPU.hh
"

53 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

54 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$MemD•Un™
()

55 : 
	`lßdB¬r›r
(
çl£
), 
	`lßdB¬r›rSN
(0), 
	`¡ÜeB¬r›r
(false),

56 
	`¡ÜeB¬r›rSN
(0), 
	$iqPŒ
(
NULL
)

58 
	}
}

60 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

61 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$MemD•Un™
(
D”ivO3CPUP¬ams
 *
·¿ms
)

62 : 
	`_Çme
(
·¿ms
->
Çme
 + ".memdepunit"),

63 
	`d•P»d
(
·¿ms
->
¡Üe_£t_ş—r_³riod
,…¬ams->
SSITSize
,

64 
·¿ms
->
LFSTSize
),

65 
	`lßdB¬r›r
(
çl£
), 
	`lßdB¬r›rSN
(0), 
	`¡ÜeB¬r›r
(false),

66 
	`¡ÜeB¬r›rSN
(0), 
	$iqPŒ
(
NULL
)

68 
	`DPRINTF
(
MemD•Un™
, "Creating MemDepUnit object.\n");

69 
	}
}

71 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

72 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::~
	$MemD•Un™
()

74 
Th»adID
 
tid
 = 0;id < 
Im¶
::
MaxTh»ads
;id++) {

76 
Li¡It
 
š¡_li¡_™
 = 
š¡Li¡
[
tid
].
	`begš
();

78 
MemD•HashIt
 
hash_™
;

80 !
š¡Li¡
[
tid
].
	`em±y
()) {

81 
hash_™
 = 
memD•Hash
.
	`fšd
((*
š¡_li¡_™
)->
£qNum
);

83 
	`as£¹
(
hash_™
 !ğ
memD•Hash
.
	`’d
());

85 
memD•Hash
.
	`”a£
(
hash_™
);

87 
š¡Li¡
[
tid
].
	`”a£
(
š¡_li¡_™
++);

91 #ifdeà
DEBUG


92 
	`as£¹
(
MemD•EÁry
::
memd•_couÁ
 == 0);

94 
	}
}

96 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

98 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$š™
(
D”ivO3CPUP¬ams
 *
·¿ms
, 
Th»adID
 
tid
)

100 
	`DPRINTF
(
MemD•Un™
, "C»©šg MemD•Un™ %˜objeù.\n",
tid
);

102 
_Çme
 = 
	`c¥rštf
("%s.memD•%d", 
·¿ms
->
Çme
, 
tid
);

103 
id
 = 
tid
;

105 
d•P»d
.
	`š™
(
·¿ms
->
¡Üe_£t_ş—r_³riod
,…¬ams->
SSITSize
,

106 
·¿ms
->
LFSTSize
);

107 
	}
}

109 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

111 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$»gSts
()

113 
š£¹edLßds


114 .
	`Çme
(name() + ".insertedLoads")

115 .
	`desc
("Number of†oads insertedohe mem dependence unit.");

117 
š£¹edStÜes


118 .
	`Çme
(name() + ".insertedStores")

119 .
	`desc
("Number of stores insertedohe mem dependence unit.");

121 
cÚæiùšgLßds


122 .
	`Çme
(name() + ".conflictingLoads")

123 .
	`desc
("Number of conflicting†oads.");

125 
cÚæiùšgStÜes


126 .
	`Çme
(name() + ".conflictingStores")

127 .
	`desc
("Number of conflicting stores.");

128 
	}
}

130 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

132 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$d¿šSª™yCheck
() const

134 
	`as£¹
(
š¡sToR•Ïy
.
	`em±y
());

135 
	`as£¹
(
memD•Hash
.
	`em±y
());

136 
i
 = 0; i < 
Im¶
::
MaxTh»ads
; ++i)

137 
	`as£¹
(
š¡Li¡
[
i
].
	`em±y
());

138 
	`as£¹
(
š¡sToR•Ïy
.
	`em±y
());

139 
	`as£¹
(
memD•Hash
.
	`em±y
());

140 
	}
}

142 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

144 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$keOv”From
()

147 
lßdB¬r›r
 = 
¡ÜeB¬r›r
 = 
çl£
;

148 
lßdB¬r›rSN
 = 
¡ÜeB¬r›rSN
 = 0;

149 
d•P»d
.
	`ş—r
();

150 
	}
}

152 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

154 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
£tIQ
(
In¡ruùiÚQueue
<
Im¶
> *
iq_±r
)

156 
iqPŒ
 = 
iq_±r
;

159 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

161 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$š£¹
(
DynIn¡PŒ
 &
š¡
)

163 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

165 
MemD•EÁryPŒ
 
š¡_’Œy
 = 
Ãw
 
	`MemD•EÁry
(
š¡
);

168 
memD•Hash
.
	`š£¹
(

169 
¡d
::
·œ
<
In¡SeqNum
, 
MemD•EÁryPŒ
>(
š¡
->
£qNum
, 
š¡_’Œy
));

170 #ifdeà
DEBUG


171 
MemD•EÁry
::
memd•_š£¹
++;

174 
š¡Li¡
[
tid
].
	`push_back
(
š¡
);

176 
š¡_’Œy
->
li¡It
 = --(
š¡Li¡
[
tid
].
	`’d
());

180 
In¡SeqNum
 
´oducšg_¡Üe
;

181 ià(
š¡
->
	`isLßd
(è&& 
lßdB¬r›r
) {

182 
	`DPRINTF
(
MemD•Un™
, "Load barrier [sn:%lli] in flight\n",

183 
lßdB¬r›rSN
);

184 
´oducšg_¡Üe
 = 
lßdB¬r›rSN
;

185 } ià(
š¡
->
	`isStÜe
(è&& 
¡ÜeB¬r›r
) {

186 
	`DPRINTF
(
MemD•Un™
, "Store barrier [sn:%lli] in flight\n",

187 
¡ÜeB¬r›rSN
);

188 
´oducšg_¡Üe
 = 
¡ÜeB¬r›rSN
;

190 
´oducšg_¡Üe
 = 
d•P»d
.
	`checkIn¡
(
š¡
->
	`š¡Addr
());

193 
MemD•EÁryPŒ
 
¡Üe_’Œy
 = 
NULL
;

196 ià(
´oducšg_¡Üe
 != 0) {

197 
	`DPRINTF
(
MemD•Un™
, "Searching for…roducer\n");

198 
MemD•HashIt
 
hash_™
 = 
memD•Hash
.
	`fšd
(
´oducšg_¡Üe
);

200 ià(
hash_™
 !ğ
memD•Hash
.
	`’d
()) {

201 
¡Üe_’Œy
 = (*
hash_™
).
£cÚd
;

202 
	`DPRINTF
(
MemD•Un™
, "Proucer found\n");

208 ià(!
¡Üe_’Œy
) {

209 
	`DPRINTF
(
MemD•Un™
, "No dependency for inst PC "

210 "% [¢:%Îi].\n", 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

212 
š¡_’Œy
->
memD•R—dy
 = 
Œue
;

214 ià(
š¡
->
	`»adyToIssue
()) {

215 
š¡_’Œy
->
»gsR—dy
 = 
Œue
;

217 
	`moveToR—dy
(
š¡_’Œy
);

221 
	`DPRINTF
(
MemD•Un™
, "Addingo dependency†ist; "

223 
š¡
->
	`pcS‹
(), 
´oducšg_¡Üe
);

225 ià(
š¡
->
	`»adyToIssue
()) {

226 
š¡_’Œy
->
»gsR—dy
 = 
Œue
;

230 
š¡
->
	`ş—rCªIssue
();

233 
¡Üe_’Œy
->
d•’dIn¡s
.
	`push_back
(
š¡_’Œy
);

235 ià(
š¡
->
	`isLßd
()) {

236 ++
cÚæiùšgLßds
;

238 ++
cÚæiùšgStÜes
;

242 ià(
š¡
->
	`isStÜe
()) {

243 
	`DPRINTF
(
MemD•Un™
, "Inserting store PC %s [sn:%lli].\n",

244 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

246 
d•P»d
.
	`š£¹StÜe
(
š¡
->
	`š¡Addr
(), in¡->
£qNum
, in¡->
th»adNumb”
);

248 ++
š£¹edStÜes
;

249 } ià(
š¡
->
	`isLßd
()) {

250 ++
š£¹edLßds
;

252 
	`·nic
("Unknownype! (most†ikely‡ barrier).");

254 
	}
}

256 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

258 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$š£¹NÚS³c
(
DynIn¡PŒ
 &
š¡
)

260 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

262 
MemD•EÁryPŒ
 
š¡_’Œy
 = 
Ãw
 
	`MemD•EÁry
(
š¡
);

265 
memD•Hash
.
	`š£¹
(

266 
¡d
::
·œ
<
In¡SeqNum
, 
MemD•EÁryPŒ
>(
š¡
->
£qNum
, 
š¡_’Œy
));

267 #ifdeà
DEBUG


268 
MemD•EÁry
::
memd•_š£¹
++;

272 
š¡Li¡
[
tid
].
	`push_back
(
š¡
);

274 
š¡_’Œy
->
li¡It
 = --(
š¡Li¡
[
tid
].
	`’d
());

278 ià(
š¡
->
	`isStÜe
()) {

279 
	`DPRINTF
(
MemD•Un™
, "Inserting store PC %s [sn:%lli].\n",

280 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

282 
d•P»d
.
	`š£¹StÜe
(
š¡
->
	`š¡Addr
(), in¡->
£qNum
, in¡->
th»adNumb”
);

284 ++
š£¹edStÜes
;

285 } ià(
š¡
->
	`isLßd
()) {

286 ++
š£¹edLßds
;

288 
	`·nic
("Unknownype! (most†ikely‡ barrier).");

290 
	}
}

292 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

294 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$š£¹B¬r›r
(
DynIn¡PŒ
 &
b¬r_š¡
)

296 
In¡SeqNum
 
b¬r_¢
 = 
b¬r_š¡
->
£qNum
;

298 ià(
b¬r_š¡
->
	`isMemB¬r›r
()) {

299 
lßdB¬r›r
 = 
Œue
;

300 
lßdB¬r›rSN
 = 
b¬r_¢
;

301 
¡ÜeB¬r›r
 = 
Œue
;

302 
¡ÜeB¬r›rSN
 = 
b¬r_¢
;

303 
	`DPRINTF
(
MemD•Un™
, "Inserted‡ memory barrier %s SN:%lli\n",

304 
b¬r_š¡
->
	`pcS‹
(),
b¬r_¢
);

305 } ià(
b¬r_š¡
->
	`isWr™eB¬r›r
()) {

306 
¡ÜeB¬r›r
 = 
Œue
;

307 
¡ÜeB¬r›rSN
 = 
b¬r_¢
;

308 
	`DPRINTF
(
MemD•Un™
, "Inserted‡ write barrier\n");

311 
Th»adID
 
tid
 = 
b¬r_š¡
->
th»adNumb”
;

313 
MemD•EÁryPŒ
 
š¡_’Œy
 = 
Ãw
 
	`MemD•EÁry
(
b¬r_š¡
);

316 
memD•Hash
.
	`š£¹
(

317 
¡d
::
·œ
<
In¡SeqNum
, 
MemD•EÁryPŒ
>(
b¬r_¢
, 
š¡_’Œy
));

318 #ifdeà
DEBUG


319 
MemD•EÁry
::
memd•_š£¹
++;

323 
š¡Li¡
[
tid
].
	`push_back
(
b¬r_š¡
);

325 
š¡_’Œy
->
li¡It
 = --(
š¡Li¡
[
tid
].
	`’d
());

326 
	}
}

328 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

330 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$»gsR—dy
(
DynIn¡PŒ
 &
š¡
)

332 
	`DPRINTF
(
MemD•Un™
, "Marking„egisters‡s„eady for "

334 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

336 
MemD•EÁryPŒ
 
š¡_’Œy
 = 
	`fšdInHash
(
š¡
);

338 
š¡_’Œy
->
»gsR—dy
 = 
Œue
;

340 ià(
š¡_’Œy
->
memD•R—dy
) {

341 
	`DPRINTF
(
MemD•Un™
, "Instruction has its memory "

344 
	`moveToR—dy
(
š¡_’Œy
);

346 
	`DPRINTF
(
MemD•Un™
, "Instruction still waiting on "

349 
	}
}

351 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

353 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$nÚS³cIn¡R—dy
(
DynIn¡PŒ
 &
š¡
)

355 
	`DPRINTF
(
MemD•Un™
, "Marking‚on speculative "

357 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

359 
MemD•EÁryPŒ
 
š¡_’Œy
 = 
	`fšdInHash
(
š¡
);

361 
	`moveToR—dy
(
š¡_’Œy
);

362 
	}
}

364 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

366 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$»scheduË
(
DynIn¡PŒ
 &
š¡
)

368 
š¡sToR•Ïy
.
	`push_back
(
š¡
);

369 
	}
}

371 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

373 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$»¶ay
(
DynIn¡PŒ
 &
š¡
)

375 
DynIn¡PŒ
 
‹mp_š¡
;

378 !
š¡sToR•Ïy
.
	`em±y
()) {

379 
‹mp_š¡
 = 
š¡sToR•Ïy
.
	`äÚt
();

381 
MemD•EÁryPŒ
 
š¡_’Œy
 = 
	`fšdInHash
(
‹mp_š¡
);

383 
	`DPRINTF
(
MemD•Un™
, "Replaying mem instruction PC %s [sn:%lli].\n",

384 
‹mp_š¡
->
	`pcS‹
(),emp_š¡->
£qNum
);

386 
	`moveToR—dy
(
š¡_’Œy
);

388 
š¡sToR•Ïy
.
	`pİ_äÚt
();

390 
	}
}

392 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

394 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$com¶‘ed
(
DynIn¡PŒ
 &
š¡
)

396 
	`DPRINTF
(
MemD•Un™
, "Completed mem instruction PC %s [sn:%lli].\n",

397 
š¡
->
	`pcS‹
(), in¡->
£qNum
);

399 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

402 
MemD•HashIt
 
hash_™
 = 
memD•Hash
.
	`fšd
(
š¡
->
£qNum
);

404 
	`as£¹
(
hash_™
 !ğ
memD•Hash
.
	`’d
());

406 
š¡Li¡
[
tid
].
	`”a£
((*
hash_™
).
£cÚd
->
li¡It
);

408 (*
hash_™
).
£cÚd
 = 
NULL
;

410 
memD•Hash
.
	`”a£
(
hash_™
);

411 #ifdeà
DEBUG


412 
MemD•EÁry
::
memd•_”a£
++;

414 
	}
}

416 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

418 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$com¶‘eB¬r›r
(
DynIn¡PŒ
 &
š¡
)

420 
	`wakeD•’d’ts
(
š¡
);

421 
	`com¶‘ed
(
š¡
);

423 
In¡SeqNum
 
b¬r_¢
 = 
š¡
->
£qNum
;

424 
	`DPRINTF
(
MemD•Un™
, "b¬r›¸com¶‘ed: % SN:%Îi\n", 
š¡
->
	`pcS‹
(),

425 
š¡
->
£qNum
);

426 ià(
š¡
->
	`isMemB¬r›r
()) {

427 ià(
lßdB¬r›rSN
 =ğ
b¬r_¢
)

428 
lßdB¬r›r
 = 
çl£
;

429 ià(
¡ÜeB¬r›rSN
 =ğ
b¬r_¢
)

430 
¡ÜeB¬r›r
 = 
çl£
;

431 } ià(
š¡
->
	`isWr™eB¬r›r
()) {

432 ià(
¡ÜeB¬r›rSN
 =ğ
b¬r_¢
)

433 
¡ÜeB¬r›r
 = 
çl£
;

435 
	}
}

437 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

439 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$wakeD•’d’ts
(
DynIn¡PŒ
 &
š¡
)

442 ià(!
š¡
->
	`isStÜe
(è&& !š¡->
	`isMemB¬r›r
(è&& !š¡->
	`isWr™eB¬r›r
()) {

446 
MemD•EÁryPŒ
 
š¡_’Œy
 = 
	`fšdInHash
(
š¡
);

448 
i
 = 0; i < 
š¡_’Œy
->
d•’dIn¡s
.
	`size
(); ++i ) {

449 
MemD•EÁryPŒ
 
wok’_š¡
 = 
š¡_’Œy
->
d•’dIn¡s
[
i
];

451 ià(!
wok’_š¡
->
š¡
) {

456 
	`DPRINTF
(
MemD•Un™
, "Waking up‡ dependent inst, "

458 
wok’_š¡
->
š¡
->
£qNum
);

460 ià(
wok’_š¡
->
»gsR—dy
 && !wok’_š¡->
squashed
) {

461 
	`moveToR—dy
(
wok’_š¡
);

463 
wok’_š¡
->
memD•R—dy
 = 
Œue
;

467 
š¡_’Œy
->
d•’dIn¡s
.
	`ş—r
();

468 
	}
}

470 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

472 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
,

473 
Th»adID
 
tid
)

475 ià(!
š¡sToR•Ïy
.
	`em±y
()) {

476 
Li¡It
 
»¶ay_™
 = 
š¡sToR•Ïy
.
	`begš
();

477 
»¶ay_™
 !ğ
š¡sToR•Ïy
.
	`’d
()) {

478 ià((*
»¶ay_™
)->
th»adNumb”
 =ğ
tid
 &&

479 (*
»¶ay_™
)->
£qNum
 > 
squashed_num
) {

480 
š¡sToR•Ïy
.
	`”a£
(
»¶ay_™
++);

482 ++
»¶ay_™
;

487 
Li¡It
 
squash_™
 = 
š¡Li¡
[
tid
].
	`’d
();

488 --
squash_™
;

490 
MemD•HashIt
 
hash_™
;

492 !
š¡Li¡
[
tid
].
	`em±y
() &&

493 (*
squash_™
)->
£qNum
 > 
squashed_num
) {

495 
	`DPRINTF
(
MemD•Un™
, "Squashing inst [sn:%lli]\n",

496 (*
squash_™
)->
£qNum
);

498 ià((*
squash_™
)->
£qNum
 =ğ
lßdB¬r›rSN
)

499 
lßdB¬r›r
 = 
çl£
;

501 ià((*
squash_™
)->
£qNum
 =ğ
¡ÜeB¬r›rSN
)

502 
¡ÜeB¬r›r
 = 
çl£
;

504 
hash_™
 = 
memD•Hash
.
	`fšd
((*
squash_™
)->
£qNum
);

506 
	`as£¹
(
hash_™
 !ğ
memD•Hash
.
	`’d
());

508 (*
hash_™
).
£cÚd
->
squashed
 = 
Œue
;

510 (*
hash_™
).
£cÚd
 = 
NULL
;

512 
memD•Hash
.
	`”a£
(
hash_™
);

513 #ifdeà
DEBUG


514 
MemD•EÁry
::
memd•_”a£
++;

517 
š¡Li¡
[
tid
].
	`”a£
(
squash_™
--);

521 
d•P»d
.
	`squash
(
squashed_num
, 
tid
);

522 
	}
}

524 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

526 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$viŞ©iÚ
(
DynIn¡PŒ
 &
¡Üe_š¡
,

527 
DynIn¡PŒ
 &
viŞ©šg_lßd
)

529 
	`DPRINTF
(
MemD•Un™
, "Passing violating PCso store sets,"

530 "†ßd: %#x, stÜe: %#x\n", 
viŞ©šg_lßd
->
	`š¡Addr
(),

531 
¡Üe_š¡
->
	`š¡Addr
());

533 
d•P»d
.
	`viŞ©iÚ
(
¡Üe_š¡
->
	`š¡Addr
(), 
viŞ©šg_lßd
->instAddr());

534 
	}
}

536 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

538 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$issue
(
DynIn¡PŒ
 &
š¡
)

540 
	`DPRINTF
(
MemD•Un™
, "Issuing instruction PC %#x [sn:%lli].\n",

541 
š¡
->
	`š¡Addr
(), in¡->
£qNum
);

543 
d•P»d
.
	`issued
(
š¡
->
	`š¡Addr
(), in¡->
£qNum
, in¡->
	`isStÜe
());

544 
	}
}

546 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

547 
šlše
 
ty³Çme
 
	gMemD•Un™
<
	gMemD•P»d
,
	gIm¶
>::
MemD•EÁryPŒ
 &

548 
MemD•Un™
<
MemD•P»d
, 
	gIm¶
>::
	$fšdInHash
(cÚ¡ 
DynIn¡PŒ
 &
š¡
)

550 
MemD•HashIt
 
hash_™
 = 
memD•Hash
.
	`fšd
(
š¡
->
£qNum
);

552 
	`as£¹
(
hash_™
 !ğ
memD•Hash
.
	`’d
());

554  (*
hash_™
).
£cÚd
;

555 
	}
}

557 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

558 
šlše
 

559 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$moveToR—dy
(
MemD•EÁryPŒ
 &
wok’_š¡_’Œy
)

561 
	`DPRINTF
(
MemD•Un™
, "Adding instruction [sn:%lli] "

562 "tØth»ady†i¡.\n", 
wok’_š¡_’Œy
->
š¡
->
£qNum
);

564 
	`as£¹
(!
wok’_š¡_’Œy
->
squashed
);

566 
iqPŒ
->
	`addR—dyMemIn¡
(
wok’_š¡_’Œy
->
š¡
);

567 
	}
}

570 
	g‹m¶©e
 <
şass
 
	gMemD•P»d
, cÏs 
	gIm¶
>

572 
	gMemD•Un™
<
	gMemD•P»d
, 
	gIm¶
>::
	$dumpLi¡s
()

574 
Th»adID
 
tid
 = 0;id < 
Im¶
::
MaxTh»ads
;id++) {

575 
	`ırštf
("Instruction†ist %i size: %i\n",

576 
tid
, 
š¡Li¡
[tid].
	`size
());

578 
Li¡It
 
š¡_li¡_™
 = 
š¡Li¡
[
tid
].
	`begš
();

579 
num
 = 0;

581 
š¡_li¡_™
 !ğ
š¡Li¡
[
tid
].
	`’d
()) {

582 
	`ırštf
("Instruction:%i\nPC: %s\n[sn:%i]\n[tid:%i]\nIssued:%i\n"

584 
num
, (*
š¡_li¡_™
)->
	`pcS‹
(),

585 (*
š¡_li¡_™
)->
£qNum
,

586 (*
š¡_li¡_™
)->
th»adNumb”
,

587 (*
š¡_li¡_™
)->
	`isIssued
(),

588 (*
š¡_li¡_™
)->
	`isSquashed
());

589 
š¡_li¡_™
++;

590 ++
num
;

594 
	`ırštf
("MemÜy d•’d’û hash size: %i\n", 
memD•Hash
.
	`size
());

596 #ifdeà
DEBUG


597 
	`ırštf
("MemÜy d•’d’ûƒÁr›s: %i\n", 
MemD•EÁry
::
memd•_couÁ
);

599 
	}
}

	@o3/regfile.cc

34 
	~"ıu/o3/ä“_li¡.hh
"

35 
	~"ıu/o3/»gfe.hh
"

38 
	gPhysRegFe
::
	$PhysRegFe
(
_numPhysiÿlIÁRegs
,

39 
_numPhysiÿlFlßtRegs
,

40 
_numPhysiÿlCCRegs
)

41 : 
	`štRegFe
(
_numPhysiÿlIÁRegs
),

42 
	`æßtRegFe
(
_numPhysiÿlFlßtRegs
),

43 
	`ccRegFe
(
_numPhysiÿlCCRegs
),

44 
	`ba£FlßtRegIndex
(
_numPhysiÿlIÁRegs
),

45 
	`ba£CCRegIndex
(
_numPhysiÿlIÁRegs
 + 
_numPhysiÿlFlßtRegs
),

46 
	`tÙ®NumRegs
(
_numPhysiÿlIÁRegs


47 + 
_numPhysiÿlFlßtRegs


48 + 
_numPhysiÿlCCRegs
)

50 ià(
TheISA
::
NumCCRegs
 =ğ0 && 
_numPhysiÿlCCRegs
 != 0) {

53 
	`w¬n
("Non-zero‚umber of…hysical CC„egs specified,ƒvenhough\n"

56 
	}
}

60 
	gPhysRegFe
::
	$š™F»eLi¡
(
Unif›dF»eLi¡
 *
ä“Li¡
)

63 
PhysRegIndex
 
»g_idx
 = 0;

66 
»g_idx
 < 
ba£FlßtRegIndex
) {

67 
ä“Li¡
->
	`addIÁReg
(
»g_idx
++);

72 
»g_idx
 < 
ba£CCRegIndex
) {

73 
ä“Li¡
->
	`addFlßtReg
(
»g_idx
++);

78 
»g_idx
 < 
tÙ®NumRegs
) {

79 
ä“Li¡
->
	`addCCReg
(
»g_idx
++);

81 
	}
}

	@o3/regfile.hh

33 #iâdeà
__CPU_O3_REGFILE_HH__


34 
	#__CPU_O3_REGFILE_HH__


	)

36 
	~<veùÜ
>

38 
	~"¬ch/i§_Œa™s.hh
"

39 
	~"¬ch/k”Ãl_¡©s.hh
"

40 
	~"¬ch/ty³s.hh
"

41 
	~"ba£/Œaû.hh
"

42 
	~"cÚfig/the_i§.hh
"

43 
	~"ıu/o3/comm.hh
"

44 
	~"debug/IEW.hh
"

46 
şass
 
	gUnif›dF»eLi¡
;

51 şas 
	cPhysRegFe


53 
	m´iv©e
:

55 
TheISA
::
	tIÁReg
 IntReg;

56 
	mTheISA
::
	tFlßtReg
 FloatReg;

57 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

58 
	mTheISA
::
	tCCReg
 CCReg;

61 
FlßtReg
 
	md
;

62 
FlßtRegB™s
 
	mq
;

63 } 
	tPhysFlßtReg
;

66 
	g¡d
::
veùÜ
<
IÁReg
> 
štRegFe
;

69 
	g¡d
::
veùÜ
<
PhysFlßtReg
> 
æßtRegFe
;

72 
	g¡d
::
veùÜ
<
CCReg
> 
ccRegFe
;

88 
	gba£FlßtRegIndex
;

94 
	gba£CCRegIndex
;

97 
	gtÙ®NumRegs
;

99 
	gpublic
:

104 
PhysRegFe
(
_numPhysiÿlIÁRegs
,

105 
_numPhysiÿlFlßtRegs
,

106 
_numPhysiÿlCCRegs
);

111 ~
	$PhysRegFe
(è{
	}
}

114 
š™F»eLi¡
(
Unif›dF»eLi¡
 *
ä“Li¡
);

117 
	$numIÁPhysRegs
(ècÚ¡ {  
ba£FlßtRegIndex
; 
	}
}

120 
	$numFlßtPhysRegs
() const

121 {  
ba£CCRegIndex
 - 
ba£FlßtRegIndex
; 
	}
}

124 
	$numCCPhysRegs
() const

125 {  
tÙ®NumRegs
 - 
ba£CCRegIndex
; 
	}
}

128 
	$tÙ®NumPhysRegs
(ècÚ¡ {  
tÙ®NumRegs
; 
	}
}

134 
boŞ
 
	$isIÁPhysReg
(
PhysRegIndex
 
»g_idx
) const

136  0 <ğ
»g_idx
 &&„eg_idx < 
ba£FlßtRegIndex
;

137 
	}
}

143 
boŞ
 
	$isFlßtPhysReg
(
PhysRegIndex
 
»g_idx
) const

145  (
ba£FlßtRegIndex
 <ğ
»g_idx
 &&„eg_idx < 
ba£CCRegIndex
);

146 
	}
}

152 
boŞ
 
	$isCCPhysReg
(
PhysRegIndex
 
»g_idx
)

154  (
ba£CCRegIndex
 <ğ
»g_idx
 &&„eg_idx < 
tÙ®NumRegs
);

155 
	}
}

158 
ušt64_t
 
	$»adIÁReg
(
PhysRegIndex
 
»g_idx
) const

160 
	`as£¹
(
	`isIÁPhysReg
(
»g_idx
));

162 
	`DPRINTF
(
IEW
, "RegFile: Accesso int„egister %i, has data "

163 "%#x\n", (
»g_idx
), 
štRegFe
[reg_idx]);

164  
štRegFe
[
»g_idx
];

165 
	}
}

168 
FlßtReg
 
	$»adFlßtReg
(
PhysRegIndex
 
»g_idx
) const

170 
	`as£¹
(
	`isFlßtPhysReg
(
»g_idx
));

173 
PhysRegIndex
 
»g_off£t
 = 
»g_idx
 - 
ba£FlßtRegIndex
;

175 
	`DPRINTF
(
IEW
, "RegFile: Accesso float„egister %i, has "

176 "d©¨%#x\n", (
»g_idx
), 
æßtRegFe
[
»g_off£t
].
q
);

178  
æßtRegFe
[
»g_off£t
].
d
;

179 
	}
}

181 
FlßtRegB™s
 
	$»adFlßtRegB™s
(
PhysRegIndex
 
»g_idx
) const

183 
	`as£¹
(
	`isFlßtPhysReg
(
»g_idx
));

186 
PhysRegIndex
 
»g_off£t
 = 
»g_idx
 - 
ba£FlßtRegIndex
;

188 
FlßtRegB™s
 
æßtRegB™s
 = 
æßtRegFe
[
»g_off£t
].
q
;

190 
	`DPRINTF
(
IEW
, "RegFile: Accesso float„egister %i‡s int, "

191 "ha d©¨%#x\n", (
»g_idx
), (
ušt64_t
)
æßtRegB™s
);

193  
æßtRegB™s
;

194 
	}
}

197 
CCReg
 
	$»adCCReg
(
PhysRegIndex
 
»g_idx
)

199 
	`as£¹
(
	`isCCPhysReg
(
»g_idx
));

202 
PhysRegIndex
 
»g_off£t
 = 
»g_idx
 - 
ba£CCRegIndex
;

204 
	`DPRINTF
(
IEW
, "RegFile: Accesso cc„egister %i, has "

205 "d©¨%#x\n", (
»g_idx
), 
ccRegFe
[
»g_off£t
]);

207  
ccRegFe
[
»g_off£t
];

208 
	}
}

211 
	$£tIÁReg
(
PhysRegIndex
 
»g_idx
, 
ušt64_t
 
v®
)

213 
	`as£¹
(
	`isIÁPhysReg
(
»g_idx
));

215 
	`DPRINTF
(
IEW
, "RegFile: Setting int„egister %io %#x\n",

216 (
»g_idx
), 
v®
);

218 ià(
»g_idx
 !ğ
TheISA
::
Z”oReg
)

219 
štRegFe
[
»g_idx
] = 
v®
;

220 
	}
}

223 
	$£tFlßtReg
(
PhysRegIndex
 
»g_idx
, 
FlßtReg
 
v®
)

225 
	`as£¹
(
	`isFlßtPhysReg
(
»g_idx
));

228 
PhysRegIndex
 
»g_off£t
 = 
»g_idx
 - 
ba£FlßtRegIndex
;

230 
	`DPRINTF
(
IEW
, "RegFile: Setting float„egister %io %#x\n",

231 (
»g_idx
), (
ušt64_t
)
v®
);

233 #ià
THE_ISA
 =ğ
ALPHA_ISA


234 ià(
»g_off£t
 !ğ
TheISA
::
Z”oReg
)

236 
æßtRegFe
[
»g_off£t
].
d
 = 
v®
;

237 
	}
}

239 
	$£tFlßtRegB™s
(
PhysRegIndex
 
»g_idx
, 
FlßtRegB™s
 
v®
)

241 
	`as£¹
(
	`isFlßtPhysReg
(
»g_idx
));

244 
PhysRegIndex
 
»g_off£t
 = 
»g_idx
 - 
ba£FlßtRegIndex
;

246 
	`DPRINTF
(
IEW
, "RegFile: Setting float„egister %io %#x\n",

247 (
»g_idx
), (
ušt64_t
)
v®
);

249 
æßtRegFe
[
»g_off£t
].
q
 = 
v®
;

250 
	}
}

253 
	$£tCCReg
(
PhysRegIndex
 
»g_idx
, 
CCReg
 
v®
)

255 
	`as£¹
(
	`isCCPhysReg
(
»g_idx
));

258 
PhysRegIndex
 
»g_off£t
 = 
»g_idx
 - 
ba£CCRegIndex
;

260 
	`DPRINTF
(
IEW
, "RegFile: Setting cc„egister %io %#x\n",

261 (
»g_idx
), (
ušt64_t
)
v®
);

263 
ccRegFe
[
»g_off£t
] = 
v®
;

264 
	}
}

	@o3/rename.cc

31 
	~"ıu/o3/i§_¥ecific.hh
"

32 
	~"ıu/o3/»Çme_im¶.hh
"

34 
‹m¶©e
 
şass
 
	gDeçuÉR’ame
<
	gO3CPUIm¶
>;

	@o3/rename.hh

43 #iâdeà
__CPU_O3_RENAME_HH__


44 
	#__CPU_O3_RENAME_HH__


	)

46 
	~<li¡
>

48 
	~"ba£/¡©i¡ics.hh
"

49 
	~"cÚfig/the_i§.hh
"

50 
	~"ıu/timebuf.hh
"

52 
	gD”ivO3CPUP¬ams
;

66 
	g‹m¶©e
<
şass
 
	gIm¶
>

67 şas 
	cDeçuÉR’ame


69 
	mpublic
:

71 
ty³Çme
 
	tIm¶
::
	tCPUPŞ
 CPUPol;

72 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

73 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

76 
ty³Çme
 
	tCPUPŞ
::
	tDecodeSŒuù
 DecodeStruct;

77 
ty³Çme
 
	tCPUPŞ
::
	tR’ameSŒuù
 RenameStruct;

78 
ty³Çme
 
	tCPUPŞ
::
	tTimeSŒuù
 TimeStruct;

79 
ty³Çme
 
	tCPUPŞ
::
	tF»eLi¡
 FreeList;

80 
ty³Çme
 
	tCPUPŞ
::
	tR’ameM­
 RenameMap;

82 
ty³Çme
 
	tCPUPŞ
::
	tIEW
 IEW;

83 
ty³Çme
 
	tCPUPŞ
::
	tComm™
 Commit;

86 
	mTheISA
::
	tRegIndex
 RegIndex;

92 
	m¡d
::
	tli¡
<
	tDynIn¡PŒ
> 
	tIn¡Queue
;

93 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

95 
	mpublic
:

99 
	eR’ameStus
 {

100 
Aùive
,

101 
	mIÇùive


105 
	eTh»adStus
 {

106 
	gRuÂšg
,

107 
	gIdË
,

108 
	gS¹Squash
,

109 
	gSquashšg
,

110 
	gBlocked
,

111 
	gUnblockšg
,

112 
	gS”ŸlizeSÎ


115 
	g´iv©e
:

117 
R’ameStus
 
_¡©us
;

120 
Th»adStus
 
	g»ÇmeStus
[
Im¶
::
MaxTh»ads
];

122 
	gpublic
:

124 
DeçuÉR’ame
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
);

127 
	g¡d
::
¡ršg
 
	$Çme
() const;

130 
	`»gSts
();

133 
	`£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
);

136 
	`£tR’ameQueue
(
TimeBufãr
<
R’ameSŒuù
> *
rq_±r
);

139 
	`£tDecodeQueue
(
TimeBufãr
<
DecodeSŒuù
> *
dq_±r
);

142 
	$£tIEWSge
(
IEW
 *
›w_¡age
)

143 { 
›w_±r
 = 
›w_¡age
; 
	}
}

146 
	$£tComm™Sge
(
Comm™
 *
comm™_¡age
)

147 { 
comm™_±r
 = 
comm™_¡age
; 
	}
}

149 
	g´iv©e
:

151 
IEW
 *
›w_±r
;

154 
Comm™
 *
	gcomm™_±r
;

156 
	gpublic
:

158 
¡¬tupSge
();

161 
£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

164 
£tR’ameM­
(
R’ameM­
 
rm_±r
[
Im¶
::
MaxTh»ads
]);

167 
£tF»eLi¡
(
F»eLi¡
 *
æ_±r
);

170 
£tScÜebßrd
(
ScÜebßrd
 *
_scÜebßrd
);

173 
	$d¿šSª™yCheck
() const;

176 
boŞ
 
	$isD¿šed
() const;

179 
	`keOv”From
();

182 
	`squash
(cÚ¡ 
In¡SeqNum
 &
squash_£q_num
, 
Th»adID
 
tid
);

187 
	`tick
();

190 
	`dumpHi¡Üy
();

192 
´iv©e
:

194 
	`»£tSge
();

201 
	`»Çme
(
boŞ
 &
¡©us_chªge
, 
Th»adID
 
tid
);

206 
	`»ÇmeIn¡s
(
Th»adID
 
tid
);

211 
	`skidIn£¹
(
Th»adID
 
tid
);

216 
	`sÜtIn¡s
();

219 
boŞ
 
	`skidsEm±y
();

222 
	`upd©eStus
();

228 
boŞ
 
	`block
(
Th»adID
 
tid
);

234 
boŞ
 
	`unblock
(
Th»adID
 
tid
);

237 
	`doSquash
(cÚ¡ 
In¡SeqNum
 &
squash_£q_num
, 
Th»adID
 
tid
);

240 
	`»moveFromHi¡Üy
(
In¡SeqNum
 
š¡_£q_num
, 
Th»adID
 
tid
);

243 
šlše
 
	`»ÇmeSrcRegs
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
);

246 
šlše
 
	`»ÇmeDe¡Regs
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
);

249 
šlše
 
	`ÿlcF»eROBEÁr›s
(
Th»adID
 
tid
);

252 
šlše
 
	`ÿlcF»eIQEÁr›s
(
Th»adID
 
tid
);

255 
šlše
 
	`ÿlcF»eLSQEÁr›s
(
Th»adID
 
tid
);

258 
	`v®idIn¡s
();

261 
	`»adSÎSigÇls
(
Th»adID
 
tid
);

264 
boŞ
 
	`checkSÎ
(
Th»adID
 
tid
);

267 
	`»adF»eEÁr›s
(
Th»adID
 
tid
);

270 
boŞ
 
	`checkSigÇlsAndUpd©e
(
Th»adID
 
tid
);

279 
	`£rŸlizeAá”
(
In¡Queue
 &
š¡_li¡
, 
Th»adID
 
tid
);

285 
	sR’ameHi¡Üy
 {

286 
	`R’ameHi¡Üy
(
In¡SeqNum
 
_š¡SeqNum
, 
RegIndex
 
_¬chReg
,

287 
PhysRegIndex
 
_ÃwPhysReg
, PhysRegIndex 
_´evPhysReg
)

288 : 
	`š¡SeqNum
(
_š¡SeqNum
), 
	`¬chReg
(
_¬chReg
),

289 
	`ÃwPhysReg
(
_ÃwPhysReg
), 
	`´evPhysReg
(
_´evPhysReg
)

294 
In¡SeqNum
 
š¡SeqNum
;

296 
RegIndex
 
¬chReg
;

298 
PhysRegIndex
 
ÃwPhysReg
;

300 
PhysRegIndex
 
´evPhysReg
;

301 
	}
};

306 
	g¡d
::
li¡
<
R’ameHi¡Üy
> 
hi¡ÜyBufãr
[
Im¶
::
MaxTh»ads
];

309 
O3CPU
 *
	gıu
;

312 
	gTimeBufãr
<
	gTimeSŒuù
> *
	gtimeBufãr
;

315 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomIEW
;

318 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomComm™
;

321 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
toDecode
;

324 
	gTimeBufãr
<
	gR’ameSŒuù
> *
	g»ÇmeQueue
;

327 
ty³Çme
 
	gTimeBufãr
<
	gR’ameSŒuù
>::
wœe
 
toIEW
;

330 
	gTimeBufãr
<
	gDecodeSŒuù
> *
	gdecodeQueue
;

333 
ty³Çme
 
	gTimeBufãr
<
	gDecodeSŒuù
>::
wœe
 
äomDecode
;

336 
In¡Queue
 
	gš¡s
[
Im¶
::
MaxTh»ads
];

339 
In¡Queue
 
	gskidBufãr
[
Im¶
::
MaxTh»ads
];

342 
R’ameM­
 *
	g»ÇmeM­
[
Im¶
::
MaxTh»ads
];

345 
F»eLi¡
 *
	gä“Li¡
;

348 
	g¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

351 
ScÜebßrd
 *
	gscÜebßrd
;

356 
	gš¡sInProg»ss
[
Im¶
::
MaxTh»ads
];

361 
boŞ
 
	gwrÙeToTimeBufãr
;

366 
	sF»eEÁr›s
 {

367 
	giqEÁr›s
;

368 
	glsqEÁr›s
;

369 
	grobEÁr›s
;

375 
F»eEÁr›s
 
	gä“EÁr›s
[
Im¶
::
MaxTh»ads
];

381 
boŞ
 
	gem±yROB
[
Im¶
::
MaxTh»ads
];

384 
	sSÎs
 {

385 
boŞ
 
	g›w
;

386 
boŞ
 
	gcomm™
;

390 
SÎs
 
	g¡®ls
[
Im¶
::
MaxTh»ads
];

393 
DynIn¡PŒ
 
	g£rŸlizeIn¡
[
Im¶
::
MaxTh»ads
];

398 
boŞ
 
	g£rŸlizeOnNextIn¡
[
Im¶
::
MaxTh»ads
];

401 
	g›wToR’ameD–ay
;

404 
	gdecodeToR’ameD–ay
;

407 
	gcomm™ToR’ameD–ay
;

410 
	g»ÇmeWidth
;

415 
	gcomm™Width
;

420 
	gtoIEWIndex
;

423 
boŞ
 
	gblockThisCyşe
;

427 
boŞ
 
	g»sumeS”Ÿlize
;

431 
boŞ
 
	g»sumeUnblockšg
;

434 
Th»adID
 
	gnumTh»ads
;

437 
	gskidBufãrMax
;

439 
PhysRegIndex
 
	gmaxPhysiÿlRegs
;

444 
	eFuÎSourû
 {

445 
	gROB
,

446 
	gIQ
,

447 
	gLSQ
,

448 
	gNONE


454 
šlše
 
šüFuÎSt
(cÚ¡ 
FuÎSourû
 &
sourû
);

457 
	gSts
::
SÿÏr
 
»ÇmeSquashCyşes
;

459 
	gSts
::
SÿÏr
 
»ÇmeIdËCyşes
;

461 
	gSts
::
SÿÏr
 
»ÇmeBlockCyşes
;

463 
	gSts
::
SÿÏr
 
»ÇmeS”ŸlizeSÎCyşes
;

465 
	gSts
::
SÿÏr
 
»ÇmeRunCyşes
;

467 
	gSts
::
SÿÏr
 
»ÇmeUnblockCyşes
;

469 
	gSts
::
SÿÏr
 
»ÇmeR’amedIn¡s
;

471 
	gSts
::
SÿÏr
 
»ÇmeSquashedIn¡s
;

473 
	gSts
::
SÿÏr
 
»ÇmeROBFuÎEv’ts
;

475 
	gSts
::
SÿÏr
 
»ÇmeIQFuÎEv’ts
;

477 
	gSts
::
SÿÏr
 
»ÇmeLSQFuÎEv’ts
;

480 
	gSts
::
SÿÏr
 
»ÇmeFuÎRegi¡”sEv’ts
;

482 
	gSts
::
SÿÏr
 
»ÇmeR’amedO³¿nds
;

484 
	gSts
::
SÿÏr
 
»ÇmeR’ameLookups
;

485 
	gSts
::
SÿÏr
 
štR’ameLookups
;

486 
	gSts
::
SÿÏr
 
åR’ameLookups
;

488 
	gSts
::
SÿÏr
 
»ÇmeComm™‹dM­s
;

490 
	gSts
::
SÿÏr
 
»ÇmeUndÚeM­s
;

492 
	gSts
::
SÿÏr
 
»ÇmedS”Ÿlizšg
;

494 
	gSts
::
SÿÏr
 
»ÇmedTempS”Ÿlizšg
;

496 
	gSts
::
SÿÏr
 
»ÇmeSkidIn¡s
;

	@o3/rename_impl.hh

45 #iâdeà
__CPU_O3_RENAME_IMPL_HH__


46 
	#__CPU_O3_RENAME_IMPL_HH__


	)

48 
	~<li¡
>

50 
	~"¬ch/i§_Œa™s.hh
"

51 
	~"¬ch/»gi¡”s.hh
"

52 
	~"cÚfig/the_i§.hh
"

53 
	~"ıu/o3/»Çme.hh
"

54 
	~"ıu/»g_şass.hh
"

55 
	~"debug/Aùiv™y.hh
"

56 
	~"debug/R’ame.hh
"

57 
	~"debug/O3PeV›w.hh
"

58 
	~"·¿ms/D”ivO3CPU.hh
"

60 
usšg
 
Çme¥aû
 
	g¡d
;

62 
	g‹m¶©e
 <
şass
 
	gIm¶
>

63 
	gDeçuÉR’ame
<
	gIm¶
>::
	$DeçuÉR’ame
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
)

64 : 
	`ıu
(
_ıu
),

65 
	`›wToR’ameD–ay
(
·¿ms
->
›wToR’ameD–ay
),

66 
	`decodeToR’ameD–ay
(
·¿ms
->
decodeToR’ameD–ay
),

67 
	`comm™ToR’ameD–ay
(
·¿ms
->
comm™ToR’ameD–ay
),

68 
	`»ÇmeWidth
(
·¿ms
->
»ÇmeWidth
),

69 
	`comm™Width
(
·¿ms
->
comm™Width
),

70 
	`numTh»ads
(
·¿ms
->
numTh»ads
),

71 
	`maxPhysiÿlRegs
(
·¿ms
->
numPhysIÁRegs
 +…¬ams->
numPhysFlßtRegs


72 + 
·¿ms
->
numPhysCCRegs
)

75 
skidBufãrMax
 = (2 * (
decodeToR’ameD–ay
 * 
·¿ms
->
decodeWidth
)è+ 
»ÇmeWidth
;

76 
	}
}

78 
	g‹m¶©e
 <
şass
 
	gIm¶
>

79 
	g¡d
::
¡ršg


80 
DeçuÉR’ame
<
Im¶
>::
	$Çme
() const

82  
ıu
->
	`Çme
() + ".rename";

83 
	}
}

85 
	g‹m¶©e
 <
şass
 
	gIm¶
>

87 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»gSts
()

89 
»ÇmeSquashCyşes


90 .
	`Çme
(name() + ".SquashCycles")

91 .
	`desc
("Number of cycles„ename is squashing")

92 .
	`´”eq
(
»ÇmeSquashCyşes
);

93 
»ÇmeIdËCyşes


94 .
	`Çme
(name() + ".IdleCycles")

95 .
	`desc
("Number of cycles„ename is idle")

96 .
	`´”eq
(
»ÇmeIdËCyşes
);

97 
»ÇmeBlockCyşes


98 .
	`Çme
(name() + ".BlockCycles")

99 .
	`desc
("Number of cycles„ename is blocking")

100 .
	`´”eq
(
»ÇmeBlockCyşes
);

101 
»ÇmeS”ŸlizeSÎCyşes


102 .
	`Çme
(name() + ".serializeStallCycles")

103 .
	`desc
("count of cycles„ename stalled for serializing inst")

104 .
	`æags
(
Sts
::
tÙ®
);

105 
»ÇmeRunCyşes


106 .
	`Çme
(name() + ".RunCycles")

107 .
	`desc
("Number of cycles„ename is„unning")

108 .
	`´”eq
(
»ÇmeIdËCyşes
);

109 
»ÇmeUnblockCyşes


110 .
	`Çme
(name() + ".UnblockCycles")

111 .
	`desc
("Number of cycles„ename is unblocking")

112 .
	`´”eq
(
»ÇmeUnblockCyşes
);

113 
»ÇmeR’amedIn¡s


114 .
	`Çme
(name() + ".RenamedInsts")

115 .
	`desc
("Number of instructions…rocessed by„ename")

116 .
	`´”eq
(
»ÇmeR’amedIn¡s
);

117 
»ÇmeSquashedIn¡s


118 .
	`Çme
(name() + ".SquashedInsts")

119 .
	`desc
("Number of squashed instructions…rocessed by„ename")

120 .
	`´”eq
(
»ÇmeSquashedIn¡s
);

121 
»ÇmeROBFuÎEv’ts


122 .
	`Çme
(name() + ".ROBFullEvents")

123 .
	`desc
("Number ofimes„ename has blocked dueo ROB full")

124 .
	`´”eq
(
»ÇmeROBFuÎEv’ts
);

125 
»ÇmeIQFuÎEv’ts


126 .
	`Çme
(name() + ".IQFullEvents")

127 .
	`desc
("Number ofimes„ename has blocked dueo IQ full")

128 .
	`´”eq
(
»ÇmeIQFuÎEv’ts
);

129 
»ÇmeLSQFuÎEv’ts


130 .
	`Çme
(name() + ".LSQFullEvents")

131 .
	`desc
("Number ofimes„ename has blocked dueo LSQ full")

132 .
	`´”eq
(
»ÇmeLSQFuÎEv’ts
);

133 
»ÇmeFuÎRegi¡”sEv’ts


134 .
	`Çme
(name() + ".FullRegisterEvents")

135 .
	`desc
("Number ofimeshere has been‚o free„egisters")

136 .
	`´”eq
(
»ÇmeFuÎRegi¡”sEv’ts
);

137 
»ÇmeR’amedO³¿nds


138 .
	`Çme
(name() + ".RenamedOperands")

139 .
	`desc
("Number of destination operands„ename has„enamed")

140 .
	`´”eq
(
»ÇmeR’amedO³¿nds
);

141 
»ÇmeR’ameLookups


142 .
	`Çme
(name() + ".RenameLookups")

143 .
	`desc
("Number of„egister„ename†ookupshat„ename has made")

144 .
	`´”eq
(
»ÇmeR’ameLookups
);

145 
»ÇmeComm™‹dM­s


146 .
	`Çme
(name() + ".CommittedMaps")

147 .
	`desc
("Number of HB mapshat‡re committed")

148 .
	`´”eq
(
»ÇmeComm™‹dM­s
);

149 
»ÇmeUndÚeM­s


150 .
	`Çme
(name() + ".UndoneMaps")

151 .
	`desc
("Number of HB mapshat‡re undone dueo squashing")

152 .
	`´”eq
(
»ÇmeUndÚeM­s
);

153 
»ÇmedS”Ÿlizšg


154 .
	`Çme
(name() + ".serializingInsts")

155 .
	`desc
("count of serializing insts„enamed")

156 .
	`æags
(
Sts
::
tÙ®
)

158 
»ÇmedTempS”Ÿlizšg


159 .
	`Çme
(name() + ".tempSerializingInsts")

160 .
	`desc
("count ofemporary serializing insts„enamed")

161 .
	`æags
(
Sts
::
tÙ®
)

163 
»ÇmeSkidIn¡s


164 .
	`Çme
(name() + ".skidInsts")

165 .
	`desc
("count of insts‡ddedohe skid buffer")

166 .
	`æags
(
Sts
::
tÙ®
)

168 
štR’ameLookups


169 .
	`Çme
(name() + ".int_rename_lookups")

170 .
	`desc
("Number of integer„ename†ookups")

171 .
	`´”eq
(
štR’ameLookups
);

172 
åR’ameLookups


173 .
	`Çme
(name() + ".fp_rename_lookups")

174 .
	`desc
("Number of floating„ename†ookups")

175 .
	`´”eq
(
åR’ameLookups
);

176 
	}
}

178 
	g‹m¶©e
 <
şass
 
	gIm¶
>

180 
	gDeçuÉR’ame
<
	gIm¶
>::
£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
)

182 
timeBufãr
 = 
tb_±r
;

185 
	gäomIEW
 = 
timeBufãr
->
g‘Wœe
(-
›wToR’ameD–ay
);

188 
	gäomComm™
 = 
timeBufãr
->
g‘Wœe
(-
comm™ToR’ameD–ay
);

191 
	gtoDecode
 = 
timeBufãr
->
g‘Wœe
(0);

194 
	g‹m¶©e
 <
şass
 
	gIm¶
>

196 
	gDeçuÉR’ame
<
	gIm¶
>::
£tR’ameQueue
(
TimeBufãr
<
R’ameSŒuù
> *
rq_±r
)

198 
»ÇmeQueue
 = 
rq_±r
;

201 
	gtoIEW
 = 
»ÇmeQueue
->
g‘Wœe
(0);

204 
	g‹m¶©e
 <
şass
 
	gIm¶
>

206 
	gDeçuÉR’ame
<
	gIm¶
>::
£tDecodeQueue
(
TimeBufãr
<
DecodeSŒuù
> *
dq_±r
)

208 
decodeQueue
 = 
dq_±r
;

211 
	gäomDecode
 = 
decodeQueue
->
g‘Wœe
(-
decodeToR’ameD–ay
);

214 
	g‹m¶©e
 <
şass
 
	gIm¶
>

216 
	gDeçuÉR’ame
<
	gIm¶
>::
	$¡¬tupSge
()

218 
	`»£tSge
();

219 
	}
}

221 
	g‹m¶©e
 <
şass
 
	gIm¶
>

223 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»£tSge
()

225 
_¡©us
 = 
IÇùive
;

227 
»sumeS”Ÿlize
 = 
çl£
;

228 
»sumeUnblockšg
 = 
çl£
;

231 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

232 
»ÇmeStus
[
tid
] = 
IdË
;

234 
ä“EÁr›s
[
tid
].
iqEÁr›s
 = 
›w_±r
->
š¡Queue
.
	`numF»eEÁr›s
(tid);

235 
ä“EÁr›s
[
tid
].
lsqEÁr›s
 = 
›w_±r
->
ld¡Queue
.
	`numF»eEÁr›s
(tid);

236 
ä“EÁr›s
[
tid
].
robEÁr›s
 = 
comm™_±r
->
	`numROBF»eEÁr›s
(tid);

237 
em±yROB
[
tid
] = 
Œue
;

239 
¡®ls
[
tid
].
›w
 = 
çl£
;

240 
¡®ls
[
tid
].
comm™
 = 
çl£
;

241 
£rŸlizeIn¡
[
tid
] = 
NULL
;

243 
š¡sInProg»ss
[
tid
] = 0;

245 
£rŸlizeOnNextIn¡
[
tid
] = 
çl£
;

247 
	}
}

249 
	g‹m¶©e
<
şass
 
	gIm¶
>

251 
	gDeçuÉR’ame
<
	gIm¶
>::
£tAùiveTh»ads
(
li¡
<
Th»adID
> *
©_±r
)

253 
aùiveTh»ads
 = 
©_±r
;

257 
	g‹m¶©e
 <
şass
 
	gIm¶
>

259 
	gDeçuÉR’ame
<
	gIm¶
>::
	$£tR’ameM­
(
R’ameM­
 
rm_±r
[])

261 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++)

262 
»ÇmeM­
[
tid
] = &
rm_±r
[tid];

263 
	}
}

265 
	g‹m¶©e
 <
şass
 
	gIm¶
>

267 
	gDeçuÉR’ame
<
	gIm¶
>::
	$£tF»eLi¡
(
F»eLi¡
 *
æ_±r
)

269 
ä“Li¡
 = 
æ_±r
;

270 
	}
}

272 
	g‹m¶©e
<
şass
 
	gIm¶
>

274 
	gDeçuÉR’ame
<
	gIm¶
>::
	$£tScÜebßrd
(
ScÜebßrd
 *
_scÜebßrd
)

276 
scÜebßrd
 = 
_scÜebßrd
;

277 
	}
}

279 
	g‹m¶©e
 <
şass
 
	gIm¶
>

280 
boŞ


281 
	gDeçuÉR’ame
<
	gIm¶
>::
	$isD¿šed
() const

283 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

284 ià(
š¡sInProg»ss
[
tid
] != 0 ||

285 !
hi¡ÜyBufãr
[
tid
].
	`em±y
() ||

286 !
skidBufãr
[
tid
].
	`em±y
() ||

287 !
š¡s
[
tid
].
	`em±y
())

288  
çl£
;

290  
Œue
;

291 
	}
}

293 
	g‹m¶©e
 <
şass
 
	gIm¶
>

295 
	gDeçuÉR’ame
<
	gIm¶
>::
	$keOv”From
()

297 
	`»£tSge
();

298 
	}
}

300 
	g‹m¶©e
 <
şass
 
	gIm¶
>

302 
	gDeçuÉR’ame
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

304 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

305 
	`as£¹
(
hi¡ÜyBufãr
[
tid
].
	`em±y
());

306 
	`as£¹
(
š¡s
[
tid
].
	`em±y
());

307 
	`as£¹
(
skidBufãr
[
tid
].
	`em±y
());

308 
	`as£¹
(
š¡sInProg»ss
[
tid
] == 0);

310 
	}
}

312 
	g‹m¶©e
 <
şass
 
	gIm¶
>

314 
	gDeçuÉR’ame
<
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
squash_£q_num
, 
Th»adID
 
tid
)

316 
	`DPRINTF
(
R’ame
, "[tid:%u]: Squashšg in¡ruùiÚs.\n",
tid
);

321 ià(
»ÇmeStus
[
tid
] =ğ
Blocked
 ||

322 
»ÇmeStus
[
tid
] =ğ
Unblockšg
) {

323 
toDecode
->
»ÇmeUnblock
[
tid
] = 1;

325 
»sumeS”Ÿlize
 = 
çl£
;

326 
£rŸlizeIn¡
[
tid
] = 
NULL
;

327 } ià(
»ÇmeStus
[
tid
] =ğ
S”ŸlizeSÎ
) {

328 ià(
£rŸlizeIn¡
[
tid
]->
£qNum
 <ğ
squash_£q_num
) {

329 
	`DPRINTF
(
R’ame
, "Rename will„esume serializing‡fter squash\n");

330 
»sumeS”Ÿlize
 = 
Œue
;

331 
	`as£¹
(
£rŸlizeIn¡
[
tid
]);

333 
»sumeS”Ÿlize
 = 
çl£
;

334 
toDecode
->
»ÇmeUnblock
[
tid
] = 1;

336 
£rŸlizeIn¡
[
tid
] = 
NULL
;

341 
»ÇmeStus
[
tid
] = 
Squashšg
;

344 
i
=0; i<
äomDecode
->
size
; i++) {

345 ià(
äomDecode
->
š¡s
[
i
]->
th»adNumb”
 =ğ
tid
 &&

346 
äomDecode
->
š¡s
[
i
]->
£qNum
 > 
squash_£q_num
) {

347 
äomDecode
->
š¡s
[
i
]->
	`£tSquashed
();

348 
wrÙeToTimeBufãr
 = 
Œue
;

355 
š¡s
[
tid
].
	`ş—r
();

358 
skidBufãr
[
tid
].
	`ş—r
();

360 
	`doSquash
(
squash_£q_num
, 
tid
);

361 
	}
}

363 
	g‹m¶©e
 <
şass
 
	gIm¶
>

365 
	gDeçuÉR’ame
<
	gIm¶
>::
	$tick
()

367 
wrÙeToTimeBufãr
 = 
çl£
;

369 
blockThisCyşe
 = 
çl£
;

371 
boŞ
 
¡©us_chªge
 = 
çl£
;

373 
toIEWIndex
 = 0;

375 
	`sÜtIn¡s
();

377 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

378 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

381 
th»ads
 !ğ
’d
) {

382 
Th»adID
 
tid
 = *
th»ads
++;

384 
	`DPRINTF
(
R’ame
, "Proûssšg [tid:%i]\n", 
tid
);

386 
¡©us_chªge
 = 
	`checkSigÇlsAndUpd©e
(
tid
) || status_change;

388 
	`»Çme
(
¡©us_chªge
, 
tid
);

391 ià(
¡©us_chªge
) {

392 
	`upd©eStus
();

395 ià(
wrÙeToTimeBufãr
) {

396 
	`DPRINTF
(
Aùiv™y
, "Activityhis cycle.\n");

397 
ıu
->
	`aùiv™yThisCyşe
();

400 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

402 
th»ads
 !ğ
’d
) {

403 
Th»adID
 
tid
 = *
th»ads
++;

406 ià(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
 != 0 &&

407 !
äomComm™
->
comm™Info
[
tid
].
squash
 &&

408 
»ÇmeStus
[
tid
] !ğ
Squashšg
) {

410 
	`»moveFromHi¡Üy
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,

411 
tid
);

416 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

417 
š¡sInProg»ss
[
tid
] -ğ
äomIEW
->
›wInfo
[tid].
di¥©ched
;

419 
	`as£¹
(
š¡sInProg»ss
[
tid
] >=0);

422 
	}
}

424 
	g‹m¶©e
<
şass
 
	gIm¶
>

426 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»Çme
(
boŞ
 &
¡©us_chªge
, 
Th»adID
 
tid
)

435 ià(
»ÇmeStus
[
tid
] =ğ
Blocked
) {

436 ++
»ÇmeBlockCyşes
;

437 } ià(
»ÇmeStus
[
tid
] =ğ
Squashšg
) {

438 ++
»ÇmeSquashCyşes
;

439 } ià(
»ÇmeStus
[
tid
] =ğ
S”ŸlizeSÎ
) {

440 ++
»ÇmeS”ŸlizeSÎCyşes
;

444 ià(
»sumeS”Ÿlize
) {

445 
»sumeS”Ÿlize
 = 
çl£
;

446 
	`block
(
tid
);

447 
toDecode
->
»ÇmeUnblock
[
tid
] = 
çl£
;

449 } ià(
»ÇmeStus
[
tid
] =ğ
Unblockšg
) {

450 ià(
»sumeUnblockšg
) {

451 
	`block
(
tid
);

452 
»sumeUnblockšg
 = 
çl£
;

453 
toDecode
->
»ÇmeUnblock
[
tid
] = 
çl£
;

457 ià(
»ÇmeStus
[
tid
] =ğ
RuÂšg
 ||

458 
»ÇmeStus
[
tid
] =ğ
IdË
) {

459 
	`DPRINTF
(
R’ame
, "[tid:%u]: Not blocked, so‡ttemptingo„un "

460 "¡age.\n", 
tid
);

462 
	`»ÇmeIn¡s
(
tid
);

463 } ià(
»ÇmeStus
[
tid
] =ğ
Unblockšg
) {

464 
	`»ÇmeIn¡s
(
tid
);

466 ià(
	`v®idIn¡s
()) {

469 
	`skidIn£¹
(
tid
);

474 
¡©us_chªge
 = 
	`unblock
(
tid
è|| stus_chªg|| 
blockThisCyşe
;

476 
	}
}

478 
	g‹m¶©e
 <
şass
 
	gIm¶
>

480 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»ÇmeIn¡s
(
Th»adID
 
tid
)

484 
š¡s_avaabË
 = 
»ÇmeStus
[
tid
] =ğ
Unblockšg
 ?

485 
skidBufãr
[
tid
].
	`size
(è: 
š¡s
[tid].size();

489 ià(
š¡s_avaabË
 == 0) {

490 
	`DPRINTF
(
R’ame
, "[tid:%u]: Nothingo do, breaking outƒarly.\n",

491 
tid
);

493 ++
»ÇmeIdËCyşes
;

495 } ià(
»ÇmeStus
[
tid
] =ğ
Unblockšg
) {

496 ++
»ÇmeUnblockCyşes
;

497 } ià(
»ÇmeStus
[
tid
] =ğ
RuÂšg
) {

498 ++
»ÇmeRunCyşes
;

501 
DynIn¡PŒ
 
š¡
;

505 
ä“_rob_’Œ›s
 = 
	`ÿlcF»eROBEÁr›s
(
tid
);

506 
ä“_iq_’Œ›s
 = 
	`ÿlcF»eIQEÁr›s
(
tid
);

507 
ä“_lsq_’Œ›s
 = 
	`ÿlcF»eLSQEÁr›s
(
tid
);

508 
mš_ä“_’Œ›s
 = 
ä“_rob_’Œ›s
;

510 
FuÎSourû
 
sourû
 = 
ROB
;

512 ià(
ä“_iq_’Œ›s
 < 
mš_ä“_’Œ›s
) {

513 
mš_ä“_’Œ›s
 = 
ä“_iq_’Œ›s
;

514 
sourû
 = 
IQ
;

517 ià(
ä“_lsq_’Œ›s
 < 
mš_ä“_’Œ›s
) {

518 
mš_ä“_’Œ›s
 = 
ä“_lsq_’Œ›s
;

519 
sourû
 = 
LSQ
;

523 ià(
mš_ä“_’Œ›s
 <= 0) {

524 
	`DPRINTF
(
R’ame
, "[tid:%u]: Blocking dueo‚o free ROB/IQ/LSQ "

529 
tid
,

530 
ä“_rob_’Œ›s
,

531 
ä“_iq_’Œ›s
,

532 
ä“_lsq_’Œ›s
);

534 
blockThisCyşe
 = 
Œue
;

536 
	`block
(
tid
);

538 
	`šüFuÎSt
(
sourû
);

541 } ià(
mš_ä“_’Œ›s
 < 
š¡s_avaabË
) {

542 
	`DPRINTF
(
R’ame
, "[tid:%u]: Will haveo blockhis cycle."

545 
tid
, 
š¡s_avaabË
, 
mš_ä“_’Œ›s
);

547 
š¡s_avaabË
 = 
mš_ä“_’Œ›s
;

549 
blockThisCyşe
 = 
Œue
;

551 
	`šüFuÎSt
(
sourû
);

554 
In¡Queue
 &
š¡s_to_»Çme
 = 
»ÇmeStus
[
tid
] =ğ
Unblockšg
 ?

555 
skidBufãr
[
tid
] : 
š¡s
[tid];

557 
	`DPRINTF
(
R’ame
, "[tid:%u]: %i‡vailable instructionso "

558 "£nd iew.\n", 
tid
, 
š¡s_avaabË
);

560 
	`DPRINTF
(
R’ame
, "[tid:%u]: %i insts…ipelining from Rename | %i insts "

562 
tid
, 
š¡sInProg»ss
[tid], 
äomIEW
->
›wInfo
[tid].
di¥©ched
);

565 ià(
£rŸlizeOnNextIn¡
[
tid
]) {

566 ià(
em±yROB
[
tid
] && 
š¡sInProg»ss
[tid] == 0) {

568 
£rŸlizeOnNextIn¡
[
tid
] = 
çl£
;

569 } ià(!
š¡s_to_»Çme
.
	`em±y
()) {

570 
š¡s_to_»Çme
.
	`äÚt
()->
	`£tS”ŸlizeBefÜe
();

574 
»Çmed_š¡s
 = 0;

576 
š¡s_avaabË
 > 0 && 
toIEWIndex
 < 
»ÇmeWidth
) {

577 
	`DPRINTF
(
R’ame
, "[tid:%u]: S’dšg in¡ruùiÚ tØIEW.\n", 
tid
);

579 
	`as£¹
(!
š¡s_to_»Çme
.
	`em±y
());

581 
š¡
 = 
š¡s_to_»Çme
.
	`äÚt
();

583 
š¡s_to_»Çme
.
	`pİ_äÚt
();

585 ià(
»ÇmeStus
[
tid
] =ğ
Unblockšg
) {

586 
	`DPRINTF
(
R’ame
,"[tid:%u]: Removing [sn:%lli] PC:%s from„ename "

587 "skidBufãr\n", 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

590 ià(
š¡
->
	`isSquashed
()) {

591 
	`DPRINTF
(
R’ame
, "[tid:%u]: instruction %i with PC %s is "

592 "squashed, skpšg.\n", 
tid
, 
š¡
->
£qNum
,

593 
š¡
->
	`pcS‹
());

595 ++
»ÇmeSquashedIn¡s
;

598 --
š¡s_avaabË
;

603 
	`DPRINTF
(
R’ame
, "[tid:%u]: Processing instruction [sn:%lli] with "

604 "PC %s.\n", 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

608 ià(
»ÇmeM­
[
tid
]->
	`numF»eEÁr›s
(è< 
š¡
->
	`numDe¡Regs
()) {

609 
	`DPRINTF
(
R’ame
, "Blocking dueo†ack of free "

611 
blockThisCyşe
 = 
Œue
;

612 
š¡s_to_»Çme
.
	`push_äÚt
(
š¡
);

613 ++
»ÇmeFuÎRegi¡”sEv’ts
;

628 ià((
š¡
->
	`isI´Acûss
(è|| in¡->
	`isS”ŸlizeBefÜe
()) &&

629 !
š¡
->
	`isS”ŸlizeHªdËd
()) {

630 
	`DPRINTF
(
R’ame
, "Serialize before instructionƒncountered.\n");

632 ià(!
š¡
->
	`isTempS”ŸlizeBefÜe
()) {

633 
»ÇmedS”Ÿlizšg
++;

634 
š¡
->
	`£tS”ŸlizeHªdËd
();

636 
»ÇmedTempS”Ÿlizšg
++;

641 
»ÇmeStus
[
tid
] = 
S”ŸlizeSÎ
;

643 
£rŸlizeIn¡
[
tid
] = 
š¡
;

645 
blockThisCyşe
 = 
Œue
;

648 } ià((
š¡
->
	`isStÜeCÚd™iÚ®
(è|| in¡->
	`isS”ŸlizeAá”
()) &&

649 !
š¡
->
	`isS”ŸlizeHªdËd
()) {

650 
	`DPRINTF
(
R’ame
, "Serialize‡fter instructionƒncountered.\n");

652 
»ÇmedS”Ÿlizšg
++;

654 
š¡
->
	`£tS”ŸlizeHªdËd
();

656 
	`£rŸlizeAá”
(
š¡s_to_»Çme
, 
tid
);

659 
	`»ÇmeSrcRegs
(
š¡
, in¡->
th»adNumb”
);

661 
	`»ÇmeDe¡Regs
(
š¡
, in¡->
th»adNumb”
);

663 ++
»Çmed_š¡s
;

667 
toIEW
->
š¡s
[
toIEWIndex
] = 
š¡
;

668 ++(
toIEW
->
size
);

671 ++
toIEWIndex
;

674 --
š¡s_avaabË
;

677 
š¡sInProg»ss
[
tid
] +ğ
»Çmed_š¡s
;

678 
»ÇmeR’amedIn¡s
 +ğ
»Çmed_š¡s
;

681 ià(
toIEWIndex
) {

682 
wrÙeToTimeBufãr
 = 
Œue
;

687 ià(
š¡s_avaabË
) {

688 
blockThisCyşe
 = 
Œue
;

691 ià(
blockThisCyşe
) {

692 
	`block
(
tid
);

693 
toDecode
->
»ÇmeUnblock
[
tid
] = 
çl£
;

695 
	}
}

697 
	g‹m¶©e
<
şass
 
	gIm¶
>

699 
	gDeçuÉR’ame
<
	gIm¶
>::
	$skidIn£¹
(
Th»adID
 
tid
)

701 
DynIn¡PŒ
 
š¡
 = 
NULL
;

703 !
š¡s
[
tid
].
	`em±y
()) {

704 
š¡
 = 
š¡s
[
tid
].
	`äÚt
();

706 
š¡s
[
tid
].
	`pİ_äÚt
();

708 
	`as£¹
(
tid
 =ğ
š¡
->
th»adNumb”
);

710 
	`DPRINTF
(
R’ame
, "[tid:%u]: Inserting [sn:%lli] PC: %s into Rename "

711 "skidBufãr\n", 
tid
, 
š¡
->
£qNum
, in¡->
	`pcS‹
());

713 ++
»ÇmeSkidIn¡s
;

715 
skidBufãr
[
tid
].
	`push_back
(
š¡
);

718 ià(
skidBufãr
[
tid
].
	`size
(è> 
skidBufãrMax
)

720 
ty³Çme
 
In¡Queue
::
™”©Ü
 
™
;

721 
	`w¬n
("Skidbuffer contents:\n");

722 
™
 = 
skidBufãr
[
tid
].
	`begš
(); iˆ!ğskidBufãr[tid].
	`’d
(); it++)

724 
	`w¬n
("[tid:%u]: % [¢:%i].\n", 
tid
,

725 (*
™
)->
¡©icIn¡
->
	`di§s£mbË
(
š¡
->
	`š¡Addr
()),

726 (*
™
)->
£qNum
);

728 
	`·nic
("Skidbuffer Exceeded Max Size");

730 
	}
}

732 
	g‹m¶©e
 <
şass
 
	gIm¶
>

734 
	gDeçuÉR’ame
<
	gIm¶
>::
	$sÜtIn¡s
()

736 
š¡s_äom_decode
 = 
äomDecode
->
size
;

737 
i
 = 0; i < 
š¡s_äom_decode
; ++i) {

738 
DynIn¡PŒ
 
š¡
 = 
äomDecode
->
š¡s
[
i
];

739 
š¡s
[
š¡
->
th»adNumb”
].
	`push_back
(inst);

740 #ià
TRACING_ON


741 ià(
	`DTRACE
(
O3PeV›w
)) {

742 
š¡
->
»ÇmeTick
 = 
	`curTick
(è- in¡->
ãtchTick
;

746 
	}
}

748 
	g‹m¶©e
<
şass
 
	gIm¶
>

749 
boŞ


750 
	gDeçuÉR’ame
<
	gIm¶
>::
	$skidsEm±y
()

752 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

753 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

755 
th»ads
 !ğ
’d
) {

756 
Th»adID
 
tid
 = *
th»ads
++;

758 ià(!
skidBufãr
[
tid
].
	`em±y
())

759  
çl£
;

762  
Œue
;

763 
	}
}

765 
	g‹m¶©e
<
şass
 
	gIm¶
>

767 
	gDeçuÉR’ame
<
	gIm¶
>::
	$upd©eStus
()

769 
boŞ
 
ªy_unblockšg
 = 
çl£
;

771 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

772 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

774 
th»ads
 !ğ
’d
) {

775 
Th»adID
 
tid
 = *
th»ads
++;

777 ià(
»ÇmeStus
[
tid
] =ğ
Unblockšg
) {

778 
ªy_unblockšg
 = 
Œue
;

784 ià(
ªy_unblockšg
) {

785 ià(
_¡©us
 =ğ
IÇùive
) {

786 
_¡©us
 = 
Aùive
;

788 
	`DPRINTF
(
Aùiv™y
, "Activating stage.\n");

790 
ıu
->
	`aùiv©eSge
(
O3CPU
::
R’ameIdx
);

795 ià(
_¡©us
 =ğ
Aùive
) {

796 
_¡©us
 = 
IÇùive
;

797 
	`DPRINTF
(
Aùiv™y
, "Deactivating stage.\n");

799 
ıu
->
	`d—ùiv©eSge
(
O3CPU
::
R’ameIdx
);

802 
	}
}

804 
	g‹m¶©e
 <
şass
 
	gIm¶
>

805 
boŞ


806 
	gDeçuÉR’ame
<
	gIm¶
>::
	$block
(
Th»adID
 
tid
)

808 
	`DPRINTF
(
R’ame
, "[tid:%u]: Blockšg.\n", 
tid
);

812 
	`skidIn£¹
(
tid
);

816 ià(
»ÇmeStus
[
tid
] !ğ
Blocked
) {

820 ià(
»sumeUnblockšg
 || 
»ÇmeStus
[
tid
] !ğ
Unblockšg
) {

821 
toDecode
->
»ÇmeBlock
[
tid
] = 
Œue
;

822 
toDecode
->
»ÇmeUnblock
[
tid
] = 
çl£
;

823 
wrÙeToTimeBufãr
 = 
Œue
;

828 ià(
»ÇmeStus
[
tid
] !ğ
S”ŸlizeSÎ
) {

830 
»ÇmeStus
[
tid
] = 
Blocked
;

831  
Œue
;

835  
çl£
;

836 
	}
}

838 
	g‹m¶©e
 <
şass
 
	gIm¶
>

839 
boŞ


840 
	gDeçuÉR’ame
<
	gIm¶
>::
	$unblock
(
Th»adID
 
tid
)

842 
	`DPRINTF
(
R’ame
, "[tid:%u]: TryšgØunblock.\n", 
tid
);

845 ià(
skidBufãr
[
tid
].
	`em±y
(è&& 
»ÇmeStus
[tid] !ğ
S”ŸlizeSÎ
) {

847 
	`DPRINTF
(
R’ame
, "[tid:%u]: DÚunblockšg.\n", 
tid
);

849 
toDecode
->
»ÇmeUnblock
[
tid
] = 
Œue
;

850 
wrÙeToTimeBufãr
 = 
Œue
;

852 
»ÇmeStus
[
tid
] = 
RuÂšg
;

853  
Œue
;

856  
çl£
;

857 
	}
}

859 
	g‹m¶©e
 <
şass
 
	gIm¶
>

861 
	gDeçuÉR’ame
<
	gIm¶
>::
	$doSquash
(cÚ¡ 
In¡SeqNum
 &
squashed_£q_num
, 
Th»adID
 
tid
)

863 
ty³Çme
 
¡d
::
li¡
<
R’ameHi¡Üy
>::
™”©Ü
 
hb_™
 =

864 
hi¡ÜyBufãr
[
tid
].
	`begš
();

868 ià(
hi¡ÜyBufãr
[
tid
].
	`em±y
()) {

874 !
hi¡ÜyBufãr
[
tid
].
	`em±y
() &&

875 
hb_™
->
š¡SeqNum
 > 
squashed_£q_num
) {

876 
	`as£¹
(
hb_™
 !ğ
hi¡ÜyBufãr
[
tid
].
	`’d
());

878 
	`DPRINTF
(
R’ame
, "[tid:%u]: Removing historyƒntry with sequence "

879 "numb” %i.\n", 
tid
, 
hb_™
->
š¡SeqNum
);

887 ià(
hb_™
->
ÃwPhysReg
 !ğhb_™->
´evPhysReg
) {

890 
»ÇmeM­
[
tid
]->
	`£tEÁry
(
hb_™
->
¬chReg
, hb_™->
´evPhysReg
);

893 
ä“Li¡
->
	`addReg
(
hb_™
->
ÃwPhysReg
);

896 
hi¡ÜyBufãr
[
tid
].
	`”a£
(
hb_™
++);

898 ++
»ÇmeUndÚeM­s
;

900 
	}
}

902 
	g‹m¶©e
<
şass
 
	gIm¶
>

904 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»moveFromHi¡Üy
(
In¡SeqNum
 
š¡_£q_num
, 
Th»adID
 
tid
)

906 
	`DPRINTF
(
R’ame
, "[tid:%u]: Removing‡ committed instruction fromhe "

908 
tid
,id, 
hi¡ÜyBufãr
[tid].
	`size
(), 
š¡_£q_num
);

910 
ty³Çme
 
¡d
::
li¡
<
R’ameHi¡Üy
>::
™”©Ü
 
hb_™
 =

911 
hi¡ÜyBufãr
[
tid
].
	`’d
();

913 --
hb_™
;

915 ià(
hi¡ÜyBufãr
[
tid
].
	`em±y
()) {

916 
	`DPRINTF
(
R’ame
, "[tid:%u]: Hi¡Üy bufã¸i em±y.\n", 
tid
);

918 } ià(
hb_™
->
š¡SeqNum
 > 
š¡_£q_num
) {

919 
	`DPRINTF
(
R’ame
, "[tid:%u]: Old sequence‚umberƒncountered. Ensure "

920 "th©‡ sysÿÎ h­³Ãd„eûÁly.\n", 
tid
);

928 !
hi¡ÜyBufãr
[
tid
].
	`em±y
() &&

929 
hb_™
 !ğ
hi¡ÜyBufãr
[
tid
].
	`’d
() &&

930 
hb_™
->
š¡SeqNum
 <ğ
š¡_£q_num
) {

932 
	`DPRINTF
(
R’ame
, "[tid:%u]: Freeing up older„ename of„eg %i, "

934 
tid
, 
hb_™
->
´evPhysReg
, hb_™->
š¡SeqNum
);

939 ià(
hb_™
->
ÃwPhysReg
 !ğhb_™->
´evPhysReg
) {

940 
ä“Li¡
->
	`addReg
(
hb_™
->
´evPhysReg
);

943 ++
»ÇmeComm™‹dM­s
;

945 
hi¡ÜyBufãr
[
tid
].
	`”a£
(
hb_™
--);

947 
	}
}

949 
	g‹m¶©e
 <
şass
 
	gIm¶
>

950 
šlše
 

951 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»ÇmeSrcRegs
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
)

953 
Th»adCÚ‹xt
 *
tc
 = 
š¡
->
	`tcBa£
();

954 
R’ameM­
 *
m­
 = 
»ÇmeM­
[
tid
];

955 
num_¤c_»gs
 = 
š¡
->
	`numSrcRegs
();

959 
¤c_idx
 = 0; src_idx < 
num_¤c_»gs
; src_idx++) {

960 
RegIndex
 
¤c_»g
 = 
š¡
->
	`¤cRegIdx
(
¤c_idx
);

961 
RegIndex
 
»l_¤c_»g
;

962 
RegIndex
 
æ©_»l_¤c_»g
;

963 
PhysRegIndex
 
»Çmed_»g
;

965 
	`»gIdxToCÏss
(
¤c_»g
, &
»l_¤c_»g
)) {

966 
IÁRegCÏss
:

967 
æ©_»l_¤c_»g
 = 
tc
->
	`æ©‹nIÁIndex
(
»l_¤c_»g
);

968 
»Çmed_»g
 = 
m­
->
	`lookupIÁ
(
æ©_»l_¤c_»g
);

969 
štR’ameLookups
++;

972 
FlßtRegCÏss
:

973 
æ©_»l_¤c_»g
 = 
tc
->
	`æ©‹nFlßtIndex
(
»l_¤c_»g
);

974 
»Çmed_»g
 = 
m­
->
	`lookupFlßt
(
æ©_»l_¤c_»g
);

975 
åR’ameLookups
++;

978 
CCRegCÏss
:

979 
æ©_»l_¤c_»g
 = 
tc
->
	`æ©‹nCCIndex
(
»l_¤c_»g
);

980 
»Çmed_»g
 = 
m­
->
	`lookupCC
(
æ©_»l_¤c_»g
);

983 
MiscRegCÏss
:

985 
æ©_»l_¤c_»g
 = 
»l_¤c_»g
;

986 
»Çmed_»g
 = 
m­
->
	`lookupMisc
(
æ©_»l_¤c_»g
);

990 
	`·nic
("Reg index i ouˆoàbound: %d.", 
¤c_»g
);

993 
	`DPRINTF
(
R’ame
, "[tid:%u]: Looking up %s‡rch„eg %i (flattened %i), "

994 "gÙ…hy »g %i\n", 
tid
, 
RegCÏssSŒšgs
[
	`»gIdxToCÏss
(
¤c_»g
)],

995 ()
¤c_»g
, ()
æ©_»l_¤c_»g
, ()
»Çmed_»g
);

997 
š¡
->
	`»ÇmeSrcReg
(
¤c_idx
, 
»Çmed_»g
);

1000 ià(
scÜebßrd
->
	`g‘Reg
(
»Çmed_»g
)) {

1001 
	`DPRINTF
(
R’ame
, "[tid:%u]: Register %d is„eady.\n",

1002 
tid
, 
»Çmed_»g
);

1004 
š¡
->
	`m¬kSrcRegR—dy
(
¤c_idx
);

1006 
	`DPRINTF
(
R’ame
, "[tid:%u]: Register %d is‚ot„eady.\n",

1007 
tid
, 
»Çmed_»g
);

1010 ++
»ÇmeR’ameLookups
;

1012 
	}
}

1014 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1015 
šlše
 

1016 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»ÇmeDe¡Regs
(
DynIn¡PŒ
 &
š¡
, 
Th»adID
 
tid
)

1018 
Th»adCÚ‹xt
 *
tc
 = 
š¡
->
	`tcBa£
();

1019 
R’ameM­
 *
m­
 = 
»ÇmeM­
[
tid
];

1020 
num_de¡_»gs
 = 
š¡
->
	`numDe¡Regs
();

1023 
de¡_idx
 = 0; de¡_idx < 
num_de¡_»gs
; dest_idx++) {

1024 
RegIndex
 
de¡_»g
 = 
š¡
->
	`de¡RegIdx
(
de¡_idx
);

1025 
RegIndex
 
»l_de¡_»g
;

1026 
RegIndex
 
æ©_»l_de¡_»g
;

1027 
RegIndex
 
æ©_uni_de¡_»g
;

1028 
ty³Çme
 
R’ameM­
::
R’ameInfo
 
»Çme_»suÉ
;

1030 
	`»gIdxToCÏss
(
de¡_»g
, &
»l_de¡_»g
)) {

1031 
IÁRegCÏss
:

1032 
æ©_»l_de¡_»g
 = 
tc
->
	`æ©‹nIÁIndex
(
»l_de¡_»g
);

1033 
»Çme_»suÉ
 = 
m­
->
	`»ÇmeIÁ
(
æ©_»l_de¡_»g
);

1034 
æ©_uni_de¡_»g
 = 
æ©_»l_de¡_»g
;

1037 
FlßtRegCÏss
:

1038 
æ©_»l_de¡_»g
 = 
tc
->
	`æ©‹nFlßtIndex
(
»l_de¡_»g
);

1039 
»Çme_»suÉ
 = 
m­
->
	`»ÇmeFlßt
(
æ©_»l_de¡_»g
);

1040 
æ©_uni_de¡_»g
 = 
æ©_»l_de¡_»g
 + 
TheISA
::
FP_Reg_Ba£
;

1043 
CCRegCÏss
:

1044 
æ©_»l_de¡_»g
 = 
tc
->
	`æ©‹nCCIndex
(
»l_de¡_»g
);

1045 
»Çme_»suÉ
 = 
m­
->
	`»ÇmeCC
(
æ©_»l_de¡_»g
);

1046 
æ©_uni_de¡_»g
 = 
æ©_»l_de¡_»g
 + 
TheISA
::
CC_Reg_Ba£
;

1049 
MiscRegCÏss
:

1051 
æ©_»l_de¡_»g
 = 
»l_de¡_»g
;

1052 
»Çme_»suÉ
 = 
m­
->
	`»ÇmeMisc
(
æ©_»l_de¡_»g
);

1053 
æ©_uni_de¡_»g
 = 
æ©_»l_de¡_»g
 + 
TheISA
::
Misc_Reg_Ba£
;

1057 
	`·nic
("Reg index i ouˆoàbound: %d.", 
de¡_»g
);

1060 
š¡
->
	`æ©‹nDe¡Reg
(
de¡_idx
, 
æ©_uni_de¡_»g
);

1063 
scÜebßrd
->
	`un£tReg
(
»Çme_»suÉ
.
fœ¡
);

1065 
	`DPRINTF
(
R’ame
, "[tid:%u]: Renaming‡rch„eg %io…hysical "

1066 "»g %i.\n", 
tid
, ()
æ©_»l_de¡_»g
,

1067 ()
»Çme_»suÉ
.
fœ¡
);

1070 
R’ameHi¡Üy
 
	`hb_’Œy
(
š¡
->
£qNum
, 
æ©_uni_de¡_»g
,

1071 
»Çme_»suÉ
.
fœ¡
,

1072 
»Çme_»suÉ
.
£cÚd
);

1074 
hi¡ÜyBufãr
[
tid
].
	`push_äÚt
(
hb_’Œy
);

1076 
	`DPRINTF
(
R’ame
, "[tid:%u]: Adding instructiono history buffer "

1077 "(size=%i), [¢:%Îi].\n",
tid
,

1078 
hi¡ÜyBufãr
[
tid
].
	`size
(),

1079 (*
hi¡ÜyBufãr
[
tid
].
	`begš
()).
š¡SeqNum
);

1086 
š¡
->
	`»ÇmeDe¡Reg
(
de¡_idx
,

1087 
»Çme_»suÉ
.
fœ¡
,

1088 
»Çme_»suÉ
.
£cÚd
);

1090 ++
»ÇmeR’amedO³¿nds
;

1092 
	}
}

1094 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1095 
šlše
 

1096 
	gDeçuÉR’ame
<
	gIm¶
>::
	$ÿlcF»eROBEÁr›s
(
Th»adID
 
tid
)

1098 
num_ä“
 = 
ä“EÁr›s
[
tid
].
robEÁr›s
 -

1099 (
š¡sInProg»ss
[
tid
] - 
äomIEW
->
›wInfo
[tid].
di¥©ched
);

1103  
num_ä“
;

1104 
	}
}

1106 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1107 
šlše
 

1108 
	gDeçuÉR’ame
<
	gIm¶
>::
	$ÿlcF»eIQEÁr›s
(
Th»adID
 
tid
)

1110 
num_ä“
 = 
ä“EÁr›s
[
tid
].
iqEÁr›s
 -

1111 (
š¡sInProg»ss
[
tid
] - 
äomIEW
->
›wInfo
[tid].
di¥©ched
);

1115  
num_ä“
;

1116 
	}
}

1118 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1119 
šlše
 

1120 
	gDeçuÉR’ame
<
	gIm¶
>::
	$ÿlcF»eLSQEÁr›s
(
Th»adID
 
tid
)

1122 
num_ä“
 = 
ä“EÁr›s
[
tid
].
lsqEÁr›s
 -

1123 (
š¡sInProg»ss
[
tid
] - 
äomIEW
->
›wInfo
[tid].
di¥©chedToLSQ
);

1127  
num_ä“
;

1128 
	}
}

1130 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1132 
	gDeçuÉR’ame
<
	gIm¶
>::
	$v®idIn¡s
()

1134 
š¡_couÁ
 = 0;

1136 
i
=0; i<
äomDecode
->
size
; i++) {

1137 ià(!
äomDecode
->
š¡s
[
i
]->
	`isSquashed
())

1138 
š¡_couÁ
++;

1141  
š¡_couÁ
;

1142 
	}
}

1144 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1146 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»adSÎSigÇls
(
Th»adID
 
tid
)

1148 ià(
äomIEW
->
›wBlock
[
tid
]) {

1149 
¡®ls
[
tid
].
›w
 = 
Œue
;

1152 ià(
äomIEW
->
›wUnblock
[
tid
]) {

1153 
	`as£¹
(
¡®ls
[
tid
].
›w
);

1154 
¡®ls
[
tid
].
›w
 = 
çl£
;

1157 ià(
äomComm™
->
comm™Block
[
tid
]) {

1158 
¡®ls
[
tid
].
comm™
 = 
Œue
;

1161 ià(
äomComm™
->
comm™Unblock
[
tid
]) {

1162 
	`as£¹
(
¡®ls
[
tid
].
comm™
);

1163 
¡®ls
[
tid
].
comm™
 = 
çl£
;

1165 
	}
}

1167 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1168 
boŞ


1169 
	gDeçuÉR’ame
<
	gIm¶
>::
	$checkSÎ
(
Th»adID
 
tid
)

1171 
boŞ
 
»t_v®
 = 
çl£
;

1173 ià(
¡®ls
[
tid
].
›w
) {

1174 
	`DPRINTF
(
R’ame
,"[tid:%i]: SÎ from IEW sgd‘eùed.\n", 
tid
);

1175 
»t_v®
 = 
Œue
;

1176 } ià(
¡®ls
[
tid
].
comm™
) {

1177 
	`DPRINTF
(
R’ame
,"[tid:%i]: SÎ from Comm™ sgd‘eùed.\n", 
tid
);

1178 
»t_v®
 = 
Œue
;

1179 } ià(
	`ÿlcF»eROBEÁr›s
(
tid
) <= 0) {

1180 
	`DPRINTF
(
R’ame
,"[tid:%i]: SÎ: ROB ha 0 f»’Œ›s.\n", 
tid
);

1181 
»t_v®
 = 
Œue
;

1182 } ià(
	`ÿlcF»eIQEÁr›s
(
tid
) <= 0) {

1183 
	`DPRINTF
(
R’ame
,"[tid:%i]: SÎ: IQ ha 0 f»’Œ›s.\n", 
tid
);

1184 
»t_v®
 = 
Œue
;

1185 } ià(
	`ÿlcF»eLSQEÁr›s
(
tid
) <= 0) {

1186 
	`DPRINTF
(
R’ame
,"[tid:%i]: SÎ: LSQ ha 0 f»’Œ›s.\n", 
tid
);

1187 
»t_v®
 = 
Œue
;

1188 } ià(
»ÇmeM­
[
tid
]->
	`numF»eEÁr›s
() <= 0) {

1189 
	`DPRINTF
(
R’ame
,"[tid:%i]: SÎ: R’ameM­ ha 0 f»’Œ›s.\n", 
tid
);

1190 
»t_v®
 = 
Œue
;

1191 } ià(
»ÇmeStus
[
tid
] =ğ
S”ŸlizeSÎ
 &&

1192 (!
em±yROB
[
tid
] || 
š¡sInProg»ss
[tid])) {

1193 
	`DPRINTF
(
R’ame
,"[tid:%i]: Stall: Serialize stall‡nd ROB is‚ot "

1195 
tid
);

1196 
»t_v®
 = 
Œue
;

1199  
»t_v®
;

1200 
	}
}

1202 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1204 
	gDeçuÉR’ame
<
	gIm¶
>::
	$»adF»eEÁr›s
(
Th»adID
 
tid
)

1206 ià(
äomIEW
->
›wInfo
[
tid
].
u£dIQ
)

1207 
ä“EÁr›s
[
tid
].
iqEÁr›s
 = 
äomIEW
->
›wInfo
[tid].
ä“IQEÁr›s
;

1209 ià(
äomIEW
->
›wInfo
[
tid
].
u£dLSQ
)

1210 
ä“EÁr›s
[
tid
].
lsqEÁr›s
 = 
äomIEW
->
›wInfo
[tid].
ä“LSQEÁr›s
;

1212 ià(
äomComm™
->
comm™Info
[
tid
].
u£dROB
) {

1213 
ä“EÁr›s
[
tid
].
robEÁr›s
 =

1214 
äomComm™
->
comm™Info
[
tid
].
ä“ROBEÁr›s
;

1215 
em±yROB
[
tid
] = 
äomComm™
->
comm™Info
[tid].emptyROB;

1218 
	`DPRINTF
(
R’ame
, "[tid:%i]: Free IQ: %i, Free ROB: %i, Free LSQ: %i\n",

1219 
tid
,

1220 
ä“EÁr›s
[
tid
].
iqEÁr›s
,

1221 
ä“EÁr›s
[
tid
].
robEÁr›s
,

1222 
ä“EÁr›s
[
tid
].
lsqEÁr›s
);

1224 
	`DPRINTF
(
R’ame
, "[tid:%i]: %i instructions‚ot yet in ROB\n",

1225 
tid
, 
š¡sInProg»ss
[tid]);

1226 
	}
}

1228 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1229 
boŞ


1230 
	gDeçuÉR’ame
<
	gIm¶
>::
	$checkSigÇlsAndUpd©e
(
Th»adID
 
tid
)

1242 
	`»adF»eEÁr›s
(
tid
);

1243 
	`»adSÎSigÇls
(
tid
);

1245 ià(
äomComm™
->
comm™Info
[
tid
].
squash
) {

1246 
	`DPRINTF
(
R’ame
, "[tid:%u]: Squashing instructions dueo squash from "

1247 "comm™.\n", 
tid
);

1249 
	`squash
(
äomComm™
->
comm™Info
[
tid
].
dÚeSeqNum
,id);

1251  
Œue
;

1254 ià(
äomComm™
->
comm™Info
[
tid
].
robSquashšg
) {

1255 
	`DPRINTF
(
R’ame
, "[tid:%u]: ROB i ¡Èsquashšg.\n", 
tid
);

1257 
»ÇmeStus
[
tid
] = 
Squashšg
;

1259  
Œue
;

1262 ià(
	`checkSÎ
(
tid
)) {

1263  
	`block
(
tid
);

1266 ià(
»ÇmeStus
[
tid
] =ğ
Blocked
) {

1267 
	`DPRINTF
(
R’ame
, "[tid:%u]: Done blocking, switchingo unblocking.\n",

1268 
tid
);

1270 
»ÇmeStus
[
tid
] = 
Unblockšg
;

1272 
	`unblock
(
tid
);

1274  
Œue
;

1277 ià(
»ÇmeStus
[
tid
] =ğ
Squashšg
) {

1280 ià(
»sumeS”Ÿlize
) {

1281 
	`DPRINTF
(
R’ame
, "[tid:%u]: Done squashing, switchingo serialize.\n",

1282 
tid
);

1284 
»ÇmeStus
[
tid
] = 
S”ŸlizeSÎ
;

1285  
Œue
;

1286 } ià(
»sumeUnblockšg
) {

1287 
	`DPRINTF
(
R’ame
, "[tid:%u]: Done squashing, switchingo unblocking.\n",

1288 
tid
);

1289 
»ÇmeStus
[
tid
] = 
Unblockšg
;

1290  
Œue
;

1292 
	`DPRINTF
(
R’ame
, "[tid:%u]: Done squashing, switchingo„unning.\n",

1293 
tid
);

1295 
»ÇmeStus
[
tid
] = 
RuÂšg
;

1296  
çl£
;

1300 ià(
»ÇmeStus
[
tid
] =ğ
S”ŸlizeSÎ
) {

1302 
	`DPRINTF
(
R’ame
, "[tid:%u]: Done with serialize stall, switchingo "

1303 "unblockšg.\n", 
tid
);

1305 
DynIn¡PŒ
 
£rŸl_š¡
 = 
£rŸlizeIn¡
[
tid
];

1307 
»ÇmeStus
[
tid
] = 
Unblockšg
;

1309 
	`unblock
(
tid
);

1311 
	`DPRINTF
(
R’ame
, "[tid:%u]: Processing instruction [%lli] with "

1312 "PC %s.\n", 
tid
, 
£rŸl_š¡
->
£qNum
, s”Ÿl_š¡->
	`pcS‹
());

1315 
£rŸl_š¡
->
	`ş—rS”ŸlizeBefÜe
();

1317 ià(!
skidBufãr
[
tid
].
	`em±y
()) {

1318 
skidBufãr
[
tid
].
	`push_äÚt
(
£rŸl_š¡
);

1320 
š¡s
[
tid
].
	`push_äÚt
(
£rŸl_š¡
);

1323 
	`DPRINTF
(
R’ame
, "[tid:%u]: Instruction must be…rocessed by„ename."

1324 " AddšgØäÚˆoàli¡.\n", 
tid
);

1326 
£rŸlizeIn¡
[
tid
] = 
NULL
;

1328  
Œue
;

1333  
çl£
;

1334 
	}
}

1336 
	g‹m¶©e
<
şass
 
	gIm¶
>

1338 
	gDeçuÉR’ame
<
	gIm¶
>::
	$£rŸlizeAá”
(
In¡Queue
 &
š¡_li¡
, 
Th»adID
 
tid
)

1340 ià(
š¡_li¡
.
	`em±y
()) {

1342 
£rŸlizeOnNextIn¡
[
tid
] = 
Œue
;

1347 
š¡_li¡
.
	`äÚt
()->
	`£tS”ŸlizeBefÜe
();

1348 
	}
}

1350 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1351 
šlše
 

1352 
	gDeçuÉR’ame
<
	gIm¶
>::
	$šüFuÎSt
(cÚ¡ 
FuÎSourû
 &
sourû
)

1354 
sourû
) {

1355 
ROB
:

1356 ++
»ÇmeROBFuÎEv’ts
;

1358 
IQ
:

1359 ++
»ÇmeIQFuÎEv’ts
;

1361 
LSQ
:

1362 ++
»ÇmeLSQFuÎEv’ts
;

1365 
	`·nic
("Rename full stall stat should be incremented for‡„eason!");

1368 
	}
}

1370 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1372 
	gDeçuÉR’ame
<
	gIm¶
>::
	$dumpHi¡Üy
()

1374 
ty³Çme
 
¡d
::
li¡
<
R’ameHi¡Üy
>::
™”©Ü
 
buf_™
;

1376 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

1378 
buf_™
 = 
hi¡ÜyBufãr
[
tid
].
	`begš
();

1380 
buf_™
 !ğ
hi¡ÜyBufãr
[
tid
].
	`’d
()) {

1381 
	`ırštf
("Seq‚um: %i\nArch„eg: %i New…hys„eg: %i Old…hys "

1382 "»g: %i\n", (*
buf_™
).
š¡SeqNum
, ()(*buf_™).
¬chReg
,

1383 ()(*
buf_™
).
ÃwPhysReg
, ()(*buf_™).
´evPhysReg
);

1385 
buf_™
++;

1388 
	}
}

	@o3/rename_map.cc

32 
	~<veùÜ
>

34 
	~"ıu/o3/»Çme_m­.hh
"

35 
	~"debug/R’ame.hh
"

37 
usšg
 
Çme¥aû
 
	g¡d
;

41 
	gSim¶eR’ameM­
::
	$Sim¶eR’ameM­
()

42 : 
	$ä“Li¡
(
NULL
)

44 
	}
}

48 
Sim¶eR’ameM­
::
	$š™
(
size
, 
Sim¶eF»eLi¡
 *
_ä“Li¡
,

49 
RegIndex
 
_z”oReg
)

51 
	`as£¹
(
ä“Li¡
 =ğ
NULL
);

52 
	`as£¹
(
m­
.
	`em±y
());

54 
m­
.
	`»size
(
size
);

55 
ä“Li¡
 = 
_ä“Li¡
;

56 
z”oReg
 = 
_z”oReg
;

57 
	}
}

59 
	gSim¶eR’ameM­
::
R’ameInfo


60 
Sim¶eR’ameM­
::
	$»Çme
(
RegIndex
 
¬ch_»g
)

62 
PhysRegIndex
 
»Çmed_»g
;

66 
PhysRegIndex
 
´ev_»g
 = 
m­
[
¬ch_»g
];

70 ià(
¬ch_»g
 !ğ
z”oReg
) {

71 
»Çmed_»g
 = 
ä“Li¡
->
	`g‘Reg
();

73 
m­
[
¬ch_»g
] = 
»Çmed_»g
;

76 
	`as£¹
(
´ev_»g
 =ğ
z”oReg
);

77 
»Çmed_»g
 = 
z”oReg
;

80 
	`DPRINTF
(
R’ame
, "Renamed„eg %do…hysical„eg %d old mapping was %d\n",

81 
¬ch_»g
, 
»Çmed_»g
, 
´ev_»g
);

83  
	`R’ameInfo
(
»Çmed_»g
, 
´ev_»g
);

84 
	}
}

90 
	gUnif›dR’ameM­
::
	$š™
(
PhysRegFe
 *
_»gFe
,

91 
RegIndex
 
_štZ”oReg
,

92 
RegIndex
 
_æßtZ”oReg
,

93 
Unif›dF»eLi¡
 *
ä“Li¡
)

95 
»gFe
 = 
_»gFe
;

97 
štM­
.
	`š™
(
TheISA
::
NumIÁRegs
, &(
ä“Li¡
->
štLi¡
), 
_štZ”oReg
);

99 
æßtM­
.
	`š™
(
TheISA
::
NumFlßtRegs
, &(
ä“Li¡
->
æßtLi¡
), 
_æßtZ”oReg
);

101 
ccM­
.
	`š™
(
TheISA
::
NumFlßtRegs
, &(
ä“Li¡
->
ccLi¡
), (
RegIndex
)-1);

102 
	}
}

105 
	gUnif›dR’ameM­
::
R’ameInfo


106 
Unif›dR’ameM­
::
	$»Çme
(
RegIndex
 
¬ch_»g
)

108 
RegIndex
 
»l_¬ch_»g
;

110 
	`»gIdxToCÏss
(
¬ch_»g
, &
»l_¬ch_»g
)) {

111 
IÁRegCÏss
:

112  
	`»ÇmeIÁ
(
»l_¬ch_»g
);

114 
FlßtRegCÏss
:

115  
	`»ÇmeFlßt
(
»l_¬ch_»g
);

117 
CCRegCÏss
:

118  
	`»ÇmeCC
(
»l_¬ch_»g
);

120 
MiscRegCÏss
:

121  
	`»ÇmeMisc
(
»l_¬ch_»g
);

124 
	`·nic
("rename„ename(): unknown„eg class %s\n",

125 
RegCÏssSŒšgs
[
	`»gIdxToCÏss
(
¬ch_»g
)]);

127 
	}
}

130 
PhysRegIndex


131 
	gUnif›dR’ameM­
::
	$lookup
(
RegIndex
 
¬ch_»g
) const

133 
RegIndex
 
»l_¬ch_»g
;

135 
	`»gIdxToCÏss
(
¬ch_»g
, &
»l_¬ch_»g
)) {

136 
IÁRegCÏss
:

137  
	`lookupIÁ
(
»l_¬ch_»g
);

139 
FlßtRegCÏss
:

140  
	`lookupFlßt
(
»l_¬ch_»g
);

142 
CCRegCÏss
:

143  
	`lookupCC
(
»l_¬ch_»g
);

145 
MiscRegCÏss
:

146  
	`lookupMisc
(
»l_¬ch_»g
);

149 
	`·nic
("rename†ookup(): unknown„eg class %s\n",

150 
RegCÏssSŒšgs
[
	`»gIdxToCÏss
(
¬ch_»g
)]);

152 
	}
}

155 
	gUnif›dR’ameM­
::
	$£tEÁry
(
RegIndex
 
¬ch_»g
, 
PhysRegIndex
 
phys_»g
)

157 
RegIndex
 
»l_¬ch_»g
;

159 
	`»gIdxToCÏss
(
¬ch_»g
, &
»l_¬ch_»g
)) {

160 
IÁRegCÏss
:

161  
	`£tIÁEÁry
(
»l_¬ch_»g
, 
phys_»g
);

163 
FlßtRegCÏss
:

164  
	`£tFlßtEÁry
(
»l_¬ch_»g
, 
phys_»g
);

166 
CCRegCÏss
:

167  
	`£tCCEÁry
(
»l_¬ch_»g
, 
phys_»g
);

169 
MiscRegCÏss
:

174 
	`as£¹
(
phys_»g
 =ğ
	`lookupMisc
(
»l_¬ch_»g
));

178 
	`·nic
("rename setEntry(): unknown„eg class %s\n",

179 
RegCÏssSŒšgs
[
	`»gIdxToCÏss
(
¬ch_»g
)]);

181 
	}
}

	@o3/rename_map.hh

37 #iâdeà
__CPU_O3_RENAME_MAP_HH__


38 
	#__CPU_O3_RENAME_MAP_HH__


	)

40 
	~<io¡»am
>

41 
	~<ut™y
>

42 
	~<veùÜ
>

44 
	~"¬ch/ty³s.hh
"

45 
	~"cÚfig/the_i§.hh
"

46 
	~"ıu/o3/ä“_li¡.hh
"

47 
	~"ıu/o3/»gfe.hh
"

48 
	~"ıu/»g_şass.hh
"

57 şas 
	cSim¶eR’ameM­


59 
	mpublic
:

61 
TheISA
::
	tRegIndex
 RegIndex;

63 
	m´iv©e
:

66 
¡d
::
veùÜ
<
PhysRegIndex
> 
m­
;

72 
Sim¶eF»eLi¡
 *
	mä“Li¡
;

81 
RegIndex
 
	mz”oReg
;

83 
	mpublic
:

85 
Sim¶eR’ameM­
();

87 ~
	$Sim¶eR’ameM­
() {};

94 
	`š™
(
size
, 
Sim¶eF»eLi¡
 *
_ä“Li¡
, 
RegIndex
 
_z”oReg
);

102 
¡d
::
	t·œ
<
	tPhysRegIndex
, PhysRegIndex> 
	tR’ameInfo
;

111 
R’ameInfo
 
	`»Çme
(
RegIndex
 
¬ch_»g
);

118 
PhysRegIndex
 
	$lookup
(
RegIndex
 
¬ch_»g
) const

120 
	`as£¹
(
¬ch_»g
 < 
m­
.
	`size
());

121  
m­
[
¬ch_»g
];

122 
	}
}

130 
	$£tEÁry
(
RegIndex
 
¬ch_»g
, 
PhysRegIndex
 
phys_»g
)

132 
m­
[
¬ch_»g
] = 
phys_»g
;

133 
	}
}

136 
	$numF»eEÁr›s
(ècÚ¡ {  
ä“Li¡
->
	`numF»eRegs
(); 
	}
}

147 şas 
	cUnif›dR’ameM­


149 
	m´iv©e
:

152 
Sim¶eR’ameM­
 
štM­
;

155 
Sim¶eR’ameM­
 
	mæßtM­
;

164 
PhysRegFe
 *
	m»gFe
;

167 
Sim¶eR’ameM­
 
	mccM­
;

169 
	mpublic
:

170 
TheISA
::
	tRegIndex
 RegIndex;

172 
	mSim¶eR’ameM­
::
	tR’ameInfo
 RenameInfo;

175 
	$Unif›dR’ameM­
() {};

178 ~
	$Unif›dR’ameM­
(è{
	}
};

181 
š™
(
PhysRegFe
 *
_»gFe
,

182 
RegIndex
 
_štZ”oReg
,

183 
RegIndex
 
_æßtZ”oReg
,

184 
Unif›dF»eLi¡
 *
ä“Li¡
);

195 
R’ameInfo
 
»Çme
(
RegIndex
 
¬ch_»g
);

201 
R’ameInfo
 
	$»ÇmeIÁ
(
RegIndex
 
»l_¬ch_»g
)

203 
R’ameInfo
 
šfo
 = 
štM­
.
	`»Çme
(
»l_¬ch_»g
);

204 
	`as£¹
(
»gFe
->
	`isIÁPhysReg
(
šfo
.
fœ¡
));

205  
šfo
;

206 
	}
}

212 
R’ameInfo
 
	$»ÇmeFlßt
(
RegIndex
 
»l_¬ch_»g
)

214 
R’ameInfo
 
šfo
 = 
æßtM­
.
	`»Çme
(
»l_¬ch_»g
);

215 
	`as£¹
(
»gFe
->
	`isFlßtPhysReg
(
šfo
.
fœ¡
));

216  
šfo
;

217 
	}
}

223 
R’ameInfo
 
	$»ÇmeCC
(
RegIndex
 
»l_¬ch_»g
)

225 
R’ameInfo
 
šfo
 = 
ccM­
.
	`»Çme
(
»l_¬ch_»g
);

226 
	`as£¹
(
»gFe
->
	`isCCPhysReg
(
šfo
.
fœ¡
));

227  
šfo
;

228 
	}
}

234 
R’ameInfo
 
	$»ÇmeMisc
(
RegIndex
 
»l_¬ch_»g
)

237 
PhysRegIndex
 
phys_»g
 = 
	`lookupMisc
(
»l_¬ch_»g
);

241  
	`R’ameInfo
(
phys_»g
,…hys_reg);

242 
	}
}

252 
PhysRegIndex
 
	$lookup
(
RegIndex
 
¬ch_»g
) const;

258 
PhysRegIndex
 
	$lookupIÁ
(
RegIndex
 
»l_¬ch_»g
) const

260 
PhysRegIndex
 
phys_»g
 = 
štM­
.
	`lookup
(
»l_¬ch_»g
);

261 
	`as£¹
(
»gFe
->
	`isIÁPhysReg
(
phys_»g
));

262  
phys_»g
;

263 
	}
}

269 
PhysRegIndex
 
	$lookupFlßt
(
RegIndex
 
»l_¬ch_»g
) const

271 
PhysRegIndex
 
phys_»g
 = 
æßtM­
.
	`lookup
(
»l_¬ch_»g
);

272 
	`as£¹
(
»gFe
->
	`isFlßtPhysReg
(
phys_»g
));

273  
phys_»g
;

274 
	}
}

280 
PhysRegIndex
 
	$lookupCC
(
RegIndex
 
»l_¬ch_»g
) const

282 
PhysRegIndex
 
phys_»g
 = 
ccM­
.
	`lookup
(
»l_¬ch_»g
);

283 
	`as£¹
(
»gFe
->
	`isCCPhysReg
(
phys_»g
));

284  
phys_»g
;

285 
	}
}

291 
PhysRegIndex
 
	$lookupMisc
(
RegIndex
 
»l_¬ch_»g
) const

295 
PhysRegIndex
 
phys_»g
 = 
»l_¬ch_»g
 + 
»gFe
->
	`tÙ®NumPhysRegs
();

296  
phys_»g
;

297 
	}
}

307 
£tEÁry
(
RegIndex
 
¬ch_»g
, 
PhysRegIndex
 
phys_»g
);

313 
	$£tIÁEÁry
(
RegIndex
 
¬ch_»g
, 
PhysRegIndex
 
phys_»g
)

315 
	`as£¹
(
»gFe
->
	`isIÁPhysReg
(
phys_»g
));

316 
štM­
.
	`£tEÁry
(
¬ch_»g
, 
phys_»g
);

317 
	}
}

323 
	$£tFlßtEÁry
(
RegIndex
 
¬ch_»g
, 
PhysRegIndex
 
phys_»g
)

325 
	`as£¹
(
»gFe
->
	`isFlßtPhysReg
(
phys_»g
));

326 
æßtM­
.
	`£tEÁry
(
¬ch_»g
, 
phys_»g
);

327 
	}
}

333 
	$£tCCEÁry
(
RegIndex
 
¬ch_»g
, 
PhysRegIndex
 
phys_»g
)

335 
	`as£¹
(
»gFe
->
	`isCCPhysReg
(
phys_»g
));

336 
ccM­
.
	`£tEÁry
(
¬ch_»g
, 
phys_»g
);

337 
	}
}

345 
	$numF»eEÁr›s
() const

347  
¡d
::
	`mš
(
štM­
.
	`numF»eEÁr›s
(), 
æßtM­
.numFreeEntries());

348 
	}
}

	@o3/rob.cc

32 
	~"ıu/o3/i§_¥ecific.hh
"

33 
	~"ıu/o3/rob_im¶.hh
"

36 
‹m¶©e
 
şass
 
	gROB
<
	gO3CPUIm¶
>;

	@o3/rob.hh

44 #iâdeà
__CPU_O3_ROB_HH__


45 
	#__CPU_O3_ROB_HH__


	)

47 
	~<¡ršg
>

48 
	~<ut™y
>

49 
	~<veùÜ
>

51 
	~"¬ch/»gi¡”s.hh
"

52 
	~"ba£/ty³s.hh
"

53 
	~"cÚfig/the_i§.hh
"

55 
	gD”ivO3CPUP¬ams
;

60 
	g‹m¶©e
 <
şass
 
	gIm¶
>

61 şas 
	cROB


63 
	m´Ùeùed
:

64 
TheISA
::
	tRegIndex
 RegIndex;

65 
	mpublic
:

67 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

68 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

70 
	m¡d
::
	t·œ
<
	tRegIndex
, 
	tPhysRegIndex
> 
	tUnm­Info
;

71 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tIn¡It
;

74 
	eStus
 {

75 
	mRuÂšg
,

76 
	mIdË
,

77 
	mROBSquashšg


81 
	eROBPŞicy
{

82 
	gDyÇmic
,

83 
	gP¬t™iÚed
,

84 
	gTh»shŞd


87 
	g´iv©e
:

89 
Stus
 
robStus
[
Im¶
::
MaxTh»ads
];

92 
ROBPŞicy
 
	grobPŞicy
;

94 
	gpublic
:

99 
ROB
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
);

101 
	g¡d
::
¡ršg
 
	$Çme
() const;

106 
	`£tAùiveTh»ads
(
¡d
::
li¡
<
Th»adID
> *
©_±r
);

109 
	$d¿šSª™yCheck
() const;

112 
	`keOv”From
();

119 
	`š£¹In¡
(
DynIn¡PŒ
 &
š¡
);

131 
DynIn¡PŒ
 
	`»adH—dIn¡
(
Th»adID
 
tid
);

136 
DynIn¡PŒ
 
	`fšdIn¡
(
Th»adID
 
tid
, 
In¡SeqNum
 
squash_š¡
);

148 
DynIn¡PŒ
 
	`»adTaIn¡
(
Th»adID
 
tid
);

156 
	`»tœeH—d
(
Th»adID
 
tid
);

162 
boŞ
 
	`isH—dR—dy
(
Th»adID
 
tid
);

165 
boŞ
 
	`ÿnComm™
();

168 
	`»£tEÁr›s
();

171 
	`’ŒyAmouÁ
(
Th»adID
 
num_th»ads
);

174 
	`numF»eEÁr›s
();

177 
	`numF»eEÁr›s
(
Th»adID
 
tid
);

180 
	$g‘MaxEÁr›s
(
Th»adID
 
tid
)

181 {  
maxEÁr›s
[
tid
]; 
	}
}

184 
	$g‘Th»adEÁr›s
(
Th»adID
 
tid
)

185 {  
th»adEÁr›s
[
tid
]; 
	}
}

188 
boŞ
 
	$isFuÎ
()

189 {  
numIn¡sInROB
 =ğ
numEÁr›s
; 
	}
}

192 
boŞ
 
	$isFuÎ
(
Th»adID
 
tid
)

193 {  
th»adEÁr›s
[
tid
] =ğ
numEÁr›s
; 
	}
}

196 
boŞ
 
	$isEm±y
() const

197 {  
numIn¡sInROB
 =ğ0; 
	}
}

200 
boŞ
 
	$isEm±y
(
Th»adID
 
tid
) const

201 {  
th»adEÁr›s
[
tid
] =ğ0; 
	}
}

204 
doSquash
(
Th»adID
 
tid
);

209 
squash
(
In¡SeqNum
 
squash_num
, 
Th»adID
 
tid
);

212 
upd©eH—d
();

215 
upd©eTa
();

251 
boŞ
 
	$isDÚeSquashšg
(
Th»adID
 
tid
) const

252 {  
dÚeSquashšg
[
tid
]; 
	}
}

257 
boŞ
 
isDÚeSquashšg
();

263 
couÁIn¡s
();

269 
couÁIn¡s
(
Th»adID
 
tid
);

272 
»gSts
();

274 
	g´iv©e
:

276 
»£tS‹
();

279 
O3CPU
 *
	gıu
;

282 
	g¡d
::
li¡
<
Th»adID
> *
aùiveTh»ads
;

285 
	gnumEÁr›s
;

288 
	gth»adEÁr›s
[
Im¶
::
MaxTh»ads
];

291 
	gmaxEÁr›s
[
Im¶
::
MaxTh»ads
];

294 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
[
Im¶
::
MaxTh»ads
];

297 
	gsquashWidth
;

299 
	gpublic
:

304 
In¡It
 

;

308 
In¡It
 
	gh—d
;

310 
	g´iv©e
:

318 
In¡It
 
squashIt
[
Im¶
::
MaxTh»ads
];

320 
	gpublic
:

322 
numIn¡sInROB
;

325 
DynIn¡PŒ
 
	gdummyIn¡
;

327 
	g´iv©e
:

329 
In¡SeqNum
 
squashedSeqNum
[
Im¶
::
MaxTh»ads
];

332 
boŞ
 
	gdÚeSquashšg
[
Im¶
::
MaxTh»ads
];

335 
Th»adID
 
	gnumTh»ads
;

338 
	gSts
::
SÿÏr
 
robR—ds
;

340 
	gSts
::
SÿÏr
 
robWr™es
;

	@o3/rob_impl.hh

44 #iâdeà
__CPU_O3_ROB_IMPL_HH__


45 
	#__CPU_O3_ROB_IMPL_HH__


	)

47 
	~<li¡
>

49 
	~"ıu/o3/rob.hh
"

50 
	~"debug/F‘ch.hh
"

51 
	~"debug/ROB.hh
"

52 
	~"·¿ms/D”ivO3CPU.hh
"

54 
usšg
 
Çme¥aû
 
	g¡d
;

56 
	g‹m¶©e
 <
şass
 
	gIm¶
>

57 
	gROB
<
	gIm¶
>::
	$ROB
(
O3CPU
 *
_ıu
, 
D”ivO3CPUP¬ams
 *
·¿ms
)

58 : 
	`ıu
(
_ıu
),

59 
	`numEÁr›s
(
·¿ms
->
numROBEÁr›s
),

60 
	`squashWidth
(
·¿ms
->
squashWidth
),

61 
	`numIn¡sInROB
(0),

62 
	`numTh»ads
(
·¿ms
->
numTh»ads
)

64 
¡d
::
¡ršg
 
pŞicy
 = 
·¿ms
->
smtROBPŞicy
;

67 
¡d
::
	`ŒªsfÜm
(
pŞicy
.
	`begš
(),…Şicy.
	`’d
(),…olicy.begin(),

68 ((*)()è
tŞow”
);

71 ià(
pŞicy
 == "dynamic") {

72 
robPŞicy
 = 
DyÇmic
;

75 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

76 
maxEÁr›s
[
tid
] = 
numEÁr›s
;

79 } ià(
pŞicy
 == "partitioned") {

80 
robPŞicy
 = 
P¬t™iÚed
;

81 
	`DPRINTF
(
F‘ch
, "ROB sharing…olicy seto Partitioned\n");

84 
·¹_amt
 = 
numEÁr›s
 / 
numTh»ads
;

87 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

88 
maxEÁr›s
[
tid
] = 
·¹_amt
;

91 } ià(
pŞicy
 == "threshold") {

92 
robPŞicy
 = 
Th»shŞd
;

93 
	`DPRINTF
(
F‘ch
, "ROB sharing…olicy seto Threshold\n");

95 
th»shŞd
 = 
·¿ms
->
smtROBTh»shŞd
;;

98 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

99 
maxEÁr›s
[
tid
] = 
th»shŞd
;

102 
	`as£¹
(0 && "Invalid ROB Sharing Policy.Options Are:{Dynamic,"

106 
	`»£tS‹
();

107 
	}
}

109 
	g‹m¶©e
 <
şass
 
	gIm¶
>

111 
	gROB
<
	gIm¶
>::
	$»£tS‹
()

113 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++) {

114 
dÚeSquashšg
[
tid
] = 
Œue
;

115 
th»adEÁr›s
[
tid
] = 0;

116 
squashIt
[
tid
] = 
š¡Li¡
[tid].
	`’d
();

117 
squashedSeqNum
[
tid
] = 0;

119 
numIn¡sInROB
 = 0;

123 
h—d
 = 
š¡Li¡
[0].
	`’d
();

124 

 = 
š¡Li¡
[0].
	`’d
();

125 
	}
}

127 
	g‹m¶©e
 <
şass
 
	gIm¶
>

128 
	g¡d
::
¡ršg


129 
ROB
<
Im¶
>::
	$Çme
() const

131  
ıu
->
	`Çme
() + ".rob";

132 
	}
}

134 
	g‹m¶©e
 <
şass
 
	gIm¶
>

136 
	gROB
<
	gIm¶
>::
£tAùiveTh»ads
(
li¡
<
Th»adID
> *
©_±r
)

138 
DPRINTF
(
ROB
, "Setting‡ctivehreads†ist…ointer.\n");

139 
	gaùiveTh»ads
 = 
©_±r
;

142 
	g‹m¶©e
 <
şass
 
	gIm¶
>

144 
	gROB
<
	gIm¶
>::
	$d¿šSª™yCheck
() const

146 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++)

147 
	`as£¹
(
š¡Li¡
[
tid
].
	`em±y
());

148 
	`as£¹
(
	`isEm±y
());

149 
	}
}

151 
	g‹m¶©e
 <
şass
 
	gIm¶
>

153 
	gROB
<
	gIm¶
>::
	$keOv”From
()

155 
	`»£tS‹
();

156 
	}
}

158 
	g‹m¶©e
 <
şass
 
	gIm¶
>

160 
	gROB
<
	gIm¶
>::
	$»£tEÁr›s
()

162 ià(
robPŞicy
 !ğ
DyÇmic
 || 
numTh»ads
 > 1) {

163 
aùive_th»ads
 = 
aùiveTh»ads
->
	`size
();

165 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

166 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

168 
th»ads
 !ğ
’d
) {

169 
Th»adID
 
tid
 = *
th»ads
++;

171 ià(
robPŞicy
 =ğ
P¬t™iÚed
) {

172 
maxEÁr›s
[
tid
] = 
numEÁr›s
 / 
aùive_th»ads
;

173 } ià(
robPŞicy
 =ğ
Th»shŞd
 && 
aùive_th»ads
 == 1) {

174 
maxEÁr›s
[
tid
] = 
numEÁr›s
;

178 
	}
}

180 
	g‹m¶©e
 <
şass
 
	gIm¶
>

182 
	gROB
<
	gIm¶
>::
	$’ŒyAmouÁ
(
Th»adID
 
num_th»ads
)

184 ià(
robPŞicy
 =ğ
P¬t™iÚed
) {

185  
numEÁr›s
 / 
num_th»ads
;

189 
	}
}

191 
	g‹m¶©e
 <
şass
 
	gIm¶
>

193 
	gROB
<
	gIm¶
>::
	$couÁIn¡s
()

195 
tÙ®
 = 0;

197 
Th»adID
 
tid
 = 0;id < 
numTh»ads
;id++)

198 
tÙ®
 +ğ
	`couÁIn¡s
(
tid
);

200  
tÙ®
;

201 
	}
}

203 
	g‹m¶©e
 <
şass
 
	gIm¶
>

205 
	gROB
<
	gIm¶
>::
	$couÁIn¡s
(
Th»adID
 
tid
)

207  
š¡Li¡
[
tid
].
	`size
();

208 
	}
}

210 
	g‹m¶©e
 <
şass
 
	gIm¶
>

212 
	gROB
<
	gIm¶
>::
	$š£¹In¡
(
DynIn¡PŒ
 &
š¡
)

214 
	`as£¹
(
š¡
);

216 
robWr™es
++;

218 
	`DPRINTF
(
ROB
, "Addšg in¡ PC % tØthROB.\n", 
š¡
->
	`pcS‹
());

220 
	`as£¹
(
numIn¡sInROB
 !ğ
numEÁr›s
);

222 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

224 
š¡Li¡
[
tid
].
	`push_back
(
š¡
);

227 ià(
numIn¡sInROB
 == 0) {

228 
h—d
 = 
š¡Li¡
[
tid
].
	`begš
();

229 
	`as£¹
((*
h—d
è=ğ
š¡
);

234 

 = 
š¡Li¡
[
tid
].
	`’d
();

235 

--;

237 
š¡
->
	`£tInROB
();

239 ++
numIn¡sInROB
;

240 ++
th»adEÁr›s
[
tid
];

242 
	`as£¹
((*

è=ğ
š¡
);

244 
	`DPRINTF
(
ROB
, "[tid:%i] Now ha %d in¡ruùiÚs.\n", 
tid
, 
th»adEÁr›s
[tid]);

245 
	}
}

247 
	g‹m¶©e
 <
şass
 
	gIm¶
>

249 
	gROB
<
	gIm¶
>::
	$»tœeH—d
(
Th»adID
 
tid
)

251 
robWr™es
++;

253 
	`as£¹
(
numIn¡sInROB
 > 0);

256 
In¡It
 
h—d_™
 = 
š¡Li¡
[
tid
].
	`begš
();

258 
DynIn¡PŒ
 
h—d_š¡
 = (*
h—d_™
);

260 
	`as£¹
(
h—d_š¡
->
	`»adyToComm™
());

262 
	`DPRINTF
(
ROB
, "[tid:%u]: Retiring head instruction, "

263 "š¡ruùiÚ PC %s, [¢:%Îi]\n", 
tid
, 
h—d_š¡
->
	`pcS‹
(),

264 
h—d_š¡
->
£qNum
);

266 --
numIn¡sInROB
;

267 --
th»adEÁr›s
[
tid
];

269 
h—d_š¡
->
	`ş—rInROB
();

270 
h—d_š¡
->
	`£tComm™‹d
();

272 
š¡Li¡
[
tid
].
	`”a£
(
h—d_™
);

275 
	`upd©eH—d
();

280 
ıu
->
	`»moveFrÚtIn¡
(
h—d_š¡
);

281 
	}
}

283 
	g‹m¶©e
 <
şass
 
	gIm¶
>

284 
boŞ


285 
	gROB
<
	gIm¶
>::
	$isH—dR—dy
(
Th»adID
 
tid
)

287 
robR—ds
++;

288 ià(
th»adEÁr›s
[
tid
] != 0) {

289  
š¡Li¡
[
tid
].
	`äÚt
()->
	`»adyToComm™
();

292  
çl£
;

293 
	}
}

295 
	g‹m¶©e
 <
şass
 
	gIm¶
>

296 
boŞ


297 
	gROB
<
	gIm¶
>::
	$ÿnComm™
()

300 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

301 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

303 
th»ads
 !ğ
’d
) {

304 
Th»adID
 
tid
 = *
th»ads
++;

306 ià(
	`isH—dR—dy
(
tid
)) {

307  
Œue
;

311  
çl£
;

312 
	}
}

314 
	g‹m¶©e
 <
şass
 
	gIm¶
>

316 
	gROB
<
	gIm¶
>::
	$numF»eEÁr›s
()

318  
numEÁr›s
 - 
numIn¡sInROB
;

319 
	}
}

321 
	g‹m¶©e
 <
şass
 
	gIm¶
>

323 
	gROB
<
	gIm¶
>::
	$numF»eEÁr›s
(
Th»adID
 
tid
)

325  
maxEÁr›s
[
tid
] - 
th»adEÁr›s
[tid];

326 
	}
}

328 
	g‹m¶©e
 <
şass
 
	gIm¶
>

330 
	gROB
<
	gIm¶
>::
	$doSquash
(
Th»adID
 
tid
)

332 
robWr™es
++;

333 
	`DPRINTF
(
ROB
, "[tid:%u]: Squashing instructions until [sn:%i].\n",

334 
tid
, 
squashedSeqNum
[tid]);

336 
	`as£¹
(
squashIt
[
tid
] !ğ
š¡Li¡
[tid].
	`’d
());

338 ià((*
squashIt
[
tid
])->
£qNum
 < 
squashedSeqNum
[tid]) {

339 
	`DPRINTF
(
ROB
, "[tid:%u]: Done squashing instructions.\n",

340 
tid
);

342 
squashIt
[
tid
] = 
š¡Li¡
[tid].
	`’d
();

344 
dÚeSquashšg
[
tid
] = 
Œue
;

348 
boŞ
 
robTaUpd©e
 = 
çl£
;

350 
numSquashed
 = 0;

351 
numSquashed
 < 
squashWidth
 &&

352 
squashIt
[
tid
] !ğ
š¡Li¡
[tid].
	`’d
() &&

353 (*
squashIt
[
tid
])->
£qNum
 > 
squashedSeqNum
[tid];

354 ++
numSquashed
)

356 
	`DPRINTF
(
ROB
, "[tid:%u]: Squashing instruction PC %s, seq‚um %i.\n",

357 (*
squashIt
[
tid
])->
th»adNumb”
,

358 (*
squashIt
[
tid
])->
	`pcS‹
(),

359 (*
squashIt
[
tid
])->
£qNum
);

363 (*
squashIt
[
tid
])->
	`£tSquashed
();

365 (*
squashIt
[
tid
])->
	`£tCªComm™
();

368 ià(
squashIt
[
tid
] =ğ
š¡Li¡
[tid].
	`begš
()) {

369 
	`DPRINTF
(
ROB
, "Reached head of instruction†ist while "

372 
squashIt
[
tid
] = 
š¡Li¡
[tid].
	`’d
();

374 
dÚeSquashšg
[
tid
] = 
Œue
;

379 
In¡It
 
_th»ad
 = 
š¡Li¡
[
tid
].
	`’d
();

380 
_th»ad
--;

382 ià((*
squashIt
[
tid
]è=ğ(*
_th»ad
))

383 
robTaUpd©e
 = 
Œue
;

385 
squashIt
[
tid
]--;

390 ià((*
squashIt
[
tid
])->
£qNum
 <ğ
squashedSeqNum
[tid]) {

391 
	`DPRINTF
(
ROB
, "[tid:%u]: Done squashing instructions.\n",

392 
tid
);

394 
squashIt
[
tid
] = 
š¡Li¡
[tid].
	`’d
();

396 
dÚeSquashšg
[
tid
] = 
Œue
;

399 ià(
robTaUpd©e
) {

400 
	`upd©eTa
();

402 
	}
}

405 
	g‹m¶©e
 <
şass
 
	gIm¶
>

407 
	gROB
<
	gIm¶
>::
	$upd©eH—d
()

409 
In¡SeqNum
 
lowe¡_num
 = 0;

410 
boŞ
 
fœ¡_v®id
 = 
Œue
;

413 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

414 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

416 
th»ads
 !ğ
’d
) {

417 
Th»adID
 
tid
 = *
th»ads
++;

419 ià(
š¡Li¡
[
tid
].
	`em±y
())

422 ià(
fœ¡_v®id
) {

423 
h—d
 = 
š¡Li¡
[
tid
].
	`begš
();

424 
lowe¡_num
 = (*
h—d
)->
£qNum
;

425 
fœ¡_v®id
 = 
çl£
;

429 
In¡It
 
h—d_th»ad
 = 
š¡Li¡
[
tid
].
	`begš
();

431 
DynIn¡PŒ
 
h—d_š¡
 = (*
h—d_th»ad
);

433 
	`as£¹
(
h—d_š¡
 != 0);

435 ià(
h—d_š¡
->
£qNum
 < 
lowe¡_num
) {

436 
h—d
 = 
h—d_th»ad
;

437 
lowe¡_num
 = 
h—d_š¡
->
£qNum
;

441 ià(
fœ¡_v®id
) {

442 
h—d
 = 
š¡Li¡
[0].
	`’d
();

445 
	}
}

447 
	g‹m¶©e
 <
şass
 
	gIm¶
>

449 
	gROB
<
	gIm¶
>::
	$upd©eTa
()

451 

 = 
š¡Li¡
[0].
	`’d
();

452 
boŞ
 
fœ¡_v®id
 = 
Œue
;

454 
li¡
<
Th»adID
>::
™”©Ü
 
th»ads
 = 
aùiveTh»ads
->
	`begš
();

455 
li¡
<
Th»adID
>::
™”©Ü
 
’d
 = 
aùiveTh»ads
->
	`’d
();

457 
th»ads
 !ğ
’d
) {

458 
Th»adID
 
tid
 = *
th»ads
++;

460 ià(
š¡Li¡
[
tid
].
	`em±y
()) {

466 ià(
fœ¡_v®id
) {

467 

 = 
š¡Li¡
[
tid
].
	`’d
();

468 

--;

469 
fœ¡_v®id
 = 
çl£
;

475 
In¡It
 
_th»ad
 = 
š¡Li¡
[
tid
].
	`’d
();

476 
_th»ad
--;

478 ià((*
_th»ad
)->
£qNum
 > (*

)->seqNum) {

479 

 = 
_th»ad
;

482 
	}
}

485 
	g‹m¶©e
 <
şass
 
	gIm¶
>

487 
	gROB
<
	gIm¶
>::
	$squash
(
In¡SeqNum
 
squash_num
, 
Th»adID
 
tid
)

489 ià(
	`isEm±y
()) {

490 
	`DPRINTF
(
ROB
, "Does‚ot‚eedo squash dueo beingƒmpty "

492 
squash_num
);

497 
	`DPRINTF
(
ROB
, "Startingo squash withinhe ROB.\n");

499 
robStus
[
tid
] = 
ROBSquashšg
;

501 
dÚeSquashšg
[
tid
] = 
çl£
;

503 
squashedSeqNum
[
tid
] = 
squash_num
;

505 ià(!
š¡Li¡
[
tid
].
	`em±y
()) {

506 
In¡It
 
_th»ad
 = 
š¡Li¡
[
tid
].
	`’d
();

507 
_th»ad
--;

509 
squashIt
[
tid
] = 
_th»ad
;

511 
	`doSquash
(
tid
);

513 
	}
}

515 
	g‹m¶©e
 <
şass
 
	gIm¶
>

516 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


517 
ROB
<
Im¶
>::
	$»adH—dIn¡
(
Th»adID
 
tid
)

519 ià(
th»adEÁr›s
[
tid
] != 0) {

520 
In¡It
 
h—d_th»ad
 = 
š¡Li¡
[
tid
].
	`begš
();

522 
	`as£¹
((*
h—d_th»ad
)->
	`isInROB
()==
Œue
);

524  *
h—d_th»ad
;

526  
dummyIn¡
;

528 
	}
}

530 
	g‹m¶©e
 <
şass
 
	gIm¶
>

531 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


532 
ROB
<
Im¶
>::
	$»adTaIn¡
(
Th»adID
 
tid
)

534 
In¡It
 
_th»ad
 = 
š¡Li¡
[
tid
].
	`’d
();

535 
_th»ad
--;

537  *
_th»ad
;

538 
	}
}

540 
	g‹m¶©e
 <
şass
 
	gIm¶
>

542 
	gROB
<
	gIm¶
>::
	$»gSts
()

544 
usšg
 
Çme¥aû
 
Sts
;

545 
robR—ds


546 .
	`Çme
(name() + ".rob_reads")

547 .
	`desc
("The‚umber of ROB„eads");

549 
robWr™es


550 .
	`Çme
(name() + ".rob_writes")

551 .
	`desc
("The‚umber of ROB writes");

552 
	}
}

554 
	g‹m¶©e
 <
şass
 
	gIm¶
>

555 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


556 
ROB
<
Im¶
>::
	$fšdIn¡
(
Th»adID
 
tid
, 
In¡SeqNum
 
squash_š¡
)

558 
In¡It
 
™
 = 
š¡Li¡
[
tid
].
	`begš
(); iˆ!ğš¡Li¡[tid].
	`’d
(); it++) {

559 ià((*
™
)->
£qNum
 =ğ
squash_š¡
) {

560  *
™
;

563  
NULL
;

564 
	}
}

	@o3/scoreboard.cc

33 
	~"cÚfig/the_i§.hh
"

34 
	~"ıu/o3/scÜebßrd.hh
"

35 
	~"debug/ScÜebßrd.hh
"

37 
	gScÜebßrd
::
ScÜebßrd
(cÚ¡ 
¡d
::
¡ršg
 &
_my_Çme
,

38 
_numPhysiÿlRegs
, 
_numMiscRegs
,

39 
PhysRegIndex
 
_z”oRegIdx
, PhysRegIndex 
_åZ”oRegIdx
)

40 : 
_Çme
(
_my_Çme
),

41 
»gScÜeBßrd
(
_numPhysiÿlRegs
, 
Œue
),

42 
numPhysRegs
(
_numPhysiÿlRegs
),

43 
numTÙ®Regs
(
_numPhysiÿlRegs
 + 
_numMiscRegs
),

44 
z”oRegIdx
(
_z”oRegIdx
), 
	$åZ”oRegIdx
(
_åZ”oRegIdx
)

46 
	}
}

	@o3/scoreboard.hh

34 #iâdeà
__CPU_O3_SCOREBOARD_HH__


35 
	#__CPU_O3_SCOREBOARD_HH__


	)

37 
	~<io¡»am
>

38 
	~<ut™y
>

39 
	~<veùÜ
>

41 
	~"ba£/Œaû.hh
"

42 
	~"cÚfig/the_i§.hh
"

43 
	~"ıu/o3/comm.hh
"

44 
	~"debug/ScÜebßrd.hh
"

56 şas 
	cScÜebßrd


58 
	m´iv©e
:

61 cÚ¡ 
¡d
::
¡ršg
 
_Çme
;

65 
	m¡d
::
veùÜ
<
boŞ
> 
»gScÜeBßrd
;

68 
	mnumPhysRegs
;

75 
	mnumTÙ®Regs
;

78 
PhysRegIndex
 
	mz”oRegIdx
;

81 
PhysRegIndex
 
	måZ”oRegIdx
;

83 
boŞ
 
	$isZ”oReg
(
PhysRegIndex
 
idx
) const

85  (
idx
 =ğ
z”oRegIdx
 ||

86 (
THE_ISA
 =ğ
ALPHA_ISA
 && 
idx
 =ğ
åZ”oRegIdx
));

89 
public
:

97 
	`ScÜebßrd
(cÚ¡ 
¡d
::
¡ršg
 &
_my_Çme
,

98 
_numPhysiÿlRegs
,

99 
_numMiscRegs
,

100 
PhysRegIndex
 
_z”oRegIdx
,

101 
PhysRegIndex
 
_åZ”oRegIdx
);

104 ~
	$ScÜebßrd
(è{
	}
}

107 
	g¡d
::
¡ršg
 
	$Çme
(ècÚ¡ {  
_Çme
; 
	}
};

110 
boŞ
 
	$g‘Reg
(
PhysRegIndex
 
»g_idx
) const

112 
	`as£¹
(
»g_idx
 < 
numTÙ®Regs
);

114 ià(
»g_idx
 >ğ
numPhysRegs
) {

116  
Œue
;

119 
boŞ
 
»ady
 = 
»gScÜeBßrd
[
»g_idx
];

121 ià(
	`isZ”oReg
(
»g_idx
))

122 
	`as£¹
(
»ady
);

124  
»ady
;

125 
	}
}

128 
	$£tReg
(
PhysRegIndex
 
»g_idx
)

130 
	`as£¹
(
»g_idx
 < 
numTÙ®Regs
);

132 ià(
»g_idx
 >ğ
numPhysRegs
) {

137 
	`DPRINTF
(
ScÜebßrd
, "S‘tšg„eg %˜a »ady\n", 
»g_idx
);

139 
	`as£¹
(
»g_idx
 < 
numTÙ®Regs
);

140 
»gScÜeBßrd
[
»g_idx
] = 
Œue
;

141 
	}
}

144 
	$un£tReg
(
PhysRegIndex
 
»g_idx
)

146 
	`as£¹
(
»g_idx
 < 
numTÙ®Regs
);

148 ià(
»g_idx
 >ğ
numPhysRegs
) {

154 ià(
	`isZ”oReg
(
»g_idx
))

157 
»gScÜeBßrd
[
»g_idx
] = 
çl£
;

158 
	}
}

	@o3/store_set.cc

31 
	~"ba£/štm©h.hh
"

32 
	~"ba£/misc.hh
"

33 
	~"ba£/Œaû.hh
"

34 
	~"ıu/o3/¡Üe_£t.hh
"

35 
	~"debug/StÜeS‘.hh
"

37 
	gStÜeS‘
::
	$StÜeS‘
(
ušt64_t
 
ş—r_³riod
, 
_SSIT_size
, 
_LFST_size
)

38 : 
	`ş—rP”iod
(
ş—r_³riod
), 
	`SSITSize
(
_SSIT_size
), 
	$LFSTSize
(
_LFST_size
)

40 
	`DPRINTF
(
StÜeS‘
, "StoreSet: Creating store set object.\n");

41 
	`DPRINTF
(
StÜeS‘
, "StoreSet: SSIT size: %i, LFST size: %i.\n",

42 
SSITSize
, 
LFSTSize
);

44 ià(!
	`isPow”Of2
(
SSITSize
)) {

45 
	`çl
("Invalid SSIT size!\n");

48 
SSIT
.
	`»size
(
SSITSize
);

50 
v®idSSIT
.
	`»size
(
SSITSize
);

52 
i
 = 0; i < 
SSITSize
; ++i)

53 
v®idSSIT
[
i
] = 
çl£
;

55 ià(!
	`isPow”Of2
(
LFSTSize
)) {

56 
	`çl
("Invalid LFST size!\n");

59 
LFST
.
	`»size
(
LFSTSize
);

61 
v®idLFST
.
	`»size
(
LFSTSize
);

63 
i
 = 0; i < 
LFSTSize
; ++i) {

64 
v®idLFST
[
i
] = 
çl£
;

65 
LFST
[
i
] = 0;

68 
šdexMask
 = 
SSITSize
 - 1;

70 
off£tB™s
 = 2;

72 
memOpsP»d
 = 0;

73 
	}
}

75 
	gStÜeS‘
::~
	$StÜeS‘
()

77 
	}
}

80 
StÜeS‘
::
	$š™
(
ušt64_t
 
ş—r_³riod
, 
_SSIT_size
, 
_LFST_size
)

82 
SSITSize
 = 
_SSIT_size
;

83 
LFSTSize
 = 
_LFST_size
;

84 
ş—rP”iod
 = 
ş—r_³riod
;

86 
	`DPRINTF
(
StÜeS‘
, "StoreSet: Creating store set object.\n");

87 
	`DPRINTF
(
StÜeS‘
, "StoreSet: SSIT size: %i, LFST size: %i.\n",

88 
SSITSize
, 
LFSTSize
);

90 
SSIT
.
	`»size
(
SSITSize
);

92 
v®idSSIT
.
	`»size
(
SSITSize
);

94 
i
 = 0; i < 
SSITSize
; ++i)

95 
v®idSSIT
[
i
] = 
çl£
;

97 
LFST
.
	`»size
(
LFSTSize
);

99 
v®idLFST
.
	`»size
(
LFSTSize
);

101 
i
 = 0; i < 
LFSTSize
; ++i) {

102 
v®idLFST
[
i
] = 
çl£
;

103 
LFST
[
i
] = 0;

106 
šdexMask
 = 
SSITSize
 - 1;

108 
off£tB™s
 = 2;

110 
memOpsP»d
 = 0;

111 
	}
}

115 
	gStÜeS‘
::
	$viŞ©iÚ
(
Addr
 
¡Üe_PC
, Add¸
lßd_PC
)

117 
lßd_šdex
 = 
	`ÿlcIndex
(
lßd_PC
);

118 
¡Üe_šdex
 = 
	`ÿlcIndex
(
¡Üe_PC
);

120 
	`as£¹
(
lßd_šdex
 < 
SSITSize
 && 
¡Üe_šdex
 < SSITSize);

122 
boŞ
 
v®id_lßd_SSID
 = 
v®idSSIT
[
lßd_šdex
];

123 
boŞ
 
v®id_¡Üe_SSID
 = 
v®idSSIT
[
¡Üe_šdex
];

125 ià(!
v®id_lßd_SSID
 && !
v®id_¡Üe_SSID
) {

127 
SSID
 
Ãw_£t
 = 
	`ÿlcSSID
(
lßd_PC
);

129 
v®idSSIT
[
lßd_šdex
] = 
Œue
;

131 
SSIT
[
lßd_šdex
] = 
Ãw_£t
;

133 
v®idSSIT
[
¡Üe_šdex
] = 
Œue
;

135 
SSIT
[
¡Üe_šdex
] = 
Ãw_£t
;

137 
	`as£¹
(
Ãw_£t
 < 
LFSTSize
);

139 
	`DPRINTF
(
StÜeS‘
, "StoreSet: Neither†oad‚or store had‡ valid "

141 
Ãw_£t
, 
lßd_PC
, 
¡Üe_PC
);

142 } ià(
v®id_lßd_SSID
 && !
v®id_¡Üe_SSID
) {

143 
SSID
 
lßd_SSID
 = 
SSIT
[
lßd_šdex
];

145 
v®idSSIT
[
¡Üe_šdex
] = 
Œue
;

147 
SSIT
[
¡Üe_šdex
] = 
lßd_SSID
;

149 
	`as£¹
(
lßd_SSID
 < 
LFSTSize
);

151 
	`DPRINTF
(
StÜeS‘
, "StoreSet: Load had‡ valid store set. Adding "

153 
lßd_SSID
, 
lßd_PC
, 
¡Üe_PC
);

154 } ià(!
v®id_lßd_SSID
 && 
v®id_¡Üe_SSID
) {

155 
SSID
 
¡Üe_SSID
 = 
SSIT
[
¡Üe_šdex
];

157 
v®idSSIT
[
lßd_šdex
] = 
Œue
;

159 
SSIT
[
lßd_šdex
] = 
¡Üe_SSID
;

161 
	`DPRINTF
(
StÜeS‘
, "StoreSet: Store had‡ valid store set: %i for "

163 
¡Üe_SSID
, 
lßd_PC
, 
¡Üe_PC
);

165 
SSID
 
lßd_SSID
 = 
SSIT
[
lßd_šdex
];

166 
SSID
 
¡Üe_SSID
 = 
SSIT
[
¡Üe_šdex
];

168 
	`as£¹
(
lßd_SSID
 < 
LFSTSize
 && 
¡Üe_SSID
 < LFSTSize);

171 ià(
¡Üe_SSID
 > 
lßd_SSID
) {

172 
SSIT
[
¡Üe_šdex
] = 
lßd_SSID
;

174 
	`DPRINTF
(
StÜeS‘
, "StoreSet: Load had smaller store set: %i; "

176 
lßd_SSID
, 
lßd_PC
, 
¡Üe_PC
);

178 
SSIT
[
lßd_šdex
] = 
¡Üe_SSID
;

180 
	`DPRINTF
(
StÜeS‘
, "StoreSet: Store had smaller store set: %i; "

182 
¡Üe_SSID
, 
lßd_PC
, 
¡Üe_PC
);

185 
	}
}

188 
	gStÜeS‘
::
	$checkCË¬
()

190 
memOpsP»d
++;

191 ià(
memOpsP»d
 > 
ş—rP”iod
) {

192 
	`DPRINTF
(
StÜeS‘
, "Wiping…redictor state beacuse %d†d/stƒxecuted\n",

193 
ş—rP”iod
);

194 
memOpsP»d
 = 0;

195 
	`ş—r
();

197 
	}
}

200 
	gStÜeS‘
::
	$š£¹Lßd
(
Addr
 
lßd_PC
, 
In¡SeqNum
 
lßd_£q_num
)

202 
	`checkCË¬
();

205 
	}
}

208 
	gStÜeS‘
::
	$š£¹StÜe
(
Addr
 
¡Üe_PC
, 
In¡SeqNum
 
¡Üe_£q_num
, 
Th»adID
 
tid
)

210 
šdex
 = 
	`ÿlcIndex
(
¡Üe_PC
);

212 
¡Üe_SSID
;

214 
	`checkCË¬
();

215 
	`as£¹
(
šdex
 < 
SSITSize
);

217 ià(!
v®idSSIT
[
šdex
]) {

221 
¡Üe_SSID
 = 
SSIT
[
šdex
];

223 
	`as£¹
(
¡Üe_SSID
 < 
LFSTSize
);

226 
LFST
[
¡Üe_SSID
] = 
¡Üe_£q_num
;

228 
v®idLFST
[
¡Üe_SSID
] = 1;

230 
¡ÜeLi¡
[
¡Üe_£q_num
] = 
¡Üe_SSID
;

232 
	`DPRINTF
(
StÜeS‘
, "Store %#x updatedhe LFST, SSID: %i\n",

233 
¡Üe_PC
, 
¡Üe_SSID
);

235 
	}
}

237 
In¡SeqNum


238 
	gStÜeS‘
::
	$checkIn¡
(
Addr
 
PC
)

240 
šdex
 = 
	`ÿlcIndex
(
PC
);

242 
š¡_SSID
;

244 
	`as£¹
(
šdex
 < 
SSITSize
);

246 ià(!
v®idSSIT
[
šdex
]) {

247 
	`DPRINTF
(
StÜeS‘
, "Inst %#x with index %i had‚o SSID\n",

248 
PC
, 
šdex
);

253 
š¡_SSID
 = 
SSIT
[
šdex
];

255 
	`as£¹
(
š¡_SSID
 < 
LFSTSize
);

257 ià(!
v®idLFST
[
š¡_SSID
]) {

259 
	`DPRINTF
(
StÜeS‘
, "Inst %#x with index %i‡nd SSID %i had‚o "

260 "d•’d’cy\n", 
PC
, 
šdex
, 
š¡_SSID
);

264 
	`DPRINTF
(
StÜeS‘
, "Inst %#x with index %i‡nd SSID %i had LFST "

265 "šum oà%i\n", 
PC
, 
šdex
, 
š¡_SSID
, 
LFST
[inst_SSID]);

267  
LFST
[
š¡_SSID
];

270 
	}
}

273 
	gStÜeS‘
::
	$issued
(
Addr
 
issued_PC
, 
In¡SeqNum
 
issued_£q_num
, 
boŞ
 
is_¡Üe
)

276 ià(!
is_¡Üe
) {

280 
šdex
 = 
	`ÿlcIndex
(
issued_PC
);

282 
¡Üe_SSID
;

284 
	`as£¹
(
šdex
 < 
SSITSize
);

286 
SeqNumM­It
 
¡Üe_li¡_™
 = 
¡ÜeLi¡
.
	`fšd
(
issued_£q_num
);

288 ià(
¡Üe_li¡_™
 !ğ
¡ÜeLi¡
.
	`’d
()) {

289 
¡ÜeLi¡
.
	`”a£
(
¡Üe_li¡_™
);

293 ià(!
v®idSSIT
[
šdex
]) {

297 
¡Üe_SSID
 = 
SSIT
[
šdex
];

299 
	`as£¹
(
¡Üe_SSID
 < 
LFSTSize
);

303 ià(
v®idLFST
[
¡Üe_SSID
] && 
LFST
[¡Üe_SSID] =ğ
issued_£q_num
) {

304 
	`DPRINTF
(
StÜeS‘
, "StoreSet: store invalidated itself in LFST.\n");

305 
v®idLFST
[
¡Üe_SSID
] = 
çl£
;

307 
	}
}

310 
	gStÜeS‘
::
	$squash
(
In¡SeqNum
 
squashed_num
, 
Th»adID
 
tid
)

312 
	`DPRINTF
(
StÜeS‘
, "StoreSet: Squashing until inum %i\n",

313 
squashed_num
);

315 
idx
;

316 
SeqNumM­It
 
¡Üe_li¡_™
 = 
¡ÜeLi¡
.
	`begš
();

319 !
¡ÜeLi¡
.
	`em±y
()) {

320 
idx
 = (*
¡Üe_li¡_™
).
£cÚd
;

322 ià((*
¡Üe_li¡_™
).
fœ¡
 <ğ
squashed_num
) {

326 
boŞ
 
young”
 = 
LFST
[
idx
] > 
squashed_num
;

328 ià(
v®idLFST
[
idx
] && 
young”
) {

329 
	`DPRINTF
(
StÜeS‘
, "Squashed [¢:%Îi]\n", 
LFST
[
idx
]);

330 
v®idLFST
[
idx
] = 
çl£
;

332 
¡ÜeLi¡
.
	`”a£
(
¡Üe_li¡_™
++);

333 } ià(!
v®idLFST
[
idx
] && 
young”
) {

334 
¡ÜeLi¡
.
	`”a£
(
¡Üe_li¡_™
++);

337 
	}
}

340 
	gStÜeS‘
::
	$ş—r
()

342 
i
 = 0; i < 
SSITSize
; ++i) {

343 
v®idSSIT
[
i
] = 
çl£
;

346 
i
 = 0; i < 
LFSTSize
; ++i) {

347 
v®idLFST
[
i
] = 
çl£
;

350 
¡ÜeLi¡
.
	`ş—r
();

351 
	}
}

354 
	gStÜeS‘
::
	$dump
()

356 
	`ırštf
("¡ÜeLi¡.size(): %i\n", 
¡ÜeLi¡
.
	`size
());

357 
SeqNumM­It
 
¡Üe_li¡_™
 = 
¡ÜeLi¡
.
	`begš
();

359 
num
 = 0;

361 
¡Üe_li¡_™
 !ğ
¡ÜeLi¡
.
	`’d
()) {

362 
	`ırštf
("%i: [sn:%lli] SSID:%i\n",

363 
num
, (*
¡Üe_li¡_™
).
fœ¡
, (*¡Üe_li¡_™).
£cÚd
);

364 
num
++;

365 
¡Üe_li¡_™
++;

367 
	}
}

	@o3/store_set.hh

31 #iâdeà
__CPU_O3_STORE_SET_HH__


32 
	#__CPU_O3_STORE_SET_HH__


	)

34 
	~<li¡
>

35 
	~<m­
>

36 
	~<ut™y
>

37 
	~<veùÜ
>

39 
	~"ba£/ty³s.hh
"

40 
	~"ıu/š¡_£q.hh
"

42 
	sÉ£qnum
 {

43 
boŞ
 
İ”©Ü
()(cÚ¡ 
	mIn¡SeqNum
 &
	mlhs
, cÚ¡ In¡SeqNum &
	mrhs
) const

45  
	mlhs
 > 
	mrhs
;

56 şas 
	cStÜeS‘


58 
	mpublic
:

59 
	tSSID
;

61 
	mpublic
:

63 
	$StÜeS‘
() { };

66 
	`StÜeS‘
(
ušt64_t
 
ş—r_³riod
, 
SSIT_size
, 
LFST_size
);

69 ~
	`StÜeS‘
();

72 
	`š™
(
ušt64_t
 
ş—r_³riod
, 
SSIT_size
, 
LFST_size
);

76 
	`viŞ©iÚ
(
Addr
 
¡Üe_PC
, Add¸
lßd_PC
);

82 
	`checkCË¬
();

87 
	`š£¹Lßd
(
Addr
 
lßd_PC
, 
In¡SeqNum
 
lßd_£q_num
);

91 
	`š£¹StÜe
(
Addr
 
¡Üe_PC
, 
In¡SeqNum
 
¡Üe_£q_num
, 
Th»adID
 
tid
);

97 
In¡SeqNum
 
	`checkIn¡
(
Addr
 
PC
);

100 
	`issued
(
Addr
 
issued_PC
, 
In¡SeqNum
 
issued_£q_num
, 
boŞ
 
is_¡Üe
);

103 
	`squash
(
In¡SeqNum
 
squashed_num
, 
Th»adID
 
tid
);

106 
	`ş—r
();

109 
	`dump
();

111 
´iv©e
:

113 
šlše
 
	$ÿlcIndex
(
Addr
 
PC
)

114 {  (
PC
 >> 
off£tB™s
è& 
šdexMask
; 
	}
}

117 
šlše
 
SSID
 
	$ÿlcSSID
(
Addr
 
PC
)

118 {  ((
PC
 ^ (PC >> 10)è% 
LFSTSize
); 
	}
}

121 
	g¡d
::
veùÜ
<
SSID
> 
SSIT
;

124 
	g¡d
::
veùÜ
<
boŞ
> 
v®idSSIT
;

127 
	g¡d
::
veùÜ
<
In¡SeqNum
> 
LFST
;

130 
	g¡d
::
veùÜ
<
boŞ
> 
v®idLFST
;

135 
	g¡d
::
m­
<
In¡SeqNum
, , 
	gÉ£qnum
> 
	g¡ÜeLi¡
;

137 
	g¡d
::
	tm­
<
	tIn¡SeqNum
, , 
	tÉ£qnum
>::
	t™”©Ü
 
	tSeqNumM­It
;

142 
ušt64_t
 
	gş—rP”iod
;

145 
	gSSITSize
;

148 
	gLFSTSize
;

151 
	gšdexMask
;

154 
	goff£tB™s
;

157 
	gmemOpsP»d
;

	@o3/thread_context.cc

31 
	~"ıu/o3/im¶.hh
"

32 
	~"ıu/o3/th»ad_cÚ‹xt.hh
"

33 
	~"ıu/o3/th»ad_cÚ‹xt_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gO3Th»adCÚ‹xt
<
	gO3CPUIm¶
>;

	@o3/thread_context.hh

44 #iâdeà
__CPU_O3_THREAD_CONTEXT_HH__


45 
	#__CPU_O3_THREAD_CONTEXT_HH__


	)

47 
	~"cÚfig/the_i§.hh
"

48 
	~"ıu/o3/i§_¥ecific.hh
"

49 
	~"ıu/th»ad_cÚ‹xt.hh
"

51 
şass
 
	gEndQu›sûEv’t
;

52 
Çme¥aû
 
	gK”Ãl
 {

53 
şass
 
	gSti¡ics
;

69 
	g‹m¶©e
 <
şass
 
	gIm¶
>

70 şas 
	cO3Th»adCÚ‹xt
 : 
public
 
Th»adCÚ‹xt


72 
public
:

73 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

76 
O3CPU
 *
	mıu
;

79 
	mO3Th»adS‹
<
	mIm¶
> *
	mth»ad
;

82 
	mTheISA
::
TLB
 *
	$g‘ITBPŒ
(è{  
ıu
->
™b
; }

85 
TheISA
::
TLB
 *
	$g‘DTBPŒ
(è{  
ıu
->
dtb
; 
	}
}

87 
Check”CPU
 *
	$g‘Check”CpuPŒ
(è{  
NULL
; 
	}
}

89 
	gTheISA
::
Decod”
 *

90 
	$g‘Decod”PŒ
()

92  
ıu
->
ãtch
.
decod”
[
th»ad
->
	`th»adId
()];

93 
	}
}

96 
vœtu®
 
Ba£CPU
 *
	$g‘CpuPŒ
(è{  
ıu
; 
	}
}

99 
vœtu®
 
	$ıuId
(è{  
ıu
->
	`ıuId
(); 
	}
}

101 
vœtu®
 
	$cÚ‹xtId
(è{  
th»ad
->
	`cÚ‹xtId
(); 
	}
}

103 
vœtu®
 
	$£tCÚ‹xtId
(
id
è{ 
th»ad
->
	`£tCÚ‹xtId
(id); 
	}
}

106 
vœtu®
 
	$th»adId
(è{  
th»ad
->
	`th»adId
(); 
	}
}

107 
vœtu®
 
	$£tTh»adId
(
id
è{  
th»ad
->
	`£tTh»adId
(id); 
	}
}

110 
vœtu®
 
Sy¡em
 *
	$g‘Sy¡emPŒ
(è{  
ıu
->
sy¡em
; 
	}
}

113 
vœtu®
 
	gTheISA
::
K”Ãl
::
Sti¡ics
 *
	$g‘K”ÃlSts
()

114 {  
th»ad
->
k”ÃlSts
; 
	}
}

117 
vœtu®
 
Proûss
 *
	$g‘ProûssPŒ
(è{  
th»ad
->
	`g‘ProûssPŒ
(); 
	}
}

119 
vœtu®
 
	gPÜtProxy
 &
	$g‘PhysProxy
(è{  
th»ad
->
	`g‘PhysProxy
(); 
	}
}

121 
vœtu®
 
	gFST¿n¦©šgPÜtProxy
 &
g‘VœtProxy
();

123 
vœtu®
 
	$š™MemProx›s
(
Th»adCÚ‹xt
 *
tc
)

124 { 
th»ad
->
	`š™MemProx›s
(
tc
); 
	}
}

126 
vœtu®
 
	gSET¿n¦©šgPÜtProxy
 &
	$g‘MemProxy
()

127 {  
th»ad
->
	`g‘MemProxy
(); 
	}
}

130 
vœtu®
 
Stus
 
	$¡©us
(ècÚ¡ {  
th»ad
->
	`¡©us
(); 
	}
}

133 
vœtu®
 
	$£tStus
(
Stus
 
Ãw_¡©us
)

134 { 
th»ad
->
	`£tStus
(
Ãw_¡©us
); 
	}
}

138 
vœtu®
 
aùiv©e
(
Cyşes
 
d–ay
 = Cycles(1));

141 
vœtu®
 
su¥’d
(
Cyşes
 
d–ay
 = Cycles(0));

144 
vœtu®
 
h®t
(
Cyşes
 
d–ay
 = Cycles(0));

149 
vœtu®
 
dumpFuncProfe
();

152 
vœtu®
 
keOv”From
(
Th»adCÚ‹xt
 *
Şd_cÚ‹xt
);

155 
vœtu®
 
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
);

158 
vœtu®
 
Tick
 
»adLa¡Aùiv©e
();

160 
vœtu®
 
Tick
 
»adLa¡Su¥’d
();

163 
vœtu®
 
´ofeCË¬
();

165 
vœtu®
 
´ofeSam¶e
();

168 
vœtu®
 
cİyArchRegs
(
Th»adCÚ‹xt
 *
tc
);

171 
vœtu®
 
ş—rArchRegs
();

174 
vœtu®
 
ušt64_t
 
	$»adIÁReg
(
»g_idx
) {

175  
	`»adIÁRegFÏt
(
	`æ©‹nIÁIndex
(
»g_idx
));

176 
	}
}

178 
vœtu®
 
FlßtReg
 
	$»adFlßtReg
(
»g_idx
) {

179  
	`»adFlßtRegFÏt
(
	`æ©‹nFlßtIndex
(
»g_idx
));

180 
	}
}

182 
vœtu®
 
FlßtRegB™s
 
	$»adFlßtRegB™s
(
»g_idx
) {

183  
	`»adFlßtRegB™sFÏt
(
	`æ©‹nFlßtIndex
(
»g_idx
));

184 
	}
}

186 
vœtu®
 
CCReg
 
	$»adCCReg
(
»g_idx
) {

187  
	`»adCCRegFÏt
(
	`æ©‹nCCIndex
(
»g_idx
));

188 
	}
}

191 
vœtu®
 
	$£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
) {

192 
	`£tIÁRegFÏt
(
	`æ©‹nIÁIndex
(
»g_idx
), 
v®
);

193 
	}
}

195 
vœtu®
 
	$£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
) {

196 
	`£tFlßtRegFÏt
(
	`æ©‹nFlßtIndex
(
»g_idx
), 
v®
);

197 
	}
}

199 
vœtu®
 
	$£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
) {

200 
	`£tFlßtRegB™sFÏt
(
	`æ©‹nFlßtIndex
(
»g_idx
), 
v®
);

201 
	}
}

203 
vœtu®
 
	$£tCCReg
(
»g_idx
, 
CCReg
 
v®
) {

204 
	`£tCCRegFÏt
(
	`æ©‹nCCIndex
(
»g_idx
), 
v®
);

205 
	}
}

208 
vœtu®
 
	gTheISA
::
PCS‹
 
	$pcS‹
()

209 {  
ıu
->
	`pcS‹
(
th»ad
->
	`th»adId
()); 
	}
}

212 
vœtu®
 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
);

214 
vœtu®
 
pcS‹NoRecÜd
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
);

217 
vœtu®
 
Addr
 
	$š¡Addr
()

218 {  
ıu
->
	`š¡Addr
(
th»ad
->
	`th»adId
()); 
	}
}

221 
vœtu®
 
Addr
 
	$ÃxtIn¡Addr
()

222 {  
ıu
->
	`ÃxtIn¡Addr
(
th»ad
->
	`th»adId
()); 
	}
}

225 
vœtu®
 
MiüoPC
 
	$miüoPC
()

226 {  
ıu
->
	`miüoPC
(
th»ad
->
	`th»adId
()); 
	}
}

229 
vœtu®
 
MiscReg
 
	$»adMiscRegNoEfãù
(
misc_»g
)

230 {  
ıu
->
	`»adMiscRegNoEfãù
(
misc_»g
, 
th»ad
->
	`th»adId
()); 
	}
}

234 
vœtu®
 
MiscReg
 
	$»adMiscReg
(
misc_»g
)

235 {  
ıu
->
	`»adMiscReg
(
misc_»g
, 
th»ad
->
	`th»adId
()); 
	}
}

238 
vœtu®
 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

242 
vœtu®
 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

244 
vœtu®
 
æ©‹nIÁIndex
(
»g
);

245 
vœtu®
 
æ©‹nFlßtIndex
(
»g
);

246 
vœtu®
 
æ©‹nCCIndex
(
»g
);

250 
vœtu®
 
	$»adStCÚdFau»s
()

251 {  
th»ad
->
¡ÜeCÚdFau»s
; 
	}
}

254 
vœtu®
 
	$£tStCÚdFau»s
(
sc_çu»s
)

255 { 
th»ad
->
¡ÜeCÚdFau»s
 = 
sc_çu»s
; 
	}
}

263 
vœtu®
 
boŞ
 
	$mis¥ecuÏtšg
(è{  
çl£
; 
	}
}

266 
vœtu®
 
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

267 {  
ıu
->
	`sysÿÎ
(
ÿÎnum
, 
th»ad
->
	`th»adId
()); 
	}
}

270 
vœtu®
 
CouÁ”
 
	$»adFuncExeIn¡
(è{  
th»ad
->
funcExeIn¡
; 
	}
}

273 
vœtu®
 
EndQu›sûEv’t
 *
	$g‘Qu›sûEv’t
()

275  
this
->
th»ad
->
qu›sûEv’t
;

276 
	}
}

282 
šlše
 
	$cÚd™iÚ®Squash
()

284 ià(!
th»ad
->
Œ­P’dšg
 && !th»ad->
noSquashFromTC
)

285 
ıu
->
	`squashFromTC
(
th»ad
->
	`th»adId
());

286 
	}
}

288 
vœtu®
 
ušt64_t
 
»adIÁRegFÏt
(
idx
);

289 
vœtu®
 
£tIÁRegFÏt
(
idx
, 
ušt64_t
 
v®
);

291 
vœtu®
 
FlßtReg
 
»adFlßtRegFÏt
(
idx
);

292 
vœtu®
 
£tFlßtRegFÏt
(
idx
, 
FlßtReg
 
v®
);

294 
vœtu®
 
FlßtRegB™s
 
»adFlßtRegB™sFÏt
(
idx
);

295 
vœtu®
 
£tFlßtRegB™sFÏt
(
idx
, 
FlßtRegB™s
 
v®
);

297 
vœtu®
 
CCReg
 
»adCCRegFÏt
(
idx
);

298 
vœtu®
 
£tCCRegFÏt
(
idx
, 
CCReg
 
v®
);

	@o3/thread_context_impl.hh

45 #iâdeà
__CPU_O3_THREAD_CONTEXT_IMPL_HH__


46 
	#__CPU_O3_THREAD_CONTEXT_IMPL_HH__


	)

48 
	~"¬ch/k”Ãl_¡©s.hh
"

49 
	~"¬ch/»gi¡”s.hh
"

50 
	~"cÚfig/the_i§.hh
"

51 
	~"ıu/o3/th»ad_cÚ‹xt.hh
"

52 
	~"ıu/qu›sû_ev’t.hh
"

53 
	~"debug/O3CPU.hh
"

55 
	g‹m¶©e
 <
şass
 
	gIm¶
>

56 
	gFST¿n¦©šgPÜtProxy
&

57 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$g‘VœtProxy
()

59  
th»ad
->
	`g‘VœtProxy
();

60 
	}
}

62 
	g‹m¶©e
 <
şass
 
	gIm¶
>

64 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$dumpFuncProfe
()

66 
th»ad
->
	`dumpFuncProfe
();

67 
	}
}

69 
	g‹m¶©e
 <
şass
 
	gIm¶
>

71 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$keOv”From
(
Th»adCÚ‹xt
 *
Şd_cÚ‹xt
)

73 ::
	`keOv”From
(*
this
, *
Şd_cÚ‹xt
);

74 
TheISA
::
Decod”
 *
ÃwDecod”
 = 
	`g‘Decod”PŒ
();

75 
TheISA
::
Decod”
 *
ŞdDecod”
 = 
Şd_cÚ‹xt
->
	`g‘Decod”PŒ
();

76 
ÃwDecod”
->
	`keOv”From
(
ŞdDecod”
);

78 
th»ad
->
k”ÃlSts
 = 
Şd_cÚ‹xt
->
	`g‘K”ÃlSts
();

79 
th»ad
->
funcExeIn¡
 = 
Şd_cÚ‹xt
->
	`»adFuncExeIn¡
();

81 
th»ad
->
noSquashFromTC
 = 
çl£
;

82 
th»ad
->
Œ­P’dšg
 = 
çl£
;

83 
	}
}

85 
	g‹m¶©e
 <
şass
 
	gIm¶
>

87 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$aùiv©e
(
Cyşes
 
d–ay
)

89 
	`DPRINTF
(
O3CPU
, "Calling‡ctivate on Thread Context %d\n",

90 
	`th»adId
());

92 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
)

95 
th»ad
->
Ï¡Aùiv©e
 = 
	`curTick
();

96 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
Aùive
);

99 
ıu
->
	`aùiv©eCÚ‹xt
(
th»ad
->
	`th»adId
(), 
d–ay
);

100 
	}
}

102 
	g‹m¶©e
 <
şass
 
	gIm¶
>

104 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$su¥’d
(
Cyşes
 
d–ay
)

106 
	`DPRINTF
(
O3CPU
, "Calling suspend on Thread Context %d\n",

107 
	`th»adId
());

109 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Su¥’ded
)

112 
th»ad
->
Ï¡Aùiv©e
 = 
	`curTick
();

113 
th»ad
->
Ï¡Su¥’d
 = 
	`curTick
();

115 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
Su¥’ded
);

116 
ıu
->
	`su¥’dCÚ‹xt
(
th»ad
->
	`th»adId
());

117 
	}
}

119 
	g‹m¶©e
 <
şass
 
	gIm¶
>

121 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$h®t
(
Cyşes
 
d–ay
)

123 
	`DPRINTF
(
O3CPU
, "Calling halt on Thread Context %d\n",

124 
	`th»adId
());

126 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
H®‹d
)

129 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
H®‹d
);

130 
ıu
->
	`h®tCÚ‹xt
(
th»ad
->
	`th»adId
());

131 
	}
}

133 
	g‹m¶©e
 <
şass
 
	gIm¶
>

135 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
)

137 ià(
FuÎSy¡em
) {

138 
th»ad
->
k”ÃlSts
 = 
Ãw
 
TheISA
::
K”Ãl
::
Sti¡ics
(
ıu
->
sy¡em
);

139 
	gth»ad
->
	gk”ÃlSts
->
»gSts
(
Çme
 + ".kern");

143 
	g‹m¶©e
 <
şass
 
	gIm¶
>

144 
Tick


145 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$»adLa¡Aùiv©e
()

147  
th»ad
->
Ï¡Aùiv©e
;

148 
	}
}

150 
	g‹m¶©e
 <
şass
 
	gIm¶
>

151 
Tick


152 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$»adLa¡Su¥’d
()

154  
th»ad
->
Ï¡Su¥’d
;

155 
	}
}

157 
	g‹m¶©e
 <
şass
 
	gIm¶
>

159 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$´ofeCË¬
()

161 
th»ad
->
	`´ofeCË¬
();

162 
	}
}

164 
	g‹m¶©e
 <
şass
 
	gIm¶
>

166 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$´ofeSam¶e
()

168 
th»ad
->
	`´ofeSam¶e
();

169 
	}
}

171 
	g‹m¶©e
 <
şass
 
	gIm¶
>

173 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$cİyArchRegs
(
Th»adCÚ‹xt
 *
tc
)

176 
th»ad
->
noSquashFromTC
 = 
Œue
;

177 
TheISA
::
	`cİyRegs
(
tc
, 
this
);

178 
th»ad
->
noSquashFromTC
 = 
çl£
;

180 ià(!
FuÎSy¡em
)

181 
this
->
th»ad
->
funcExeIn¡
 = 
tc
->
	`»adFuncExeIn¡
();

182 
	}
}

184 
	g‹m¶©e
 <
şass
 
	gIm¶
>

186 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$ş—rArchRegs
()

188 
ıu
->
i§
[
th»ad
->
	`th»adId
()]->
	`ş—r
();

189 
	}
}

191 
	g‹m¶©e
 <
şass
 
	gIm¶
>

192 
ušt64_t


193 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$»adIÁRegFÏt
(
»g_idx
)

195  
ıu
->
	`»adArchIÁReg
(
»g_idx
, 
th»ad
->
	`th»adId
());

196 
	}
}

198 
	g‹m¶©e
 <
şass
 
	gIm¶
>

199 
	gTheISA
::
FlßtReg


200 
O3Th»adCÚ‹xt
<
Im¶
>::
	$»adFlßtRegFÏt
(
»g_idx
)

202  
ıu
->
	`»adArchFlßtReg
(
»g_idx
, 
th»ad
->
	`th»adId
());

203 
	}
}

205 
	g‹m¶©e
 <
şass
 
	gIm¶
>

206 
	gTheISA
::
FlßtRegB™s


207 
O3Th»adCÚ‹xt
<
Im¶
>::
	$»adFlßtRegB™sFÏt
(
»g_idx
)

209  
ıu
->
	`»adArchFlßtRegIÁ
(
»g_idx
, 
th»ad
->
	`th»adId
());

210 
	}
}

212 
	g‹m¶©e
 <
şass
 
	gIm¶
>

213 
	gTheISA
::
CCReg


214 
O3Th»adCÚ‹xt
<
Im¶
>::
	$»adCCRegFÏt
(
»g_idx
)

216  
ıu
->
	`»adArchCCReg
(
»g_idx
, 
th»ad
->
	`th»adId
());

217 
	}
}

219 
	g‹m¶©e
 <
şass
 
	gIm¶
>

221 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$£tIÁRegFÏt
(
»g_idx
, 
ušt64_t
 
v®
)

223 
ıu
->
	`£tArchIÁReg
(
»g_idx
, 
v®
, 
th»ad
->
	`th»adId
());

225 
	`cÚd™iÚ®Squash
();

226 
	}
}

228 
	g‹m¶©e
 <
şass
 
	gIm¶
>

230 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$£tFlßtRegFÏt
(
»g_idx
, 
FlßtReg
 
v®
)

232 
ıu
->
	`£tArchFlßtReg
(
»g_idx
, 
v®
, 
th»ad
->
	`th»adId
());

234 
	`cÚd™iÚ®Squash
();

235 
	}
}

237 
	g‹m¶©e
 <
şass
 
	gIm¶
>

239 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$£tFlßtRegB™sFÏt
(
»g_idx
, 
FlßtRegB™s
 
v®
)

241 
ıu
->
	`£tArchFlßtRegIÁ
(
»g_idx
, 
v®
, 
th»ad
->
	`th»adId
());

243 
	`cÚd™iÚ®Squash
();

244 
	}
}

246 
	g‹m¶©e
 <
şass
 
	gIm¶
>

248 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
£tCCRegFÏt
(
»g_idx
, 
TheISA
::
CCReg
 
v®
)

250 
ıu
->
£tArchCCReg
(
»g_idx
, 
v®
, 
th»ad
->
th»adId
());

252 
cÚd™iÚ®Squash
();

255 
	g‹m¶©e
 <
şass
 
	gIm¶
>

257 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

259 
ıu
->
pcS‹
(
v®
, 
th»ad
->
th»adId
());

261 
cÚd™iÚ®Squash
();

264 
	g‹m¶©e
 <
şass
 
	gIm¶
>

266 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
pcS‹NoRecÜd
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

268 
ıu
->
pcS‹
(
v®
, 
th»ad
->
th»adId
());

270 
cÚd™iÚ®Squash
();

273 
	g‹m¶©e
 <
şass
 
	gIm¶
>

275 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$æ©‹nIÁIndex
(
»g
)

277  
ıu
->
i§
[
th»ad
->
	`th»adId
()]->
	`æ©‹nIÁIndex
(
»g
);

278 
	}
}

280 
	g‹m¶©e
 <
şass
 
	gIm¶
>

282 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$æ©‹nFlßtIndex
(
»g
)

284  
ıu
->
i§
[
th»ad
->
	`th»adId
()]->
	`æ©‹nFlßtIndex
(
»g
);

285 
	}
}

287 
	g‹m¶©e
 <
şass
 
	gIm¶
>

289 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$æ©‹nCCIndex
(
»g
)

291  
ıu
->
i§
[
th»ad
->
	`th»adId
()]->
	`æ©‹nCCIndex
(
»g
);

292 
	}
}

294 
	g‹m¶©e
 <
şass
 
	gIm¶
>

296 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

298 
ıu
->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
, 
th»ad
->
	`th»adId
());

300 
	`cÚd™iÚ®Squash
();

301 
	}
}

304 
	g‹m¶©e
 <
şass
 
	gIm¶
>

306 
	gO3Th»adCÚ‹xt
<
	gIm¶
>::
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

308 
ıu
->
	`£tMiscReg
(
misc_»g
, 
v®
, 
th»ad
->
	`th»adId
());

310 
	`cÚd™iÚ®Squash
();

311 
	}
}

	@o3/thread_state.hh

43 #iâdeà
__CPU_O3_THREAD_STATE_HH__


44 
	#__CPU_O3_THREAD_STATE_HH__


	)

46 
	~"ba£/ÿÎback.hh
"

47 
	~"ba£/ouut.hh
"

48 
	~"ıu/th»ad_cÚ‹xt.hh
"

49 
	~"ıu/th»ad_¡©e.hh
"

50 
	~"sim/fuÎ_sy¡em.hh
"

51 
	~"sim/sim_ex™.hh
"

53 
şass
 
	gEndQu›sûEv’t
;

54 
şass
 
	gEv’t
;

55 
şass
 
	gFunùiÚ®MemÜy
;

56 
şass
 
	gFunùiÚProfe
;

57 
şass
 
	gProûss
;

58 
şass
 
	gProfeNode
;

67 
	g‹m¶©e
 <
şass
 
	gIm¶
>

68 
	gO3Th»adS‹
 : 
public
 
Th»adS‹
 {

69 
Th»adCÚ‹xt
::
	tStus
 Status;

70 
ty³Çme
 
	tIm¶
::
	tO3CPU
 O3CPU;

72 
	g´iv©e
:

74 
O3CPU
 *
ıu
;

75 
	gpublic
:

84 
boŞ
 
noSquashFromTC
;

89 
boŞ
 
	gŒ­P’dšg
;

91 
O3Th»adS‹
(
O3CPU
 *
_ıu
, 
_th»ad_num
, 
Proûss
 *
_´oûss
)

92 : 
Th»adS‹
(
_ıu
, 
_th»ad_num
, 
_´oûss
),

93 
ıu
(
_ıu
), 
noSquashFromTC
(
çl£
), 
Œ­P’dšg
(false)

95 ià(!
	gFuÎSy¡em
)

98 ià(
	gıu
->
·¿ms
()->
	g´ofe
) {

99 
	g´ofe
 = 
Ãw
 
FunùiÚProfe
(

100 
ıu
->
·¿ms
()->
sy¡em
->
k”ÃlSymb
);

101 
C®lback
 *
	gcb
 =

102 
Ãw
 
MakeC®lback
<
O3Th»adS‹
,

103 &
	gO3Th»adS‹
::
dumpFuncProfe
>(
this
);

104 
»gi¡”Ex™C®lback
(
cb
);

109 
ProfeNode
 
	gdummyNode
;

110 
	g´ofeNode
 = &
dummyNode
;

111 
	g´ofePC
 = 3;

114 
£rŸlize
(
¡d
::
o¡»am
 &
os
)

116 
Th»adS‹
::
£rŸlize
(
os
);

119 ::
£rŸlize
(*
tc
, 
os
);

122 
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
)

127 
noSquashFromTC
 = 
Œue
;

128 
	gTh»adS‹
::
un£rŸlize
(
ı
, 
£ùiÚ
);

131 ::
un£rŸlize
(*
tc
, 
ı
, 
£ùiÚ
);

132 
	gnoSquashFromTC
 = 
çl£
;

136 
Th»adCÚ‹xt
 *
	gtc
;

139 
Th»adCÚ‹xt
 *
g‘TC
(è{  
	gtc
; }

142 
sysÿÎ
(
št64_t
 
ÿÎnum
è{ 
	g´oûss
->sysÿÎ(ÿÎnum, 
tc
); }

144 
dumpFuncProfe
()

146 
	g¡d
::
o¡»am
 *
os
 = 
simout
.
ü—‹
(
c¥rštf
("´ofe.%s.d©", 
ıu
->
Çme
()));

147 
	g´ofe
->
dump
(
tc
, *
os
);

	@op_class.hh

43 #iâdeà
__CPU__OP_CLASS_HH__


44 
	#__CPU__OP_CLASS_HH__


	)

46 
	~"’ums/OpCÏss.hh
"

52 
usšg
 
	gEnums
::
OpCÏss
;

53 
usšg
 
	gEnums
::
No_OpCÏss
;

54 
usšg
 
	gEnums
::
Num_OpCÏss
;

56 cÚ¡ 
OpCÏss
 
	gIÁAluOp
 = 
Enums
::
IÁAlu
;

57 cÚ¡ 
OpCÏss
 
	gIÁMuÉOp
 = 
Enums
::
IÁMuÉ
;

58 cÚ¡ 
OpCÏss
 
	gIÁDivOp
 = 
Enums
::
IÁDiv
;

59 cÚ¡ 
OpCÏss
 
	gFlßtAddOp
 = 
Enums
::
FlßtAdd
;

60 cÚ¡ 
OpCÏss
 
	gFlßtCmpOp
 = 
Enums
::
FlßtCmp
;

61 cÚ¡ 
OpCÏss
 
	gFlßtCvtOp
 = 
Enums
::
FlßtCvt
;

62 cÚ¡ 
OpCÏss
 
	gFlßtMuÉOp
 = 
Enums
::
FlßtMuÉ
;

63 cÚ¡ 
OpCÏss
 
	gFlßtDivOp
 = 
Enums
::
FlßtDiv
;

64 cÚ¡ 
OpCÏss
 
	gFlßtSq¹Op
 = 
Enums
::
FlßtSq¹
;

65 cÚ¡ 
OpCÏss
 
	gSimdAddOp
 = 
Enums
::
SimdAdd
;

66 cÚ¡ 
OpCÏss
 
	gSimdAddAccOp
 = 
Enums
::
SimdAddAcc
;

67 cÚ¡ 
OpCÏss
 
	gSimdAluOp
 = 
Enums
::
SimdAlu
;

68 cÚ¡ 
OpCÏss
 
	gSimdCmpOp
 = 
Enums
::
SimdCmp
;

69 cÚ¡ 
OpCÏss
 
	gSimdCvtOp
 = 
Enums
::
SimdCvt
;

70 cÚ¡ 
OpCÏss
 
	gSimdMiscOp
 = 
Enums
::
SimdMisc
;

71 cÚ¡ 
OpCÏss
 
	gSimdMuÉOp
 = 
Enums
::
SimdMuÉ
;

72 cÚ¡ 
OpCÏss
 
	gSimdMuÉAccOp
 = 
Enums
::
SimdMuÉAcc
;

73 cÚ¡ 
OpCÏss
 
	gSimdShiáOp
 = 
Enums
::
SimdShiá
;

74 cÚ¡ 
OpCÏss
 
	gSimdShiáAccOp
 = 
Enums
::
SimdShiáAcc
;

75 cÚ¡ 
OpCÏss
 
	gSimdSq¹Op
 = 
Enums
::
SimdSq¹
;

76 cÚ¡ 
OpCÏss
 
	gSimdFlßtAddOp
 = 
Enums
::
SimdFlßtAdd
;

77 cÚ¡ 
OpCÏss
 
	gSimdFlßtAluOp
 = 
Enums
::
SimdFlßtAlu
;

78 cÚ¡ 
OpCÏss
 
	gSimdFlßtCmpOp
 = 
Enums
::
SimdFlßtCmp
;

79 cÚ¡ 
OpCÏss
 
	gSimdFlßtCvtOp
 = 
Enums
::
SimdFlßtCvt
;

80 cÚ¡ 
OpCÏss
 
	gSimdFlßtDivOp
 = 
Enums
::
SimdFlßtDiv
;

81 cÚ¡ 
OpCÏss
 
	gSimdFlßtMiscOp
 = 
Enums
::
SimdFlßtMisc
;

82 cÚ¡ 
OpCÏss
 
	gSimdFlßtMuÉOp
 = 
Enums
::
SimdFlßtMuÉ
;

83 cÚ¡ 
OpCÏss
 
	gSimdFlßtMuÉAccOp
 = 
Enums
::
SimdFlßtMuÉAcc
;

84 cÚ¡ 
OpCÏss
 
	gSimdFlßtSq¹Op
 = 
Enums
::
SimdFlßtSq¹
;

85 cÚ¡ 
OpCÏss
 
	gMemR—dOp
 = 
Enums
::
MemR—d
;

86 cÚ¡ 
OpCÏss
 
	gMemWr™eOp
 = 
Enums
::
MemWr™e
;

87 cÚ¡ 
OpCÏss
 
	gI´AcûssOp
 = 
Enums
::
I´Acûss
;

88 cÚ¡ 
OpCÏss
 
	gIn¡P»ãtchOp
 = 
Enums
::
In¡P»ãtch
;

89 cÚ¡ 
OpCÏss
 
	gNum_OpCÏs£s
 = 
Num_OpCÏss
;

	@ozone/back_end.cc

31 
	~"ıu/ozÚe/back_’d_im¶.hh
"

32 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

	@ozone/back_end.hh

31 #iâdeà
__CPU_OZONE_BACK_END_HH__


32 
	#__CPU_OZONE_BACK_END_HH__


	)

34 
	~<li¡
>

35 
	~<queue
>

36 
	~<¡ršg
>

38 
	~"ıu/ozÚe/»Çme_bË.hh
"

39 
	~"ıu/ozÚe/th»ad_¡©e.hh
"

40 
	~"ıu/š¡_£q.hh
"

41 
	~"ıu/timebuf.hh
"

42 
	~"mem/»que¡.hh
"

43 
	~"sim/ev’tq.hh
"

44 
	~"sim/çuÉs.hh
"

46 
şass
 
	gTh»adCÚ‹xt
;

48 
	g‹m¶©e
 <
şass
 
	gIm¶
>

49 
şass
 
	gOzÚeTh»adS‹
;

51 
	g‹m¶©e
 <
şass
 
	gIm¶
>

52 şas 
	cBackEnd


54 
	mpublic
:

55 
OzÚeTh»adS‹
<
	tIm¶
> 
	tTh»ad
;

57 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

58 
ty³Çme
 
	tIm¶
::
	tDynIn¡
 DynInst;

59 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

60 
ty³Çme
 
	tIm¶
::
	tFuÎCPU
 FullCPU;

61 
ty³Çme
 
	tIm¶
::
	tFrÚtEnd
 FrontEnd;

62 
ty³Çme
 
	tIm¶
::
	tFuÎCPU
::
	tCommSŒuù
 CommStruct;

64 
	sSizeSŒuù
 {

65 
	msize
;

68 
SizeSŒuù
 
	tDi¥©chToIssue
;

69 
SizeSŒuù
 
	tIssueToExec
;

70 
SizeSŒuù
 
	tExecToComm™
;

71 
SizeSŒuù
 
	tWr™eback
;

73 
	gTimeBufãr
<
	gDi¥©chToIssue
> 
	gd2i
;

74 
ty³Çme
 
	gTimeBufãr
<
	gDi¥©chToIssue
>::
wœe
 
š¡sToDi¥©ch
;

75 
	gTimeBufãr
<
	gIssueToExec
> 
	gi2e
;

76 
ty³Çme
 
	gTimeBufãr
<
	gIssueToExec
>::
wœe
 
š¡sToExecu‹
;

77 
	gTimeBufãr
<
	gExecToComm™
> 
	ge2c
;

78 
	gTimeBufãr
<
	gWr™eback
> 
	gnumIn¡sToWB
;

80 
	gTimeBufãr
<
	gCommSŒuù
> *
	gcomm
;

81 
ty³Çme
 
	gTimeBufãr
<
	gCommSŒuù
>::
wœe
 
toIEW
;

82 
ty³Çme
 
	gTimeBufãr
<
	gCommSŒuù
>::
wœe
 
äomComm™
;

84 şas 
	cIn¡Queue
 {

85 
	equeue
 {

86 
	gNÚS³c
,

87 
	gIQ
,

88 
	gToBeScheduËd
,

89 
	gR—dyLi¡
,

90 
	gR•ÏyLi¡


92 
	spqCom·»
 {

93 
boŞ
 
İ”©Ü
(è(cÚ¡ 
	gDynIn¡PŒ
 &
	glhs
, cÚ¡ DynIn¡PŒ &
	grhs
) const

95  
	glhs
->
	g£qNum
 > 
	grhs
->seqNum;

98 
	gpublic
:

99 
In¡Queue
(
P¬ams
 *
·¿ms
);

101 
	g¡d
::
¡ršg
 
Çme
() const;

103 
»gSts
();

105 
£tIssueExecQueue
(
TimeBufãr
<
IssueToExec
> *
i2e_queue
);

107 
£tBE
(
BackEnd
 *
_be
è{ 
	gbe
 = _be; }

109 
š£¹
(
DynIn¡PŒ
 &
š¡
);

111 
scheduËR—dyIn¡s
();

113 
scheduËNÚS³c
(cÚ¡ 
In¡SeqNum
 &
¢
);

115 
DynIn¡PŒ
 
g‘R—dyIn¡
();

117 
comm™
(cÚ¡ 
In¡SeqNum
 &
¢
) {}

119 
squash
(cÚ¡ 
In¡SeqNum
 &
¢
);

121 
wakeD•’d’ts
(
DynIn¡PŒ
 &
š¡
);

126 
»scheduËMemIn¡
(
DynIn¡PŒ
 &
š¡
);

129 
»¶ayMemIn¡
(
DynIn¡PŒ
 &
š¡
);

132 
com¶‘eMemIn¡
(
DynIn¡PŒ
 &
š¡
);

134 
viŞ©iÚ
(
DynIn¡PŒ
 &
š¡
, DynInstPtr &violation) { }

136 
boŞ
 
isFuÎ
(è{  
	gnumIn¡s
 >ğ
size
; }

138 
dumpIn¡s
();

140 
	g´iv©e
:

141 
boŞ
 
fšd
(
queue
 
q
, 
ty³Çme
 
¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
™
);

142 
BackEnd
 *
	gbe
;

143 
	gTimeBufãr
<
	gIssueToExec
> *
	gi2e
;

144 
ty³Çme
 
	gTimeBufãr
<
	gIssueToExec
>::
wœe
 
numIssued
;

145 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
> 
	tIn¡Li¡
;

146 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tIn¡Li¡It
;

147 
ty³Çme
 
	t¡d
::
	t´iÜ™y_queue
<
	tDynIn¡PŒ
, std::
	tveùÜ
<DynIn¡PŒ>, 
	tpqCom·»
> 
	tR—dyIn¡Queue
;

149 
In¡Li¡
 
	giq
;

150 
In¡Li¡
 
	gtoBeScheduËd
;

151 
In¡Li¡
 
	g»adyLi¡
;

152 
In¡Li¡
 
	gnÚS³c
;

153 
In¡Li¡
 
	g»¶ayLi¡
;

154 
R—dyIn¡Queue
 
	g»adyQueue
;

155 
	gpublic
:

156 
size
;

157 
	gnumIn¡s
;

158 
	gwidth
;

160 
	gSts
::
VeùÜDi¡ributiÚ
 
occ_di¡
;

162 
	gSts
::
VeùÜ
 
š¡_couÁ
;

163 
	gSts
::
VeùÜ
 
³ak_š¡_couÁ
;

164 
	gSts
::
SÿÏr
 
em±y_couÁ
;

165 
	gSts
::
SÿÏr
 
cu¼’t_couÁ
;

166 
	gSts
::
SÿÏr
 
fuÎCouÁ
;

168 
	gSts
::
FÜmuÏ
 
occ_¿‹
;

169 
	gSts
::
FÜmuÏ
 
avg_»sid’cy
;

170 
	gSts
::
FÜmuÏ
 
em±y_¿‹
;

171 
	gSts
::
FÜmuÏ
 
fuÎ_¿‹
;

175 şas 
	cLdWr™ebackEv’t
 : 
public
 
Ev’t
 {

176 
´iv©e
:

178 
DynIn¡PŒ
 
š¡
;

180 
BackEnd
 *
	gbe
;

182 
	gpublic
:

184 
LdWr™ebackEv’t
(
DynIn¡PŒ
 &
_š¡
, 
BackEnd
 *
be
);

187 
vœtu®
 
´oûss
();

189 
vœtu®
 cÚ¡ *
desütiÚ
() const;

192 
BackEnd
(
P¬ams
 *
·¿ms
);

194 
	g¡d
::
¡ršg
 
	$Çme
() const;

196 
	`»gSts
();

198 
	$£tCPU
(
FuÎCPU
 *
ıu_±r
)

199 { 
ıu
 = 
ıu_±r
; 
	}
}

201 
	$£tFrÚtEnd
(
FrÚtEnd
 *
äÚt_’d_±r
)

202 { 
äÚtEnd
 = 
äÚt_’d_±r
; 
	}
}

204 
	$£tTC
(
Th»adCÚ‹xt
 *
tc_±r
)

205 { 
tc
 = 
tc_±r
; 
	}
}

207 
	$£tTh»adS‹
(
Th»ad
 *
th»ad_±r
)

208 { 
th»ad
 = 
th»ad_±r
; 
	}
}

210 
£tCommBufãr
(
TimeBufãr
<
CommSŒuù
> *
_comm
);

212 
tick
();

213 
squash
();

214 
squashFromTC
();

215 
boŞ
 
	gtcSquash
;

217 
	g‹m¶©e
 <
şass
 
	gT
>

218 
FauÉ
 
»ad
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
lßd_idx
);

220 
	g‹m¶©e
 <
şass
 
	gT
>

221 
FauÉ
 
wr™e
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
¡Üe_idx
);

223 
Addr
 
	$»adComm™PC
(è{  
comm™PC
; 
	}
}

225 
Addr
 
	gcomm™PC
;

227 
boŞ
 
	$robEm±y
(è{  
š¡Li¡
.
	`em±y
(); 
	}
}

229 
boŞ
 
	$isFuÎ
(è{  
numIn¡s
 >ğ
numROBEÁr›s
; 
	}
}

230 
boŞ
 
	$isBlocked
(è{  
¡©us
 =ğ
Blocked
 || 
di¥©chStus
 =ğBlocked; 
	}
}

235 
	$»scheduËMemIn¡
(
DynIn¡PŒ
 &
š¡
)

236 { 
IQ
.
	`»scheduËMemIn¡
(
š¡
); 
	}
}

239 
	$»¶ayMemIn¡
(
DynIn¡PŒ
 &
š¡
)

240 { 
IQ
.
	`»¶ayMemIn¡
(
š¡
); 
	}
}

243 
	$com¶‘eMemIn¡
(
DynIn¡PŒ
 &
š¡
)

244 { 
IQ
.
	`com¶‘eMemIn¡
(
š¡
); 
	}
}

246 
ãtchFauÉ
(
FauÉ
 &
çuÉ
);

248 
	g´iv©e
:

249 
upd©eSŒuùu»s
();

250 
di¥©chIn¡s
();

251 
di¥©chSÎ
();

252 
checkDi¥©chStus
();

253 
scheduËR—dyIn¡s
();

254 
execu‹In¡s
();

255 
comm™In¡s
();

256 
addToIQ
(
DynIn¡PŒ
 &
š¡
);

257 
addToLSQ
(
DynIn¡PŒ
 &
š¡
);

258 
š¡ToComm™
(
DynIn¡PŒ
 &
š¡
);

259 
wr™ebackIn¡s
();

260 
boŞ
 
comm™In¡
(
š¡_num
);

261 
squash
(cÚ¡ 
In¡SeqNum
 &
¢
);

262 
squashDueToB¿nch
(
DynIn¡PŒ
 &
š¡
);

263 
squashDueToMemBlocked
(
DynIn¡PŒ
 &
š¡
);

264 
upd©eExeIn¡Sts
(
DynIn¡PŒ
 &
š¡
);

265 
upd©eComIn¡Sts
(
DynIn¡PŒ
 &
š¡
);

267 
	gpublic
:

268 
FuÎCPU
 *
ıu
;

270 
FrÚtEnd
 *
	gäÚtEnd
;

272 
Th»adCÚ‹xt
 *
	gtc
;

274 
Th»ad
 *
	gth»ad
;

276 
	eStus
 {

277 
	gRuÂšg
,

278 
	gIdË
,

279 
	gDÿcheMissSÎ
,

280 
	gDÿcheMissCom¶‘e
,

281 
	gBlocked


284 
Stus
 
	g¡©us
;

286 
Stus
 
	gdi¥©chStus
;

288 
CouÁ”
 
	gfuncExeIn¡
;

290 
	g´iv©e
:

293 
In¡Queue
 
IQ
;

295 
ty³Çme
 
	tIm¶
::
	tLd¡Queue
 LdstQueue;

297 
Ld¡Queue
 
	gLSQ
;

298 
	gpublic
:

299 
R’ameTabË
<
Im¶
> 
comm™R’ameTabË
;

301 
	gR’ameTabË
<
	gIm¶
> 
	g»ÇmeTabË
;

302 
	g´iv©e
:

303 şas 
	cDCacheCom¶‘iÚEv’t
 : 
public
 
Ev’t


305 
´iv©e
:

306 
BackEnd
 *
be
;

308 
	gpublic
:

309 
DCacheCom¶‘iÚEv’t
(
BackEnd
 *
_be
);

311 
vœtu®
 
´oûss
();

312 
vœtu®
 cÚ¡ *
desütiÚ
() const;

315 
ä›nd
 
şass
 
	gDCacheCom¶‘iÚEv’t
;

317 
DCacheCom¶‘iÚEv’t
 
	gÿcheCom¶‘iÚEv’t
;

319 
MemIÁ”çû
 *
	gdÿcheIÁ”çû
;

321 
Reque¡
 *
	gmemReq
;

324 
	gwidth
;

327 
	gdi¥©chWidth
;

328 
	gnumDi¥©chEÁr›s
;

329 
	gdi¥©chSize
;

331 
	gissueWidth
;

334 
	gwbWidth
;

337 
	gcomm™Width
;

340 
	gwbNumIn¡
;

347 
	gwbCyşe
;

349 
	gnumROBEÁr›s
;

350 
	gnumIn¡s
;

352 
boŞ
 
	gsquashP’dšg
;

353 
In¡SeqNum
 
	gsquashSeqNum
;

354 
Addr
 
	gsquashNextPC
;

356 
FauÉ
 
	gçuÉFromF‘ch
;

358 
	g´iv©e
:

359 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tIn¡Li¡It
;

361 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
;

362 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
di¥©ch
;

363 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
wr™eback
;

365 
	gÏ‹ncy
;

367 
	gsquashL©’cy
;

369 
boŞ
 
	gexaùFuÎSÎ
;

371 
boŞ
 
	gãtchRedœeù
[
Im¶
::
MaxTh»ads
];

377 
	gSts
::
VeùÜ
 
rob_ÿp_ev’ts
;

378 
	gSts
::
VeùÜ
 
rob_ÿp_š¡_couÁ
;

379 
	gSts
::
VeùÜ
 
iq_ÿp_ev’ts
;

380 
	gSts
::
VeùÜ
 
iq_ÿp_š¡_couÁ
;

382 
	gSts
::
VeùÜ
 
exe_š¡
;

383 
	gSts
::
VeùÜ
 
exe_swp
;

384 
	gSts
::
VeùÜ
 
exe_nİ
;

385 
	gSts
::
VeùÜ
 
exe_»fs
;

386 
	gSts
::
VeùÜ
 
exe_lßds
;

387 
	gSts
::
VeùÜ
 
exe_b¿nches
;

389 
	gSts
::
VeùÜ
 
issued_İs
;

392 
	gSts
::
VeùÜ
 
lsq_fÜw_lßds
;

395 
	gSts
::
VeùÜ
 
šv_addr_lßds
;

398 
	gSts
::
VeùÜ
 
šv_addr_swpfs
;

400 
	gSts
::
VeùÜ
 
lsq_blocked_lßds
;

402 
	gSts
::
SÿÏr
 
lsqInv”siÚ
;

404 
	gSts
::
VeùÜ
 
n_issued_di¡
;

405 
	gSts
::
VeùÜDi¡ributiÚ
 
issue_d–ay_di¡
;

407 
	gSts
::
VeùÜDi¡ributiÚ
 
queue_»s_di¡
;

425 
	gSts
::
VeùÜ
 
wr™eback_couÁ
;

426 
	gSts
::
VeùÜ
 
´oduûr_š¡
;

427 
	gSts
::
VeùÜ
 
cÚsum”_š¡
;

428 
	gSts
::
VeùÜ
 
wb_³Çlized
;

430 
	gSts
::
FÜmuÏ
 
wb_¿‹
;

431 
	gSts
::
FÜmuÏ
 
wb_çnout
;

432 
	gSts
::
FÜmuÏ
 
wb_³Çlized_¿‹
;

435 
	gSts
::
VeùÜ
 
¡©_com_š¡
;

436 
	gSts
::
VeùÜ
 
¡©_com_swp
;

437 
	gSts
::
VeùÜ
 
¡©_com_»fs
;

438 
	gSts
::
VeùÜ
 
¡©_com_lßds
;

439 
	gSts
::
VeùÜ
 
¡©_com_memb¬s
;

440 
	gSts
::
VeùÜ
 
¡©_com_b¿nches
;

442 
	gSts
::
Di¡ributiÚ
 
n_comm™‹d_di¡
;

444 
	gSts
::
SÿÏr
 
comm™_–igibË_§m¶es
;

445 
	gSts
::
VeùÜ
 
comm™_–igibË
;

447 
	gSts
::
SÿÏr
 
ROB_fcouÁ
;

448 
	gSts
::
FÜmuÏ
 
ROB_fuÎ_¿‹
;

450 
	gSts
::
VeùÜ
 
ROB_couÁ
;

451 
	gSts
::
FÜmuÏ
 
ROB_occ_¿‹
;

452 
	gSts
::
VeùÜDi¡ributiÚ
 
ROB_occ_di¡
;

453 
	gpublic
:

454 
dumpIn¡s
();

457 
	g‹m¶©e
 <
şass
 
	gIm¶
>

458 
	g‹m¶©e
 <
şass
 
	gT
>

459 
FauÉ


460 
	gBackEnd
<
	gIm¶
>::
	$»ad
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
lßd_idx
)

495  
LSQ
.
	`»ad
(
»q
, 
d©a
, 
lßd_idx
);

496 
	}
}

498 
	g‹m¶©e
 <
şass
 
	gIm¶
>

499 
	g‹m¶©e
 <
şass
 
	gT
>

500 
FauÉ


501 
	gBackEnd
<
	gIm¶
>::
	$wr™e
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
¡Üe_idx
)

532  
LSQ
.
	`wr™e
(
»q
, 
d©a
, 
¡Üe_idx
);

533 
	}
}

	@ozone/back_end_impl.hh

31 #iâdeà
__CPU_OZONE_BACK_END_IMPL_HH__


32 
	#__CPU_OZONE_BACK_END_IMPL_HH__


	)

34 
	~"ıu/ozÚe/back_’d.hh
"

35 
	~"’cumb”ed/ıu/fuÎ/İ_şass.hh
"

37 
	g‹m¶©e
 <
şass
 
	gIm¶
>

38 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$In¡Queue
(
P¬ams
 *
·¿ms
)

39 : 
	`size
(
·¿ms
->
numIQEÁr›s
), 
	`numIn¡s
(0), 
	`width
Õ¬ams->
issueWidth
)

41 
	}
}

43 
	g‹m¶©e
 <
şass
 
	gIm¶
>

44 
	g¡d
::
¡ršg


45 
BackEnd
<
Im¶
>::
In¡Queue
::
	$Çme
() const

47  
be
->
	`Çme
() + ".iq";

48 
	}
}

50 
	g‹m¶©e
 <
şass
 
	gIm¶
>

52 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$»gSts
()

54 
usšg
 
Çme¥aû
 
Sts
;

56 
occ_di¡


57 .
	`š™
(1, 0, 
size
, 2)

58 .
	`Çme
(name() + "occ_dist")

59 .
	`desc
("IQ Occupancy…er cycle")

60 .
	`æags
(
tÙ®
 | 
cdf
)

63 
š¡_couÁ


64 .
	`š™
(1)

65 .
	`Çme
(name() + "cum_num_insts")

66 .
	`desc
("Total occupancy")

67 .
	`æags
(
tÙ®
)

70 
³ak_š¡_couÁ


71 .
	`š™
(1)

72 .
	`Çme
(name() + "peak_occupancy")

73 .
	`desc
("Peak IQ occupancy")

74 .
	`æags
(
tÙ®
)

77 
cu¼’t_couÁ


78 .
	`Çme
(name() + "current_count")

79 .
	`desc
("Occupancyhis cycle")

82 
em±y_couÁ


83 .
	`Çme
(name() + "empty_count")

84 .
	`desc
("Number ofƒmpty cycles")

87 
fuÎCouÁ


88 .
	`Çme
(name() + "full_count")

89 .
	`desc
("Number of full cycles")

93 
occ_¿‹


94 .
	`Çme
(name() + "occ_rate")

95 .
	`desc
("Average occupancy")

96 .
	`æags
(
tÙ®
)

98 
occ_¿‹
 = 
š¡_couÁ
 / 
be
->
ıu
->
numCyşes
;

100 
avg_»sid’cy


101 .
	`Çme
(name() + "avg_residency")

102 .
	`desc
("Average IQ„esidency")

103 .
	`æags
(
tÙ®
)

105 
avg_»sid’cy
 = 
occ_¿‹
 / 
be
->
ıu
->
numCyşes
;

107 
em±y_¿‹


108 .
	`Çme
(name() + "empty_rate")

109 .
	`desc
("Fraction of cyclesƒmpty")

111 
em±y_¿‹
 = 100 * 
em±y_couÁ
 / 
be
->
ıu
->
numCyşes
;

113 
fuÎ_¿‹


114 .
	`Çme
(name() + "full_rate")

115 .
	`desc
("Fraction of cycles full")

117 
fuÎ_¿‹
 = 100 * 
fuÎCouÁ
 / 
be
->
ıu
->
numCyşes
;

118 
	}
}

120 
	g‹m¶©e
 <
şass
 
	gIm¶
>

122 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
£tIssueExecQueue
(
TimeBufãr
<
IssueToExec
> *
i2e_queue
)

124 
i2e
 = 
i2e_queue
;

125 
	gnumIssued
 = 
i2e
->
g‘Wœe
(0);

128 
	g‹m¶©e
 <
şass
 
	gIm¶
>

130 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$š£¹
(
DynIn¡PŒ
 &
š¡
)

132 
numIn¡s
++;

133 
š¡_couÁ
[0]++;

134 ià(!
š¡
->
	`isNÚS³cuÏtive
()) {

135 
	`DPRINTF
(
BE
, "In¡ruùiÚ [¢:%Îi]‡ddedØIQ\n", 
š¡
->
£qNum
);

136 ià(
š¡
->
	`»adyToIssue
()) {

137 
toBeScheduËd
.
	`push_äÚt
(
š¡
);

138 
š¡
->
iqIt
 = 
toBeScheduËd
.
	`begš
();

139 
š¡
->
iqItV®id
 = 
Œue
;

141 
iq
.
	`push_äÚt
(
š¡
);

142 
š¡
->
iqIt
 = 
iq
.
	`begš
();

143 
š¡
->
iqItV®id
 = 
Œue
;

146 
	`DPRINTF
(
BE
, "NÚ¥ecuÏtivš¡ruùiÚ [¢:%Îi]‡ddedØIQ\n", 
š¡
->
£qNum
);

147 
nÚS³c
.
	`push_äÚt
(
š¡
);

148 
š¡
->
iqIt
 = 
nÚS³c
.
	`begš
();

149 
š¡
->
iqItV®id
 = 
Œue
;

151 
	}
}

153 
	g‹m¶©e
 <
şass
 
	gIm¶
>

155 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$scheduËR—dyIn¡s
()

157 
scheduËd
 = 
numIssued
->
size
;

158 
In¡Li¡It
 
iq_™
 = --
toBeScheduËd
.
	`’d
();

159 
In¡Li¡It
 
iq_’d_™
 = 
toBeScheduËd
.
	`’d
();

161 
iq_™
 !ğ
iq_’d_™
 && 
scheduËd
 < 
width
) {

163 
	`DPRINTF
(
BE
, "Instruction [sn:%lli] PC:%#x is„eady\n",

164 (*
iq_™
)->
£qNum
, (*iq_™)->
	`»adPC
());

165 
»adyQueue
.
	`push
(*
iq_™
);

166 
»adyLi¡
.
	`push_äÚt
(*
iq_™
);

168 (*
iq_™
)->
iqIt
 = 
»adyLi¡
.
	`begš
();

170 
toBeScheduËd
.
	`”a£
(
iq_™
--);

172 ++
scheduËd
;

178 
numIssued
->
size
+ğ
scheduËd
;

179 
	}
}

181 
	g‹m¶©e
 <
şass
 
	gIm¶
>

183 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$scheduËNÚS³c
(cÚ¡ 
In¡SeqNum
 &
¢
)

194 
DynIn¡PŒ
 
š¡
 = 
nÚS³c
.
	`back
();

196 
	`DPRINTF
(
BE
, "NÚ¥ecuÏtivš¡ruùiÚ [¢:%Îi] scheduËd\n", 
š¡
->
£qNum
);

198 
	`as£¹
(
š¡
->
£qNum
 =ğ
¢
);

200 
	`as£¹
(
	`fšd
(
NÚS³c
, 
š¡
->
iqIt
));

201 
nÚS³c
.
	`”a£
(
š¡
->
iqIt
);

202 
»adyLi¡
.
	`push_äÚt
(
š¡
);

203 
š¡
->
iqIt
 = 
»adyLi¡
.
	`begš
();

204 
»adyQueue
.
	`push
(
š¡
);

205 
numIssued
->
size
++;

206 
	}
}

208 
	g‹m¶©e
 <
şass
 
	gIm¶
>

209 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


210 
BackEnd
<
Im¶
>::
In¡Queue
::
	$g‘R—dyIn¡
()

212 
	`as£¹
(!
»adyLi¡
.
	`em±y
());

214 
DynIn¡PŒ
 
š¡
 = 
»adyQueue
.
	`tİ
();

215 
»adyQueue
.
	`pİ
();

216 
	`as£¹
(
	`fšd
(
R—dyLi¡
, 
š¡
->
iqIt
));

217 
»adyLi¡
.
	`”a£
(
š¡
->
iqIt
);

218 
š¡
->
iqItV®id
 = 
çl£
;

220 --
numIn¡s
;

221  
š¡
;

222 
	}
}

224 
	g‹m¶©e
 <
şass
 
	gIm¶
>

226 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$squash
(cÚ¡ 
In¡SeqNum
 &
¢
)

228 
In¡Li¡It
 
iq_™
 = 
iq
.
	`begš
();

229 
In¡Li¡It
 
iq_’d_™
 = 
iq
.
	`’d
();

231 
iq_™
 !ğ
iq_’d_™
 && (*iq_™)->
£qNum
 > 
¢
) {

232 
	`DPRINTF
(
BE
, "In¡ruùiÚ [¢:%Îi]„emoved from IQ\n", (*
iq_™
)->
£qNum
);

233 (*
iq_™
)->
iqItV®id
 = 
çl£
;

234 
iq
.
	`”a£
(
iq_™
++);

235 --
numIn¡s
;

238 
iq_™
 = 
nÚS³c
.
	`begš
();

239 
iq_’d_™
 = 
nÚS³c
.
	`’d
();

241 
iq_™
 !ğ
iq_’d_™
 && (*iq_™)->
£qNum
 > 
¢
) {

242 
	`DPRINTF
(
BE
, "In¡ruùiÚ [¢:%Îi]„emoved from IQ\n", (*
iq_™
)->
£qNum
);

243 (*
iq_™
)->
iqItV®id
 = 
çl£
;

244 
nÚS³c
.
	`”a£
(
iq_™
++);

245 --
numIn¡s
;

248 
iq_™
 = 
»¶ayLi¡
.
	`begš
();

249 
iq_’d_™
 = 
»¶ayLi¡
.
	`’d
();

251 
iq_™
 !ğ
iq_’d_™
) {

252 ià((*
iq_™
)->
£qNum
 > 
¢
) {

253 
	`DPRINTF
(
BE
, "In¡ruùiÚ [¢:%Îi]„emoved from IQ\n", (*
iq_™
)->
£qNum
);

254 (*
iq_™
)->
iqItV®id
 = 
çl£
;

255 
»¶ayLi¡
.
	`”a£
(
iq_™
++);

256 --
numIn¡s
;

258 
iq_™
++;

262 
	`as£¹
(
numIn¡s
 >= 0);

275 
	}
}

277 
	g‹m¶©e
 <
şass
 
	gIm¶
>

279 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$wakeD•’d’ts
(
DynIn¡PŒ
 &
š¡
)

281 
	`as£¹
(!
š¡
->
	`isSquashed
());

282 
¡d
::
veùÜ
<
DynIn¡PŒ
> &
d•’d’ts
 = 
š¡
->
	`g‘D•’d’ts
();

283 
num_ouuts
 = 
d•’d’ts
.
	`size
();

285 
	`DPRINTF
(
BE
, "Wakšg in¡ruùiÚ [¢:%Îi] d•’d’t š IQ\n", 
š¡
->
£qNum
);

287 
i
 = 0; i < 
num_ouuts
; i++) {

288 
DynIn¡PŒ
 
d•_š¡
 = 
d•’d’ts
[
i
];

289 
d•_š¡
->
	`m¬kSrcRegR—dy
();

290 
	`DPRINTF
(
BE
, "M¬kšg sourû„eg„—dy [¢:%Îi] iÀIQ\n", 
d•_š¡
->
£qNum
);

292 ià(
d•_š¡
->
	`»adyToIssue
(è&& d•_š¡->
iqItV®id
) {

293 ià(
d•_š¡
->
	`isNÚS³cuÏtive
()) {

294 
	`as£¹
(
	`fšd
(
NÚS³c
, 
d•_š¡
->
iqIt
));

295 
nÚS³c
.
	`”a£
(
d•_š¡
->
iqIt
);

297 
	`as£¹
(
	`fšd
(
IQ
, 
d•_š¡
->
iqIt
));

298 
iq
.
	`”a£
(
d•_š¡
->
iqIt
);

301 
toBeScheduËd
.
	`push_äÚt
(
d•_š¡
);

302 
d•_š¡
->
iqIt
 = 
toBeScheduËd
.
	`begš
();

305  
num_ouuts
;

306 
	}
}

308 
	g‹m¶©e
 <
şass
 
	gIm¶
>

310 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$»scheduËMemIn¡
(
DynIn¡PŒ
 &
š¡
)

312 
	`DPRINTF
(
BE
, "Reschedulšg memÜy in¡ruùiÚ [¢:%Îi]\n", 
š¡
->
£qNum
);

313 
	`as£¹
(!
š¡
->
iqItV®id
);

314 
»¶ayLi¡
.
	`push_äÚt
(
š¡
);

315 
š¡
->
iqIt
 = 
»¶ayLi¡
.
	`begš
();

316 
š¡
->
iqItV®id
 = 
Œue
;

317 ++
numIn¡s
;

318 
	}
}

320 
	g‹m¶©e
 <
şass
 
	gIm¶
>

322 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$»¶ayMemIn¡
(
DynIn¡PŒ
 &
š¡
)

324 
	`DPRINTF
(
BE
, "R•Ïyšg memÜy in¡ruùiÚ [¢:%Îi]\n", 
š¡
->
£qNum
);

325 
	`as£¹
(
	`fšd
(
R•ÏyLi¡
, 
š¡
->
iqIt
));

326 
In¡Li¡It
 
iq_™
 = --
»¶ayLi¡
.
	`’d
();

327 
In¡Li¡It
 
iq_’d_™
 = 
»¶ayLi¡
.
	`’d
();

328 
iq_™
 !ğ
iq_’d_™
) {

329 
DynIn¡PŒ
 
»scheduËd_š¡
 = (*
iq_™
);

331 
	`DPRINTF
(
BE
, "MemÜy in¡ruùiÚ [¢:%Îi]‡lsØ»¶ayed\n", 
š¡
->
£qNum
);

332 
»¶ayLi¡
.
	`”a£
(
iq_™
--);

333 
toBeScheduËd
.
	`push_äÚt
(
»scheduËd_š¡
);

334 
»scheduËd_š¡
->
iqIt
 = 
toBeScheduËd
.
	`begš
();

336 
	}
}

338 
	g‹m¶©e
 <
şass
 
	gIm¶
>

340 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$com¶‘eMemIn¡
(
DynIn¡PŒ
 &
š¡
)

342 
	`·nic
("Not implemented.");

343 
	}
}

345 
	g‹m¶©e
 <
şass
 
	gIm¶
>

346 
boŞ


347 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$fšd
(
queue
 
q
, 
In¡Li¡It
 
™
)

349 
In¡Li¡It
 
iq_™
, 
iq_’d_™
;

350 
q
) {

351 
NÚS³c
:

352 
iq_™
 = 
nÚS³c
.
	`begš
();

353 
iq_’d_™
 = 
nÚS³c
.
	`’d
();

355 
IQ
:

356 
iq_™
 = 
iq
.
	`begš
();

357 
iq_’d_™
 = 
iq
.
	`’d
();

359 
ToBeScheduËd
:

360 
iq_™
 = 
toBeScheduËd
.
	`begš
();

361 
iq_’d_™
 = 
toBeScheduËd
.
	`’d
();

363 
R—dyLi¡
:

364 
iq_™
 = 
»adyLi¡
.
	`begš
();

365 
iq_’d_™
 = 
»adyLi¡
.
	`’d
();

367 
R•ÏyLi¡
:

368 
iq_™
 = 
»¶ayLi¡
.
	`begš
();

369 
iq_’d_™
 = 
»¶ayLi¡
.
	`’d
();

372 
iq_™
 !ğ
™
 && iq_™ !ğ
iq_’d_™
) {

373 
iq_™
++;

375 ià(
iq_™
 =ğ
™
) {

376  
Œue
;

378  
çl£
;

380 
	}
}

382 
	g‹m¶©e
 <
şass
 
	gIm¶
>

384 
	gBackEnd
<
	gIm¶
>::
In¡Queue
::
	$dumpIn¡s
()

386 
	`ırštf
("IQ size: %i\n", 
iq
.
	`size
());

388 
In¡Li¡It
 
š¡_li¡_™
 = --
iq
.
	`’d
();

390 
num
 = 0;

391 
v®id_num
 = 0;

392 
š¡_li¡_™
 !ğ
iq
.
	`’d
())

394 
	`ırštf
("Instruction:%i\n",

395 
num
);

396 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

397 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

398 ++
v®id_num
;

399 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

400 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

401 !(*
š¡_li¡_™
)->
memOpDÚe
) {

404 ++
v®id_num
;

405 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

409 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

411 (*
š¡_li¡_™
)->
	`»adPC
(),

412 (*
š¡_li¡_™
)->
£qNum
,

413 (*
š¡_li¡_™
)->
th»adNumb”
,

414 (*
š¡_li¡_™
)->
	`isIssued
(),

415 (*
š¡_li¡_™
)->
	`isSquashed
());

417 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

418 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

421 
	`ırštf
("\n");

423 
š¡_li¡_™
--;

424 ++
num
;

427 
	`ırštf
("nÚS³øsize: %i\n", 
nÚS³c
.
	`size
());

429 
š¡_li¡_™
 = --
nÚS³c
.
	`’d
();

431 
š¡_li¡_™
 !ğ
nÚS³c
.
	`’d
())

433 
	`ırštf
("Instruction:%i\n",

434 
num
);

435 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

436 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

437 ++
v®id_num
;

438 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

439 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

440 !(*
š¡_li¡_™
)->
memOpDÚe
) {

443 ++
v®id_num
;

444 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

448 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

450 (*
š¡_li¡_™
)->
	`»adPC
(),

451 (*
š¡_li¡_™
)->
£qNum
,

452 (*
š¡_li¡_™
)->
th»adNumb”
,

453 (*
š¡_li¡_™
)->
	`isIssued
(),

454 (*
š¡_li¡_™
)->
	`isSquashed
());

456 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

457 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

460 
	`ırštf
("\n");

462 
š¡_li¡_™
--;

463 ++
num
;

466 
	`ırštf
("toBeScheduËd size: %i\n", 
toBeScheduËd
.
	`size
());

468 
š¡_li¡_™
 = --
toBeScheduËd
.
	`’d
();

470 
š¡_li¡_™
 !ğ
toBeScheduËd
.
	`’d
())

472 
	`ırštf
("Instruction:%i\n",

473 
num
);

474 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

475 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

476 ++
v®id_num
;

477 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

478 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

479 !(*
š¡_li¡_™
)->
memOpDÚe
) {

482 ++
v®id_num
;

483 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

487 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

489 (*
š¡_li¡_™
)->
	`»adPC
(),

490 (*
š¡_li¡_™
)->
£qNum
,

491 (*
š¡_li¡_™
)->
th»adNumb”
,

492 (*
š¡_li¡_™
)->
	`isIssued
(),

493 (*
š¡_li¡_™
)->
	`isSquashed
());

495 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

496 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

499 
	`ırštf
("\n");

501 
š¡_li¡_™
--;

502 ++
num
;

505 
	`ırštf
("»adyLi¡ size: %i\n", 
»adyLi¡
.
	`size
());

507 
š¡_li¡_™
 = --
»adyLi¡
.
	`’d
();

509 
š¡_li¡_™
 !ğ
»adyLi¡
.
	`’d
())

511 
	`ırštf
("Instruction:%i\n",

512 
num
);

513 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

514 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

515 ++
v®id_num
;

516 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

517 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

518 !(*
š¡_li¡_™
)->
memOpDÚe
) {

521 ++
v®id_num
;

522 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

526 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

528 (*
š¡_li¡_™
)->
	`»adPC
(),

529 (*
š¡_li¡_™
)->
£qNum
,

530 (*
š¡_li¡_™
)->
th»adNumb”
,

531 (*
š¡_li¡_™
)->
	`isIssued
(),

532 (*
š¡_li¡_™
)->
	`isSquashed
());

534 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

535 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

538 
	`ırštf
("\n");

540 
š¡_li¡_™
--;

541 ++
num
;

543 
	}
}

545 
	g‹m¶©e
<
şass
 
	gIm¶
>

546 
	gBackEnd
<
	gIm¶
>::
LdWr™ebackEv’t
::LdWr™ebackEv’t(
DynIn¡PŒ
 &
_š¡
,

547 
BackEnd
<
Im¶
> *
_be
)

548 : 
Ev’t
(&
mašEv’tQueue
), 
š¡
(
_š¡
), 
	$be
(
_be
)

550 
this
->
	`£tFÏgs
(
Ev’t
::
AutoD–‘e
);

551 
	}
}

553 
	g‹m¶©e
<
şass
 
	gIm¶
>

555 
	gBackEnd
<
	gIm¶
>::
LdWr™ebackEv’t
::
	$´oûss
()

557 
	`DPRINTF
(
BE
, "Lßd wr™ebackƒv’ˆ[¢:%Îi]\n", 
š¡
->
£qNum
);

564 ià(
š¡
->
	`isSquashed
()) {

565 
š¡
 = 
NULL
;

569 ià(!
š¡
->
	`isExecu‹d
()) {

570 
š¡
->
	`£tExecu‹d
();

573 
š¡
->
	`com¶‘eAcc
();

577 
be
->
	`š¡ToComm™
(
š¡
);

582 
š¡
 = 
NULL
;

583 
	}
}

585 
	g‹m¶©e
<
şass
 
	gIm¶
>

587 
	gBackEnd
<
	gIm¶
>::
LdWr™ebackEv’t
::
	$desütiÚ
() const

590 
	}
}

593 
	g‹m¶©e
 <
şass
 
	gIm¶
>

594 
	gBackEnd
<
	gIm¶
>::
DCacheCom¶‘iÚEv’t
::
	$DCacheCom¶‘iÚEv’t
(
BackEnd
 *
_be
)

595 : 
	`Ev’t
(&
mašEv’tQueue
, 
CPU_Tick_Pri
), 
	$be
(
_be
)

597 
	}
}

599 
	g‹m¶©e
 <
şass
 
	gIm¶
>

601 
	gBackEnd
<
	gIm¶
>::
DCacheCom¶‘iÚEv’t
::
	$´oûss
()

603 
	}
}

605 
‹m¶©e
 <
şass
 
Im¶
>

607 
BackEnd
<
Im¶
>::
DCacheCom¶‘iÚEv’t
::
	$desütiÚ
() const

610 
	}
}

612 
	g‹m¶©e
 <
şass
 
	gIm¶
>

613 
	gBackEnd
<
	gIm¶
>::
	$BackEnd
(
P¬ams
 *
·¿ms
)

614 : 
	`d2i
(5, 5), 
	`i2e
(5, 5), 
	`e2c
(5, 5), 
	`numIn¡sToWB
(5, 5),

615 
	`xcSquash
(
çl£
), 
	`IQ
(
·¿ms
),

616 
	`ÿcheCom¶‘iÚEv’t
(
this
), 
	`width
(
·¿ms
->
backEndWidth
),

617 
	$exaùFuÎSÎ
(
Œue
)

619 
numROBEÁr›s
 = 
·¿ms
->numROBEntries;

620 
numIn¡s
 = 0;

621 
numDi¥©chEÁr›s
 = 32;

622 
IQ
.
	`£tBE
(
this
);

623 
LSQ
.
	`£tBE
(
this
);

626 
š¡sToDi¥©ch
 = 
d2i
.
	`g‘Wœe
(-1);

628 
š¡sToExecu‹
 = 
i2e
.
	`g‘Wœe
(-1);

630 
IQ
.
	`£tIssueExecQueue
(&
i2e
);

632 
di¥©chWidth
 = 
·¿ms
->di¥©chWidth ?…¬ams->di¥©chWidth : 
width
;

633 
issueWidth
 = 
·¿ms
->issueWidth ?…¬ams->issueWidth : 
width
;

634 
wbWidth
 = 
·¿ms
->wbWidth ?…¬ams->wbWidth : 
width
;

635 
comm™Width
 = 
·¿ms
->comm™Width ?…¬ams->comm™Width : 
width
;

637 
LSQ
.
	`š™
(
·¿ms
,…¬ams->
LQEÁr›s
,…¬ams->
SQEÁr›s
, 0);

639 
di¥©chStus
 = 
RuÂšg
;

640 
	}
}

642 
	g‹m¶©e
 <
şass
 
	gIm¶
>

643 
	g¡d
::
¡ršg


644 
BackEnd
<
Im¶
>::
	$Çme
() const

646  
ıu
->
	`Çme
() + ".backend";

647 
	}
}

649 
	g‹m¶©e
 <
şass
 
	gIm¶
>

651 
	gBackEnd
<
	gIm¶
>::
	$»gSts
()

653 
usšg
 
Çme¥aû
 
Sts
;

654 
rob_ÿp_ev’ts


655 .
	`š™
(
ıu
->
numTh»ads
)

656 .
	`Çme
(name() + ".ROB:cap_events")

657 .
	`desc
("number of cycles where ROB cap was‡ctive")

658 .
	`æags
(
tÙ®
)

661 
rob_ÿp_š¡_couÁ


662 .
	`š™
(
ıu
->
numTh»ads
)

663 .
	`Çme
(name() + ".ROB:cap_inst")

664 .
	`desc
("number of instructions held up by ROB cap")

665 .
	`æags
(
tÙ®
)

668 
iq_ÿp_ev’ts


669 .
	`š™
(
ıu
->
numTh»ads
)

670 .
	`Çme
(name() +".IQ:cap_events" )

671 .
	`desc
("number of cycles where IQ cap was‡ctive")

672 .
	`æags
(
tÙ®
)

675 
iq_ÿp_š¡_couÁ


676 .
	`š™
(
ıu
->
numTh»ads
)

677 .
	`Çme
(name() + ".IQ:cap_inst")

678 .
	`desc
("number of instructions held up by IQ cap")

679 .
	`æags
(
tÙ®
)

683 
exe_š¡


684 .
	`š™
(
ıu
->
numTh»ads
)

685 .
	`Çme
(name() + ".ISSUE:count")

686 .
	`desc
("number of insts issued")

687 .
	`æags
(
tÙ®
)

690 
exe_swp


691 .
	`š™
(
ıu
->
numTh»ads
)

692 .
	`Çme
(name() + ".ISSUE:swp")

693 .
	`desc
("number of swp insts issued")

694 .
	`æags
(
tÙ®
)

697 
exe_nİ


698 .
	`š™
(
ıu
->
numTh»ads
)

699 .
	`Çme
(name() + ".ISSUE:nop")

700 .
	`desc
("number of‚op insts issued")

701 .
	`æags
(
tÙ®
)

704 
exe_»fs


705 .
	`š™
(
ıu
->
numTh»ads
)

706 .
	`Çme
(name() + ".ISSUE:refs")

707 .
	`desc
("number of memory„eference insts issued")

708 .
	`æags
(
tÙ®
)

711 
exe_lßds


712 .
	`š™
(
ıu
->
numTh»ads
)

713 .
	`Çme
(name() + ".ISSUE:loads")

714 .
	`desc
("number of†oad insts issued")

715 .
	`æags
(
tÙ®
)

718 
exe_b¿nches


719 .
	`š™
(
ıu
->
numTh»ads
)

720 .
	`Çme
(name() + ".ISSUE:branches")

721 .
	`desc
("Number of branches issued")

722 .
	`æags
(
tÙ®
)

725 
issued_İs


726 .
	`š™
(
ıu
->
numTh»ads
)

727 .
	`Çme
(name() + ".ISSUE:op_count")

728 .
	`desc
("number of insts issued")

729 .
	`æags
(
tÙ®
)

742 
lsq_fÜw_lßds


743 .
	`š™
(
ıu
->
numTh»ads
)

744 .
	`Çme
(name() + ".LSQ:forw_loads")

745 .
	`desc
("number of†oads forwarded via LSQ")

746 .
	`æags
(
tÙ®
)

749 
šv_addr_lßds


750 .
	`š™
(
ıu
->
numTh»ads
)

751 .
	`Çme
(name() + ".ISSUE:addr_loads")

752 .
	`desc
("number of invalid-address†oads")

753 .
	`æags
(
tÙ®
)

756 
šv_addr_swpfs


757 .
	`š™
(
ıu
->
numTh»ads
)

758 .
	`Çme
(name() + ".ISSUE:addr_swpfs")

759 .
	`desc
("number of invalid-address SW…refetches")

760 .
	`æags
(
tÙ®
)

763 
lsq_blocked_lßds


764 .
	`š™
(
ıu
->
numTh»ads
)

765 .
	`Çme
(name() + ".LSQ:blocked_loads")

766 .
	`desc
("number of„eady†oads‚ot issued dueo memory disambiguation")

767 .
	`æags
(
tÙ®
)

770 
lsqInv”siÚ


771 .
	`Çme
(name() + ".ISSUE:lsq_invert")

772 .
	`desc
("Number ofimes LSQ instruction issuedƒarly")

775 
n_issued_di¡


776 .
	`š™
(
issueWidth
 + 1)

777 .
	`Çme
(name() + ".ISSUE:issued_per_cycle")

778 .
	`desc
("Number of insts issuedƒach cycle")

779 .
	`æags
(
tÙ®
 | 
pdf
 | 
di¡
)

781 
issue_d–ay_di¡


782 .
	`š™
(
Num_OpCÏs£s
,0,99,2)

783 .
	`Çme
(name() + ".ISSUE:")

784 .
	`desc
("cycles from operands„eadyo issue")

785 .
	`æags
(
pdf
 | 
cdf
)

788 
queue_»s_di¡


789 .
	`š™
(
Num_OpCÏs£s
, 0, 99, 2)

790 .
	`Çme
(name() + ".IQ:residence:")

791 .
	`desc
("cycles from dispatcho issue")

792 .
	`æags
(
tÙ®
 | 
pdf
 | 
cdf
 )

794 
i
 = 0; i < 
Num_OpCÏs£s
; ++i) {

795 
queue_»s_di¡
.
	`subÇme
(
i
, 
İCÏssSŒšgs
[i]);

798 
wr™eback_couÁ


799 .
	`š™
(
ıu
->
numTh»ads
)

800 .
	`Çme
(name() + ".WB:count")

801 .
	`desc
("cumulative count of insts written-back")

802 .
	`æags
(
tÙ®
)

805 
´oduûr_š¡


806 .
	`š™
(
ıu
->
numTh»ads
)

807 .
	`Çme
(name() + ".WB:producers")

808 .
	`desc
("num instructions…roducing‡ value")

809 .
	`æags
(
tÙ®
)

812 
cÚsum”_š¡


813 .
	`š™
(
ıu
->
numTh»ads
)

814 .
	`Çme
(name() + ".WB:consumers")

815 .
	`desc
("num instructions consuming‡ value")

816 .
	`æags
(
tÙ®
)

819 
wb_³Çlized


820 .
	`š™
(
ıu
->
numTh»ads
)

821 .
	`Çme
(name() + ".WB:penalized")

822 .
	`desc
("number of instrctions„equiredo writeo 'other' IQ")

823 .
	`æags
(
tÙ®
)

827 
wb_³Çlized_¿‹


828 .
	`Çme
(name() + ".WB:penalized_rate")

829 .
	`desc
 ("fraction of instructions written-backhat wroteo 'other' IQ")

830 .
	`æags
(
tÙ®
)

833 
wb_³Çlized_¿‹
 = 
wb_³Çlized
 / 
wr™eback_couÁ
;

835 
wb_çnout


836 .
	`Çme
(name() + ".WB:fanout")

837 .
	`desc
("average fanout of values written-back")

838 .
	`æags
(
tÙ®
)

841 
wb_çnout
 = 
´oduûr_š¡
 / 
cÚsum”_š¡
;

843 
wb_¿‹


844 .
	`Çme
(name() + ".WB:rate")

845 .
	`desc
("insts written-back…er cycle")

846 .
	`æags
(
tÙ®
)

848 
wb_¿‹
 = 
wr™eback_couÁ
 / 
ıu
->
numCyşes
;

850 
¡©_com_š¡


851 .
	`š™
(
ıu
->
numTh»ads
)

852 .
	`Çme
(name() + ".COM:count")

853 .
	`desc
("Number of instructions committed")

854 .
	`æags
(
tÙ®
)

857 
¡©_com_swp


858 .
	`š™
(
ıu
->
numTh»ads
)

859 .
	`Çme
(name() + ".COM:swp_count")

860 .
	`desc
("Number of s/w…refetches committed")

861 .
	`æags
(
tÙ®
)

864 
¡©_com_»fs


865 .
	`š™
(
ıu
->
numTh»ads
)

866 .
	`Çme
(name() + ".COM:refs")

867 .
	`desc
("Number of memory„eferences committed")

868 .
	`æags
(
tÙ®
)

871 
¡©_com_lßds


872 .
	`š™
(
ıu
->
numTh»ads
)

873 .
	`Çme
(name() + ".COM:loads")

874 .
	`desc
("Number of†oads committed")

875 .
	`æags
(
tÙ®
)

878 
¡©_com_memb¬s


879 .
	`š™
(
ıu
->
numTh»ads
)

880 .
	`Çme
(name() + ".COM:membars")

881 .
	`desc
("Number of memory barriers committed")

882 .
	`æags
(
tÙ®
)

885 
¡©_com_b¿nches


886 .
	`š™
(
ıu
->
numTh»ads
)

887 .
	`Çme
(name() + ".COM:branches")

888 .
	`desc
("Number of branches committed")

889 .
	`æags
(
tÙ®
)

891 
n_comm™‹d_di¡


892 .
	`š™
(0,
comm™Width
,1)

893 .
	`Çme
(name() + ".COM:committed_per_cycle")

894 .
	`desc
("Number of insts commitedƒach cycle")

895 .
	`æags
(
pdf
)

911 
comm™_–igibË


912 .
	`š™
(
ıu
->
numTh»ads
)

913 .
	`Çme
(name() + ".COM:bw_limited")

914 .
	`desc
("number of insts‚ot committed dueo BW†imits")

915 .
	`æags
(
tÙ®
)

918 
comm™_–igibË_§m¶es


919 .
	`Çme
(name() + ".COM:bw_lim_events")

920 .
	`desc
("number cycles where commit BW†imit„eached")

923 
ROB_fcouÁ


924 .
	`Çme
(name() + ".ROB:full_count")

925 .
	`desc
("number of cycles where ROB was full")

928 
ROB_couÁ


929 .
	`š™
(
ıu
->
numTh»ads
)

930 .
	`Çme
(name() + ".ROB:occupancy")

931 .
	`desc
(
	`Çme
() + ".ROB occupancy (cumulative)")

932 .
	`æags
(
tÙ®
)

935 
ROB_fuÎ_¿‹


936 .
	`Çme
(name() + ".ROB:full_rate")

937 .
	`desc
("ROB full…er cycle")

939 
ROB_fuÎ_¿‹
 = 
ROB_fcouÁ
 / 
ıu
->
numCyşes
;

941 
ROB_occ_¿‹


942 .
	`Çme
(name() + ".ROB:occ_rate")

943 .
	`desc
("ROB occupancy„ate")

944 .
	`æags
(
tÙ®
)

946 
ROB_occ_¿‹
 = 
ROB_couÁ
 / 
ıu
->
numCyşes
;

948 
ROB_occ_di¡


949 .
	`š™
(
ıu
->
numTh»ads
, 0, 
numROBEÁr›s
, 2)

950 .
	`Çme
(name() + ".ROB:occ_dist")

951 .
	`desc
("ROB Occupancy…er cycle")

952 .
	`æags
(
tÙ®
 | 
cdf
)

955 
IQ
.
	`»gSts
();

956 
	}
}

958 
	g‹m¶©e
 <
şass
 
	gIm¶
>

960 
	gBackEnd
<
	gIm¶
>::
£tCommBufãr
(
TimeBufãr
<
CommSŒuù
> *
_comm
)

962 
comm
 = 
_comm
;

963 
	gtoIEW
 = 
comm
->
g‘Wœe
(0);

964 
	gäomComm™
 = 
comm
->
g‘Wœe
(-1);

967 
	g‹m¶©e
 <
şass
 
	gIm¶
>

969 
	gBackEnd
<
	gIm¶
>::
	$tick
()

971 
	`DPRINTF
(
BE
, "Ticking backƒnd\n");

973 
ROB_couÁ
[0]+ğ
numIn¡s
;

975 
wbCyşe
 = 0;

977 ià(
xcSquash
) {

978 
	`squashFromXC
();

982 
	`upd©eSŒuùu»s
();

984 ià(
di¥©chStus
 !ğ
Blocked
) {

985 
d2i
.
	`advªû
();

986 
	`di¥©chIn¡s
();

988 
	`checkDi¥©chStus
();

991 
i2e
.
	`advªû
();

992 
	`scheduËR—dyIn¡s
();

994 
e2c
.
	`advªû
();

995 
	`execu‹In¡s
();

997 
numIn¡sToWB
.
	`advªû
();

998 
	`wr™ebackIn¡s
();

1000 
	`comm™In¡s
();

1002 
	`DPRINTF
(
BE
, "IQƒntries in use: %i, ROBƒntries in use: %i, LSQ†oads: %i, LSQ stores: %i\n",

1003 
IQ
.
numIn¡s
,‚umIn¡s, 
LSQ
.
	`numLßds
(), LSQ.
	`numStÜes
());

1005 
	`as£¹
(
numIn¡s
 =ğ
š¡Li¡
.
	`size
());

1006 
	}
}

1008 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1010 
	gBackEnd
<
	gIm¶
>::
	$upd©eSŒuùu»s
()

1012 ià(
äomComm™
->
dÚeSeqNum
) {

1013 
IQ
.
	`comm™
(
äomComm™
->
dÚeSeqNum
);

1014 
LSQ
.
	`comm™Lßds
(
äomComm™
->
dÚeSeqNum
);

1015 
LSQ
.
	`comm™StÜes
(
äomComm™
->
dÚeSeqNum
);

1018 ià(
äomComm™
->
nÚS³cSeqNum
) {

1019 ià(
äomComm™
->
unÿched
) {

1020 
LSQ
.
	`execu‹Lßd
(
äomComm™
->
lqIdx
);

1022 
IQ
.
	`scheduËNÚS³c
(

1023 
äomComm™
->
nÚS³cSeqNum
);

1026 
	}
}

1028 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1030 
	gBackEnd
<
	gIm¶
>::
	$addToIQ
(
DynIn¡PŒ
 &
š¡
)

1033 
IQ
.
	`š£¹
(
š¡
);

1034 
	}
}

1036 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1038 
	gBackEnd
<
	gIm¶
>::
	$addToLSQ
(
DynIn¡PŒ
 &
š¡
)

1041 
LSQ
.
	`š£¹
(
š¡
);

1042 
	}
}

1044 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1046 
	gBackEnd
<
	gIm¶
>::
	$di¥©chIn¡s
()

1048 
	`DPRINTF
(
BE
, "Tryingo dispatch instructions.\n");

1051 
di¥_width
 = 
di¥©chWidth
 ? di¥©chWidth : 
width
;

1056 ià(
di¥©chSize
 < 
numDi¥©chEÁr›s
) {

1057 
i
 = 0; i < 
di¥_width
; i++) {

1059 
DynIn¡PŒ
 
š¡
 = 
äÚtEnd
->
	`g‘In¡
();

1061 ià(!
š¡
) {

1066 
	`DPRINTF
(
BE
, "Processing instruction [sn:%lli] PC:%#x\n",

1067 
š¡
->
£qNum
, in¡->
	`»adPC
());

1069 
i
 = 0; i < 
š¡
->
	`numDe¡Regs
(); ++i)

1070 
»ÇmeTabË
[
š¡
->
	`de¡RegIdx
(
i
)] = inst;

1073 
di¥©ch
.
	`push_back
(
š¡
);

1075 
d2i
[0].
size
++;

1076 ++
di¥©chSize
;

1080 
	`as£¹
(
di¥©ch
.
	`size
() < 64);

1082 
i
 = 0; i < 
š¡sToDi¥©ch
->
size
; ++i) {

1083 
	`as£¹
(!
di¥©ch
.
	`em±y
());

1085 
DynIn¡PŒ
 
š¡
 = 
di¥©ch
.
	`äÚt
();

1086 
di¥©ch
.
	`pİ_äÚt
();

1087 --
di¥©chSize
;

1089 ià(
š¡
->
	`isSquashed
())

1092 ++
numIn¡s
;

1093 
š¡Li¡
.
	`push_back
(
š¡
);

1095 
	`DPRINTF
(
BE
, "Dispatching instruction [sn:%lli] PC:%#x\n",

1096 
š¡
->
£qNum
, in¡->
	`»adPC
());

1098 
	`addToIQ
(
š¡
);

1100 ià(
š¡
->
	`isMemRef
()) {

1101 
	`addToLSQ
(
š¡
);

1104 ià(
š¡
->
	`isNÚS³cuÏtive
()) {

1105 
š¡
->
	`£tCªComm™
();

1111 ià(
exaùFuÎSÎ
) {

1112 
boŞ
 
¡®l
 = 
çl£
;

1113 ià(
IQ
.
	`isFuÎ
()) {

1114 
	`DPRINTF
(
BE
, "IQ is full!\n");

1115 
¡®l
 = 
Œue
;

1116 } ià(
LSQ
.
	`isFuÎ
()) {

1117 
	`DPRINTF
(
BE
, "LSQ is full!\n");

1118 
¡®l
 = 
Œue
;

1119 } ià(
	`isFuÎ
()) {

1120 
	`DPRINTF
(
BE
, "ROB is full!\n");

1121 
¡®l
 = 
Œue
;

1122 
ROB_fcouÁ
++;

1124 ià(
¡®l
) {

1125 
š¡sToDi¥©ch
->
size
-ğ
i
+1;

1126 
	`di¥©chSÎ
();

1137 
boŞ
 
¡®l
 = 
çl£
;

1138 ià(
IQ
.
	`isFuÎ
()) {

1139 
	`DPRINTF
(
BE
, "IQ is full!\n");

1140 
¡®l
 = 
Œue
;

1141 } ià(
LSQ
.
	`isFuÎ
()) {

1142 
	`DPRINTF
(
BE
, "LSQ is full!\n");

1143 
¡®l
 = 
Œue
;

1144 } ià(
	`isFuÎ
()) {

1145 
	`DPRINTF
(
BE
, "ROB is full!\n");

1146 
¡®l
 = 
Œue
;

1147 
ROB_fcouÁ
++;

1149 ià(
¡®l
) {

1150 
d2i
.
	`advªû
();

1151 
	`di¥©chSÎ
();

1154 
	}
}

1156 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1158 
	gBackEnd
<
	gIm¶
>::
	$di¥©chSÎ
()

1160 
di¥©chStus
 = 
Blocked
;

1161 ià(!
ıu
->
decou¶edFrÚtEnd
) {

1165 
	}
}

1167 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1169 
	gBackEnd
<
	gIm¶
>::
	$checkDi¥©chStus
()

1171 
	`DPRINTF
(
BE
, "Checking dispatch status\n");

1172 
	`as£¹
(
di¥©chStus
 =ğ
Blocked
);

1173 ià(!
IQ
.
	`isFuÎ
(è&& !
LSQ
.isFull() && !isFull()) {

1174 
	`DPRINTF
(
BE
, "Dispatch‚o†onger blocked\n");

1175 
di¥©chStus
 = 
RuÂšg
;

1176 
	`di¥©chIn¡s
();

1178 
	}
}

1180 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1182 
	gBackEnd
<
	gIm¶
>::
	$scheduËR—dyIn¡s
()

1189 
	`DPRINTF
(
BE
, "Tryingo schedule„eady instructions\n");

1190 
IQ
.
	`scheduËR—dyIn¡s
();

1191 
	}
}

1193 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1195 
	gBackEnd
<
	gIm¶
>::
	$execu‹In¡s
()

1197 
š¡s_to_execu‹
 = 
š¡sToExecu‹
->
size
;

1199 
issued_İs
[0]+ğ
š¡s_to_execu‹
;

1200 
n_issued_di¡
[
š¡s_to_execu‹
]++;

1202 
	`DPRINTF
(
BE
, "TryšgØexecu‹ %˜š¡ruùiÚs\n", 
š¡s_to_execu‹
);

1204 
ãtchRedœeù
[0] = 
çl£
;

1206 
š¡s_to_execu‹
 > 0) {

1210 
DynIn¡PŒ
 
š¡
 = 
IQ
.
	`g‘R—dyIn¡
();

1212 
	`DPRINTF
(
BE
, "Executing inst [sn:%lli] PC: %#x\n",

1213 
š¡
->
£qNum
, in¡->
	`»adPC
());

1215 ++
funcExeIn¡
;

1219 ià(
š¡
->
	`isSquashed
()) {

1220 
	`DPRINTF
(
BE
, "Execute: Instruction was squashed.\n");

1225 --
š¡s_to_execu‹
;

1229 
š¡
->
	`£tExecu‹d
();

1233 
š¡
->
	`£tCªComm™
();

1240 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

1245 ià(
š¡
->
	`isMemRef
() &&

1246 (!
š¡
->
	`isD©aP»ãtch
(è&& !š¡->
	`isIn¡P»ãtch
())) {

1247 
	`DPRINTF
(
BE
, "Execute: Initiating‡ccess for memory "

1251 ià(
š¡
->
	`isLßd
()) {

1254 
çuÉ
 = 
LSQ
.
	`execu‹Lßd
(
š¡
);

1257 } ià(
š¡
->
	`isStÜe
()) {

1258 
LSQ
.
	`execu‹StÜe
(
š¡
);

1262 ià(!(
š¡
->
»q
->
	`isLLSC
())) {

1263 
š¡
->
	`£tExecu‹d
();

1265 
	`š¡ToComm™
(
š¡
);

1271 
	`·nic
("Unexpected memoryype!\n");

1275 
š¡
->
	`execu‹
();

1279 
š¡
->
	`£tExecu‹d
();

1281 
	`š¡ToComm™
(
š¡
);

1284 
	`upd©eExeIn¡Sts
(
š¡
);

1298 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1300 ià(!
ãtchRedœeù
[
tid
]) {

1302 ià(
š¡
->
	`mi¥»diùed
()) {

1303 
ãtchRedœeù
[
tid
] = 
Œue
;

1305 
	`DPRINTF
(
BE
, "Execute: Branch mispredict detected.\n");

1306 
	`DPRINTF
(
BE
, "Execute: Redirecting fetcho PC: %#x.\n",

1307 
š¡
->
ÃxtPC
);

1310 
	`squashDueToB¿nch
(
š¡
);

1312 ià(
š¡
->
	`´edTak’
()) {

1317 } ià(
LSQ
.
	`viŞ©iÚ
()) {

1318 
ãtchRedœeù
[
tid
] = 
Œue
;

1322 
DynIn¡PŒ
 
viŞ©Ü
;

1323 
viŞ©Ü
 = 
LSQ
.
	`g‘MemD•ViŞ©Ü
();

1325 
	`DPRINTF
(
BE
, "LDSTQ detected‡ violation. Violator PC: "

1327 
viŞ©Ü
->
	`»adPC
(), 
š¡
->»adPC(), in¡->
physEffAddr
);

1334 
	`squashDueToB¿nch
(
š¡
);

1337 } ià(
LSQ
.
	`lßdBlocked
()) {

1338 
ãtchRedœeù
[
tid
] = 
Œue
;

1340 
	`DPRINTF
(
BE
, "Load operation couldn'tƒxecute becausehe "

1342 
š¡
->
	`»adPC
(), in¡->
£qNum
);

1344 
	`squashDueToMemBlocked
(
š¡
);

1350 --
š¡s_to_execu‹
;

1353 
th»ad
->
numIn¡
++;

1354 
th»ad
->
numIn¡s
++;

1357 
	`as£¹
(
š¡s_to_execu‹
 >= 0);

1358 
	}
}

1360 
	g‹m¶©e
<
şass
 
	gIm¶
>

1362 
	gBackEnd
<
	gIm¶
>::
	$š¡ToComm™
(
DynIn¡PŒ
 &
š¡
)

1364 
wb_width
 = 
wbWidth
;

1374 
	`DPRINTF
(
BE
, "Sending instructionso commit [sn:%lli] PC %#x.\n",

1375 
š¡
->
£qNum
, in¡->
	`»adPC
());

1377 
numIn¡sToWB
[
wbCyşe
].
size
 >ğ
wb_width
) {

1378 ++
wbCyşe
;

1380 
	`as£¹
(
wbCyşe
 < 5);

1384 
wr™eback
.
	`push_back
(
š¡
);

1385 
numIn¡sToWB
[
wbCyşe
].
size
++;

1387 ià(
wbCyşe
)

1388 
wb_³Çlized
[0]++;

1389 
	}
}

1391 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1393 
	gBackEnd
<
	gIm¶
>::
	$wr™ebackIn¡s
()

1395 
wb_width
 = 
wbWidth
;

1401 
In¡Li¡It
 
wb_š¡_™
 = 
wr™eback
.
	`begš
();

1402 
In¡Li¡It
 
wb_’d_™
 = 
wr™eback
.
	`’d
();

1403 
š¡_num
 = 0;

1404 
cÚsum”_š¡s
 = 0;

1406 ; 
š¡_num
 < 
wb_width
 &&

1407 
wb_š¡_™
 !ğ
wb_’d_™
; 
š¡_num
++) {

1408 
DynIn¡PŒ
 
š¡
 = (*
wb_š¡_™
);

1415 ià(!
š¡
->
	`isSquashed
()) {

1416 
	`DPRINTF
(
BE
, "Writing back instruction [sn:%lli] PC %#x.\n",

1417 
š¡
->
£qNum
, in¡->
	`»adPC
());

1419 
š¡
->
	`£tCªComm™
();

1420 
š¡
->
	`£tResuÉR—dy
();

1422 ià(
š¡
->
	`isExecu‹d
()) {

1423 
d•’d’ts
 = 
IQ
.
	`wakeD•’d’ts
(
š¡
);

1424 ià(
d•’d’ts
) {

1425 
´oduûr_š¡
[0]++;

1426 
cÚsum”_š¡s
+ğ
d•’d’ts
;

1431 
wr™eback
.
	`”a£
(
wb_š¡_™
++);

1433 
LSQ
.
	`wr™ebackStÜes
();

1434 
cÚsum”_š¡
[0]+ğ
cÚsum”_š¡s
;

1435 
wr™eback_couÁ
[0]+ğ
š¡_num
;

1436 
	}
}

1438 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1439 
boŞ


1440 
	gBackEnd
<
	gIm¶
>::
	$comm™In¡
(
š¡_num
)

1443 
DynIn¡PŒ
 
š¡
 = 
š¡Li¡
.
	`äÚt
();

1446 
	`as£¹
(
š¡
);

1448 ià(!
š¡
->
	`»adyToComm™
())

1449  
çl£
;

1451 
	`DPRINTF
(
BE
, "Tryingo commit instruction [sn:%lli] PC:%#x\n",

1452 
š¡
->
£qNum
, in¡->
	`»adPC
());

1456 ià(!
š¡
->
	`isExecu‹d
()) {

1461 ià(
š¡
->
	`isNÚS³cuÏtive
()) {

1465 ià(
š¡_num
 > 0 || 
LSQ
.
	`hasStÜesToWB
()) {

1466 
	`DPRINTF
(
BE
, "Waiting for‡ll storeso writeback.\n");

1467  
çl£
;

1470 
	`DPRINTF
(
BE
, "Encountered‡ store or‚on-speculative "

1472 
š¡
->
	`»adPC
());

1475 
toIEW
->
nÚS³cSeqNum
 = 
š¡
->
£qNum
;

1479 
š¡
->
	`ş—rCªComm™
();

1483  
çl£
;

1484 } ià(
š¡
->
	`isLßd
()) {

1485 
	`DPRINTF
(
BE
, "[sn:%lli]: Uncached†oad, PC %#x.\n",

1486 
š¡
->
£qNum
, in¡->
	`»adPC
());

1490 
toIEW
->
nÚS³cSeqNum
 = 
š¡
->
£qNum
;

1491 
toIEW
->
unÿched
 = 
Œue
;

1492 
toIEW
->
lqIdx
 = 
š¡
->lqIdx;

1494 
š¡
->
	`ş—rCªComm™
();

1496  
çl£
;

1498 
	`·nic
("Tryingo commit un-executed instruction "

1505 ià(
š¡
->
	`isTh»adSync
())

1508 
	`·nic
("Barrier instructions‡re‚ot handled yet.\n");

1512 
FauÉ
 
š¡_çuÉ
 = 
š¡
->
	`g‘FauÉ
();

1514 ià(
š¡_çuÉ
 !ğ
NoFauÉ
) {

1515 ià(!
š¡
->
	`isNİ
()) {

1516 
	`DPRINTF
(
BE
, "Inst [sn:%lli] PC %#x has‡ fault\n",

1517 
š¡
->
£qNum
, in¡->
	`»adPC
());

1525 
š¡_çuÉ
->
	`švoke
(
th»ad
->
	`g‘XCProxy
());

1535  
çl£
;

1539 ià(
š¡
->
	`isCÚŒŞ
()) {

1543 
ä“d_»gs
 = 0;

1545 
i
 = 0; i < 
š¡
->
	`numDe¡Regs
(); ++i) {

1546 
	`DPRINTF
(
BE
, "Commit„ename map setting„egister %io [sn:%lli]\n",

1547 ()
š¡
->
	`de¡RegIdx
(
i
), in¡->
£qNum
);

1548 
th»ad
->
»ÇmeTabË
[
š¡
->
	`de¡RegIdx
(
i
)] = inst;

1549 ++
ä“d_»gs
;

1552 ià(
š¡
->
ŒaûD©a
) {

1553 
š¡
->
ŒaûD©a
->
	`fš®ize
();

1554 
š¡
->
ŒaûD©a
 = 
NULL
;

1557 
š¡
->
	`ş—rD•’d’ts
();

1559 
äÚtEnd
->
	`addF»eRegs
(
ä“d_»gs
);

1561 
š¡Li¡
.
	`pİ_äÚt
();

1563 --
numIn¡s
;

1564 
ıu
->
numIn¡
++;

1565 
th»ad
->
numIn¡s
++;

1566 ++
th»ad
->
funcExeIn¡
;

1567 
th»ad
->
PC
 = 
š¡
->
	`»adNextPC
();

1568 
	`upd©eComIn¡Sts
(
š¡
);

1571 
toIEW
->
dÚeSeqNum
 = 
š¡
->
£qNum
;

1573 
couÁ
 = 0;

1574 
Addr
 
Şdpc
;

1576 ià(
couÁ
 == 0)

1577 
	`as£¹
(!
th»ad
->
noSquashFromTC
 && !th»ad->
Œ­P’dšg
);

1578 
Şdpc
 = 
th»ad
->
	`»adPC
();

1579 
ıu
->
sy¡em
->
pcEv’tQueue
.
	`£rviû
(

1580 
th»ad
->
	`g‘XCProxy
());

1581 
couÁ
++;

1582 } 
Şdpc
 !ğ
th»ad
->
	`»adPC
());

1583 ià(
couÁ
 > 1) {

1584 
	`DPRINTF
(
BE
, "PC skip functionƒvent, stopping commit\n");

1587  
çl£
;

1589  
Œue
;

1590 
	}
}

1592 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1594 
	gBackEnd
<
	gIm¶
>::
	$comm™In¡s
()

1596 
comm™_width
 = 
comm™Width
 ? comm™Width : 
width
;

1599 
š¡_num
 = 0;

1600 !
š¡Li¡
.
	`em±y
(è&& 
š¡_num
 < 
comm™_width
) {

1601 ià(
š¡Li¡
.
	`äÚt
()->
	`isSquashed
()) {

1602 
	`·nic
("No squashed insts should still be onhe†ist!");

1603 
š¡Li¡
.
	`äÚt
()->
	`ş—rD•’d’ts
();

1604 
š¡Li¡
.
	`pİ_äÚt
();

1608 ià(!
	`comm™In¡
(
š¡_num
++)) {

1612 
n_comm™‹d_di¡
.
	`§m¶e
(
š¡_num
);

1613 
	}
}

1615 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1617 
	gBackEnd
<
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
¢
)

1619 
IQ
.
	`squash
(
¢
);

1620 
LSQ
.
	`squash
(
¢
);

1622 
ä“d_»gs
 = 0;

1623 
In¡Li¡It
 
di¥©ch_’d
 = 
di¥©ch
.
	`’d
();

1624 
In¡Li¡It
 
š¡s_™
 = 
di¥©ch
.
	`’d
();

1625 
š¡s_™
--;

1627 
š¡s_™
 !ğ
di¥©ch_’d
 && (*š¡s_™)->
£qNum
 > 
¢
)

1629 ià((*
š¡s_™
)->
	`isSquashed
()) {

1630 --
š¡s_™
;

1633 
	`DPRINTF
(
BE
, "Squashing instruction on dispatch†ist PC %#x, [sn:%lli].\n",

1634 (*
š¡s_™
)->
	`»adPC
(),

1635 (*
š¡s_™
)->
£qNum
);

1639 (*
š¡s_™
)->
	`£tSquashed
();

1641 (*
š¡s_™
)->
	`£tCªComm™
();

1644 
i
 = 0; i < (*
š¡s_™
)->
	`numDe¡Regs
(); ++i) {

1645 
DynIn¡PŒ
 
´ev_de¡
 = (*
š¡s_™
)->
	`g‘P»vDe¡In¡
(
i
);

1646 
	`DPRINTF
(
BE
, "Commit„ename map setting„egister %io [sn:%lli]\n",

1647 ()(*
š¡s_™
)->
	`de¡RegIdx
(
i
), 
´ev_de¡
);

1648 
»ÇmeTabË
[(*
š¡s_™
)->
	`de¡RegIdx
(
i
)] = 
´ev_de¡
;

1649 ++
ä“d_»gs
;

1652 (*
š¡s_™
)->
	`ş—rD•’d’ts
();

1654 --
š¡s_™
;

1657 
š¡s_™
 = 
š¡Li¡
.
	`’d
();

1658 
š¡s_™
--;

1660 !
š¡Li¡
.
	`em±y
(è&& (*
š¡s_™
)->
£qNum
 > 
¢
)

1662 ià((*
š¡s_™
)->
	`isSquashed
()) {

1663 --
š¡s_™
;

1666 
	`DPRINTF
(
BE
, "Squashing instruction on inst†ist PC %#x, [sn:%lli].\n",

1667 (*
š¡s_™
)->
	`»adPC
(),

1668 (*
š¡s_™
)->
£qNum
);

1672 (*
š¡s_™
)->
	`£tSquashed
();

1674 (*
š¡s_™
)->
	`£tCªComm™
();

1676 
i
 = 0; i < (*
š¡s_™
)->
	`numDe¡Regs
(); ++i) {

1677 
DynIn¡PŒ
 
´ev_de¡
 = (*
š¡s_™
)->
	`g‘P»vDe¡In¡
(
i
);

1678 
	`DPRINTF
(
BE
, "Commit„ename map setting„egister %io [sn:%lli]\n",

1679 ()(*
š¡s_™
)->
	`de¡RegIdx
(
i
), 
´ev_de¡
);

1680 
»ÇmeTabË
[(*
š¡s_™
)->
	`de¡RegIdx
(
i
)] = 
´ev_de¡
;

1681 ++
ä“d_»gs
;

1684 (*
š¡s_™
)->
	`ş—rD•’d’ts
();

1686 
š¡Li¡
.
	`”a£
(
š¡s_™
--);

1687 --
numIn¡s
;

1690 
äÚtEnd
->
	`addF»eRegs
(
ä“d_»gs
);

1691 
	}
}

1693 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1695 
	gBackEnd
<
	gIm¶
>::
	$squashFromXC
()

1697 
xcSquash
 = 
Œue
;

1698 
	}
}

1700 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1702 
	gBackEnd
<
	gIm¶
>::
	$squashDueToB¿nch
(
DynIn¡PŒ
 &
š¡
)

1705 
	`squash
(
š¡
->
£qNum
);

1706 
äÚtEnd
->
	`squash
(
š¡
->
£qNum
, in¡->
	`»adNextPC
(),

1707 
Œue
, 
š¡
->
	`mi¥»diùed
());

1708 
	}
}

1710 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1712 
	gBackEnd
<
	gIm¶
>::
	$squashDueToMemBlocked
(
DynIn¡PŒ
 &
š¡
)

1714 
	`DPRINTF
(
IEW
, "Memory blocked, squashing†oad‡nd younger insts, "

1715 "PC: %#x [¢:%i].\n", 
š¡
->
	`»adPC
(), in¡->
£qNum
);

1717 
	`squash
(
š¡
->
£qNum
 - 1);

1718 
äÚtEnd
->
	`squash
(
š¡
->
£qNum
 - 1, in¡->
	`»adPC
());

1719 
	}
}

1721 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1723 
	gBackEnd
<
	gIm¶
>::
	$ãtchFauÉ
(
FauÉ
 &
çuÉ
)

1725 
çuÉFromF‘ch
 = 
çuÉ
;

1726 
	}
}

1728 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1730 
	gBackEnd
<
	gIm¶
>::
	$upd©eExeIn¡Sts
(
DynIn¡PŒ
 &
š¡
)

1732 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1734 
exe_š¡
[
tid
]++;

1739 ià(
š¡
->
	`isCÚŒŞ
())

1740 
exe_b¿nches
[
tid
]++;

1745 ià(
š¡
->
	`isMemRef
()) {

1746 
exe_»fs
[
tid
]++;

1748 ià(
š¡
->
	`isLßd
())

1749 
exe_lßds
[
tid
]++;

1751 
	}
}

1753 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1755 
	gBackEnd
<
	gIm¶
>::
	$upd©eComIn¡Sts
(
DynIn¡PŒ
 &
š¡
)

1757 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1762 #ifdeà
TARGET_ALPHA


1763 ià(
š¡
->
	`isD©aP»ãtch
()) {

1764 
¡©_com_swp
[
tid
]++;

1766 
¡©_com_š¡
[
tid
]++;

1769 
¡©_com_š¡
[
tid
]++;

1775 ià(
š¡
->
	`isCÚŒŞ
())

1776 
¡©_com_b¿nches
[
tid
]++;

1781 ià(
š¡
->
	`isMemRef
()) {

1782 
¡©_com_»fs
[
tid
]++;

1784 ià(
š¡
->
	`isLßd
()) {

1785 
¡©_com_lßds
[
tid
]++;

1789 ià(
š¡
->
	`isMemB¬r›r
()) {

1790 
¡©_com_memb¬s
[
tid
]++;

1792 
	}
}

1794 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1796 
	gBackEnd
<
	gIm¶
>::
	$dumpIn¡s
()

1798 
num
 = 0;

1799 
v®id_num
 = 0;

1801 
In¡Li¡It
 
š¡_li¡_™
 = 
š¡Li¡
.
	`begš
();

1803 
	`ırštf
("In¡†i¡ size: %i\n", 
š¡Li¡
.
	`size
());

1805 
š¡_li¡_™
 !ğ
š¡Li¡
.
	`’d
())

1807 
	`ırštf
("Instruction:%i\n",

1808 
num
);

1809 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

1810 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

1811 ++
v®id_num
;

1812 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1813 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

1814 !(*
š¡_li¡_™
)->
memOpDÚe
) {

1817 ++
v®id_num
;

1818 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1822 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

1824 (*
š¡_li¡_™
)->
	`»adPC
(),

1825 (*
š¡_li¡_™
)->
£qNum
,

1826 (*
š¡_li¡_™
)->
th»adNumb”
,

1827 (*
š¡_li¡_™
)->
	`isIssued
(),

1828 (*
š¡_li¡_™
)->
	`isSquashed
());

1830 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

1831 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

1834 
	`ırštf
("\n");

1836 
š¡_li¡_™
++;

1837 ++
num
;

1840 
	`ırštf
("Di¥©ch†i¡ size: %i\n", 
di¥©ch
.
	`size
());

1842 
š¡_li¡_™
 = 
di¥©ch
.
	`begš
();

1844 
š¡_li¡_™
 !ğ
di¥©ch
.
	`’d
())

1846 
	`ırštf
("Instruction:%i\n",

1847 
num
);

1848 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

1849 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

1850 ++
v®id_num
;

1851 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1852 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

1853 !(*
š¡_li¡_™
)->
memOpDÚe
) {

1856 ++
v®id_num
;

1857 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1861 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

1863 (*
š¡_li¡_™
)->
	`»adPC
(),

1864 (*
š¡_li¡_™
)->
£qNum
,

1865 (*
š¡_li¡_™
)->
th»adNumb”
,

1866 (*
š¡_li¡_™
)->
	`isIssued
(),

1867 (*
š¡_li¡_™
)->
	`isSquashed
());

1869 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

1870 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

1873 
	`ırštf
("\n");

1875 
š¡_li¡_™
++;

1876 ++
num
;

1879 
	`ırštf
("Wr™eback†i¡ size: %i\n", 
wr™eback
.
	`size
());

1881 
š¡_li¡_™
 = 
wr™eback
.
	`begš
();

1883 
š¡_li¡_™
 !ğ
wr™eback
.
	`’d
())

1885 
	`ırštf
("Instruction:%i\n",

1886 
num
);

1887 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

1888 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

1889 ++
v®id_num
;

1890 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1891 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

1892 !(*
š¡_li¡_™
)->
memOpDÚe
) {

1895 ++
v®id_num
;

1896 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1900 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

1902 (*
š¡_li¡_™
)->
	`»adPC
(),

1903 (*
š¡_li¡_™
)->
£qNum
,

1904 (*
š¡_li¡_™
)->
th»adNumb”
,

1905 (*
š¡_li¡_™
)->
	`isIssued
(),

1906 (*
š¡_li¡_™
)->
	`isSquashed
());

1908 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

1909 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

1912 
	`ırštf
("\n");

1914 
š¡_li¡_™
++;

1915 ++
num
;

1917 
	}
}

	@ozone/base_dyn_inst.cc

31 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

32 
	~"ıu/ba£_dyn_š¡_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gBa£DynIn¡
<
	gOzÚeIm¶
>;

	@ozone/bpred_unit.cc

31 
	~"ıu/o3/b´ed_un™_im¶.hh
"

32 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gBP»dUn™
<
	gOzÚeIm¶
>;

	@ozone/checker_builder.cc

31 
	~<¡ršg
>

33 
	~"ıu/check”/ıu_im¶.hh
"

34 
	~"ıu/ozÚe/dyn_š¡.hh
"

35 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

36 
	~"ıu/š¡_£q.hh
"

37 
	~"·¿ms/OzÚeCheck”.hh
"

38 
	~"sim/´oûss.hh
"

39 
	~"sim/sim_objeù.hh
"

41 
şass
 
	gMemObjeù
;

43 
‹m¶©e


44 
şass
 
	gCheck”
<
	gRefCouÁšgPŒ
<
	gOzÚeDynIn¡
<
	gOzÚeIm¶
> > >;

49 
şass
 
	gOzÚeCheck”
 :

50 
public
 
Check”
<
RefCouÁšgPŒ
<
OzÚeDynIn¡
<
OzÚeIm¶
> > >

52 
public
:

53 
OzÚeCheck”
(
P¬ams
 *
p
)

54 : 
Check”
<
RefCouÁšgPŒ
<
OzÚeDynIn¡
<
OzÚeIm¶
> > >(
p
)

62 
OzÚeCheck”
 *

63 
	gOzÚeCheck”P¬ams
::
	$ü—‹
()

65 
OzÚeCheck”
::
P¬ams
 *
·¿ms
 = 
Ãw
 OzÚeCheck”::
	`P¬ams
();

66 
·¿ms
->
Çme
 =‚ame;

67 
·¿ms
->
numb”OfTh»ads
 = 1;

68 
·¿ms
->
max_š¡s_ªy_th»ad
 = 0;

69 
·¿ms
->
max_š¡s_®l_th»ads
 = 0;

70 
·¿ms
->
max_lßds_ªy_th»ad
 = 0;

71 
·¿ms
->
max_lßds_®l_th»ads
 = 0;

72 
·¿ms
->
ex™OnE¼Ü
 =ƒxitOnError;

73 
·¿ms
->
upd©eOnE¼Ü
 = updateOnError;

74 
·¿ms
->
w¬nOÆyOnLßdE¼Ü
 = warnOnlyOnLoadError;

75 
·¿ms
->
sw™ched_out
 = switched_out;

76 
·¿ms
->
funùiÚT¿û
 = 
funùiÚ_Œaû
;

77 
·¿ms
->
funùiÚT¿ûS¹
 = 
funùiÚ_Œaû_¡¬t
;

78 
·¿ms
->
şock
 = clock;

81 
CouÁ”
 
‹mp
;

82 
‹mp
 = 
max_š¡s_ªy_th»ad
;

83 
‹mp
 = 
max_š¡s_®l_th»ads
;

84 
‹mp
 = 
max_lßds_ªy_th»ad
;

85 
‹mp
 = 
max_lßds_®l_th»ads
;

86 
Tick
 
‹mp2
 = 
´og»ss_š‹rv®
;

87 
‹mp2
++;

88 
·¿ms
->
´og»ss_š‹rv®
 = 0;

90 
·¿ms
->
™b
 = itb;

91 
·¿ms
->
dtb
 = dtb;

92 
·¿ms
->
i§
 = isa;

93 
·¿ms
->
sy¡em
 = system;

94 
·¿ms
->
ıu_id
 = cpu_id;

95 
·¿ms
->
´ofe
 =…rofile;

96 
·¿ms
->
´oûss
 = 
wÜklßd
;

98 
OzÚeCheck”
 *
ıu
 = 
Ãw
 
	`OzÚeCheck”
(
·¿ms
);

99  
ıu
;

100 
	}
}

	@ozone/cpu.cc

32 
	~"ıu/ozÚe/ıu_im¶.hh
"

33 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

37 
‹m¶©e
 
şass
 
	gOzÚeCPU
<
	gOzÚeIm¶
>;

	@ozone/cpu.hh

31 #iâdeà
__CPU_OZONE_CPU_HH__


32 
	#__CPU_OZONE_CPU_HH__


	)

34 
	~<£t
>

36 
	~"¬ch/®pha/b.hh
"

37 
	~"ba£/¡©i¡ics.hh
"

38 
	~"cÚfig/the_i§.hh
"

39 
	~"ıu/ozÚe/»Çme_bË.hh
"

40 
	~"ıu/ozÚe/th»ad_¡©e.hh
"

41 
	~"ıu/ba£.hh
"

42 
	~"ıu/š¡_£q.hh
"

43 
	~"ıu/pc_ev’t.hh
"

44 
	~"ıu/¡©ic_š¡.hh
"

45 
	~"ıu/th»ad_cÚ‹xt.hh
"

46 
	~"ıu/timebuf.hh
"

47 
	~"mem/·ge_bË.hh
"

48 
	~"sim/ev’tq.hh
"

52 
Çme¥aû
 
	gTheISA
 {

53 
Çme¥aû
 
	gK”Ãl
 {

54 
şass
 
	gSti¡ics
;

56 
şass
 
	gTLB
;

59 
şass
 
	gCheckpošt
;

60 
şass
 
	gEndQu›sûEv’t
;

61 
şass
 
	gMemÜyCÚŒŞËr
;

62 
şass
 
	gMemObjeù
;

63 
şass
 
	gProûss
;

64 
şass
 
	gReque¡
;

66 
Çme¥aû
 
	gT¿û
 {

67 
şass
 
	gIn¡RecÜd
;

70 
	g‹m¶©e
 <
	gşass
>

71 
şass
 
	gCheck”
;

81 
	g‹m¶©e
 <
şass
 
	gIm¶
>

82 şas 
	cOzÚeCPU
 : 
public
 
Ba£CPU


84 
´iv©e
:

85 
ty³Çme
 
	tIm¶
::
	tFrÚtEnd
 FrontEnd;

86 
ty³Çme
 
	tIm¶
::
	tBackEnd
 BackEnd;

87 
ty³Çme
 
	tIm¶
::
	tDynIn¡
 DynInst;

88 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

90 
	mTheISA
::
	tFlßtReg
 FloatReg;

91 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

92 
	mTheISA
::
	tMiscReg
 MiscReg;

94 
	mpublic
:

95 şas 
	cOzÚeTC
 : 
public
 
Th»adCÚ‹xt
 {

96 
public
:

97 
OzÚeCPU
<
Im¶
> *
ıu
;

99 
	mOzÚeTh»adS‹
<
	mIm¶
> *
	mth»ad
;

101 
Ba£CPU
 *
g‘CpuPŒ
();

103 
	mTheISA
::
TLB
 *
g‘ITBPŒ
(è{  
ıu
->
™b
; }

105 
	mTheISA
::
TLB
 * 
g‘DTBPŒ
(è{  
ıu
->
dtb
; }

107 
Sy¡em
 *
g‘Sy¡emPŒ
(è{  
	mıu
->
	msy¡em
; }

109 
	mTheISA
::
K”Ãl
::
Sti¡ics
 *
g‘K”ÃlSts
()

110 {  
th»ad
->
g‘K”ÃlSts
(); }

112 
Proûss
 *
g‘ProûssPŒ
(è{  
	mth»ad
->getProcessPtr(); }

114 
	mPÜtProxy
 &
g‘PhysProxy
(è{  
	mth»ad
->getPhysProxy(); }

116 
	mFST¿n¦©šgPÜtProxy
 &
g‘VœtProxy
()

117 {  
	mth»ad
->
g‘VœtProxy
(); }

119 
	mSET¿n¦©šgPÜtProxy
 &
g‘MemProxy
(è{  
	mth»ad
->getMemProxy(); }

121 
Stus
 
¡©us
(ècÚ¡ {  
	mth»ad
->status(); }

123 
£tStus
(
Stus
 
Ãw_¡©us
);

127 
aùiv©e
(
d–ay
 = 1);

130 
su¥’d
();

133 
h®t
();

135 
dumpFuncProfe
();

137 
keOv”From
(
Th»adCÚ‹xt
 *
Şd_cÚ‹xt
);

139 
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
);

141 
£rŸlize
(
¡d
::
o¡»am
 &
os
);

142 
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
);

144 
EndQu›sûEv’t
 *
g‘Qu›sûEv’t
();

146 
Tick
 
»adLa¡Aùiv©e
();

147 
Tick
 
»adLa¡Su¥’d
();

149 
´ofeCË¬
();

150 
´ofeSam¶e
();

152 
th»adId
();

154 
cİyArchRegs
(
Th»adCÚ‹xt
 *
tc
);

156 
ş—rArchRegs
();

158 
ušt64_t
 
»adIÁReg
(
»g_idx
);

160 
FlßtReg
 
»adFlßtReg
(
»g_idx
);

162 
FlßtRegB™s
 
»adFlßtRegB™s
(
»g_idx
);

164 
£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
);

166 
£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
);

168 
£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
);

170 
ušt64_t
 
»adPC
(è{  
	mth»ad
->
	mPC
; }

171 
£tPC
(
Addr
 
v®
);

173 
ušt64_t
 
»adNextPC
(è{  
	mth»ad
->
	mÃxtPC
; }

174 
£tNextPC
(
Addr
 
v®
);

176 
ušt64_t
 
»adNextNPC
()

178 #ià
ISA_HAS_DELAY_SLOT


179 
·nic
("Ozone‚eedso support‚extNPC");

181  
	mth»ad
->
	mÃxtPC
 + (
	mTheISA
::
MachIn¡
);

185 
£tNextNPC
(
ušt64_t
 
v®
)

187 #ià
ISA_HAS_DELAY_SLOT


188 
·nic
("Ozone‚eedso support‚extNPC");

192 
	mpublic
:

194 
MiscReg
 
»adMiscRegNoEfãù
(
misc_»g
);

196 
MiscReg
 
»adMiscReg
(
misc_»g
);

198 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

200 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

202 
»adStCÚdFau»s
()

203 {  
	mth»ad
->
	m¡ÜeCÚdFau»s
; }

205 
£tStCÚdFau»s
(
sc_çu»s
)

206 { 
	mth»ad
->
	m¡ÜeCÚdFau»s
 = 
sc_çu»s
; }

208 
boŞ
 
mis¥ecuÏtšg
(è{  
	mçl£
; }

210 
CouÁ”
 
»adFuncExeIn¡
(è{  
	mth»ad
->
	mfuncExeIn¡
; }

212 
£tFuncExeIn¡
(
CouÁ”
 
Ãw_v®
)

213 { 
	mth»ad
->
	mfuncExeIn¡
 = 
Ãw_v®
; }

217 
OzÚeTC
 
	gozÚeTC
;

219 
Th»adCÚ‹xt
 *
	gtc
;

222 
Th»adCÚ‹xt
 *
	gcheck”TC
;

224 
	gOzÚeTh»adS‹
<
	tIm¶
> 
	tIm¶S‹
;

226 
	g´iv©e
:

228 
OzÚeTh»adS‹
<
Im¶
> 
th»ad
;

230 
	gpublic
:

232 
tick
();

234 #iâdeà
NDEBUG


236 
	gš¡couÁ
;

239 
	g¡d
::
£t
<
In¡SeqNum
> 
¢Li¡
;

240 
	g¡d
::
£t
<
Addr
> 
lockAddrLi¡
;

241 
	g´iv©e
:

242 
TickEv’t
 : 
public
 
Ev’t


244 
OzÚeCPU
 *
ıu
;

245 
	gwidth
;

247 
TickEv’t
(
OzÚeCPU
 *
c
, 
w
);

248 
´oûss
();

249 cÚ¡ *
desütiÚ
() const;

252 
TickEv’t
 
	gtickEv’t
;

255 
	$scheduËTickEv’t
(
d–ay
)

257 ià(
tickEv’t
.
	`squashed
())

258 
tickEv’t
.
	`»scheduË
(
	`curTick
(è+ 
	`ticks
(
d–ay
));

259 ià(!
tickEv’t
.
	`scheduËd
())

260 
tickEv’t
.
	`scheduË
(
	`curTick
(è+ 
	`ticks
(
d–ay
));

261 
	}
}

264 
	$unscheduËTickEv’t
()

266 ià(
tickEv’t
.
	`scheduËd
())

267 
tickEv’t
.
	`squash
();

268 
	}
}

270 
	gpublic
:

271 
	eStus
 {

272 
RuÂšg
,

273 
	gIdË
,

274 
	gSw™chedOut


277 
Stus
 
	g_¡©us
;

279 
	gpublic
:

280 
wakeup
();

282 
	$z”o_fl_64
(
Addr
 
addr
) {

283 
w¬Ãd
 = 0;

284 ià(!
w¬Ãd
) {

285 
	`w¬n
 ("WH64 is‚ot implemented");

286 
w¬Ãd
 = 1;

288 
	}
};

290 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

292 
OzÚeCPU
(
P¬ams
 *
·¿ms
);

294 
	gvœtu®
 ~
OzÚeCPU
();

296 
š™
();

298 
	gpublic
:

299 
Ba£CPU
 *
	$g‘CpuPŒ
(è{  
this
; 
	}
}

301 
sw™chOut
();

302 
sigÇlSw™ched
();

303 
keOv”From
(
Ba£CPU
 *
ŞdCPU
);

305 
	gsw™chCouÁ
;

307 
Addr
 
dbg_vtİhys
(Add¸
addr
);

309 
boŞ
 
	gš‹rv®_¡©s
;

311 
	gTheISA
::
TLB
 *
™b
;

312 
	gTheISA
::
TLB
 *
dtb
;

313 
Sy¡em
 *
	gsy¡em
;

315 
FrÚtEnd
 *
	gäÚtEnd
;

317 
BackEnd
 *
	gbackEnd
;

319 
	g´iv©e
:

320 
Stus
 
	$¡©us
(ècÚ¡ {  
_¡©us
; 
	}
}

321 
	$£tStus
(
Stus
 
Ãw_¡©us
è{ 
_¡©us
 =‚ew_¡©us; 
	}
}

323 
vœtu®
 
aùiv©eCÚ‹xt
(
th»ad_num
, 
d–ay
);

324 
vœtu®
 
su¥’dCÚ‹xt
(
th»ad_num
);

325 
vœtu®
 
d—Îoÿ‹CÚ‹xt
(
th»ad_num
, 
d–ay
);

326 
vœtu®
 
h®tCÚ‹xt
(
th»ad_num
);

329 
vœtu®
 
»gSts
();

330 
vœtu®
 
»£tSts
();

333 
	gpublic
:

334 
CouÁ”
 
numIn¡
;

335 
CouÁ”
 
	g¡¬tNumIn¡
;

337 
vœtu®
 
CouÁ”
 
	$tÙ®In¡ruùiÚs
() const

339  
numIn¡
 - 
¡¬tNumIn¡
;

340 
	}
}

342 
	g´iv©e
:

344 
CouÁ”
 
numLßd
;

345 
CouÁ”
 
	g¡¬tNumLßd
;

348 
	gSts
::
Av”age
 
nÙIdËF¿ùiÚ
;

349 
	gSts
::
FÜmuÏ
 
idËF¿ùiÚ
;

351 
	gpublic
:

352 
vœtu®
 
£rŸlize
(
¡d
::
o¡»am
 &
os
);

353 
vœtu®
 
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
);

355 
	$dem­Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

357 
ıu
->
™b
->
	`dem­
(
vaddr
, 
a¢
);

358 
ıu
->
dtb
->
	`dem­
(
vaddr
, 
a¢
);

359 
	}
}

361 
	$dem­In¡Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

363 
ıu
->
™b
->
	`dem­
(
vaddr
, 
a¢
);

364 
	}
}

366 
	$dem­D©aPage
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

368 
ıu
->
dtb
->
	`dem­
(
vaddr
, 
a¢
);

369 
	}
}

372 
	g‹m¶©e
 <
şass
 
	gT
>

373 
FauÉ
 
	$»ad
(
Reque¡
 *
»q
, 
T
 &
d©a
, 
lßd_idx
)

375  
backEnd
->
	`»ad
(
»q
, 
d©a
, 
lßd_idx
);

376 
	}
}

379 
	g‹m¶©e
 <
şass
 
	gT
>

380 
FauÉ
 
	$wr™e
(
Reque¡
 *
»q
, 
T
 &
d©a
, 
¡Üe_idx
)

382  
backEnd
->
	`wr™e
(
»q
, 
d©a
, 
¡Üe_idx
);

383 
	}
}

385 
	gpublic
:

386 
squashFromTC
();

388 
	$dumpIn¡s
(è{ 
äÚtEnd
->
	`dumpIn¡s
(); 
	}
}

390 
FauÉ
 
hw»i
();

391 
boŞ
 
simP®Check
(
·lFunc
);

392 
´oûssIÁ”ru±s
();

393 
sysÿÎ
(
ušt64_t
 &
ÿÎnum
);

395 
Th»adCÚ‹xt
 *
	$tcBa£
(è{  
tc
; 
	}
}

397 
	sCommSŒuù
 {

398 
In¡SeqNum
 
	gdÚeSeqNum
;

399 
In¡SeqNum
 
	gnÚS³cSeqNum
;

400 
boŞ
 
	gunÿched
;

401 
	glqIdx
;

403 
boŞ
 
	g¡®l
;

406 
In¡SeqNum
 
	gglob®SeqNum
;

408 
	gTimeBufãr
<
	gCommSŒuù
> 
	gcomm
;

410 
boŞ
 
	gdecou¶edFrÚtEnd
;

412 
boŞ
 
	glockFÏg
;

414 
	gSts
::
SÿÏr
 
qu›sûCyşes
;

416 
	gCheck”
<
	gDynIn¡PŒ
> *
	gcheck”
;

	@ozone/cpu_builder.cc

31 
	~<¡ršg
>

33 
	~"ıu/check”/ıu.hh
"

34 
	~"ıu/ozÚe/ıu.hh
"

35 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

36 
	~"ıu/ozÚe/sim¶e_·¿ms.hh
"

37 
	~"ıu/š¡_£q.hh
"

38 
	~"·¿ms/D”ivOzÚeCPU.hh
"

39 
	~"sim/´oûss.hh
"

40 
	~"sim/sim_objeù.hh
"

42 
şass
 
	gD”ivOzÚeCPU
 : 
public
 
OzÚeCPU
<
OzÚeIm¶
>

44 
public
:

45 
D”ivOzÚeCPU
(
Sim¶eP¬ams
 *
p
)

46 : 
OzÚeCPU
<
OzÚeIm¶
>(
p
)

55 
D”ivOzÚeCPU
 *

56 
	gD”ivOzÚeCPUP¬ams
::
	$ü—‹
()

58 
D”ivOzÚeCPU
 *
ıu
;

60 ià(
FuÎSy¡em
) {

62 
Th»adID
 
aùu®_num_th»ads
 = 1;

66 
Th»adID
 
aùu®_num_th»ads
 =

67 
numTh»ads
.
	`isV®id
(è?‚umTh»ad : 
wÜklßd
.
	`size
();

69 ià(
wÜklßd
.
	`size
() == 0) {

70 
	`çl
("Must specify‡t†east one workload!");

74 
Sim¶eP¬ams
 *
·¿ms
 = 
Ãw
 SimpleParams;

76 
·¿ms
->
şock
 = clock;

78 
·¿ms
->
Çme
 =‚ame;

79 
·¿ms
->
numb”OfTh»ads
 = 
aùu®_num_th»ads
;

81 
·¿ms
->
™b
 = itb;

82 
·¿ms
->
dtb
 = dtb;

83 
·¿ms
->
i§
 = isa;

85 
·¿ms
->
sy¡em
 = system;

86 
·¿ms
->
ıu_id
 = cpu_id;

87 
·¿ms
->
´ofe
 =…rofile;

88 
·¿ms
->
do_qu›sû
 = do_quiesce;

89 
·¿ms
->
do_checkpošt_š¡s
 = do_checkpoint_insts;

90 
·¿ms
->
do_¡©i¡ics_š¡s
 = do_statistics_insts;

91 
·¿ms
->
wÜklßd
 = workload;

93 
·¿ms
->
check”
 = checker;

94 
·¿ms
->
max_š¡s_ªy_th»ad
 = max_insts_any_thread;

95 
·¿ms
->
max_š¡s_®l_th»ads
 = max_insts_all_threads;

96 
·¿ms
->
max_lßds_ªy_th»ad
 = max_loads_any_thread;

97 
·¿ms
->
max_lßds_®l_th»ads
 = max_loads_all_threads;

98 
·¿ms
->
´og»ss_š‹rv®
 =…rogress_interval;

105 
·¿ms
->
ÿchePÜts
 = cachePorts;

107 
·¿ms
->
width
 = width;

108 
·¿ms
->
äÚtEndWidth
 = frontEndWidth;

109 
·¿ms
->
äÚtEndL©’cy
 = frontEndLatency;

110 
·¿ms
->
backEndWidth
 = backEndWidth;

111 
·¿ms
->
backEndSquashL©’cy
 = backEndSquashLatency;

112 
·¿ms
->
backEndL©’cy
 = backEndLatency;

113 
·¿ms
->
maxIn¡BufãrSize
 = maxInstBufferSize;

114 
·¿ms
->
numPhysiÿlRegs
 = 
numPhysIÁRegs
 + 
numPhysFlßtRegs
;

115 
·¿ms
->
maxOut¡ªdšgMemOps
 = maxOutstandingMemOps;

117 
·¿ms
->
decodeToF‘chD–ay
 = decodeToFetchDelay;

118 
·¿ms
->
»ÇmeToF‘chD–ay
 =„enameToFetchDelay;

119 
·¿ms
->
›wToF‘chD–ay
 = iewToFetchDelay;

120 
·¿ms
->
comm™ToF‘chD–ay
 = commitToFetchDelay;

121 
·¿ms
->
ãtchWidth
 = fetchWidth;

123 
·¿ms
->
»ÇmeToDecodeD–ay
 =„enameToDecodeDelay;

124 
·¿ms
->
›wToDecodeD–ay
 = iewToDecodeDelay;

125 
·¿ms
->
comm™ToDecodeD–ay
 = commitToDecodeDelay;

126 
·¿ms
->
ãtchToDecodeD–ay
 = fetchToDecodeDelay;

127 
·¿ms
->
decodeWidth
 = decodeWidth;

129 
·¿ms
->
›wToR’ameD–ay
 = iewToRenameDelay;

130 
·¿ms
->
comm™ToR’ameD–ay
 = commitToRenameDelay;

131 
·¿ms
->
decodeToR’ameD–ay
 = decodeToRenameDelay;

132 
·¿ms
->
»ÇmeWidth
 =„enameWidth;

134 
·¿ms
->
comm™ToIEWD–ay
 = commitToIEWDelay;

135 
·¿ms
->
»ÇmeToIEWD–ay
 =„enameToIEWDelay;

136 
·¿ms
->
issueToExecu‹D–ay
 = issueToExecuteDelay;

137 
·¿ms
->
issueWidth
 = issueWidth;

138 
·¿ms
->
execu‹Width
 =ƒxecuteWidth;

139 
·¿ms
->
execu‹IÁWidth
 =ƒxecuteIntWidth;

140 
·¿ms
->
execu‹FlßtWidth
 =ƒxecuteFloatWidth;

141 
·¿ms
->
execu‹B¿nchWidth
 =ƒxecuteBranchWidth;

142 
·¿ms
->
execu‹MemÜyWidth
 =ƒxecuteMemoryWidth;

144 
·¿ms
->
›wToComm™D–ay
 = iewToCommitDelay;

145 
·¿ms
->
»ÇmeToROBD–ay
 =„enameToROBDelay;

146 
·¿ms
->
comm™Width
 = commitWidth;

147 
·¿ms
->
squashWidth
 = squashWidth;

149 
·¿ms
->
´edTy³
 =…redType;

150 
·¿ms
->
loÿlP»diùÜSize
 =†ocalPredictorSize;

151 
·¿ms
->
loÿlCŒB™s
 =†ocalCtrBits;

152 
·¿ms
->
loÿlHi¡ÜyTabËSize
 =†ocalHistoryTableSize;

153 
·¿ms
->
loÿlHi¡ÜyB™s
 =†ocalHistoryBits;

154 
·¿ms
->
glob®P»diùÜSize
 = globalPredictorSize;

155 
·¿ms
->
glob®CŒB™s
 = globalCtrBits;

156 
·¿ms
->
glob®Hi¡ÜyB™s
 = globalHistoryBits;

157 
·¿ms
->
choiûP»diùÜSize
 = choicePredictorSize;

158 
·¿ms
->
choiûCŒB™s
 = choiceCtrBits;

160 
·¿ms
->
BTBEÁr›s
 = BTBEntries;

161 
·¿ms
->
BTBTagSize
 = BTBTagSize;

163 
·¿ms
->
RASSize
 = RASSize;

165 
·¿ms
->
LQEÁr›s
 = LQEntries;

166 
·¿ms
->
SQEÁr›s
 = SQEntries;

167 
·¿ms
->
lsqLim™s
 =†sqLimits;

169 
·¿ms
->
SSITSize
 = SSITSize;

170 
·¿ms
->
LFSTSize
 = LFSTSize;

172 
·¿ms
->
numPhysIÁRegs
 =‚umPhysIntRegs;

173 
·¿ms
->
numPhysFlßtRegs
 =‚umPhysFloatRegs;

174 
·¿ms
->
numIQEÁr›s
 =‚umIQEntries;

175 
·¿ms
->
numROBEÁr›s
 =‚umROBEntries;

177 
·¿ms
->
decou¶edFrÚtEnd
 = decoupledFrontEnd;

178 
·¿ms
->
di¥©chWidth
 = dispatchWidth;

179 
·¿ms
->
wbWidth
 = wbWidth;

181 
·¿ms
->
smtNumF‘chšgTh»ads
 = smtNumFetchingThreads;

182 
·¿ms
->
smtF‘chPŞicy
 = smtFetchPolicy;

183 
·¿ms
->
smtIQPŞicy
 = smtIQPolicy;

184 
·¿ms
->
smtLSQPŞicy
 = smtLSQPolicy;

185 
·¿ms
->
smtLSQTh»shŞd
 = smtLSQThreshold;

186 
·¿ms
->
smtROBPŞicy
 = smtROBPolicy;

187 
·¿ms
->
smtROBTh»shŞd
 = smtROBThreshold;

188 
·¿ms
->
smtComm™PŞicy
 = smtCommitPolicy;

190 
·¿ms
->
š¡ShiáAmt
 = 2;

192 
·¿ms
->
sw™ched_out
 = switched_out;

194 
·¿ms
->
funùiÚT¿û
 = 
funùiÚ_Œaû
;

195 
·¿ms
->
funùiÚT¿ûS¹
 = 
funùiÚ_Œaû_¡¬t
;

197 
ıu
 = 
Ãw
 
	`D”ivOzÚeCPU
(
·¿ms
);

199  
ıu
;

200 
	}
}

	@ozone/cpu_impl.hh

33 #iâdeà
__CPU_OZONE_CPU_IMPL_HH__


34 
	#__CPU_OZONE_CPU_IMPL_HH__


	)

36 
	~"¬ch/®pha/oså®.hh
"

37 
	~"¬ch/i§_Œa™s.hh
"

38 
	~"¬ch/k”Ãl_¡©s.hh
"

39 
	~"¬ch/b.hh
"

40 
	~"¬ch/ty³s.hh
"

41 
	~"¬ch/vtİhys.hh
"

42 
	~"ba£/ÿÎback.hh
"

43 
	~"ba£/Œaû.hh
"

44 
	~"cÚfig/the_i§.hh
"

45 
	~"ıu/check”/th»ad_cÚ‹xt.hh
"

46 
	~"ıu/ozÚe/ıu.hh
"

47 
	~"ıu/ba£.hh
"

48 
	~"ıu/ex‘¿û.hh
"

49 
	~"ıu/´ofe.hh
"

50 
	~"ıu/qu›sû_ev’t.hh
"

51 
	~"ıu/sim¶e_th»ad.hh
"

52 
	~"ıu/¡©ic_š¡.hh
"

53 
	~"ıu/th»ad_cÚ‹xt.hh
"

54 
	~"sim/çuÉs.hh
"

55 
	~"sim/fuÎ_sy¡em.hh
"

56 
	~"sim/´oûss.hh
"

57 
	~"sim/sim_ev’ts.hh
"

58 
	~"sim/sim_ex™.hh
"

59 
	~"sim/sim_objeù.hh
"

60 
	~"sim/¡©s.hh
"

61 
	~"sim/sy¡em.hh
"

63 
usšg
 
Çme¥aû
 
	gTheISA
;

65 
	g‹m¶©e
 <
şass
 
	gIm¶
>

66 
	gOzÚeCPU
<
	gIm¶
>::
TickEv’t
::
	$TickEv’t
(
OzÚeCPU
 *
c
, 
w
)

67 : 
	`Ev’t
(&
mašEv’tQueue
, 
CPU_Tick_Pri
), 
	`ıu
(
c
), 
	$width
(
w
)

69 
	}
}

71 
	g‹m¶©e
 <
şass
 
	gIm¶
>

73 
	gOzÚeCPU
<
	gIm¶
>::
TickEv’t
::
	$´oûss
()

75 
ıu
->
	`tick
();

76 
	}
}

78 
	g‹m¶©e
 <
şass
 
	gIm¶
>

80 
	gOzÚeCPU
<
	gIm¶
>::
TickEv’t
::
	$desütiÚ
() const

83 
	}
}

85 
	g‹m¶©e
 <
şass
 
	gIm¶
>

86 
	gOzÚeCPU
<
	gIm¶
>::
	$OzÚeCPU
(
P¬ams
 *
p
)

87 : 
	`Ba£CPU
(
p
), 
	`th»ad
(
this
, 0,…->
wÜklßd
[0], 0), 
	`tickEv’t
(this,

88 
p
->
width
),

89 #iâdeà
NDEBUG


90 
	`š¡couÁ
(0),

92 
	$comm
(5, 5)

94 
äÚtEnd
 = 
Ãw
 
	`FrÚtEnd
(
p
);

95 
backEnd
 = 
Ãw
 
	`BackEnd
(
p
);

97 
_¡©us
 = 
IdË
;

99 ià(
p
->
check”
) {

100 
Ba£CPU
 *
‹mp_check”
 = 
p
->
check”
;

101 
check”
 = 
dyÇmic_ÿ¡
<
Check”
<
DynIn¡PŒ
> *>(
‹mp_check”
);

102 
check”
->
	`£tSy¡em
(
p
->
sy¡em
);

103 
check”TC
 = 
Ãw
 
Check”Th»adCÚ‹xt
<
OzÚeTC
>(&
ozÚeTC
, 
check”
);

104 
th»ad
.
tc
 = 
check”TC
;

105 
tc
 = 
check”TC
;

109 
check”
 = 
NULL
;

110 
th»ad
.
tc
 = &
ozÚeTC
;

111 
tc
 = &
ozÚeTC
;

114 
ozÚeTC
.
ıu
 = 
this
;

115 
ozÚeTC
.
th»ad
 = &thread;

117 
th»ad
.
noSquashFromTC
 = 
çl£
;

119 
™b
 = 
p
->itb;

120 
dtb
 = 
p
->dtb;

122 ià(
FuÎSy¡em
) {

124 
th»ad
.
ıu
 = 
this
;

125 
th»ad
.
	`£tTid
(0);

127 
th»ad
.
qu›sûEv’t
 = 
Ãw
 
	`EndQu›sûEv’t
(
tc
);

129 
sy¡em
 = 
p
->system;

130 
physmem
 = 
p
->
sy¡em
->physmem;

132 ià(
p
->
´ofe
) {

133 
th»ad
.
´ofe
 = 
Ãw
 
	`FunùiÚProfe
(
p
->
sy¡em
->
k”ÃlSymb
);

136 
C®lback
 *
cb
 =

137 
Ãw
 
MakeC®lback
<
OzÚeTC
,

138 &
OzÚeTC
::
dumpFuncProfe
>(&
ozÚeTC
);

139 
	`»gi¡”Ex™C®lback
(
cb
);

144 
ProfeNode
 
dummyNode
;

145 
th»ad
.
´ofeNode
 = &
dummyNode
;

146 
th»ad
.
´ofePC
 = 3;

148 
th»ad
.
ıu
 = 
this
;

151 
numIn¡
 = 0;

152 
¡¬tNumIn¡
 = 0;

154 
th»adCÚ‹xts
.
	`push_back
(
tc
);

156 
äÚtEnd
->
	`£tCPU
(
this
);

157 
backEnd
->
	`£tCPU
(
this
);

159 
äÚtEnd
->
	`£tTC
(
tc
);

160 
backEnd
->
	`£tTC
(
tc
);

162 
äÚtEnd
->
	`£tTh»adS‹
(&
th»ad
);

163 
backEnd
->
	`£tTh»adS‹
(&
th»ad
);

165 
äÚtEnd
->
	`£tCommBufãr
(&
comm
);

166 
backEnd
->
	`£tCommBufãr
(&
comm
);

168 
äÚtEnd
->
	`£tBackEnd
(
backEnd
);

169 
backEnd
->
	`£tFrÚtEnd
(
äÚtEnd
);

171 
glob®SeqNum
 = 1;

173 
lockFÏg
 = 0;

176 
i
 = 0; i < 
TheISA
::
TÙ®NumRegs
; ++i) {

177 
th»ad
.
»ÇmeTabË
[
i
] = 
Ãw
 
	`DynIn¡
(
this
);

178 
th»ad
.
»ÇmeTabË
[
i
]->
	`£tResuÉR—dy
();

181 
äÚtEnd
->
»ÇmeTabË
.
	`cİyFrom
(
th»ad
.renameTable);

182 
backEnd
->
»ÇmeTabË
.
	`cİyFrom
(
th»ad
.renameTable);

184 
th»ad
.
	`cÚÃùMemPÜts
(
tc
);

186 
	`DPRINTF
(
OzÚeCPU
, "OzoneCPU: Created Ozone cpu object.\n");

187 
	}
}

189 
	g‹m¶©e
 <
şass
 
	gIm¶
>

190 
	gOzÚeCPU
<
	gIm¶
>::~
	$OzÚeCPU
()

192 
	}
}

194 
‹m¶©e
 <
şass
 
Im¶
>

196 
OzÚeCPU
<
Im¶
>::
	$sw™chOut
()

198 
Ba£CPU
::
	`sw™chOut
();

199 
sw™chCouÁ
 = 0;

201 
backEnd
->
	`sw™chOut
();

202 
äÚtEnd
->
	`sw™chOut
();

203 
	}
}

205 
	g‹m¶©e
 <
şass
 
	gIm¶
>

207 
	gOzÚeCPU
<
	gIm¶
>::
	$sigÇlSw™ched
()

211 ià(++
sw™chCouÁ
 == 2) {

212 
backEnd
->
	`doSw™chOut
();

213 
äÚtEnd
->
	`doSw™chOut
();

215 ià(
check”
)

216 
check”
->
	`sw™chOut
();

218 
_¡©us
 = 
Sw™chedOut
;

219 #iâdeà
NDEBUG


221 
i
 = 0; i < 
AÍhaISA
::
TÙ®NumRegs
; ++i) {

222 
	`as£¹
(
th»ad
.
»ÇmeTabË
[
i
] =ğ
äÚtEnd
->renameTable[i]);

224 
	`as£¹
(
th»ad
.
»ÇmeTabË
[
i
] =ğ
backEnd
->renameTable[i]);

226 
	`DPRINTF
(
OzÚeCPU
, "Checkšg ià»gi¡” %˜m©ches.\n", 
i
);

230 ià(
tickEv’t
.
	`scheduËd
())

231 
tickEv’t
.
	`squash
();

233 
	`as£¹
(
sw™chCouÁ
 <= 2);

234 
	}
}

236 
	g‹m¶©e
 <
şass
 
	gIm¶
>

238 
	gOzÚeCPU
<
	gIm¶
>::
	$keOv”From
(
Ba£CPU
 *
ŞdCPU
)

240 
Ba£CPU
::
	`keOv”From
(
ŞdCPU
);

242 
th»ad
.
Œ­P’dšg
 = 
çl£
;

243 
th»ad
.
noSquashFromTC
 = 
çl£
;

245 
backEnd
->
	`keOv”From
();

246 
äÚtEnd
->
	`keOv”From
();

247 
äÚtEnd
->
»ÇmeTabË
.
	`cİyFrom
(
th»ad
.renameTable);

248 
backEnd
->
»ÇmeTabË
.
	`cİyFrom
(
th»ad
.renameTable);

249 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

251 #iâdeà
NDEBUG


253 
i
 = 0; i < 
TheISA
::
TÙ®NumRegs
; ++i) {

254 
	`as£¹
(
th»ad
.
»ÇmeTabË
[
i
]->
	`isResuÉR—dy
());

260 
i
 = 0; i < 15; ++i) {

261 
comm
.
	`advªû
();

266 
i
 = 0; i < 
th»adCÚ‹xts
.
	`size
(); ++i) {

267 
Th»adCÚ‹xt
 *
tc
 = 
th»adCÚ‹xts
[
i
];

268 ià(
tc
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
 &&

269 
_¡©us
 !ğ
RuÂšg
) {

270 
_¡©us
 = 
RuÂšg
;

271 
tickEv’t
.
	`scheduË
(
	`curTick
());

276 ià(
_¡©us
 =ğ
Sw™chedOut
) {

277 
_¡©us
 = 
IdË
;

279 
	}
}

281 
	g‹m¶©e
 <
şass
 
	gIm¶
>

283 
	gOzÚeCPU
<
	gIm¶
>::
	$aùiv©eCÚ‹xt
(
th»ad_num
, 
d–ay
)

286 
	`as£¹
(
th»ad_num
 == 0);

288 
	`as£¹
(
_¡©us
 =ğ
IdË
);

289 
nÙIdËF¿ùiÚ
 = 1;

290 
	`scheduËTickEv’t
(
d–ay
);

291 
_¡©us
 = 
RuÂšg
;

292 ià(
th»ad
.
qu›sûEv’t
 &&h»ad.qu›sûEv’t->
	`scheduËd
())

293 
th»ad
.
qu›sûEv’t
->
	`descheduË
();

294 
th»ad
.
	`£tStus
(
Th»adCÚ‹xt
::
Aùive
);

295 
äÚtEnd
->
	`wakeFromQu›sû
();

296 
	}
}

298 
	g‹m¶©e
 <
şass
 
	gIm¶
>

300 
	gOzÚeCPU
<
	gIm¶
>::
	$su¥’dCÚ‹xt
(
th»ad_num
)

303 
	`as£¹
(
th»ad_num
 == 0);

307 
nÙIdËF¿ùiÚ
 = 0;

308 
	`unscheduËTickEv’t
();

309 
_¡©us
 = 
IdË
;

310 
	}
}

312 
	g‹m¶©e
 <
şass
 
	gIm¶
>

314 
	gOzÚeCPU
<
	gIm¶
>::
	$d—Îoÿ‹CÚ‹xt
(
th»ad_num
, 
d–ay
)

317 
	`su¥’dCÚ‹xt
(
th»ad_num
);

318 
	}
}

320 
	g‹m¶©e
 <
şass
 
	gIm¶
>

322 
	gOzÚeCPU
<
	gIm¶
>::
	$h®tCÚ‹xt
(
th»ad_num
)

325 
	`su¥’dCÚ‹xt
(
th»ad_num
);

326 
	}
}

328 
	g‹m¶©e
 <
şass
 
	gIm¶
>

330 
	gOzÚeCPU
<
	gIm¶
>::
	$»gSts
()

332 
usšg
 
Çme¥aû
 
Sts
;

334 
Ba£CPU
::
	`»gSts
();

336 
th»ad
.
numIn¡s


337 .
	`Çme
(name() + ".num_insts")

338 .
	`desc
("Number of instructionsƒxecuted")

341 
th»ad
.
numMemRefs


342 .
	`Çme
(name() + ".num_refs")

343 .
	`desc
("Number of memory„eferences")

346 
nÙIdËF¿ùiÚ


347 .
	`Çme
(name() + ".not_idle_fraction")

348 .
	`desc
("Percentage of‚on-idle cycles")

351 
idËF¿ùiÚ


352 .
	`Çme
(name() + ".idle_fraction")

353 .
	`desc
("Percentage of idle cycles")

356 
qu›sûCyşes


357 .
	`Çme
(name() + ".quiesce_cycles")

358 .
	`desc
("Number of cycles spent in quiesce")

361 
idËF¿ùiÚ
 = 
	`cÚ¡ªt
(1.0è- 
nÙIdËF¿ùiÚ
;

363 
äÚtEnd
->
	`»gSts
();

364 
backEnd
->
	`»gSts
();

365 
	}
}

367 
	g‹m¶©e
 <
şass
 
	gIm¶
>

369 
	gOzÚeCPU
<
	gIm¶
>::
	$»£tSts
()

372 
nÙIdËF¿ùiÚ
 = (
_¡©us
 !ğ
IdË
);

373 
	}
}

375 
	g‹m¶©e
 <
şass
 
	gIm¶
>

377 
	gOzÚeCPU
<
	gIm¶
>::
	$š™
()

379 
Ba£CPU
::
	`š™
();

382 
th»ad
.
noSquashFromTC
 = 
Œue
;

383 ià(
FuÎSy¡em
) {

384 
i
 = 0; i < 
th»adCÚ‹xts
.
	`size
(); ++i) {

385 
Th»adCÚ‹xt
 *
tc
 = 
th»adCÚ‹xts
[
i
];

388 
TheISA
::
	`š™CPU
(
tc
,c->
	`cÚ‹xtId
());

391 
äÚtEnd
->
»ÇmeTabË
.
	`cİyFrom
(
th»ad
.renameTable);

392 
backEnd
->
»ÇmeTabË
.
	`cİyFrom
(
th»ad
.renameTable);

394 
th»ad
.
noSquashFromTC
 = 
çl£
;

395 
	}
}

397 
	g‹m¶©e
 <
şass
 
	gIm¶
>

399 
	gOzÚeCPU
<
	gIm¶
>::
£rŸlize
(
¡d
::
o¡»am
 &
os
)

401 
Ba£CPU
::
£rŸlize
(
os
);

402 
SERIALIZE_ENUM
(
_¡©us
);

403 
ÇmeOut
(
os
, 
c¥rštf
("%s.tc", 
Çme
()));

404 
	gozÚeTC
.
£rŸlize
(
os
);

405 
ÇmeOut
(
os
, 
c¥rštf
("%s.tickEv’t", 
Çme
()));

406 
	gtickEv’t
.
£rŸlize
(
os
);

411 
Sim¶eTh»ad
 
	g‹mp
;

413 
ÇmeOut
(
os
, 
c¥rštf
("%s.xc.0", 
Çme
()));

414 
	g‹mp
.
cİyTC
(
th»ad
.
g‘TC
());

415 
	g‹mp
.
£rŸlize
(
os
);

418 
	g‹m¶©e
 <
şass
 
	gIm¶
>

420 
	gOzÚeCPU
<
	gIm¶
>::
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
)

422 
Ba£CPU
::
un£rŸlize
(
ı
, 
£ùiÚ
);

423 
UNSERIALIZE_ENUM
(
_¡©us
);

424 
	gozÚeTC
.
un£rŸlize
(
ı
, 
c¥rštf
("%s.tc", 
£ùiÚ
));

425 
	gtickEv’t
.
un£rŸlize
(
ı
, 
c¥rštf
("%s.tickEv’t", 
£ùiÚ
));

430 
Sim¶eTh»ad
 
	g‹mp
;

432 
	g‹mp
.
cİyTC
(
th»ad
.
g‘TC
());

433 
	g‹mp
.
un£rŸlize
(
ı
, 
c¥rštf
("%s.xc.0", 
£ùiÚ
));

434 
	gth»ad
.
g‘TC
()->
cİyArchRegs
(
‹mp
.getTC());

437 
	g‹m¶©e
 <
şass
 
	gIm¶
>

438 
Addr


439 
	gOzÚeCPU
<
	gIm¶
>::
	$dbg_vtİhys
(
Addr
 
addr
)

441  
	`vtİhys
(
tc
, 
addr
);

442 
	}
}

444 
	g‹m¶©e
 <
şass
 
	gIm¶
>

446 
	gOzÚeCPU
<
	gIm¶
>::
	$wakeup
()

448 ià(
_¡©us
 =ğ
IdË
) {

449 
	`DPRINTF
(
IPI
,"Suspended Processor‡woke\n");

452 
	`aùiv©eCÚ‹xt
(
th»ad
.
	`th»adId
(), 1);

454 
	}
}

457 
	g‹m¶©e
 <
şass
 
	gIm¶
>

459 
	gOzÚeCPU
<
	gIm¶
>::
	$tick
()

461 
	`DPRINTF
(
OzÚeCPU
, "\n\nOzoneCPU: Ticking cpu.\n");

463 
_¡©us
 = 
RuÂšg
;

464 
th»ad
.
»ÇmeTabË
[
Z”oReg
]->
	`£tIÁResuÉ
(0);

465 
th»ad
.
»ÇmeTabË
[
Z”oReg
+
TheISA
::
FP_Reg_Ba£
]->

466 
	`£tDoubËResuÉ
(0.0);

468 
comm
.
	`advªû
();

469 
äÚtEnd
->
	`tick
();

470 
backEnd
->
	`tick
();

473 
comIn¡Ev’tQueue
[0]->
	`£rviûEv’ts
(
numIn¡
);

475 ià(!
tickEv’t
.
	`scheduËd
(è&& 
_¡©us
 =ğ
RuÂšg
)

476 
tickEv’t
.
	`scheduË
(
	`curTick
(è+ 
	`ticks
(1));

477 
	}
}

479 
	g‹m¶©e
 <
şass
 
	gIm¶
>

481 
	gOzÚeCPU
<
	gIm¶
>::
	$squashFromTC
()

483 
th»ad
.
noSquashFromTC
 = 
Œue
;

484 
backEnd
->
	`g’”©eTCEv’t
();

485 
	}
}

487 
	g‹m¶©e
 <
şass
 
	gIm¶
>

489 
	gOzÚeCPU
<
	gIm¶
>::
	$sysÿÎ
(
ušt64_t
 &
ÿÎnum
)

492 
th»ad
.
»ÇmeTabË
.
	`cİyFrom
(
backEnd
->renameTable);

494 
th»ad
.
noSquashFromTC
 = 
Œue
;

496 
th»ad
.
funcExeIn¡
++;

498 
	`DPRINTF
(
OzÚeCPU
, "FuncExeIn¡: %i\n", 
th»ad
.
funcExeIn¡
);

500 
th»ad
.
´oûss
->
	`sysÿÎ
(
ÿÎnum
, 
tc
);

502 
th»ad
.
funcExeIn¡
--;

504 
th»ad
.
noSquashFromTC
 = 
çl£
;

506 
äÚtEnd
->
»ÇmeTabË
.
	`cİyFrom
(
th»ad
.renameTable);

507 
backEnd
->
»ÇmeTabË
.
	`cİyFrom
(
th»ad
.renameTable);

508 
	}
}

510 
	g‹m¶©e
 <
şass
 
	gIm¶
>

511 
FauÉ


512 
	gOzÚeCPU
<
	gIm¶
>::
	$hw»i
()

517 
lockFÏg
 = 
çl£
;

518 
lockAddrLi¡
.
	`ş—r
();

519 
th»ad
.
k”ÃlSts
->
	`hw»i
();

522  
NoFauÉ
;

523 
	}
}

525 
	g‹m¶©e
 <
şass
 
	gIm¶
>

527 
	gOzÚeCPU
<
	gIm¶
>::
	$´oûssIÁ”ru±s
()

535 
FauÉ
 
š‹¼u±
 = 
this
->
š‹¼u±s
->
	`g‘IÁ”ru±
(
th»ad
.
	`g‘TC
());

537 ià(
š‹¼u±
 !ğ
NoFauÉ
) {

538 
this
->
š‹¼u±s
->
	`upd©eIÁrInfo
(
th»ad
.
	`g‘TC
());

539 
š‹¼u±
->
	`švoke
(
th»ad
.
	`g‘TC
());

541 
	}
}

543 
	g‹m¶©e
 <
şass
 
	gIm¶
>

544 
boŞ


545 
	gOzÚeCPU
<
	gIm¶
>::
	$simP®Check
(
·lFunc
)

549 
th»ad
.
k”ÃlSts
->
	`ÿÎ·l
(
·lFunc
, 
tc
);

551 
·lFunc
) {

552 
PAL
::
h®t
:

553 
	`h®tCÚ‹xt
(
th»ad
.
	`th»adId
());

554 ià(--
Sy¡em
::
numSy¡emsRuÂšg
 == 0)

555 
	`ex™SimLoİ
("all cpus halted");

558 
PAL
::
b±
:

559 
PAL
::
bugchk
:

560 ià(
sy¡em
->
	`b»akpošt
())

561  
çl£
;

565  
Œue
;

566 
	}
}

568 
	g‹m¶©e
 <
şass
 
	gIm¶
>

569 
Ba£CPU
 *

570 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$g‘CpuPŒ
()

572  
ıu
;

573 
	}
}

575 
	g‹m¶©e
 <
şass
 
	gIm¶
>

577 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tStus
(
Stus
 
Ãw_¡©us
)

579 
th»ad
->
	`£tStus
(
Ãw_¡©us
);

580 
	}
}

582 
	g‹m¶©e
 <
şass
 
	gIm¶
>

584 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$aùiv©e
(
d–ay
)

586 
ıu
->
	`aùiv©eCÚ‹xt
(
th»ad
->
	`th»adId
(), 
d–ay
);

587 
	}
}

590 
	g‹m¶©e
 <
şass
 
	gIm¶
>

592 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$su¥’d
()

594 
ıu
->
	`su¥’dCÚ‹xt
(
th»ad
->
	`th»adId
());

595 
	}
}

598 
	g‹m¶©e
 <
şass
 
	gIm¶
>

600 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$h®t
()

602 
ıu
->
	`h®tCÚ‹xt
(
th»ad
->
	`th»adId
());

603 
	}
}

605 
	g‹m¶©e
 <
şass
 
	gIm¶
>

607 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$dumpFuncProfe
()

609 
th»ad
->
	`dumpFuncProfe
();

610 
	}
}

612 
	g‹m¶©e
 <
şass
 
	gIm¶
>

614 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$keOv”From
(
Th»adCÚ‹xt
 *
Şd_cÚ‹xt
)

617 
	`as£¹
(
	`g‘Sy¡emPŒ
(è=ğ
Şd_cÚ‹xt
->getSystemPtr());

618 
	`as£¹
(
	`g‘ProûssPŒ
(è=ğ
Şd_cÚ‹xt
->getProcessPtr());

621 
	`£tStus
(
Şd_cÚ‹xt
->
	`¡©us
());

622 
	`cİyArchRegs
(
Şd_cÚ‹xt
);

623 
	`£tCpuId
(
Şd_cÚ‹xt
->
	`ıuId
());

624 
	`£tCÚ‹xtId
(
Şd_cÚ‹xt
->
	`cÚ‹xtId
());

626 
	`£tFuncExeIn¡
(
Şd_cÚ‹xt
->
	`»adFuncExeIn¡
());

627 
EndQu›sûEv’t
 *
Ùh”_qu›sû
 = 
Şd_cÚ‹xt
->
	`g‘Qu›sûEv’t
();

628 ià(
Ùh”_qu›sû
) {

631 
Ùh”_qu›sû
->
tc
 = 
this
;

633 ià(
th»ad
->
qu›sûEv’t
) {

634 
th»ad
->
qu›sûEv’t
->
tc
 = 
this
;

638 
th»ad
->
k”ÃlSts
 = 
Şd_cÚ‹xt
->
	`g‘K”ÃlSts
();

640 
ıu
->
lockFÏg
 = 
çl£
;

643 
Şd_cÚ‹xt
->
	`£tStus
(
Th»adCÚ‹xt
::
H®‹d
);

644 
	}
}

646 
	g‹m¶©e
 <
şass
 
	gIm¶
>

648 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
)

650 ià(
FuÎSy¡em
) {

651 
th»ad
->
k”ÃlSts
 = 
Ãw
 
TheISA
::
K”Ãl
::
Sti¡ics
(
ıu
->
sy¡em
);

652 
	gth»ad
->
	gk”ÃlSts
->
»gSts
(
Çme
 + ".kern");

656 
	g‹m¶©e
 <
şass
 
	gIm¶
>

658 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
£rŸlize
(
¡d
::
o¡»am
 &
os
)

665 
‹m¶©e
 <
şass
 
Im¶
>

667 
OzÚeCPU
<
Im¶
>::
OzÚeTC
::
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
)

670 
‹m¶©e
 <
şass
 
Im¶
>

671 
EndQu›sûEv’t
 *

672 
OzÚeCPU
<
Im¶
>::
OzÚeTC
::
	$g‘Qu›sûEv’t
()

674  
th»ad
->
qu›sûEv’t
;

675 
	}
}

677 
	g‹m¶©e
 <
şass
 
	gIm¶
>

678 
Tick


679 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$»adLa¡Aùiv©e
()

681  
th»ad
->
Ï¡Aùiv©e
;

682 
	}
}

684 
	g‹m¶©e
 <
şass
 
	gIm¶
>

685 
Tick


686 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$»adLa¡Su¥’d
()

688  
th»ad
->
Ï¡Su¥’d
;

689 
	}
}

691 
	g‹m¶©e
 <
şass
 
	gIm¶
>

693 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$´ofeCË¬
()

695 
th»ad
->
	`´ofeCË¬
();

696 
	}
}

698 
	g‹m¶©e
 <
şass
 
	gIm¶
>

700 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$´ofeSam¶e
()

702 
th»ad
->
	`´ofeSam¶e
();

703 
	}
}

705 
	g‹m¶©e
 <
şass
 
	gIm¶
>

707 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$th»adId
()

709  
th»ad
->
	`th»adId
();

710 
	}
}

712 
	g‹m¶©e
 <
şass
 
	gIm¶
>

714 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$cİyArchRegs
(
Th»adCÚ‹xt
 *
tc
)

716 
th»ad
->
PC
 = 
tc
->
	`»adPC
();

717 
th»ad
->
ÃxtPC
 = 
tc
->
	`»adNextPC
();

719 
ıu
->
äÚtEnd
->
	`£tPC
(
th»ad
->
PC
);

720 
ıu
->
äÚtEnd
->
	`£tNextPC
(
th»ad
->
ÃxtPC
);

723 
i
 = 0; i < 
TheISA
::
NumIÁRegs
; ++i) {

729 
th»ad
->
»ÇmeTabË
[
i
]->
	`£tIÁResuÉ
(
tc
->
	`»adIÁReg
(i));

733 
i
 = 0; i < 
TheISA
::
NumFlßtRegs
; ++i) {

734 
å_idx
 = 
i
 + 
TheISA
::
FP_Reg_Ba£
;

735 
th»ad
->
»ÇmeTabË
[
å_idx
]->
	`£tIÁResuÉ
(
tc
->
	`»adFlßtRegB™s
(
i
));

738 
th»ad
->
funcExeIn¡
 = 
tc
->
	`»adFuncExeIn¡
();

742 
	`cİyMiscRegs
(
tc
, 
this
);

743 
	}
}

745 
	g‹m¶©e
 <
şass
 
	gIm¶
>

747 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$ş—rArchRegs
()

749 
	`·nic
("Unimplemented!");

750 
	}
}

752 
	g‹m¶©e
 <
şass
 
	gIm¶
>

753 
ušt64_t


754 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$»adIÁReg
(
»g_idx
)

756  
th»ad
->
»ÇmeTabË
[
»g_idx
]->
	`»adIÁResuÉ
();

757 
	}
}

759 
	g‹m¶©e
 <
şass
 
	gIm¶
>

761 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$»adFlßtReg
(
»g_idx
)

763 
idx
 = 
»g_idx
 + 
TheISA
::
FP_Reg_Ba£
;

764  
th»ad
->
»ÇmeTabË
[
idx
]->
	`»adFlßtResuÉ
();

765 
	}
}

767 
	g‹m¶©e
 <
şass
 
	gIm¶
>

768 
ušt64_t


769 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$»adFlßtRegB™s
(
»g_idx
)

771 
idx
 = 
»g_idx
 + 
TheISA
::
FP_Reg_Ba£
;

772  
th»ad
->
»ÇmeTabË
[
idx
]->
	`»adIÁResuÉ
();

773 
	}
}

775 
	g‹m¶©e
 <
şass
 
	gIm¶
>

776 
CCReg


777 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$»adCCReg
(
»g_idx
)

779  
th»ad
->
»ÇmeTabË
[
»g_idx
]->
	`»adCCResuÉ
();

780 
	}
}

782 
	g‹m¶©e
 <
şass
 
	gIm¶
>

784 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
)

786 
th»ad
->
»ÇmeTabË
[
»g_idx
]->
	`£tIÁResuÉ
(
v®
);

788 ià(!
th»ad
->
noSquashFromTC
) {

789 
ıu
->
	`squashFromTC
();

791 
	}
}

793 
	g‹m¶©e
 <
şass
 
	gIm¶
>

795 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
)

797 
idx
 = 
»g_idx
 + 
TheISA
::
FP_Reg_Ba£
;

799 
th»ad
->
»ÇmeTabË
[
idx
]->
	`£tDoubËResuÉ
(
v®
);

801 ià(!
th»ad
->
noSquashFromTC
) {

802 
ıu
->
	`squashFromTC
();

804 
	}
}

806 
	g‹m¶©e
 <
şass
 
	gIm¶
>

808 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
)

810 
	`·nic
("Unimplemented!");

811 
	}
}

813 
	g‹m¶©e
 <
şass
 
	gIm¶
>

815 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tCCReg
(
»g_idx
, 
CCReg
 
v®
)

817 
th»ad
->
»ÇmeTabË
[
»g_idx
]->
	`£tCCResuÉ
(
v®
);

819 ià(!
th»ad
->
noSquashFromTC
) {

820 
ıu
->
	`squashFromTC
();

822 
	}
}

824 
	g‹m¶©e
 <
şass
 
	gIm¶
>

826 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tPC
(
Addr
 
v®
)

828 
th»ad
->
PC
 = 
v®
;

829 
ıu
->
äÚtEnd
->
	`£tPC
(
v®
);

831 ià(!
th»ad
->
noSquashFromTC
) {

832 
ıu
->
	`squashFromTC
();

834 
	}
}

836 
	g‹m¶©e
 <
şass
 
	gIm¶
>

838 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tNextPC
(
Addr
 
v®
)

840 
th»ad
->
ÃxtPC
 = 
v®
;

841 
ıu
->
äÚtEnd
->
	`£tNextPC
(
v®
);

843 ià(!
th»ad
->
noSquashFromTC
) {

844 
ıu
->
	`squashFromTC
();

846 
	}
}

848 
	g‹m¶©e
 <
şass
 
	gIm¶
>

849 
	gTheISA
::
MiscReg


850 
OzÚeCPU
<
Im¶
>::
OzÚeTC
::
	$»adMiscRegNoEfãù
(
misc_»g
)

852  
th»ad
->
miscRegFe
.
	`»adRegNoEfãù
(
misc_»g
);

853 
	}
}

855 
	g‹m¶©e
 <
şass
 
	gIm¶
>

856 
	gTheISA
::
MiscReg


857 
OzÚeCPU
<
Im¶
>::
OzÚeTC
::
	$»adMiscReg
(
misc_»g
)

859  
th»ad
->
miscRegFe
.
	`»adReg
(
misc_»g
, 
this
);

860 
	}
}

862 
	g‹m¶©e
 <
şass
 
	gIm¶
>

864 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

867 
th»ad
->
miscRegFe
.
	`£tRegNoEfãù
(
misc_»g
, 
v®
);

869 ià(!
th»ad
->
noSquashFromTC
) {

870 
ıu
->
	`squashFromTC
();

872 
	}
}

876 
	g‹m¶©e
 <
şass
 
	gIm¶
>

878 
	gOzÚeCPU
<
	gIm¶
>::
OzÚeTC
::
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

881 
th»ad
->
miscRegFe
.
	`£tReg
(
misc_»g
, 
v®
, 
this
);

883 ià(!
th»ad
->
noSquashFromTC
) {

884 
ıu
->
	`squashFromTC
();

886 
	}
}

	@ozone/dyn_inst.cc

31 
	~"ıu/ozÚe/dyn_š¡_im¶.hh
"

32 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gOzÚeDynIn¡
<
	gOzÚeIm¶
>;

	@ozone/dyn_inst.hh

31 #iâdeà
__CPU_OZONE_DYN_INST_HH__


32 
	#__CPU_OZONE_DYN_INST_HH__


	)

34 
	~<li¡
>

35 
	~<veùÜ
>

37 
	~"¬ch/i§_Œa™s.hh
"

38 
	~"¬ch/ty³s.hh
"

39 
	~"cÚfig/the_i§.hh
"

40 
	~"ıu/ozÚe/ıu.hh
"

41 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

42 
	~"ıu/ba£_dyn_š¡.hh
"

43 
	~"ıu/š¡_£q.hh
"

45 
	g‹m¶©e
 <
şass
 
	gIm¶
>

46 
şass
 
	gOzÚeDynIn¡
 : 
public
 
Ba£DynIn¡
<
Im¶
>

48 
public
:

50 
ty³Çme
 
	tIm¶
::
	tOzÚeCPU
 OzoneCPU;

52 
ty³Çme
 
	tOzÚeCPU
::
	tIm¶S‹
 ImplState;

55 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

57 
	gTheISA
::
	tExtMachIn¡
 ExtMachInst;

58 
	gTheISA
::
	tMachIn¡
 MachInst;

59 
	gTheISA
::
	tFlßtReg
 FloatReg;

60 
	gTheISA
::
	tFlßtRegB™s
 FloatRegBits;

61 
	gTheISA
::
	tMiscReg
 MiscReg;

62 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

68 
	gMaxIn¡SrcRegs
 = 
TheISA
::
MaxIn¡SrcRegs
,

69 
	gMaxIn¡De¡Regs
 = 
TheISA
::
MaxIn¡De¡Regs


72 
OzÚeDynIn¡
(
OzÚeCPU
 *
ıu
);

74 
OzÚeDynIn¡
(
ExtMachIn¡
 
š¡
, 
Addr
 
PC
, Add¸
P»d_PC
,

75 
In¡SeqNum
 
£q_num
, 
OzÚeCPU
 *
ıu
);

77 
OzÚeDynIn¡
(
SticIn¡PŒ
 
š¡
);

79 ~
OzÚeDynIn¡
();

81 
£tSrcIn¡
(
DynIn¡PŒ
 &
ÃwSrcIn¡
, 
»gIdx
)

82 { 
	g¤cIn¡s
[
»gIdx
] = 
ÃwSrcIn¡
; }

84 
boŞ
 
¤cIn¡R—dy
(
»gIdx
);

86 
£tP»vDe¡In¡
(
DynIn¡PŒ
 &
ŞdDe¡In¡
, 
»gIdx
)

87 { 
	g´evDe¡In¡
[
»gIdx
] = 
ŞdDe¡In¡
; }

89 
	gDynIn¡PŒ
 &
g‘P»vDe¡In¡
(
»gIdx
)

90 {  
	g´evDe¡In¡
[
»gIdx
]; }

92 
addD•’d’t
(
DynIn¡PŒ
 &
d•’d’t_š¡
);

94 
	g¡d
::
veùÜ
<
DynIn¡PŒ
> &
g‘D•’d’ts
(è{  
d•’d’ts
; }

95 
	g¡d
::
veùÜ
<
DynIn¡PŒ
> &
g‘MemD•s
(è{  
memD•’d’ts
; }

96 
	g¡d
::
li¡
<
DynIn¡PŒ
> &
g‘MemSrcs
(è{  
¤cMemIn¡s
; }

98 
wakeD•’d’ts
();

100 
wakeMemD•’d’ts
();

102 
addMemD•’d’t
(
DynIn¡PŒ
 &
š¡
è{ 
	gmemD•’d’ts
.
push_back
(inst); }

104 
addSrcMemIn¡
(
DynIn¡PŒ
 &
š¡
è{ 
	g¤cMemIn¡s
.
push_back
(inst); }

106 
m¬kMemIn¡R—dy
(
OzÚeDynIn¡
<
Im¶
> *
š¡
);

110 
boŞ
 
memD•R—dy
(è{  
	g¤cMemIn¡s
.
em±y
(); }

112 
	g´iv©e
:

113 
š™In¡PŒs
();

115 
	g¡d
::
veùÜ
<
DynIn¡PŒ
> 
d•’d’ts
;

117 
	g¡d
::
veùÜ
<
DynIn¡PŒ
> 
memD•’d’ts
;

119 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
¤cMemIn¡s
;

125 
DynIn¡PŒ
 
	g¤cIn¡s
[
MaxIn¡SrcRegs
];

130 
DynIn¡PŒ
 
	g´evDe¡In¡
[
MaxIn¡SrcRegs
];

132 
	gpublic
:

134 
FauÉ
 
š™Ÿ‹Acc
();

136 
FauÉ
 
com¶‘eAcc
(
Pack‘PŒ
 
pkt
);

149 
ušt64_t
 
»adIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

151  
	g¤cIn¡s
[
idx
]->
»adIÁResuÉ
();

154 
FlßtReg
 
»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

156  
	g¤cIn¡s
[
idx
]->
»adFlßtResuÉ
();

159 
FlßtReg
 
»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

161  
	g¤cIn¡s
[
idx
]->
»adFlßtResuÉ
();

164 
FlßtRegB™s
 
»adFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

166  
	g¤cIn¡s
[
idx
]->
»adIÁResuÉ
();

172 
£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

174 
	gBa£DynIn¡
<
	gIm¶
>::
£tIÁReg
(
si
, 
idx
, 
v®
);

177 
£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
)

179 
	gBa£DynIn¡
<
	gIm¶
>::
£tFlßtReg
(
si
, 
idx
, 
v®
);

182 
£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

183 
FlßtRegB™s
 
v®
)

185 
	gBa£DynIn¡
<
	gIm¶
>::
£tFlßtRegB™s
(
si
, 
idx
, 
v®
);

188 
£tIÁResuÉ
(
ušt64_t
 
»suÉ
è{ 
	gthis
->
	gš¡ResuÉ
.
	gš‹g”
 =„esult; }

189 
£tDoubËResuÉ
(
»suÉ
è{ 
	gthis
->
	gš¡ResuÉ
.
	gdbl
 =„esult; }

191 
boŞ
 
¤csR—dy
();

192 
boŞ
 
—SrcsR—dy
();

194 
FauÉ
 
execu‹
();

196 
FauÉ
 
execu‹EAComp
()

197 {  
	gNoFauÉ
; }

199 
FauÉ
 
execu‹MemAcc
()

200 {  
	gthis
->
	g¡©icIn¡
->
memAccIn¡
()->
execu‹
(
this
,his->
ŒaûD©a
); }

202 
ş—rD•’d’ts
();

204 
ş—rMemD•’d’ts
();

206 
	gpublic
:

208 
MiscReg
 
»adMiscRegNoEfãù
(
misc_»g
);

210 
MiscReg
 
»adMiscReg
(
misc_»g
);

212 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

214 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
);

216 
FauÉ
 
hw»i
();

217 
Œ­
(
FauÉ
 
çuÉ
);

218 
boŞ
 
simP®Check
(
·lFunc
);

219 
sysÿÎ
(
ušt64_t
 &
ÿÎnum
);

221 
Li¡It
 
	giqIt
;

222 
boŞ
 
	giqItV®id
;

	@ozone/dyn_inst_impl.hh

31 #iâdeà
__CPU_OZONE_DYN_INST_IMPL_HH__


32 
	#__CPU_OZONE_DYN_INST_IMPL_HH__


	)

34 
	~"cÚfig/the_i§.hh
"

35 
	~"ıu/ozÚe/dyn_š¡.hh
"

36 
	~"k”n/k”Ãl_¡©s.hh
"

37 
	~"sim/çuÉs.hh
"

39 
	g‹m¶©e
 <
şass
 
	gIm¶
>

40 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$OzÚeDynIn¡
(
OzÚeCPU
 *
ıu
)

41 : 
Ba£DynIn¡
<
Im¶
>(0, 0, 0, 0, 
ıu
)

43 
this
->
	`£tResuÉR—dy
();

45 
	`š™In¡PŒs
();

46 
	}
}

48 
	g‹m¶©e
 <
şass
 
	gIm¶
>

49 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$OzÚeDynIn¡
(
SticIn¡PŒ
 
_¡©icIn¡
)

50 : 
Ba£DynIn¡
<
Im¶
>(
_¡©icIn¡
)

52 
	`š™In¡PŒs
();

53 
	}
}

55 
	g‹m¶©e
 <
şass
 
	gIm¶
>

56 
	gOzÚeDynIn¡
<
	gIm¶
>::~
	$OzÚeDynIn¡
()

58 
	`DPRINTF
(
BE
, "[¢:%Îi] de¡ruùÜ c®Ëd\n", 
this
->
£qNum
);

59 
i
 = 0; i < 
this
->
	`numSrcRegs
(); ++i) {

60 
¤cIn¡s
[
i
] = 
NULL
;

63 
i
 = 0; i < 
this
->
	`numDe¡Regs
(); ++i) {

64 
´evDe¡In¡
[
i
] = 
NULL
;

67 
d•’d’ts
.
	`ş—r
();

68 
	}
}

70 
	g‹m¶©e
 <
şass
 
	gIm¶
>

71 
FauÉ


72 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$execu‹
()

77 
boŞ
 
no_squash_äom_TC
 = 
this
->
th»ad
->
noSquashFromTC
;

78 
this
->
th»ad
->
noSquashFromTC
 = 
Œue
;

80 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`execu‹
Ñhis,his->
ŒaûD©a
);

82 
this
->
th»ad
->
noSquashFromTC
 = 
no_squash_äom_TC
;

84  
this
->
çuÉ
;

85 
	}
}

87 
	g‹m¶©e
 <
şass
 
	gIm¶
>

88 
FauÉ


89 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$š™Ÿ‹Acc
()

94 
boŞ
 
no_squash_äom_TC
 = 
this
->
th»ad
->
noSquashFromTC
;

95 
this
->
th»ad
->
noSquashFromTC
 = 
Œue
;

97 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`š™Ÿ‹Acc
Ñhis,his->
ŒaûD©a
);

99 
this
->
th»ad
->
noSquashFromTC
 = 
no_squash_äom_TC
;

101  
this
->
çuÉ
;

102 
	}
}

104 
	g‹m¶©e
 <
şass
 
	gIm¶
>

105 
FauÉ


106 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$com¶‘eAcc
(
Pack‘PŒ
 
pkt
)

108 
this
->
çuÉ
 =his->
¡©icIn¡
->
	`com¶‘eAcc
(
pkt
,his,his->
ŒaûD©a
);

110  
this
->
çuÉ
;

111 
	}
}

113 
	g‹m¶©e
 <
şass
 
	gIm¶
>

114 
boŞ


115 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$¤cIn¡R—dy
(
»gIdx
)

117  
¤cIn¡s
[
»gIdx
]->
	`isResuÉR—dy
();

118 
	}
}

120 
	g‹m¶©e
 <
şass
 
	gIm¶
>

122 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$addD•’d’t
(
DynIn¡PŒ
 &
d•’d’t_š¡
)

124 
d•’d’ts
.
	`push_back
(
d•’d’t_š¡
);

125 
	}
}

127 
	g‹m¶©e
 <
şass
 
	gIm¶
>

129 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$wakeD•’d’ts
()

131 
i
 = 0; i < 
d•’d’ts
.
	`size
(); ++i) {

132 
d•’d’ts
[
i
]->
	`m¬kSrcRegR—dy
();

134 
	}
}

136 
	g‹m¶©e
 <
şass
 
	gIm¶
>

138 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$wakeMemD•’d’ts
()

140 
i
 = 0; i < 
memD•’d’ts
.
	`size
(); ++i) {

141 
memD•’d’ts
[
i
]->
	`m¬kMemIn¡R—dy
(
this
);

143 
	}
}

145 
	g‹m¶©e
 <
şass
 
	gIm¶
>

147 
	gOzÚeDynIn¡
<
	gIm¶
>::
m¬kMemIn¡R—dy
(
OzÚeDynIn¡
<
Im¶
> *
š¡
)

149 
Li¡It
 
mem_™
 = 
¤cMemIn¡s
.
begš
();

150 (*
	gmem_™
è!ğ
š¡
 && 
mem_™
 !ğ
¤cMemIn¡s
.
’d
()) {

151 
mem_™
++;

153 
as£¹
(
mem_™
 !ğ
¤cMemIn¡s
.
’d
());

155 
	g¤cMemIn¡s
.
”a£
(
mem_™
);

158 
	g‹m¶©e
 <
şass
 
	gIm¶
>

160 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$š™In¡PŒs
()

162 
i
 = 0; i < 
MaxIn¡SrcRegs
; ++i) {

163 
¤cIn¡s
[
i
] = 
NULL
;

165 
iqItV®id
 = 
çl£
;

166 
	}
}

168 
	g‹m¶©e
 <
şass
 
	gIm¶
>

169 
boŞ


170 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$¤csR—dy
()

172 
i
 = 0; i < 
this
->
	`numSrcRegs
(); ++i) {

173 ià(!
¤cIn¡s
[
i
]->
	`isResuÉR—dy
())

174  
çl£
;

177  
Œue
;

178 
	}
}

180 
	g‹m¶©e
 <
şass
 
	gIm¶
>

181 
boŞ


182 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$—SrcsR—dy
()

184 
i
 = 1; i < 
this
->
	`numSrcRegs
(); ++i) {

185 ià(!
¤cIn¡s
[
i
]->
	`isResuÉR—dy
())

186  
çl£
;

189  
Œue
;

190 
	}
}

192 
	g‹m¶©e
 <
şass
 
	gIm¶
>

194 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$ş—rD•’d’ts
()

196 
d•’d’ts
.
	`ş—r
();

197 
i
 = 0; i < 
this
->
	`numSrcRegs
(); ++i) {

198 
¤cIn¡s
[
i
] = 
NULL
;

200 
i
 = 0; i < 
this
->
	`numDe¡Regs
(); ++i) {

201 
´evDe¡In¡
[
i
] = 
NULL
;

203 
	}
}

205 
	g‹m¶©e
 <
şass
 
	gIm¶
>

207 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$ş—rMemD•’d’ts
()

209 
memD•’d’ts
.
	`ş—r
();

210 
	}
}

212 
	g‹m¶©e
 <
şass
 
	gIm¶
>

213 
	gTheISA
::
MiscReg


214 
OzÚeDynIn¡
<
Im¶
>::
	$»adMiscRegNoEfãù
(
misc_»g
)

216  
this
->
th»ad
->
	`»adMiscRegNoEfãù
(
misc_»g
);

217 
	}
}

219 
	g‹m¶©e
 <
şass
 
	gIm¶
>

220 
	gTheISA
::
MiscReg


221 
OzÚeDynIn¡
<
Im¶
>::
	$»adMiscReg
(
misc_»g
)

223  
this
->
th»ad
->
	`»adMiscReg
(
misc_»g
);

224 
	}
}

226 
	g‹m¶©e
 <
şass
 
	gIm¶
>

228 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

230 
this
->
	`£tIÁResuÉ
(
v®
);

231 
this
->
th»ad
->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
);

232 
	}
}

234 
	g‹m¶©e
 <
şass
 
	gIm¶
>

236 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

238 
this
->
th»ad
->
	`£tMiscReg
(
misc_»g
, 
v®
);

239 
	}
}

241 
	g‹m¶©e
 <
şass
 
	gIm¶
>

242 
FauÉ


243 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$hw»i
()

245 ià(!(
this
->
	`»adPC
() & 0x3))

246  
Ãw
 
AÍhaISA
::
Unim¶em’‹dOpcodeFauÉ
;

248 
this
->
	`£tNextPC
Ñhis->
th»ad
->
	`»adMiscRegNoEfãù
(
AÍhaISA
::
IPR_EXC_ADDR
));

250 
this
->
ıu
->
	`hw»i
();

253  
NoFauÉ
;

254 
	}
}

256 
	g‹m¶©e
 <
şass
 
	gIm¶
>

258 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$Œ­
(
FauÉ
 
çuÉ
)

260 
çuÉ
->
	`švoke
(
this
->
th»ad
->
	`g‘TC
());

261 
	}
}

263 
	g‹m¶©e
 <
şass
 
	gIm¶
>

264 
boŞ


265 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$simP®Check
(
·lFunc
)

267  
this
->
ıu
->
	`simP®Check
(
·lFunc
);

268 
	}
}

270 
	g‹m¶©e
 <
şass
 
	gIm¶
>

272 
	gOzÚeDynIn¡
<
	gIm¶
>::
	$sysÿÎ
(
ušt64_t
 &
ÿÎnum
)

274 
this
->
ıu
->
	`sysÿÎ
(
ÿÎnum
);

275 
	}
}

	@ozone/ea_list.cc

32 
	~"¬ch/i§_Œa™s.hh
"

33 
	~"ıu/ooo_ıu/—_li¡.hh
"

34 
	~"ıu/š¡_£q.hh
"

37 
	gEALi¡
::
	$addAddr
(cÚ¡ 
In¡SeqNum
 &
Ãw_¢
, cÚ¡ 
Addr
 &
Ãw_—
)

39 
š¡EA
 
	`ÃwEA
(
Ãw_¢
, 
Ãw_—
);

41 
—Li¡
.
	`push_back
(
ÃwEA
);

42 
	}
}

45 
	gEALi¡
::
	$ş—rAddr
(cÚ¡ 
In¡SeqNum
 &
¢_to_ş—r
, cÚ¡ 
Addr
 &
—_to_ş—r
)

47 
—Li¡It
 
li¡_™
 = 
—Li¡
.
	`begš
();

49 
li¡_™
 !ğ
—Li¡
.
	`’d
(è&& (*li¡_™).
fœ¡
 !ğ
¢_to_ş—r
) {

50 
	`as£¹
((*
li¡_™
).
£cÚd
 =ğ
—_to_ş—r
);

52 
	}
}

54 
boŞ


55 
	gEALi¡
::
	$checkCÚæiù
(cÚ¡ 
In¡SeqNum
 &
check_¢
, cÚ¡ 
Addr
 &
check_—
) const

57 cÚ¡ 
cÚ¡EALi¡It
 
li¡_™
 = 
—Li¡
.
	`begš
();

59 
li¡_™
 !ğ
—Li¡
.
	`’d
(è&& (*li¡_™).
fœ¡
 < 
check_¢
) {

60 ià((*
li¡_™
).
£cÚd
 =ğ
check_—
) {

61  
Œue
;

65  
çl£
;

66 
	}
}

69 
	gEALi¡
::
	$ş—r
()

71 
—Li¡
.
	`ş—r
();

72 
	}
}

75 
	gEALi¡
::
	$comm™
(cÚ¡ 
In¡SeqNum
 &
comm™_¢
)

77 !
—Li¡
.
	`em±y
(è&&ƒaLi¡.
	`äÚt
().
fœ¡
 <ğ
comm™_¢
) {

78 
—Li¡
.
	`pİ_äÚt
();

80 
	}
}

	@ozone/ea_list.hh

32 #iâdeà
__CPU_EA_LIST_HH__


33 
	#__CPU_EA_LIST_HH__


	)

35 
	~<li¡
>

36 
	~<ut™y
>

38 
	~"ba£/ty³s.hh
"

39 
	~"ıu/š¡_£q.hh
"

48 şas 
	cEALi¡
 {

49 
	m´iv©e
:

50 
¡d
::
	t·œ
<
	tIn¡SeqNum
, 
	tAddr
> 
	tš¡EA
;

51 
	m¡d
::
	tli¡
<
	tš¡EA
>::
	t™”©Ü
 
	t—Li¡It
;

52 
	m¡d
::
	tli¡
<
	tš¡EA
>::
	tcÚ¡_™”©Ü
 
	tcÚ¡EALi¡It
;

54 
	m¡d
::
li¡
<
š¡EA
> 
—Li¡
;

56 
	mpublic
:

57 
	$EALi¡
() { }

58 ~
	$EALi¡
(è{ 
	}
}

60 
addAddr
(cÚ¡ 
In¡SeqNum
 &
Ãw_¢
, cÚ¡ 
Addr
 &
Ãw_—
);

62 
ş—rAddr
(cÚ¡ 
In¡SeqNum
 &
¢_to_ş—r
, cÚ¡ 
Addr
 &
—_to_ş—r
);

68 
boŞ
 
	$checkCÚæiù
(cÚ¡ 
In¡SeqNum
 &
check_¢
, cÚ¡ 
Addr
 &
check_—
) const;

70 
	`ş—r
();

72 
	`comm™
(cÚ¡ 
In¡SeqNum
 &
comm™_¢
);

73 
	}
};

	@ozone/front_end.cc

31 
	~"ıu/ozÚe/äÚt_’d_im¶.hh
"

32 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gFrÚtEnd
<
	gOzÚeIm¶
>;

	@ozone/front_end.hh

31 #iâdeà
__CPU_OZONE_FRONT_END_HH__


32 
	#__CPU_OZONE_FRONT_END_HH__


	)

34 
	~<deque
>

36 
	~"¬ch/ut™y.hh
"

37 
	~"cÚfig/the_i§.hh
"

38 
	~"ıu/o3/b´ed_un™.hh
"

39 
	~"ıu/ozÚe/»Çme_bË.hh
"

40 
	~"ıu/š¡_£q.hh
"

41 
	~"ıu/timebuf.hh
"

42 
	~"mem/pÜt.hh
"

43 
	~"mem/»que¡.hh
"

44 
	~"sim/ev’tq.hh
"

45 
	~"sim/¡©s.hh
"

47 
şass
 
	gTh»adCÚ‹xt
;

48 
şass
 
	gMemObjeù
;

49 
	g‹m¶©e
 <
	gşass
>

50 
şass
 
	gOzÚeTh»adS‹
;

51 
şass
 
	gPageTabË
;

52 
	g‹m¶©e
 <
	gşass
>

53 
şass
 
	gTimeBufãr
;

55 
	g‹m¶©e
 <
şass
 
	gIm¶
>

56 şas 
	cFrÚtEnd


58 
	mpublic
:

59 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

60 
ty³Çme
 
	tIm¶
::
	tDynIn¡
 DynInst;

61 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

62 
ty³Çme
 
	tIm¶
::
	tCPUTy³
 CPUType;

63 
ty³Çme
 
	tIm¶
::
	tBackEnd
 BackEnd;

65 
ty³Çme
 
	tIm¶
::
	tCPUTy³
::
	tOzÚeTC
 OzoneTC;

66 
ty³Çme
 
	tIm¶
::
	tCPUTy³
::
	tCommSŒuù
 CommStruct;

71 şas 
	cIÿchePÜt
 : 
public
 
Ma¡”PÜt


73 
´Ùeùed
:

75 
FrÚtEnd
<
Im¶
> *
ã
;

77 
	mpublic
:

79 
IÿchePÜt
(
FrÚtEnd
<
Im¶
> *
_ã
)

80 : 
ã
(
_ã
)

83 
´Ùeùed
:

85 
vœtu®
 
Tick
 
»cvAtomic
(
Pack‘PŒ
 
pkt
);

88 
vœtu®
 
»cvFunùiÚ®
(
Pack‘PŒ
 
pkt
);

92 
vœtu®
 
boŞ
 
»cvTimšg
(
Pack‘PŒ
 
pkt
);

95 
vœtu®
 
»cvR‘ry
();

98 
FrÚtEnd
(
P¬ams
 *
·¿ms
);

100 
	g¡d
::
¡ršg
 
	$Çme
() const;

102 
	`£tCPU
(
CPUTy³
 *
ıu_±r
);

104 
	$£tBackEnd
(
BackEnd
 *
back_’d_±r
)

105 { 
backEnd
 = 
back_’d_±r
; 
	}
}

107 
£tCommBufãr
(
TimeBufãr
<
CommSŒuù
> *
_comm
);

109 
£tTC
(
Th»adCÚ‹xt
 *
tc_±r
);

111 
£tTh»adS‹
(
OzÚeTh»adS‹
<
Im¶
> *
th»ad_±r
)

112 { 
	gth»ad
 = 
th»ad_±r
; }

114 
»gSts
();

116 
PÜt
 *
	$g‘IÿchePÜt
(è{  &
iÿchePÜt
; 
	}
}

118 
tick
();

119 
FauÉ
 
ãtchCacheLše
();

120 
´oûssIn¡
(
DynIn¡PŒ
 &
š¡
);

121 
squash
(cÚ¡ 
In¡SeqNum
 &
squash_num
, cÚ¡ 
Addr
 &
Ãxt_PC
,

122 cÚ¡ 
boŞ
 
is_b¿nch
 = 
çl£
, cÚ¡ boŞ 
b¿nch_k’
 = false);

123 
DynIn¡PŒ
 
g‘In¡
();

125 
´oûssCacheCom¶‘iÚ
(
Pack‘PŒ
 
pkt
);

127 
addF»eRegs
(
num_ä“d
);

129 
boŞ
 
	$isEm±y
(è{  
š¡Bufãr
.
	`em±y
(); 
	}
}

131 
sw™chOut
();

133 
doSw™chOut
();

135 
keOv”From
(
Th»adCÚ‹xt
 *
Şd_tc
 = 
NULL
);

137 
boŞ
 
	$isSw™chedOut
(è{  
sw™chedOut
; 
	}
}

139 
boŞ
 
	gsw™chedOut
;

141 
	g´iv©e
:

142 
»cvR‘ry
();

144 
boŞ
 
upd©eStus
();

146 
checkBE
();

147 
DynIn¡PŒ
 
g‘In¡FromCach–še
();

148 
»ÇmeIn¡
(
DynIn¡PŒ
 &
š¡
);

150 
boŞ
 
´oûssB¬r›rs
(
DynIn¡PŒ
 &
š¡
);

152 
hªdËFauÉ
(
FauÉ
 &
çuÉ
);

153 
	gpublic
:

154 
FauÉ
 
	$g‘FauÉ
(è{  
ãtchFauÉ
; 
	}
}

155 
	g´iv©e
:

156 
FauÉ
 
ãtchFauÉ
;

160 
Addr
 
	$iÿcheBlockAlignPC
(
Addr
 
addr
)

162  (
addr
 & ~(
ÿcheBlkMask
));

163 
	}
}

165 
In¡SeqNum
 
	$g‘AndInüem’tIn¡Seq
()

166 {  
ıu
->
glob®SeqNum
++; 
	}
}

168 
	gpublic
:

169 
CPUTy³
 *
ıu
;

171 
BackEnd
 *
	gbackEnd
;

173 
Th»adCÚ‹xt
 *
	gtc
;

175 
	gOzÚeTh»adS‹
<
	gIm¶
> *
	gth»ad
;

177 
	eStus
 {

178 
	gRuÂšg
,

179 
	gIdË
,

180 
	gIÿcheWa™Re¥Ú£
,

181 
	gIÿcheWa™R‘ry
,

182 
	gIÿcheAcûssCom¶‘e
,

183 
	gS”ŸlizeBlocked
,

184 
	gS”ŸlizeCom¶‘e
,

185 
	gR’ameBlocked
,

186 
	gQu›sûP’dšg
,

187 
	gT¿pP’dšg
,

188 
	gBEBlocked


191 
Stus
 
	g¡©us
;

193 
	g´iv©e
:

194 
TimeBufãr
<
CommSŒuù
> *
comm
;

195 
ty³Çme
 
	gTimeBufãr
<
	gCommSŒuù
>::
wœe
 
äomComm™
;

197 
ty³Çme
 
	tIm¶
::
	tB¿nchP»d
 BranchPred;

199 
B¿nchP»d
 
	gb¿nchP»d
;

201 
IÿchePÜt
 
	giÿchePÜt
;

203 
Reque¡PŒ
 
	gmemReq
;

206 
Addr
 
	gÿcheBlkMask
;

208 
	gÿcheBlkSize
;

210 
Addr
 
	gÿcheBlkPC
;

213 
ušt8_t
 *
	gÿcheD©a
;

215 
boŞ
 
	gãtchCacheLšeNextCyşe
;

217 
boŞ
 
	gÿcheBlkV®id
;

219 
boŞ
 
	gÿcheBlocked
;

222 
Pack‘PŒ
 
	g»ŒyPkt
;

224 
	gpublic
:

225 
R’ameTabË
<
Im¶
> 
»ÇmeTabË
;

227 
	g´iv©e
:

228 
Addr
 
PC
;

229 
Addr
 
	gÃxtPC
;

231 
	gpublic
:

232 
	$£tPC
(
Addr
 
v®
è{ 
PC
 = v®; 
	}
}

233 
	$£tNextPC
(
Addr
 
v®
è{ 
ÃxtPC
 = v®; 
	}
}

235 
wakeFromQu›sû
();

237 
dumpIn¡s
();

239 
	g´iv©e
:

240 
TimeBufãr
<> 
numIn¡sR—dy
;

242 
ty³Çme
 
	t¡d
::
	tdeque
<
	tDynIn¡PŒ
> 
	tIn¡Buff
;

243 
ty³Çme
 
	tIn¡Buff
::
	t™”©Ü
 
	tIn¡BuffIt
;

245 
In¡Buff
 
	gãBufãr
;

247 
In¡Buff
 
	gš¡Bufãr
;

249 
	gš¡BufãrSize
;

251 
	gmaxIn¡BufãrSize
;

253 
	gÏ‹ncy
;

255 
	gwidth
;

257 
	gä“Regs
;

259 
	gnumPhysRegs
;

261 
boŞ
 
	g£rŸlizeNext
;

263 
DynIn¡PŒ
 
	gb¬r›rIn¡
;

265 
	gpublic
:

266 
boŞ
 
š‹¼u±P’dšg
;

267 
	g´iv©e
:

275 
Sts
::
SÿÏr
 
iÿcheSÎCyşes
;

277 
	gSts
::
SÿÏr
 
ãtchedIn¡s
;

278 
	gSts
::
SÿÏr
 
ãtchedB¿nches
;

280 
	gSts
::
SÿÏr
 
´ediùedB¿nches
;

282 
	gSts
::
SÿÏr
 
ãtchCyşes
;

284 
	gSts
::
SÿÏr
 
ãtchIdËCyşes
;

286 
	gSts
::
SÿÏr
 
ãtchSquashCyşes
;

290 
	gSts
::
SÿÏr
 
ãtchBlockedCyşes
;

292 
	gSts
::
SÿÏr
 
ãtchedCacheLšes
;

294 
	gSts
::
SÿÏr
 
ãtchIÿcheSquashes
;

296 
	gSts
::
Di¡ributiÚ
 
ãtchNi¢Di¡
;

299 
	gSts
::
FÜmuÏ
 
idËR©e
;

300 
	gSts
::
FÜmuÏ
 
b¿nchR©e
;

301 
	gSts
::
FÜmuÏ
 
ãtchR©e
;

302 
	gSts
::
SÿÏr
 
IFQCouÁ
;

303 
	gSts
::
FÜmuÏ
 
IFQOccu·ncy
;

304 
	gSts
::
FÜmuÏ
 
IFQL©’cy
;

305 
	gSts
::
SÿÏr
 
IFQFcouÁ
;

306 
	gSts
::
FÜmuÏ
 
IFQFuÎR©e
;

308 
	gSts
::
SÿÏr
 
di¥©chCouÁSt
;

309 
	gSts
::
SÿÏr
 
di¥©chedS”Ÿlizšg
;

310 
	gSts
::
SÿÏr
 
di¥©chedTempS”Ÿlizšg
;

311 
	gSts
::
SÿÏr
 
di¥©chS”ŸlizeSÎCyşes
;

312 
	gSts
::
FÜmuÏ
 
di¥©chR©e
;

313 
	gSts
::
FÜmuÏ
 
»gIÁFuÎ
;

314 
	gSts
::
FÜmuÏ
 
»gFpFuÎ
;

	@ozone/front_end_impl.hh

30 #iâdeà
__CPU_OZONE_BACK_END_IMPL_HH__


31 
	#__CPU_OZONE_BACK_END_IMPL_HH__


	)

33 
	~"¬ch/i§_Œa™s.hh
"

34 
	~"¬ch/ut™y.hh
"

35 
	~"ba£/¡©i¡ics.hh
"

36 
	~"cÚfig/the_i§.hh
"

37 
	~"ıu/check”/ıu.hh
"

38 
	~"ıu/ozÚe/äÚt_’d.hh
"

39 
	~"ıu/ex‘¿û.hh
"

40 
	~"ıu/th»ad_cÚ‹xt.hh
"

41 
	~"mem/mem_objeù.hh
"

42 
	~"mem/·ck‘.hh
"

43 
	~"mem/»que¡.hh
"

44 
	~"sim/çuÉs.hh
"

46 
usšg
 
Çme¥aû
 
	gTheISA
;

48 
	g‹m¶©e
<
şass
 
	gIm¶
>

49 
Tick


50 
	gFrÚtEnd
<
	gIm¶
>::
IÿchePÜt
::
	$»cvAtomic
(
Pack‘PŒ
 
pkt
)

52 
	`·nic
("FrontEnd doesn'tƒxpect„ecvAtomic callback!");

53  
	`curTick
();

54 
	}
}

56 
	g‹m¶©e
<
şass
 
	gIm¶
>

58 
	gFrÚtEnd
<
	gIm¶
>::
IÿchePÜt
::
	$»cvFunùiÚ®
(
Pack‘PŒ
 
pkt
)

60 
	`w¬n
("FrontEnd doesn't update state from functional calls");

61 
	}
}

63 
	g‹m¶©e
<
şass
 
	gIm¶
>

64 
boŞ


65 
	gFrÚtEnd
<
	gIm¶
>::
IÿchePÜt
::
	$»cvTimšg
(
Pack‘PŒ
 
pkt
)

67 
ã
->
	`´oûssCacheCom¶‘iÚ
(
pkt
);

68  
Œue
;

69 
	}
}

71 
	g‹m¶©e
<
şass
 
	gIm¶
>

73 
	gFrÚtEnd
<
	gIm¶
>::
IÿchePÜt
::
	$»cvR‘ry
()

75 
ã
->
	`»cvR‘ry
();

76 
	}
}

78 
	g‹m¶©e
 <
şass
 
	gIm¶
>

79 
	gFrÚtEnd
<
	gIm¶
>::
	$FrÚtEnd
(
P¬ams
 *
·¿ms
)

80 : 
	`b¿nchP»d
(
·¿ms
),

81 
	`iÿchePÜt
(
this
),

82 
	`numIn¡sR—dy
(
·¿ms
->
äÚtEndL©’cy
, 0),

83 
	`š¡BufãrSize
(0),

84 
	`maxIn¡BufãrSize
(
·¿ms
->
maxIn¡BufãrSize
),

85 
	`Ï‹ncy
(
·¿ms
->
äÚtEndL©’cy
),

86 
	`width
(
·¿ms
->
äÚtEndWidth
),

87 
	`ä“Regs
(
·¿ms
->
numPhysiÿlRegs
),

88 
	`numPhysRegs
(
·¿ms
->
numPhysiÿlRegs
),

89 
	`£rŸlizeNext
(
çl£
),

90 
	$š‹¼u±P’dšg
(
çl£
)

92 
sw™chedOut
 = 
çl£
;

94 
¡©us
 = 
IdË
;

96 
memReq
 = 
NULL
;

98 
ÿcheBlkSize
 = 64;

100 
	`as£¹
(
	`isPow”Of2
(
ÿcheBlkSize
));

103 
ÿcheBlkMask
 = (
ÿcheBlkSize
 - 1);

106 
ÿcheD©a
 = 
Ãw
 
ušt8_t
[
ÿcheBlkSize
];

108 
ãtchCacheLšeNextCyşe
 = 
Œue
;

110 
ÿcheBlkV®id
 = 
ÿcheBlocked
 = 
çl£
;

112 
»ŒyPkt
 = 
NULL
;

114 
ãtchFauÉ
 = 
NoFauÉ
;

115 
	}
}

117 
	g‹m¶©e
 <
şass
 
	gIm¶
>

118 
	g¡d
::
¡ršg


119 
FrÚtEnd
<
Im¶
>::
	$Çme
() const

121  
ıu
->
	`Çme
() + ".frontend";

122 
	}
}

124 
	g‹m¶©e
 <
şass
 
	gIm¶
>

126 
	gFrÚtEnd
<
	gIm¶
>::
	$£tCPU
(
CPUTy³
 *
ıu_±r
)

128 
ıu
 = 
ıu_±r
;

130 
iÿchePÜt
.
	`£tName
(
this
->
	`Çme
() + "-iport");

132 ià(
ıu
->
check”
) {

133 
ıu
->
check”
->
	`£tIÿchePÜt
(&
iÿchePÜt
);

135 
	}
}

137 
	g‹m¶©e
 <
şass
 
	gIm¶
>

139 
	gFrÚtEnd
<
	gIm¶
>::
£tCommBufãr
(
TimeBufãr
<
CommSŒuù
> *
_comm
)

141 
comm
 = 
_comm
;

143 
	gäomComm™
 = 
comm
->
g‘Wœe
(-1);

146 
	g‹m¶©e
 <
şass
 
	gIm¶
>

148 
	gFrÚtEnd
<
	gIm¶
>::
	$£tTC
(
Th»adCÚ‹xt
 *
tc_±r
)

150 
tc
 = 
tc_±r
;

151 
	}
}

153 
	g‹m¶©e
 <
şass
 
	gIm¶
>

155 
	gFrÚtEnd
<
	gIm¶
>::
	$»gSts
()

157 
iÿcheSÎCyşes


158 .
	`Çme
(name() + ".icacheStallCycles")

159 .
	`desc
("Number of cycles fetch is stalled on‡n Icache miss")

160 .
	`´”eq
(
iÿcheSÎCyşes
);

162 
ãtchedIn¡s


163 .
	`Çme
(name() + ".fetchedInsts")

164 .
	`desc
("Number of instructions fetch has…rocessed")

165 .
	`´”eq
(
ãtchedIn¡s
);

167 
ãtchedB¿nches


168 .
	`Çme
(name() + ".fetchedBranches")

169 .
	`desc
("Number of fetched branches")

170 .
	`´”eq
(
ãtchedB¿nches
);

172 
´ediùedB¿nches


173 .
	`Çme
(name() + ".predictedBranches")

174 .
	`desc
("Number of brancheshat fetch has…redictedaken")

175 .
	`´”eq
(
´ediùedB¿nches
);

177 
ãtchCyşes


178 .
	`Çme
(name() + ".fetchCycles")

179 .
	`desc
("Number of cycles fetch has„un‡nd was‚ot squashing or"

181 .
	`´”eq
(
ãtchCyşes
);

183 
ãtchIdËCyşes


184 .
	`Çme
(name() + ".fetchIdleCycles")

185 .
	`desc
("Number of cycles fetch was idle")

186 .
	`´”eq
(
ãtchIdËCyşes
);

188 
ãtchSquashCyşes


189 .
	`Çme
(name() + ".fetchSquashCycles")

190 .
	`desc
("Number of cycles fetch has spent squashing")

191 .
	`´”eq
(
ãtchSquashCyşes
);

193 
ãtchBlockedCyşes


194 .
	`Çme
(name() + ".fetchBlockedCycles")

195 .
	`desc
("Number of cycles fetch has spent blocked")

196 .
	`´”eq
(
ãtchBlockedCyşes
);

198 
ãtchedCacheLšes


199 .
	`Çme
(name() + ".fetchedCacheLines")

200 .
	`desc
("Number of cache†ines fetched")

201 .
	`´”eq
(
ãtchedCacheLšes
);

203 
ãtchIÿcheSquashes


204 .
	`Çme
(name() + ".fetchIcacheSquashes")

205 .
	`desc
("Number of outstanding Icache misseshat were squashed")

206 .
	`´”eq
(
ãtchIÿcheSquashes
);

208 
ãtchNi¢Di¡


209 .
	`š™
( 0,

210  
width
,

212 .
	`Çme
(name() + ".rateDist")

213 .
	`desc
("Number of instructions fetchedƒach cycle (Total)")

214 .
	`æags
(
Sts
::
pdf
);

216 
idËR©e


217 .
	`Çme
(name() + ".idleRate")

218 .
	`desc
("Percent of cycles fetch was idle")

219 .
	`´”eq
(
idËR©e
);

220 
idËR©e
 = 
ãtchIdËCyşes
 * 100 / 
ıu
->
numCyşes
;

222 
b¿nchR©e


223 .
	`Çme
(name() + ".branchRate")

224 .
	`desc
("Number of branch fetches…er cycle")

225 .
	`æags
(
Sts
::
tÙ®
);

226 
b¿nchR©e
 = 
ãtchedB¿nches
 / 
ıu
->
numCyşes
;

228 
ãtchR©e


229 .
	`Çme
(name() + ".rate")

230 .
	`desc
("Number of inst fetches…er cycle")

231 .
	`æags
(
Sts
::
tÙ®
);

232 
ãtchR©e
 = 
ãtchedIn¡s
 / 
ıu
->
numCyşes
;

234 
IFQCouÁ


235 .
	`Çme
(name() + ".IFQ:count")

236 .
	`desc
("cumulative IFQ occupancy")

239 
IFQFcouÁ


240 .
	`Çme
(name() + ".IFQ:fullCount")

241 .
	`desc
("cumulative IFQ full count")

242 .
	`æags
(
Sts
::
tÙ®
)

245 
IFQOccu·ncy


246 .
	`Çme
(name() + ".IFQ:occupancy")

247 .
	`desc
("avg IFQ occupancy (inst's)")

249 
IFQOccu·ncy
 = 
IFQCouÁ
 / 
ıu
->
numCyşes
;

251 
IFQL©’cy


252 .
	`Çme
(name() + ".IFQ:latency")

253 .
	`desc
("avg IFQ occupant†atency (cycle's)")

254 .
	`æags
(
Sts
::
tÙ®
)

257 
IFQFuÎR©e


258 .
	`Çme
(name() + ".IFQ:fullRate")

259 .
	`desc
("fraction ofime (cycles) IFQ was full")

260 .
	`æags
(
Sts
::
tÙ®
);

262 
IFQFuÎR©e
 = 
IFQFcouÁ
 * 
Sts
::
	`cÚ¡ªt
(100è/ 
ıu
->
numCyşes
;

264 
di¥©chCouÁSt


265 .
	`Çme
(name() + ".DIS:count")

266 .
	`desc
("cumulative count of dispatched insts")

267 .
	`æags
(
Sts
::
tÙ®
)

270 
di¥©chedS”Ÿlizšg


271 .
	`Çme
(name() + ".DIS:serializingInsts")

272 .
	`desc
("count of serializing insts dispatched")

273 .
	`æags
(
Sts
::
tÙ®
)

276 
di¥©chedTempS”Ÿlizšg


277 .
	`Çme
(name() + ".DIS:tempSerializingInsts")

278 .
	`desc
("count ofemporary serializing insts dispatched")

279 .
	`æags
(
Sts
::
tÙ®
)

282 
di¥©chS”ŸlizeSÎCyşes


283 .
	`Çme
(name() + ".DIS:serializeStallCycles")

284 .
	`desc
("count of cycles dispatch stalled for serializing inst")

285 .
	`æags
(
Sts
::
tÙ®
)

288 
di¥©chR©e


289 .
	`Çme
(name() + ".DIS:rate")

290 .
	`desc
("dispatched insts…er cycle")

291 .
	`æags
(
Sts
::
tÙ®
)

293 
di¥©chR©e
 = 
di¥©chCouÁSt
 / 
ıu
->
numCyşes
;

295 
»gIÁFuÎ


296 .
	`Çme
(name() + ".REG:int:full")

297 .
	`desc
("number of cycles wherehere were‚o INT„egisters")

300 
»gFpFuÎ


301 .
	`Çme
(name() + ".REG:fp:full")

302 .
	`desc
("number of cycles wherehere were‚o FP„egisters")

304 
IFQL©’cy
 = 
IFQOccu·ncy
 / 
di¥©chR©e
;

306 
b¿nchP»d
.
	`»gSts
();

307 
	}
}

309 
	g‹m¶©e
 <
şass
 
	gIm¶
>

311 
	gFrÚtEnd
<
	gIm¶
>::
	$tick
()

313 ià(
sw™chedOut
)

316 
š¡s_to_queue
 = 
numIn¡sR—dy
[-
Ï‹ncy
];

317 !
š¡Bufãr
.
	`em±y
(è&& 
š¡s_to_queue
;

318 --
š¡s_to_queue
)

320 
	`DPRINTF
(
FE
, "Transferring instruction [sn:%lli]ohe feBuffer\n",

321 
š¡Bufãr
.
	`äÚt
()->
£qNum
);

322 
ãBufãr
.
	`push_back
(
š¡Bufãr
.
	`äÚt
());

323 
š¡Bufãr
.
	`pİ_äÚt
();

326 
numIn¡sR—dy
.
	`advªû
();

329 ià(
äomComm™
->
dÚeSeqNum
) {

330 
b¿nchP»d
.
	`upd©e
(
äomComm™
->
dÚeSeqNum
, 0);

333 
IFQCouÁ
 +ğ
š¡BufãrSize
;

334 
IFQFcouÁ
 +ğ
š¡BufãrSize
 =ğ
maxIn¡BufãrSize
;

337 ià(
¡©us
 =ğ
IÿcheAcûssCom¶‘e
) {

338 
ÿcheBlkV®id
 = 
Œue
;

340 
¡©us
 = 
RuÂšg
;

343 ià(
ä“Regs
 <= 0)

344 
¡©us
 = 
R’ameBlocked
;

345 
	`checkBE
();

346 } ià(
¡©us
 =ğ
IÿcheWa™Re¥Ú£
 || stu =ğ
IÿcheWa™R‘ry
) {

347 
	`DPRINTF
(
FE
, "Still in Icache wait.\n");

348 
iÿcheSÎCyşes
++;

352 ià(
¡©us
 =ğ
R’ameBlocked
 || stu =ğ
S”ŸlizeBlocked
 ||

353 
¡©us
 =ğ
T¿pP’dšg
 || stu =ğ
BEBlocked
) {

356 
	`DPRINTF
(
FE
, "In blocked status.\n");

358 
ãtchBlockedCyşes
++;

360 ià(
¡©us
 =ğ
S”ŸlizeBlocked
) {

361 
di¥©chS”ŸlizeSÎCyşes
++;

363 
	`upd©eStus
();

365 } ià(
¡©us
 =ğ
Qu›sûP’dšg
) {

366 
	`DPRINTF
(
FE
, "Waiting for quiesceoƒxecute or get squashed.\n");

368 } ià(
¡©us
 !ğ
IÿcheAcûssCom¶‘e
) {

369 ià(
ãtchCacheLšeNextCyşe
) {

370 
FauÉ
 
çuÉ
 = 
	`ãtchCacheLše
();

371 ià(
çuÉ
 !ğ
NoFauÉ
) {

372 
	`hªdËFauÉ
(
çuÉ
);

373 
ãtchFauÉ
 = 
çuÉ
;

376 
ãtchCacheLšeNextCyşe
 = 
çl£
;

379 ià(
¡©us
 =ğ
IÿcheWa™Re¥Ú£
 || stu =ğ
IÿcheWa™R‘ry
) {

385 
ãtchCyşes
++;

387 
num_š¡
 = 0;

392 
num_š¡
 < 
width
 &&

393 
š¡BufãrSize
 < 
maxIn¡BufãrSize
) {

395 
DynIn¡PŒ
 
š¡
 = 
	`g‘In¡FromCach–še
();

397 ià(!
š¡
) {

401 
	`DPRINTF
(
FE
, "Needo get‚ew cache†ine\n");

402 
ãtchCacheLšeNextCyşe
 = 
Œue
;

406 
	`´oûssIn¡
(
š¡
);

408 ià(
¡©us
 =ğ
S”ŸlizeBlocked
) {

414 
š¡Bufãr
.
	`push_back
(
š¡
);

415 ++
š¡BufãrSize
;

416 
numIn¡sR—dy
[0]++;

417 ++
num_š¡
;

419 ià(
š¡
->
	`isQu›sû
()) {

420 
¡©us
 = 
Qu›sûP’dšg
;

424 ià(
š¡
->
	`´edTak’
()) {

427 } ià(
ä“Regs
 <= 0) {

428 
	`DPRINTF
(
FE
, "Ran out of free„egisterso„enameo!\n");

429 
¡©us
 = 
R’ameBlocked
;

431 } ià(
£rŸlizeNext
) {

436 
ãtchNi¢Di¡
.
	`§m¶e
(
num_š¡
);

437 
	`checkBE
();

439 
	`DPRINTF
(
FE
, "Num insts…rocessed: %i, Inst Buffer size: %i, Free "

440 "Reg %i\n", 
num_š¡
, 
š¡BufãrSize
, 
ä“Regs
);

441 
	}
}

443 
	g‹m¶©e
 <
şass
 
	gIm¶
>

444 
FauÉ


445 
	gFrÚtEnd
<
	gIm¶
>::
	$ãtchCacheLše
()

448 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

451 ià(
š‹¼u±P’dšg
 && (
PC
 & 0x3)) {

452  
çuÉ
;

456 
Addr
 
ãtch_PC
 = 
	`iÿcheBlockAlignPC
(
PC
);

458 
	`DPRINTF
(
FE
, "F‘chšg cachlš¡¬tšg‡ˆ%#x.\n", 
ãtch_PC
);

462 
memReq
 = 
Ãw
 
	`Reque¡
(0, 
ãtch_PC
, 
ÿcheBlkSize
, 0,

463 
PC
, 
ıu
->
th»ad
->
	`cÚ‹xtId
());

466 
çuÉ
 = 
ıu
->
™b
->
	`Œª¦©eAtomic
(
memReq
, 
th»ad
, 
çl£
, 
Œue
);

470 ià(
çuÉ
 =ğ
NoFauÉ
) {

472 ià(
ıu
->
sy¡em
->
memù¾
->
	`badaddr
(
memReq
->
·ddr
) ||

473 
memReq
->
	`isUnÿch—bË
()) {

474 
	`DPRINTF
(
FE
, "Fetch: Bad‡ddress %#x (hopefully on‡ "

476 
memReq
->
·ddr
);

477  
TheISA
::
	`g’MachšeCheckFauÉ
();

482 
Pack‘PŒ
 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
memReq
, 
Pack‘
::
R—dReq
);

483 
d©a_pkt
->
	`d©aStic
(
ÿcheD©a
);

485 ià(!
iÿchePÜt
.
	`£ndTimšg
(
d©a_pkt
)) {

486 
	`as£¹
(
»ŒyPkt
 =ğ
NULL
);

487 
	`DPRINTF
(
F‘ch
, "Out of MSHRs!\n");

488 
¡©us
 = 
IÿcheWa™R‘ry
;

489 
»ŒyPkt
 = 
d©a_pkt
;

490 
ÿcheBlocked
 = 
Œue
;

491  
NoFauÉ
;

494 
¡©us
 = 
IÿcheWa™Re¥Ú£
;

499 
ÿcheBlkPC
 = 
ãtch_PC
;

501 ++
ãtchedCacheLšes
;

503 
	`DPRINTF
(
FE
, "Done fetching cache†ine.\n");

505  
çuÉ
;

506 
	}
}

508 
	g‹m¶©e
 <
şass
 
	gIm¶
>

510 
	gFrÚtEnd
<
	gIm¶
>::
	$´oûssIn¡
(
DynIn¡PŒ
 &
š¡
)

512 ià(
	`´oûssB¬r›rs
(
š¡
)) {

516 
Addr
 
š¡_PC
 = 
š¡
->
	`»adPC
();

518 ià(!
š¡
->
	`isCÚŒŞ
()) {

519 
š¡
->
	`£tP»dT¬g
(š¡->
	`»adNextPC
());

521 
ãtchedB¿nches
++;

522 ià(
b¿nchP»d
.
	`´ediù
(
š¡
, 
š¡_PC
, in¡->
th»adNumb”
)) {

523 
´ediùedB¿nches
++;

527 
Addr
 
Ãxt_PC
 = 
š¡
->
	`»adP»dT¬g
();

529 
	`DPRINTF
(
FE
, "[sn:%lli] Predicted‡nd…rocessed inst PC %#x,‚ext PC "

530 "%#x\n", 
š¡
->
£qNum
, 
š¡_PC
, 
Ãxt_PC
);

535 
PC
 = 
Ãxt_PC
;

537 
	`»ÇmeIn¡
(
š¡
);

538 
	}
}

540 
	g‹m¶©e
 <
şass
 
	gIm¶
>

541 
boŞ


542 
	gFrÚtEnd
<
	gIm¶
>::
	$´oûssB¬r›rs
(
DynIn¡PŒ
 &
š¡
)

544 ià(
£rŸlizeNext
) {

545 
š¡
->
	`£tS”ŸlizeBefÜe
();

546 
£rŸlizeNext
 = 
çl£
;

547 } ià(!
š¡
->
	`isS”Ÿlizšg
() &&

548 !
š¡
->
	`isI´Acûss
() &&

549 !
š¡
->
	`isStÜeCÚd™iÚ®
()) {

550  
çl£
;

553 ià((
š¡
->
	`isI´Acûss
(è|| in¡->
	`isS”ŸlizeBefÜe
()) &&

554 !
š¡
->
	`isS”ŸlizeHªdËd
()) {

555 
	`DPRINTF
(
FE
, "Serialize before instructionƒncountered.\n");

557 ià(!
š¡
->
	`isTempS”ŸlizeBefÜe
()) {

558 
di¥©chedS”Ÿlizšg
++;

559 
š¡
->
	`£tS”ŸlizeHªdËd
();

561 
di¥©chedTempS”Ÿlizšg
++;

570 } ià((
š¡
->
	`isStÜeCÚd™iÚ®
(è|| in¡->
	`isS”ŸlizeAá”
())

571 && !
š¡
->
	`isS”ŸlizeHªdËd
()) {

572 
	`DPRINTF
(
FE
, "Serialize‡fter instructionƒncountered.\n");

574 
š¡
->
	`£tS”ŸlizeHªdËd
();

576 
di¥©chedS”Ÿlizšg
++;

578 
£rŸlizeNext
 = 
Œue
;

579  
çl£
;

581  
çl£
;

582 
	}
}

584 
	g‹m¶©e
 <
şass
 
	gIm¶
>

586 
	gFrÚtEnd
<
	gIm¶
>::
	$hªdËFauÉ
(
FauÉ
 &
çuÉ
)

588 
	`DPRINTF
(
FE
, "Fault‡t fetch,elling commit\n");

591 
¡©us
 = 
T¿pP’dšg
;

594 
In¡SeqNum
 
š¡_£q
 = 
	`g‘AndInüem’tIn¡Seq
();

596 
ExtMachIn¡
 
ext_š¡
 = 
TheISA
::
NoİMachIn¡
;

599 
DynIn¡PŒ
 
š¡ruùiÚ
 = 
Ãw
 
	`DynIn¡
(
ext_š¡
, 
PC
,

600 
PC
+(
MachIn¡
),

601 
š¡_£q
, 
ıu
);

602 
š¡ruùiÚ
->
	`£tP»dT¬g
(š¡ruùiÚ->
	`»adNextPC
());

607 
š¡ruùiÚ
->
	`£tTh»adS‹
(
th»ad
);

609 
š¡ruùiÚ
->
ŒaûD©a
 = 
NULL
;

611 
š¡ruùiÚ
->
çuÉ
 = fault;

612 
š¡ruùiÚ
->
	`£tCªIssue
();

613 
š¡Bufãr
.
	`push_back
(
š¡ruùiÚ
);

614 
numIn¡sR—dy
[0]++;

615 ++
š¡BufãrSize
;

616 
	}
}

618 
	g‹m¶©e
 <
şass
 
	gIm¶
>

620 
	gFrÚtEnd
<
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
squash_num
, cÚ¡ 
Addr
 &
Ãxt_PC
,

621 cÚ¡ 
boŞ
 
is_b¿nch
, cÚ¡ boŞ 
b¿nch_k’
)

623 
	`DPRINTF
(
FE
, "Squashing from [sn:%lli], setting PCo %#x\n",

624 
squash_num
, 
Ãxt_PC
);

626 ià(
ãtchFauÉ
 !ğ
NoFauÉ
)

627 
ãtchFauÉ
 = 
NoFauÉ
;

629 !
š¡Bufãr
.
	`em±y
() &&

630 
š¡Bufãr
.
	`back
()->
£qNum
 > 
squash_num
) {

631 
DynIn¡PŒ
 
š¡
 = 
š¡Bufãr
.
	`back
();

633 
	`DPRINTF
(
FE
, "Squashing instruction [sn:%lli] PC %#x\n",

634 
š¡
->
£qNum
, in¡->
	`»adPC
());

636 
š¡
->
	`ş—rD•’d’ts
();

638 
š¡Bufãr
.
	`pİ_back
();

639 --
š¡BufãrSize
;

641 
ä“Regs
+ğ
š¡
->
	`numDe¡Regs
();

644 !
ãBufãr
.
	`em±y
() &&

645 
ãBufãr
.
	`back
()->
£qNum
 > 
squash_num
) {

646 
DynIn¡PŒ
 
š¡
 = 
ãBufãr
.
	`back
();

648 
	`DPRINTF
(
FE
, "Squashing instruction [sn:%lli] PC %#x\n",

649 
š¡
->
£qNum
, in¡->
	`»adPC
());

651 
š¡
->
	`ş—rD•’d’ts
();

653 
ãBufãr
.
	`pİ_back
();

654 --
š¡BufãrSize
;

656 
ä“Regs
+ğ
š¡
->
	`numDe¡Regs
();

660 
»ÇmeTabË
.
	`cİyFrom
(
backEnd
->renameTable);

662 
PC
 = 
Ãxt_PC
;

665 ià(
is_b¿nch
) {

666 
b¿nchP»d
.
	`squash
(
squash_num
, 
Ãxt_PC
, 
b¿nch_k’
, 0);

668 
b¿nchP»d
.
	`squash
(
squash_num
, 0);

672 ià(
¡©us
 =ğ
IÿcheWa™Re¥Ú£
) {

673 
	`DPRINTF
(
FE
, "Squashing outstanding Icache‡ccess.\n");

674 
memReq
 = 
NULL
;

685 
¡©us
 = 
RuÂšg
;

686 
ãtchCacheLšeNextCyşe
 = 
Œue
;

687 
	}
}

689 
	g‹m¶©e
 <
şass
 
	gIm¶
>

690 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


691 
FrÚtEnd
<
Im¶
>::
	$g‘In¡
()

693 ià(
ãBufãr
.
	`em±y
()) {

694  
NULL
;

697 
DynIn¡PŒ
 
š¡
 = 
ãBufãr
.
	`äÚt
();

699 ià(
š¡
->
	`isS”ŸlizeBefÜe
(è|| in¡->
	`isI´Acûss
()) {

700 
	`DPRINTF
(
FE
, "Backƒnd is getting‡ serialize before inst\n");

701 ià(!
backEnd
->
	`robEm±y
()) {

702 
	`DPRINTF
(
FE
, "Rob is‚otƒmpty yet,‚ot„eturning inst\n");

703  
NULL
;

705 
š¡
->
	`ş—rS”ŸlizeBefÜe
();

708 
ãBufãr
.
	`pİ_äÚt
();

710 --
š¡BufãrSize
;

712 
di¥©chCouÁSt
++;

714  
š¡
;

715 
	}
}

717 
	g‹m¶©e
 <
şass
 
	gIm¶
>

719 
	gFrÚtEnd
<
	gIm¶
>::
	$´oûssCacheCom¶‘iÚ
(
Pack‘PŒ
 
pkt
)

721 
	`DPRINTF
(
FE
, "Processing cache completion\n");

724 ià(
¡©us
 !ğ
IÿcheWa™Re¥Ú£
 ||

725 
pkt
->
»q
 !ğ
memReq
 ||

726 
sw™chedOut
) {

727 
	`DPRINTF
(
FE
, "Previous fetch was squashed.\n");

728 
ãtchIÿcheSquashes
++;

729 
d–‘e
 
pkt
->
»q
;

730 
d–‘e
 
pkt
;

734 
¡©us
 = 
IÿcheAcûssCom¶‘e
;

746 
d–‘e
 
pkt
->
»q
;

747 
d–‘e
 
pkt
;

748 
memReq
 = 
NULL
;

749 
	}
}

751 
	g‹m¶©e
 <
şass
 
	gIm¶
>

753 
	gFrÚtEnd
<
	gIm¶
>::
	$addF»eRegs
(
num_ä“d
)

755 ià(
¡©us
 =ğ
R’ameBlocked
 && 
ä“Regs
 + 
num_ä“d
 > 0) {

756 
¡©us
 = 
RuÂšg
;

759 
	`DPRINTF
(
FE
, "Addšg %˜ä“d„egi¡”s\n", 
num_ä“d
);

761 
ä“Regs
+ğ
num_ä“d
;

764 ià(
ä“Regs
 > 
numPhysRegs
)

765 
ä“Regs
 = 
numPhysRegs
;

766 
	}
}

768 
	g‹m¶©e
 <
şass
 
	gIm¶
>

770 
	gFrÚtEnd
<
	gIm¶
>::
	$»cvR‘ry
()

772 
	`as£¹
(
ÿcheBlocked
);

773 ià(
»ŒyPkt
 !ğ
NULL
) {

774 
	`as£¹
(
¡©us
 =ğ
IÿcheWa™R‘ry
);

776 ià(
iÿchePÜt
.
	`£ndTimšg
(
»ŒyPkt
)) {

777 
¡©us
 = 
IÿcheWa™Re¥Ú£
;

778 
»ŒyPkt
 = 
NULL
;

779 
ÿcheBlocked
 = 
çl£
;

784 
ÿcheBlocked
 = 
çl£
;

787 
	}
}

789 
	g‹m¶©e
 <
şass
 
	gIm¶
>

790 
boŞ


791 
	gFrÚtEnd
<
	gIm¶
>::
	$upd©eStus
()

793 
boŞ
 
£rŸlize_block
 = !
backEnd
->
	`robEm±y
(è|| 
š¡BufãrSize
;

794 
boŞ
 
be_block
 = 
ıu
->
decou¶edFrÚtEnd
 ? 
çl£
 : 
backEnd
->
	`isBlocked
();

795 
boŞ
 
»t_v®
 = 
çl£
;

797 ià(
¡©us
 =ğ
S”ŸlizeBlocked
 && !
£rŸlize_block
) {

798 
¡©us
 = 
S”ŸlizeCom¶‘e
;

799 
»t_v®
 = 
Œue
;

802 ià(
¡©us
 =ğ
BEBlocked
 && !
be_block
) {

806 
¡©us
 = 
RuÂšg
;

808 
»t_v®
 = 
Œue
;

810  
»t_v®
;

811 
	}
}

813 
	g‹m¶©e
 <
şass
 
	gIm¶
>

815 
	gFrÚtEnd
<
	gIm¶
>::
	$checkBE
()

817 
boŞ
 
be_block
 = 
ıu
->
decou¶edFrÚtEnd
 ? 
çl£
 : 
backEnd
->
	`isBlocked
();

818 ià(
be_block
) {

819 ià(
¡©us
 =ğ
RuÂšg
 || stu =ğ
IdË
) {

820 
¡©us
 = 
BEBlocked
;

823 
	}
}

825 
	g‹m¶©e
 <
şass
 
	gIm¶
>

826 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


827 
FrÚtEnd
<
Im¶
>::
	$g‘In¡FromCach–še
()

838 
In¡SeqNum
 
š¡_£q
;

839 
MachIn¡
 
š¡
;

842 
off£t
 = (
PC
 & 
ÿcheBlkMask
) & ~3;

845 ià(
PC
 >ğ(
ÿcheBlkPC
 + 
ÿcheBlkSize
è|| PC < cacheBlkPC || !
ÿcheBlkV®id
) {

846  
NULL
;

854 
š¡_£q
 = 
	`g‘AndInüem’tIn¡Seq
();

857 
	`as£¹
(
off£t
 <ğ
ÿcheBlkSize
 - (
MachIn¡
));

860 
š¡
 = 
	`htog
(*
»š‹½»t_ÿ¡
<
MachIn¡
 *>(&
ÿcheD©a
[
off£t
]));

862 #ià
THE_ISA
 =ğ
ALPHA_ISA


863 
ExtMachIn¡
 
decode_š¡
 = 
TheISA
::
	`makeExtMI
(
š¡
, 
PC
);

864 #–ià
THE_ISA
 =ğ
SPARC_ISA


865 
ExtMachIn¡
 
decode_š¡
 = 
TheISA
::
	`makeExtMI
(
š¡
, 
tc
);

869 
DynIn¡PŒ
 
š¡ruùiÚ
 = 
Ãw
 
	`DynIn¡
(
decode_š¡
, 
PC
, PC+(
MachIn¡
),

870 
š¡_£q
, 
ıu
);

872 
š¡ruùiÚ
->
	`£tTh»adS‹
(
th»ad
);

874 
	`DPRINTF
(
FE
, "Instruction [sn:%lli] created, with PC %#x\n%s\n",

875 
š¡_£q
, 
š¡ruùiÚ
->
	`»adPC
(),

876 
š¡ruùiÚ
->
¡©icIn¡
->
	`di§s£mbË
(
PC
));

878 
š¡ruùiÚ
->
ŒaûD©a
 =

879 
T¿û
::
	`g‘In¡RecÜd
(
	`curTick
(), 
tc
,

880 
š¡ruùiÚ
->
¡©icIn¡
,

881 
š¡ruùiÚ
->
	`»adPC
());

884 ++
ãtchedIn¡s
;

886  
š¡ruùiÚ
;

887 
	}
}

889 
	g‹m¶©e
 <
şass
 
	gIm¶
>

891 
	gFrÚtEnd
<
	gIm¶
>::
	$»ÇmeIn¡
(
DynIn¡PŒ
 &
š¡
)

893 
DynIn¡PŒ
 
¤c_š¡
 = 
NULL
;

894 
num_¤c_»gs
 = 
š¡
->
	`numSrcRegs
();

895 ià(
num_¤c_»gs
 == 0) {

896 
š¡
->
	`£tCªIssue
();

898 
i
 = 0; i < 
num_¤c_»gs
; ++i) {

899 
¤c_š¡
 = 
»ÇmeTabË
[
š¡
->
	`¤cRegIdx
(
i
)];

901 
š¡
->
	`£tSrcIn¡
(
¤c_š¡
, 
i
);

903 
	`DPRINTF
(
FE
, "[sn:%lli]: Src„eg %i is inst [sn:%lli]\n",

904 
š¡
->
£qNum
, ()š¡->
	`¤cRegIdx
(
i
), 
¤c_š¡
->seqNum);

906 ià(
¤c_š¡
->
	`isResuÉR—dy
()) {

907 
	`DPRINTF
(
FE
, "Reg„eady.\n");

908 
š¡
->
	`m¬kSrcRegR—dy
(
i
);

910 
	`DPRINTF
(
FE
, "Addingo dependent†ist.\n");

911 
¤c_š¡
->
	`addD•’d’t
(
š¡
);

916 
i
 = 0; i < 
š¡
->
	`numDe¡Regs
(); ++i) {

917 
RegIndex
 
idx
 = 
š¡
->
	`de¡RegIdx
(
i
);

919 
	`DPRINTF
(
FE
, "Dest„eg %i is‚ow inst [sn:%lli], was…reviously "

921 ()
š¡
->
	`de¡RegIdx
(
i
), in¡->
£qNum
,

922 
»ÇmeTabË
[
idx
]->
£qNum
);

924 
š¡
->
	`£tP»vDe¡In¡
(
»ÇmeTabË
[
idx
], 
i
);

926 
»ÇmeTabË
[
idx
] = 
š¡
;

927 --
ä“Regs
;

929 
	}
}

931 
	g‹m¶©e
 <
şass
 
	gIm¶
>

933 
	gFrÚtEnd
<
	gIm¶
>::
	$wakeFromQu›sû
()

935 
	`DPRINTF
(
FE
, "Waking up from quiesce\n");

937 
¡©us
 = 
RuÂšg
;

938 
	}
}

940 
	g‹m¶©e
 <
şass
 
	gIm¶
>

942 
	gFrÚtEnd
<
	gIm¶
>::
	$sw™chOut
()

944 
sw™chedOut
 = 
Œue
;

945 
ıu
->
	`sigÇlSw™ched
();

946 
	}
}

948 
	g‹m¶©e
 <
şass
 
	gIm¶
>

950 
	gFrÚtEnd
<
	gIm¶
>::
	$doSw™chOut
()

952 
memReq
 = 
NULL
;

953 
	`squash
(0, 0);

954 
š¡Bufãr
.
	`ş—r
();

955 
š¡BufãrSize
 = 0;

956 
ãBufãr
.
	`ş—r
();

957 
¡©us
 = 
IdË
;

958 
	}
}

960 
	g‹m¶©e
 <
şass
 
	gIm¶
>

962 
	gFrÚtEnd
<
	gIm¶
>::
	$keOv”From
(
Th»adCÚ‹xt
 *
Şd_tc
)

964 
	`as£¹
(
ä“Regs
 =ğ
numPhysRegs
);

965 
ãtchCacheLšeNextCyşe
 = 
Œue
;

967 
ÿcheBlkV®id
 = 
çl£
;

969 
ãtchFauÉ
 = 
NoFauÉ
;

970 
£rŸlizeNext
 = 
çl£
;

971 
b¬r›rIn¡
 = 
NULL
;

972 
¡©us
 = 
RuÂšg
;

973 
sw™chedOut
 = 
çl£
;

974 
š‹¼u±P’dšg
 = 
çl£
;

975 
	}
}

977 
	g‹m¶©e
 <
şass
 
	gIm¶
>

979 
	gFrÚtEnd
<
	gIm¶
>::
	$dumpIn¡s
()

981 
	`ırštf
("š¡Bufã¸size: %i\n", 
š¡Bufãr
.
	`size
());

983 
In¡BuffIt
 
buff_™
 = 
š¡Bufãr
.
	`begš
();

985 
num
 = 0; 
buff_™
 !ğ
š¡Bufãr
.
	`’d
();‚um++) {

986 
	`ırštf
("Instruction:%i\nPC:%#x\n[tid:%i]\n[sn:%lli]\nIssued:%i\n"

988 
num
, (*
buff_™
)->
	`»adPC
(), (*buff_™)->
th»adNumb”
,

989 (*
buff_™
)->
£qNum
, (*buff_™)->
	`isIssued
(),

990 (*
buff_™
)->
	`isSquashed
());

991 
buff_™
++;

993 
	}
}

	@ozone/inorder_back_end.cc

31 
	~"ıu/ozÚe/šÜd”_back_’d_im¶.hh
"

32 
	~"ıu/ozÚe/sim¶e_im¶.hh
"

34 
‹m¶©e
 
şass
 
	gInÜd”BackEnd
<
	gSim¶eIm¶
>;

	@ozone/inorder_back_end.hh

31 #iâdeà
__CPU_OZONE_INORDER_BACK_END_HH__


32 
	#__CPU_OZONE_INORDER_BACK_END_HH__


	)

34 
	~<li¡
>

36 
	~"ıu/ozÚe/»Çme_bË.hh
"

37 
	~"ıu/ozÚe/th»ad_¡©e.hh
"

38 
	~"ıu/š¡_£q.hh
"

39 
	~"ıu/th»ad_cÚ‹xt.hh
"

40 
	~"ıu/timebuf.hh
"

41 
	~"mem/»que¡.hh
"

42 
	~"sim/ev’tq.hh
"

43 
	~"sim/çuÉs.hh
"

45 
	g‹m¶©e
 <
şass
 
	gIm¶
>

46 şas 
	cInÜd”BackEnd


48 
	mpublic
:

49 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

50 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

51 
ty³Çme
 
	tIm¶
::
	tFuÎCPU
 FullCPU;

52 
ty³Çme
 
	tIm¶
::
	tFrÚtEnd
 FrontEnd;

54 
ty³Çme
 
	tFuÎCPU
::
	tOzÚeTC
 OzoneTC;

55 
ty³Çme
 
	tIm¶
::
	tFuÎCPU
::
	tCommSŒuù
 CommStruct;

57 
InÜd”BackEnd
(
P¬ams
 *
·¿ms
);

59 
	m¡d
::
¡ršg
 
	$Çme
() const;

61 
	$£tCPU
(
FuÎCPU
 *
ıu_±r
)

62 { 
ıu
 = 
ıu_±r
; }

64 
	$£tFrÚtEnd
(
FrÚtEnd
 *
äÚt_’d_±r
)

65 { 
äÚtEnd
 = 
äÚt_’d_±r
; 
	}
}

67 
£tCommBufãr
(
TimeBufãr
<
CommSŒuù
> *
_comm
)

68 { 
	gcomm
 = 
_comm
; }

70 
£tTC
(
Th»adCÚ‹xt
 *
tc_±r
);

72 
£tTh»adS‹
(
OzÚeTh»adS‹
<
Im¶
> *
th»ad_±r
);

74 
	$»gSts
(è{ 
	}
}

76 
checkIÁ”ru±s
();

78 
tick
();

79 
execu‹In¡s
();

80 
squash
(cÚ¡ 
In¡SeqNum
 &
squash_num
, cÚ¡ 
Addr
 &
Ãxt_PC
);

82 
squashFromXC
();

83 
	$g’”©eXCEv’t
(è{ 
	}
}

85 
boŞ
 
	$robEm±y
(è{  
š¡Li¡
.
	`em±y
(); 
	}
}

87 
boŞ
 
	$isFuÎ
(è{  
çl£
; 
	}
}

88 
boŞ
 
	$isBlocked
(è{  
¡©us
 =ğ
DÿcheMissStÜeSÎ
 ||

89 
¡©us
 =ğ
DÿcheMissLßdSÎ
 ||

90 
š‹¼u±Blocked
; 
	}
}

92 
ãtchFauÉ
(
FauÉ
 &
çuÉ
);

94 
dumpIn¡s
();

96 
	g´iv©e
:

97 
hªdËFauÉ
();

99 
£tSquashInfoFromTC
();

101 
boŞ
 
	gsquashP’dšg
;

102 
In¡SeqNum
 
	gsquashSeqNum
;

103 
Addr
 
	gsquashNextPC
;

105 
FauÉ
 
	gçuÉFromF‘ch
;

107 
boŞ
 
	gš‹¼u±Blocked
;

109 
	gpublic
:

110 
‹m¶©e
 <
şass
 
T
>

111 
FauÉ
 
»ad
(
Addr
 
addr
, 
T
 &
d©a
, 
æags
);

113 
	g‹m¶©e
 <
şass
 
	gT
>

114 
FauÉ
 
»ad
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
lßd_idx
);

116 
	g‹m¶©e
 <
şass
 
	gT
>

117 
FauÉ
 
wr™e
(
T
 
d©a
, 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

119 
	g‹m¶©e
 <
şass
 
	gT
>

120 
FauÉ
 
wr™e
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
¡Üe_idx
);

122 
Addr
 
	$»adComm™PC
(è{  
comm™PC
; 
	}
}

124 
Addr
 
	gcomm™PC
;

126 
	$sw™chOut
(è{ 
	`·nic
("NÙ im¶em’‹d!"); 
	}
}

127 
	$doSw™chOut
(è{ 
	`·nic
("NÙ im¶em’‹d!"); 
	}
}

128 
	$keOv”From
(
Th»adCÚ‹xt
 *
Şd_tc
 = 
NULL
è{ 
	`·nic
("NÙ im¶em’‹d!"); 
	}
}

130 
	gpublic
:

131 
FuÎCPU
 *
ıu
;

133 
FrÚtEnd
 *
	gäÚtEnd
;

135 
Th»adCÚ‹xt
 *
	gtc
;

137 
	gOzÚeTh»adS‹
<
	gIm¶
> *
	gth»ad
;

139 
	gR’ameTabË
<
	gIm¶
> 
	g»ÇmeTabË
;

141 
	g´Ùeùed
:

142 
	eStus
 {

143 
RuÂšg
,

144 
	gIdË
,

145 
	gDÿcheMissLßdSÎ
,

146 
	gDÿcheMissStÜeSÎ
,

147 
	gDÿcheMissCom¶‘e
,

148 
	gBlocked


151 
Stus
 
	g¡©us
;

153 şas 
	cDCacheCom¶‘iÚEv’t
 : 
public
 
Ev’t


155 
´iv©e
:

156 
InÜd”BackEnd
 *
be
;

158 
	gpublic
:

159 
DCacheCom¶‘iÚEv’t
(
InÜd”BackEnd
 *
_be
);

161 
vœtu®
 
´oûss
();

162 
vœtu®
 cÚ¡ *
desütiÚ
() const;

164 
DynIn¡PŒ
 
	gš¡
;

167 
ä›nd
 
şass
 
	gDCacheCom¶‘iÚEv’t
;

169 
DCacheCom¶‘iÚEv’t
 
	gÿcheCom¶‘iÚEv’t
;

173 
Reque¡PŒ
 
	gmemReq
;

175 
	g´iv©e
:

176 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tIn¡Li¡It
;

178 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
;

181 
	gwidth
;

183 
	gÏ‹ncy
;

185 
	gsquashL©’cy
;

187 
	gTimeBufãr
<> 
	gnumIn¡sToWB
;

188 
	gTimeBufãr
<>::
wœe
 
š¡sAdded
;

189 
	gTimeBufãr
<>::
wœe
 
š¡sToExecu‹
;

191 
	gTimeBufãr
<
	gCommSŒuù
> *
	gcomm
;

193 
	gSts
::
SÿÏr
 
dÿcheSÎCyşes
;

194 
CouÁ”
 
	gÏ¡DÿcheSÎ
;

197 
	g‹m¶©e
 <
şass
 
	gIm¶
>

198 
	g‹m¶©e
 <
şass
 
	gT
>

199 
FauÉ


200 
	gInÜd”BackEnd
<
	gIm¶
>::
	$»ad
(
Addr
 
addr
, 
T
 &
d©a
, 
æags
)

202 
memReq
->
	`»£t
(
addr
, (
T
), 
æags
);

205 
FauÉ
 
çuÉ
 = 
ıu
->
dtb
->
	`Œª¦©eAtomic
(
memReq
, 
th»ad
->
	`g‘TC
(), 
çl£
);

208 ià(
çuÉ
 =ğ
NoFauÉ
 && 
dÿcheIÁ”çû
) {

209 
memReq
->
cmd
 = 
R—d
;

210 
memReq
->
com¶‘iÚEv’t
 = 
NULL
;

211 
memReq
->
time
 = 
	`curTick
();

212 
MemAcûssResuÉ
 
»suÉ
 = 
dÿcheIÁ”çû
->
	`acûss
(
memReq
);

217 ià(
»suÉ
 !ğ
MA_HIT
) {

220 
memReq
->
com¶‘iÚEv’t
 = &
ÿcheCom¶‘iÚEv’t
;

221 
Ï¡DÿcheSÎ
 = 
	`curTick
();

223 
¡©us
 = 
DÿcheMissLßdSÎ
;

224 
	`DPRINTF
(
IBE
, "Dcache miss stall!\n");

227 
	`DPRINTF
(
IBE
, "Dcache hit!\n");

230  
çuÉ
;

231 
	}
}

233 
	g‹m¶©e
 <
şass
 
	gIm¶
>

234 
	g‹m¶©e
 <
şass
 
	gT
>

235 
FauÉ


236 
	gInÜd”BackEnd
<
	gIm¶
>::
	$wr™e
(
T
 
d©a
, 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
)

238 
memReq
->
	`»£t
(
addr
, (
T
), 
æags
);

241 
FauÉ
 
çuÉ
 = 
ıu
->
dtb
->
	`Œª¦©eAtomic
(
memReq
, 
th»ad
->
	`g‘TC
(), 
Œue
);

243 ià(
çuÉ
 =ğ
NoFauÉ
 && 
dÿcheIÁ”çû
) {

244 
memReq
->
cmd
 = 
Wr™e
;

246 
memReq
->
com¶‘iÚEv’t
 = 
NULL
;

247 
memReq
->
time
 = 
	`curTick
();

248 
MemAcûssResuÉ
 
»suÉ
 = 
dÿcheIÁ”çû
->
	`acûss
(
memReq
);

253 ià(
»suÉ
 !ğ
MA_HIT
) {

254 
memReq
->
com¶‘iÚEv’t
 = &
ÿcheCom¶‘iÚEv’t
;

255 
Ï¡DÿcheSÎ
 = 
	`curTick
();

257 
¡©us
 = 
DÿcheMissStÜeSÎ
;

258 
	`DPRINTF
(
IBE
, "Dcache miss stall!\n");

260 
	`DPRINTF
(
IBE
, "Dcache hit!\n");

264 ià(
»s
 && (
çuÉ
 =ğ
NoFauÉ
))

265 *
»s
 = 
memReq
->
»suÉ
;

266  
çuÉ
;

267 
	}
}

269 
	g‹m¶©e
 <
şass
 
	gIm¶
>

270 
	g‹m¶©e
 <
şass
 
	gT
>

271 
FauÉ


272 
	gInÜd”BackEnd
<
	gIm¶
>::
	$»ad
(
MemReqPŒ
 &
»q
, 
T
 &
d©a
, 
lßd_idx
)

279 
»q
->
cmd
 = 
R—d
;

280 
»q
->
com¶‘iÚEv’t
 = 
NULL
;

281 
»q
->
time
 = 
	`curTick
();

282 
	`as£¹
(!
»q
->
d©a
);

283 
»q
->
d©a
 = 
Ãw
 
ušt8_t
[64];

284 
FauÉ
 
çuÉ
 = 
ıu
->
	`»ad
(
»q
, 
d©a
);

285 
	`memıy
(
»q
->
d©a
, &d©a, (
T
));

288 ià(
dÿcheIÁ”çû
) {

289 
MemAcûssResuÉ
 
»suÉ
 = 
dÿcheIÁ”çû
->
	`acûss
(
»q
);

294 ià(
»suÉ
 !ğ
MA_HIT
) {

295 
»q
->
com¶‘iÚEv’t
 = &
ÿcheCom¶‘iÚEv’t
;

296 
Ï¡DÿcheSÎ
 = 
	`curTick
();

298 
¡©us
 = 
DÿcheMissLßdSÎ
;

299 
	`DPRINTF
(
IBE
, "Dcache miss†oad stall!\n");

301 
	`DPRINTF
(
IBE
, "Dcache hit!\n");

306  
NoFauÉ
;

307 
	}
}

309 
	g‹m¶©e
 <
şass
 
	gIm¶
>

310 
	g‹m¶©e
 <
şass
 
	gT
>

311 
FauÉ


312 
	gInÜd”BackEnd
<
	gIm¶
>::
	$wr™e
(
MemReqPŒ
 &
»q
, 
T
 &
d©a
, 
¡Üe_idx
)

319 
»q
->
cmd
 = 
Wr™e
;

320 
»q
->
com¶‘iÚEv’t
 = 
NULL
;

321 
»q
->
time
 = 
	`curTick
();

322 
	`as£¹
(!
»q
->
d©a
);

323 
»q
->
d©a
 = 
Ãw
 
ušt8_t
[64];

324 
	`memıy
(
»q
->
d©a
, (
ušt8_t
 *)&d©a,„eq->
size
);

326 
»q
->
size
) {

328 
ıu
->
	`wr™e
(
»q
, (
ušt8_t
 &)
d©a
);

331 
ıu
->
	`wr™e
(
»q
, (
ušt16_t
 &)
d©a
);

334 
ıu
->
	`wr™e
(
»q
, (
ušt32_t
 &)
d©a
);

337 
ıu
->
	`wr™e
(
»q
, (
ušt64_t
 &)
d©a
);

340 
	`·nic
("Unexpected store size!\n");

343 ià(
dÿcheIÁ”çû
) {

344 
»q
->
cmd
 = 
Wr™e
;

345 
»q
->
d©a
 = 
Ãw
 
ušt8_t
[64];

346 
	`memıy
(
»q
->
d©a
,(
ušt8_t
 *)&d©a,»q->
size
);

347 
»q
->
com¶‘iÚEv’t
 = 
NULL
;

348 
»q
->
time
 = 
	`curTick
();

349 
MemAcûssResuÉ
 
»suÉ
 = 
dÿcheIÁ”çû
->
	`acûss
(
»q
);

354 ià(
»suÉ
 !ğ
MA_HIT
) {

355 
»q
->
com¶‘iÚEv’t
 = &
ÿcheCom¶‘iÚEv’t
;

356 
Ï¡DÿcheSÎ
 = 
	`curTick
();

358 
¡©us
 = 
DÿcheMissStÜeSÎ
;

359 
	`DPRINTF
(
IBE
, "Dcache miss store stall!\n");

361 
	`DPRINTF
(
IBE
, "Dcache hit!\n");

379  
NoFauÉ
;

380 
	}
}

	@ozone/inorder_back_end_impl.hh

31 #iâdeà
__CPU_OZONE_INORDER_BACK_END_IMPL_HH__


32 
	#__CPU_OZONE_INORDER_BACK_END_IMPL_HH__


	)

34 
	~"¬ch/ty³s.hh
"

35 
	~"cÚfig/the_i§.hh
"

36 
	~"ıu/ozÚe/šÜd”_back_’d.hh
"

37 
	~"ıu/ozÚe/th»ad_¡©e.hh
"

38 
	~"sim/çuÉs.hh
"

40 
	g‹m¶©e
 <
şass
 
	gIm¶
>

41 
	gInÜd”BackEnd
<
	gIm¶
>::
	$InÜd”BackEnd
(
P¬ams
 *
·¿ms
)

42 : 
	`squashP’dšg
(
çl£
),

43 
	`squashSeqNum
(0),

44 
	`squashNextPC
(0),

45 
	`çuÉFromF‘ch
(
NoFauÉ
),

46 
	`š‹¼u±Blocked
(
çl£
),

47 
	`ÿcheCom¶‘iÚEv’t
(
this
),

48 
	`dÿcheIÁ”çû
(
·¿ms
->
dÿcheIÁ”çû
),

49 
	`width
(
·¿ms
->
backEndWidth
),

50 
	`Ï‹ncy
(
·¿ms
->
backEndL©’cy
),

51 
	`squashL©’cy
(
·¿ms
->
backEndSquashL©’cy
),

52 
	`numIn¡sToWB
(0, 
Ï‹ncy
 + 1)

54 
š¡sAdded
 = 
numIn¡sToWB
.
	`g‘Wœe
(
Ï‹ncy
);

55 
š¡sToExecu‹
 = 
numIn¡sToWB
.
	`g‘Wœe
(0);

57 
memReq
 = 
Ãw
 
MemReq
;

58 
memReq
->
d©a
 = 
Ãw
 
ušt8_t
[64];

59 
¡©us
 = 
RuÂšg
;

60 
	}
}

62 
	g‹m¶©e
 <
şass
 
	gIm¶
>

63 
	g¡d
::
¡ršg


64 
InÜd”BackEnd
<
Im¶
>::
	$Çme
() const

66  
ıu
->
	`Çme
() + ".inorderbackend";

67 
	}
}

69 
	g‹m¶©e
 <
şass
 
	gIm¶
>

71 
	gInÜd”BackEnd
<
	gIm¶
>::
	$£tXC
(
ExecCÚ‹xt
 *
xc_±r
)

73 
xc
 = 
xc_±r
;

74 
memReq
->
xc
 = xc;

75 
	}
}

77 
	g‹m¶©e
 <
şass
 
	gIm¶
>

79 
	gInÜd”BackEnd
<
	gIm¶
>::
£tTh»adS‹
(
OzÚeTh»adS‹
<
Im¶
> *
th»ad_±r
)

81 
th»ad
 = 
th»ad_±r
;

82 
	gth»ad
->
£tFuncExeIn¡
(0);

85 
	g‹m¶©e
 <
şass
 
	gIm¶
>

87 
	gInÜd”BackEnd
<
	gIm¶
>::
	$checkIÁ”ru±s
()

91 
l
 = 0;

92 
summ¬y
 = 0;

95 ià(
th»ad
->
	`»adMiscRegNoEfãù
(
IPR_ASTRR
))

96 
	`·nic
("asynchronousraps‚ot implemented\n");

98 ià(
th»ad
->
	`»adMiscRegNoEfãù
(
IPR_SIRR
)) {

99 
i
 = 
INTLEVEL_SOFTWARE_MIN
;

100 
i
 < 
INTLEVEL_SOFTWARE_MAX
; i++) {

101 ià(
th»ad
->
	`»adMiscRegNoEfãù
(
IPR_SIRR
è& (
	`ULL
(1è<< 
i
)) {

103 
l
 = (
i
 - 
INTLEVEL_SOFTWARE_MIN
) + 1;

104 
summ¬y
 |ğ(
	`ULL
(1è<< 
i
);

109 
ušt64_t
 
š‹¼u±s
 = 
ıu
->
	`šŒ_¡©us
();

111 ià(
š‹¼u±s
) {

112 
i
 = 
INTLEVEL_EXTERNAL_MIN
;

113 
i
 < 
INTLEVEL_EXTERNAL_MAX
; i++) {

114 ià(
š‹¼u±s
 & (
	`ULL
(1è<< 
i
)) {

116 
l
 = 
i
;

117 
summ¬y
 |ğ(
	`ULL
(1è<< 
i
);

122 ià(
l
 && i¶ > 
th»ad
->
	`»adMiscRegNoEfãù
(
IPR_IPLR
)) {

123 
th»ad
->
noSquashFromTC
 = 
Œue
;

125 
th»ad
->
	`£tMiscRegNoEfãù
(
IPR_ISR
, 
summ¬y
);

126 
th»ad
->
	`£tMiscRegNoEfãù
(
IPR_INTID
, 
l
);

127 
	`FauÉ
(
Ãw
 
IÁ”ru±FauÉ
)->
	`švoke
(
xc
);

128 
	`DPRINTF
(
Flow
, "Interrupt! IPLR=%d ipl=%d summary=%x\n",

129 
th»ad
->
	`»adMiscRegNoEfãù
(
IPR_IPLR
), 
l
, 
summ¬y
);

132 
squashP’dšg
 = 
Œue
;

134 
th»ad
->
noSquashFromTC
 = 
çl£
;

136 
	`£tSquashInfoFromXC
();

138 
	}
}

140 
	g‹m¶©e
 <
şass
 
	gIm¶
>

142 
	gInÜd”BackEnd
<
	gIm¶
>::
	$tick
()

146 ià(
squashP’dšg
) {

147 
	`squash
(
squashSeqNum
, 
squashNextPC
);

153 ià(
FuÎSy¡em
 && (
š‹¼u±Blocked
 || 
ıu
->
	`checkIÁ”ru±s
(
tc
))) {

154 ià(!
	`robEm±y
()) {

155 
š‹¼u±Blocked
 = 
Œue
;

157 } ià(
	`robEm±y
(è&& (
PC
 & 0x3)) {

161 
š‹¼u±Blocked
 = 
çl£
;

163 
š‹¼u±Blocked
 = 
çl£
;

164 
	`checkIÁ”ru±s
();

169 ià(
¡©us
 !ğ
DÿcheMissLßdSÎ
 &&

170 
¡©us
 !ğ
DÿcheMissStÜeSÎ
) {

171 
i
 = 0; i < 
width
 && (*
š¡sAdded
) < width; ++i) {

172 
DynIn¡PŒ
 
š¡
 = 
äÚtEnd
->
	`g‘In¡
();

174 ià(!
š¡
)

177 
š¡Li¡
.
	`push_back
(
š¡
);

179 (*
š¡sAdded
)++;

182 ià(
çuÉFromF‘ch
 && 
	`robEm±y
(è&& 
äÚtEnd
->
	`isEm±y
()) {

183 
	`hªdËFauÉ
();

185 
	`execu‹In¡s
();

188 
	}
}

190 
	g‹m¶©e
 <
şass
 
	gIm¶
>

192 
	gInÜd”BackEnd
<
	gIm¶
>::
	$execu‹In¡s
()

194 
boŞ
 
com¶‘ed_Ï¡_š¡
 = 
Œue
;

195 
š¡s_to_execu‹
 = *
š¡sToExecu‹
;

196 
ä“d_»gs
 = 0;

198 
š¡s_to_execu‹
 > 0) {

199 
	`as£¹
(!
š¡Li¡
.
	`em±y
());

200 
DynIn¡PŒ
 
š¡
 = 
š¡Li¡
.
	`äÚt
();

202 
comm™PC
 = 
š¡
->
	`»adPC
();

204 
th»ad
->
	`£tPC
(
comm™PC
);

205 
th»ad
->
	`£tNextPC
(
š¡
->
	`»adNextPC
());

207 ià(
FuÎSy¡em
) {

208 
couÁ
 = 0;

209 
Addr
 
Şdpc
;

211 ià(
couÁ
 == 0)

212 
	`as£¹
(!
th»ad
->
noSquashFromTC
 && !th»ad->
Œ­P’dšg
);

213 
Şdpc
 = 
th»ad
->
	`»adPC
();

214 
ıu
->
sy¡em
->
pcEv’tQueue
.
	`£rviû
(

215 
th»ad
->
	`g‘XCProxy
());

216 
couÁ
++;

217 } 
Şdpc
 !ğ
th»ad
->
	`»adPC
());

218 ià(
couÁ
 > 1) {

219 
	`DPRINTF
(
IBE
, "PC skip functionƒvent, stopping commit\n");

220 
com¶‘ed_Ï¡_š¡
 = 
çl£
;

221 
squashP’dšg
 = 
Œue
;

226 
FauÉ
 
š¡_çuÉ
 = 
NoFauÉ
;

228 ià(
¡©us
 =ğ
DÿcheMissCom¶‘e
) {

229 
	`DPRINTF
(
IBE
, "Com¶‘šg in¡ [¢:%Îi]\n", 
š¡
->
£qNum
);

230 
¡©us
 = 
RuÂšg
;

231 } ià(
š¡
->
	`isMemRef
(è&& 
¡©us
 !ğ
DÿcheMissCom¶‘e
 &&

232 (!
š¡
->
	`isD©aP»ãtch
(è&& !š¡->
	`isIn¡P»ãtch
())) {

233 
	`DPRINTF
(
IBE
, "Initiating mem op inst [sn:%lli] PC: %#x\n",

234 
š¡
->
£qNum
, in¡->
	`»adPC
());

236 
ÿcheCom¶‘iÚEv’t
.
š¡
 = inst;

237 
š¡_çuÉ
 = 
š¡
->
	`š™Ÿ‹Acc
();

238 ià(
š¡_çuÉ
 =ğ
NoFauÉ
 &&

239 
¡©us
 !ğ
DÿcheMissLßdSÎ
 &&

240 
¡©us
 !ğ
DÿcheMissStÜeSÎ
) {

241 
š¡_çuÉ
 = 
š¡
->
	`com¶‘eAcc
();

243 ++
th»ad
->
funcExeIn¡
;

245 
	`DPRINTF
(
IBE
, "Executing inst [sn:%lli] PC: %#x\n",

246 
š¡
->
£qNum
, in¡->
	`»adPC
());

247 
š¡_çuÉ
 = 
š¡
->
	`execu‹
();

248 ++
th»ad
->
funcExeIn¡
;

254 ià(
¡©us
 =ğ
DÿcheMissLßdSÎ
) {

255 *
š¡sToExecu‹
 = 
š¡s_to_execu‹
;

257 
com¶‘ed_Ï¡_š¡
 = 
çl£
;

259 } ià(
¡©us
 =ğ
DÿcheMissStÜeSÎ
) {

262 *
š¡sToExecu‹
 = 
š¡s_to_execu‹
;

263 
com¶‘ed_Ï¡_š¡
 = 
çl£
;

279 
š¡
->
	`£tExecu‹d
();

280 
š¡
->
	`£tResuÉR—dy
();

281 
š¡
->
	`£tCªComm™
();

283 
š¡Li¡
.
	`pİ_äÚt
();

285 --
š¡s_to_execu‹
;

286 --(*
š¡sToExecu‹
);

288 ià(
š¡
->
ŒaûD©a
) {

289 
š¡
->
ŒaûD©a
->
	`fš®ize
();

290 
š¡
->
ŒaûD©a
 = 
NULL
;

293 ià(
š¡_çuÉ
 !ğ
NoFauÉ
) {

294 
	`DPRINTF
(
IBE
, "Inst [sn:%lli] PC %#x has‡ fault\n",

295 
š¡
->
£qNum
, in¡->
	`»adPC
());

297 
	`as£¹
(!
th»ad
->
noSquashFromTC
);

299 
th»ad
->
noSquashFromTC
 = 
Œue
;

303 
š¡_çuÉ
->
	`švoke
(
xc
);

306 
th»ad
->
noSquashFromTC
 = 
çl£
;

308 
squashP’dšg
 = 
Œue
;

310 
com¶‘ed_Ï¡_š¡
 = 
çl£
;

314 
i
 = 0; i < 
š¡
->
	`numDe¡Regs
(); ++i) {

315 
»ÇmeTabË
[
š¡
->
	`de¡RegIdx
(
i
)] = inst;

316 
th»ad
->
»ÇmeTabË
[
š¡
->
	`de¡RegIdx
(
i
)] = inst;

317 ++
ä“d_»gs
;

320 
š¡
->
	`ş—rD•’d’ts
();

322 
comm
->
	`acûss
(0)->
dÚeSeqNum
 = 
š¡
->
£qNum
;

324 ià(
š¡
->
	`mi¥»diùed
()) {

325 
	`squash
(
š¡
->
£qNum
, in¡->
	`»adNextPC
());

327 
th»ad
->
	`£tNextPC
(
š¡
->
	`»adNextPC
());

330 } ià(
squashP’dšg
) {

341 
ıu
->
numIn¡
++;

342 
th»ad
->
numIn¡s
++;

345 
äÚtEnd
->
	`addF»eRegs
(
ä“d_»gs
);

347 
	`as£¹
(
š¡s_to_execu‹
 >= 0);

350 ià(
š¡s_to_execu‹
 == 0) {

351 
numIn¡sToWB
.
	`advªû
();

355 ià(
com¶‘ed_Ï¡_š¡
) {

356 
th»ad
->
	`£tPC
Ñh»ad->
	`»adNextPC
());

357 
th»ad
->
	`£tNextPC
Ñh»ad->
	`»adPC
(è+ (
MachIn¡
));

360 ià(
squashP’dšg
) {

361 
	`£tSquashInfoFromXC
();

363 
	}
}

365 
	g‹m¶©e
 <
şass
 
	gIm¶
>

367 
	gInÜd”BackEnd
<
	gIm¶
>::
	$hªdËFauÉ
()

369 
	`DPRINTF
(
Comm™
, "Handling fault from fetch\n");

371 
	`as£¹
(!
th»ad
->
noSquashFromTC
);

373 
th»ad
->
noSquashFromTC
 = 
Œue
;

377 
çuÉFromF‘ch
->
	`švoke
(
xc
);

380 
th»ad
->
noSquashFromTC
 = 
çl£
;

382 
squashP’dšg
 = 
Œue
;

384 
	`£tSquashInfoFromXC
();

385 
	}
}

387 
	g‹m¶©e
 <
şass
 
	gIm¶
>

389 
	gInÜd”BackEnd
<
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
squash_num
, cÚ¡ 
Addr
 &
Ãxt_PC
)

391 
	`DPRINTF
(
IBE
, "Squashing from [sn:%lli], setting PCo %#x\n",

392 
squash_num
, 
Ãxt_PC
);

394 
In¡Li¡It
 
squash_™
 = --(
š¡Li¡
.
	`’d
());

396 
ä“d_»gs
 = 0;

398 !
š¡Li¡
.
	`em±y
(è&& (*
squash_™
)->
£qNum
 > 
squash_num
) {

399 
DynIn¡PŒ
 
š¡
 = *
squash_™
;

401 
	`DPRINTF
(
IBE
, "Squashing instruction PC %#x, [sn:%lli].\n",

402 
š¡
->
	`»adPC
(),

403 
š¡
->
£qNum
);

406 
ä“d_»gs
+ğ
š¡
->
	`numDe¡Regs
();

407 
š¡
->
	`ş—rD•’d’ts
();

408 
squash_™
--;

409 
š¡Li¡
.
	`pİ_back
();

412 
äÚtEnd
->
	`addF»eRegs
(
ä“d_»gs
);

414 
i
 = 0; i < 
Ï‹ncy
+1; ++i) {

415 
numIn¡sToWB
.
	`advªû
();

418 
squashP’dšg
 = 
çl£
;

422 
th»ad
->
noSquashFromTC
 = 
çl£
;

425 
äÚtEnd
->
	`squash
(
squash_num
, 
Ãxt_PC
);

427 
çuÉFromF‘ch
 = 
NULL
;

428 
	}
}

430 
	g‹m¶©e
 <
şass
 
	gIm¶
>

432 
	gInÜd”BackEnd
<
	gIm¶
>::
	$squashFromXC
()

435 
squashP’dšg
 = 
Œue
;

437 
th»ad
->
noSquashFromTC
 = 
Œue
;

438 
	}
}

440 
	g‹m¶©e
 <
şass
 
	gIm¶
>

442 
	gInÜd”BackEnd
<
	gIm¶
>::
	$£tSquashInfoFromXC
()

446 
squashSeqNum
 = 
š¡Li¡
.
	`em±y
(è? 0 : in¡Li¡.
	`äÚt
()->
£qNum
 - 1;

448 
squashNextPC
 = 
th»ad
->
PC
;

449 
	}
}

451 
	g‹m¶©e
 <
şass
 
	gIm¶
>

453 
	gInÜd”BackEnd
<
	gIm¶
>::
	$ãtchFauÉ
(
FauÉ
 &
çuÉ
)

455 
çuÉFromF‘ch
 = 
çuÉ
;

456 
	}
}

458 
	g‹m¶©e
 <
şass
 
	gIm¶
>

460 
	gInÜd”BackEnd
<
	gIm¶
>::
	$dumpIn¡s
()

462 
num
 = 0;

463 
v®id_num
 = 0;

465 
In¡Li¡It
 
š¡_li¡_™
 = 
š¡Li¡
.
	`begš
();

467 
	`ırštf
("In¡†i¡ size: %i\n", 
š¡Li¡
.
	`size
());

469 
š¡_li¡_™
 !ğ
š¡Li¡
.
	`’d
())

471 
	`ırštf
("Instruction:%i\n",

472 
num
);

473 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

474 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

475 ++
v®id_num
;

476 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

477 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

478 !(*
š¡_li¡_™
)->
memOpDÚe
) {

481 ++
v®id_num
;

482 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

486 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

488 (*
š¡_li¡_™
)->
	`»adPC
(),

489 (*
š¡_li¡_™
)->
£qNum
,

490 (*
š¡_li¡_™
)->
th»adNumb”
,

491 (*
š¡_li¡_™
)->
	`isIssued
(),

492 (*
š¡_li¡_™
)->
	`isSquashed
());

494 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

495 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

498 
	`ırštf
("\n");

500 
š¡_li¡_™
++;

501 ++
num
;

503 
	}
}

505 
	g‹m¶©e
 <
şass
 
	gIm¶
>

506 
	gInÜd”BackEnd
<
	gIm¶
>::
DCacheCom¶‘iÚEv’t
::
	$DCacheCom¶‘iÚEv’t
(

507 
InÜd”BackEnd
 *
_be
)

508 : 
	`Ev’t
(&
mašEv’tQueue
, 
CPU_Tick_Pri
), 
	$be
(
_be
)

511 
	}
}

513 
	g‹m¶©e
 <
şass
 
	gIm¶
>

515 
	gInÜd”BackEnd
<
	gIm¶
>::
DCacheCom¶‘iÚEv’t
::
	$´oûss
()

517 
š¡
->
	`com¶‘eAcc
();

518 
be
->
¡©us
 = 
DÿcheMissCom¶‘e
;

519 
	}
}

521 
	g‹m¶©e
 <
şass
 
	gIm¶
>

523 
	gInÜd”BackEnd
<
	gIm¶
>::
DCacheCom¶‘iÚEv’t
::
	$desütiÚ
() const

526 
	}
}

	@ozone/inst_queue.cc

31 
	~"ıu/ozÚe/dyn_š¡.hh
"

32 
	~"ıu/ozÚe/š¡_queue_im¶.hh
"

33 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

34 
	~"ıu/ozÚe/sim¶e_im¶.hh
"

37 
‹m¶©e
 
şass
 
	gIn¡Queue
<
	gSim¶eIm¶
>;

38 
‹m¶©e
 
şass
 
	gIn¡Queue
<
	gOzÚeIm¶
>;

	@ozone/inst_queue.hh

31 #iâdeà
__CPU_OZONE_INST_QUEUE_HH__


32 
	#__CPU_OZONE_INST_QUEUE_HH__


	)

34 
	~<li¡
>

35 
	~<m­
>

36 
	~<queue
>

37 
	~<veùÜ
>

39 
	~"ba£/¡©i¡ics.hh
"

40 
	~"ba£/ty³s.hh
"

41 
	~"ıu/š¡_£q.hh
"

42 
	~"ıu/timebuf.hh
"

44 
şass
 
	gFUPoŞ
;

45 
şass
 
	gMemIÁ”çû
;

64 
	g‹m¶©e
 <
şass
 
	gIm¶
>

65 şas 
	cIn¡Queue


67 
	mpublic
:

69 
ty³Çme
 
	tIm¶
::
	tFuÎCPU
 FullCPU;

70 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

71 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

72 
ty³Çme
 
	tIm¶
::
	tIssueSŒuù
 IssueStruct;

80 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLi¡It
;

82 
ä›nd
 
şass
 
	mIm¶
::
FuÎCPU
;

85 şas 
	cFUCom¶‘iÚ
 : 
public
 
Ev’t
 {

86 
´iv©e
:

88 
DynIn¡PŒ
 
š¡
;

91 
	mfuIdx
;

94 
	mIn¡Queue
<
	mIm¶
> *
	miqPŒ
;

96 
	mpublic
:

98 
FUCom¶‘iÚ
(
DynIn¡PŒ
 &
_š¡
, 
fu_idx
,

99 
In¡Queue
<
Im¶
> *
iq_±r
);

101 
vœtu®
 
´oûss
();

102 
vœtu®
 cÚ¡ *
desütiÚ
() const;

106 
In¡Queue
(
P¬ams
 *
·¿ms
);

109 ~
In¡Queue
();

112 
	g¡d
::
¡ršg
 
	$Çme
() const;

115 
	`»gSts
();

118 
	$£tCPU
(
FuÎCPU
 *
_ıu
è{ 
ıu
 = _ıu; 
	}
}

121 
£tAùiveTh»ads
(
li¡
<> *
©_±r
);

124 
	$£tIEW
(
IEW
 *
›w_±r
è{ 
›wSge
 = iew_±r; 
	}
}

127 
£tIssueToExecu‹Queue
(
TimeBufãr
<
IssueSŒuù
> *
i2eQueue
);

130 
£tTimeBufãr
(
TimeBufãr
<
TimeSŒuù
> *
tb_±r
);

133 
’ŒyAmouÁ
(
Th»adID
 
num_th»ads
);

136 
»£tEÁr›s
();

139 
numF»eEÁr›s
();

142 
numF»eEÁr›s
(
Th»adID
 
tid
);

145 
boŞ
 
isFuÎ
();

148 
boŞ
 
isFuÎ
(
Th»adID
 
tid
);

151 
boŞ
 
hasR—dyIn¡s
();

154 
š£¹
(
DynIn¡PŒ
 &
Ãw_š¡
);

157 
š£¹NÚS³c
(
DynIn¡PŒ
 &
Ãw_š¡
);

164 
advªûTa
(
DynIn¡PŒ
 &
š¡
);

167 
´oûssFUCom¶‘iÚ
(
DynIn¡PŒ
 &
š¡
, 
fu_idx
);

173 
scheduËR—dyIn¡s
();

176 
scheduËNÚS³c
(cÚ¡ 
In¡SeqNum
 &
š¡
);

182 
comm™
(cÚ¡ 
In¡SeqNum
 &
š¡
, 
Th»adID
 
tid
 = 0);

185 
wakeD•’d’ts
(
DynIn¡PŒ
 &
com¶‘ed_š¡
);

188 
addR—dyMemIn¡
(
DynIn¡PŒ
 &
»ady_š¡
);

194 
»scheduËMemIn¡
(
DynIn¡PŒ
 &
»sched_š¡
);

197 
»¶ayMemIn¡
(
DynIn¡PŒ
 &
»¶ay_š¡
);

200 
com¶‘eMemIn¡
(
DynIn¡PŒ
 &
com¶‘ed_š¡
);

203 
viŞ©iÚ
(
DynIn¡PŒ
 &
¡Üe
, DynIn¡PŒ &
çuÉšg_lßd
);

209 
squash
(
Th»adID
 
tid
);

212 
	$g‘CouÁ
(
Th»adID
 
tid
è{  
couÁ
[tid]; 
	}
};

215 
	$upd©eF»eEÁr›s
(
num
è{ 
ä“EÁr›s
 +ğnum; 
	}
}

218 
´štIn¡s
();

220 
	g´iv©e
:

222 
doSquash
(
Th»adID
 
tid
);

229 
FuÎCPU
 *
	gıu
;

232 
MemIÁ”çû
 *
	gdÿcheIÁ”çû
;

235 
IEW
 *
	g›wSge
;

240 
MemD•Un™
 
	gmemD•Un™
[
Im¶
::
MaxTh»ads
];

245 
	gTimeBufãr
<
	gIssueSŒuù
> *
	gissueToExecu‹Queue
;

248 
	gTimeBufãr
<
	gTimeSŒuù
> *
	gtimeBufãr
;

251 
ty³Çme
 
	gTimeBufãr
<
	gTimeSŒuù
>::
wœe
 
äomComm™
;

254 
FUPoŞ
 *
	gfuPoŞ
;

261 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
[
Im¶
::
MaxTh»ads
];

269 
	spqCom·»
 {

270 
boŞ
 
İ”©Ü
(è(cÚ¡ 
	gDynIn¡PŒ
 &
	glhs
, cÚ¡ DynIn¡PŒ &
	grhs
) const

272  
	glhs
->
	g£qNum
 > 
	grhs
->seqNum;

280 
	sIQEÁry
 {

281 
DynIn¡PŒ
 
	gš¡
;

282 
Li¡It
 
	giqIt
;

285 
	g¡d
::
	t´iÜ™y_queue
<
	tDynIn¡PŒ
, 
	t¡d
::
	tveùÜ
<DynIn¡PŒ>, 
	tpqCom·»
>

286 
	tR—dyIn¡Queue
;

288 
	g¡d
::
	tm­
<
	tDynIn¡PŒ
, 
	tpqCom·»
> 
	tR—dyIn¡M­
;

289 
ty³Çme
 
	t¡d
::
	tm­
<
	tDynIn¡PŒ
, 
	tpqCom·»
>::
	t™”©Ü
 
	tR—dyM­It
;

293 
R—dyIn¡Queue
 
	g»adyIn¡s
;

302 
	g¡d
::
m­
<
In¡SeqNum
, 
	gDynIn¡PŒ
> 
	gnÚS³cIn¡s
;

304 
ty³Çme
 
	t¡d
::
	tm­
<
	tIn¡SeqNum
, 
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tNÚS³cM­It
;

307 
	sLi¡Ord”EÁry
 {

308 
OpCÏss
 
	gqueueTy³
;

309 
In¡SeqNum
 
	gŞde¡In¡
;

316 
	g¡d
::
li¡
<
Li¡Ord”EÁry
> 
li¡Ord”
;

318 
ty³Çme
 
	t¡d
::
	tli¡
<
	tLi¡Ord”EÁry
>::
	t™”©Ü
 
	tLi¡Ord”It
;

321 
boŞ
 
	gqueueOnLi¡
[
Num_OpCÏs£s
];

326 
Li¡Ord”It
 
	g»adyIt
[
Num_OpCÏs£s
];

329 
addToOrd”Li¡
(
OpCÏss
 
İ_şass
);

335 
moveToYoung”In¡
(
Li¡Ord”It
 
age_Üd”_™
);

342 
	eIQPŞicy
 {

343 
	gDyÇmic
,

344 
	gP¬t™iÚed
,

345 
	gTh»shŞd


349 
IQPŞicy
 
	giqPŞicy
;

352 
	gnumTh»ads
;

355 
	gli¡
<> *
	gaùiveTh»ads
;

358 
	gcouÁ
[
Im¶
::
MaxTh»ads
];

361 
	gmaxEÁr›s
[
Im¶
::
MaxTh»ads
];

364 
	gä“EÁr›s
;

367 
	gnumEÁr›s
;

370 
	gtÙ®Width
;

373 
	gnumPhysRegs
;

376 
	gnumPhysIÁRegs
;

379 
	gnumPhysFlßtRegs
;

384 
	gcomm™ToIEWD–ay
;

391 
In¡SeqNum
 
	gsquashedSeqNum
[
Im¶
::
MaxTh»ads
];

396 
Li¡It
 
	gsquashIt
[
Im¶
::
MaxTh»ads
];

402 şas 
	cD•’d’cyEÁry


404 
	gpublic
:

405 
D•’d’cyEÁry
()

406 : 
š¡
(
NULL
), 
Ãxt
(NULL)

409 
DynIn¡PŒ
 
	gš¡
;

412 
D•’d’cyEÁry
 *
	gÃxt
;

421 
š£¹
(
DynIn¡PŒ
 &
Ãw_š¡
);

423 
»move
(
DynIn¡PŒ
 &
š¡_to_»move
);

426 
	gmem_®loc_couÁ”
;

435 
D•’d’cyEÁry
 *
	gd•’dG¿ph
;

443 
	gveùÜ
<
	gboŞ
> 
	g»gScÜebßrd
;

446 
boŞ
 
addToD•’d’ts
(
DynIn¡PŒ
 &
Ãw_š¡
);

449 
ü—‹D•’d’cy
(
DynIn¡PŒ
 &
Ãw_š¡
);

452 
addIfR—dy
(
DynIn¡PŒ
 &
š¡
);

458 
couÁIn¡s
();

462 
dumpD•’dG¿ph
();

468 
dumpLi¡s
();

473 
dumpIn¡s
();

476 
	gSts
::
SÿÏr
 
iqIn¡sAdded
;

478 
	gSts
::
SÿÏr
 
iqNÚS³cIn¡sAdded
;

481 
	gSts
::
SÿÏr
 
iqIÁIn¡sIssued
;

484 
	gSts
::
SÿÏr
 
iqFlßtIn¡sIssued
;

487 
	gSts
::
SÿÏr
 
iqB¿nchIn¡sIssued
;

490 
	gSts
::
SÿÏr
 
iqMemIn¡sIssued
;

493 
	gSts
::
SÿÏr
 
iqMiscIn¡sIssued
;

495 
	gSts
::
SÿÏr
 
iqSquashedIn¡sIssued
;

497 
	gSts
::
SÿÏr
 
iqSquashedIn¡sExamšed
;

501 
	gSts
::
SÿÏr
 
iqSquashedO³¿ndsExamšed
;

504 
	gSts
::
SÿÏr
 
iqSquashedNÚS³cRemoved
;

	@ozone/inst_queue_impl.hh

31 #iâdeà
__CPU_OZONE_INST_QUEUE_IMPL_HH__


32 
	#__CPU_OZONE_INST_QUEUE_IMPL_HH__


	)

42 
	~<veùÜ
>

44 
	~"ıu/ozÚe/š¡_queue.hh
"

45 
	~"sim/cÜe.hh
"

47 
	g‹m¶©e
 <
şass
 
	gIm¶
>

48 
	gIn¡Queue
<
	gIm¶
>::
FUCom¶‘iÚ
::FUCom¶‘iÚ(
DynIn¡PŒ
 &
_š¡
,

49 
fu_idx
,

50 
In¡Queue
<
Im¶
> *
iq_±r
)

51 : 
Ev’t
(&
mašEv’tQueue
, 
St_Ev’t_Pri
),

52 
š¡
(
_š¡
), 
fuIdx
(
fu_idx
), 
	$iqPŒ
(
iq_±r
)

54 
this
->
	`£tFÏgs
(
Ev’t
::
AutoD–‘e
);

55 
	}
}

57 
	g‹m¶©e
 <
şass
 
	gIm¶
>

59 
	gIn¡Queue
<
	gIm¶
>::
FUCom¶‘iÚ
::
	$´oûss
()

61 
iqPŒ
->
	`´oûssFUCom¶‘iÚ
(
š¡
, 
fuIdx
);

62 
	}
}

65 
	g‹m¶©e
 <
şass
 
	gIm¶
>

67 
	gIn¡Queue
<
	gIm¶
>::
FUCom¶‘iÚ
::
	$desütiÚ
() const

70 
	}
}

72 
	g‹m¶©e
 <
şass
 
	gIm¶
>

73 
	gIn¡Queue
<
	gIm¶
>::
	$In¡Queue
(
P¬ams
 *
·¿ms
)

74 : 
	`dÿcheIÁ”çû
(
·¿ms
->
dÿcheIÁ”çû
),

76 
	`numEÁr›s
(
·¿ms
->
numIQEÁr›s
),

77 
	`tÙ®Width
(
·¿ms
->
issueWidth
),

80 
	`comm™ToIEWD–ay
(
·¿ms
->
comm™ToIEWD–ay
)

85 
numTh»ads
 = 1;

88 
Th»adID
 
tid
 = 0;id <
numTh»ads
;id++) {

89 
couÁ
[
tid
] = 0;

93 
ä“EÁr›s
 = 
numEÁr›s
;

126 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

127 
squashedSeqNum
[
tid
] = 0;

183 
	}
}

185 
	g‹m¶©e
 <
şass
 
	gIm¶
>

186 
	gIn¡Queue
<
	gIm¶
>::~
	$In¡Queue
()

217 
	}
}

219 
‹m¶©e
 <
şass
 
Im¶
>

220 
¡d
::
¡ršg


221 
In¡Queue
<
Im¶
>::
	$Çme
() const

223  
ıu
->
	`Çme
() + ".iq";

224 
	}
}

226 
	g‹m¶©e
 <
şass
 
	gIm¶
>

228 
	gIn¡Queue
<
	gIm¶
>::
	$»gSts
()

230 
iqIn¡sAdded


231 .
	`Çme
(name() + ".iqInstsAdded")

232 .
	`desc
("Number of instructions‡ddedohe IQ (excludes‚on-spec)")

233 .
	`´”eq
(
iqIn¡sAdded
);

235 
iqNÚS³cIn¡sAdded


236 .
	`Çme
(name() + ".iqNonSpecInstsAdded")

237 .
	`desc
("Number of‚on-speculative instructions‡ddedohe IQ")

238 .
	`´”eq
(
iqNÚS³cIn¡sAdded
);

242 
iqIÁIn¡sIssued


243 .
	`Çme
(name() + ".iqIntInstsIssued")

244 .
	`desc
("Number of integer instructions issued")

245 .
	`´”eq
(
iqIÁIn¡sIssued
);

249 
iqFlßtIn¡sIssued


250 .
	`Çme
(name() + ".iqFloatInstsIssued")

251 .
	`desc
("Number of float instructions issued")

252 .
	`´”eq
(
iqFlßtIn¡sIssued
);

256 
iqB¿nchIn¡sIssued


257 .
	`Çme
(name() + ".iqBranchInstsIssued")

258 .
	`desc
("Number of branch instructions issued")

259 .
	`´”eq
(
iqB¿nchIn¡sIssued
);

263 
iqMemIn¡sIssued


264 .
	`Çme
(name() + ".iqMemInstsIssued")

265 .
	`desc
("Number of memory instructions issued")

266 .
	`´”eq
(
iqMemIn¡sIssued
);

270 
iqMiscIn¡sIssued


271 .
	`Çme
(name() + ".iqMiscInstsIssued")

272 .
	`desc
("Number of miscellaneous instructions issued")

273 .
	`´”eq
(
iqMiscIn¡sIssued
);

275 
iqSquashedIn¡sIssued


276 .
	`Çme
(name() + ".iqSquashedInstsIssued")

277 .
	`desc
("Number of squashed instructions issued")

278 .
	`´”eq
(
iqSquashedIn¡sIssued
);

280 
iqSquashedIn¡sExamšed


281 .
	`Çme
(name() + ".iqSquashedInstsExamined")

282 .
	`desc
("Number of squashed instructions iterated over during squash;"

284 .
	`´”eq
(
iqSquashedIn¡sExamšed
);

286 
iqSquashedO³¿ndsExamšed


287 .
	`Çme
(name() + ".iqSquashedOperandsExamined")

288 .
	`desc
("Number of squashed operandshat‡reƒxamined‡nd…ossibly "

290 .
	`´”eq
(
iqSquashedO³¿ndsExamšed
);

292 
iqSquashedNÚS³cRemoved


293 .
	`Çme
(name() + ".iqSquashedNonSpecRemoved")

294 .
	`desc
("Number of squashed‚on-spec instructionshat were„emoved")

295 .
	`´”eq
(
iqSquashedNÚS³cRemoved
);

302 
	}
}

312 
	g‹m¶©e
 <
şass
 
	gIm¶
>

314 
	gIn¡Queue
<
	gIm¶
>::
£tIssueToExecu‹Queue
(
TimeBufãr
<
IssueSŒuù
> *
i2e_±r
)

316 
DPRINTF
(
IQ
, "Sethe issueoƒxecute queue.\n");

317 
	gissueToExecu‹Queue
 = 
i2e_±r
;

364 
	g‹m¶©e
 <
şass
 
	gIm¶
>

366 
	gIn¡Queue
<
	gIm¶
>::
	$numF»eEÁr›s
()

368  
ä“EÁr›s
;

369 
	}
}

371 
	g‹m¶©e
 <
şass
 
	gIm¶
>

373 
	gIn¡Queue
<
	gIm¶
>::
	$numF»eEÁr›s
(
Th»adID
 
tid
)

375  
maxEÁr›s
[
tid
] - 
couÁ
[tid];

376 
	}
}

380 
	g‹m¶©e
 <
şass
 
	gIm¶
>

381 
boŞ


382 
	gIn¡Queue
<
	gIm¶
>::
	$isFuÎ
()

384 ià(
ä“EÁr›s
 == 0) {

385 (
Œue
);

387 (
çl£
);

389 
	}
}

391 
	g‹m¶©e
 <
şass
 
	gIm¶
>

392 
boŞ


393 
	gIn¡Queue
<
	gIm¶
>::
	$isFuÎ
(
Th»adID
 
tid
)

395 ià(
	`numF»eEÁr›s
(
tid
) == 0) {

396 (
Œue
);

398 (
çl£
);

400 
	}
}

402 
	g‹m¶©e
 <
şass
 
	gIm¶
>

403 
boŞ


404 
	gIn¡Queue
<
	gIm¶
>::
	$hasR—dyIn¡s
()

419  
»adyIn¡s
.
	`em±y
();

420 
	}
}

422 
	g‹m¶©e
 <
şass
 
	gIm¶
>

424 
	gIn¡Queue
<
	gIm¶
>::
	$š£¹
(
DynIn¡PŒ
 &
Ãw_š¡
)

427 
	`as£¹
(
Ãw_š¡
);

429 
	`DPRINTF
(
IQ
, "Adding instruction PC %#xohe IQ.\n",

430 
Ãw_š¡
->
	`»adPC
());

435 
	`as£¹
(
ä“EÁr›s
 != 0);

437 
š¡Li¡
[
Ãw_š¡
->
th»adNumb”
].
	`push_back
(new_inst);

440 --
ä“EÁr›s
;

459 
	`addIfR—dy
(
Ãw_š¡
);

462 ++
iqIn¡sAdded
;

466 
couÁ
[
Ãw_š¡
->
th»adNumb”
]++;

468 
	`as£¹
(
ä“EÁr›s
 =ğ(
numEÁr›s
 - 
	`couÁIn¡s
()));

469 
	}
}

471 
	g‹m¶©e
 <
şass
 
	gIm¶
>

473 
	gIn¡Queue
<
	gIm¶
>::
	$š£¹NÚS³c
(
DynIn¡PŒ
 &
Ãw_š¡
)

475 
nÚS³cIn¡s
[
Ãw_š¡
->
£qNum
] =‚ew_inst;

481 
	`as£¹
(
Ãw_š¡
);

483 
	`DPRINTF
(
IQ
, "Adding instruction PC %#xohe IQ.\n",

484 
Ãw_š¡
->
	`»adPC
());

489 
	`as£¹
(
ä“EÁr›s
 != 0);

491 
š¡Li¡
[
Ãw_š¡
->
th»adNumb”
].
	`push_back
(new_inst);

494 --
ä“EÁr›s
;

509 ++
iqNÚS³cIn¡sAdded
;

512 
couÁ
[
Ãw_š¡
->
th»adNumb”
]++;

514 
	`as£¹
(
ä“EÁr›s
 =ğ(
numEÁr›s
 - 
	`couÁIn¡s
()));

515 
	}
}

597 
	g‹m¶©e
 <
şass
 
	gIm¶
>

599 
	gIn¡Queue
<
	gIm¶
>::
	$scheduËR—dyIn¡s
()

601 
	`DPRINTF
(
IQ
, "Attemptingo schedule„eady instructions from "

727 
	}
}

729 
	g‹m¶©e
 <
şass
 
	gIm¶
>

731 
	gIn¡Queue
<
	gIm¶
>::
	$scheduËNÚS³c
(cÚ¡ 
In¡SeqNum
 &
š¡
)

733 
	`DPRINTF
(
IQ
, "Marking‚onspeculative instruction with sequence "

734 "numb” %˜a »adyØexecu‹.\n", 
š¡
);

736 
NÚS³cM­It
 
š¡_™
 = 
nÚS³cIn¡s
.
	`fšd
(
š¡
);

738 
	`as£¹
(
š¡_™
 !ğ
nÚS³cIn¡s
.
	`’d
());

743 (*
š¡_™
).
£cÚd
->
	`£tCªIssue
();

747 
	`addIfR—dy
((*
š¡_™
).
£cÚd
);

752 
nÚS³cIn¡s
.
	`”a£
(
š¡_™
);

753 
	}
}

755 
	g‹m¶©e
 <
şass
 
	gIm¶
>

757 
	gIn¡Queue
<
	gIm¶
>::
	$comm™
(cÚ¡ 
In¡SeqNum
 &
š¡
, 
Th»adID
 
tid
)

760 
	`DPRINTF
(
IQ
, "[tid:%i]: Committing instructions olderhan [sn:%i]\n",

761 
tid
,
š¡
);

763 
Li¡It
 
iq_™
 = 
š¡Li¡
[
tid
].
	`begš
();

765 
iq_™
 !ğ
š¡Li¡
[
tid
].
	`’d
() &&

766 (*
iq_™
)->
£qNum
 <ğ
š¡
) {

767 ++
iq_™
;

768 
š¡Li¡
[
tid
].
	`pİ_äÚt
();

771 
	`as£¹
(
ä“EÁr›s
 =ğ(
numEÁr›s
 - 
	`couÁIn¡s
()));

772 
	}
}

774 
	g‹m¶©e
 <
şass
 
	gIm¶
>

776 
	gIn¡Queue
<
	gIm¶
>::
	$wakeD•’d’ts
(
DynIn¡PŒ
 &
com¶‘ed_š¡
)

778 
	`DPRINTF
(
IQ
, "Waking dependents of completed instruction.\n");

792 ià(
com¶‘ed_š¡
->
	`isMemRef
()) {

794 
	`com¶‘eMemIn¡
(
com¶‘ed_š¡
);

796 
com¶‘ed_š¡
->
	`wakeD•’d’ts
();

851 
	}
}

853 
	g‹m¶©e
 <
şass
 
	gIm¶
>

855 
	gIn¡Queue
<
	gIm¶
>::
	$addR—dyMemIn¡
(
DynIn¡PŒ
 &
»ady_š¡
)

859 
»adyIn¡s
.
	`push
(
»ady_š¡
);

861 
	`DPRINTF
(
IQ
, "Instruction is„eadyo issue,…utting it onto "

863 
»ady_š¡
->
	`»adPC
(),„—dy_š¡->
	`İCÏss
(),„—dy_š¡->
£qNum
);

864 
	}
}

880 
	g‹m¶©e
 <
şass
 
	gIm¶
>

882 
	gIn¡Queue
<
	gIm¶
>::
	$com¶‘eMemIn¡
(
DynIn¡PŒ
 &
com¶‘ed_š¡
)

884 
Th»adID
 
tid
 = 
com¶‘ed_š¡
->
th»adNumb”
;

886 
	`DPRINTF
(
IQ
, "Completing mem instruction PC:%#x [sn:%lli]\n",

887 
com¶‘ed_š¡
->
	`»adPC
(), com¶‘ed_š¡->
£qNum
);

889 ++
ä“EÁr›s
;

895 
couÁ
[
tid
]--;

896 
	}
}

906 
	g‹m¶©e
 <
şass
 
	gIm¶
>

908 
	gIn¡Queue
<
	gIm¶
>::
	$squash
(
Th»adID
 
tid
)

910 
	`DPRINTF
(
IQ
, "[tid:%i]: Startingo squash instructions in "

911 "thIQ.\n", 
tid
);

918 
squashIt
[
tid
] = 
š¡Li¡
[tid].
	`’d
();

919 --
squashIt
[
tid
];

922 ià(
couÁ
[
tid
] > 0) {

923 
	`doSquash
(
tid
);

928 
	}
}

930 
	g‹m¶©e
 <
şass
 
	gIm¶
>

932 
	gIn¡Queue
<
	gIm¶
>::
	$doSquash
(
Th»adID
 
tid
)

935 
	`as£¹
(
squashedSeqNum
[
tid
] != 0);

937 
	`DPRINTF
(
IQ
, "[tid:%i]: Squashing until sequence‚umber %i!\n",

938 
tid
, 
squashedSeqNum
[tid]);

942 
squashIt
[
tid
] !ğ
š¡Li¡
[tid].
	`’d
() &&

943 (*
squashIt
[
tid
])->
£qNum
 > 
squashedSeqNum
[tid]) {

945 
DynIn¡PŒ
 
squashed_š¡
 = (*
squashIt
[
tid
]);

949 ià(
squashed_š¡
->
th»adNumb”
 !ğ
tid
 ||

950 
squashed_š¡
->
	`isSquashedInIQ
()) {

951 --
squashIt
[
tid
];

955 ià(!
squashed_š¡
->
	`isIssued
() ||

956 (
squashed_š¡
->
	`isMemRef
()

960 ià(!
squashed_š¡
->
	`isNÚS³cuÏtive
()) {

991 
nÚS³cIn¡s
[
squashed_š¡
->
£qNum
] = 
NULL
;

993 
nÚS³cIn¡s
.
	`”a£
(
squashed_š¡
->
£qNum
);

995 ++
iqSquashedNÚS³cRemoved
;

1001 
squashed_š¡
->
	`£tSquashedInIQ
();

1005 
squashed_š¡
->
	`£tIssued
();

1006 
squashed_š¡
->
	`£tCªComm™
();

1010 
couÁ
[
squashed_š¡
->
th»adNumb”
]--;

1012 ++
ä“EÁr›s
;

1014 ià(
numTh»ads
 > 1) {

1015 
	`DPRINTF
(
IQ
, "[tid:%i]: Instruction PC %#x squashed.\n",

1016 
tid
, 
squashed_š¡
->
	`»adPC
());

1018 
	`DPRINTF
(
IQ
, "Instruction PC %#x squashed.\n",

1019 
squashed_š¡
->
	`»adPC
());

1023 --
squashIt
[
tid
];

1024 ++
iqSquashedIn¡sExamšed
;

1026 
	}
}

1163 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1165 
	gIn¡Queue
<
	gIm¶
>::
	$addIfR—dy
(
DynIn¡PŒ
 &
š¡
)

1169 ià(
š¡
->
	`»adyToIssue
()) {

1172 ià(
š¡
->
	`isMemRef
()) {

1174 
	`DPRINTF
(
IQ
, "Checking if memory instruction can issue.\n");

1186 
	`DPRINTF
(
IQ
, "Instruction is„eadyo issue,…utting it onto "

1188 
š¡
->
	`»adPC
(), in¡->
	`İCÏss
(), in¡->
£qNum
);

1190 
»adyIn¡s
.
	`push
(
š¡
);

1192 
	}
}

1194 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1196 
	gIn¡Queue
<
	gIm¶
>::
	$couÁIn¡s
()

1203 
tÙ®_š¡s
 = 0;

1205 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

1206 
Li¡It
 
couÁ_™
 = 
š¡Li¡
[
tid
].
	`begš
();

1208 
couÁ_™
 !ğ
š¡Li¡
[
tid
].
	`’d
()) {

1209 ià(!(*
couÁ_™
)->
	`isSquashed
(è&& !(*couÁ_™)->
	`isSquashedInIQ
()) {

1210 ià(!(*
couÁ_™
)->
	`isIssued
()) {

1211 ++
tÙ®_š¡s
;

1212 } ià((*
couÁ_™
)->
	`isMemRef
() &&

1213 !(*
couÁ_™
)->
memOpDÚe
) {

1216 ++
tÙ®_š¡s
;

1220 ++
couÁ_™
;

1224  
tÙ®_š¡s
;

1226  
numEÁr›s
 - 
ä“EÁr›s
;

1228 
	}
}

1258 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1260 
	gIn¡Queue
<
	gIm¶
>::
	$dumpLi¡s
()

1262 
i
 = 0; i < 
Num_OpCÏs£s
; ++i) {

1263 
	`ırštf
("R—dy†i¡ %˜size: %i\n", 
i
, 
»adyIn¡s
.
	`size
());

1265 
	`ırštf
("\n");

1268 
	`ırštf
("NÚ s³cuÏtivli¡ size: %i\n", 
nÚS³cIn¡s
.
	`size
());

1270 
NÚS³cM­It
 
nÚ_¥ec_™
 = 
nÚS³cIn¡s
.
	`begš
();

1271 
NÚS³cM­It
 
nÚ_¥ec_’d_™
 = 
nÚS³cIn¡s
.
	`’d
();

1273 
	`ırštf
("Non speculative†ist: ");

1275 
nÚ_¥ec_™
 !ğ
nÚ_¥ec_’d_™
) {

1276 
	`ırštf
("%#x [¢:%Îi]", (*
nÚ_¥ec_™
).
£cÚd
->
	`»adPC
(),

1277 (*
nÚ_¥ec_™
).
£cÚd
->
£qNum
);

1278 ++
nÚ_¥ec_™
;

1281 
	`ırštf
("\n");

1297 
	`ırštf
("\n");

1298 
	}
}

1301 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1303 
	gIn¡Queue
<
	gIm¶
>::
	$dumpIn¡s
()

1305 
Th»adID
 
tid
 = 0;id < 
numTh»ads
; ++tid) {

1347 
	}
}

	@ozone/lsq_unit.cc

31 
	~"ıu/ozÚe/lsq_un™_im¶.hh
"

32 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gOzÚeLSQ
<
	gOzÚeIm¶
>;

	@ozone/lsq_unit.hh

31 #iâdeà
__CPU_OZONE_LSQ_UNIT_HH__


32 
	#__CPU_OZONE_LSQ_UNIT_HH__


	)

34 
	~<®gÜ™hm
>

35 
	~<m­
>

36 
	~<queue
>

38 
	~"¬ch/ty³s.hh
"

39 
	~"ba£/hashm­.hh
"

40 
	~"cÚfig/the_i§.hh
"

41 
	~"ıu/š¡_£q.hh
"

42 
	~"mem/mem_š‹rçû.hh
"

44 
	~"sim/çuÉ_fwd.hh
"

45 
	~"sim/sim_objeù.hh
"

47 
şass
 
	gPageTabË
;

60 
	g‹m¶©e
 <
şass
 
	gIm¶
>

61 şas 
	cOzÚeLSQ
 {

62 
	mpublic
:

63 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

64 
ty³Çme
 
	tIm¶
::
	tFuÎCPU
 FullCPU;

65 
ty³Çme
 
	tIm¶
::
	tBackEnd
 BackEnd;

66 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

67 
ty³Çme
 
	tIm¶
::
	tIssueSŒuù
 IssueStruct;

69 
	mTheISA
::
	tIÁReg
 IntReg;

71 
ty³Çme
 
	t¡d
::
	tm­
<
	tIn¡SeqNum
, 
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLdM­It
;

73 
	m´iv©e
:

74 şas 
	cStÜeCom¶‘iÚEv’t
 : 
public
 
Ev’t
 {

75 
public
:

77 
StÜeCom¶‘iÚEv’t
(
¡Üe_idx
, 
Ev’t
 *
wb_ev’t
, 
OzÚeLSQ
 *
lsq_±r
);

80 
´oûss
();

83 cÚ¡ *
desütiÚ
() const;

85 
	m´iv©e
:

87 
¡ÜeIdx
;

91 
Ev’t
 *
	mwbEv’t
;

93 
	mOzÚeLSQ
<
	mIm¶
> *
	mlsqPŒ
;

96 
ä›nd
 
şass
 
	gStÜeCom¶‘iÚEv’t
;

98 
	gpublic
:

100 
OzÚeLSQ
();

103 
š™
(
P¬ams
 *
·¿ms
, 
maxLQEÁr›s
,

104 
maxSQEÁr›s
, 
id
);

107 
	g¡d
::
¡ršg
 
	$Çme
() const;

110 
	$£tCPU
(
FuÎCPU
 *
ıu_±r
)

111 { 
ıu
 = 
ıu_±r
; 
	}
}

114 
	$£tBE
(
BackEnd
 *
be_±r
)

115 { 
be
 = 
be_±r
; 
	}
}

122 
	$tick
(è{ 
u£dPÜts
 = 0; 
	}
}

125 
š£¹
(
DynIn¡PŒ
 &
š¡
);

127 
š£¹Lßd
(
DynIn¡PŒ
 &
lßd_š¡
);

129 
š£¹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
);

132 
FauÉ
 
execu‹Lßd
(
DynIn¡PŒ
 &
š¡
);

134 
FauÉ
 
execu‹Lßd
(
lq_idx
);

136 
FauÉ
 
execu‹StÜe
(
DynIn¡PŒ
 &
š¡
);

139 
comm™Lßd
();

141 
comm™Lßd
(
In¡SeqNum
 &
š¡
);

143 
comm™Lßds
(
In¡SeqNum
 &
younge¡_š¡
);

146 
comm™StÜes
(
In¡SeqNum
 &
younge¡_š¡
);

149 
wr™ebackStÜes
();

155 
ş—rLQ
();

158 
ş—rSQ
();

161 
»sizeLQ
(
size
);

164 
»sizeSQ
(
size
);

167 
squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
);

172 
boŞ
 
	$viŞ©iÚ
(è{  
memD•ViŞ©Ü
; 
	}
}

175 
DynIn¡PŒ
 
g‘MemD•ViŞ©Ü
();

180 
šlše
 
boŞ
 
lßdBlocked
();

183 
numF»eEÁr›s
();

186 
numLßdsR—dy
();

189 
	$numLßds
(è{  
lßds
; 
	}
}

192 
	$numStÜes
(è{  
¡Ües
; 
	}
}

195 
boŞ
 
	$isFuÎ
(è{  
	`lqFuÎ
(è|| 
	`sqFuÎ
(); 
	}
}

198 
boŞ
 
	$lqFuÎ
(è{  
lßds
 >ğ(
LQEÁr›s
 - 1); 
	}
}

201 
boŞ
 
	$sqFuÎ
(è{  
¡Ües
 >ğ(
SQEÁr›s
 - 1); 
	}
}

204 
dumpIn¡s
();

207 
	$g‘CouÁ
(è{  
lßds
 + 
¡Ües
; 
	}
}

210 
boŞ
 
	$hasStÜesToWB
(è{  
¡ÜesToWB
; 
	}
}

213 
	$numStÜesToWB
(è{  
¡ÜesToWB
; 
	}
}

216 
boŞ
 
	$wlWB
(è{  
¡ÜeQueue
[
¡ÜeWBIdx
].
ÿnWB
 &&

217 !
¡ÜeQueue
[
¡ÜeWBIdx
].
com¶‘ed
 &&

218 !
dÿcheIÁ”çû
->
	`isBlocked
(); 
	}
}

220 
	g´iv©e
:

222 
com¶‘eStÜe
(
¡Üe_idx
);

225 
šlše
 
šüStIdx
(&
¡Üe_idx
);

227 
šlše
 
deüStIdx
(&
¡Üe_idx
);

229 
šlše
 
šüLdIdx
(&
lßd_idx
);

231 
šlše
 
deüLdIdx
(&
lßd_idx
);

233 
	g´iv©e
:

235 
FuÎCPU
 *
ıu
;

238 
BackEnd
 *
	gbe
;

241 
MemIÁ”çû
 *
	gdÿcheIÁ”çû
;

244 
PageTabË
 *
	gpTabË
;

246 
	gpublic
:

247 
	sSQEÁry
 {

249 
SQEÁry
()

250 : 
š¡
(
NULL
), 
»q
(NULL), 
size
(0), 
d©a
(0),

251 
ÿnWB
(0), 
comm™‹d
(0), 
com¶‘ed
(0)

255 
SQEÁry
(
DynIn¡PŒ
 &
_š¡
)

256 : 
š¡
(
_š¡
), 
»q
(
NULL
), 
size
(0), 
d©a
(0),

257 
ÿnWB
(0), 
comm™‹d
(0), 
com¶‘ed
(0)

261 
DynIn¡PŒ
 
	gš¡
;

263 
MemReqPŒ
 
	g»q
;

265 
	gsize
;

267 
IÁReg
 
	gd©a
;

269 
boŞ
 
	gÿnWB
;

271 
boŞ
 
	gcomm™‹d
;

273 
boŞ
 
	gcom¶‘ed
;

276 
	eStus
 {

277 
	gRuÂšg
,

278 
	gIdË
,

279 
	gDÿcheMissSÎ
,

280 
	gDÿcheMissSw™ch


283 
	g´iv©e
:

285 
lsqID
;

288 
Stus
 
	g_¡©us
;

291 
	g¡d
::
veùÜ
<
SQEÁry
> 
¡ÜeQueue
;

294 
	g¡d
::
veùÜ
<
DynIn¡PŒ
> 
lßdQueue
;

298 
	gLQEÁr›s
;

300 
	gSQEÁr›s
;

303 
	glßds
;

307 
	g¡Ües
;

309 
	g¡ÜesToWB
;

312 
	glßdH—d
;

314 
	glßdTa
;

317 
	g¡ÜeH—d
;

321 
	g¡ÜeWBIdx
;

323 
	g¡ÜeTa
;

327 
	gÿchePÜts
;

330 
	gu£dPÜts
;

335 
CouÁ”
 
	gÏ¡DÿcheSÎ
;

338 
ty³Çme
 
	gTimeBufãr
<
	gIssueSŒuù
>::
wœe
 
äomIssue
;

342 
boŞ
 
	g¡®Ëd
;

346 
In¡SeqNum
 
	g¡®lšgStÜeI¢
;

348 
	g¡®lšgLßdIdx
;

353 
boŞ
 
	gisLßdBlocked
;

356 
DynIn¡PŒ
 
	glßdFauÉIn¡
;

358 
DynIn¡PŒ
 
	g¡ÜeFauÉIn¡
;

361 
DynIn¡PŒ
 
	gmemD•ViŞ©Ü
;

367 
	gpublic
:

369 
‹m¶©e
 <
şass
 
T
>

370 
FauÉ
 
»ad
(
MemReqPŒ
 &
»q
, 
T
 &
d©a
, 
lßd_idx
);

373 
	g‹m¶©e
 <
şass
 
	gT
>

374 
FauÉ
 
wr™e
(
MemReqPŒ
 &
»q
, 
T
 &
d©a
, 
¡Üe_idx
);

377 
	$g‘LßdH—d
(è{  
lßdH—d
; 
	}
}

379 
In¡SeqNum
 
	$g‘LßdH—dSeqNum
()

381 ià(
lßdQueue
[
lßdH—d
]) {

382  
lßdQueue
[
lßdH—d
]->
£qNum
;

387 
	}
}

390 
	$g‘StÜeH—d
(è{  
¡ÜeH—d
; 
	}
}

392 
In¡SeqNum
 
	$g‘StÜeH—dSeqNum
()

394 ià(
¡ÜeQueue
[
¡ÜeH—d
].
š¡
) {

395  
¡ÜeQueue
[
¡ÜeH—d
].
š¡
->
£qNum
;

400 
	}
}

403 
boŞ
 
	$isSÎed
(è{  
¡®Ëd
; 
	}
}

406 
	g‹m¶©e
 <
şass
 
	gIm¶
>

407 
	g‹m¶©e
 <
şass
 
	gT
>

408 
FauÉ


409 
	gOzÚeLSQ
<
	gIm¶
>::
	$»ad
(
MemReqPŒ
 &
»q
, 
T
 &
d©a
, 
lßd_idx
)

414 
	`as£¹
(
lßdQueue
[
lßd_idx
]);

416 ià(
lßdQueue
[
lßd_idx
]->
	`isExecu‹d
()) {

417 
	`·nic
("Should‚ot„eachhis…oint with split ops!");

419 
	`memıy
(&
d©a
,
»q
->d©a,»q->
size
);

421  
NoFauÉ
;

429 ià(
»q
->
	`isUnÿch—bË
() &&

430 (
lßd_idx
 !ğ
lßdH—d
 || !
lßdQueue
[lßd_idx]->
	`»adyToComm™
())) {

432  
TheISA
::
	`g’MachšeCheckFauÉ
();

436 
¡Üe_idx
 = 
lßdQueue
[
lßd_idx
]->
sqIdx
;

438 
¡Üe_size
 = 0;

440 
	`DPRINTF
(
OzÚeLSQ
, "Read called,†oad idx: %i, store idx: %i, "

442 
lßd_idx
, 
¡Üe_idx
, 
¡ÜeH—d
, 
»q
->
·ddr
);

444 
¡Üe_idx
 != -1) {

446 ià(
¡Üe_idx
 =ğ
¡ÜeWBIdx
) {

451 ià(--
¡Üe_idx
 < 0)

452 
¡Üe_idx
 +ğ
SQEÁr›s
;

454 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

456 
¡Üe_size
 = 
¡ÜeQueue
[
¡Üe_idx
].
size
;

458 ià(
¡Üe_size
 == 0)

463 
boŞ
 
¡Üe_has_low”_lim™
 =

464 
»q
->
vaddr
 >ğ
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
;

465 
boŞ
 
¡Üe_has_uµ”_lim™
 =

466 (
»q
->
vaddr
 +„eq->
size
è<ğ(
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
 +

467 
¡Üe_size
);

468 
boŞ
 
low”_lßd_has_¡Üe_·¹
 =

469 
»q
->
vaddr
 < (
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
 +

470 
¡Üe_size
);

471 
boŞ
 
uµ”_lßd_has_¡Üe_·¹
 =

472 (
»q
->
vaddr
 +„eq->
size
è> 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
effAddr
;

475 ià(
¡Üe_has_low”_lim™
 && 
¡Üe_has_uµ”_lim™
) {

477 
shiá_amt
 = 
»q
->
vaddr
 & (
¡Üe_size
 - 1);

479 
shiá_amt
 = shift_amt << 3;

482 
d©a
 = 
¡ÜeQueue
[
¡Üe_idx
].d©¨>> 
shiá_amt
;

484 
»q
->
cmd
 = 
R—d
;

485 
	`as£¹
(!
»q
->
com¶‘iÚEv’t
);

486 
»q
->
com¶‘iÚEv’t
 = 
NULL
;

487 
»q
->
time
 = 
	`curTick
();

488 
	`as£¹
(!
»q
->
d©a
);

489 
»q
->
d©a
 = 
Ãw
 
ušt8_t
[64];

491 
	`memıy
(
»q
->
d©a
, &d©a,„eq->
size
);

493 
	`DPRINTF
(
OzÚeLSQ
, "Forwarding from store idx %io†oado "

495 
¡Üe_idx
, 
»q
->
vaddr
, *Ôeq->
d©a
));

497 
ty³Çme
 
BackEnd
::
LdWr™ebackEv’t
 *
wb
 =

498 
Ãw
 
ty³Çme
 
BackEnd
::
	`LdWr™ebackEv’t
(
lßdQueue
[
lßd_idx
],

499 
be
);

504 
wb
->
	`scheduË
(
	`curTick
());

507  
NoFauÉ
;

508 } ià((
¡Üe_has_low”_lim™
 && 
low”_lßd_has_¡Üe_·¹
) ||

509 (
¡Üe_has_uµ”_lim™
 && 
uµ”_lßd_has_¡Üe_·¹
) ||

510 (
low”_lßd_has_¡Üe_·¹
 && 
uµ”_lßd_has_¡Üe_·¹
)) {

516 ià(
¡ÜeQueue
[
¡Üe_idx
].
com¶‘ed
) {

522 ià(!
¡®Ëd
 ||

523 (
¡®Ëd
 &&

524 
lßdQueue
[
lßd_idx
]->
£qNum
 <

525 
lßdQueue
[
¡®lšgLßdIdx
]->
£qNum
)) {

526 
¡®Ëd
 = 
Œue
;

527 
¡®lšgStÜeI¢
 = 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
;

528 
¡®lšgLßdIdx
 = 
lßd_idx
;

533 
be
->
	`»scheduËMemIn¡
(
lßdQueue
[
lßd_idx
]);

535 
	`DPRINTF
(
OzÚeLSQ
, "Load-store forwarding mis-match. "

537 
¡Üe_idx
, 
»q
->
vaddr
);

539  
NoFauÉ
;

545 
DynIn¡PŒ
 
š¡
 = 
lßdQueue
[
lßd_idx
];

547 ++
u£dPÜts
;

550 ià(
dÿcheIÁ”çû
) {

551 ià(
dÿcheIÁ”çû
->
	`isBlocked
()) {

552 
isLßdBlocked
 = 
Œue
;

554  
NoFauÉ
;

557 
	`DPRINTF
(
OzÚeLSQ
, "D-cache: PC:%#x„eading from…addr:%#x "

559 
š¡
->
	`»adPC
(), 
»q
->
·ddr
,„eq->
vaddr
,„eq->
æags
);

562 
»q
->
cmd
 = 
R—d
;

563 
»q
->
com¶‘iÚEv’t
 = 
NULL
;

564 
»q
->
time
 = 
	`curTick
();

565 
	`as£¹
(!
»q
->
d©a
);

566 
»q
->
d©a
 = 
Ãw
 
ušt8_t
[64];

568 
	`as£¹
(!
»q
->
com¶‘iÚEv’t
);

569 
ty³Çme
 
	tBackEnd
::
	tLdWr™ebackEv’t
 LdWritebackEvent;

571 
LdWr™ebackEv’t
 *
wb
 = 
Ãw
 
	`LdWr™ebackEv’t
(
lßdQueue
[
lßd_idx
], 
be
);

573 
»q
->
com¶‘iÚEv’t
 = 
wb
;

576 
MemAcûssResuÉ
 
»suÉ
 = 
dÿcheIÁ”çû
->
	`acûss
(
»q
);

582 ià(
»suÉ
 !ğ
MA_HIT
) {

583 
	`DPRINTF
(
OzÚeLSQ
, "D-cache miss!\n");

584 
	`DPRINTF
(
Aùiv™y
, "Activity:†d‡ccessing mem miss [sn:%lli]\n",

585 
š¡
->
£qNum
);

587 
Ï¡DÿcheSÎ
 = 
	`curTick
();

589 
_¡©us
 = 
DÿcheMissSÎ
;

591 
wb
->
	`£tDÿcheMiss
();

597 
	`DPRINTF
(
OzÚeLSQ
, "D-cache hit!\n");

600 
	`çl
("Must use D-cache with‚ew memory system");

603  
NoFauÉ
;

604 
	}
}

606 
	g‹m¶©e
 <
şass
 
	gIm¶
>

607 
	g‹m¶©e
 <
şass
 
	gT
>

608 
FauÉ


609 
	gOzÚeLSQ
<
	gIm¶
>::
	$wr™e
(
MemReqPŒ
 &
»q
, 
T
 &
d©a
, 
¡Üe_idx
)

611 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

613 
	`DPRINTF
(
OzÚeLSQ
, "Doing writeo store idx %i,‡ddr %#x data %#x"

615 
¡Üe_idx
, 
»q
->
·ddr
, 
d©a
, 
¡ÜeH—d
,

616 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
);

618 
¡ÜeQueue
[
¡Üe_idx
].
»q
 =„eq;

619 
¡ÜeQueue
[
¡Üe_idx
].
size
 = (
T
);

620 
¡ÜeQueue
[
¡Üe_idx
].
d©a
 = data;

624  
NoFauÉ
;

625 
	}
}

627 
	g‹m¶©e
 <
şass
 
	gIm¶
>

628 
šlše
 
boŞ


629 
	gOzÚeLSQ
<
	gIm¶
>::
	$lßdBlocked
()

631 
boŞ
 
»t_v®
 = 
isLßdBlocked
;

632 
isLßdBlocked
 = 
çl£
;

633  
»t_v®
;

634 
	}
}

	@ozone/lsq_unit_impl.hh

30 #iâdeà
__CPU_OZONE_LSQ_UNIT_IMPL_HH__


31 
	#__CPU_OZONE_LSQ_UNIT_IMPL_HH__


	)

33 
	~"ba£/¡r.hh
"

34 
	~"cÚfig/the_i§.hh
"

35 
	~"ıu/ozÚe/lsq_un™.hh
"

36 
	~"sim/çuÉ_fwd.hh
"

38 
	g‹m¶©e
 <
şass
 
	gIm¶
>

39 
	gOzÚeLSQ
<
	gIm¶
>::
StÜeCom¶‘iÚEv’t
::StÜeCom¶‘iÚEv’t(
¡Üe_idx
,

40 
Ev’t
 *
wb_ev’t
,

41 
OzÚeLSQ
<
Im¶
> *
lsq_±r
)

42 : 
Ev’t
(&
mašEv’tQueue
),

43 
¡ÜeIdx
(
¡Üe_idx
),

44 
wbEv’t
(
wb_ev’t
),

45 
	$lsqPŒ
(
lsq_±r
)

47 
this
->
	`£tFÏgs
(
Ev’t
::
AutoD–‘e
);

48 
	}
}

50 
	g‹m¶©e
 <
şass
 
	gIm¶
>

52 
	gOzÚeLSQ
<
	gIm¶
>::
StÜeCom¶‘iÚEv’t
::
	$´oûss
()

54 
	`DPRINTF
(
OzÚeLSQ
, "Cachmis com¶‘fÜ stÜidx:%i\n", 
¡ÜeIdx
);

59 ià(
wbEv’t
)

60 
wbEv’t
->
	`´oûss
();

61 
lsqPŒ
->
	`com¶‘eStÜe
(
¡ÜeIdx
);

62 
	}
}

64 
	g‹m¶©e
 <
şass
 
	gIm¶
>

66 
	gOzÚeLSQ
<
	gIm¶
>::
StÜeCom¶‘iÚEv’t
::
	$desütiÚ
() const

69 
	}
}

71 
	g‹m¶©e
 <
şass
 
	gIm¶
>

72 
	gOzÚeLSQ
<
	gIm¶
>::
	$OzÚeLSQ
()

73 : 
	`lßds
(0), 
	`¡Ües
(0), 
	`¡ÜesToWB
(0), 
	`¡®Ëd
(
çl£
), 
	$isLßdBlocked
(
çl£
)

75 
	}
}

77 
	g‹m¶©e
<
şass
 
	gIm¶
>

79 
	gOzÚeLSQ
<
	gIm¶
>::
	$š™
(
P¬ams
 *
·¿ms
, 
maxLQEÁr›s
,

80 
maxSQEÁr›s
, 
id
)

83 
	`DPRINTF
(
OzÚeLSQ
, "C»©šg OzÚeLSQ%˜objeù.\n",
id
);

85 
lsqID
 = 
id
;

87 
LQEÁr›s
 = 
maxLQEÁr›s
;

88 
SQEÁr›s
 = 
maxSQEÁr›s
;

90 
lßdQueue
.
	`»size
(
LQEÁr›s
);

91 
¡ÜeQueue
.
	`»size
(
SQEÁr›s
);

96 
lßdH—d
 = 
lßdTa
 = 0;

98 
¡ÜeH—d
 = 
¡ÜeWBIdx
 = 
¡ÜeTa
 = 0;

100 
u£dPÜts
 = 0;

101 
ÿchePÜts
 = 
·¿ms
->cachePorts;

103 
dÿcheIÁ”çû
 = 
·¿ms
->dcacheInterface;

105 
lßdFauÉIn¡
 = 
¡ÜeFauÉIn¡
 = 
memD•ViŞ©Ü
 = 
NULL
;

106 
	}
}

108 
	g‹m¶©e
<
şass
 
	gIm¶
>

109 
	g¡d
::
¡ršg


110 
OzÚeLSQ
<
Im¶
>::
	$Çme
() const

113 
	}
}

115 
	g‹m¶©e
<
şass
 
	gIm¶
>

117 
	gOzÚeLSQ
<
	gIm¶
>::
	$ş—rLQ
()

119 
lßdQueue
.
	`ş—r
();

120 
	}
}

122 
	g‹m¶©e
<
şass
 
	gIm¶
>

124 
	gOzÚeLSQ
<
	gIm¶
>::
	$ş—rSQ
()

126 
¡ÜeQueue
.
	`ş—r
();

127 
	}
}

129 
	g‹m¶©e
<
şass
 
	gIm¶
>

131 
	gOzÚeLSQ
<
	gIm¶
>::
	$»sizeLQ
(
size
)

133 
	`as£¹
Ğ
size
 >ğ
LQEÁr›s
);

135 ià(
size
 > 
LQEÁr›s
) {

136 
size
 > 
lßdQueue
.
	`size
()) {

137 
DynIn¡PŒ
 
dummy
;

138 
lßdQueue
.
	`push_back
(
dummy
);

139 
LQEÁr›s
++;

142 
LQEÁr›s
 = 
size
;

145 
	}
}

147 
	g‹m¶©e
<
şass
 
	gIm¶
>

149 
	gOzÚeLSQ
<
	gIm¶
>::
	$»sizeSQ
(
size
)

151 ià(
size
 > 
SQEÁr›s
) {

152 
size
 > 
¡ÜeQueue
.
	`size
()) {

153 
SQEÁry
 
dummy
;

154 
¡ÜeQueue
.
	`push_back
(
dummy
);

155 
SQEÁr›s
++;

158 
SQEÁr›s
 = 
size
;

160 
	}
}

162 
	g‹m¶©e
 <
şass
 
	gIm¶
>

164 
	gOzÚeLSQ
<
	gIm¶
>::
	$š£¹
(
DynIn¡PŒ
 &
š¡
)

167 
	`as£¹
(
š¡
->
	`isMemRef
());

170 
	`as£¹
(
š¡
->
	`isLßd
(è|| in¡->
	`isStÜe
());

172 ià(
š¡
->
	`isLßd
()) {

173 
	`š£¹Lßd
(
š¡
);

175 
	`š£¹StÜe
(
š¡
);

179 
	}
}

181 
	g‹m¶©e
 <
şass
 
	gIm¶
>

183 
	gOzÚeLSQ
<
	gIm¶
>::
	$š£¹Lßd
(
DynIn¡PŒ
 &
lßd_š¡
)

185 
	`as£¹
((
lßdTa
 + 1è% 
LQEÁr›s
 !ğ
lßdH—d
 && 
lßds
 < LQEntries);

187 
	`DPRINTF
(
OzÚeLSQ
, "Inserting†oad PC %#x, idx:%i [sn:%lli]\n",

188 
lßd_š¡
->
	`»adPC
(), 
lßdTa
,†ßd_š¡->
£qNum
);

190 
lßd_š¡
->
lqIdx
 = 
lßdTa
;

192 ià(
¡Ües
 == 0) {

193 
lßd_š¡
->
sqIdx
 = -1;

195 
lßd_š¡
->
sqIdx
 = 
¡ÜeTa
;

198 
lßdQueue
[
lßdTa
] = 
lßd_š¡
;

200 
	`šüLdIdx
(
lßdTa
);

202 ++
lßds
;

203 
	}
}

205 
	g‹m¶©e
 <
şass
 
	gIm¶
>

207 
	gOzÚeLSQ
<
	gIm¶
>::
	$š£¹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
)

210 
	`as£¹
((
¡ÜeTa
 + 1è% 
SQEÁr›s
 !ğ
¡ÜeH—d
);

211 
	`as£¹
(
¡Ües
 < 
SQEÁr›s
);

213 
	`DPRINTF
(
OzÚeLSQ
, "Inserting store PC %#x, idx:%i [sn:%lli]\n",

214 
¡Üe_š¡
->
	`»adPC
(), 
¡ÜeTa
, stÜe_š¡->
£qNum
);

216 
¡Üe_š¡
->
sqIdx
 = 
¡ÜeTa
;

217 
¡Üe_š¡
->
lqIdx
 = 
lßdTa
;

219 
¡ÜeQueue
[
¡ÜeTa
] = 
	`SQEÁry
(
¡Üe_š¡
);

221 
	`šüStIdx
(
¡ÜeTa
);

223 ++
¡Ües
;

225 
	}
}

227 
	g‹m¶©e
 <
şass
 
	gIm¶
>

228 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


229 
OzÚeLSQ
<
Im¶
>::
	$g‘MemD•ViŞ©Ü
()

231 
DynIn¡PŒ
 
‹mp
 = 
memD•ViŞ©Ü
;

233 
memD•ViŞ©Ü
 = 
NULL
;

235  
‹mp
;

236 
	}
}

238 
	g‹m¶©e
 <
şass
 
	gIm¶
>

240 
	gOzÚeLSQ
<
	gIm¶
>::
	$numF»eEÁr›s
()

242 
ä“_lq_’Œ›s
 = 
LQEÁr›s
 - 
lßds
;

243 
ä“_sq_’Œ›s
 = 
SQEÁr›s
 - 
¡Ües
;

247 ià(
ä“_lq_’Œ›s
 < 
ä“_sq_’Œ›s
) {

248  
ä“_lq_’Œ›s
 - 1;

250  
ä“_sq_’Œ›s
 - 1;

252 
	}
}

254 
	g‹m¶©e
 <
şass
 
	gIm¶
>

256 
	gOzÚeLSQ
<
	gIm¶
>::
	$numLßdsR—dy
()

258 
lßd_idx
 = 
lßdH—d
;

259 
»tv®
 = 0;

261 
lßd_idx
 !ğ
lßdTa
) {

262 
	`as£¹
(
lßdQueue
[
lßd_idx
]);

264 ià(
lßdQueue
[
lßd_idx
]->
	`»adyToIssue
()) {

265 ++
»tv®
;

269  
»tv®
;

270 
	}
}

273 
	g‹m¶©e
 <
şass
 
	gIm¶
>

274 
FauÉ


275 
	gOzÚeLSQ
<
	gIm¶
>::
	$execu‹Lßd
()

277 
FauÉ
 
lßd_çuÉ
 = 
NoFauÉ
;

278 
DynIn¡PŒ
 
lßd_š¡
;

280 
	`as£¹
(
»adyLßds
.
	`size
() != 0);

283 
LdM­It
 
»ady_™
 = 
»adyLßds
.
	`begš
();

285 
lßd_š¡
 = (*
»ady_™
).
£cÚd
;

289 
lßd_çuÉ
 = 
lßd_š¡
->
	`execu‹
();

293 ià(
lßd_çuÉ
 =ğ
NoFauÉ
) {

294 
execu‹dLßds
[
lßd_š¡
->
£qNum
] =†oad_inst;

296 
»adyLßds
.
	`”a£
(
»ady_™
);

298 
lßdFauÉIn¡
 = 
lßd_š¡
;

301  
lßd_çuÉ
;

302 
	}
}

305 
	g‹m¶©e
 <
şass
 
	gIm¶
>

306 
FauÉ


307 
	gOzÚeLSQ
<
	gIm¶
>::
	$execu‹Lßd
(
DynIn¡PŒ
 &
š¡
)

310 
FauÉ
 
lßd_çuÉ
 = 
NoFauÉ
;

312 
	`DPRINTF
(
OzÚeLSQ
, "Executing†oad PC %#x, [sn:%lli]\n",

313 
š¡
->
	`»adPC
(),š¡->
£qNum
);

334 
lßd_çuÉ
 = 
š¡
->
	`š™Ÿ‹Acc
();

339 ià(
lßd_çuÉ
 !ğ
NoFauÉ
) {

346  
lßd_çuÉ
;

347 
	}
}

349 
	g‹m¶©e
 <
şass
 
	gIm¶
>

350 
FauÉ


351 
	gOzÚeLSQ
<
	gIm¶
>::
	$execu‹Lßd
(
lq_idx
)

357 
lßdQueue
[
lq_idx
]->
	`£tCªComm™
();

358 
FauÉ
 
»t_çuÉ
 = 
	`execu‹Lßd
(
lßdQueue
[
lq_idx
]);

359 
lßdQueue
[
lq_idx
]->
	`ş—rCªComm™
();

360  
»t_çuÉ
;

361 
	}
}

363 
	g‹m¶©e
 <
şass
 
	gIm¶
>

364 
FauÉ


365 
	gOzÚeLSQ
<
	gIm¶
>::
	$execu‹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
)

368 
	`as£¹
(
¡Ües
 != 0);

370 
¡Üe_idx
 = 
¡Üe_š¡
->
sqIdx
;

372 
	`DPRINTF
(
OzÚeLSQ
, "Executing store PC %#x [sn:%lli]\n",

373 
¡Üe_š¡
->
	`»adPC
(), stÜe_š¡->
£qNum
);

377 
lßd_idx
 = 
¡Üe_š¡
->
lqIdx
;

379 
FauÉ
 
¡Üe_çuÉ
 = 
¡Üe_š¡
->
	`š™Ÿ‹Acc
();

383 
size
 = 
¡ÜeQueue
[
¡Üe_idx
].size;

385 ià(
size
 == 0) {

386 
	`DPRINTF
(
OzÚeLSQ
,"Fault on Store PC %#x, [sn:%lli],Size = 0\n",

387 
¡Üe_š¡
->
	`»adPC
(),¡Üe_š¡->
£qNum
);

389  
¡Üe_çuÉ
;

392 
	`as£¹
(
¡Üe_çuÉ
 =ğ
NoFauÉ
);

394 ià(!
¡ÜeFauÉIn¡
) {

395 ià(
¡Üe_çuÉ
 !ğ
NoFauÉ
) {

396 
	`·nic
("Fault in‡ store instruction!");

397 
¡ÜeFauÉIn¡
 = 
¡Üe_š¡
;

398 } ià(
¡Üe_š¡
->
	`isNÚS³cuÏtive
()) {

402 
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
 = 
Œue
;

404 ++
¡ÜesToWB
;

408 ià(!
memD•ViŞ©Ü
) {

409 
lßd_idx
 !ğ
lßdTa
) {

419 ià((
lßdQueue
[
lßd_idx
]->
effAddr
 >> 8) ==

420 (
¡Üe_š¡
->
effAddr
 >> 8)) {

423 
memD•ViŞ©Ü
 = 
lßdQueue
[
lßd_idx
];

425  
TheISA
::
	`g’MachšeCheckFauÉ
();

428 
	`šüLdIdx
(
lßd_idx
);

432 
memD•ViŞ©Ü
 = 
NULL
;

435  
¡Üe_çuÉ
;

436 
	}
}

438 
	g‹m¶©e
 <
şass
 
	gIm¶
>

440 
	gOzÚeLSQ
<
	gIm¶
>::
	$comm™Lßd
()

442 
	`as£¹
(
lßdQueue
[
lßdH—d
]);

444 
	`DPRINTF
(
OzÚeLSQ
, "[sn:%lli] Committing head†oad instruction, PC %#x\n",

445 
lßdQueue
[
lßdH—d
]->
£qNum
,†ßdQueue[lßdH—d]->
	`»adPC
());

448 
lßdQueue
[
lßdH—d
] = 
NULL
;

450 
	`šüLdIdx
(
lßdH—d
);

452 --
lßds
;

453 
	}
}

455 
	g‹m¶©e
 <
şass
 
	gIm¶
>

457 
	gOzÚeLSQ
<
	gIm¶
>::
	$comm™Lßd
(
In¡SeqNum
 &
š¡
)

460 
	`·nic
("Don't usehis function!");

462 
i
 = 
lßdH—d
;

464 ià(
i
 =ğ
lßdTa
) {

465 
	`as£¹
(0 && "Load‚ot inhe queue!");

466 } ià(
lßdQueue
[
i
]->
£qNum
 =ğ
š¡
) {

470 ++
i
;

471 ià(
i
 >ğ
LQEÁr›s
) {

472 
i
 = 0;

477 
lßdQueue
[
i
] = 
NULL
;

478 --
lßds
;

479 
	}
}

481 
	g‹m¶©e
 <
şass
 
	gIm¶
>

483 
	gOzÚeLSQ
<
	gIm¶
>::
	$comm™Lßds
(
In¡SeqNum
 &
younge¡_š¡
)

485 
	`as£¹
(
lßds
 =ğ0 || 
lßdQueue
[
lßdH—d
]);

487 
lßds
 !ğ0 && 
lßdQueue
[
lßdH—d
]->
£qNum
 <ğ
younge¡_š¡
) {

488 
	`comm™Lßd
();

490 
	}
}

492 
	g‹m¶©e
 <
şass
 
	gIm¶
>

494 
	gOzÚeLSQ
<
	gIm¶
>::
	$comm™StÜes
(
In¡SeqNum
 &
younge¡_š¡
)

496 
	`as£¹
(
¡Ües
 =ğ0 || 
¡ÜeQueue
[
¡ÜeH—d
].
š¡
);

498 
¡Üe_idx
 = 
¡ÜeH—d
;

500 
¡Üe_idx
 !ğ
¡ÜeTa
) {

501 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

502 ià(!
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
) {

503 ià(
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
 > 
younge¡_š¡
) {

506 
	`DPRINTF
(
OzÚeLSQ
, "Marking store‡s‡bleo write back, PC "

508 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`»adPC
(),

509 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
);

511 
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
 = 
Œue
;

514 ++
¡ÜesToWB
;

517 
	`šüStIdx
(
¡Üe_idx
);

519 
	}
}

521 
	g‹m¶©e
 <
şass
 
	gIm¶
>

523 
	gOzÚeLSQ
<
	gIm¶
>::
	$wr™ebackStÜes
()

525 
¡ÜesToWB
 > 0 &&

526 
¡ÜeWBIdx
 !ğ
¡ÜeTa
 &&

527 
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
 &&

528 
¡ÜeQueue
[
¡ÜeWBIdx
].
ÿnWB
 &&

529 
u£dPÜts
 < 
ÿchePÜts
) {

531 ià(
¡ÜeQueue
[
¡ÜeWBIdx
].
size
 == 0) {

532 
	`com¶‘eStÜe
(
¡ÜeWBIdx
);

534 
	`šüStIdx
(
¡ÜeWBIdx
);

539 ià(
dÿcheIÁ”çû
 && dÿcheIÁ”çû->
	`isBlocked
()) {

540 
	`DPRINTF
(
OzÚeLSQ
, "Unableo write back‡ny more stores, cache"

545 ++
u£dPÜts
;

547 ià(
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
->
	`isD©aP»ãtch
()) {

548 
	`šüStIdx
(
¡ÜeWBIdx
);

553 
	`as£¹
(
¡ÜeQueue
[
¡ÜeWBIdx
].
»q
);

554 
	`as£¹
(!
¡ÜeQueue
[
¡ÜeWBIdx
].
comm™‹d
);

556 
MemReqPŒ
 
»q
 = 
¡ÜeQueue
[
¡ÜeWBIdx
].req;

557 
¡ÜeQueue
[
¡ÜeWBIdx
].
comm™‹d
 = 
Œue
;

560 
»q
->
cmd
 = 
Wr™e
;

561 
»q
->
com¶‘iÚEv’t
 = 
NULL
;

562 
»q
->
time
 = 
	`curTick
();

563 
	`as£¹
(!
»q
->
d©a
);

564 
»q
->
d©a
 = 
Ãw
 
ušt8_t
[64];

565 
	`memıy
(
»q
->
d©a
, (
ušt8_t
 *)&
¡ÜeQueue
[
¡ÜeWBIdx
].d©a,„eq->
size
);

567 
	`DPRINTF
(
OzÚeLSQ
, "D-Cache: Writing back store idx:%i PC:%#x "

569 
¡ÜeWBIdx
,
¡ÜeQueue
[¡ÜeWBIdx].
š¡
->
	`»adPC
(),

570 
»q
->
·ddr
, *Ôeq->
d©a
),

571 
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
->
£qNum
);

579 ià(
dÿcheIÁ”çû
) {

580 
MemAcûssResuÉ
 
»suÉ
 = 
dÿcheIÁ”çû
->
	`acûss
(
»q
);

583 ià(
»q
->
	`isLLSC
()) {

584 
»q
->
»suÉ
=1;

585 
	`·nic
("LL/SC! oh‚o‚o support!!!");

588 ià(
	`isSÎed
() &&

589 
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

590 
	`DPRINTF
(
OzÚeLSQ
, "Unstalling, stalling store [sn:%lli] "

592 
¡®lšgStÜeI¢
, 
¡®lšgLßdIdx
);

593 
¡®Ëd
 = 
çl£
;

594 
¡®lšgStÜeI¢
 = 0;

595 
be
->
	`»¶ayMemIn¡
(
lßdQueue
[
¡®lšgLßdIdx
]);

598 ià(
»suÉ
 !ğ
MA_HIT
 && 
dÿcheIÁ”çû
->
	`doEv’ts
()) {

599 
Ev’t
 *
wb
 = 
NULL
;

609 
	`DPRINTF
(
OzÚeLSQ
,"D-Cache Write Miss!\n");

616 
	`as£¹
(!
»q
->
com¶‘iÚEv’t
);

617 
»q
->
com¶‘iÚEv’t
 = 
Ãw


618 
	`StÜeCom¶‘iÚEv’t
(
¡ÜeWBIdx
, 
wb
, 
this
);

620 
Ï¡DÿcheSÎ
 = 
	`curTick
();

622 
_¡©us
 = 
DÿcheMissSÎ
;

630 
	`DPRINTF
(
OzÚeLSQ
,"D-Cache: Write Hit on idx:%i !\n",

631 
¡ÜeWBIdx
);

636 ià(
»q
->
	`isLLSC
()) {

638 
»q
->
»suÉ
=1;

639 
ty³Çme
 
BackEnd
::
LdWr™ebackEv’t
 *
wb
 =

640 
Ãw
 
ty³Çme
 
BackEnd
::
	`LdWr™ebackEv’t
(
¡ÜeQueue
[
¡ÜeWBIdx
].
š¡
,

641 
be
);

642 
wb
->
	`scheduË
(
	`curTick
());

645 
	`com¶‘eStÜe
(
¡ÜeWBIdx
);

648 
	`šüStIdx
(
¡ÜeWBIdx
);

650 
	`·nic
("Must HAVE DCACHE!!!!!\n");

655 
u£dPÜts
 = 0;

657 
	`as£¹
(
¡Ües
 >ğ0 && 
¡ÜesToWB
 >= 0);

658 
	}
}

674 
	g‹m¶©e
 <
şass
 
	gIm¶
>

676 
	gOzÚeLSQ
<
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
)

678 
	`DPRINTF
(
OzÚeLSQ
, "Squashing until [sn:%lli]!"

679 "(Lßds:%˜StÜes:%i)\n",
squashed_num
,
lßds
,
¡Ües
);

681 
lßd_idx
 = 
lßdTa
;

682 
	`deüLdIdx
(
lßd_idx
);

684 
lßds
 !ğ0 && 
lßdQueue
[
lßd_idx
]->
£qNum
 > 
squashed_num
) {

687 
	`DPRINTF
(
OzÚeLSQ
,"Load Instruction PC %#x squashed, "

689 
lßdQueue
[
lßd_idx
]->
	`»adPC
(),

690 
lßdQueue
[
lßd_idx
]->
£qNum
);

692 ià(
	`isSÎed
(è&& 
lßd_idx
 =ğ
¡®lšgLßdIdx
) {

693 
¡®Ëd
 = 
çl£
;

694 
¡®lšgStÜeI¢
 = 0;

695 
¡®lšgLßdIdx
 = 0;

699 
lßdQueue
[
lßd_idx
] = 
NULL
;

700 --
lßds
;

703 
lßdTa
 = 
lßd_idx
;

705 
	`deüLdIdx
(
lßd_idx
);

708 
¡Üe_idx
 = 
¡ÜeTa
;

709 
	`deüStIdx
(
¡Üe_idx
);

711 
¡Ües
 !ğ0 && 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
 > 
squashed_num
) {

714 
	`DPRINTF
(
OzÚeLSQ
,"Store Instruction PC %#x squashed, "

716 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`»adPC
(),

717 
¡Üe_idx
, 
¡ÜeQueue
[¡Üe_idx].
š¡
->
£qNum
);

721 ià(
	`isSÎed
() &&

722 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

723 
	`·nic
("Is stalled should have been cleared by stalling†oad!\n");

724 
¡®Ëd
 = 
çl£
;

725 
¡®lšgStÜeI¢
 = 0;

729 
¡ÜeQueue
[
¡Üe_idx
].
š¡
 = 
NULL
;

730 
¡ÜeQueue
[
¡Üe_idx
].
ÿnWB
 = 0;

732 ià(
¡ÜeQueue
[
¡Üe_idx
].
»q
) {

733 
	`as£¹
(!
¡ÜeQueue
[
¡Üe_idx
].
»q
->
com¶‘iÚEv’t
);

735 
¡ÜeQueue
[
¡Üe_idx
].
»q
 = 
NULL
;

736 --
¡Ües
;

739 
¡ÜeTa
 = 
¡Üe_idx
;

741 
	`deüStIdx
(
¡Üe_idx
);

743 
	}
}

745 
	g‹m¶©e
 <
şass
 
	gIm¶
>

747 
	gOzÚeLSQ
<
	gIm¶
>::
	$dumpIn¡s
()

749 
	`ırštf
("Load store queue: Dumping instructions.\n");

750 
	`ırštf
("Lßd queusize: %i\n", 
lßds
);

751 
	`ırštf
("Load queue: ");

753 
lßd_idx
 = 
lßdH—d
;

755 
lßd_idx
 !ğ
lßdTa
 && 
lßdQueue
[load_idx]) {

756 
	`ırštf
("[¢:%Îi] %#x ", 
lßdQueue
[
lßd_idx
]->
£qNum
,

757 
lßdQueue
[
lßd_idx
]->
	`»adPC
());

759 
	`šüLdIdx
(
lßd_idx
);

762 
	`ırštf
("\nStÜqueusize: %i\n", 
¡Ües
);

763 
	`ırštf
("Store queue: ");

765 
¡Üe_idx
 = 
¡ÜeH—d
;

767 
¡Üe_idx
 !ğ
¡ÜeTa
 && 
¡ÜeQueue
[¡Üe_idx].
š¡
) {

768 
	`ırštf
("[¢:%Îi] %#x ", 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
,

769 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
	`»adPC
());

771 
	`šüStIdx
(
¡Üe_idx
);

774 
	`ırštf
("\n");

775 
	}
}

777 
	g‹m¶©e
 <
şass
 
	gIm¶
>

779 
	gOzÚeLSQ
<
	gIm¶
>::
	$com¶‘eStÜe
(
¡Üe_idx
)

781 
	`as£¹
(
¡ÜeQueue
[
¡Üe_idx
].
š¡
);

782 
¡ÜeQueue
[
¡Üe_idx
].
com¶‘ed
 = 
Œue
;

783 --
¡ÜesToWB
;

789 ià(
¡Üe_idx
 =ğ
¡ÜeH—d
) {

791 
	`šüStIdx
(
¡ÜeH—d
);

793 --
¡Ües
;

794 } 
¡ÜeQueue
[
¡ÜeH—d
].
com¶‘ed
 &&

795 
¡ÜeH—d
 !ğ
¡ÜeTa
);

800 
	`DPRINTF
(
OzÚeLSQ
, "StÜh—d idx:%i\n", 
¡ÜeH—d
);

802 ià(
	`isSÎed
() &&

803 
¡ÜeQueue
[
¡Üe_idx
].
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

804 
	`DPRINTF
(
OzÚeLSQ
, "Unstalling, stalling store [sn:%lli] "

806 
¡®lšgStÜeI¢
, 
¡®lšgLßdIdx
);

807 
¡®Ëd
 = 
çl£
;

808 
¡®lšgStÜeI¢
 = 0;

809 
be
->
	`»¶ayMemIn¡
(
lßdQueue
[
¡®lšgLßdIdx
]);

811 
	}
}

813 
	g‹m¶©e
 <
şass
 
	gIm¶
>

814 
šlše
 

815 
	gOzÚeLSQ
<
	gIm¶
>::
	$šüStIdx
(&
¡Üe_idx
)

817 ià(++
¡Üe_idx
 >ğ
SQEÁr›s
)

818 
¡Üe_idx
 = 0;

819 
	}
}

821 
	g‹m¶©e
 <
şass
 
	gIm¶
>

822 
šlše
 

823 
	gOzÚeLSQ
<
	gIm¶
>::
	$deüStIdx
(&
¡Üe_idx
)

825 ià(--
¡Üe_idx
 < 0)

826 
¡Üe_idx
 +ğ
SQEÁr›s
;

827 
	}
}

829 
	g‹m¶©e
 <
şass
 
	gIm¶
>

830 
šlše
 

831 
	gOzÚeLSQ
<
	gIm¶
>::
	$šüLdIdx
(&
lßd_idx
)

833 ià(++
lßd_idx
 >ğ
LQEÁr›s
)

834 
lßd_idx
 = 0;

835 
	}
}

837 
	g‹m¶©e
 <
şass
 
	gIm¶
>

838 
šlše
 

839 
	gOzÚeLSQ
<
	gIm¶
>::
	$deüLdIdx
(&
lßd_idx
)

841 ià(--
lßd_idx
 < 0)

842 
lßd_idx
 +ğ
LQEÁr›s
;

843 
	}
}

	@ozone/lw_back_end.cc

31 
	~"ıu/ozÚe/lw_back_’d_im¶.hh
"

32 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

34 
‹m¶©e
 
şass
 
	gLWBackEnd
<
	gOzÚeIm¶
>;

	@ozone/lw_back_end.hh

31 #iâdeà
__CPU_OZONE_LW_BACK_END_HH__


32 
	#__CPU_OZONE_LW_BACK_END_HH__


	)

34 
	~<li¡
>

35 
	~<queue
>

36 
	~<£t
>

37 
	~<¡ršg
>

39 
	~"ıu/ozÚe/»Çme_bË.hh
"

40 
	~"ıu/ozÚe/th»ad_¡©e.hh
"

41 
	~"ıu/š¡_£q.hh
"

42 
	~"ıu/timebuf.hh
"

43 
	~"mem/»que¡.hh
"

44 
	~"sim/ev’tq.hh
"

45 
	~"sim/çuÉs.hh
"

47 
	g‹m¶©e
 <
	gşass
>

48 
şass
 
	gCheck”
;

49 
şass
 
	gTh»adCÚ‹xt
;

51 
	g‹m¶©e
 <
şass
 
	gIm¶
>

52 
şass
 
	gOzÚeTh»adS‹
;

54 
şass
 
	gPÜt
;

56 
	g‹m¶©e
 <
şass
 
	gIm¶
>

57 şas 
	cLWBackEnd


59 
	mpublic
:

60 
OzÚeTh»adS‹
<
	tIm¶
> 
	tTh»ad
;

62 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

63 
ty³Çme
 
	tIm¶
::
	tDynIn¡
 DynInst;

64 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

65 
ty³Çme
 
	tIm¶
::
	tOzÚeCPU
 OzoneCPU;

66 
ty³Çme
 
	tIm¶
::
	tFrÚtEnd
 FrontEnd;

67 
ty³Çme
 
	tIm¶
::
	tOzÚeCPU
::
	tCommSŒuù
 CommStruct;

69 
	sSizeSŒuù
 {

70 
	msize
;

73 
SizeSŒuù
 
	tDi¥©chToIssue
;

74 
SizeSŒuù
 
	tIssueToExec
;

75 
SizeSŒuù
 
	tExecToComm™
;

76 
SizeSŒuù
 
	tWr™eback
;

78 
	gTimeBufãr
<
	gDi¥©chToIssue
> 
	gd2i
;

79 
ty³Çme
 
	gTimeBufãr
<
	gDi¥©chToIssue
>::
wœe
 
š¡sToDi¥©ch
;

80 
	gTimeBufãr
<
	gIssueToExec
> 
	gi2e
;

81 
ty³Çme
 
	gTimeBufãr
<
	gIssueToExec
>::
wœe
 
š¡sToExecu‹
;

82 
	gTimeBufãr
<
	gExecToComm™
> 
	ge2c
;

83 
	gTimeBufãr
<> 
	gnumIn¡sToWB
;

85 
	gTimeBufãr
<
	gCommSŒuù
> *
	gcomm
;

86 
ty³Çme
 
	gTimeBufãr
<
	gCommSŒuù
>::
wœe
 
toIEW
;

87 
ty³Çme
 
	gTimeBufãr
<
	gCommSŒuù
>::
wœe
 
äomComm™
;

89 şas 
	cT¿pEv’t
 : 
public
 
Ev’t
 {

90 
´iv©e
:

91 
LWBackEnd
<
Im¶
> *
be
;

93 
	gpublic
:

94 
T¿pEv’t
(
LWBackEnd
<
Im¶
> *
_be
);

96 
´oûss
();

97 cÚ¡ *
desütiÚ
() const;

100 
LWBackEnd
(
P¬ams
 *
·¿ms
);

102 
	g¡d
::
¡ršg
 
	$Çme
() const;

104 
	`»gSts
();

106 
	`£tCPU
(
OzÚeCPU
 *
ıu_±r
);

108 
	$£tFrÚtEnd
(
FrÚtEnd
 *
äÚt_’d_±r
)

109 { 
äÚtEnd
 = 
äÚt_’d_±r
; 
	}
}

111 
	$£tTC
(
Th»adCÚ‹xt
 *
tc_±r
)

112 { 
tc
 = 
tc_±r
; 
	}
}

114 
	$£tTh»adS‹
(
Th»ad
 *
th»ad_±r
)

115 { 
th»ad
 = 
th»ad_±r
; 
	}
}

117 
£tCommBufãr
(
TimeBufãr
<
CommSŒuù
> *
_comm
);

119 
PÜt
 *
	$g‘DÿchePÜt
(è{  
LSQ
.
	`g‘DÿchePÜt
(); 
	}
}

121 
tick
();

122 
squash
();

123 
	$g’”©eTCEv’t
(è{ 
tcSquash
 = 
Œue
; 
	}
}

124 
squashFromTC
();

125 
squashFromT¿p
();

126 
checkIÁ”ru±s
();

127 
boŞ
 
	gŒ­Squash
;

128 
boŞ
 
	gtcSquash
;

130 
	g‹m¶©e
 <
şass
 
	gT
>

131 
FauÉ
 
»ad
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
lßd_idx
);

133 
	g‹m¶©e
 <
şass
 
	gT
>

134 
FauÉ
 
wr™e
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
¡Üe_idx
);

136 
Addr
 
	$»adComm™PC
(è{  
comm™PC
; 
	}
}

138 
Addr
 
	gcomm™PC
;

140 
Tick
 
	gÏ¡Comm™Cyşe
;

142 
boŞ
 
	$robEm±y
(è{  
numIn¡s
 =ğ0; 
	}
}

144 
boŞ
 
	$isFuÎ
(è{  
numIn¡s
 >ğ
numROBEÁr›s
; 
	}
}

145 
boŞ
 
	$isBlocked
(è{  
¡©us
 =ğ
Blocked
 || 
di¥©chStus
 =ğBlocked; 
	}
}

147 
ãtchFauÉ
(
FauÉ
 &
çuÉ
);

149 
wakeD•’d’ts
(
DynIn¡PŒ
 &
š¡
, 
boŞ
 
memÜy_d•s
 = 
çl£
);

154 
»scheduËMemIn¡
(
DynIn¡PŒ
 &
š¡
);

157 
»¶ayMemIn¡
(
DynIn¡PŒ
 &
š¡
);

160 
	$com¶‘eMemIn¡
(
DynIn¡PŒ
 &
š¡
è{ 
	}
}

162 
	$addDÿcheMiss
(
DynIn¡PŒ
 &
š¡
)

164 
wa™šgMemOps
.
	`š£¹
(
š¡
->
£qNum
);

165 
numWa™šgMemOps
++;

166 
	`DPRINTF
(
BE
, "Adding‡ Dcache miss mem op [sn:%lli],otal %i\n",

167 
š¡
->
£qNum
, 
numWa™šgMemOps
);

168 
	}
}

170 
	$»moveDÿcheMiss
(
DynIn¡PŒ
 &
š¡
)

172 
	`as£¹
(
wa™šgMemOps
.
	`fšd
(
š¡
->
£qNum
è!ğwa™šgMemOps.
	`’d
());

173 
wa™šgMemOps
.
	`”a£
(
š¡
->
£qNum
);

174 
numWa™šgMemOps
--;

175 
	`DPRINTF
(
BE
, "Removing‡ Dcache miss mem op [sn:%lli],otal %i\n",

176 
š¡
->
£qNum
, 
numWa™šgMemOps
);

177 
	}
}

179 
	$addWa™šgMemOp
(
DynIn¡PŒ
 &
š¡
)

181 
wa™šgMemOps
.
	`š£¹
(
š¡
->
£qNum
);

182 
numWa™šgMemOps
++;

183 
	`DPRINTF
(
BE
, "Adding‡ waiting mem op [sn:%lli],otal %i\n",

184 
š¡
->
£qNum
, 
numWa™šgMemOps
);

185 
	}
}

187 
	$»moveWa™šgMemOp
(
DynIn¡PŒ
 &
š¡
)

189 
	`as£¹
(
wa™šgMemOps
.
	`fšd
(
š¡
->
£qNum
è!ğwa™šgMemOps.
	`’d
());

190 
wa™šgMemOps
.
	`”a£
(
š¡
->
£qNum
);

191 
numWa™šgMemOps
--;

192 
	`DPRINTF
(
BE
, "Removing‡ waiting mem op [sn:%lli],otal %i\n",

193 
š¡
->
£qNum
, 
numWa™šgMemOps
);

194 
	}
}

196 
š¡ToComm™
(
DynIn¡PŒ
 &
š¡
);

197 
»adyIn¡sFÜComm™
();

199 
sw™chOut
();

200 
doSw™chOut
();

201 
keOv”From
(
Th»adCÚ‹xt
 *
Şd_tc
 = 
NULL
);

203 
boŞ
 
	$isSw™chedOut
(è{  
sw™chedOut
; 
	}
}

205 
	g´iv©e
:

206 
g’”©eT¿pEv’t
(
Tick
 
Ï‹ncy
 = 0);

207 
hªdËFauÉ
(
FauÉ
 &
çuÉ
, 
Tick
 
Ï‹ncy
 = 0);

208 
upd©eSŒuùu»s
();

209 
di¥©chIn¡s
();

210 
di¥©chSÎ
();

211 
checkDi¥©chStus
();

212 
execu‹In¡s
();

213 
comm™In¡s
();

214 
addToLSQ
(
DynIn¡PŒ
 &
š¡
);

215 
wr™ebackIn¡s
();

216 
boŞ
 
comm™In¡
(
š¡_num
);

217 
squash
(cÚ¡ 
In¡SeqNum
 &
¢
);

218 
squashDueToB¿nch
(
DynIn¡PŒ
 &
š¡
);

219 
squashDueToMemViŞ©iÚ
(
DynIn¡PŒ
 &
š¡
);

220 
squashDueToMemBlocked
(
DynIn¡PŒ
 &
š¡
);

221 
upd©eExeIn¡Sts
(
DynIn¡PŒ
 &
š¡
);

222 
upd©eComIn¡Sts
(
DynIn¡PŒ
 &
š¡
);

224 
	gpublic
:

225 
OzÚeCPU
 *
ıu
;

227 
FrÚtEnd
 *
	gäÚtEnd
;

229 
Th»adCÚ‹xt
 *
	gtc
;

231 
Th»ad
 *
	gth»ad
;

233 
	eStus
 {

234 
	gRuÂšg
,

235 
	gIdË
,

236 
	gDÿcheMissSÎ
,

237 
	gDÿcheMissCom¶‘e
,

238 
	gBlocked
,

239 
	gT¿pP’dšg


242 
Stus
 
	g¡©us
;

244 
Stus
 
	gdi¥©chStus
;

246 
Stus
 
	gcomm™Stus
;

248 
CouÁ”
 
	gfuncExeIn¡
;

250 
	g´iv©e
:

251 
ty³Çme
 
	tIm¶
::
	tLd¡Queue
 LdstQueue;

253 
Ld¡Queue
 
	gLSQ
;

254 
	gpublic
:

255 
R’ameTabË
<
Im¶
> 
comm™R’ameTabË
;

257 
	gR’ameTabË
<
	gIm¶
> 
	g»ÇmeTabË
;

258 
	g´iv©e
:

259 
Ï‹ncy
;

262 
	gwidth
;

265 
	gdi¥©chWidth
;

266 
	gdi¥©chSize
;

268 
	gwa™šgIn¡s
;

270 
	gissueWidth
;

273 
	gwbWidth
;

276 
	gcomm™Width
;

279 
	gwbNumIn¡
;

286 
	gwbCyşe
;

288 
	gnumROBEÁr›s
;

289 
	gnumIn¡s
;

290 
boŞ
 
	glsqLim™s
;

292 
	g¡d
::
£t
<
In¡SeqNum
> 
wa™šgMemOps
;

293 
	g¡d
::
	t£t
<
	tIn¡SeqNum
>::
	t™”©Ü
 
	tMemIt
;

294 
	gnumWa™šgMemOps
;

295 
	gmaxOut¡ªdšgMemOps
;

297 
boŞ
 
	gsquashP’dšg
;

298 
In¡SeqNum
 
	gsquashSeqNum
;

299 
Addr
 
	gsquashNextPC
;

301 
boŞ
 
	gsw™chedOut
;

302 
boŞ
 
	gsw™chP’dšg
;

304 
DynIn¡PŒ
 
	gmemB¬r›r
;

306 
	g´iv©e
:

307 
	spqCom·»
 {

308 
boŞ
 
İ”©Ü
(è(cÚ¡ 
DynIn¡PŒ
 &
lhs
, cÚ¡ 
	gDynIn¡PŒ
 &
	grhs
) const

310  
	glhs
->
	g£qNum
 > 
	grhs
->seqNum;

314 
ty³Çme
 
	t¡d
::
	t´iÜ™y_queue
<
	tDynIn¡PŒ
, std::
	tveùÜ
<DynIn¡PŒ>, 
	tpqCom·»
> 
	tR—dyIn¡Queue
;

315 
R—dyIn¡Queue
 
	gexeLi¡
;

317 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tIn¡Li¡It
;

319 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
š¡Li¡
;

320 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
wa™šgLi¡
;

321 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
»¶ayLi¡
;

322 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
wr™eback
;

324 
	gsquashL©’cy
;

326 
boŞ
 
	gexaùFuÎSÎ
;

332 
	gSts
::
VeùÜ
 
robC­Ev’ts
;

333 
	gSts
::
VeùÜ
 
robC­In¡CouÁ
;

334 
	gSts
::
VeùÜ
 
iqC­Ev’ts
;

335 
	gSts
::
VeùÜ
 
iqC­In¡CouÁ
;

337 
	gSts
::
VeùÜ
 
exeIn¡
;

338 
	gSts
::
VeùÜ
 
exeSwp
;

339 
	gSts
::
VeùÜ
 
exeNİ
;

340 
	gSts
::
VeùÜ
 
exeRefs
;

341 
	gSts
::
VeùÜ
 
exeLßds
;

342 
	gSts
::
VeùÜ
 
exeB¿nches
;

344 
	gSts
::
VeùÜ
 
issuedOps
;

347 
	gSts
::
VeùÜ
 
lsqFÜwLßds
;

350 
	gSts
::
VeùÜ
 
švAddrLßds
;

353 
	gSts
::
VeùÜ
 
švAddrSwpfs
;

355 
	gSts
::
VeùÜ
 
lsqBlockedLßds
;

357 
	gSts
::
SÿÏr
 
lsqInv”siÚ
;

359 
	gSts
::
VeùÜ
 
nIssuedDi¡
;

382 
	gSts
::
VeùÜ
 
wr™ebackCouÁ
;

383 
	gSts
::
VeùÜ
 
´oduûrIn¡
;

384 
	gSts
::
VeùÜ
 
cÚsum”In¡
;

385 
	gSts
::
VeùÜ
 
wbP’®ized
;

387 
	gSts
::
FÜmuÏ
 
wbR©e
;

388 
	gSts
::
FÜmuÏ
 
wbFªout
;

389 
	gSts
::
FÜmuÏ
 
wbP’®izedR©e
;

392 
	gSts
::
VeùÜ
 
¡©ComIn¡
;

393 
	gSts
::
VeùÜ
 
¡©ComSwp
;

394 
	gSts
::
VeùÜ
 
¡©ComRefs
;

395 
	gSts
::
VeùÜ
 
¡©ComLßds
;

396 
	gSts
::
VeùÜ
 
¡©ComMemb¬s
;

397 
	gSts
::
VeùÜ
 
¡©ComB¿nches
;

399 
	gSts
::
Di¡ributiÚ
 
nComm™‹dDi¡
;

401 
	gSts
::
SÿÏr
 
comm™EligibËSam¶es
;

402 
	gSts
::
VeùÜ
 
comm™EligibË
;

404 
	gSts
::
VeùÜ
 
squashedIn¡s
;

405 
	gSts
::
VeùÜ
 
ROBSquashedIn¡s
;

407 
	gSts
::
SÿÏr
 
ROBFcouÁ
;

408 
	gSts
::
FÜmuÏ
 
ROBFuÎR©e
;

410 
	gSts
::
VeùÜ
 
ROBCouÁ
;

411 
	gSts
::
FÜmuÏ
 
ROBOccR©e
;

413 
	gpublic
:

414 
dumpIn¡s
();

416 
	gCheck”
<
	gDynIn¡PŒ
> *
	gcheck”
;

419 
	g‹m¶©e
 <
şass
 
	gIm¶
>

420 
	g‹m¶©e
 <
şass
 
	gT
>

421 
FauÉ


422 
	gLWBackEnd
<
	gIm¶
>::
	$»ad
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
lßd_idx
)

424  
LSQ
.
	`»ad
(
»q
, 
d©a
, 
lßd_idx
);

425 
	}
}

427 
	g‹m¶©e
 <
şass
 
	gIm¶
>

428 
	g‹m¶©e
 <
şass
 
	gT
>

429 
FauÉ


430 
	gLWBackEnd
<
	gIm¶
>::
	$wr™e
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
¡Üe_idx
)

432  
LSQ
.
	`wr™e
(
»q
, 
d©a
, 
¡Üe_idx
);

433 
	}
}

	@ozone/lw_back_end_impl.hh

30 #iâdeà
__CPU_OZONE_LW_BACK_END_IMPL_HH__


31 
	#__CPU_OZONE_LW_BACK_END_IMPL_HH__


	)

33 
	~"cÚfig/the_i§.hh
"

34 
	~"ıu/check”/ıu.hh
"

35 
	~"ıu/ozÚe/lw_back_’d.hh
"

36 
	~"ıu/İ_şass.hh
"

38 
	g‹m¶©e
 <
şass
 
	gIm¶
>

40 
	gLWBackEnd
<
	gIm¶
>::
	$g’”©eT¿pEv’t
(
Tick
 
Ï‹ncy
)

42 
	`DPRINTF
(
BE
, "Generatingrapƒvent\n");

44 
T¿pEv’t
 *
Œ­
 = 
Ãw
 
	`T¿pEv’t
(
this
);

46 
Œ­
->
	`scheduË
(
	`curTick
(è+ 
ıu
->
	`ticks
(
Ï‹ncy
));

48 
th»ad
->
Œ­P’dšg
 = 
Œue
;

49 
	}
}

51 
	g‹m¶©e
 <
şass
 
	gIm¶
>

53 
	gLWBackEnd
<
	gIm¶
>::
	$wakeD•’d’ts
(
DynIn¡PŒ
 &
š¡
, 
boŞ
 
memÜy_d•s
)

55 
	`as£¹
(!
š¡
->
	`isSquashed
());

56 
¡d
::
veùÜ
<
DynIn¡PŒ
> &
d•’d’ts
 = 
memÜy_d•s
 ? 
š¡
->
	`g‘MemD•s
() :

57 
š¡
->
	`g‘D•’d’ts
();

58 
num_ouuts
 = 
d•’d’ts
.
	`size
();

60 
	`DPRINTF
(
BE
, "Wakšg in¡ruùiÚ [¢:%Îi] d•’d’t š IQ\n", 
š¡
->
£qNum
);

62 
i
 = 0; i < 
num_ouuts
; i++) {

63 
DynIn¡PŒ
 
d•_š¡
 = 
d•’d’ts
[
i
];

64 ià(!
memÜy_d•s
) {

65 
d•_š¡
->
	`m¬kSrcRegR—dy
();

67 ià(!
d•_š¡
->
	`isSquashed
())

68 
d•_š¡
->
	`m¬kMemIn¡R—dy
(
š¡
.
	`g‘
());

71 
	`DPRINTF
(
BE
, "M¬kšg sourû„eg„—dy [¢:%Îi] iÀIQ\n", 
d•_š¡
->
£qNum
);

73 ià(
d•_š¡
->
	`»adyToIssue
(è&& d•_š¡->
	`isInROB
() &&

74 !
d•_š¡
->
	`isNÚS³cuÏtive
(è&& !d•_š¡->
	`isStÜeCÚd™iÚ®
() &&

75 
d•_š¡
->
	`memD•R—dy
(è&& !d•_š¡->
	`isMemB¬r›r
() &&

76 !
d•_š¡
->
	`isWr™eB¬r›r
()) {

77 
	`DPRINTF
(
BE
, "Adding instructionoƒxeList [sn:%lli]\n",

78 
d•_š¡
->
£qNum
);

79 
exeLi¡
.
	`push
(
d•_š¡
);

80 ià(
d•_š¡
->
iqItV®id
) {

81 
	`DPRINTF
(
BE
, "Removing instruction from waiting†ist\n");

82 
wa™šgLi¡
.
	`”a£
(
d•_š¡
->
iqIt
);

83 
wa™šgIn¡s
--;

84 
d•_š¡
->
iqItV®id
 = 
çl£
;

85 
	`as£¹
(
wa™šgIn¡s
 >= 0);

87 ià(
d•_š¡
->
	`isMemRef
()) {

88 
	`»moveWa™šgMemOp
(
d•_š¡
);

89 
	`DPRINTF
(
BE
, "Issued‡ waiting mem op [sn:%lli]\n",

90 
d•_š¡
->
£qNum
);

94  
num_ouuts
;

95 
	}
}

97 
	g‹m¶©e
 <
şass
 
	gIm¶
>

99 
	gLWBackEnd
<
	gIm¶
>::
	$»scheduËMemIn¡
(
DynIn¡PŒ
 &
š¡
)

101 
»¶ayLi¡
.
	`push_äÚt
(
š¡
);

102 
	}
}

104 
	g‹m¶©e
 <
şass
 
	gIm¶
>

105 
	gLWBackEnd
<
	gIm¶
>::
T¿pEv’t
::T¿pEv’t(
LWBackEnd
<
Im¶
> *
_be
)

106 : 
Ev’t
(&
mašEv’tQueue
, 
CPU_Tick_Pri
), 
	$be
(
_be
)

108 
this
->
	`£tFÏgs
(
Ev’t
::
AutoD–‘e
);

109 
	}
}

111 
	g‹m¶©e
 <
şass
 
	gIm¶
>

113 
	gLWBackEnd
<
	gIm¶
>::
T¿pEv’t
::
	$´oûss
()

115 
be
->
Œ­Squash
 = 
Œue
;

116 
	}
}

118 
	g‹m¶©e
 <
şass
 
	gIm¶
>

120 
	gLWBackEnd
<
	gIm¶
>::
T¿pEv’t
::
	$desütiÚ
() const

123 
	}
}

125 
	g‹m¶©e
 <
şass
 
	gIm¶
>

127 
	gLWBackEnd
<
	gIm¶
>::
	$»¶ayMemIn¡
(
DynIn¡PŒ
 &
š¡
)

129 
boŞ
 
found_š¡
 = 
çl£
;

130 !
»¶ayLi¡
.
	`em±y
()) {

131 
exeLi¡
.
	`push
(
»¶ayLi¡
.
	`äÚt
());

132 ià(
»¶ayLi¡
.
	`äÚt
(è=ğ
š¡
) {

133 
found_š¡
 = 
Œue
;

135 
»¶ayLi¡
.
	`pİ_äÚt
();

137 
	`as£¹
(
found_š¡
);

138 
	}
}

140 
	g‹m¶©e
 <
şass
 
	gIm¶
>

141 
	gLWBackEnd
<
	gIm¶
>::
	$LWBackEnd
(
P¬ams
 *
·¿ms
)

142 : 
	`d2i
(5, 5), 
	`i2e
(5, 5), 
	`e2c
(5, 5), 
	`numIn¡sToWB
(
·¿ms
->
backEndL©’cy
, 0),

143 
	`Œ­Squash
(
çl£
), 
	`tcSquash
(false),

144 
	`Ï‹ncy
(
·¿ms
->
backEndL©’cy
),

145 
	`width
(
·¿ms
->
backEndWidth
), 
	`lsqLim™s
Õ¬ams->
lsqLim™s
),

146 
	$exaùFuÎSÎ
(
Œue
)

148 
numROBEÁr›s
 = 
·¿ms
->numROBEntries;

149 
numIn¡s
 = 0;

150 
maxOut¡ªdšgMemOps
 = 
·¿ms
->maxOutstandingMemOps;

151 
numWa™šgMemOps
 = 0;

152 
wa™šgIn¡s
 = 0;

153 
sw™chedOut
 = 
çl£
;

154 
sw™chP’dšg
 = 
çl£
;

156 
LSQ
.
	`£tBE
(
this
);

159 
š¡sToDi¥©ch
 = 
d2i
.
	`g‘Wœe
(-1);

161 
š¡sToExecu‹
 = 
i2e
.
	`g‘Wœe
(-1);

163 
di¥©chWidth
 = 
·¿ms
->di¥©chWidth ?…¬ams->di¥©chWidth : 
width
;

164 
issueWidth
 = 
·¿ms
->issueWidth ?…¬ams->issueWidth : 
width
;

165 
wbWidth
 = 
·¿ms
->wbWidth ?…¬ams->wbWidth : 
width
;

166 
comm™Width
 = 
·¿ms
->comm™Width ?…¬ams->comm™Width : 
width
;

168 
LSQ
.
	`š™
(
·¿ms
,…¬ams->
LQEÁr›s
,…¬ams->
SQEÁr›s
, 0);

170 
di¥©chStus
 = 
RuÂšg
;

171 
comm™Stus
 = 
RuÂšg
;

172 
	}
}

174 
	g‹m¶©e
 <
şass
 
	gIm¶
>

175 
	g¡d
::
¡ršg


176 
LWBackEnd
<
Im¶
>::
	$Çme
() const

178  
ıu
->
	`Çme
() + ".backend";

179 
	}
}

181 
	g‹m¶©e
 <
şass
 
	gIm¶
>

183 
	gLWBackEnd
<
	gIm¶
>::
	$»gSts
()

185 
usšg
 
Çme¥aû
 
Sts
;

186 
LSQ
.
	`»gSts
();

188 
robC­Ev’ts


189 .
	`š™
(
ıu
->
numTh»ads
)

190 .
	`Çme
(name() + ".ROB:cap_events")

191 .
	`desc
("number of cycles where ROB cap was‡ctive")

192 .
	`æags
(
tÙ®
)

195 
robC­In¡CouÁ


196 .
	`š™
(
ıu
->
numTh»ads
)

197 .
	`Çme
(name() + ".ROB:cap_inst")

198 .
	`desc
("number of instructions held up by ROB cap")

199 .
	`æags
(
tÙ®
)

202 
iqC­Ev’ts


203 .
	`š™
(
ıu
->
numTh»ads
)

204 .
	`Çme
(name() +".IQ:cap_events" )

205 .
	`desc
("number of cycles where IQ cap was‡ctive")

206 .
	`æags
(
tÙ®
)

209 
iqC­In¡CouÁ


210 .
	`š™
(
ıu
->
numTh»ads
)

211 .
	`Çme
(name() + ".IQ:cap_inst")

212 .
	`desc
("number of instructions held up by IQ cap")

213 .
	`æags
(
tÙ®
)

216 
exeIn¡


217 .
	`š™
(
ıu
->
numTh»ads
)

218 .
	`Çme
(name() + ".ISSUE:count")

219 .
	`desc
("number of insts issued")

220 .
	`æags
(
tÙ®
)

223 
exeSwp


224 .
	`š™
(
ıu
->
numTh»ads
)

225 .
	`Çme
(name() + ".ISSUE:swp")

226 .
	`desc
("number of swp insts issued")

227 .
	`æags
(
tÙ®
)

230 
exeNİ


231 .
	`š™
(
ıu
->
numTh»ads
)

232 .
	`Çme
(name() + ".ISSUE:nop")

233 .
	`desc
("number of‚op insts issued")

234 .
	`æags
(
tÙ®
)

237 
exeRefs


238 .
	`š™
(
ıu
->
numTh»ads
)

239 .
	`Çme
(name() + ".ISSUE:refs")

240 .
	`desc
("number of memory„eference insts issued")

241 .
	`æags
(
tÙ®
)

244 
exeLßds


245 .
	`š™
(
ıu
->
numTh»ads
)

246 .
	`Çme
(name() + ".ISSUE:loads")

247 .
	`desc
("number of†oad insts issued")

248 .
	`æags
(
tÙ®
)

251 
exeB¿nches


252 .
	`š™
(
ıu
->
numTh»ads
)

253 .
	`Çme
(name() + ".ISSUE:branches")

254 .
	`desc
("Number of branches issued")

255 .
	`æags
(
tÙ®
)

258 
issuedOps


259 .
	`š™
(
ıu
->
numTh»ads
)

260 .
	`Çme
(name() + ".ISSUE:op_count")

261 .
	`desc
("number of insts issued")

262 .
	`æags
(
tÙ®
)

275 
lsqFÜwLßds


276 .
	`š™
(
ıu
->
numTh»ads
)

277 .
	`Çme
(name() + ".LSQ:forw_loads")

278 .
	`desc
("number of†oads forwarded via LSQ")

279 .
	`æags
(
tÙ®
)

282 
švAddrLßds


283 .
	`š™
(
ıu
->
numTh»ads
)

284 .
	`Çme
(name() + ".ISSUE:addr_loads")

285 .
	`desc
("number of invalid-address†oads")

286 .
	`æags
(
tÙ®
)

289 
švAddrSwpfs


290 .
	`š™
(
ıu
->
numTh»ads
)

291 .
	`Çme
(name() + ".ISSUE:addr_swpfs")

292 .
	`desc
("number of invalid-address SW…refetches")

293 .
	`æags
(
tÙ®
)

296 
lsqBlockedLßds


297 .
	`š™
(
ıu
->
numTh»ads
)

298 .
	`Çme
(name() + ".LSQ:blocked_loads")

299 .
	`desc
("number of„eady†oads‚ot issued dueo memory disambiguation")

300 .
	`æags
(
tÙ®
)

303 
lsqInv”siÚ


304 .
	`Çme
(name() + ".ISSUE:lsq_invert")

305 .
	`desc
("Number ofimes LSQ instruction issuedƒarly")

308 
nIssuedDi¡


309 .
	`š™
(
issueWidth
 + 1)

310 .
	`Çme
(name() + ".ISSUE:issued_per_cycle")

311 .
	`desc
("Number of insts issuedƒach cycle")

312 .
	`æags
(
tÙ®
 | 
pdf
 | 
di¡
)

332 
wr™ebackCouÁ


333 .
	`š™
(
ıu
->
numTh»ads
)

334 .
	`Çme
(name() + ".WB:count")

335 .
	`desc
("cumulative count of insts written-back")

336 .
	`æags
(
tÙ®
)

339 
´oduûrIn¡


340 .
	`š™
(
ıu
->
numTh»ads
)

341 .
	`Çme
(name() + ".WB:producers")

342 .
	`desc
("num instructions…roducing‡ value")

343 .
	`æags
(
tÙ®
)

346 
cÚsum”In¡


347 .
	`š™
(
ıu
->
numTh»ads
)

348 .
	`Çme
(name() + ".WB:consumers")

349 .
	`desc
("num instructions consuming‡ value")

350 .
	`æags
(
tÙ®
)

353 
wbP’®ized


354 .
	`š™
(
ıu
->
numTh»ads
)

355 .
	`Çme
(name() + ".WB:penalized")

356 .
	`desc
("number of instrctions„equiredo writeo 'other' IQ")

357 .
	`æags
(
tÙ®
)

361 
wbP’®izedR©e


362 .
	`Çme
(name() + ".WB:penalized_rate")

363 .
	`desc
 ("fraction of instructions written-backhat wroteo 'other' IQ")

364 .
	`æags
(
tÙ®
)

367 
wbP’®izedR©e
 = 
wbP’®ized
 / 
wr™ebackCouÁ
;

369 
wbFªout


370 .
	`Çme
(name() + ".WB:fanout")

371 .
	`desc
("average fanout of values written-back")

372 .
	`æags
(
tÙ®
)

375 
wbFªout
 = 
´oduûrIn¡
 / 
cÚsum”In¡
;

377 
wbR©e


378 .
	`Çme
(name() + ".WB:rate")

379 .
	`desc
("insts written-back…er cycle")

380 .
	`æags
(
tÙ®
)

382 
wbR©e
 = 
wr™ebackCouÁ
 / 
ıu
->
numCyşes
;

384 
¡©ComIn¡


385 .
	`š™
(
ıu
->
numTh»ads
)

386 .
	`Çme
(name() + ".COM:count")

387 .
	`desc
("Number of instructions committed")

388 .
	`æags
(
tÙ®
)

391 
¡©ComSwp


392 .
	`š™
(
ıu
->
numTh»ads
)

393 .
	`Çme
(name() + ".COM:swp_count")

394 .
	`desc
("Number of s/w…refetches committed")

395 .
	`æags
(
tÙ®
)

398 
¡©ComRefs


399 .
	`š™
(
ıu
->
numTh»ads
)

400 .
	`Çme
(name() + ".COM:refs")

401 .
	`desc
("Number of memory„eferences committed")

402 .
	`æags
(
tÙ®
)

405 
¡©ComLßds


406 .
	`š™
(
ıu
->
numTh»ads
)

407 .
	`Çme
(name() + ".COM:loads")

408 .
	`desc
("Number of†oads committed")

409 .
	`æags
(
tÙ®
)

412 
¡©ComMemb¬s


413 .
	`š™
(
ıu
->
numTh»ads
)

414 .
	`Çme
(name() + ".COM:membars")

415 .
	`desc
("Number of memory barriers committed")

416 .
	`æags
(
tÙ®
)

419 
¡©ComB¿nches


420 .
	`š™
(
ıu
->
numTh»ads
)

421 .
	`Çme
(name() + ".COM:branches")

422 .
	`desc
("Number of branches committed")

423 .
	`æags
(
tÙ®
)

425 
nComm™‹dDi¡


426 .
	`š™
(0,
comm™Width
,1)

427 .
	`Çme
(name() + ".COM:committed_per_cycle")

428 .
	`desc
("Number of insts commitedƒach cycle")

429 .
	`æags
(
pdf
)

445 
comm™EligibË


446 .
	`š™
(
ıu
->
numTh»ads
)

447 .
	`Çme
(name() + ".COM:bw_limited")

448 .
	`desc
("number of insts‚ot committed dueo BW†imits")

449 .
	`æags
(
tÙ®
)

452 
comm™EligibËSam¶es


453 .
	`Çme
(name() + ".COM:bw_lim_events")

454 .
	`desc
("number cycles where commit BW†imit„eached")

457 
squashedIn¡s


458 .
	`š™
(
ıu
->
numTh»ads
)

459 .
	`Çme
(name() + ".COM:squashed_insts")

460 .
	`desc
("Number of instructions„emoved from inst†ist")

463 
ROBSquashedIn¡s


464 .
	`š™
(
ıu
->
numTh»ads
)

465 .
	`Çme
(name() + ".COM:rob_squashed_insts")

466 .
	`desc
("Number of instructions„emoved from inst†ist whenhey„eachedhe head ofhe ROB")

469 
ROBFcouÁ


470 .
	`Çme
(name() + ".ROB:full_count")

471 .
	`desc
("number of cycles where ROB was full")

474 
ROBCouÁ


475 .
	`š™
(
ıu
->
numTh»ads
)

476 .
	`Çme
(name() + ".ROB:occupancy")

477 .
	`desc
(
	`Çme
() + ".ROB occupancy (cumulative)")

478 .
	`æags
(
tÙ®
)

481 
ROBFuÎR©e


482 .
	`Çme
(name() + ".ROB:full_rate")

483 .
	`desc
("ROB full…er cycle")

485 
ROBFuÎR©e
 = 
ROBFcouÁ
 / 
ıu
->
numCyşes
;

487 
ROBOccR©e


488 .
	`Çme
(name() + ".ROB:occ_rate")

489 .
	`desc
("ROB occupancy„ate")

490 .
	`æags
(
tÙ®
)

492 
ROBOccR©e
 = 
ROBCouÁ
 / 
ıu
->
numCyşes
;

501 
	}
}

503 
	g‹m¶©e
 <
şass
 
	gIm¶
>

505 
	gLWBackEnd
<
	gIm¶
>::
	$£tCPU
(
OzÚeCPU
 *
ıu_±r
)

507 
ıu
 = 
ıu_±r
;

508 
LSQ
.
	`£tCPU
(
ıu_±r
);

509 
check”
 = 
ıu
->checker;

510 
	}
}

512 
	g‹m¶©e
 <
şass
 
	gIm¶
>

514 
	gLWBackEnd
<
	gIm¶
>::
£tCommBufãr
(
TimeBufãr
<
CommSŒuù
> *
_comm
)

516 
comm
 = 
_comm
;

517 
	gtoIEW
 = 
comm
->
g‘Wœe
(0);

518 
	gäomComm™
 = 
comm
->
g‘Wœe
(-1);

521 
	g‹m¶©e
 <
şass
 
	gIm¶
>

523 
	gLWBackEnd
<
	gIm¶
>::
	$checkIÁ”ru±s
()

525 ià(
ıu
->
	`checkIÁ”ru±s
(
tc
è&& !
Œ­Squash
 && !
tcSquash
) {

526 
äÚtEnd
->
š‹¼u±P’dšg
 = 
Œue
;

527 ià(
	`robEm±y
(è&& !
LSQ
.
	`hasStÜesToWB
()) {

536 
	`as£¹
(!
th»ad
->
noSquashFromTC
);

537 
th»ad
->
noSquashFromTC
 = 
Œue
;

540 
ıu
->
	`´oûssIÁ”ru±s
();

543 
comm™Stus
 = 
T¿pP’dšg
;

546 
th»ad
->
noSquashFromTC
 = 
çl£
;

549 
	`g’”©eT¿pEv’t
();

551 
	`DPRINTF
(
BE
, "Interrupt detected.\n");

553 
	`DPRINTF
(
BE
, "Interrupt must wait for ROBo drain.\n");

556 
	}
}

558 
	g‹m¶©e
 <
şass
 
	gIm¶
>

560 
	gLWBackEnd
<
	gIm¶
>::
	$hªdËFauÉ
(
FauÉ
 &
çuÉ
, 
Tick
 
Ï‹ncy
)

562 
	`DPRINTF
(
BE
, "Handling fault!\n");

564 
	`as£¹
(!
th»ad
->
noSquashFromTC
);

566 
th»ad
->
noSquashFromTC
 = 
Œue
;

570 
çuÉ
->
	`švoke
(
th»ad
->
	`g‘TC
());

573 
th»ad
->
noSquashFromTC
 = 
çl£
;

575 
comm™Stus
 = 
T¿pP’dšg
;

578 
	`g’”©eT¿pEv’t
(
Ï‹ncy
);

579 
	}
}

581 
	g‹m¶©e
 <
şass
 
	gIm¶
>

583 
	gLWBackEnd
<
	gIm¶
>::
	$tick
()

585 
	`DPRINTF
(
BE
, "Ticking backƒnd\n");

588 
	`upd©eSŒuùu»s
();

590 ià(
sw™chP’dšg
 && 
	`robEm±y
(è&& !
LSQ
.
	`hasStÜesToWB
()) {

591 
ıu
->
	`sigÇlSw™ched
();

595 
	`»adyIn¡sFÜComm™
();

597 
numIn¡sToWB
.
	`advªû
();

599 
ROBCouÁ
[0]+ğ
numIn¡s
;

601 
wbCyşe
 = 0;

603 
	`checkIÁ”ru±s
();

605 ià(
Œ­Squash
) {

606 
	`as£¹
(!
tcSquash
);

607 
	`squashFromT¿p
();

608 } ià(
tcSquash
) {

609 
	`squashFromTC
();

612 ià(
di¥©chStus
 !ğ
Blocked
) {

613 
	`di¥©chIn¡s
();

615 
	`checkDi¥©chStus
();

618 ià(
comm™Stus
 !ğ
T¿pP’dšg
) {

619 
	`execu‹In¡s
();

621 
	`comm™In¡s
();

624 
LSQ
.
	`wr™ebackStÜes
();

626 
	`DPRINTF
(
BE
, "Waiting insts: %i, mem ops: %i, ROBƒntries in use: %i, "

628 
wa™šgIn¡s
, 
numWa™šgMemOps
, 
numIn¡s
,

629 
LSQ
.
	`numLßds
(), LSQ.
	`numStÜes
());

631 #ifdeà
DEBUG


632 
	`as£¹
(
numIn¡s
 =ğ
š¡Li¡
.
	`size
());

633 
	`as£¹
(
wa™šgIn¡s
 =ğ
wa™šgLi¡
.
	`size
());

634 
	`as£¹
(
numWa™šgMemOps
 =ğ
wa™šgMemOps
.
	`size
());

635 
	`as£¹
(!
sw™chedOut
);

637 
	}
}

639 
	g‹m¶©e
 <
şass
 
	gIm¶
>

641 
	gLWBackEnd
<
	gIm¶
>::
	$upd©eSŒuùu»s
()

643 ià(
äomComm™
->
dÚeSeqNum
) {

644 
LSQ
.
	`comm™Lßds
(
äomComm™
->
dÚeSeqNum
);

645 
LSQ
.
	`comm™StÜes
(
äomComm™
->
dÚeSeqNum
);

648 ià(
äomComm™
->
nÚS³cSeqNum
) {

649 ià(
äomComm™
->
unÿched
) {

656 
	}
}

658 
	g‹m¶©e
 <
şass
 
	gIm¶
>

660 
	gLWBackEnd
<
	gIm¶
>::
	$addToLSQ
(
DynIn¡PŒ
 &
š¡
)

663 
LSQ
.
	`š£¹
(
š¡
);

664 
	}
}

666 
	g‹m¶©e
 <
şass
 
	gIm¶
>

668 
	gLWBackEnd
<
	gIm¶
>::
	$di¥©chIn¡s
()

670 
	`DPRINTF
(
BE
, "Tryingo dispatch instructions.\n");

672 
numIn¡s
 < 
numROBEÁr›s
 &&

673 
numWa™šgMemOps
 < 
maxOut¡ªdšgMemOps
) {

675 ià(
lsqLim™s
 && 
LSQ
.
	`isFuÎ
()) {

679 
DynIn¡PŒ
 
š¡
 = 
äÚtEnd
->
	`g‘In¡
();

680 ià(!
š¡
) {

682 } ià(
š¡
->
	`isSquashed
()) {

686 ++
numIn¡s
;

687 
š¡Li¡
.
	`push_äÚt
(
š¡
);

689 
š¡
->
	`£tInROB
();

691 
	`DPRINTF
(
BE
, "Dispatching instruction [sn:%lli] PC:%#x\n",

692 
š¡
->
£qNum
, in¡->
	`»adPC
());

694 
i
 = 0; i < 
š¡
->
	`numDe¡Regs
(); ++i)

695 
»ÇmeTabË
[
š¡
->
	`de¡RegIdx
(
i
)] = inst;

697 ià(
š¡
->
	`isMemB¬r›r
(è|| in¡->
	`isWr™eB¬r›r
()) {

698 ià(
memB¬r›r
) {

699 
	`DPRINTF
(
BE
, "Instruction [sn:%lli] is waiting on "

701 
š¡
->
£qNum
, 
memB¬r›r
->seqNum);

702 
memB¬r›r
->
	`addMemD•’d’t
(
š¡
);

703 
š¡
->
	`addSrcMemIn¡
(
memB¬r›r
);

705 
memB¬r›r
 = 
š¡
;

706 
š¡
->
	`£tCªComm™
();

707 } ià(
š¡
->
	`»adyToIssue
() &&

708 !
š¡
->
	`isNÚS³cuÏtive
() &&

709 !
š¡
->
	`isStÜeCÚd™iÚ®
()) {

710 ià(
š¡
->
	`isMemRef
()) {

712 
LSQ
.
	`š£¹
(
š¡
);

713 ià(
memB¬r›r
) {

714 
	`DPRINTF
(
BE
, "Instruction [sn:%lli] is waiting on "

716 
š¡
->
£qNum
, 
memB¬r›r
->seqNum);

717 
memB¬r›r
->
	`addMemD•’d’t
(
š¡
);

718 
š¡
->
	`addSrcMemIn¡
(
memB¬r›r
);

719 
	`addWa™šgMemOp
(
š¡
);

721 
wa™šgLi¡
.
	`push_äÚt
(
š¡
);

722 
š¡
->
iqIt
 = 
wa™šgLi¡
.
	`begš
();

723 
š¡
->
iqItV®id
 = 
Œue
;

724 
wa™šgIn¡s
++;

726 
	`DPRINTF
(
BE
, "Instruction [sn:%lli]„eady,‡dddingo "

728 
š¡
->
£qNum
);

729 
exeLi¡
.
	`push
(
š¡
);

731 } ià(
š¡
->
	`isNİ
()) {

732 
	`DPRINTF
(
BE
, "Nopƒncountered [sn:%lli], skippingƒxeList.\n",

733 
š¡
->
£qNum
);

734 
š¡
->
	`£tIssued
();

735 
š¡
->
	`£tExecu‹d
();

736 
š¡
->
	`£tCªComm™
();

737 
numIn¡sToWB
[0]++;

739 
	`DPRINTF
(
BE
, "Instruction [sn:%lli]„eady,‡dddingo "

741 
š¡
->
£qNum
);

742 
exeLi¡
.
	`push
(
š¡
);

745 ià(
š¡
->
	`isNÚS³cuÏtive
(è|| in¡->
	`isStÜeCÚd™iÚ®
()) {

746 
š¡
->
	`£tCªComm™
();

747 
	`DPRINTF
(
BE
, "Adding‚on speculative instruction\n");

750 ià(
š¡
->
	`isMemRef
()) {

751 
	`addWa™šgMemOp
(
š¡
);

752 
LSQ
.
	`š£¹
(
š¡
);

753 ià(
memB¬r›r
) {

754 
memB¬r›r
->
	`addMemD•’d’t
(
š¡
);

755 
š¡
->
	`addSrcMemIn¡
(
memB¬r›r
);

757 
	`DPRINTF
(
BE
, "Instruction [sn:%lli] is waiting on "

759 
š¡
->
£qNum
, 
memB¬r›r
->seqNum);

763 
	`DPRINTF
(
BE
, "Instruction [sn:%lli]‚ot„eady,‡dddingo "

765 
š¡
->
£qNum
);

766 
wa™šgLi¡
.
	`push_äÚt
(
š¡
);

767 
š¡
->
iqIt
 = 
wa™šgLi¡
.
	`begš
();

768 
š¡
->
iqItV®id
 = 
Œue
;

769 
wa™šgIn¡s
++;

796 
	}
}

798 
	g‹m¶©e
 <
şass
 
	gIm¶
>

800 
	gLWBackEnd
<
	gIm¶
>::
	$di¥©chSÎ
()

802 
di¥©chStus
 = 
Blocked
;

803 ià(!
ıu
->
decou¶edFrÚtEnd
) {

807 
	}
}

809 
	g‹m¶©e
 <
şass
 
	gIm¶
>

811 
	gLWBackEnd
<
	gIm¶
>::
	$checkDi¥©chStus
()

813 
	`DPRINTF
(
BE
, "Checking dispatch status\n");

814 
	`as£¹
(
di¥©chStus
 =ğ
Blocked
);

815 ià(!
LSQ
.
	`isFuÎ
() && !isFull()) {

816 
	`DPRINTF
(
BE
, "Dispatch‚o†onger blocked\n");

817 
di¥©chStus
 = 
RuÂšg
;

818 
	`di¥©chIn¡s
();

820 
	}
}

822 
	g‹m¶©e
 <
şass
 
	gIm¶
>

824 
	gLWBackEnd
<
	gIm¶
>::
	$execu‹In¡s
()

826 
	`DPRINTF
(
BE
, "Tryingoƒxecute instructions\n");

828 
num_execu‹d
 = 0;

829 !
exeLi¡
.
	`em±y
(è&& 
num_execu‹d
 < 
issueWidth
) {

830 
DynIn¡PŒ
 
š¡
 = 
exeLi¡
.
	`tİ
();

832 
	`DPRINTF
(
BE
, "Executing inst [sn:%lli] PC: %#x\n",

833 
š¡
->
£qNum
, in¡->
	`»adPC
());

837 ià(
š¡
->
	`isSquashed
()) {

838 
	`DPRINTF
(
BE
, "Execute: Instruction was squashed.\n");

843 ++
num_execu‹d
;

847 
š¡
->
	`£tExecu‹d
();

851 
š¡
->
	`£tCªComm™
();

854 
exeLi¡
.
	`pİ
();

859 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

864 ià(
š¡
->
	`isMemRef
() &&

865 (!
š¡
->
	`isD©aP»ãtch
(è&& !š¡->
	`isIn¡P»ãtch
())) {

866 
	`DPRINTF
(
BE
, "Execute: Initiating‡ccess for memory "

869 ià(
š¡
->
	`isLßd
()) {

870 
LSQ
.
	`execu‹Lßd
(
š¡
);

871 } ià(
š¡
->
	`isStÜe
()) {

872 
FauÉ
 
çuÉ
 = 
LSQ
.
	`execu‹StÜe
(
š¡
);

874 ià(!
š¡
->
	`isStÜeCÚd™iÚ®
(è&& 
çuÉ
 =ğ
NoFauÉ
) {

875 
š¡
->
	`£tExecu‹d
();

877 
	`š¡ToComm™
(
š¡
);

878 } ià(
çuÉ
 !ğ
NoFauÉ
) {

883 
š¡
->
	`£tExecu‹d
();

885 
	`š¡ToComm™
(
š¡
);

888 
	`·nic
("Unknown memype!");

891 
š¡
->
	`execu‹
();

893 
š¡
->
	`£tExecu‹d
();

895 
	`š¡ToComm™
(
š¡
);

898 
	`upd©eExeIn¡Sts
(
š¡
);

900 ++
funcExeIn¡
;

901 ++
num_execu‹d
;

903 
exeLi¡
.
	`pİ
();

905 ià(
š¡
->
	`mi¥»diùed
()) {

906 
	`squashDueToB¿nch
(
š¡
);

908 } ià(
LSQ
.
	`viŞ©iÚ
()) {

911 
DynIn¡PŒ
 
viŞ©Ü
;

912 
viŞ©Ü
 = 
LSQ
.
	`g‘MemD•ViŞ©Ü
();

914 
	`DPRINTF
(
BE
, "LDSTQ detected‡ violation. Violator PC: "

916 
viŞ©Ü
->
	`»adPC
(), 
š¡
->»adPC(), in¡->
physEffAddr
);

919 
	`squashDueToMemViŞ©iÚ
(
š¡
);

923 
issuedOps
[0]+ğ
num_execu‹d
;

924 
nIssuedDi¡
[
num_execu‹d
]++;

925 
	}
}

927 
	g‹m¶©e
<
şass
 
	gIm¶
>

929 
	gLWBackEnd
<
	gIm¶
>::
	$š¡ToComm™
(
DynIn¡PŒ
 &
š¡
)

931 
	`DPRINTF
(
BE
, "Sending instructionso commit [sn:%lli] PC %#x.\n",

932 
š¡
->
£qNum
, in¡->
	`»adPC
());

934 ià(!
š¡
->
	`isSquashed
()) {

935 ià(
š¡
->
	`isExecu‹d
()) {

936 
š¡
->
	`£tResuÉR—dy
();

937 
d•’d’ts
 = 
	`wakeD•’d’ts
(
š¡
);

938 ià(
d•’d’ts
) {

939 
´oduûrIn¡
[0]++;

940 
cÚsum”In¡
[0]+ğ
d•’d’ts
;

945 
wr™eback
.
	`push_back
(
š¡
);

947 
numIn¡sToWB
[0]++;

949 
wr™ebackCouÁ
[0]++;

950 
	}
}

952 
	g‹m¶©e
 <
şass
 
	gIm¶
>

954 
	gLWBackEnd
<
	gIm¶
>::
	$»adyIn¡sFÜComm™
()

956 
i
 = 
numIn¡sToWB
[-
Ï‹ncy
];

957 !
wr™eback
.
	`em±y
(è&& 
i
;

958 --
i
)

960 
DynIn¡PŒ
 
š¡
 = 
wr™eback
.
	`äÚt
();

961 
wr™eback
.
	`pİ_äÚt
();

962 ià(!
š¡
->
	`isSquashed
()) {

963 
	`DPRINTF
(
BE
, "Writing back instruction [sn:%lli] PC %#x.\n",

964 
š¡
->
£qNum
, in¡->
	`»adPC
());

966 
š¡
->
	`£tCªComm™
();

969 
	}
}

972 
	g‹m¶©e
 <
şass
 
	gIm¶
>

974 
	gLWBackEnd
<
	gIm¶
>::
	$wr™ebackIn¡s
()

976 
wb_width
 = 
wbWidth
;

982 
In¡Li¡It
 
wb_š¡_™
 = 
wr™eback
.
	`begš
();

983 
In¡Li¡It
 
wb_’d_™
 = 
wr™eback
.
	`’d
();

984 
š¡_num
 = 0;

985 
cÚsum”_š¡s
 = 0;

987 ; 
š¡_num
 < 
wb_width
 &&

988 
wb_š¡_™
 !ğ
wb_’d_™
; 
š¡_num
++) {

989 
DynIn¡PŒ
 
š¡
 = (*
wb_š¡_™
);

996 ià(!
š¡
->
	`isSquashed
()) {

997 
	`DPRINTF
(
BE
, "Writing back instruction [sn:%lli] PC %#x.\n",

998 
š¡
->
£qNum
, in¡->
	`»adPC
());

1000 
š¡
->
	`£tCªComm™
();

1001 
š¡
->
	`£tResuÉR—dy
();

1003 ià(
š¡
->
	`isExecu‹d
()) {

1004 
d•’d’ts
 = 
	`wakeD•’d’ts
(
š¡
);

1005 ià(
d•’d’ts
) {

1006 
´oduûr_š¡
[0]++;

1007 
cÚsum”_š¡s
+ğ
d•’d’ts
;

1012 
wr™eback
.
	`”a£
(
wb_š¡_™
++);

1014 
LSQ
.
	`wr™ebackStÜes
();

1015 
cÚsum”_š¡
[0]+ğ
cÚsum”_š¡s
;

1016 
wr™eback_couÁ
[0]+ğ
š¡_num
;

1017 
	}
}

1019 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1020 
boŞ


1021 
	gLWBackEnd
<
	gIm¶
>::
	$comm™In¡
(
š¡_num
)

1024 
DynIn¡PŒ
 
š¡
 = 
š¡Li¡
.
	`back
();

1027 
	`as£¹
(
š¡
);

1029 ià(!
š¡
->
	`»adyToComm™
())

1030  
çl£
;

1032 
	`DPRINTF
(
BE
, "Tryingo commit instruction [sn:%lli] PC:%#x\n",

1033 
š¡
->
£qNum
, in¡->
	`»adPC
());

1035 
th»ad
->
	`£tPC
(
š¡
->
	`»adPC
());

1036 
th»ad
->
	`£tNextPC
(
š¡
->
	`»adNextPC
());

1037 
š¡
->
	`£tAtComm™
();

1041 ià(!
š¡
->
	`isExecu‹d
()) {

1042 ià(
š¡
->
	`isNÚS³cuÏtive
() ||

1043 (
š¡
->
	`isStÜeCÚd™iÚ®
(è&& in¡->
	`g‘FauÉ
(è=ğ
NoFauÉ
) ||

1044 
š¡
->
	`isMemB¬r›r
() ||

1045 
š¡
->
	`isWr™eB¬r›r
()) {

1046 ià((
š¡
->
	`isMemB¬r›r
(è|| in¡->
	`isWr™eB¬r›r
() ||

1047 
š¡
->
	`isQu›sû
()è&& 
LSQ
.
	`hasStÜesToWB
())

1049 
	`DPRINTF
(
BE
, "Waiting for‡ll storeso writeback.\n");

1050  
çl£
;

1053 
	`DPRINTF
(
BE
, "Encountered‡ store or‚on-speculative "

1055 
š¡
->
	`»adPC
());

1057 ià(
š¡
->
	`isMemB¬r›r
(è|| in¡->
	`isWr™eB¬r›r
()) {

1058 
	`DPRINTF
(
BE
, "Waking dependents on barrier [sn:%lli]\n",

1059 
š¡
->
£qNum
);

1060 
	`as£¹
(
memB¬r›r
);

1061 
	`wakeD•’d’ts
(
š¡
, 
Œue
);

1062 ià(
memB¬r›r
 =ğ
š¡
)

1063 
memB¬r›r
 = 
NULL
;

1064 
š¡
->
	`ş—rMemD•’d’ts
();

1068 ià(
š¡
->
iqItV®id
) {

1069 
	`DPRINTF
(
BE
, "Removing instruction from waiting†ist\n");

1070 
wa™šgLi¡
.
	`”a£
(
š¡
->
iqIt
);

1071 
š¡
->
iqItV®id
 = 
çl£
;

1072 
wa™šgIn¡s
--;

1073 
	`as£¹
(
wa™šgIn¡s
 >= 0);

1074 ià(
š¡
->
	`isStÜe
())

1075 
	`»moveWa™šgMemOp
(
š¡
);

1078 
exeLi¡
.
	`push
(
š¡
);

1082 
š¡
->
	`ş—rCªComm™
();

1086  
çl£
;

1087 } ià(
š¡
->
	`isLßd
()) {

1088 
	`DPRINTF
(
BE
, "[sn:%lli]: Uncached†oad, PC %#x.\n",

1089 
š¡
->
£qNum
, in¡->
	`»adPC
());

1095 ià(
š¡
->
iqItV®id
) {

1096 
	`DPRINTF
(
BE
, "Removing instruction from waiting†ist\n");

1097 
wa™šgLi¡
.
	`”a£
(
š¡
->
iqIt
);

1098 
š¡
->
iqItV®id
 = 
çl£
;

1099 
wa™šgIn¡s
--;

1100 
	`as£¹
(
wa™šgIn¡s
 >= 0);

1101 
	`»moveWa™šgMemOp
(
š¡
);

1103 
	`»¶ayMemIn¡
(
š¡
);

1105 
š¡
->
	`ş—rCªComm™
();

1107  
çl£
;

1109 
	`·nic
("Tryingo commit un-executed instruction "

1115 
	`as£¹
(!
š¡
->
	`isTh»adSync
());

1116 
	`as£¹
(
š¡
->
	`memD•R—dy
());

1126 ià(!
š¡
->
	`isStÜe
()) {

1127 
š¡
->
	`£tCom¶‘ed
();

1130 
FauÉ
 
š¡_çuÉ
 = 
š¡
->
	`g‘FauÉ
();

1134 ià(
check”
) {

1135 
check”
->
	`v”ify
(
š¡
);

1138 ià(
š¡_çuÉ
 !ğ
NoFauÉ
) {

1139 
	`DPRINTF
(
BE
, "Inst [sn:%lli] PC %#x has‡ fault\n",

1140 
š¡
->
£qNum
, in¡->
	`»adPC
());

1143 
š¡
->
	`£tCom¶‘ed
();

1145 ià(
LSQ
.
	`hasStÜesToWB
()) {

1146 
	`DPRINTF
(
BE
, "Stores still in flight, will wait until drained.\n");

1147  
çl£
;

1148 } ià(
š¡_num
 != 0) {

1149 
	`DPRINTF
(
BE
, "Will wait until instruction is head of commit group.\n");

1150  
çl£
;

1152 ià(
check”
 && 
š¡
->
	`isStÜe
()) {

1153 
check”
->
	`v”ify
(
š¡
);

1156 
	`hªdËFauÉ
(
š¡_çuÉ
);

1157  
çl£
;

1160 
ä“d_»gs
 = 0;

1162 
i
 = 0; i < 
š¡
->
	`numDe¡Regs
(); ++i) {

1163 
	`DPRINTF
(
BE
, "Commit„ename map setting„eg %io [sn:%lli]\n",

1164 ()
š¡
->
	`de¡RegIdx
(
i
), in¡->
£qNum
);

1165 
th»ad
->
»ÇmeTabË
[
š¡
->
	`de¡RegIdx
(
i
)] = inst;

1166 ++
ä“d_»gs
;

1169 ià(
FuÎSy¡em
 && 
th»ad
->
´ofe
) {

1170 
th»ad
->
´ofePC
 = 
š¡
->
	`»adPC
();

1171 
ProfeNode
 *
node
 = 
th»ad
->
´ofe
->
	`cÚsume
Ñh»ad->
	`g‘TC
(),

1172 
š¡
->
¡©icIn¡
);

1174 ià(
node
)

1175 
th»ad
->
´ofeNode
 = 
node
;

1178 ià(
š¡
->
ŒaûD©a
) {

1179 
š¡
->
ŒaûD©a
->
	`£tF‘chSeq
(š¡->
£qNum
);

1180 
š¡
->
ŒaûD©a
->
	`£tCPSeq
(
th»ad
->
numIn¡
);

1181 
š¡
->
ŒaûD©a
->
	`fš®ize
();

1182 
š¡
->
ŒaûD©a
 = 
NULL
;

1185 
š¡
->
	`ş—rD•’d’ts
();

1187 
äÚtEnd
->
	`addF»eRegs
(
ä“d_»gs
);

1189 
š¡Li¡
.
	`pİ_back
();

1191 --
numIn¡s
;

1192 ++
th»ad
->
funcExeIn¡
;

1197 
th»ad
->
	`£tPC
Ñh»ad->
	`»adNextPC
());

1198 
th»ad
->
	`£tNextPC
Ñh»ad->
	`»adNextPC
(è+ (
TheISA
::
MachIn¡
));

1199 
	`upd©eComIn¡Sts
(
š¡
);

1202 
toIEW
->
dÚeSeqNum
 = 
š¡
->
£qNum
;

1203 
Ï¡Comm™Cyşe
 = 
	`curTick
();

1205 ià(
FuÎSy¡em
) {

1206 
couÁ
 = 0;

1207 
Addr
 
Şdpc
;

1209 ià(
couÁ
 == 0)

1210 
	`as£¹
(!
th»ad
->
noSquashFromTC
 && !th»ad->
Œ­P’dšg
);

1211 
Şdpc
 = 
th»ad
->
	`»adPC
();

1212 
ıu
->
sy¡em
->
pcEv’tQueue
.
	`£rviû
(

1213 
th»ad
->
	`g‘TC
());

1214 
couÁ
++;

1215 } 
Şdpc
 !ğ
th»ad
->
	`»adPC
());

1216 ià(
couÁ
 > 1) {

1217 
	`DPRINTF
(
BE
, "PC skip functionƒvent, stopping commit\n");

1218 
tcSquash
 = 
Œue
;

1219  
çl£
;

1222  
Œue
;

1223 
	}
}

1225 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1227 
	gLWBackEnd
<
	gIm¶
>::
	$comm™In¡s
()

1230 
š¡_num
 = 0;

1231 !
š¡Li¡
.
	`em±y
(è&& 
š¡_num
 < 
comm™Width
) {

1232 ià(
š¡Li¡
.
	`back
()->
	`isSquashed
()) {

1233 
š¡Li¡
.
	`back
()->
	`ş—rD•’d’ts
();

1234 
ROBSquashedIn¡s
[
š¡Li¡
.
	`back
()->
th»adNumb”
]++;

1235 
š¡Li¡
.
	`pİ_back
();

1236 --
numIn¡s
;

1240 ià(!
	`comm™In¡
(
š¡_num
++)) {

1241 
	`DPRINTF
(
BE
, "Can't commit, Instruction [sn:%lli] PC "

1243 
š¡Li¡
.
	`back
()->
£qNum
, in¡Li¡.back()->
	`»adPC
());

1244 --
š¡_num
;

1248 
nComm™‹dDi¡
.
	`§m¶e
(
š¡_num
);

1249 
	}
}

1251 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1253 
	gLWBackEnd
<
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
¢
)

1255 
LSQ
.
	`squash
(
¢
);

1257 
ä“d_»gs
 = 0;

1258 
In¡Li¡It
 
š¡s_’d_™
 = 
wa™šgLi¡
.
	`’d
();

1259 
In¡Li¡It
 
š¡s_™
 = 
wa™šgLi¡
.
	`begš
();

1261 
š¡s_™
 !ğ
š¡s_’d_™
 && (*š¡s_™)->
£qNum
 > 
¢
)

1263 ià((*
š¡s_™
)->
	`isSquashed
()) {

1264 ++
š¡s_™
;

1267 
	`DPRINTF
(
BE
, "Squashing instruction on waitingList PC %#x, [sn:%lli].\n",

1268 (*
š¡s_™
)->
	`»adPC
(),

1269 (*
š¡s_™
)->
£qNum
);

1271 ià((*
š¡s_™
)->
	`isMemRef
()) {

1272 
	`DPRINTF
(
BE
, "Squashing‡ waiting mem op [sn:%lli]\n",

1273 (*
š¡s_™
)->
£qNum
);

1274 
	`»moveWa™šgMemOp
((*
š¡s_™
));

1277 
wa™šgLi¡
.
	`”a£
(
š¡s_™
++);

1278 
wa™šgIn¡s
--;

1280 
	`as£¹
(
wa™šgIn¡s
 >= 0);

1282 
š¡s_™
 = 
š¡Li¡
.
	`begš
();

1284 !
š¡Li¡
.
	`em±y
(è&& (*
š¡s_™
)->
£qNum
 > 
¢
)

1286 ià((*
š¡s_™
)->
	`isSquashed
()) {

1287 
	`·nic
("Instruction should‚ot be‡lready squashed‡nd on†ist!");

1288 ++
š¡s_™
;

1291 
	`DPRINTF
(
BE
, "Squashing instruction on inst†ist PC %#x, [sn:%lli].\n",

1292 (*
š¡s_™
)->
	`»adPC
(),

1293 (*
š¡s_™
)->
£qNum
);

1297 (*
š¡s_™
)->
	`£tSquashed
();

1299 (*
š¡s_™
)->
	`£tCªComm™
();

1301 (*
š¡s_™
)->
	`ş—rInROB
();

1303 
i
 = 0; i < (*
š¡s_™
)->
	`numDe¡Regs
(); ++i) {

1304 
DynIn¡PŒ
 
´ev_de¡
 = (*
š¡s_™
)->
	`g‘P»vDe¡In¡
(
i
);

1305 
	`DPRINTF
(
BE
, "Commit„ename map setting„eg %io [sn:%lli]\n",

1306 ()(*
š¡s_™
)->
	`de¡RegIdx
(
i
), 
´ev_de¡
->
£qNum
);

1307 
»ÇmeTabË
[(*
š¡s_™
)->
	`de¡RegIdx
(
i
)] = 
´ev_de¡
;

1308 ++
ä“d_»gs
;

1311 (*
š¡s_™
)->
	`ş—rD•’d’ts
();

1313 
squashedIn¡s
[(*
š¡s_™
)->
th»adNumb”
]++;

1315 
š¡Li¡
.
	`”a£
(
š¡s_™
++);

1316 --
numIn¡s
;

1319 
memB¬r›r
 && memB¬r›r->
£qNum
 > 
¢
) {

1320 
	`DPRINTF
(
BE
, "[sn:%lli] Memory barrier squashed (or…reviously "

1321 "squashed)\n", 
memB¬r›r
->
£qNum
);

1322 
memB¬r›r
->
	`ş—rMemD•’d’ts
();

1323 ià(
memB¬r›r
->
	`memD•R—dy
()) {

1324 
	`DPRINTF
(
BE
, "No…revious barrier\n");

1325 
memB¬r›r
 = 
NULL
;

1327 
¡d
::
li¡
<
DynIn¡PŒ
> &
¤cs
 = 
memB¬r›r
->
	`g‘MemSrcs
();

1328 
memB¬r›r
 = 
¤cs
.
	`äÚt
();

1329 
¤cs
.
	`pİ_äÚt
();

1330 
	`as£¹
(
¤cs
.
	`em±y
());

1331 
	`DPRINTF
(
BE
, "Previous barrier: [sn:%lli]\n",

1332 
memB¬r›r
->
£qNum
);

1336 
š¡s_™
 = 
»¶ayLi¡
.
	`begš
();

1337 
š¡s_’d_™
 = 
»¶ayLi¡
.
	`’d
();

1338 !
»¶ayLi¡
.
	`em±y
(è&& 
š¡s_™
 !ğ
š¡s_’d_™
) {

1339 ià((*
š¡s_™
)->
£qNum
 < 
¢
) {

1340 ++
š¡s_™
;

1343 
	`as£¹
((*
š¡s_™
)->
	`isSquashed
());

1345 
»¶ayLi¡
.
	`”a£
(
š¡s_™
++);

1348 
äÚtEnd
->
	`addF»eRegs
(
ä“d_»gs
);

1349 
	}
}

1351 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1353 
	gLWBackEnd
<
	gIm¶
>::
	$squashFromTC
()

1355 
In¡SeqNum
 
squashed_š¡
 = 
	`robEm±y
(è? 0 : 
š¡Li¡
.
	`back
()->
£qNum
 - 1;

1356 
	`squash
(
squashed_š¡
);

1357 
äÚtEnd
->
	`squash
(
squashed_š¡
, 
th»ad
->
	`»adPC
(),

1358 
çl£
, false);

1359 
äÚtEnd
->
š‹¼u±P’dšg
 = 
çl£
;

1361 
th»ad
->
Œ­P’dšg
 = 
çl£
;

1362 
th»ad
->
noSquashFromTC
 = 
çl£
;

1363 
tcSquash
 = 
çl£
;

1364 
comm™Stus
 = 
RuÂšg
;

1365 
	}
}

1367 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1369 
	gLWBackEnd
<
	gIm¶
>::
	$squashFromT¿p
()

1371 
In¡SeqNum
 
squashed_š¡
 = 
	`robEm±y
(è? 0 : 
š¡Li¡
.
	`back
()->
£qNum
 - 1;

1372 
	`squash
(
squashed_š¡
);

1373 
äÚtEnd
->
	`squash
(
squashed_š¡
, 
th»ad
->
	`»adPC
(),

1374 
çl£
, false);

1375 
äÚtEnd
->
š‹¼u±P’dšg
 = 
çl£
;

1377 
th»ad
->
Œ­P’dšg
 = 
çl£
;

1378 
th»ad
->
noSquashFromTC
 = 
çl£
;

1379 
Œ­Squash
 = 
çl£
;

1380 
comm™Stus
 = 
RuÂšg
;

1381 
	}
}

1383 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1385 
	gLWBackEnd
<
	gIm¶
>::
	$squashDueToB¿nch
(
DynIn¡PŒ
 &
š¡
)

1388 
	`DPRINTF
(
BE
, "Squashing dueo branch [sn:%lli], will„estart‡t PC %#x\n",

1389 
š¡
->
£qNum
, in¡->
	`»adNextPC
());

1390 
	`squash
(
š¡
->
£qNum
);

1391 
äÚtEnd
->
	`squash
(
š¡
->
£qNum
, in¡->
	`»adNextPC
(),

1392 
Œue
, 
š¡
->
	`mi¥»diùed
());

1393 
	}
}

1395 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1397 
	gLWBackEnd
<
	gIm¶
>::
	$squashDueToMemViŞ©iÚ
(
DynIn¡PŒ
 &
š¡
)

1400 
	`DPRINTF
(
BE
, "Squashing dueo violation [sn:%lli], will„estart‡t PC %#x\n",

1401 
š¡
->
£qNum
, in¡->
	`»adNextPC
());

1402 
	`squash
(
š¡
->
£qNum
);

1403 
äÚtEnd
->
	`squash
(
š¡
->
£qNum
, in¡->
	`»adNextPC
(),

1404 
çl£
, 
š¡
->
	`mi¥»diùed
());

1405 
	}
}

1407 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1409 
	gLWBackEnd
<
	gIm¶
>::
	$squashDueToMemBlocked
(
DynIn¡PŒ
 &
š¡
)

1411 
	`DPRINTF
(
IEW
, "Memory blocked, squashing†oad‡nd younger insts, "

1412 "PC: %#x [¢:%i].\n", 
š¡
->
	`»adPC
(), in¡->
£qNum
);

1414 
	`squash
(
š¡
->
£qNum
 - 1);

1415 
äÚtEnd
->
	`squash
(
š¡
->
£qNum
 - 1, in¡->
	`»adPC
());

1416 
	}
}

1418 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1420 
	gLWBackEnd
<
	gIm¶
>::
	$sw™chOut
()

1422 
sw™chP’dšg
 = 
Œue
;

1423 
	}
}

1425 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1427 
	gLWBackEnd
<
	gIm¶
>::
	$doSw™chOut
()

1429 
sw™chedOut
 = 
Œue
;

1430 
sw™chP’dšg
 = 
çl£
;

1434 
	`as£¹
(
	`robEm±y
());

1435 
	`as£¹
(!
LSQ
.
	`hasStÜesToWB
());

1436 
wr™eback
.
	`ş—r
();

1437 
i
 = 0; i < 
numIn¡sToWB
.
	`g‘Size
() + 1; ++i)

1438 
numIn¡sToWB
.
	`advªû
();

1441 
	`as£¹
(
wa™šgLi¡
.
	`em±y
());

1442 
	`as£¹
(
š¡Li¡
.
	`em±y
());

1443 
	`as£¹
(
»¶ayLi¡
.
	`em±y
());

1444 
	`as£¹
(
wr™eback
.
	`em±y
());

1445 
LSQ
.
	`sw™chOut
();

1446 
	}
}

1448 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1450 
	gLWBackEnd
<
	gIm¶
>::
	$keOv”From
(
Th»adCÚ‹xt
 *
Şd_tc
)

1452 
	`as£¹
(!
squashP’dšg
);

1453 
squashSeqNum
 = 0;

1454 
squashNextPC
 = 0;

1455 
tcSquash
 = 
çl£
;

1456 
Œ­Squash
 = 
çl£
;

1458 
numIn¡s
 = 0;

1459 
numWa™šgMemOps
 = 0;

1460 
wa™šgMemOps
.
	`ş—r
();

1461 
wa™šgIn¡s
 = 0;

1462 
sw™chedOut
 = 
çl£
;

1463 
di¥©chStus
 = 
RuÂšg
;

1464 
comm™Stus
 = 
RuÂšg
;

1465 
LSQ
.
	`keOv”From
(
Şd_tc
);

1466 
	}
}

1468 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1470 
	gLWBackEnd
<
	gIm¶
>::
	$upd©eExeIn¡Sts
(
DynIn¡PŒ
 &
š¡
)

1472 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1474 
exeIn¡
[
tid
]++;

1479 ià(
š¡
->
	`isCÚŒŞ
())

1480 
exeB¿nches
[
tid
]++;

1485 ià(
š¡
->
	`isMemRef
()) {

1486 
exeRefs
[
tid
]++;

1488 ià(
š¡
->
	`isLßd
())

1489 
exeLßds
[
tid
]++;

1491 
	}
}

1493 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1495 
	gLWBackEnd
<
	gIm¶
>::
	$upd©eComIn¡Sts
(
DynIn¡PŒ
 &
š¡
)

1497 
Th»adID
 
tid
 = 
š¡
->
th»adNumb”
;

1500 
th»ad
->
numIn¡
++;

1501 
th»ad
->
numIn¡s
++;

1503 
ıu
->
numIn¡
++;

1507 #ifdeà
TARGET_ALPHA


1508 ià(
š¡
->
	`isD©aP»ãtch
()) {

1509 
¡©ComSwp
[
tid
]++;

1511 
¡©ComIn¡
[
tid
]++;

1514 
¡©ComIn¡
[
tid
]++;

1520 ià(
š¡
->
	`isCÚŒŞ
())

1521 
¡©ComB¿nches
[
tid
]++;

1526 ià(
š¡
->
	`isMemRef
()) {

1527 
¡©ComRefs
[
tid
]++;

1529 ià(
š¡
->
	`isLßd
()) {

1530 
¡©ComLßds
[
tid
]++;

1534 ià(
š¡
->
	`isMemB¬r›r
()) {

1535 
¡©ComMemb¬s
[
tid
]++;

1537 
	}
}

1539 
	g‹m¶©e
 <
şass
 
	gIm¶
>

1541 
	gLWBackEnd
<
	gIm¶
>::
	$dumpIn¡s
()

1543 
num
 = 0;

1544 
v®id_num
 = 0;

1546 
In¡Li¡It
 
š¡_li¡_™
 = --(
š¡Li¡
.
	`’d
());

1548 
	`ırštf
("ExeLi¡ size: %i\n", 
exeLi¡
.
	`size
());

1550 
	`ırštf
("In¡†i¡ size: %i\n", 
š¡Li¡
.
	`size
());

1552 
š¡_li¡_™
 !ğ
š¡Li¡
.
	`’d
())

1554 
	`ırštf
("Instruction:%i\n",

1555 
num
);

1556 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

1557 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

1558 ++
v®id_num
;

1559 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1560 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

1561 !(*
š¡_li¡_™
)->
memOpDÚe
) {

1564 ++
v®id_num
;

1565 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1569 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

1571 (*
š¡_li¡_™
)->
	`»adPC
(),

1572 (*
š¡_li¡_™
)->
£qNum
,

1573 (*
š¡_li¡_™
)->
th»adNumb”
,

1574 (*
š¡_li¡_™
)->
	`isIssued
(),

1575 (*
š¡_li¡_™
)->
	`isSquashed
());

1577 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

1578 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

1581 
	`ırštf
("\n");

1583 
š¡_li¡_™
--;

1584 ++
num
;

1587 
š¡_li¡_™
 = --(
wr™eback
.
	`’d
());

1589 
	`ırštf
("Wr™eback†i¡ size: %i\n", 
wr™eback
.
	`size
());

1591 
š¡_li¡_™
 !ğ
wr™eback
.
	`’d
())

1593 
	`ırštf
("Instruction:%i\n",

1594 
num
);

1595 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

1596 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

1597 ++
v®id_num
;

1598 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1599 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

1600 !(*
š¡_li¡_™
)->
memOpDÚe
) {

1603 ++
v®id_num
;

1604 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1608 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

1610 (*
š¡_li¡_™
)->
	`»adPC
(),

1611 (*
š¡_li¡_™
)->
£qNum
,

1612 (*
š¡_li¡_™
)->
th»adNumb”
,

1613 (*
š¡_li¡_™
)->
	`isIssued
(),

1614 (*
š¡_li¡_™
)->
	`isSquashed
());

1616 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

1617 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

1620 
	`ırštf
("\n");

1622 
š¡_li¡_™
--;

1623 ++
num
;

1626 
	`ırštf
("Wa™šg†i¡ size: %i\n", 
wa™šgLi¡
.
	`size
());

1628 
š¡_li¡_™
 = --(
wa™šgLi¡
.
	`’d
());

1630 
š¡_li¡_™
 !ğ
wa™šgLi¡
.
	`’d
())

1632 
	`ırštf
("Instruction:%i\n",

1633 
num
);

1634 ià(!(*
š¡_li¡_™
)->
	`isSquashed
()) {

1635 ià(!(*
š¡_li¡_™
)->
	`isIssued
()) {

1636 ++
v®id_num
;

1637 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1638 } ià((*
š¡_li¡_™
)->
	`isMemRef
() &&

1639 !(*
š¡_li¡_™
)->
memOpDÚe
) {

1642 ++
v®id_num
;

1643 
	`ırštf
("CouÁ:%i\n", 
v®id_num
);

1647 
	`ırštf
("PC:%#x\n[sn:%lli]\n[tid:%i]\n"

1649 (*
š¡_li¡_™
)->
	`»adPC
(),

1650 (*
š¡_li¡_™
)->
£qNum
,

1651 (*
š¡_li¡_™
)->
th»adNumb”
,

1652 (*
š¡_li¡_™
)->
	`isIssued
(),

1653 (*
š¡_li¡_™
)->
	`isSquashed
());

1655 ià((*
š¡_li¡_™
)->
	`isMemRef
()) {

1656 
	`ırštf
("MemOpDÚe:%i\n", (*
š¡_li¡_™
)->
memOpDÚe
);

1659 
	`ırštf
("\n");

1661 
š¡_li¡_™
--;

1662 ++
num
;

1665 
	`ırštf
("wa™šgMemOp li¡ size: %i\n", 
wa™šgMemOps
.
	`size
());

1667 
MemIt
 
wa™šg_™
 = 
wa™šgMemOps
.
	`begš
();

1669 
wa™šg_™
 !ğ
wa™šgMemOps
.
	`’d
())

1671 
	`ırštf
("[¢:%Îi] ", (*
wa™šg_™
));

1672 
wa™šg_™
++;

1673 ++
num
;

1675 
	`ırštf
("\n");

1676 
	}
}

	@ozone/lw_lsq.cc

31 
	~"ıu/ozÚe/lw_lsq_im¶.hh
"

32 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gOzÚeLWLSQ
<
	gOzÚeIm¶
>;

	@ozone/lw_lsq.hh

31 #iâdeà
__CPU_OZONE_LW_LSQ_HH__


32 
	#__CPU_OZONE_LW_LSQ_HH__


	)

34 
	~<®gÜ™hm
>

35 
	~<li¡
>

36 
	~<m­
>

37 
	~<queue
>

39 
	~"¬ch/ty³s.hh
"

40 
	~"ba£/hashm­.hh
"

41 
	~"cÚfig/the_i§.hh
"

42 
	~"ıu/š¡_£q.hh
"

43 
	~"mem/·ck‘.hh
"

44 
	~"mem/pÜt.hh
"

46 
	~"sim/debug.hh
"

47 
	~"sim/çuÉ_fwd.hh
"

48 
	~"sim/sim_objeù.hh
"

50 
şass
 
	gMemObjeù
;

63 
	g‹m¶©e
 <
şass
 
	gIm¶
>

64 şas 
	cOzÚeLWLSQ
 {

65 
	mpublic
:

66 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

67 
ty³Çme
 
	tIm¶
::
	tOzÚeCPU
 OzoneCPU;

68 
ty³Çme
 
	tIm¶
::
	tBackEnd
 BackEnd;

69 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

70 
ty³Çme
 
	tIm¶
::
	tIssueSŒuù
 IssueStruct;

72 
	mTheISA
::
	tIÁReg
 IntReg;

74 
ty³Çme
 
	t¡d
::
	tm­
<
	tIn¡SeqNum
, 
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLdM­It
;

76 
	mpublic
:

78 
OzÚeLWLSQ
();

81 
š™
(
P¬ams
 *
·¿ms
, 
maxLQEÁr›s
,

82 
maxSQEÁr›s
, 
id
);

85 
	m¡d
::
¡ršg
 
	$Çme
() const;

87 
	`»gSts
();

90 
	`£tCPU
(
OzÚeCPU
 *
ıu_±r
);

93 
	$£tBE
(
BackEnd
 *
be_±r
)

94 { 
be
 = 
be_±r
; }

96 
PÜt
 *
	$g‘DÿchePÜt
(è{  &
dÿchePÜt
; 
	}
}

103 
	$tick
(è{ 
u£dPÜts
 = 0; 
	}
}

106 
š£¹
(
DynIn¡PŒ
 &
š¡
);

108 
š£¹Lßd
(
DynIn¡PŒ
 &
lßd_š¡
);

110 
š£¹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
);

113 
FauÉ
 
execu‹Lßd
(
DynIn¡PŒ
 &
š¡
);

116 
FauÉ
 
execu‹StÜe
(
DynIn¡PŒ
 &
š¡
);

119 
comm™Lßd
();

121 
comm™Lßds
(
In¡SeqNum
 &
younge¡_š¡
);

124 
comm™StÜes
(
In¡SeqNum
 &
younge¡_š¡
);

127 
wr™ebackStÜes
();

131 
com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
);

137 
ş—rLQ
();

140 
ş—rSQ
();

143 
»sizeLQ
(
size
);

146 
»sizeSQ
(
size
);

149 
squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
);

154 
boŞ
 
	$viŞ©iÚ
(è{  
memD•ViŞ©Ü
; 
	}
}

157 
DynIn¡PŒ
 
g‘MemD•ViŞ©Ü
();

162 
boŞ
 
	$lßdBlocked
()

163 {  
isLßdBlocked
; 
	}
}

165 
	$ş—rLßdBlocked
()

166 { 
isLßdBlocked
 = 
çl£
; 
	}
}

168 
boŞ
 
	$isLßdBlockedHªdËd
()

169 {  
lßdBlockedHªdËd
; 
	}
}

171 
	$£tLßdBlockedHªdËd
()

172 { 
lßdBlockedHªdËd
 = 
Œue
; 
	}
}

175 
numF»eEÁr›s
();

178 
numLßdsR—dy
();

181 
	$numLßds
(è{  
lßds
; 
	}
}

184 
	$numStÜes
(è{  
¡Ües
 + 
¡ÜesInFlight
; 
	}
}

187 
boŞ
 
	$isFuÎ
(è{  
	`lqFuÎ
(è|| 
	`sqFuÎ
(); 
	}
}

190 
boŞ
 
	$lqFuÎ
(è{  
lßds
 >ğ(
LQEÁr›s
 - 1); 
	}
}

193 
boŞ
 
	$sqFuÎ
(è{  (
¡Ües
 + 
¡ÜesInFlight
è>ğ(
SQEÁr›s
 - 1); 
	}
}

196 
dumpIn¡s
();

199 
	$g‘CouÁ
(è{  
lßds
 + 
¡Ües
; 
	}
}

202 
boŞ
 
	$hasStÜesToWB
(è{  
¡ÜesToWB
; 
	}
}

205 
	$numStÜesToWB
(è{  
¡ÜesToWB
; 
	}
}

208 
boŞ
 
	$wlWB
(è{  
¡ÜeQueue
.
	`back
().
ÿnWB
 &&

209 !
¡ÜeQueue
.
	`back
().
com¶‘ed
 &&

210 !
isStÜeBlocked
; 
	}
}

212 
sw™chOut
();

214 
keOv”From
(
Th»adCÚ‹xt
 *
Şd_tc
 = 
NULL
);

216 
boŞ
 
	$isSw™chedOut
(è{  
sw™chedOut
; 
	}
}

218 
boŞ
 
	gsw™chedOut
;

220 
	g´iv©e
:

222 
wr™eback
(
DynIn¡PŒ
 &
š¡
, 
Pack‘PŒ
 
pkt
);

225 
¡ÜePo¡S’d
(
Pack‘PŒ
 
pkt
, 
DynIn¡PŒ
 &
š¡
);

228 
com¶‘eStÜe
(
DynIn¡PŒ
 &
š¡
);

230 
»moveStÜe
(
¡Üe_idx
);

233 
»cvR‘ry
();

235 
	g´iv©e
:

237 
OzÚeCPU
 *
ıu
;

240 
BackEnd
 *
	gbe
;

242 şas 
	cDÿchePÜt
 : 
public
 
Ma¡”PÜt


244 
´Ùeùed
:

245 
OzÚeLWLSQ
 *
lsq
;

247 
	gpublic
:

248 
DÿchePÜt
(
OzÚeLWLSQ
 *
_lsq
)

249 : 
lsq
(
_lsq
)

252 
´Ùeùed
:

253 
vœtu®
 
Tick
 
»cvAtomic
(
Pack‘PŒ
 
pkt
);

255 
vœtu®
 
»cvFunùiÚ®
(
Pack‘PŒ
 
pkt
);

260 
vœtu®
 
boŞ
 
isSnoİšg
(ècÚ¡ {  
	gŒue
; }

262 
vœtu®
 
boŞ
 
»cvTimšg
(
Pack‘PŒ
 
pkt
);

264 
vœtu®
 
»cvR‘ry
();

268 
DÿchePÜt
 
	gdÿchePÜt
;

270 
	gpublic
:

271 
	sSQEÁry
 {

273 
SQEÁry
()

274 : 
š¡
(
NULL
), 
»q
(NULL), 
size
(0), 
d©a
(0),

275 
ÿnWB
(0), 
comm™‹d
(0), 
com¶‘ed
(0), 
lqIt
(
NULL
)

279 
SQEÁry
(
DynIn¡PŒ
 &
_š¡
)

280 : 
š¡
(
_š¡
), 
»q
(
NULL
), 
size
(0), 
d©a
(0),

281 
ÿnWB
(0), 
comm™‹d
(0), 
com¶‘ed
(0), 
lqIt
(
NULL
)

285 
DynIn¡PŒ
 
	gš¡
;

287 
Reque¡PŒ
 
	g»q
;

289 
	gsize
;

291 
IÁReg
 
	gd©a
;

293 
boŞ
 
	gÿnWB
;

295 
boŞ
 
	gcomm™‹d
;

297 
boŞ
 
	gcom¶‘ed
;

299 
ty³Çme
 
	g¡d
::
li¡
<
DynIn¡PŒ
>::
™”©Ü
 
lqIt
;

303 şas 
	cLSQS’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


305 
public
:

307 
LSQS’d”S‹
()

308 : 
noWB
(
çl£
)

312 
DynIn¡PŒ
 
š¡
;

314 
boŞ
 
	gisLßd
;

316 
	gidx
;

318 
boŞ
 
	gnoWB
;

322 şas 
	cWr™ebackEv’t
 : 
public
 
Ev’t
 {

323 
public
:

325 
Wr™ebackEv’t
(
DynIn¡PŒ
 &
_š¡
, 
Pack‘PŒ
 
pkt
, 
OzÚeLWLSQ
 *
lsq_±r
);

328 
´oûss
();

331 cÚ¡ *
desütiÚ
() const;

333 
	g´iv©e
:

335 
DynIn¡PŒ
 
š¡
;

338 
Pack‘PŒ
 
	gpkt
;

341 
	gOzÚeLWLSQ
<
	gIm¶
> *
	glsqPŒ
;

344 
	eStus
 {

345 
	gRuÂšg
,

346 
	gIdË
,

347 
	gDÿcheMissSÎ
,

348 
	gDÿcheMissSw™ch


351 
	g´iv©e
:

353 
lsqID
;

356 
Stus
 
	g_¡©us
;

359 
	g¡d
::
li¡
<
SQEÁry
> 
¡ÜeQueue
;

361 
	g¡d
::
li¡
<
DynIn¡PŒ
> 
lßdQueue
;

363 
ty³Çme
 
	t¡d
::
	tli¡
<
	tSQEÁry
>::
	t™”©Ü
 
	tSQIt
;

364 
ty³Çme
 
	t¡d
::
	tli¡
<
	tDynIn¡PŒ
>::
	t™”©Ü
 
	tLQIt
;

367 
	sHashFn
 {

368 
size_t
 
İ”©Ü
(è(cÚ¡ 
	ga
) const

370 
	ghash
 = (((
a
 >> 14) ^ ((a >> 2) & 0xffff))) & 0x7FFFFFFF;

372  
	ghash
;

376 
	gm5
::
hash_m­
<, 
	gSQIt
, 
	gHashFn
> 
	gSQItHash
;

377 
	g¡d
::
queue
<> 
SQIndiûs
;

378 
	gm5
::
hash_m­
<, 
	gLQIt
, 
	gHashFn
> 
	gLQItHash
;

379 
	g¡d
::
queue
<> 
LQIndiûs
;

381 
ty³Çme
 
	tm5
::
	thash_m­
<, 
	tLQIt
, 
	tHashFn
>::
	t™”©Ü
 
	tLQHashIt
;

382 
ty³Çme
 
	tm5
::
	thash_m­
<, 
	tSQIt
, 
	tHashFn
>::
	t™”©Ü
 
	tSQHashIt
;

385 
	gLQEÁr›s
;

387 
	gSQEÁr›s
;

390 
	glßds
;

394 
	g¡Ües
;

396 
	g¡ÜesToWB
;

398 
	gpublic
:

399 
¡ÜesInFlight
;

401 
	g´iv©e
:

404 
ÿchePÜts
;

407 
	gu£dPÜts
;

412 
	gSts
::
SÿÏr
 
lsqMemOrd”ViŞ©iÚ
;

415 
CouÁ”
 
	gÏ¡DÿcheSÎ
;

419 
boŞ
 
	g¡®Ëd
;

423 
In¡SeqNum
 
	g¡®lšgStÜeI¢
;

425 
LQIt
 
	g¡®lšgLßd
;

428 
Pack‘PŒ
 
	g»ŒyPkt
;

431 
boŞ
 
	gisStÜeBlocked
;

436 
boŞ
 
	gisLßdBlocked
;

438 
boŞ
 
	glßdBlockedHªdËd
;

440 
In¡SeqNum
 
	gblockedLßdSeqNum
;

443 
DynIn¡PŒ
 
	glßdFauÉIn¡
;

445 
DynIn¡PŒ
 
	g¡ÜeFauÉIn¡
;

448 
DynIn¡PŒ
 
	gmemD•ViŞ©Ü
;

454 
	gpublic
:

456 
‹m¶©e
 <
şass
 
T
>

457 
FauÉ
 
»ad
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
lßd_idx
);

460 
	g‹m¶©e
 <
şass
 
	gT
>

461 
FauÉ
 
wr™e
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
¡Üe_idx
);

464 
In¡SeqNum
 
	$g‘LßdH—dSeqNum
()

466 ià(!
lßdQueue
.
	`em±y
()) {

467  
lßdQueue
.
	`back
()->
£qNum
;

472 
	}
}

475 
In¡SeqNum
 
	$g‘StÜeH—dSeqNum
()

477 ià(!
¡ÜeQueue
.
	`em±y
()) {

478  
¡ÜeQueue
.
	`back
().
š¡
->
£qNum
;

483 
	}
}

486 
boŞ
 
	$isSÎed
(è{  
¡®Ëd
; 
	}
}

489 
	g‹m¶©e
 <
şass
 
	gIm¶
>

490 
	g‹m¶©e
 <
şass
 
	gT
>

491 
FauÉ


492 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$»ad
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
lßd_idx
)

497 
ty³Çme
 
m5
::
hash_m­
<, 
LQIt
, 
HashFn
>::
™”©Ü


498 
lq_hash_™
 = 
LQItHash
.
	`fšd
(
lßd_idx
);

499 
	`as£¹
(
lq_hash_™
 !ğ
LQItHash
.
	`’d
());

500 
DynIn¡PŒ
 
š¡
 = (*(*
lq_hash_™
).
£cÚd
);

507 ià(
»q
->
	`isUnÿch—bË
() &&

508 (
š¡
 !ğ
lßdQueue
.
	`back
(è|| !š¡->
	`isAtComm™
())) {

509 
	`DPRINTF
(
OzÚeLSQ
, "[sn:%lli] Uncached†oad‡nd‚ot head of "

511 
š¡
->
£qNum
);

512 
be
->
	`»scheduËMemIn¡
(
š¡
);

513  
TheISA
::
	`g’MachšeCheckFauÉ
();

517 
SQIt
 
sq_™
 = 
¡ÜeQueue
.
	`begš
();

518 
¡Üe_size
 = 0;

520 
	`DPRINTF
(
OzÚeLSQ
, "Read called,†oad idx: %i‡ddr: %#x\n",

521 
lßd_idx
, 
»q
->
	`g‘Paddr
());

523 
sq_™
 !ğ
¡ÜeQueue
.
	`’d
(è&& (*sq_™).
š¡
->
£qNum
 > inst->seqNum)

524 ++
sq_™
;

528 ià(
sq_™
 =ğ
¡ÜeQueue
.
	`’d
()) {

532 
	`as£¹
((*
sq_™
).
š¡
);

534 
¡Üe_size
 = (*
sq_™
).
size
;

536 ià(
¡Üe_size
 =ğ0 || (*
sq_™
).
comm™‹d
) {

537 
sq_™
++;

543 
boŞ
 
¡Üe_has_low”_lim™
 =

544 
»q
->
	`g‘Vaddr
(è>ğ(*
sq_™
).
š¡
->
effAddr
;

545 
boŞ
 
¡Üe_has_uµ”_lim™
 =

546 (
»q
->
	`g‘Vaddr
(è+„eq->
	`g‘Size
()è<ğ((*
sq_™
).
š¡
->
effAddr
 +

547 
¡Üe_size
);

548 
boŞ
 
low”_lßd_has_¡Üe_·¹
 =

549 
»q
->
	`g‘Vaddr
(è< ((*
sq_™
).
š¡
->
effAddr
 +

550 
¡Üe_size
);

551 
boŞ
 
uµ”_lßd_has_¡Üe_·¹
 =

552 (
»q
->
	`g‘Vaddr
(è+„eq->
	`g‘Size
()è> (*
sq_™
).
š¡
->
effAddr
;

555 ià(
¡Üe_has_low”_lim™
 && 
¡Üe_has_uµ”_lim™
) {

556 
shiá_amt
 = 
»q
->
	`g‘Vaddr
(è& (
¡Üe_size
 - 1);

558 
shiá_amt
 = shift_amt << 3;

561 
d©a
 = (*
sq_™
).d©¨>> 
shiá_amt
;

563 
	`as£¹
(!
š¡
->
memD©a
);

564 
š¡
->
memD©a
 = 
Ãw
 
ušt8_t
[64];

566 
	`memıy
(
š¡
->
memD©a
, &
d©a
, 
»q
->
	`g‘Size
());

568 
	`DPRINTF
(
OzÚeLSQ
, "Forwarding from store [sn:%lli]o†oado "

570 (*
sq_™
).
š¡
->
£qNum
, in¡->£qNum, 
»q
->
	`g‘Vaddr
(),

571 *(
š¡
->
memD©a
));

573 
Pack‘PŒ
 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
Pack‘
::
R—dReq
);

574 
d©a_pkt
->
	`d©aStic
(
š¡
->
memD©a
);

576 
Wr™ebackEv’t
 *
wb
 = 
Ãw
 
	`Wr™ebackEv’t
(
š¡
, 
d©a_pkt
, 
this
);

581 
wb
->
	`scheduË
(
	`curTick
());

584  
NoFauÉ
;

585 } ià((
¡Üe_has_low”_lim™
 && 
low”_lßd_has_¡Üe_·¹
) ||

586 (
¡Üe_has_uµ”_lim™
 && 
uµ”_lßd_has_¡Üe_·¹
) ||

587 (
low”_lßd_has_¡Üe_·¹
 && 
uµ”_lßd_has_¡Üe_·¹
)) {

593 ià((*
sq_™
).
com¶‘ed
) {

594 
sq_™
++;

600 ià(!
¡®Ëd
 ||

601 (
¡®Ëd
 &&

602 
š¡
->
£qNum
 <

603 (*
¡®lšgLßd
)->
£qNum
)) {

604 
¡®Ëd
 = 
Œue
;

605 
¡®lšgStÜeI¢
 = (*
sq_™
).
š¡
->
£qNum
;

606 
¡®lšgLßd
 = (*
lq_hash_™
).
£cÚd
;

611 
be
->
	`»scheduËMemIn¡
(
š¡
);

613 
	`DPRINTF
(
OzÚeLSQ
, "Load-store forwarding mis-match. "

615 (*
sq_™
).
š¡
->
£qNum
, 
»q
->
	`g‘Vaddr
());

617  
NoFauÉ
;

619 
sq_™
++;

623 
	`DPRINTF
(
OzÚeLSQ
, "Doing functional‡ccess for inst PC %#x\n",

624 
š¡
->
	`»adPC
());

626 
	`as£¹
(!
š¡
->
memD©a
);

627 
š¡
->
memD©a
 = 
Ãw
 
ušt8_t
[64];

629 ++
u£dPÜts
;

631 
	`DPRINTF
(
OzÚeLSQ
, "Doingiming‡ccess for inst PC %#x\n",

632 
š¡
->
	`»adPC
());

634 
Pack‘PŒ
 
d©a_pkt
 =

635 
Ãw
 
	`Pack‘
(
»q
,

636 (
»q
->
	`isLLSC
() ?

637 
MemCmd
::
LßdLockedReq
 : 
Pack‘
::
R—dReq
));

638 
d©a_pkt
->
	`d©aStic
(
š¡
->
memD©a
);

640 
LSQS’d”S‹
 *
¡©e
 = 
Ãw
 LSQSenderState;

641 
¡©e
->
isLßd
 = 
Œue
;

642 
¡©e
->
idx
 = 
lßd_idx
;

643 
¡©e
->
š¡
 = inst;

644 
d©a_pkt
->
£nd”S‹
 = 
¡©e
;

647 ià(!
dÿchePÜt
.
	`£ndTimšg
(
d©a_pkt
)) {

649 ià(
isLßdBlocked
 && 
blockedLßdSeqNum
 < 
š¡
->
£qNum
)

650  
NoFauÉ
;

655 
isLßdBlocked
 = 
Œue
;

656 
lßdBlockedHªdËd
 = 
çl£
;

657 
blockedLßdSeqNum
 = 
š¡
->
£qNum
;

659  
NoFauÉ
;

662 ià(
»q
->
	`isLLSC
()) {

663 
ıu
->
lockFÏg
 = 
Œue
;

666  
NoFauÉ
;

667 
	}
}

669 
	g‹m¶©e
 <
şass
 
	gIm¶
>

670 
	g‹m¶©e
 <
şass
 
	gT
>

671 
FauÉ


672 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$wr™e
(
Reque¡PŒ
 
»q
, 
T
 &
d©a
, 
¡Üe_idx
)

674 
SQHashIt
 
sq_hash_™
 = 
SQItHash
.
	`fšd
(
¡Üe_idx
);

675 
	`as£¹
(
sq_hash_™
 !ğ
SQItHash
.
	`’d
());

677 
SQIt
 
sq_™
 = (*
sq_hash_™
).
£cÚd
;

678 
	`as£¹
((*
sq_™
).
š¡
);

680 
	`DPRINTF
(
OzÚeLSQ
, "Doing writeo store idx %i,‡ddr %#x data %#x"

682 
¡Üe_idx
, 
»q
->
	`g‘Paddr
(), 
d©a
, (*
sq_™
).
š¡
->
£qNum
);

684 (*
sq_™
).
»q
 =„eq;

685 (*
sq_™
).
size
 = (
T
);

686 (*
sq_™
).
d©a
 = data;

695  
NoFauÉ
;

696 
	}
}

	@ozone/lw_lsq_impl.hh

31 #iâdeà
__CPU_OZONE_LW_LSQ_IMPL_HH__


32 
	#__CPU_OZONE_LW_LSQ_IMPL_HH__


	)

34 
	~"ba£/¡r.hh
"

35 
	~"cÚfig/the_i§.hh
"

36 
	~"ıu/check”/ıu.hh
"

37 
	~"ıu/ozÚe/lw_lsq.hh
"

38 
	~"sim/çuÉ_fwd.hh
"

40 
	g‹m¶©e
<
şass
 
	gIm¶
>

41 
	gOzÚeLWLSQ
<
	gIm¶
>::
Wr™ebackEv’t
::
	$Wr™ebackEv’t
(
DynIn¡PŒ
 &
_š¡
, 
Pack‘PŒ
 
_pkt
,

42 
OzÚeLWLSQ
 *
lsq_±r
)

43 : 
	`Ev’t
(&
mašEv’tQueue
), 
	`š¡
(
_š¡
), 
	`pkt
(
_pkt
), 
	$lsqPŒ
(
lsq_±r
)

45 
this
->
	`£tFÏgs
(
Ev’t
::
AutoD–‘e
);

46 
	}
}

48 
	g‹m¶©e
<
şass
 
	gIm¶
>

50 
	gOzÚeLWLSQ
<
	gIm¶
>::
Wr™ebackEv’t
::
	$´oûss
()

52 ià(!
lsqPŒ
->
	`isSw™chedOut
()) {

53 
lsqPŒ
->
	`wr™eback
(
š¡
, 
pkt
);

55 
d–‘e
 
pkt
;

56 
	}
}

58 
	g‹m¶©e
<
şass
 
	gIm¶
>

60 
	gOzÚeLWLSQ
<
	gIm¶
>::
Wr™ebackEv’t
::
	$desütiÚ
() const

63 
	}
}

65 
	g‹m¶©e
 <
şass
 
	gIm¶
>

66 
Tick


67 
	gOzÚeLWLSQ
<
	gIm¶
>::
DÿchePÜt
::
	$»cvAtomic
(
Pack‘PŒ
 
pkt
)

69 
	`·nic
("O3CPU model does‚ot work with‡tomic mode!");

70  
	`curTick
();

71 
	}
}

73 
	g‹m¶©e
 <
şass
 
	gIm¶
>

75 
	gOzÚeLWLSQ
<
	gIm¶
>::
DÿchePÜt
::
	$»cvFunùiÚ®
(
Pack‘PŒ
 
pkt
)

77 
	`w¬n
("O3CPU doesn't updatehings on‡„ecvFunctional");

78 
	}
}

80 
	g‹m¶©e
 <
şass
 
	gIm¶
>

81 
boŞ


82 
	gOzÚeLWLSQ
<
	gIm¶
>::
DÿchePÜt
::
	$»cvTimšg
(
Pack‘PŒ
 
pkt
)

84 
lsq
->
	`com¶‘eD©aAcûss
(
pkt
);

85  
Œue
;

86 
	}
}

88 
	g‹m¶©e
 <
şass
 
	gIm¶
>

90 
	gOzÚeLWLSQ
<
	gIm¶
>::
DÿchePÜt
::
	$»cvR‘ry
()

92 
lsq
->
	`»cvR‘ry
();

93 
	}
}

95 
	g‹m¶©e
<
şass
 
	gIm¶
>

97 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
)

99 
LSQS’d”S‹
 *
¡©e
 = 
dyÇmic_ÿ¡
<LSQS’d”S‹ *>(
pkt
->
£nd”S‹
);

100 
DynIn¡PŒ
 
š¡
 = 
¡©e
->inst;

101 
	`DPRINTF
(
IEW
, "Wr™ebackƒv’ˆ[¢:%Îi]\n", 
š¡
->
£qNum
);

102 
	`DPRINTF
(
Aùiv™y
, "Aùiv™y: Wr™ebackƒv’ˆ[¢:%Îi]\n", 
š¡
->
£qNum
);

106 ià(
	`isSw™chedOut
(è|| 
š¡
->
	`isSquashed
()) {

107 
d–‘e
 
¡©e
;

108 
d–‘e
 
pkt
;

111 ià(!
¡©e
->
noWB
) {

112 
	`wr™eback
(
š¡
, 
pkt
);

115 ià(
š¡
->
	`isStÜe
()) {

116 
	`com¶‘eStÜe
(
š¡
);

120 
d–‘e
 
¡©e
;

121 
d–‘e
 
pkt
;

122 
	}
}

124 
	g‹m¶©e
 <
şass
 
	gIm¶
>

125 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$OzÚeLWLSQ
()

126 : 
	`sw™chedOut
(
çl£
), 
	`dÿchePÜt
(
this
), 
	`lßds
(0), 
	`¡Ües
(0),

127 
	`¡ÜesToWB
(0), 
	`¡ÜesInFlight
(0), 
	`¡®Ëd
(
çl£
), 
	`isStÜeBlocked
(false),

128 
	`isLßdBlocked
(
çl£
), 
	$lßdBlockedHªdËd
(
çl£
)

130 
	}
}

132 
	g‹m¶©e
<
şass
 
	gIm¶
>

134 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$š™
(
P¬ams
 *
·¿ms
, 
maxLQEÁr›s
,

135 
maxSQEÁr›s
, 
id
)

137 
	`DPRINTF
(
OzÚeLSQ
, "C»©šg OzÚeLWLSQ%˜objeù.\n",
id
);

139 
lsqID
 = 
id
;

141 
LQEÁr›s
 = 
maxLQEÁr›s
;

142 
SQEÁr›s
 = 
maxSQEÁr›s
;

144 
i
 = 0; i < 
LQEÁr›s
 * 2; i++) {

145 
LQIndiûs
.
	`push
(
i
);

146 
SQIndiûs
.
	`push
(
i
);

149 
u£dPÜts
 = 0;

150 
ÿchePÜts
 = 
·¿ms
->cachePorts;

152 
lßdFauÉIn¡
 = 
¡ÜeFauÉIn¡
 = 
memD•ViŞ©Ü
 = 
NULL
;

154 
blockedLßdSeqNum
 = 0;

155 
	}
}

157 
	g‹m¶©e
<
şass
 
	gIm¶
>

158 
	g¡d
::
¡ršg


159 
OzÚeLWLSQ
<
Im¶
>::
	$Çme
() const

162 
	}
}

164 
	g‹m¶©e
<
şass
 
	gIm¶
>

166 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$»gSts
()

168 
lsqMemOrd”ViŞ©iÚ


169 .
	`Çme
(name() + ".memOrderViolation")

170 .
	`desc
("Number of memory ordering violations");

171 
	}
}

173 
	g‹m¶©e
<
şass
 
	gIm¶
>

175 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$£tCPU
(
OzÚeCPU
 *
ıu_±r
)

177 
ıu
 = 
ıu_±r
;

178 
dÿchePÜt
.
	`£tName
(
this
->
	`Çme
() + "-dport");

180 ià(
ıu
->
check”
) {

181 
ıu
->
check”
->
	`£tDÿchePÜt
(&
dÿchePÜt
);

183 
	}
}

185 
	g‹m¶©e
<
şass
 
	gIm¶
>

187 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$ş—rLQ
()

189 
lßdQueue
.
	`ş—r
();

190 
	}
}

192 
	g‹m¶©e
<
şass
 
	gIm¶
>

194 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$ş—rSQ
()

196 
¡ÜeQueue
.
	`ş—r
();

197 
	}
}

207 
	g‹m¶©e
<
şass
 
	gIm¶
>

209 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$»sizeLQ
(
size
)

211 
	`as£¹
Ğ
size
 >ğ
LQEÁr›s
);

213 ià(
size
 > 
LQEÁr›s
) {

214 
size
 > 
lßdQueue
.
	`size
()) {

215 
DynIn¡PŒ
 
dummy
;

216 
lßdQueue
.
	`push_back
(
dummy
);

217 
LQEÁr›s
++;

220 
LQEÁr›s
 = 
size
;

223 
	}
}

225 
	g‹m¶©e
<
şass
 
	gIm¶
>

227 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$»sizeSQ
(
size
)

229 ià(
size
 > 
SQEÁr›s
) {

230 
size
 > 
¡ÜeQueue
.
	`size
()) {

231 
SQEÁry
 
dummy
;

232 
¡ÜeQueue
.
	`push_back
(
dummy
);

233 
SQEÁr›s
++;

236 
SQEÁr›s
 = 
size
;

238 
	}
}

240 
	g‹m¶©e
 <
şass
 
	gIm¶
>

242 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$š£¹
(
DynIn¡PŒ
 &
š¡
)

245 
	`as£¹
(
š¡
->
	`isMemRef
());

248 
	`as£¹
(
š¡
->
	`isLßd
(è|| in¡->
	`isStÜe
());

250 ià(
š¡
->
	`isLßd
()) {

251 
	`š£¹Lßd
(
š¡
);

253 
	`š£¹StÜe
(
š¡
);

255 
	}
}

257 
	g‹m¶©e
 <
şass
 
	gIm¶
>

259 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$š£¹Lßd
(
DynIn¡PŒ
 &
lßd_š¡
)

261 
	`as£¹
(
lßds
 < 
LQEÁr›s
 * 2);

262 
	`as£¹
(!
LQIndiûs
.
	`em±y
());

263 
lßd_šdex
 = 
LQIndiûs
.
	`äÚt
();

264 
LQIndiûs
.
	`pİ
();

266 
	`DPRINTF
(
OzÚeLSQ
, "Inserting†oad PC %#x, idx:%i [sn:%lli]\n",

267 
lßd_š¡
->
	`»adPC
(), 
lßd_šdex
,†ßd_š¡->
£qNum
);

269 
lßd_š¡
->
lqIdx
 = 
lßd_šdex
;

271 
lßdQueue
.
	`push_äÚt
(
lßd_š¡
);

272 
LQItHash
[
lßd_šdex
] = 
lßdQueue
.
	`begš
();

274 ++
lßds
;

275 
	}
}

277 
	g‹m¶©e
 <
şass
 
	gIm¶
>

279 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$š£¹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
)

282 
	`as£¹
(
¡Ües
 - 
¡ÜesToWB
 < 
SQEÁr›s
);

284 
	`as£¹
(!
SQIndiûs
.
	`em±y
());

285 
¡Üe_šdex
 = 
SQIndiûs
.
	`äÚt
();

286 
SQIndiûs
.
	`pİ
();

288 
	`DPRINTF
(
OzÚeLSQ
, "Inserting store PC %#x, idx:%i [sn:%lli]\n",

289 
¡Üe_š¡
->
	`»adPC
(), 
¡Üe_šdex
, stÜe_š¡->
£qNum
);

291 
¡Üe_š¡
->
sqIdx
 = 
¡Üe_šdex
;

292 
SQEÁry
 
	`’Œy
(
¡Üe_š¡
);

293 ià(
lßdQueue
.
	`em±y
()) {

294 
’Œy
.
lqIt
 = 
lßdQueue
.
	`’d
();

296 
’Œy
.
lqIt
 = 
lßdQueue
.
	`begš
();

298 
¡ÜeQueue
.
	`push_äÚt
(
’Œy
);

300 
SQItHash
[
¡Üe_šdex
] = 
¡ÜeQueue
.
	`begš
();

302 ++
¡Ües
;

303 
	}
}

305 
	g‹m¶©e
 <
şass
 
	gIm¶
>

306 
ty³Çme
 
	gIm¶
::
DynIn¡PŒ


307 
OzÚeLWLSQ
<
Im¶
>::
	$g‘MemD•ViŞ©Ü
()

309 
DynIn¡PŒ
 
‹mp
 = 
memD•ViŞ©Ü
;

311 
memD•ViŞ©Ü
 = 
NULL
;

313  
‹mp
;

314 
	}
}

316 
	g‹m¶©e
 <
şass
 
	gIm¶
>

318 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$numF»eEÁr›s
()

320 
ä“_lq_’Œ›s
 = 
LQEÁr›s
 - 
lßds
;

321 
ä“_sq_’Œ›s
 = 
SQEÁr›s
 - (
¡Ües
 + 
¡ÜesInFlight
);

325 ià(
ä“_lq_’Œ›s
 < 
ä“_sq_’Œ›s
) {

326  
ä“_lq_’Œ›s
 - 1;

328  
ä“_sq_’Œ›s
 - 1;

330 
	}
}

332 
	g‹m¶©e
 <
şass
 
	gIm¶
>

334 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$numLßdsR—dy
()

336 
»tv®
 = 0;

337 
LQIt
 
lq_™
 = 
lßdQueue
.
	`begš
();

338 
LQIt
 
’d_™
 = 
lßdQueue
.
	`’d
();

340 
lq_™
 !ğ
’d_™
) {

341 ià((*
lq_™
)->
	`»adyToIssue
()) {

342 ++
»tv®
;

346  
»tv®
;

347 
	}
}

349 
	g‹m¶©e
 <
şass
 
	gIm¶
>

350 
FauÉ


351 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$execu‹Lßd
(
DynIn¡PŒ
 &
š¡
)

354 
FauÉ
 
lßd_çuÉ
 = 
NoFauÉ
;

356 
	`DPRINTF
(
OzÚeLSQ
, "Executing†oad PC %#x, [sn:%lli]\n",

357 
š¡
->
	`»adPC
(),š¡->
£qNum
);

378 
lßd_çuÉ
 = 
š¡
->
	`š™Ÿ‹Acc
();

383 ià(
lßd_çuÉ
 !ğ
NoFauÉ
) {

384 
	`DPRINTF
(
OzÚeLSQ
, "Lßd [¢:%Îi] ha ¨çuÉ\n", 
š¡
->
£qNum
);

385 ià(!(
š¡
->
»q
->
	`isUnÿch—bË
(è&& !š¡->
	`isAtComm™
())) {

386 
š¡
->
	`£tExecu‹d
();

390 
be
->
	`š¡ToComm™
(
š¡
);

394  
lßd_çuÉ
;

395 
	}
}

397 
	g‹m¶©e
 <
şass
 
	gIm¶
>

398 
FauÉ


399 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$execu‹StÜe
(
DynIn¡PŒ
 &
¡Üe_š¡
)

402 
	`as£¹
(
¡Ües
 != 0);

404 
¡Üe_idx
 = 
¡Üe_š¡
->
sqIdx
;

405 
SQHashIt
 
sq_hash_™
 = 
SQItHash
.
	`fšd
(
¡Üe_idx
);

406 
	`as£¹
(
sq_hash_™
 !ğ
SQItHash
.
	`’d
());

407 
	`DPRINTF
(
OzÚeLSQ
, "Executing store PC %#x [sn:%lli]\n",

408 
¡Üe_š¡
->
	`»adPC
(), stÜe_š¡->
£qNum
);

410 
SQIt
 
sq_™
 = (*
sq_hash_™
).
£cÚd
;

412 
FauÉ
 
¡Üe_çuÉ
 = 
¡Üe_š¡
->
	`š™Ÿ‹Acc
();

416 
size
 = (*
sq_™
).size;

418 ià(
size
 == 0) {

419 
	`DPRINTF
(
OzÚeLSQ
,"Fault on Store PC %#x, [sn:%lli],Size = 0\n",

420 
¡Üe_š¡
->
	`»adPC
(),¡Üe_š¡->
£qNum
);

422  
¡Üe_çuÉ
;

425 
	`as£¹
(
¡Üe_çuÉ
 =ğ
NoFauÉ
);

427 ià(!
¡ÜeFauÉIn¡
) {

428 ià(
¡Üe_çuÉ
 !ğ
NoFauÉ
) {

429 
	`·nic
("Fault in‡ store instruction!");

430 
¡ÜeFauÉIn¡
 = 
¡Üe_š¡
;

431 } ià(
¡Üe_š¡
->
	`isStÜeCÚd™iÚ®
()) {

434 (*
sq_™
).
ÿnWB
 = 
Œue
;

436 ++
¡ÜesToWB
;

437 
	`DPRINTF
(
OzÚeLSQ
, "Nonspeculative store! storesToWB:%i\n",

438 
¡ÜesToWB
);

442 
LQIt
 
lq_™
 = --(
lßdQueue
.
	`’d
());

444 ià(!
memD•ViŞ©Ü
) {

445 
lq_™
 !ğ
lßdQueue
.
	`’d
()) {

446 ià((*
lq_™
)->
£qNum
 < 
¡Üe_š¡
->seqNum) {

447 
lq_™
--;

459 ià(((*
lq_™
)->
effAddr
 >> 8) ==

460 (
¡Üe_š¡
->
effAddr
 >> 8)) {

463 
memD•ViŞ©Ü
 = (*
lq_™
);

464 ++
lsqMemOrd”ViŞ©iÚ
;

466  
TheISA
::
	`g’MachšeCheckFauÉ
();

469 
lq_™
--;

473 
memD•ViŞ©Ü
 = 
NULL
;

476  
¡Üe_çuÉ
;

477 
	}
}

479 
	g‹m¶©e
 <
şass
 
	gIm¶
>

481 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$comm™Lßd
()

483 
	`as£¹
(!
lßdQueue
.
	`em±y
());

485 
	`DPRINTF
(
OzÚeLSQ
, "[sn:%lli] Committing head†oad instruction, PC %#x\n",

486 
lßdQueue
.
	`back
()->
£qNum
,†ßdQueue.back()->
	`»adPC
());

488 
LQIndiûs
.
	`push
(
lßdQueue
.
	`back
()->
lqIdx
);

489 
LQItHash
.
	`”a£
(
lßdQueue
.
	`back
()->
lqIdx
);

491 
lßdQueue
.
	`pİ_back
();

493 --
lßds
;

494 
	}
}

496 
	g‹m¶©e
 <
şass
 
	gIm¶
>

498 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$comm™Lßds
(
In¡SeqNum
 &
younge¡_š¡
)

500 
	`as£¹
(
lßds
 =ğ0 || !
lßdQueue
.
	`em±y
());

502 
lßds
 != 0 &&

503 
lßdQueue
.
	`back
()->
£qNum
 <ğ
younge¡_š¡
) {

504 
	`comm™Lßd
();

506 
	}
}

508 
	g‹m¶©e
 <
şass
 
	gIm¶
>

510 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$comm™StÜes
(
In¡SeqNum
 &
younge¡_š¡
)

512 
	`as£¹
(
¡Ües
 =ğ0 || !
¡ÜeQueue
.
	`em±y
());

514 
SQIt
 
sq_™
 = --(
¡ÜeQueue
.
	`’d
());

515 !
¡ÜeQueue
.
	`em±y
(è&& 
sq_™
 !ğ¡ÜeQueue.
	`’d
()) {

516 
	`as£¹
((*
sq_™
).
š¡
);

517 ià(!(*
sq_™
).
ÿnWB
) {

518 ià((*
sq_™
).
š¡
->
£qNum
 > 
younge¡_š¡
) {

521 ++
¡ÜesToWB
;

523 
	`DPRINTF
(
OzÚeLSQ
, "Marking store‡s‡bleo write back, PC "

525 (*
sq_™
).
š¡
->
	`»adPC
(),

526 (*
sq_™
).
š¡
->
£qNum
,

527 
¡ÜesToWB
);

529 (*
sq_™
).
ÿnWB
 = 
Œue
;

532 
sq_™
--;

534 
	}
}

536 
	g‹m¶©e
 <
şass
 
	gIm¶
>

538 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$wr™ebackStÜes
()

540 
SQIt
 
sq_™
 = --(
¡ÜeQueue
.
	`’d
());

541 
¡ÜesToWB
 > 0 &&

542 
sq_™
 !ğ
¡ÜeQueue
.
	`’d
() &&

543 (*
sq_™
).
š¡
 &&

544 (*
sq_™
).
ÿnWB
 &&

545 
u£dPÜts
 < 
ÿchePÜts
) {

547 ià(
isStÜeBlocked
) {

548 
	`DPRINTF
(
OzÚeLSQ
, "Unableo write back‡ny more stores, cache"

553 
DynIn¡PŒ
 
š¡
 = (*
sq_™
).inst;

555 ià((*
sq_™
).
size
 =ğ0 && !(*sq_™).
com¶‘ed
) {

556 
sq_™
--;

557 
	`»moveStÜe
(
š¡
->
sqIdx
);

558 
	`com¶‘eStÜe
(
š¡
);

562 ià(
š¡
->
	`isD©aP»ãtch
(è|| (*
sq_™
).
comm™‹d
) {

563 
sq_™
--;

567 ++
u£dPÜts
;

569 
	`as£¹
((*
sq_™
).
»q
);

570 
	`as£¹
(!(*
sq_™
).
comm™‹d
);

572 
Reque¡
 *
»q
 = (*
sq_™
).req;

573 (*
sq_™
).
comm™‹d
 = 
Œue
;

575 
	`as£¹
(!
š¡
->
memD©a
);

576 
š¡
->
memD©a
 = 
Ãw
 
ušt8_t
[64];

577 
	`memıy
(
š¡
->
memD©a
, (
ušt8_t
 *)&(*
sq_™
).
d©a
,

578 
»q
->
	`g‘Size
());

580 
MemCmd
 
commªd
 =

581 
»q
->
	`isSw­
(è? 
MemCmd
::
Sw­Req
 :

582 (
»q
->
	`isLLSC
(è? 
MemCmd
::
Wr™eReq
 : MemCmd::
StÜeCÚdReq
);

583 
Pack‘PŒ
 
d©a_pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
commªd
);

584 
d©a_pkt
->
	`d©aStic
(
š¡
->
memD©a
);

586 
LSQS’d”S‹
 *
¡©e
 = 
Ãw
 LSQSenderState;

587 
¡©e
->
isLßd
 = 
çl£
;

588 
¡©e
->
idx
 = 
š¡
->
sqIdx
;

589 
¡©e
->
š¡
 = inst;

590 
d©a_pkt
->
£nd”S‹
 = 
¡©e
;

592 
	`DPRINTF
(
OzÚeLSQ
, "D-Cache: Writing back store PC:%#x "

594 (*
sq_™
).
š¡
->
	`»adPC
(),

595 
»q
->
	`g‘Paddr
(), *(
š¡
->
memD©a
),

596 
š¡
->
£qNum
);

599 ià(
»q
->
	`isLLSC
()) {

600 ià(
»q
->
	`isUnÿch—bË
()) {

601 
»q
->
	`£tExŒaD©a
(2);

603 ià(
ıu
->
lockFÏg
) {

604 
»q
->
	`£tExŒaD©a
(1);

606 
»q
->
	`£tExŒaD©a
(0);

608 
	`com¶‘eD©aAcûss
(
d©a_pkt
);

609 --
sq_™
;

615 
¡©e
->
noWB
 = 
Œue
;

618 ià(!
dÿchePÜt
.
	`£ndTimšg
(
d©a_pkt
)) {

620 
isStÜeBlocked
 = 
Œue
;

621 
	`as£¹
(
»ŒyPkt
 =ğ
NULL
);

622 
»ŒyPkt
 = 
d©a_pkt
;

624 
	`¡ÜePo¡S’d
(
d©a_pkt
, 
š¡
);

625 --
sq_™
;

705 
u£dPÜts
 = 0;

707 
	`as£¹
(
¡Ües
 >ğ0 && 
¡ÜesToWB
 >= 0);

708 
	}
}

710 
	g‹m¶©e
 <
şass
 
	gIm¶
>

712 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$squash
(cÚ¡ 
In¡SeqNum
 &
squashed_num
)

714 
	`DPRINTF
(
OzÚeLSQ
, "Squashing until [sn:%lli]!"

715 "(Lßds:%˜StÜes:%i)\n",
squashed_num
,
lßds
,
¡Ües
+
¡ÜesInFlight
);

718 
LQIt
 
lq_™
 = 
lßdQueue
.
	`begš
();

720 
lßds
 !ğ0 && (*
lq_™
)->
£qNum
 > 
squashed_num
) {

721 
	`as£¹
(!
lßdQueue
.
	`em±y
());

723 
	`DPRINTF
(
OzÚeLSQ
,"Load Instruction PC %#x squashed, "

725 (*
lq_™
)->
	`»adPC
(),

726 (*
lq_™
)->
£qNum
);

728 ià(
	`isSÎed
(è&& 
lq_™
 =ğ
¡®lšgLßd
) {

729 
¡®Ëd
 = 
çl£
;

730 
¡®lšgStÜeI¢
 = 0;

731 
¡®lšgLßd
 = 
NULL
;

734 --
lßds
;

737 
LQHashIt
 
lq_hash_™
 = 
LQItHash
.
	`fšd
((*
lq_™
)->
lqIdx
);

738 
	`as£¹
(
lq_hash_™
 !ğ
LQItHash
.
	`’d
());

739 
LQItHash
.
	`”a£
(
lq_hash_™
);

740 
LQIndiûs
.
	`push
((*
lq_™
)->
lqIdx
);

741 
lßdQueue
.
	`”a£
(
lq_™
++);

744 ià(
isLßdBlocked
) {

745 ià(
squashed_num
 < 
blockedLßdSeqNum
) {

746 
isLßdBlocked
 = 
çl£
;

747 
lßdBlockedHªdËd
 = 
çl£
;

748 
blockedLßdSeqNum
 = 0;

752 
SQIt
 
sq_™
 = 
¡ÜeQueue
.
	`begš
();

754 
¡Ües
 !ğ0 && (*
sq_™
).
š¡
->
£qNum
 > 
squashed_num
) {

755 
	`as£¹
(!
¡ÜeQueue
.
	`em±y
());

757 ià((*
sq_™
).
ÿnWB
) {

762 
	`DPRINTF
(
OzÚeLSQ
,"Store Instruction PC %#x idx:%i squashed [sn:%lli]\n",

763 (*
sq_™
).
š¡
->
	`»adPC
(), (*sq_™).š¡->
sqIdx
,

764 (*
sq_™
).
š¡
->
£qNum
);

768 ià(
	`isSÎed
() &&

769 (*
sq_™
).
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

770 
	`·nic
("Is stalled should have been cleared by stalling†oad!\n");

771 
¡®Ëd
 = 
çl£
;

772 
¡®lšgStÜeI¢
 = 0;

775 
SQHashIt
 
sq_hash_™
 = 
SQItHash
.
	`fšd
((*
sq_™
).
š¡
->
sqIdx
);

776 
	`as£¹
(
sq_hash_™
 !ğ
SQItHash
.
	`’d
());

777 
SQItHash
.
	`”a£
(
sq_hash_™
);

778 
SQIndiûs
.
	`push
((*
sq_™
).
š¡
->
sqIdx
);

779 (*
sq_™
).
š¡
 = 
NULL
;

780 (*
sq_™
).
ÿnWB
 = 0;

781 (*
sq_™
).
»q
 = 
NULL
;

782 --
¡Ües
;

783 
¡ÜeQueue
.
	`”a£
(
sq_™
++);

785 
	}
}

787 
	g‹m¶©e
 <
şass
 
	gIm¶
>

789 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$dumpIn¡s
()

791 
	`ırštf
("Load store queue: Dumping instructions.\n");

792 
	`ırštf
("Lßd queusize: %i\n", 
lßds
);

793 
	`ırštf
("Load queue: ");

795 
LQIt
 
lq_™
 = --(
lßdQueue
.
	`’d
());

797 
lq_™
 !ğ
lßdQueue
.
	`’d
() && (*lq_it)) {

798 
	`ırštf
("[¢:%Îi] %#x ", (*
lq_™
)->
£qNum
,

799 (*
lq_™
)->
	`»adPC
());

801 
lq_™
--;

804 
	`ırštf
("\nStÜqueusize: %i\n", 
¡Ües
);

805 
	`ırštf
("Store queue: ");

807 
SQIt
 
sq_™
 = --(
¡ÜeQueue
.
	`’d
());

809 
sq_™
 !ğ
¡ÜeQueue
.
	`’d
(è&& (*sq_™).
š¡
) {

810 
	`ırštf
("[sn:%lli]\nPC:%#x\nSize:%i\nCommitted:%i\nCompleted:%i\ncanWB:%i\n",

811 (*
sq_™
).
š¡
->
£qNum
,

812 (*
sq_™
).
š¡
->
	`»adPC
(),

813 (*
sq_™
).
size
,

814 (*
sq_™
).
comm™‹d
,

815 (*
sq_™
).
com¶‘ed
,

816 (*
sq_™
).
ÿnWB
);

818 
sq_™
--;

821 
	`ırštf
("\n");

822 
	}
}

824 
	g‹m¶©e
 <
şass
 
	gIm¶
>

826 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$¡ÜePo¡S’d
(
Pack‘PŒ
 
pkt
, 
DynIn¡PŒ
 &
š¡
)

828 ià(
	`isSÎed
() &&

829 
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

830 
	`DPRINTF
(
OzÚeLSQ
, "Unstalling, stalling store [sn:%lli] "

832 
¡®lšgStÜeI¢
, (*
¡®lšgLßd
)->
£qNum
);

833 
¡®Ëd
 = 
çl£
;

834 
¡®lšgStÜeI¢
 = 0;

835 
be
->
	`»¶ayMemIn¡
((*
¡®lšgLßd
));

838 ià(!
š¡
->
	`isStÜeCÚd™iÚ®
()) {

842 
š¡
->
	`£tCom¶‘ed
();

843 ià(
ıu
->
check”
) {

844 
ıu
->
check”
->
	`v”ify
(
š¡
);

847 
	}
}

849 
	g‹m¶©e
 <
şass
 
	gIm¶
>

851 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$wr™eback
(
DynIn¡PŒ
 &
š¡
, 
Pack‘PŒ
 
pkt
)

854 ià(
š¡
->
	`isSquashed
()) {

855 
	`as£¹
(!
š¡
->
	`isStÜe
());

859 ià(!
š¡
->
	`isExecu‹d
()) {

860 
š¡
->
	`£tExecu‹d
();

863 
š¡
->
	`com¶‘eAcc
(
pkt
);

867 
be
->
	`š¡ToComm™
(
š¡
);

868 
	}
}

870 
	g‹m¶©e
 <
şass
 
	gIm¶
>

872 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$»moveStÜe
(
¡Üe_idx
)

874 
SQHashIt
 
sq_hash_™
 = 
SQItHash
.
	`fšd
(
¡Üe_idx
);

875 
	`as£¹
(
sq_hash_™
 !ğ
SQItHash
.
	`’d
());

876 
SQIt
 
sq_™
 = (*
sq_hash_™
).
£cÚd
;

878 
	`as£¹
((*
sq_™
).
š¡
);

879 (*
sq_™
).
com¶‘ed
 = 
Œue
;

880 
DynIn¡PŒ
 
š¡
 = (*
sq_™
).inst;

882 ià(
	`isSÎed
() &&

883 
š¡
->
£qNum
 =ğ
¡®lšgStÜeI¢
) {

884 
	`DPRINTF
(
OzÚeLSQ
, "Unstalling, stalling store [sn:%lli] "

886 
¡®lšgStÜeI¢
, (*
¡®lšgLßd
)->
£qNum
);

887 
¡®Ëd
 = 
çl£
;

888 
¡®lšgStÜeI¢
 = 0;

889 
be
->
	`»¶ayMemIn¡
((*
¡®lšgLßd
));

892 
	`DPRINTF
(
OzÚeLSQ
, "Completing store idx:%i [sn:%lli], storesToWB:%i\n",

893 
š¡
->
sqIdx
, in¡->
£qNum
, 
¡ÜesToWB
);

895 
	`as£¹
(!
¡ÜeQueue
.
	`em±y
());

896 
SQItHash
.
	`”a£
(
sq_hash_™
);

897 
SQIndiûs
.
	`push
(
š¡
->
sqIdx
);

898 
¡ÜeQueue
.
	`”a£
(
sq_™
);

899 
	}
}

901 
	g‹m¶©e
 <
şass
 
	gIm¶
>

903 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$com¶‘eStÜe
(
DynIn¡PŒ
 &
š¡
)

905 --
¡ÜesToWB
;

906 --
¡Ües
;

908 
š¡
->
	`£tCom¶‘ed
();

909 ià(
ıu
->
check”
) {

910 
ıu
->
check”
->
	`v”ify
(
š¡
);

912 
	}
}

914 
	g‹m¶©e
 <
şass
 
	gIm¶
>

916 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$»cvR‘ry
()

918 
	`·nic
("Unimplemented!");

919 
	}
}

921 
	g‹m¶©e
 <
şass
 
	gIm¶
>

923 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$sw™chOut
()

925 
	`as£¹
(
¡ÜesToWB
 == 0);

926 
sw™chedOut
 = 
Œue
;

929 
	`as£¹
(
¡Ües
 == 0);

930 
	`as£¹
(
¡ÜeQueue
.
	`em±y
());

931 
	`as£¹
(
lßds
 == 0);

932 
	`as£¹
(
lßdQueue
.
	`em±y
());

933 
	`as£¹
(
¡ÜesInFlight
 == 0);

934 
¡ÜeQueue
.
	`ş—r
();

935 
lßdQueue
.
	`ş—r
();

936 
lßds
 = 
¡Ües
 = 
¡ÜesToWB
 = 
¡ÜesInFlight
 = 0;

937 
	}
}

939 
	g‹m¶©e
 <
şass
 
	gIm¶
>

941 
	gOzÚeLWLSQ
<
	gIm¶
>::
	$keOv”From
(
Th»adCÚ‹xt
 *
Şd_tc
)

945 
¡®Ëd
 = 
çl£
;

946 
isLßdBlocked
 = 
çl£
;

947 
lßdBlockedHªdËd
 = 
çl£
;

948 
sw™chedOut
 = 
çl£
;

951 !
LQIndiûs
.
	`em±y
())

952 
LQIndiûs
.
	`pİ
();

953 !
SQIndiûs
.
	`em±y
())

954 
SQIndiûs
.
	`pİ
();

956 
i
 = 0; i < 
LQEÁr›s
 * 2; i++) {

957 
LQIndiûs
.
	`push
(
i
);

958 
SQIndiûs
.
	`push
(
i
);

961 
u£dPÜts
 = 0;

963 
lßdFauÉIn¡
 = 
¡ÜeFauÉIn¡
 = 
memD•ViŞ©Ü
 = 
NULL
;

965 
blockedLßdSeqNum
 = 0;

966 
	}
}

	@ozone/null_predictor.hh

31 #iâdeà
__CPU_OZONE_NULL_PREDICTOR_HH__


32 
	#__CPU_OZONE_NULL_PREDICTOR_HH__


	)

34 
	~"ba£/ty³s.hh
"

35 
	~"ıu/š¡_£q.hh
"

37 
	g‹m¶©e
 <
şass
 
	gIm¶
>

38 şas 
	cNuÎP»diùÜ


40 
	mpublic
:

41 
ty³Çme
 
	tIm¶
::
	tP¬ams
 Params;

42 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

44 
	$NuÎP»diùÜ
(
P¬ams
 *
p
) { }

46 
	sBP»dInfo
 {

47 
	`BP»dInfo
()

48 : 
	`PC
(0), 
	`ÃxtPC
(0)

51 
	`BP»dInfo
(cÚ¡ 
Addr
 &
pc
, cÚ¡ Add¸&
Ãxt_pc
)

52 : 
	`PC
(
pc
), 
	`ÃxtPC
(
Ãxt_pc
)

55 
Addr
 
PC
;

56 
Addr
 
ÃxtPC
;

57 
	}
};

59 
BP»dInfo
 
	$lookup
(
Addr
 &
PC
è{  
	`BP»dInfo
(PC, PC+4); 
	}
}

61 
	$undo
(
BP»dInfo
 &
bp_šfo
è{ ; 
	}
}

71 
boŞ
 
	$´ediù
(
DynIn¡PŒ
 &
š¡
, 
Addr
 &
PC
, 
Th»adID
 
tid
)

72 {  
çl£
; 
	}
}

80 
	$upd©e
(cÚ¡ 
In¡SeqNum
 &
dÚe_¢
, 
Th»adID
 
tid
è{ 
	}
}

88 
	$squash
(cÚ¡ 
In¡SeqNum
 &
squashed_¢
, 
Th»adID
 
tid
è{ 
	}
}

99 
	$squash
(cÚ¡ 
In¡SeqNum
 &
squashed_¢
, cÚ¡ 
Addr
 &
cÜr_rg‘
,

100 
boŞ
 
aùu®ly_k’
, 
Th»adID
 
tid
)

101 { 
	}
}

	@ozone/ozone_base_dyn_inst.cc

31 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

32 
	~"ıu/ba£_dyn_š¡_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gBa£DynIn¡
<
	gOzÚeIm¶
>;

37 
	g‹m¶©e
 <>

39 
	gBa£DynIn¡
<
	gOzÚeIm¶
>::
š¡couÁ
 = 0;

	@ozone/ozone_impl.hh

31 #iâdeà
__CPU_OZONE_OZONE_IMPL_HH__


32 
	#__CPU_OZONE_OZONE_IMPL_HH__


	)

34 
	~"ıu/o3/b´ed_un™.hh
"

35 
	~"ıu/ozÚe/dyn_š¡.hh
"

36 
	~"ıu/ozÚe/äÚt_’d.hh
"

37 
	~"ıu/ozÚe/š¡_queue.hh
"

38 
	~"ıu/ozÚe/lw_back_’d.hh
"

39 
	~"ıu/ozÚe/lw_lsq.hh
"

40 
	~"ıu/ozÚe/nuÎ_´ediùÜ.hh
"

41 
	~"ıu/ozÚe/sim¶e_·¿ms.hh
"

43 
	g‹m¶©e
 <
şass
 
	gIm¶
>

44 
şass
 
	gOzÚeCPU
;

46 
	g‹m¶©e
 <
şass
 
	gIm¶
>

47 
şass
 
	gOzÚeDynIn¡
;

49 
	sOzÚeIm¶
 {

50 
Sim¶eP¬ams
 
	tP¬ams
;

51 
	mOzÚeCPU
<
	tOzÚeIm¶
> 
	tOzÚeCPU
;

52 
OzÚeCPU
 
	tCPUTy³
;

56 
	mBP»dUn™
<
	tOzÚeIm¶
> 
	tB¿nchP»d
;

57 
	mFrÚtEnd
<
	tOzÚeIm¶
> 
	tFrÚtEnd
;

59 
	mLWBackEnd
<
	tOzÚeIm¶
> 
	tBackEnd
;

61 
	mIn¡Queue
<
	tOzÚeIm¶
> 
	tIn¡Queue
;

62 
	mOzÚeLWLSQ
<
	tOzÚeIm¶
> 
	tLd¡Queue
;

64 
	mOzÚeDynIn¡
<
	tOzÚeIm¶
> 
	tDynIn¡
;

65 
	mRefCouÁšgPŒ
<
	tDynIn¡
> 
	tDynIn¡PŒ
;

67 
ušt64_t
 
	tIssueSŒuù
;

70 
	mMaxTh»ads
 = 1

	@ozone/rename_table.cc

31 
	~"ıu/ozÚe/ozÚe_im¶.hh
"

32 
	~"ıu/ozÚe/»Çme_bË_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gR’ameTabË
<
	gOzÚeIm¶
>;

	@ozone/rename_table.hh

31 #iâdeà
__CPU_OZONE_RENAME_TABLE_HH__


32 
	#__CPU_OZONE_RENAME_TABLE_HH__


	)

34 
	~"¬ch/i§_Œa™s.hh
"

35 
	~"cÚfig/the_i§.hh
"

41 
	g‹m¶©e
 <
şass
 
	gIm¶
>

42 şas 
	cR’ameTabË
 {

43 
	mpublic
:

44 
ty³Çme
 
	tIm¶
::
	tDynIn¡PŒ
 DynInstPtr;

46 
R’ameTabË
();

48 
cİyFrom
(cÚ¡ 
R’ameTabË
<
Im¶
> &
bË_to_cİy
);

50 
	mDynIn¡PŒ
 &
	mİ”©Ü
 [] (
	mšdex
)

51 {  
	mbË
[
šdex
]; }

53 
DynIn¡PŒ
 
	gbË
[
TheISA
::
TÙ®NumRegs
];

	@ozone/rename_table_impl.hh

30 #iâdeà
__CPU_OZONE_RENAME_TABLE_IMPL_HH__


31 
	#__CPU_OZONE_RENAME_TABLE_IMPL_HH__


	)

33 
	~<c¡dlib
>

35 
	~"cÚfig/the_i§.hh
"

36 
	~"ıu/ozÚe/»Çme_bË.hh
"

38 
	g‹m¶©e
 <
şass
 
	gIm¶
>

39 
	gR’ameTabË
<
	gIm¶
>::
	$R’ameTabË
()

44 
i
 = 0; i < 
TheISA
::
TÙ®NumRegs
; ++i) {

45 
bË
[
i
] = 
NULL
;

47 
	}
}

49 
	g‹m¶©e
 <
şass
 
	gIm¶
>

51 
	gR’ameTabË
<
	gIm¶
>::
cİyFrom
(cÚ¡ 
R’ameTabË
<
Im¶
> &
bË_to_cİy
)

53 
i
 = 0; 
	gi
 < 
	gTheISA
::
TÙ®NumRegs
; ++i) {

54 
	gbË
[
i
] = 
bË_to_cİy
.
bË
[i];

	@ozone/simple_base_dyn_inst.cc

31 
	~"ıu/ozÚe/sim¶e_im¶.hh
"

32 
	~"ıu/ba£_dyn_š¡_im¶.hh
"

35 
‹m¶©e
 
şass
 
	gBa£DynIn¡
<
	gSim¶eIm¶
>;

37 
	g‹m¶©e
 <>

39 
	gBa£DynIn¡
<
	gSim¶eIm¶
>::
š¡couÁ
 = 0;

	@ozone/simple_cpu_builder.cc

31 
	~<¡ršg
>

33 
	~"ıu/check”/ıu.hh
"

34 
	~"ıu/ozÚe/ıu_im¶.hh
"

35 
	~"ıu/ozÚe/sim¶e_im¶.hh
"

36 
	~"ıu/ozÚe/sim¶e_·¿ms.hh
"

37 
	~"ıu/š¡_£q.hh
"

38 
	~"mem/ÿche/ba£.hh
"

39 
	~"sim/Sim¶eOzÚeCPU.hh
"

40 
	~"sim/´oûss.hh
"

41 
	~"sim/sim_objeù.hh
"

43 
‹m¶©e


44 
şass
 
	gOzÚeCPU
<
	gSim¶eIm¶
>;

46 
şass
 
	gSim¶eOzÚeCPU
 : 
public
 
OzÚeCPU
<
Sim¶eIm¶
>

48 
public
:

49 
Sim¶eOzÚeCPU
(
Sim¶eP¬ams
 *
p
)

50 : 
OzÚeCPU
<
Sim¶eIm¶
>(
p
)

58 
Sim¶eOzÚeCPU
 *

59 
	gSim¶eOzÚeCPUP¬ams
::
	$ü—‹
()

61 
Sim¶eOzÚeCPU
 *
ıu
;

63 ià(
FuÎSy¡em
) {

65 
Th»adID
 
aùu®_num_th»ads
 = 1;

69 
Th»adID
 
aùu®_num_th»ads
 =

70 
numTh»ads
.
	`isV®id
(è?‚umTh»ad : 
wÜklßd
.
	`size
();

72 ià(
wÜklßd
.
	`size
() == 0) {

73 
	`çl
("Must specify‡t†east one workload!");

77 
Sim¶eP¬ams
 *
·¿ms
 = 
Ãw
 SimpleParams;

79 
·¿ms
->
şock
 = clock;

81 
·¿ms
->
Çme
 =‚ame;

82 
·¿ms
->
numb”OfTh»ads
 = 
aùu®_num_th»ads
;

84 
·¿ms
->
™b
 = itb;

85 
·¿ms
->
dtb
 = dtb;

86 
·¿ms
->
i§
 = isa;

88 
·¿ms
->
sy¡em
 = system;

89 
·¿ms
->
ıu_id
 = cpu_id;

90 
·¿ms
->
wÜklßd
 = workload;

92 
·¿ms
->
mem
 = mem;

93 
·¿ms
->
check”
 = checker;

94 
·¿ms
->
max_š¡s_ªy_th»ad
 = max_insts_any_thread;

95 
·¿ms
->
max_š¡s_®l_th»ads
 = max_insts_all_threads;

96 
·¿ms
->
max_lßds_ªy_th»ad
 = max_loads_any_thread;

97 
·¿ms
->
max_lßds_®l_th»ads
 = max_loads_all_threads;

102 
·¿ms
->
iÿcheIÁ”çû
 = 
iÿche
 ? iÿche->
	`g‘IÁ”çû
(è: 
NULL
;

103 
·¿ms
->
dÿcheIÁ”çû
 = 
dÿche
 ? dÿche->
	`g‘IÁ”çû
(è: 
NULL
;

104 
·¿ms
->
ÿchePÜts
 = cachePorts;

106 
·¿ms
->
width
 = width;

107 
·¿ms
->
äÚtEndWidth
 = frontEndWidth;

108 
·¿ms
->
backEndWidth
 = backEndWidth;

109 
·¿ms
->
backEndSquashL©’cy
 = backEndSquashLatency;

110 
·¿ms
->
backEndL©’cy
 = backEndLatency;

111 
·¿ms
->
maxIn¡BufãrSize
 = maxInstBufferSize;

112 
·¿ms
->
numPhysiÿlRegs
 = 
numPhysIÁRegs
 + 
numPhysFlßtRegs
;

114 
·¿ms
->
decodeToF‘chD–ay
 = decodeToFetchDelay;

115 
·¿ms
->
»ÇmeToF‘chD–ay
 =„enameToFetchDelay;

116 
·¿ms
->
›wToF‘chD–ay
 = iewToFetchDelay;

117 
·¿ms
->
comm™ToF‘chD–ay
 = commitToFetchDelay;

118 
·¿ms
->
ãtchWidth
 = fetchWidth;

120 
·¿ms
->
»ÇmeToDecodeD–ay
 =„enameToDecodeDelay;

121 
·¿ms
->
›wToDecodeD–ay
 = iewToDecodeDelay;

122 
·¿ms
->
comm™ToDecodeD–ay
 = commitToDecodeDelay;

123 
·¿ms
->
ãtchToDecodeD–ay
 = fetchToDecodeDelay;

124 
·¿ms
->
decodeWidth
 = decodeWidth;

126 
·¿ms
->
›wToR’ameD–ay
 = iewToRenameDelay;

127 
·¿ms
->
comm™ToR’ameD–ay
 = commitToRenameDelay;

128 
·¿ms
->
decodeToR’ameD–ay
 = decodeToRenameDelay;

129 
·¿ms
->
»ÇmeWidth
 =„enameWidth;

131 
·¿ms
->
comm™ToIEWD–ay
 = commitToIEWDelay;

132 
·¿ms
->
»ÇmeToIEWD–ay
 =„enameToIEWDelay;

133 
·¿ms
->
issueToExecu‹D–ay
 = issueToExecuteDelay;

134 
·¿ms
->
issueWidth
 = issueWidth;

135 
·¿ms
->
execu‹Width
 =ƒxecuteWidth;

136 
·¿ms
->
execu‹IÁWidth
 =ƒxecuteIntWidth;

137 
·¿ms
->
execu‹FlßtWidth
 =ƒxecuteFloatWidth;

138 
·¿ms
->
execu‹B¿nchWidth
 =ƒxecuteBranchWidth;

139 
·¿ms
->
execu‹MemÜyWidth
 =ƒxecuteMemoryWidth;

141 
·¿ms
->
›wToComm™D–ay
 = iewToCommitDelay;

142 
·¿ms
->
»ÇmeToROBD–ay
 =„enameToROBDelay;

143 
·¿ms
->
comm™Width
 = commitWidth;

144 
·¿ms
->
squashWidth
 = squashWidth;

146 
·¿ms
->
´edTy³
 =…redType;

147 
·¿ms
->
loÿlP»diùÜSize
 =†ocalPredictorSize;

148 
·¿ms
->
loÿlCŒB™s
 =†ocalCtrBits;

149 
·¿ms
->
loÿlHi¡ÜyTabËSize
 =†ocalHistoryTableSize;

150 
·¿ms
->
loÿlHi¡ÜyB™s
 =†ocalHistoryBits;

151 
·¿ms
->
glob®P»diùÜSize
 = globalPredictorSize;

152 
·¿ms
->
glob®CŒB™s
 = globalCtrBits;

153 
·¿ms
->
glob®Hi¡ÜyB™s
 = globalHistoryBits;

154 
·¿ms
->
choiûP»diùÜSize
 = choicePredictorSize;

155 
·¿ms
->
choiûCŒB™s
 = choiceCtrBits;

157 
·¿ms
->
BTBEÁr›s
 = BTBEntries;

158 
·¿ms
->
BTBTagSize
 = BTBTagSize;

160 
·¿ms
->
RASSize
 = RASSize;

162 
·¿ms
->
LQEÁr›s
 = LQEntries;

163 
·¿ms
->
SQEÁr›s
 = SQEntries;

165 
·¿ms
->
SSITSize
 = SSITSize;

166 
·¿ms
->
LFSTSize
 = LFSTSize;

168 
·¿ms
->
numPhysIÁRegs
 =‚umPhysIntRegs;

169 
·¿ms
->
numPhysFlßtRegs
 =‚umPhysFloatRegs;

170 
·¿ms
->
numIQEÁr›s
 =‚umIQEntries;

171 
·¿ms
->
numROBEÁr›s
 =‚umROBEntries;

173 
·¿ms
->
decou¶edFrÚtEnd
 = decoupledFrontEnd;

174 
·¿ms
->
di¥©chWidth
 = dispatchWidth;

175 
·¿ms
->
wbWidth
 = wbWidth;

177 
·¿ms
->
smtNumF‘chšgTh»ads
 = smtNumFetchingThreads;

178 
·¿ms
->
smtF‘chPŞicy
 = smtFetchPolicy;

179 
·¿ms
->
smtIQPŞicy
 = smtIQPolicy;

180 
·¿ms
->
smtLSQPŞicy
 = smtLSQPolicy;

181 
·¿ms
->
smtLSQTh»shŞd
 = smtLSQThreshold;

182 
·¿ms
->
smtROBPŞicy
 = smtROBPolicy;

183 
·¿ms
->
smtROBTh»shŞd
 = smtROBThreshold;

184 
·¿ms
->
smtComm™PŞicy
 = smtCommitPolicy;

186 
·¿ms
->
š¡ShiáAmt
 = 2;

188 
·¿ms
->
sw™chedOut
 = 
sw™ched_out
;

190 
·¿ms
->
funùiÚT¿û
 = 
funùiÚ_Œaû
;

191 
·¿ms
->
funùiÚT¿ûS¹
 = 
funùiÚ_Œaû_¡¬t
;

193 
ıu
 = 
Ãw
 
	`Sim¶eOzÚeCPU
(
·¿ms
);

195  
ıu
;

196 
	}
}

	@ozone/simple_impl.hh

31 #iâdeà
__CPU_OZONE_SIMPLE_IMPL_HH__


32 
	#__CPU_OZONE_SIMPLE_IMPL_HH__


	)

34 
	~"ıu/o3/b´ed_un™.hh
"

35 
	~"ıu/ozÚe/ıu.hh
"

36 
	~"ıu/ozÚe/dyn_š¡.hh
"

37 
	~"ıu/ozÚe/äÚt_’d.hh
"

38 
	~"ıu/ozÚe/šÜd”_back_’d.hh
"

39 
	~"ıu/ozÚe/nuÎ_´ediùÜ.hh
"

40 
	~"ıu/ozÚe/sim¶e_·¿ms.hh
"

45 
	g‹m¶©e
 <
şass
 
	gIm¶
>

46 
şass
 
	gOzÚeDynIn¡
;

48 
	sSim¶eIm¶
 {

49 
Sim¶eP¬ams
 
	tP¬ams
;

50 
	mOzÚeCPU
<
	tSim¶eIm¶
> 
	tOzÚeCPU
;

51 
OzÚeCPU
 
	tFuÎCPU
;

55 
	mBP»dUn™
<
	tSim¶eIm¶
> 
	tB¿nchP»d
;

56 
	mFrÚtEnd
<
	tSim¶eIm¶
> 
	tFrÚtEnd
;

58 
	mInÜd”BackEnd
<
	tSim¶eIm¶
> 
	tBackEnd
;

60 
	mOzÚeDynIn¡
<
	tSim¶eIm¶
> 
	tDynIn¡
;

61 
	mRefCouÁšgPŒ
<
	tDynIn¡
> 
	tDynIn¡PŒ
;

63 
ušt64_t
 
	tIssueSŒuù
;

66 
	mMaxTh»ads
 = 1

	@ozone/simple_params.hh

31 #iâdeà
__CPU_OZONE_SIMPLE_PARAMS_HH__


32 
	#__CPU_OZONE_SIMPLE_PARAMS_HH__


	)

34 
	~"cÚfig/the_i§.hh
"

35 
	~"ıu/ozÚe/ıu.hh
"

38 
Çme¥aû
 
	gTheISA


40 
şass
 
	gTLB
;

42 
şass
 
	gFUPoŞ
;

43 
şass
 
	gMemObjeù
;

44 
şass
 
	gPageTabË
;

45 
şass
 
	gProûss
;

46 
şass
 
	gSy¡em
;

54 şas 
	cSim¶eP¬ams
 : 
public
 
Ba£CPU
::
P¬ams


56 
public
:

58 
TheISA
::
TLB
 *
™b
; 
	mTheISA
::TLB *
dtb
;

59 
	m¡d
::
veùÜ
<
Proûss
 *> 
wÜklßd
;

62 
PageTabË
 *
	mpTabË
;

70 
	mÿchePÜts
;

71 
	mwidth
;

72 
	mäÚtEndL©’cy
;

73 
	mäÚtEndWidth
;

74 
	mbackEndL©’cy
;

75 
	mbackEndWidth
;

76 
	mbackEndSquashL©’cy
;

77 
	mmaxIn¡BufãrSize
;

78 
	mnumPhysiÿlRegs
;

79 
	mmaxOut¡ªdšgMemOps
;

83 
	mdecodeToF‘chD–ay
;

84 
	m»ÇmeToF‘chD–ay
;

85 
	m›wToF‘chD–ay
;

86 
	mcomm™ToF‘chD–ay
;

87 
	mãtchWidth
;

92 
	m»ÇmeToDecodeD–ay
;

93 
	m›wToDecodeD–ay
;

94 
	mcomm™ToDecodeD–ay
;

95 
	mãtchToDecodeD–ay
;

96 
	mdecodeWidth
;

101 
	m›wToR’ameD–ay
;

102 
	mcomm™ToR’ameD–ay
;

103 
	mdecodeToR’ameD–ay
;

104 
	m»ÇmeWidth
;

109 
	mcomm™ToIEWD–ay
;

110 
	m»ÇmeToIEWD–ay
;

111 
	missueToExecu‹D–ay
;

112 
	missueWidth
;

113 
	mexecu‹Width
;

114 
	mexecu‹IÁWidth
;

115 
	mexecu‹FlßtWidth
;

116 
	mexecu‹B¿nchWidth
;

117 
	mexecu‹MemÜyWidth
;

118 
FUPoŞ
 *
	mfuPoŞ
;

123 
	m›wToComm™D–ay
;

124 
	m»ÇmeToROBD–ay
;

125 
	mcomm™Width
;

126 
	msquashWidth
;

131 
	m¡d
::
¡ršg
 
´edTy³
;

132 
	mloÿlP»diùÜSize
;

133 
	mloÿlCŒB™s
;

134 
	mloÿlHi¡ÜyTabËSize
;

135 
	mloÿlHi¡ÜyB™s
;

136 
	mglob®P»diùÜSize
;

137 
	mglob®CŒB™s
;

138 
	mglob®Hi¡ÜyB™s
;

139 
	mchoiûP»diùÜSize
;

140 
	mchoiûCŒB™s
;

142 
	mBTBEÁr›s
;

143 
	mBTBTagSize
;

145 
	mRASSize
;

150 
	mLQEÁr›s
;

151 
	mSQEÁr›s
;

152 
boŞ
 
	mlsqLim™s
;

157 
	mSSITSize
;

158 
	mLFSTSize
;

163 
	mnumPhysIÁRegs
;

164 
	mnumPhysFlßtRegs
;

165 
	mnumIQEÁr›s
;

166 
	mnumROBEÁr›s
;

168 
boŞ
 
	mdecou¶edFrÚtEnd
;

169 
	mdi¥©chWidth
;

170 
	mwbWidth
;

173 
	msmtNumF‘chšgTh»ads
;

175 
	m¡d
::
¡ršg
 
smtF‘chPŞicy
;

177 
	m¡d
::
¡ršg
 
smtIQPŞicy
;

178 
	msmtIQTh»shŞd
;

180 
	m¡d
::
¡ršg
 
smtLSQPŞicy
;

181 
	msmtLSQTh»shŞd
;

183 
	m¡d
::
¡ršg
 
smtComm™PŞicy
;

185 
	m¡d
::
¡ršg
 
smtROBPŞicy
;

186 
	msmtROBTh»shŞd
;

189 
	mš¡ShiáAmt
;

	@ozone/thread_state.hh

31 #iâdeà
__CPU_OZONE_THREAD_STATE_HH__


32 
	#__CPU_OZONE_THREAD_STATE_HH__


	)

34 
	~"¬ch/»gfe.hh
"

35 
	~"¬ch/ty³s.hh
"

36 
	~"ba£/ÿÎback.hh
"

37 
	~"ba£/ouut.hh
"

38 
	~"cÚfig/the_i§.hh
"

39 
	~"ıu/th»ad_cÚ‹xt.hh
"

40 
	~"ıu/th»ad_¡©e.hh
"

41 
	~"sim/çuÉs.hh
"

42 
	~"sim/´oûss.hh
"

43 
	~"sim/sim_ex™.hh
"

45 
şass
 
	gEv’t
;

48 
şass
 
	gEndQu›sûEv’t
;

49 
şass
 
	gFunùiÚ®MemÜy
;

50 
şass
 
	gFunùiÚProfe
;

51 
şass
 
	gProûss
;

52 
şass
 
	gProfeNode
;

60 
	g‹m¶©e
 <
şass
 
	gIm¶
>

61 
	gOzÚeTh»adS‹
 : 
public
 
Th»adS‹
 {

62 
ty³Çme
 
	tTh»adCÚ‹xt
::
	tStus
 Status;

63 
ty³Çme
 
	tIm¶
::
	tCPUTy³
 CPUType;

64 
	gTheISA
::
	tMiscReg
 MiscReg;

66 
OzÚeTh»adS‹
(
CPUTy³
 *
_ıu
, 
_th»ad_num
)

67 : 
Th»adS‹
(
_ıu
, -1, 
_th»ad_num
),

68 
šŒæag
(0), 
ıu
(
_ıu
), 
noSquashFromTC
(
çl£
), 
Œ­P’dšg
(false)

70 ià(
	gıu
->
	g·¿ms
->
	g´ofe
) {

71 
	g´ofe
 = 
Ãw
 
FunùiÚProfe
(
ıu
->
·¿ms
->
sy¡em
->
k”ÃlSymb
);

72 
C®lback
 *
	gcb
 =

73 
Ãw
 
MakeC®lback
<
OzÚeTh»adS‹
,

74 &
	gOzÚeTh»adS‹
::
dumpFuncProfe
>(
this
);

75 
»gi¡”Ex™C®lback
(
cb
);

80 
ProfeNode
 
	gdummyNode
;

81 
	g´ofeNode
 = &
dummyNode
;

82 
	g´ofePC
 = 3;

83 
	gmiscRegFe
.
ş—r
();

86 
OzÚeTh»adS‹
(
CPUTy³
 *
_ıu
, 
_th»ad_num
, 
Proûss
 *
_´oûss
)

87 : 
Th»adS‹
(
_ıu
, -1, 
_th»ad_num
, 
_´oûss
),

88 
ıu
(
_ıu
), 
noSquashFromTC
(
çl£
), 
Œ­P’dšg
(false)

90 
	gmiscRegFe
.
ş—r
();

93 
	gR’ameTabË
<
	gIm¶
> 
	g»ÇmeTabË
;

95 
Addr
 
	gPC
;

97 
Addr
 
	gÃxtPC
;

99 
	gTheISA
::
MiscRegFe
 
miscRegFe
;

101 
	gšŒæag
;

103 
ty³Çme
 
	gIm¶
::
CPUTy³
 *
ıu
;

105 
boŞ
 
	gnoSquashFromTC
;

107 
boŞ
 
	gŒ­P’dšg
;

109 
Th»adCÚ‹xt
 *
	gtc
;

111 
Th»adCÚ‹xt
 *
g‘TC
(è{  
	gtc
; }

113 
MiscReg
 
»adMiscRegNoEfãù
(
misc_»g
)

115  
	gmiscRegFe
.
»adRegNoEfãù
(
misc_»g
);

118 
MiscReg
 
»adMiscReg
(
misc_»g
)

120  
	gmiscRegFe
.
»adReg
(
misc_»g
, 
tc
);

123 
£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

125 
	gmiscRegFe
.
£tRegNoEfãù
(
misc_»g
, 
v®
);

128 
£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

130 
	gmiscRegFe
.
£tReg
(
misc_»g
, 
v®
, 
tc
);

133 
ušt64_t
 
»adPC
()

134 {  
	gPC
; }

136 
£tPC
(
ušt64_t
 
v®
)

137 { 
	gPC
 = 
v®
; }

139 
ušt64_t
 
»adNextPC
()

140 {  
	gÃxtPC
; }

142 
£tNextPC
(
ušt64_t
 
v®
)

143 { 
	gÃxtPC
 = 
v®
; }

145 
dumpFuncProfe
()

147 
	g¡d
::
o¡»am
 *
os
 = 
simout
.
ü—‹
(
c¥rštf
("´ofe.%s.d©", 
ıu
->
Çme
()));

148 
	g´ofe
->
dump
(
tc
, *
os
);

	@pc_event.cc

32 
	~<®gÜ™hm
>

33 
	~<¡ršg
>

34 
	~<ut™y
>

36 
	~"ba£/debug.hh
"

37 
	~"ba£/Œaû.hh
"

38 
	~"ıu/ba£.hh
"

39 
	~"ıu/pc_ev’t.hh
"

40 
	~"ıu/th»ad_cÚ‹xt.hh
"

41 
	~"debug/PCEv’t.hh
"

42 
	~"sim/cÜe.hh
"

43 
	~"sim/sy¡em.hh
"

45 
usšg
 
Çme¥aû
 
	g¡d
;

47 
	gPCEv’tQueue
::
	$PCEv’tQueue
()

48 {
	}
}

50 
PCEv’tQueue
::~
	$PCEv’tQueue
()

51 {
	}
}

53 
boŞ


54 
PCEv’tQueue
::
	$»move
(
PCEv’t
 *
ev’t
)

56 
»moved
 = 0;

57 
¿nge_t
 
¿nge
 = 
	`equ®_¿nge
(
ev’t
);

58 
™”©Ü
 
i
 = 
¿nge
.
fœ¡
;

59 
i
 !ğ
¿nge
.
£cÚd
 &&

60 
i
 !ğ
pc_m­
.
	`’d
()) {

61 ià(*
i
 =ğ
ev’t
) {

62 
	`DPRINTF
(
PCEv’t
, "PC basedƒvent„emoved‡t %#x: %s\n",

63 
ev’t
->
	`pc
(),ƒv’t->
	`desü
());

64 
i
 = 
pc_m­
.
	`”a£
(i);

65 ++
»moved
;

67 
i
++;

72  
»moved
 > 0;

73 
	}
}

75 
boŞ


76 
	gPCEv’tQueue
::
	$scheduË
(
PCEv’t
 *
ev’t
)

78 
pc_m­
.
	`push_back
(
ev’t
);

79 
	`sÜt
(
pc_m­
.
	`begš
(),…c_m­.
	`’d
(), 
	`M­Com·»
());

81 
	`DPRINTF
(
PCEv’t
, "PC basedƒvent scheduled for %#x: %s\n",

82 
ev’t
->
	`pc
(),ƒv’t->
	`desü
());

84  
Œue
;

85 
	}
}

87 
boŞ


88 
	gPCEv’tQueue
::
	$doS”viû
(
Th»adCÚ‹xt
 *
tc
)

92 
Addr
 
pc
 = 
tc
->
	`š¡Addr
();

93 
£rviûd
 = 0;

94 
¿nge_t
 
¿nge
 = 
	`equ®_¿nge
(
pc
);

95 
™”©Ü
 
i
 = 
¿nge
.
fœ¡
; i !ğ¿nge.
£cÚd
; ++i) {

100 ià(
pc
 !ğ
tc
->
	`š¡Addr
())

103 
	`DPRINTF
(
PCEv’t
, "PC basedƒvent serviced‡t %#x: %s\n",

104 (*
i
)->
	`pc
(), (*i)->
	`desü
());

106 (*
i
)->
	`´oûss
(
tc
);

107 ++
£rviûd
;

110  
£rviûd
 > 0;

111 
	}
}

114 
	gPCEv’tQueue
::
	$dump
() const

116 
cÚ¡_™”©Ü
 
i
 = 
pc_m­
.
	`begš
();

117 
cÚ¡_™”©Ü
 
e
 = 
pc_m­
.
	`’d
();

119 ; 
i
 !ğ
e
; ++i)

120 
	`ırštf
("%d:ƒv’ˆ© %#x: %s\n", 
	`curTick
(), (*
i
)->
	`pc
(),

121 (*
i
)->
	`desü
());

122 
	}
}

124 
	gPCEv’tQueue
::
¿nge_t


125 
PCEv’tQueue
::
	$equ®_¿nge
(
Addr
 
pc
)

127  
¡d
::
	`equ®_¿nge
(
pc_m­
.
	`begš
(),…c_m­.
	`’d
(), 
pc
, 
	`M­Com·»
());

128 
	}
}

130 
	gB»akPCEv’t
::
B»akPCEv’t
(
PCEv’tQueue
 *
q
, cÚ¡ 
¡d
::
¡ršg
 &
desc
, 
Addr
 
addr
,

131 
boŞ
 
d–
)

132 : 
PCEv’t
(
q
, 
desc
, 
addr
), 
	$»move
(
d–
)

134 
	}
}

137 
	gB»akPCEv’t
::
	$´oûss
(
Th»adCÚ‹xt
 *
tc
)

139 
SŒšgW¿p
 
	`Çme
(
tc
->
	`g‘CpuPŒ
()->name() + ".break_event");

140 
	`DPRINTFN
("b»akƒv’ˆ% Œigg”ed\n", 
	`desü
());

141 
Debug
::
	`b»akpošt
();

142 ià(
»move
)

143 
d–‘e
 
this
;

144 
	}
}

147 
	$sched_b»ak_pc_sys
(
Sy¡em
 *
sys
, 
Addr
 
addr
)

149 
Ãw
 
	`B»akPCEv’t
(&
sys
->
pcEv’tQueue
, "debug b»ak", 
addr
, 
Œue
);

150 
	}
}

153 
	$sched_b»ak_pc
(
Addr
 
addr
)

155 
veùÜ
<
Sy¡em
 *>::
™”©Ü
 
sysi
 = Sy¡em::
sy¡emLi¡
.
	`begš
();

156 
sysi
 !ğ
Sy¡em
::
sy¡emLi¡
.
	`’d
(); ++sysi) {

157 
	`sched_b»ak_pc_sys
(*
sysi
, 
addr
);

160 
	}
}

162 
	gPªicPCEv’t
::
PªicPCEv’t
(
PCEv’tQueue
 *
q
, cÚ¡ 
¡d
::
¡ršg
 &
desc
, 
Addr
 
pc
)

163 : 
	$PCEv’t
(
q
, 
desc
, 
pc
)

165 
	}
}

168 
	gPªicPCEv’t
::
	$´oûss
(
Th»adCÚ‹xt
 *
tc
)

170 
SŒšgW¿p
 
	`Çme
(
tc
->
	`g‘CpuPŒ
()->name() + ".panic_event");

171 
	`·nic
(
	`desü
());

172 
	}
}

	@pc_event.hh

32 #iâdeà
__PC_EVENT_HH__


33 
	#__PC_EVENT_HH__


	)

35 
	~<veùÜ
>

37 
	~"ba£/misc.hh
"

38 
	~"ba£/ty³s.hh
"

40 
şass
 
	gTh»adCÚ‹xt
;

41 
şass
 
	gPCEv’tQueue
;

42 
şass
 
	gSy¡em
;

44 şas 
	cPCEv’t


46 
	m´Ùeùed
:

47 
¡d
::
¡ršg
 
desütiÚ
;

48 
PCEv’tQueue
 *
	mqueue
;

49 
Addr
 
	mevpc
;

51 
	mpublic
:

52 
PCEv’t
(
PCEv’tQueue
 *
q
, cÚ¡ 
¡d
::
¡ršg
 &
desc
, 
Addr
 
pc
);

54 
	mvœtu®
 ~
	$PCEv’t
(è{ ià(
queue
è
	`»move
(); }

57 
vœtu®
 cÚ¡ 
¡d
::
¡ršg
 
	$Çme
(ècÚ¡ {  
desütiÚ
; 
	}
}

59 
	g¡d
::
¡ršg
 
	$desü
(ècÚ¡ {  
desütiÚ
; 
	}
}

60 
Addr
 
	$pc
(ècÚ¡ {  
evpc
; 
	}
}

62 
boŞ
 
»move
();

63 
vœtu®
 
´oûss
(
Th»adCÚ‹xt
 *
tc
) = 0;

66 şas 
	cPCEv’tQueue


68 
	m´Ùeùed
:

69 
PCEv’t
 * 
	t»cÜd_t
;

70 şas 
	cM­Com·»
 {

71 
	mpublic
:

72 
boŞ
 
İ”©Ü
()(cÚ¡ 
»cÜd_t
 &
l
, cÚ¡ 
	m»cÜd_t
 &
	mr
) const {

73  
	ml
->
pc
(è< 
	mr
->pc();

75 
boŞ
 
İ”©Ü
()(cÚ¡ 
	m»cÜd_t
 &
	ml
, 
Addr
 
	mpc
) const {

76  
	ml
->
pc
(è< 
	mpc
;

78 
boŞ
 
İ”©Ü
()(
Addr
 
	mpc
, cÚ¡ 
	m»cÜd_t
 &
	mr
) const {

79  
	mpc
 < 
	mr
->
pc
();

82 
	g¡d
::
	tveùÜ
<
	t»cÜd_t
> 
	tm­_t
;

84 
	gpublic
:

85 
m­_t
::
	t™”©Ü
 iterator;

86 
	gm­_t
::
	tcÚ¡_™”©Ü
 const_iterator;

88 
	g´Ùeùed
:

89 
¡d
::
	t·œ
<
	t™”©Ü
, i‹¿tÜ> 
	t¿nge_t
;

90 
	g¡d
::
	t·œ
<
	tcÚ¡_™”©Ü
, cÚ¡_™”©Ü> 
	tcÚ¡_¿nge_t
;

92 
	g´Ùeùed
:

93 
m­_t
 
pc_m­
;

95 
boŞ
 
doS”viû
(
Th»adCÚ‹xt
 *
tc
);

97 
	gpublic
:

98 
PCEv’tQueue
();

99 ~
PCEv’tQueue
();

101 
boŞ
 
»move
(
PCEv’t
 *
ev’t
);

102 
boŞ
 
scheduË
(
PCEv’t
 *
ev’t
);

103 
boŞ
 
	$£rviû
(
Th»adCÚ‹xt
 *
tc
)

105 ià(
pc_m­
.
	`em±y
())

106  
çl£
;

108  
	`doS”viû
(
tc
);

109 
	}
}

111 
¿nge_t
 
equ®_¿nge
(
Addr
 
pc
);

112 
¿nge_t
 
	$equ®_¿nge
(
PCEv’t
 *
ev’t
è{  
	`equ®_¿nge
Óv’t->
	`pc
()); 
	}
}

114 
	$dump
() const;

115 
	}
};

118 
šlše


119 
	gPCEv’t
::
PCEv’t
(
PCEv’tQueue
 *
q
, cÚ¡ 
¡d
::
¡ršg
 &
desc
, 
Addr
 
pc
)

120 : 
desütiÚ
(
desc
), 
queue
(
q
), 
	$evpc
(
pc
)

122 
queue
->
	`scheduË
(
this
);

123 
	}
}

125 
šlše
 
boŞ


126 
	gPCEv’t
::
	$»move
()

128 ià(!
queue
)

129 
	`·nic
("cannot„emove‡n uninitializedƒvent;");

131  
queue
->
	`»move
(
this
);

132 
	}
}

134 şas 
	cB»akPCEv’t
 : 
public
 
PCEv’t


136 
´Ùeùed
:

137 
boŞ
 
»move
;

139 
	mpublic
:

140 
B»akPCEv’t
(
PCEv’tQueue
 *
q
, cÚ¡ 
¡d
::
¡ršg
 &
desc
, 
Addr
 
addr
,

141 
boŞ
 
d–
 = 
çl£
);

142 
vœtu®
 
´oûss
(
Th»adCÚ‹xt
 *
tc
);

145 
sched_b»ak_pc_sys
(
Sy¡em
 *
sys
, 
Addr
 
addr
);

147 
sched_b»ak_pc
(
Addr
 
addr
);

149 şas 
	cPªicPCEv’t
 : 
public
 
PCEv’t


151 
public
:

152 
PªicPCEv’t
(
PCEv’tQueue
 *
q
, cÚ¡ 
¡d
::
¡ršg
 &
desc
, 
Addr
 
pc
);

153 
vœtu®
 
´oûss
(
Th»adCÚ‹xt
 *
tc
);

	@pred/2bit_local.cc

31 
	~"ba£/štm©h.hh
"

32 
	~"ba£/misc.hh
"

33 
	~"ba£/Œaû.hh
"

34 
	~"ıu/´ed/2b™_loÿl.hh
"

35 
	~"debug/F‘ch.hh
"

37 
	gLoÿlBP
::
	$LoÿlBP
(cÚ¡ 
P¬ams
 *
·¿ms
)

38 : 
	`BP»dUn™
(
·¿ms
),

39 
	`loÿlP»diùÜSize
(
·¿ms
->
loÿlP»diùÜSize
),

40 
	`loÿlCŒB™s
(
·¿ms
->
loÿlCŒB™s
),

41 
	`š¡ShiáAmt
(
·¿ms
->
š¡ShiáAmt
)

43 ià(!
	`isPow”Of2
(
loÿlP»diùÜSize
)) {

44 
	`çl
("Invalid†ocal…redictor size!\n");

47 
loÿlP»diùÜS‘s
 = 
loÿlP»diùÜSize
 / 
loÿlCŒB™s
;

49 ià(!
	`isPow”Of2
(
loÿlP»diùÜS‘s
)) {

50 
	`çl
("Invalid‚umber of†ocal…redictor sets! Check†ocalCtrBits.\n");

54 
šdexMask
 = 
loÿlP»diùÜS‘s
 - 1;

56 
	`DPRINTF
(
F‘ch
, "šdex mask: %#x\n", 
šdexMask
);

59 
loÿlCŒs
.
	`»size
(
loÿlP»diùÜS‘s
);

61 
i
 = 0; i < 
loÿlP»diùÜS‘s
; ++i)

62 
loÿlCŒs
[
i
].
	`£tB™s
(
loÿlCŒB™s
);

64 
	`DPRINTF
(
F‘ch
, "local…redictor size: %i\n",

65 
loÿlP»diùÜSize
);

67 
	`DPRINTF
(
F‘ch
, "loÿÈcouÁ” b™s: %i\n", 
loÿlCŒB™s
);

69 
	`DPRINTF
(
F‘ch
, "instruction shift‡mount: %i\n",

70 
š¡ShiáAmt
);

71 
	}
}

74 
	gLoÿlBP
::
	$»£t
()

76 
i
 = 0; i < 
loÿlP»diùÜS‘s
; ++i) {

77 
loÿlCŒs
[
i
].
	`»£t
();

79 
	}
}

82 
	gLoÿlBP
::
	$btbUpd©e
(
Addr
 
b¿nch_addr
, * &
bp_hi¡Üy
)

86 
	}
}

89 
boŞ


90 
	gLoÿlBP
::
	$lookup
(
Addr
 
b¿nch_addr
, * &
bp_hi¡Üy
)

92 
boŞ
 
k’
;

93 
ušt8_t
 
couÁ”_v®
;

94 
loÿl_´ediùÜ_idx
 = 
	`g‘LoÿlIndex
(
b¿nch_addr
);

96 
	`DPRINTF
(
F‘ch
, "Looking up index %#x\n",

97 
loÿl_´ediùÜ_idx
);

99 
couÁ”_v®
 = 
loÿlCŒs
[
loÿl_´ediùÜ_idx
].
	`»ad
();

101 
	`DPRINTF
(
F‘ch
, "prediction is %i.\n",

102 ()
couÁ”_v®
);

104 
k’
 = 
	`g‘P»diùiÚ
(
couÁ”_v®
);

108 ià(
k’
) {

109 
	`DPRINTF
(
F‘ch
, "Branch updated‡saken.\n");

110 
loÿlCŒs
[
loÿl_´ediùÜ_idx
].
	`šüem’t
();

112 
	`DPRINTF
(
F‘ch
, "Branch updated‡s‚otaken.\n");

113 
loÿlCŒs
[
loÿl_´ediùÜ_idx
].
	`deüem’t
();

117  
k’
;

118 
	}
}

121 
	gLoÿlBP
::
	$upd©e
(
Addr
 
b¿nch_addr
, 
boŞ
 
k’
, *
bp_hi¡Üy
, boŞ 
squashed
)

123 
	`as£¹
(
bp_hi¡Üy
 =ğ
NULL
);

124 
loÿl_´ediùÜ_idx
;

127 
loÿl_´ediùÜ_idx
 = 
	`g‘LoÿlIndex
(
b¿nch_addr
);

129 
	`DPRINTF
(
F‘ch
, "Lookšg u°šdex %#x\n", 
loÿl_´ediùÜ_idx
);

131 ià(
k’
) {

132 
	`DPRINTF
(
F‘ch
, "Branch updated‡saken.\n");

133 
loÿlCŒs
[
loÿl_´ediùÜ_idx
].
	`šüem’t
();

135 
	`DPRINTF
(
F‘ch
, "Branch updated‡s‚otaken.\n");

136 
loÿlCŒs
[
loÿl_´ediùÜ_idx
].
	`deüem’t
();

138 
	}
}

140 
šlše


141 
boŞ


142 
	gLoÿlBP
::
	$g‘P»diùiÚ
(
ušt8_t
 &
couÁ
)

145  (
couÁ
 >> (
loÿlCŒB™s
 - 1));

146 
	}
}

148 
šlše


150 
	gLoÿlBP
::
	$g‘LoÿlIndex
(
Addr
 &
b¿nch_addr
)

152  (
b¿nch_addr
 >> 
š¡ShiáAmt
è& 
šdexMask
;

153 
	}
}

156 
	gLoÿlBP
::
	$uncÚdB¿nch
(*&
bp_hi¡Üy
)

158 
	}
}

	@pred/2bit_local.hh

44 #iâdeà
__CPU_PRED_2BIT_LOCAL_PRED_HH__


45 
	#__CPU_PRED_2BIT_LOCAL_PRED_HH__


	)

47 
	~<veùÜ
>

49 
	~"ba£/ty³s.hh
"

50 
	~"ıu/´ed/b´ed_un™.hh
"

51 
	~"ıu/´ed/§t_couÁ”.hh
"

60 şas 
	cLoÿlBP
 : 
public
 
BP»dUn™


62 
public
:

66 
LoÿlBP
(cÚ¡ 
P¬ams
 *
·¿ms
);

68 
vœtu®
 
uncÚdB¿nch
(* &
bp_hi¡Üy
);

77 
boŞ
 
lookup
(
Addr
 
b¿nch_addr
, * &
bp_hi¡Üy
);

86 
btbUpd©e
(
Addr
 
b¿nch_addr
, * &
bp_hi¡Üy
);

93 
upd©e
(
Addr
 
b¿nch_addr
, 
boŞ
 
k’
, *
bp_hi¡Üy
, boŞ 
squashed
);

95 
	$squash
(*
bp_hi¡Üy
)

96 { 
	`as£¹
(
bp_hi¡Üy
 =ğ
NULL
); }

98 
	`»£t
();

100 
´iv©e
:

107 
šlše
 
boŞ
 
	`g‘P»diùiÚ
(
ušt8_t
 &
couÁ
);

110 
šlše
 
	`g‘LoÿlIndex
(
Addr
 &
PC
);

113 
¡d
::
veùÜ
<
S©CouÁ”
> 
loÿlCŒs
;

116 
loÿlP»diùÜSize
;

119 
loÿlP»diùÜS‘s
;

122 
loÿlCŒB™s
;

125 
š¡ShiáAmt
;

128 
šdexMask
;

129 
	}
};

	@pred/bpred_unit.cc

34 
	~"ıu/´ed/2b™_loÿl.hh
"

35 
	~"ıu/´ed/b´ed_un™_im¶.hh
"

36 
	~"ıu/´ed/touºam’t.hh
"

38 
BP»dUn™
 *

39 
	gB¿nchP»diùÜP¬ams
::
	$ü—‹
()

42 ià(
´edTy³
 == "local") {

43  
Ãw
 
	`LoÿlBP
(
this
);

44 } ià(
´edTy³
 == "tournament") {

45  
Ãw
 
	`Touºam’tBP
(
this
);

47 
	`çl
("Invalid BP selected!");

49 
	}
}

	@pred/bpred_unit.hh

47 #iâdeà
__CPU_PRED_BPRED_UNIT_HH__


48 
	#__CPU_PRED_BPRED_UNIT_HH__


	)

50 
	~<li¡
>

52 
	~"ba£/¡©i¡ics.hh
"

53 
	~"ba£/ty³s.hh
"

54 
	~"ıu/´ed/btb.hh
"

55 
	~"ıu/´ed/¿s.hh
"

56 
	~"ıu/š¡_£q.hh
"

57 
	~"ıu/¡©ic_š¡.hh
"

58 
	~"·¿ms/B¿nchP»diùÜ.hh
"

59 
	~"sim/sim_objeù.hh
"

65 şas 
	cBP»dUn™
 : 
public
 
SimObjeù


67 
public
:

68 
B¿nchP»diùÜP¬ams
 
	tP¬ams
;

72 
BP»dUn™
(cÚ¡ 
P¬ams
 *
p
);

77 
»gSts
();

80 
	$d¿šSª™yCheck
() const;

90 
boŞ
 
	`´ediù
(
SticIn¡PŒ
 &
š¡
, cÚ¡ 
In¡SeqNum
 &
£qNum
,

91 
TheISA
::
PCS‹
 &
pc
, 
Th»adID
 
tid
);

92 
boŞ
 
	`´ediùInOrd”
(
SticIn¡PŒ
 &
š¡
, cÚ¡ 
In¡SeqNum
 &
£qNum
,

93 
asid
, 
TheISA
::
PCS‹
 &
š¡PC
, TheISA::PCS‹ &
´edPC
,

94 
Th»adID
 
tid
);

97 
vœtu®
 
	`uncÚdB¿nch
(* &
bp_hi¡Üy
) = 0;

105 
	`upd©e
(cÚ¡ 
In¡SeqNum
 &
dÚe_¢
, 
Th»adID
 
tid
);

113 
	`squash
(cÚ¡ 
In¡SeqNum
 &
squashed_¢
, 
Th»adID
 
tid
);

124 
	`squash
(cÚ¡ 
In¡SeqNum
 &
squashed_¢
,

125 cÚ¡ 
TheISA
::
PCS‹
 &
cÜr_rg‘
,

126 
boŞ
 
aùu®ly_k’
, 
Th»adID
 
tid
);

132 
vœtu®
 
	`squash
(*
bp_hi¡Üy
) = 0;

141 
vœtu®
 
boŞ
 
	`lookup
(
Addr
 
š¡PC
, * &
bp_hi¡Üy
) = 0;

151 
vœtu®
 
	`btbUpd©e
(
Addr
 
š¡PC
, * &
bp_hi¡Üy
) = 0;

158 
boŞ
 
	$BTBV®id
(
Addr
 
š¡PC
)

159 {  
BTB
.
	`v®id
(
š¡PC
, 0); }

166 
TheISA
::
PCS‹
 
	$BTBLookup
(
Addr
 
š¡PC
)

167 {  
BTB
.
	`lookup
(
š¡PC
, 0); 
	}
}

179 
vœtu®
 
upd©e
(
Addr
 
š¡PC
, 
boŞ
 
k’
, *
bp_hi¡Üy
,

180 
boŞ
 
squashed
) = 0;

187 
BTBUpd©e
(
Addr
 
š¡PC
, cÚ¡ 
TheISA
::
PCS‹
 &
rg‘
)

188 { 
BTB
.
upd©e
(
š¡PC
, 
rg‘
, 0); }

190 
dump
();

192 
	g´iv©e
:

193 
	sP»diùÜHi¡Üy
 {

198 
P»diùÜHi¡Üy
(cÚ¡ 
In¡SeqNum
 &
£q_num
, 
Addr
 
š¡PC
,

199 
boŞ
 
´ed_k’
, *
bp_hi¡Üy
,

200 
Th»adID
 
_tid
)

201 : 
£qNum
(
£q_num
), 
pc
(
š¡PC
), 
bpHi¡Üy
(
bp_hi¡Üy
), 
RAST¬g‘
(0),

202 
RASIndex
(0), 
tid
(
_tid
), 
´edTak’
(
´ed_k’
), 
u£dRAS
(0), 
pushedRAS
(0),

203 
wasC®l
(0), 
wasR‘uº
(0)

206 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
P»diùÜHi¡Üy
 &
’Œy
) const {

207  
this
->
£qNum
 =ğ
’Œy
.seqNum;

211 
In¡SeqNum
 
	g£qNum
;

214 
Addr
 
	gpc
;

220 *
	gbpHi¡Üy
;

223 
	gTheISA
::
PCS‹
 
RAST¬g‘
;

226 
	gRASIndex
;

229 
Th»adID
 
	gtid
;

232 
boŞ
 
	g´edTak’
;

235 
boŞ
 
	gu£dRAS
;

238 
boŞ
 
	gpushedRAS
;

241 
boŞ
 
	gwasC®l
;

244 
boŞ
 
	gwasR‘uº
;

247 
	g¡d
::
	tli¡
<
	tP»diùÜHi¡Üy
> 
	tHi¡Üy
;

248 
	gHi¡Üy
::
	t™”©Ü
 
	tHi¡ÜyIt
;

251 
ušt32_t
 
	gnumTh»ads
;

258 
Hi¡Üy
 *
	g´edHi¡
;

261 
DeçuÉBTB
 
	gBTB
;

264 
R‘uºAddrSck
 *
	gRAS
;

267 
	gSts
::
SÿÏr
 
lookups
;

269 
	gSts
::
SÿÏr
 
cÚdP»diùed
;

271 
	gSts
::
SÿÏr
 
cÚdIncÜ»ù
;

273 
	gSts
::
SÿÏr
 
BTBLookups
;

275 
	gSts
::
SÿÏr
 
BTBH™s
;

277 
	gSts
::
SÿÏr
 
BTBCÜ»ù
;

279 
	gSts
::
FÜmuÏ
 
BTBH™Pù
;

281 
	gSts
::
SÿÏr
 
u£dRAS
;

283 
	gSts
::
SÿÏr
 
RASIncÜ»ù
;

	@pred/bpred_unit_impl.hh

45 #iâdeà
__CPU_PRED_BPRED_UNIT_IMPL_HH__


46 
	#__CPU_PRED_BPRED_UNIT_IMPL_HH__


	)

48 
	~<®gÜ™hm
>

50 
	~"¬ch/i§_Œa™s.hh
"

51 
	~"¬ch/ty³s.hh
"

52 
	~"¬ch/ut™y.hh
"

53 
	~"ba£/Œaû.hh
"

54 
	~"cÚfig/the_i§.hh
"

55 
	~"ıu/´ed/b´ed_un™.hh
"

56 
	~"debug/B¿nch.hh
"

58 
	gBP»dUn™
::
	$BP»dUn™
(cÚ¡ 
P¬ams
 *
·¿ms
)

59 : 
	`SimObjeù
(
·¿ms
),

60 
	`BTB
(
·¿ms
->
BTBEÁr›s
,

61 
·¿ms
->
BTBTagSize
,

62 
·¿ms
->
š¡ShiáAmt
)

64 
numTh»ads
 = 
·¿ms
->numThreads;

66 
´edHi¡
 = 
Ãw
 
Hi¡Üy
[
numTh»ads
];

68 
RAS
 = 
Ãw
 
R‘uºAddrSck
[
numTh»ads
];

69 
i
=0; i < 
numTh»ads
; i++)

70 
RAS
[
i
].
	`š™
(
·¿ms
->
RASSize
);

71 
	}
}

74 
	gBP»dUn™
::
	$»gSts
()

76 
lookups


77 .
	`Çme
(name() + ".lookups")

78 .
	`desc
("Number of BP†ookups")

81 
cÚdP»diùed


82 .
	`Çme
(name() + ".condPredicted")

83 .
	`desc
("Number of conditional branches…redicted")

86 
cÚdIncÜ»ù


87 .
	`Çme
(name() + ".condIncorrect")

88 .
	`desc
("Number of conditional branches incorrect")

91 
BTBLookups


92 .
	`Çme
(name() + ".BTBLookups")

93 .
	`desc
("Number of BTB†ookups")

96 
BTBH™s


97 .
	`Çme
(name() + ".BTBHits")

98 .
	`desc
("Number of BTB hits")

101 
BTBCÜ»ù


102 .
	`Çme
(name() + ".BTBCorrect")

103 .
	`desc
("Number of correct BTB…redictions (this stat may‚ot "

107 
BTBH™Pù


108 .
	`Çme
(name() + ".BTBHitPct")

109 .
	`desc
("BTB Hit Percentage")

110 .
	`´ecisiÚ
(6);

111 
BTBH™Pù
 = (
BTBH™s
 / 
BTBLookups
) * 100;

113 
u£dRAS


114 .
	`Çme
(name() + ".usedRAS")

115 .
	`desc
("Number ofimeshe RAS was usedo get‡arget.")

118 
RASIncÜ»ù


119 .
	`Çme
(name() + ".RASInCorrect")

120 .
	`desc
("Number of incorrect RAS…redictions.")

122 
	}
}

125 
	gBP»dUn™
::
	$d¿šSª™yCheck
() const

129 
i
 = 0; i < 
numTh»ads
; ++i)

130 
	`as£¹
(
´edHi¡
[
i
].
	`em±y
());

131 
	}
}

133 
boŞ


134 
	gBP»dUn™
::
´ediù
(
SticIn¡PŒ
 &
š¡
, cÚ¡ 
In¡SeqNum
 &
£qNum
,

135 
TheISA
::
PCS‹
 &
pc
, 
Th»adID
 
tid
)

142 
boŞ
 
	g´ed_k’
 = 
çl£
;

143 
	gTheISA
::
PCS‹
 
rg‘
 = 
pc
;

145 ++
	glookups
;

147 *
	gbp_hi¡Üy
 = 
NULL
;

149 ià(
	gš¡
->
isUncÚdCŒl
()) {

150 
DPRINTF
(
B¿nch
, "[tid:%i]: UncÚd™iÚ® cÚŒŞ.\n", 
tid
);

151 
	g´ed_k’
 = 
Œue
;

153 
uncÚdB¿nch
(
bp_hi¡Üy
);

155 ++
	gcÚdP»diùed
;

156 
	g´ed_k’
 = 
lookup
(
pc
.
š¡Addr
(), 
bp_hi¡Üy
);

158 
DPRINTF
(
B¿nch
, "[tid:%i]: [sn:%i] Branch…redictor"

159 "…»diùed %˜fÜ PC %s\n", 
tid
, 
£qNum
, 
´ed_k’
, 
pc
);

162 
DPRINTF
(
B¿nch
, "[tid:%i]: [sn:%i] Creating…rediction history "

163 "fÜ PC %s\n", 
tid
, 
£qNum
, 
pc
);

165 
P»diùÜHi¡Üy
 
´ediù_»cÜd
(
£qNum
, 
pc
.
š¡Addr
(),

166 
´ed_k’
, 
bp_hi¡Üy
, 
tid
);

169 ià(
	g´ed_k’
) {

170 ià(
	gš¡
->
isR‘uº
()) {

171 ++
	gu£dRAS
;

172 
	g´ediù_»cÜd
.
	gwasR‘uº
 = 
Œue
;

175 
	gTheISA
::
PCS‹
 
¿sTİ
 = 
RAS
[
tid
].
tİ
();

176 
	grg‘
 = 
TheISA
::
budR‘PC
(
pc
, 
¿sTİ
);

179 
	g´ediù_»cÜd
.
	gu£dRAS
 = 
Œue
;

180 
	g´ediù_»cÜd
.
	gRASIndex
 = 
RAS
[
tid
].
tİIdx
();

181 
	g´ediù_»cÜd
.
	gRAST¬g‘
 = 
¿sTİ
;

183 
	gRAS
[
tid
].
pİ
();

185 
DPRINTF
(
B¿nch
, "[tid:%i]: Instruction %s is‡„eturn, "

187 
tid
, 
pc
, 
rg‘
, 
´ediù_»cÜd
.
RASIndex
);

189 ++
	gBTBLookups
;

191 ià(
	gš¡
->
isC®l
()) {

192 
	gRAS
[
tid
].
push
(
pc
);

193 
	g´ediù_»cÜd
.
	gpushedRAS
 = 
Œue
;

197 
	g´ediù_»cÜd
.
	gwasC®l
 = 
Œue
;

199 
DPRINTF
(
B¿nch
, "[tid:%i]: Instruction %s was‡ "

201 
tid
, 
pc
,…c, 
RAS
[tid].
tİIdx
());

204 ià(
	gBTB
.
v®id
(
pc
.
š¡Addr
(), 
tid
)) {

205 ++
	gBTBH™s
;

208 
	grg‘
 = 
BTB
.
lookup
(
pc
.
š¡Addr
(), 
tid
);

210 
DPRINTF
(
B¿nch
, "[tid:%i]: Instruction %s…redicted"

211 "¬g‘ i %s.\n", 
tid
, 
pc
, 
rg‘
);

214 
DPRINTF
(
B¿nch
, "[tid:%i]: BTB doesn't have‡ "

215 "v®idƒÁry.\n",
tid
);

216 
	g´ed_k’
 = 
çl£
;

220 ià(!
	gš¡
->
isC®l
(è&& !š¡->
isR‘uº
()) {

221 
btbUpd©e
(
pc
.
š¡Addr
(), 
bp_hi¡Üy
);

222 
DPRINTF
(
B¿nch
, "[tid:%i]:[sn:%i] btbUpdate"

223 " c®Ëd fÜ %s\n", 
tid
, 
£qNum
, 
pc
);

224 } ià(
	gš¡
->
isC®l
(è&& !š¡->
isUncÚdCŒl
()) {

225 
	gRAS
[
tid
].
pİ
();

226 
	g´ediù_»cÜd
.
	gpushedRAS
 = 
çl£
;

228 
	gTheISA
::
advªûPC
(
rg‘
, 
š¡
);

232 ià(
	gš¡
->
isR‘uº
()) {

233 
	g´ediù_»cÜd
.
	gwasR‘uº
 = 
Œue
;

235 
	gTheISA
::
advªûPC
(
rg‘
, 
š¡
);

238 
	gpc
 = 
rg‘
;

240 
	g´edHi¡
[
tid
].
push_äÚt
(
´ediù_»cÜd
);

242 
DPRINTF
(
B¿nch
, "[tid:%i]: [sn:%i]: Historyƒntry‡dded."

243 "´edHi¡.size(): %i\n", 
tid
, 
£qNum
, 
´edHi¡
[tid].
size
());

245  
	g´ed_k’
;

248 
boŞ


249 
	gBP»dUn™
::
´ediùInOrd”
(
SticIn¡PŒ
 &
š¡
, cÚ¡ 
In¡SeqNum
 &
£qNum
,

250 
asid
, 
TheISA
::
PCS‹
 &
š¡PC
,

251 
TheISA
::
PCS‹
 &
´edPC
, 
Th»adID
 
tid
)

258 
usšg
 
	gTheISA
::
MachIn¡
;

260 
boŞ
 
	g´ed_k’
 = 
çl£
;

261 
	gTheISA
::
PCS‹
 
rg‘
;

263 ++
	glookups
;

264 
DPRINTF
(
B¿nch
, "[tid:%i] [sn:%i] %s ... PC %s doing branch "

265 "´ediùiÚ\n", 
tid
, 
£qNum
,

266 
š¡
->
di§s£mbË
(
š¡PC
.
š¡Addr
()), instPC);

268 *
	gbp_hi¡Üy
 = 
NULL
;

270 ià(
	gš¡
->
isUncÚdCŒl
()) {

271 
DPRINTF
(
B¿nch
, "[tid:%i] UncÚd™iÚ® cÚŒŞ.\n", 
tid
);

272 
	g´ed_k’
 = 
Œue
;

274 
uncÚdB¿nch
(
bp_hi¡Üy
);

276 ià(
	gš¡
->
isR‘uº
(è&& 
	gRAS
[
tid
].
em±y
()) {

277 
DPRINTF
(
B¿nch
, "[tid:%i] RAS isƒmpty,…redicting "

278 "çl£.\n", 
tid
);

279 
	g´ed_k’
 = 
çl£
;

282 ++
	gcÚdP»diùed
;

284 
	g´ed_k’
 = 
lookup
(
´edPC
.
š¡Addr
(), 
bp_hi¡Üy
);

287 
P»diùÜHi¡Üy
 
´ediù_»cÜd
(
£qNum
, 
´edPC
.
š¡Addr
(), 
´ed_k’
,

288 
bp_hi¡Üy
, 
tid
);

291 ià(
	g´ed_k’
) {

292 ià(
	gš¡
->
isR‘uº
()) {

293 ++
	gu£dRAS
;

297 
	gTheISA
::
PCS‹
 
¿sTİ
 = 
RAS
[
tid
].
tİ
();

298 
	grg‘
 = 
TheISA
::
budR‘PC
(
š¡PC
, 
¿sTİ
);

301 
	g´ediù_»cÜd
.
	gu£dRAS
 = 
Œue
;

302 
	g´ediù_»cÜd
.
	gRASIndex
 = 
RAS
[
tid
].
tİIdx
();

303 
	g´ediù_»cÜd
.
	gRAST¬g‘
 = 
¿sTİ
;

305 
as£¹
(
´ediù_»cÜd
.
RASIndex
 < 16);

307 
	gRAS
[
tid
].
pİ
();

309 
DPRINTF
(
B¿nch
, "[tid:%i]: Instruction %s is‡„eturn, "

311 
tid
, 
š¡PC
, 
rg‘
,

312 
´ediù_»cÜd
.
RASIndex
);

314 ++
	gBTBLookups
;

316 ià(
	gš¡
->
isC®l
()) {

318 
	gRAS
[
tid
].
push
(
š¡PC
);

319 
	g´ediù_»cÜd
.
	gpushedRAS
 = 
Œue
;

323 
	g´ediù_»cÜd
.
	gwasC®l
 = 
Œue
;

325 
DPRINTF
(
B¿nch
, "[tid:%i]: Instruction %s was‡ call"

327 
tid
, 
š¡PC
, 
´edPC
,

328 
RAS
[
tid
].
tİIdx
());

331 ià(
	gš¡
->
isC®l
() &&

332 
	gš¡
->
isUncÚdCŒl
() &&

333 
	gš¡
->
isDœeùCŒl
()) {

334 
	grg‘
 = 
š¡
->
b¿nchT¬g‘
(
š¡PC
);

335 } ià(
	gBTB
.
v®id
(
´edPC
.
š¡Addr
(), 
asid
)) {

336 ++
	gBTBH™s
;

339 
	grg‘
 = 
BTB
.
lookup
(
´edPC
.
š¡Addr
(), 
asid
);

341 
DPRINTF
(
B¿nch
, "[tid:%i]: [asid:%i] Instruction %s "

343 
tid
, 
asid
, 
š¡PC
, 
rg‘
);

345 
DPRINTF
(
B¿nch
, "[tid:%i]: BTB doesn't have‡ "

346 "v®idƒÁry,…»diùšg f®£.\n",
tid
);

347 
	g´ed_k’
 = 
çl£
;

352 ià(
	g´ed_k’
) {

354 
	g´edPC
 = 
rg‘
;

356 
DPRINTF
(
B¿nch
, "[tid:%i]: [sn:%i]: Setting Predicted PCo %s.\n",

357 
tid
, 
£qNum
, 
´edPC
);

359 
	g´edHi¡
[
tid
].
push_äÚt
(
´ediù_»cÜd
);

361 
DPRINTF
(
B¿nch
, "[tid:%i] [sn:%i]…ushed onto front of…redHist "

363 
tid
, 
£qNum
, 
´edHi¡
[tid].
size
());

365  
	g´ed_k’
;

369 
	gBP»dUn™
::
	$upd©e
(cÚ¡ 
In¡SeqNum
 &
dÚe_¢
, 
Th»adID
 
tid
)

371 
	`DPRINTF
(
B¿nch
, "[tid:%i]: Committing branches until "

372 "[¢:%Îi].\n", 
tid
, 
dÚe_¢
);

374 !
´edHi¡
[
tid
].
	`em±y
() &&

375 
´edHi¡
[
tid
].
	`back
().
£qNum
 <ğ
dÚe_¢
) {

377 
	`upd©e
(
´edHi¡
[
tid
].
	`back
().
pc
,…»dHi¡[tid].back().
´edTak’
,

378 
´edHi¡
[
tid
].
	`back
().
bpHi¡Üy
, 
çl£
);

380 
´edHi¡
[
tid
].
	`pİ_back
();

382 
	}
}

385 
	gBP»dUn™
::
	$squash
(cÚ¡ 
In¡SeqNum
 &
squashed_¢
, 
Th»adID
 
tid
)

387 
Hi¡Üy
 &
´ed_hi¡
 = 
´edHi¡
[
tid
];

389 !
´ed_hi¡
.
	`em±y
() &&

390 
´ed_hi¡
.
	`äÚt
().
£qNum
 > 
squashed_¢
) {

391 ià(
´ed_hi¡
.
	`äÚt
().
u£dRAS
) {

392 
	`DPRINTF
(
B¿nch
, "[tid:%i]: Restoringop of RASo: %i,"

393 "¬g‘: %s.\n", 
tid
,

394 
´ed_hi¡
.
	`äÚt
().
RASIndex
,…»d_hi¡.äÚt().
RAST¬g‘
);

396 
RAS
[
tid
].
	`»¡Üe
(
´ed_hi¡
.
	`äÚt
().
RASIndex
,

397 
´ed_hi¡
.
	`äÚt
().
RAST¬g‘
);

398 } if(
´ed_hi¡
.
	`äÚt
().
wasC®l
 &&…»d_hi¡.äÚt().
pushedRAS
) {

400 
	`DPRINTF
(
B¿nch
, "[tid: %i] Squashing"

401 " C®È[¢:%i] PC: % Pİpšg RAS\n", 
tid
,

402 
´ed_hi¡
.
	`äÚt
().
£qNum
,…»d_hi¡.äÚt().
pc
);

403 
RAS
[
tid
].
	`pİ
();

407 
	`squash
(
´ed_hi¡
.
	`äÚt
().
bpHi¡Üy
);

409 
	`DPRINTF
(
B¿nch
, "[tid:%i]: Removing history for [sn:%i] "

410 "PC %s.\n", 
tid
, 
´ed_hi¡
.
	`äÚt
().
£qNum
,

411 
´ed_hi¡
.
	`äÚt
().
pc
);

413 
´ed_hi¡
.
	`pİ_äÚt
();

415 
	`DPRINTF
(
B¿nch
, "[tid:%i]:…redHist.size(): %i\n",

416 
tid
, 
´edHi¡
[tid].
	`size
());

418 
	}
}

421 
	gBP»dUn™
::
squash
(cÚ¡ 
In¡SeqNum
 &
squashed_¢
,

422 cÚ¡ 
TheISA
::
PCS‹
 &
cÜrT¬g‘
,

423 
boŞ
 
aùu®ly_k’
, 
Th»adID
 
tid
)

436 
	gHi¡Üy
 &
	g´ed_hi¡
 = 
´edHi¡
[
tid
];

438 ++
	gcÚdIncÜ»ù
;

440 
DPRINTF
(
B¿nch
, "[tid:%i]: Squashing from sequence‚umber %i, "

441 "£‰šg¬g‘Ø%s.\n", 
tid
, 
squashed_¢
, 
cÜrT¬g‘
);

444 
squash
(
squashed_¢
, 
tid
);

449 ià(!
	g´ed_hi¡
.
em±y
()) {

451 
Hi¡ÜyIt
 
	ghi¡_™
 = 
´ed_hi¡
.
begš
();

456 ià(
	g´ed_hi¡
.
äÚt
().
	g£qNum
 !ğ
squashed_¢
) {

457 
DPRINTF
(
B¿nch
, "Front sn %i != Squash sn %i\n",

458 
´ed_hi¡
.
äÚt
().
£qNum
, 
squashed_¢
);

460 
as£¹
(
´ed_hi¡
.
äÚt
().
£qNum
 =ğ
squashed_¢
);

464 ià((*
	ghi¡_™
).
	gu£dRAS
) {

465 ++
	gRASIncÜ»ù
;

468 
upd©e
((*
hi¡_™
).
pc
, 
aùu®ly_k’
,

469 
´ed_hi¡
.
äÚt
().
bpHi¡Üy
, 
Œue
);

470 ià(
	gaùu®ly_k’
) {

471 ià(
	ghi¡_™
->
	gwasR‘uº
 && !hi¡_™->
	gu£dRAS
) {

472 
DPRINTF
(
B¿nch
, "[tid: %i] Incorrectly…redicted"

473 "„‘uº [¢:%i] PC: %s\n", 
tid
, 
hi¡_™
->
£qNum
,

474 
hi¡_™
->
pc
);

475 
	gRAS
[
tid
].
pİ
();

478 
DPRINTF
(
B¿nch
,"[tid: %i] BTB Update called for [sn:%i]"

479 " PC: %s\n", 
tid
,
hi¡_™
->
£qNum
, hi¡_™->
pc
);

481 
	gBTB
.
upd©e
((*
hi¡_™
).
pc
, 
cÜrT¬g‘
, 
tid
);

485 ià(
	ghi¡_™
->
	gu£dRAS
) {

486 
DPRINTF
(
B¿nch
,"[tid: %i] Incorrectly…redicted"

487 "„‘uº [¢:%i] PC: % Re¡Üšg RAS\n", 
tid
,

488 
hi¡_™
->
£qNum
, hi¡_™->
pc
);

489 
DPRINTF
(
B¿nch
, "[tid:%i]: Restoringop of RAS"

490 "o: %i,¬g‘: %s.\n", 
tid
,

491 
hi¡_™
->
RASIndex
, hi¡_™->
RAST¬g‘
);

492 
	gRAS
[
tid
].
»¡Üe
(
hi¡_™
->
RASIndex
, hi¡_™->
RAST¬g‘
);

494 } ià(
	ghi¡_™
->
	gwasC®l
 && hi¡_™->
	gpushedRAS
) {

496 
DPRINTF
(
B¿nch
, "[tid: %i] Incorrectly…redicted"

497 " C®È[¢:%i] PC: % Pİpšg RAS\n", 
tid
,

498 
hi¡_™
->
£qNum
, hi¡_™->
pc
);

499 
	gRAS
[
tid
].
pİ
();

502 
DPRINTF
(
B¿nch
, "[tid:%i]: Removing history for [sn:%i]"

503 " PC %  Aùu®ly Tak’: %i\n", 
tid
, 
hi¡_™
->
£qNum
,

504 
hi¡_™
->
pc
, 
aùu®ly_k’
);

506 
	g´ed_hi¡
.
”a£
(
hi¡_™
);

508 
DPRINTF
(
B¿nch
, "[tid:%i]:…»dHi¡.size(): %i\n", 
tid
,

509 
´edHi¡
[
tid
].
size
());

511 
DPRINTF
(
B¿nch
, "[tid:%i]: [sn:%i]…red_histƒmpty, can't "

512 "upd©e.\n", 
tid
, 
squashed_¢
);

517 
	gBP»dUn™
::
	$dump
()

519 
Hi¡ÜyIt
 
´ed_hi¡_™
;

521 
i
 = 0; i < 
numTh»ads
; ++i) {

522 ià(!
´edHi¡
[
i
].
	`em±y
()) {

523 
´ed_hi¡_™
 = 
´edHi¡
[
i
].
	`begš
();

525 
	`ırštf
("´edHi¡[%i].size(): %i\n", 
i
, 
´edHi¡
[i].
	`size
());

527 
´ed_hi¡_™
 !ğ
´edHi¡
[
i
].
	`’d
()) {

528 
	`ırštf
("[sn:%lli], PC:%#x,id:%i,…redTaken:%i, "

530 
´ed_hi¡_™
->
£qNum
,…»d_hi¡_™->
pc
,

531 
´ed_hi¡_™
->
tid
,…»d_hi¡_™->
´edTak’
,

532 
´ed_hi¡_™
->
bpHi¡Üy
);

533 
´ed_hi¡_™
++;

536 
	`ırštf
("\n");

539 
	}
}

	@pred/btb.cc

31 
	~"ba£/štm©h.hh
"

32 
	~"ba£/Œaû.hh
"

33 
	~"ıu/´ed/btb.hh
"

34 
	~"debug/F‘ch.hh
"

36 
	gDeçuÉBTB
::
	$DeçuÉBTB
(
_numEÁr›s
,

37 
_gB™s
,

38 
_š¡ShiáAmt
)

39 : 
	`numEÁr›s
(
_numEÁr›s
),

40 
	`gB™s
(
_gB™s
),

41 
	$š¡ShiáAmt
(
_š¡ShiáAmt
)

43 
	`DPRINTF
(
F‘ch
, "BTB: Creating BTB object.\n");

45 ià(!
	`isPow”Of2
(
numEÁr›s
)) {

46 
	`çl
("BTBƒntries is‚ot‡…ower of 2!");

49 
btb
.
	`»size
(
numEÁr›s
);

51 
i
 = 0; i < 
numEÁr›s
; ++i) {

52 
btb
[
i
].
v®id
 = 
çl£
;

55 
idxMask
 = 
numEÁr›s
 - 1;

57 
gMask
 = (1 << 
gB™s
) - 1;

59 
gShiáAmt
 = 
š¡ShiáAmt
 + 
	`æoÜLog2
(
numEÁr›s
);

60 
	}
}

63 
	gDeçuÉBTB
::
	$»£t
()

65 
i
 = 0; i < 
numEÁr›s
; ++i) {

66 
btb
[
i
].
v®id
 = 
çl£
;

68 
	}
}

70 
šlše


72 
	gDeçuÉBTB
::
	$g‘Index
(
Addr
 
š¡PC
)

75  (
š¡PC
 >> 
š¡ShiáAmt
è& 
idxMask
;

76 
	}
}

78 
šlše


79 
Addr


80 
	gDeçuÉBTB
::
	$g‘Tag
(
Addr
 
š¡PC
)

82  (
š¡PC
 >> 
gShiáAmt
è& 
gMask
;

83 
	}
}

85 
boŞ


86 
	gDeçuÉBTB
::
	$v®id
(
Addr
 
š¡PC
, 
Th»adID
 
tid
)

88 
btb_idx
 = 
	`g‘Index
(
š¡PC
);

90 
Addr
 
š¡_g
 = 
	`g‘Tag
(
š¡PC
);

92 
	`as£¹
(
btb_idx
 < 
numEÁr›s
);

94 ià(
btb
[
btb_idx
].
v®id


95 && 
š¡_g
 =ğ
btb
[
btb_idx
].
g


96 && 
btb
[
btb_idx
].
tid
 ==id) {

97  
Œue
;

99  
çl£
;

101 
	}
}

106 
	gTheISA
::
PCS‹


107 
DeçuÉBTB
::
	$lookup
(
Addr
 
š¡PC
, 
Th»adID
 
tid
)

109 
btb_idx
 = 
	`g‘Index
(
š¡PC
);

111 
Addr
 
š¡_g
 = 
	`g‘Tag
(
š¡PC
);

113 
	`as£¹
(
btb_idx
 < 
numEÁr›s
);

115 ià(
btb
[
btb_idx
].
v®id


116 && 
š¡_g
 =ğ
btb
[
btb_idx
].
g


117 && 
btb
[
btb_idx
].
tid
 ==id) {

118  
btb
[
btb_idx
].
rg‘
;

122 
	}
}

125 
	gDeçuÉBTB
::
upd©e
(
Addr
 
š¡PC
, cÚ¡ 
TheISA
::
PCS‹
 &
rg‘
, 
Th»adID
 
tid
)

127 
	gbtb_idx
 = 
g‘Index
(
š¡PC
);

129 
as£¹
(
btb_idx
 < 
numEÁr›s
);

131 
	gbtb
[
btb_idx
].
	gtid
 = 
tid
;

132 
	gbtb
[
btb_idx
].
	gv®id
 = 
Œue
;

133 
	gbtb
[
btb_idx
].
	grg‘
 = 
rg‘
;

134 
	gbtb
[
btb_idx
].
	gg
 = 
g‘Tag
(
š¡PC
);

	@pred/btb.hh

31 #iâdeà
__CPU_PRED_BTB_HH__


32 
	#__CPU_PRED_BTB_HH__


	)

34 
	~"¬ch/ty³s.hh
"

35 
	~"ba£/misc.hh
"

36 
	~"ba£/ty³s.hh
"

37 
	~"cÚfig/the_i§.hh
"

39 şas 
	cDeçuÉBTB


41 
	m´iv©e
:

42 
	sBTBEÁry


44 
BTBEÁry
()

45 : 
g
(0), 
rg‘
(0), 
v®id
(
çl£
)

49 
Addr
 
	mg
;

52 
	mTheISA
::
PCS‹
 
rg‘
;

55 
Th»adID
 
	mtid
;

58 
boŞ
 
	mv®id
;

61 
	gpublic
:

68 
DeçuÉBTB
(
numEÁr›s
, 
gB™s
,

69 
š¡ShiáAmt
);

71 
»£t
();

78 
	gTheISA
::
PCS‹
 
lookup
(
Addr
 
š¡PC
, 
Th»adID
 
tid
);

85 
boŞ
 
v®id
(
Addr
 
š¡PC
, 
Th»adID
 
tid
);

92 
upd©e
(
Addr
 
š¡PC
, cÚ¡ 
TheISA
::
PCS‹
 &
rg‘PC
,

93 
Th»adID
 
tid
);

95 
	g´iv©e
:

100 
šlše
 
g‘Index
(
Addr
 
š¡PC
);

106 
šlše
 
Addr
 
g‘Tag
(Add¸
š¡PC
);

109 
	g¡d
::
veùÜ
<
BTBEÁry
> 
btb
;

112 
	gnumEÁr›s
;

115 
	gidxMask
;

118 
	ggB™s
;

121 
	ggMask
;

124 
	gš¡ShiáAmt
;

127 
	ggShiáAmt
;

	@pred/ras.cc

31 
	~"ıu/´ed/¿s.hh
"

34 
	gR‘uºAddrSck
::
	$š™
(
_numEÁr›s
)

36 
numEÁr›s
 = 
_numEÁr›s
;

37 
addrSck
.
	`»size
(
numEÁr›s
);

38 
	`»£t
();

39 
	}
}

42 
	gR‘uºAddrSck
::
	$»£t
()

44 
u£dEÁr›s
 = 0;

45 
tos
 = 0;

46 
i
 = 0; i < 
numEÁr›s
; ++i)

47 
addrSck
[
i
].
	`£t
(0);

48 
	}
}

51 
	gR‘uºAddrSck
::
push
(cÚ¡ 
TheISA
::
PCS‹
 &
»tuº_addr
)

53 
šüTos
();

55 
	gaddrSck
[
tos
] = 
»tuº_addr
;

57 ià(
	gu£dEÁr›s
 !ğ
numEÁr›s
) {

58 ++
u£dEÁr›s
;

63 
	gR‘uºAddrSck
::
	$pİ
()

65 ià(
u£dEÁr›s
 > 0) {

66 --
u£dEÁr›s
;

69 
	`deüTos
();

70 
	}
}

73 
	gR‘uºAddrSck
::
»¡Üe
(
tİ_’Œy_idx
,

74 cÚ¡ 
TheISA
::
PCS‹
 &
»¡Üed
)

76 
tos
 = 
tİ_’Œy_idx
;

78 
	gaddrSck
[
tos
] = 
»¡Üed
;

	@pred/ras.hh

31 #iâdeà
__CPU_PRED_RAS_HH__


32 
	#__CPU_PRED_RAS_HH__


	)

34 
	~<veùÜ
>

36 
	~"¬ch/ty³s.hh
"

37 
	~"ba£/ty³s.hh
"

38 
	~"cÚfig/the_i§.hh
"

41 şas 
	cR‘uºAddrSck


43 
	mpublic
:

47 
	$R‘uºAddrSck
() {}

52 
	`š™
(
numEÁr›s
);

54 
	`»£t
();

57 
TheISA
::
PCS‹
 
	$tİ
()

58 {  
addrSck
[
tos
]; 
	}
}

61 
	$tİIdx
()

62 {  
tos
; 
	}
}

65 
push
(cÚ¡ 
TheISA
::
PCS‹
 &
»tuº_addr
);

68 
pİ
();

75 
»¡Üe
(
tİ_’Œy_idx
, cÚ¡ 
TheISA
::
PCS‹
 &
»¡Üed
);

77 
boŞ
 
	$em±y
(è{  
u£dEÁr›s
 =ğ0; 
	}
}

79 
boŞ
 
	$fuÎ
(è{  
u£dEÁr›s
 =ğ
numEÁr›s
; 
	}
}

80 
	g´iv©e
:

82 
šlše
 
	$šüTos
()

83 { ià(++
tos
 =ğ
numEÁr›s
èto ğ0; 
	}
}

86 
šlše
 
	$deüTos
()

87 { 
tos
 = (to =ğ0 ? 
numEÁr›s
 - 1 :o - 1); 
	}
}

90 
	g¡d
::
veùÜ
<
TheISA
::
PCS‹
> 
addrSck
;

93 
	gnumEÁr›s
;

96 
	gu£dEÁr›s
;

99 
	gtos
;

	@pred/sat_counter.hh

31 #iâdeà
__CPU_PRED_SAT_COUNTER_HH__


32 
	#__CPU_PRED_SAT_COUNTER_HH__


	)

34 
	~"ba£/misc.hh
"

35 
	~"ba£/ty³s.hh
"

44 şas 
	cS©CouÁ”


46 
	mpublic
:

50 
	$S©CouÁ”
()

51 : 
	`š™ŸlV®
(0), 
	$couÁ”
(0)

58 
	$S©CouÁ”
(
b™s
)

59 : 
	`š™ŸlV®
(0), 
	`maxV®
((1 << 
b™s
è- 1), 
	$couÁ”
(0)

60 { 
	}
}

67 
	$S©CouÁ”
(
b™s
, 
ušt8_t
 
š™Ÿl_v®
)

68 : 
	`š™ŸlV®
(
š™Ÿl_v®
), 
	`maxV®
((1 << 
b™s
) - 1),

69 
	$couÁ”
(
š™Ÿl_v®
)

73 ià(
š™Ÿl_v®
 > 
maxV®
) {

74 
	`çl
("BP: Initial counter valueƒxceeds max size.");

76 
	}
}

81 
	$£tB™s
(
b™s
è{ 
maxV®
 = (1 << b™sè- 1; 
	}
}

83 
	$»£t
(è{ 
couÁ”
 = 
š™ŸlV®
; 
	}
}

88 
	$šüem’t
()

90 ià(
couÁ”
 < 
maxV®
) {

91 ++
couÁ”
;

93 
	}
}

98 
	$deüem’t
()

100 ià(
couÁ”
 > 0) {

101 --
couÁ”
;

103 
	}
}

108 cÚ¡ 
ušt8_t
 
	$»ad
() const

109 {  
couÁ”
; 
	}
}

111 
	g´iv©e
:

112 
ušt8_t
 
š™ŸlV®
;

113 
ušt8_t
 
	gmaxV®
;

114 
ušt8_t
 
	gcouÁ”
;

	@pred/tournament.cc

43 
	~"ba£/b™f›ld.hh
"

44 
	~"ba£/štm©h.hh
"

45 
	~"ıu/´ed/touºam’t.hh
"

47 
	gTouºam’tBP
::
	$Touºam’tBP
(cÚ¡ 
P¬ams
 *
·¿ms
)

48 : 
	`BP»dUn™
(
·¿ms
),

49 
	`loÿlP»diùÜSize
(
·¿ms
->
loÿlP»diùÜSize
),

50 
	`loÿlCŒB™s
(
·¿ms
->
loÿlCŒB™s
),

51 
	`loÿlHi¡ÜyTabËSize
(
·¿ms
->
loÿlHi¡ÜyTabËSize
),

52 
	`loÿlHi¡ÜyB™s
(
	`ûLog2
(
·¿ms
->
loÿlP»diùÜSize
)),

53 
	`glob®P»diùÜSize
(
·¿ms
->
glob®P»diùÜSize
),

54 
	`glob®CŒB™s
(
·¿ms
->
glob®CŒB™s
),

55 
	`glob®Hi¡ÜyB™s
(

56 
	`ûLog2
(
·¿ms
->
glob®P»diùÜSize
) >

57 
	`ûLog2
(
·¿ms
->
choiûP»diùÜSize
) ?

58 
	`ûLog2
(
·¿ms
->
glob®P»diùÜSize
) :

59 
	`ûLog2
(
·¿ms
->
choiûP»diùÜSize
)),

60 
	`choiûP»diùÜSize
(
·¿ms
->
choiûP»diùÜSize
),

61 
	`choiûCŒB™s
(
·¿ms
->
choiûCŒB™s
),

62 
	`š¡ShiáAmt
(
·¿ms
->
š¡ShiáAmt
)

64 ià(!
	`isPow”Of2
(
loÿlP»diùÜSize
)) {

65 
	`çl
("Invalid†ocal…redictor size!\n");

68 ià(!
	`isPow”Of2
(
glob®P»diùÜSize
)) {

69 
	`çl
("Invalid global…redictor size!\n");

73 
loÿlCŒs
.
	`»size
(
loÿlP»diùÜSize
);

75 
i
 = 0; i < 
loÿlP»diùÜSize
; ++i)

76 
loÿlCŒs
[
i
].
	`£tB™s
(
loÿlCŒB™s
);

78 
loÿlP»diùÜMask
 = 
	`mask
(
loÿlHi¡ÜyB™s
);

80 ià(!
	`isPow”Of2
(
loÿlHi¡ÜyTabËSize
)) {

81 
	`çl
("Invalid†ocal historyable size!\n");

85 
loÿlHi¡ÜyTabË
.
	`»size
(
loÿlHi¡ÜyTabËSize
);

87 
i
 = 0; i < 
loÿlHi¡ÜyTabËSize
; ++i)

88 
loÿlHi¡ÜyTabË
[
i
] = 0;

91 
glob®CŒs
.
	`»size
(
glob®P»diùÜSize
);

93 
i
 = 0; i < 
glob®P»diùÜSize
; ++i)

94 
glob®CŒs
[
i
].
	`£tB™s
(
glob®CŒB™s
);

97 
glob®Hi¡Üy
 = 0;

100 
glob®Hi¡ÜyMask
 = 
glob®P»diùÜSize
 - 1;

102 ià(!
	`isPow”Of2
(
choiûP»diùÜSize
)) {

103 
	`çl
("Invalid choice…redictor size!\n");

108 
choiûHi¡ÜyMask
 = 
choiûP»diùÜSize
 - 1;

111 
choiûCŒs
.
	`»size
(
choiûP»diùÜSize
);

113 
i
 = 0; i < 
choiûP»diùÜSize
; ++i)

114 
choiûCŒs
[
i
].
	`£tB™s
(
choiûCŒB™s
);

117 
hi¡ÜyRegi¡”Mask
 = 
	`mask
(
glob®Hi¡ÜyB™s
);

120 ià(
glob®Hi¡ÜyMask
 > 
hi¡ÜyRegi¡”Mask
) {

121 
	`çl
("Global…redictoroo†arge for global history bits!\n");

123 ià(
choiûHi¡ÜyMask
 > 
hi¡ÜyRegi¡”Mask
) {

124 
	`çl
("Choice…redictoroo†arge for global history bits!\n");

127 ià(
glob®Hi¡ÜyMask
 < 
hi¡ÜyRegi¡”Mask
 &&

128 
choiûHi¡ÜyMask
 < 
hi¡ÜyRegi¡”Mask
) {

129 
	`šfÜm
("More global history bitshan„equired by…redictors\n");

134 
loÿlTh»shŞd
 = (
	`ULL
(1è<< (
loÿlCŒB™s
 - 1)) - 1;

135 
glob®Th»shŞd
 = (
	`ULL
(1è<< (
glob®CŒB™s
 - 1)) - 1;

136 
choiûTh»shŞd
 = (
	`ULL
(1è<< (
choiûCŒB™s
 - 1)) - 1;

137 
	}
}

139 
šlše


141 
	gTouºam’tBP
::
	$ÿlcLocHi¡Idx
(
Addr
 &
b¿nch_addr
)

144  (
b¿nch_addr
 >> 
š¡ShiáAmt
è& (
loÿlHi¡ÜyTabËSize
 - 1);

145 
	}
}

147 
šlše


149 
	gTouºam’tBP
::
	$upd©eGlob®Hi¡Tak’
()

151 
glob®Hi¡Üy
 = (globalHistory << 1) | 1;

152 
glob®Hi¡Üy
 = glob®Hi¡Üy & 
hi¡ÜyRegi¡”Mask
;

153 
	}
}

155 
šlše


157 
	gTouºam’tBP
::
	$upd©eGlob®Hi¡NÙTak’
()

159 
glob®Hi¡Üy
 = (globalHistory << 1);

160 
glob®Hi¡Üy
 = glob®Hi¡Üy & 
hi¡ÜyRegi¡”Mask
;

161 
	}
}

163 
šlše


165 
	gTouºam’tBP
::
	$upd©eLoÿlHi¡Tak’
(
loÿl_hi¡Üy_idx
)

167 
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
] =

168 (
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
] << 1) | 1;

169 
	}
}

171 
šlše


173 
	gTouºam’tBP
::
	$upd©eLoÿlHi¡NÙTak’
(
loÿl_hi¡Üy_idx
)

175 
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
] =

176 (
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
] << 1);

177 
	}
}

181 
	gTouºam’tBP
::
	$btbUpd©e
(
Addr
 
b¿nch_addr
, * &
bp_hi¡Üy
)

183 
loÿl_hi¡Üy_idx
 = 
	`ÿlcLocHi¡Idx
(
b¿nch_addr
);

185 
glob®Hi¡Üy
 &ğ(
hi¡ÜyRegi¡”Mask
 & ~
	`ULL
(1));

187 
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
] =

188 
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
] & (
loÿlP»diùÜMask
 & ~
	`ULL
(1));

189 
	}
}

191 
boŞ


192 
	gTouºam’tBP
::
	$lookup
(
Addr
 
b¿nch_addr
, * &
bp_hi¡Üy
)

194 
boŞ
 
loÿl_´ediùiÚ
;

195 
loÿl_hi¡Üy_idx
;

196 
loÿl_´ediùÜ_idx
;

198 
boŞ
 
glob®_´ediùiÚ
;

199 
boŞ
 
choiû_´ediùiÚ
;

202 
loÿl_hi¡Üy_idx
 = 
	`ÿlcLocHi¡Idx
(
b¿nch_addr
);

203 
loÿl_´ediùÜ_idx
 = 
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
]

204 & 
loÿlP»diùÜMask
;

205 
loÿl_´ediùiÚ
 = 
loÿlCŒs
[
loÿl_´ediùÜ_idx
].
	`»ad
(è> 
loÿlTh»shŞd
;

208 
glob®_´ediùiÚ
 =

209 
glob®CŒs
[
glob®Hi¡Üy
 & 
glob®Hi¡ÜyMask
].
	`»ad
(è> 
glob®Th»shŞd
;

212 
choiû_´ediùiÚ
 =

213 
choiûCŒs
[
glob®Hi¡Üy
 & 
choiûHi¡ÜyMask
].
	`»ad
(è> 
choiûTh»shŞd
;

216 
BPHi¡Üy
 *
hi¡Üy
 = 
Ãw
 BPHistory;

217 
hi¡Üy
->
glob®Hi¡Üy
 = globalHistory;

218 
hi¡Üy
->
loÿlP»dTak’
 = 
loÿl_´ediùiÚ
;

219 
hi¡Üy
->
glob®P»dTak’
 = 
glob®_´ediùiÚ
;

220 
hi¡Üy
->
glob®U£d
 = 
choiû_´ediùiÚ
;

221 
hi¡Üy
->
loÿlHi¡Üy
 = 
loÿl_´ediùÜ_idx
;

222 
bp_hi¡Üy
 = (*)
hi¡Üy
;

224 
	`as£¹
(
loÿl_hi¡Üy_idx
 < 
loÿlHi¡ÜyTabËSize
);

228 ià(
choiû_´ediùiÚ
) {

229 ià(
glob®_´ediùiÚ
) {

230 
	`upd©eGlob®Hi¡Tak’
();

231 
	`upd©eLoÿlHi¡Tak’
(
loÿl_hi¡Üy_idx
);

232  
Œue
;

234 
	`upd©eGlob®Hi¡NÙTak’
();

235 
	`upd©eLoÿlHi¡NÙTak’
(
loÿl_hi¡Üy_idx
);

236  
çl£
;

239 ià(
loÿl_´ediùiÚ
) {

240 
	`upd©eGlob®Hi¡Tak’
();

241 
	`upd©eLoÿlHi¡Tak’
(
loÿl_hi¡Üy_idx
);

242  
Œue
;

244 
	`upd©eGlob®Hi¡NÙTak’
();

245 
	`upd©eLoÿlHi¡NÙTak’
(
loÿl_hi¡Üy_idx
);

246  
çl£
;

249 
	}
}

252 
	gTouºam’tBP
::
	$uncÚdB¿nch
(* &
bp_hi¡Üy
)

255 
BPHi¡Üy
 *
hi¡Üy
 = 
Ãw
 BPHistory;

256 
hi¡Üy
->
glob®Hi¡Üy
 = globalHistory;

257 
hi¡Üy
->
loÿlP»dTak’
 = 
Œue
;

258 
hi¡Üy
->
glob®P»dTak’
 = 
Œue
;

259 
hi¡Üy
->
glob®U£d
 = 
Œue
;

260 
hi¡Üy
->
loÿlHi¡Üy
 = 
šv®idP»diùÜIndex
;

261 
bp_hi¡Üy
 = 
¡©ic_ÿ¡
<*>(
hi¡Üy
);

263 
	`upd©eGlob®Hi¡Tak’
();

264 
	}
}

267 
	gTouºam’tBP
::
	$upd©e
(
Addr
 
b¿nch_addr
, 
boŞ
 
k’
, *
bp_hi¡Üy
,

268 
boŞ
 
squashed
)

270 
loÿl_hi¡Üy_idx
;

271 
loÿl_´ediùÜ_idx
 
M5_VAR_USED
;

272 
loÿl_´ediùÜ_hi¡
;

275 
loÿl_hi¡Üy_idx
 = 
	`ÿlcLocHi¡Idx
(
b¿nch_addr
);

276 
loÿl_´ediùÜ_hi¡
 = 
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
];

277 
loÿl_´ediùÜ_idx
 = 
loÿl_´ediùÜ_hi¡
 & 
loÿlP»diùÜMask
;

279 ià(
bp_hi¡Üy
) {

280 
BPHi¡Üy
 *
hi¡Üy
 = 
¡©ic_ÿ¡
<BPHi¡Üy *>(
bp_hi¡Üy
);

283 
boŞ
 
hi¡ÜyP»d
 = 
çl£
;

284 
Şd_loÿl_´ed_šdex
 = 
hi¡Üy
->
loÿlHi¡Üy
 &

285 
loÿlP»diùÜMask
;

287 
boŞ
 
Şd_loÿl_´ed_v®id
 = 
hi¡Üy
->
loÿlHi¡Üy
 !=

288 
šv®idP»diùÜIndex
;

290 
	`as£¹
(
Şd_loÿl_´ed_šdex
 < 
loÿlP»diùÜSize
);

292 ià(
hi¡Üy
->
glob®U£d
) {

293 
hi¡ÜyP»d
 = 
hi¡Üy
->
glob®P»dTak’
;

295 
hi¡ÜyP»d
 = 
hi¡Üy
->
loÿlP»dTak’
;

297 ià(
hi¡ÜyP»d
 !ğ
k’
 || !
squashed
) {

300 ià(
hi¡Üy
->
loÿlP»dTak’
 !ğhi¡Üy->
glob®P»dTak’
) {

304 
choiû_´ediùÜ_idx
 =

305 
hi¡Üy
->
glob®Hi¡Üy
 & 
choiûHi¡ÜyMask
;

306 ià(
hi¡Üy
->
loÿlP»dTak’
 =ğ
k’
) {

307 
choiûCŒs
[
choiû_´ediùÜ_idx
].
	`deüem’t
();

308 } ià(
hi¡Üy
->
glob®P»dTak’
 =ğ
k’
) {

309 
choiûCŒs
[
choiû_´ediùÜ_idx
].
	`šüem’t
();

318 
glob®_´ediùÜ_idx
 =

319 
hi¡Üy
->
glob®Hi¡Üy
 & 
glob®Hi¡ÜyMask
;

320 ià(
k’
) {

321 
glob®CŒs
[
glob®_´ediùÜ_idx
].
	`šüem’t
();

322 ià(
Şd_loÿl_´ed_v®id
) {

323 
loÿlCŒs
[
Şd_loÿl_´ed_šdex
].
	`šüem’t
();

326 
glob®CŒs
[
glob®_´ediùÜ_idx
].
	`deüem’t
();

327 ià(
Şd_loÿl_´ed_v®id
) {

328 
loÿlCŒs
[
Şd_loÿl_´ed_šdex
].
	`deüem’t
();

332 ià(
squashed
) {

333 ià(
k’
) {

334 
glob®Hi¡Üy
 = (
hi¡Üy
->globalHistory << 1) | 1;

335 
glob®Hi¡Üy
 = glob®Hi¡Üy & 
hi¡ÜyRegi¡”Mask
;

336 ià(
Şd_loÿl_´ed_v®id
) {

337 
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
] =

338 (
hi¡Üy
->
loÿlHi¡Üy
 << 1) | 1;

341 
glob®Hi¡Üy
 = (
hi¡Üy
->globalHistory << 1);

342 
glob®Hi¡Üy
 = glob®Hi¡Üy & 
hi¡ÜyRegi¡”Mask
;

343 ià(
Şd_loÿl_´ed_v®id
) {

344 
loÿlHi¡ÜyTabË
[
loÿl_hi¡Üy_idx
] =

345 
hi¡Üy
->
loÿlHi¡Üy
 << 1;

351 
d–‘e
 
hi¡Üy
;

355 
	`as£¹
(
loÿl_hi¡Üy_idx
 < 
loÿlHi¡ÜyTabËSize
);

358 
	}
}

361 
	gTouºam’tBP
::
	$squash
(*
bp_hi¡Üy
)

363 
BPHi¡Üy
 *
hi¡Üy
 = 
¡©ic_ÿ¡
<BPHi¡Üy *>(
bp_hi¡Üy
);

366 
glob®Hi¡Üy
 = 
hi¡Üy
->globalHistory;

369 
d–‘e
 
hi¡Üy
;

370 
	}
}

372 #ifdeà
DEBUG


374 
	gTouºam’tBP
::
BPHi¡Üy
::
ÃwCouÁ
 = 0;

	@pred/tournament.hh

45 #iâdeà
__CPU_PRED_TOURNAMENT_PRED_HH__


46 
	#__CPU_PRED_TOURNAMENT_PRED_HH__


	)

48 
	~<veùÜ
>

50 
	~"ba£/ty³s.hh
"

51 
	~"ıu/´ed/b´ed_un™.hh
"

52 
	~"ıu/´ed/§t_couÁ”.hh
"

63 şas 
	cTouºam’tBP
 : 
public
 
BP»dUn™


65 
public
:

69 
Touºam’tBP
(cÚ¡ 
P¬ams
 *
·¿ms
);

79 
boŞ
 
lookup
(
Addr
 
b¿nch_addr
, * &
bp_hi¡Üy
);

87 
uncÚdB¿nch
(* &
bp_hi¡Üy
);

95 
btbUpd©e
(
Addr
 
b¿nch_addr
, * &
bp_hi¡Üy
);

105 
upd©e
(
Addr
 
b¿nch_addr
, 
boŞ
 
k’
, *
bp_hi¡Üy
, boŞ 
squashed
);

112 
squash
(*
bp_hi¡Üy
);

115 
šlše
 
	$»adGlob®Hi¡
(è{  
glob®Hi¡Üy
; }

117 
´iv©e
:

123 
šlše
 
boŞ
 
	`g‘P»diùiÚ
(
ušt8_t
 &
couÁ
);

129 
šlše
 
	`ÿlcLocHi¡Idx
(
Addr
 &
b¿nch_addr
);

132 
šlše
 
	`upd©eGlob®Hi¡Tak’
();

135 
šlše
 
	`upd©eGlob®Hi¡NÙTak’
();

142 
šlše
 
	`upd©eLoÿlHi¡Tak’
(
loÿl_hi¡Üy_idx
);

149 
šlše
 
	`upd©eLoÿlHi¡NÙTak’
(
loÿl_hi¡Üy_idx
);

157 
	sBPHi¡Üy
 {

158 #ifdeà
DEBUG


159 
	`BPHi¡Üy
()

160 { 
ÃwCouÁ
++; }

161 ~
	`BPHi¡Üy
()

162 { 
ÃwCouÁ
--; }

164 
ÃwCouÁ
;

166 
glob®Hi¡Üy
;

167 
loÿlHi¡Üy
;

168 
boŞ
 
loÿlP»dTak’
;

169 
boŞ
 
glob®P»dTak’
;

170 
boŞ
 
glob®U£d
;

171 
	}
};

174 cÚ¡ 
	gšv®idP»diùÜIndex
 = -1;

176 
	g¡d
::
veùÜ
<
S©CouÁ”
> 
loÿlCŒs
;

179 
	gloÿlP»diùÜSize
;

182 
	gloÿlP»diùÜMask
;

185 
	gloÿlCŒB™s
;

188 
	g¡d
::
veùÜ
<> 
loÿlHi¡ÜyTabË
;

191 
	gloÿlHi¡ÜyTabËSize
;

194 
	gloÿlHi¡ÜyB™s
;

197 
	g¡d
::
veùÜ
<
S©CouÁ”
> 
glob®CŒs
;

200 
	gglob®P»diùÜSize
;

203 
	gglob®CŒB™s
;

208 
	gglob®Hi¡Üy
;

212 
	gglob®Hi¡ÜyB™s
;

216 
	gglob®Hi¡ÜyMask
;

220 
	gchoiûHi¡ÜyMask
;

224 
	ghi¡ÜyRegi¡”Mask
;

227 
	g¡d
::
veùÜ
<
S©CouÁ”
> 
choiûCŒs
;

230 
	gchoiûP»diùÜSize
;

233 
	gchoiûCŒB™s
;

238 
	gš¡ShiáAmt
;

243 
	gloÿlTh»shŞd
;

244 
	gglob®Th»shŞd
;

245 
	gchoiûTh»shŞd
;

	@profile.cc

31 
	~<¡ršg
>

33 
	~"ba£/lßd”/symb.hh
"

34 
	~"ba£/b™f›ld.hh
"

35 
	~"ba£/ÿÎback.hh
"

36 
	~"ba£/¡©i¡ics.hh
"

37 
	~"ba£/Œaû.hh
"

38 
	~"ıu/ba£.hh
"

39 
	~"ıu/´ofe.hh
"

40 
	~"ıu/th»ad_cÚ‹xt.hh
"

42 
usšg
 
Çme¥aû
 
	g¡d
;

44 
	gProfeNode
::
	$ProfeNode
()

45 : 
	$couÁ
(0)

46 { 
	}
}

49 
ProfeNode
::
	$dump
(cÚ¡ 
¡ršg
 &
symbŞ
, 
ušt64_t
 
id
, cÚ¡ 
SymbŞTabË
 *
symb
,

50 
o¡»am
 &
os
) const

52 
	`cırštf
(
os
, "%#x % %d ", 
id
, 
symbŞ
, 
couÁ
);

53 
ChdLi¡
::
cÚ¡_™”©Ü
 
i
, 
’d
 = 
chd»n
.
	`’d
();

54 
i
 = 
chd»n
.
	`begš
(); i !ğ
’d
; ++i) {

55 cÚ¡ 
ProfeNode
 *
node
 = 
i
->
£cÚd
;

56 
	`cırštf
(
os
, "%#x ", (
šŒ_t
)
node
);

59 
	`cırštf
(
os
, "\n");

61 
i
 = 
chd»n
.
	`begš
(); i !ğ
’d
; ++i) {

62 
Addr
 
addr
 = 
i
->
fœ¡
;

63 
¡ršg
 
symbŞ
;

64 ià(
addr
 == 1)

65 
symbŞ
 = "user";

66 ià(
addr
 == 2)

67 
symbŞ
 = "console";

68 ià(
addr
 == 3)

69 
symbŞ
 = "unknown";

70 ià(!
symb
->
	`fšdSymbŞ
(
addr
, 
symbŞ
))

71 
	`·nic
("could‚Ù fšd symbŞ fÜ‡dd»s %#x\n", 
addr
);

73 cÚ¡ 
ProfeNode
 *
node
 = 
i
->
£cÚd
;

74 
node
->
	`dump
(
symbŞ
, (
šŒ_t
êode, 
symb
, 
os
);

76 
	}
}

79 
	gProfeNode
::
	$ş—r
()

81 
couÁ
 = 0;

82 
ChdLi¡
::
™”©Ü
 
i
, 
’d
 = 
chd»n
.
	`’d
();

83 
i
 = 
chd»n
.
	`begš
(); i !ğ
’d
; ++i)

84 
i
->
£cÚd
->
	`ş—r
();

85 
	}
}

87 
	gFunùiÚProfe
::
	$FunùiÚProfe
(cÚ¡ 
SymbŞTabË
 *
_symb
)

88 : 
	`»£t
(0), 
	$symb
(
_symb
)

90 
»£t
 = 
Ãw
 
MakeC®lback
<
FunùiÚProfe
, &FunùiÚProfe::
ş—r
>(
this
);

91 
Sts
::
	`»gi¡”Re£tC®lback
(
»£t
);

92 
	}
}

94 
	gFunùiÚProfe
::~
	$FunùiÚProfe
()

96 ià(
»£t
)

97 
d–‘e
 
»£t
;

98 
	}
}

100 
ProfeNode
 *

101 
	gFunùiÚProfe
::
cÚsume
(cÚ¡ 
veùÜ
<
Addr
> &
¡ack
)

103 
ProfeNode
 *
cu¼’t
 = &
tİ
;

104 
	gi
 = 0, 
	gsize
 = 
¡ack
.
size
(); i < size; ++i) {

105 
	gProfeNode
 *&
	g±r
 = 
cu¼’t
->
chd»n
[
¡ack
[
size
 - 
i
 - 1]];

106 ià(
	g±r
 =ğ
NULL
)

107 
±r
 = 
Ãw
 
ProfeNode
;

109 
	gcu¼’t
 = 
±r
;

112  
	gcu¼’t
;

116 
	gFunùiÚProfe
::
	$ş—r
()

118 
tİ
.
	`ş—r
();

119 
pc_couÁ
.
	`ş—r
();

120 
	}
}

123 
	gFunùiÚProfe
::
	$dump
(
Th»adCÚ‹xt
 *
tc
, 
o¡»am
 &
os
) const

125 
	`cırštf
(
os
, ">>>PC data\n");

126 
m­
<
Addr
, 
CouÁ”
>::
cÚ¡_™”©Ü
 
i
, 
’d
 = 
pc_couÁ
.
	`’d
();

127 
i
 = 
pc_couÁ
.
	`begš
(); i !ğ
’d
; ++i) {

128 
Addr
 
pc
 = 
i
->
fœ¡
;

129 
CouÁ”
 
couÁ
 = 
i
->
£cÚd
;

131 
¡d
::
¡ršg
 
symbŞ
;

132 ià(
pc
 == 1)

133 
	`cırštf
(
os
, "u£¸%d\n", 
couÁ
);

134 ià(
symb
->
	`fšdSymbŞ
(
pc
, 
symbŞ
è&& !symbŞ.
	`em±y
())

135 
	`cırštf
(
os
, "% %d\n", 
symbŞ
, 
couÁ
);

137 
	`cırštf
(
os
, "%#x %d\n", 
pc
, 
couÁ
);

140 
	`cırštf
(
os
, ">>>function data\n");

141 
tİ
.
	`dump
("tİ", 0, 
symb
, 
os
);

142 
	}
}

145 
	gFunùiÚProfe
::
	$§m¶e
(
ProfeNode
 *
node
, 
Addr
 
pc
)

147 
node
->
couÁ
++;

149 
Addr
 
symaddr
;

150 ià(
symb
->
	`fšdN—»¡Addr
(
pc
, 
symaddr
)) {

151 
pc_couÁ
[
symaddr
]++;

155 
pc_couÁ
[
pc
]++;

157 
	}
}

	@profile.hh

31 #iâdeà
__CPU_PROFILE_HH__


32 
	#__CPU_PROFILE_HH__


	)

34 
	~<m­
>

36 
	~"¬ch/¡ackŒaû.hh
"

37 
	~"ba£/ty³s.hh
"

38 
	~"cÚfig/the_i§.hh
"

39 
	~"ıu/¡©ic_š¡.hh
"

41 
şass
 
	gTh»adCÚ‹xt
;

43 şas 
	cProfeNode


45 
	m´iv©e
:

46 
ä›nd
 
şass
 
FunùiÚProfe
;

48 
	m¡d
::
	tm­
<
	tAddr
, 
	tProfeNode
 *> 
	tChdLi¡
;

49 
ChdLi¡
 
	mchd»n
;

51 
	mpublic
:

52 
CouÁ”
 
couÁ
;

54 
	mpublic
:

55 
ProfeNode
();

57 
dump
(cÚ¡ 
¡d
::
¡ršg
 &
symbŞ
, 
ušt64_t
 
id
,

58 cÚ¡ 
SymbŞTabË
 *
symb
, 
¡d
::
o¡»am
 &
os
) const;

59 
ş—r
();

62 
şass
 
	gC®lback
;

63 şas 
	cFunùiÚProfe


65 
	m´iv©e
:

66 
C®lback
 *
»£t
;

67 cÚ¡ 
SymbŞTabË
 *
	msymb
;

68 
ProfeNode
 
	mtİ
;

69 
	m¡d
::
m­
<
Addr
, 
	mCouÁ”
> 
	mpc_couÁ
;

70 
	mTheISA
::
SckT¿û
 
Œaû
;

72 
	mpublic
:

73 
FunùiÚProfe
(cÚ¡ 
SymbŞTabË
 *
symb
);

74 ~
FunùiÚProfe
();

76 
ProfeNode
 *
cÚsume
(
Th»adCÚ‹xt
 *
tc
, 
SticIn¡PŒ
 
š¡
);

77 
ProfeNode
 *
cÚsume
(cÚ¡ 
¡d
::
veùÜ
<
Addr
> &
¡ack
);

78 
ş—r
();

79 
dump
(
Th»adCÚ‹xt
 *
tc
, 
¡d
::
o¡»am
 &
out
) const;

80 
§m¶e
(
ProfeNode
 *
node
, 
Addr
 
pc
);

83 
šlše
 
ProfeNode
 *

84 
	gFunùiÚProfe
::
	$cÚsume
(
Th»adCÚ‹xt
 *
tc
, 
SticIn¡PŒ
 
š¡
)

86 ià(!
Œaû
.
	`Œaû
(
tc
, 
š¡
))

87  
NULL
;

88 
Œaû
.
	`d´štf
();

89  
	`cÚsume
(
Œaû
.
	`g‘¡ack
());

90 
	}
}

	@quiesce_event.cc

31 
	~"ıu/ba£.hh
"

32 
	~"ıu/qu›sû_ev’t.hh
"

33 
	~"ıu/th»ad_cÚ‹xt.hh
"

34 
	~"debug/Qu›sû.hh
"

36 
	gEndQu›sûEv’t
::
	$EndQu›sûEv’t
(
Th»adCÚ‹xt
 *
_tc
)

37 : 
	$tc
(
_tc
)

39 
	}
}

42 
EndQu›sûEv’t
::
	$´oûss
()

44 
	`DPRINTF
(
Qu›sû
, "aùiv©šg %s\n", 
tc
->
	`g‘CpuPŒ
()->
	`Çme
());

45 
tc
->
	`aùiv©e
();

46 
	}
}

49 
	gEndQu›sûEv’t
::
	$desütiÚ
() const

52 
	}
}

	@quiesce_event.hh

31 #iâdeà
__CPU_QUIESCE_EVENT_HH__


32 
	#__CPU_QUIESCE_EVENT_HH__


	)

34 
	~"sim/ev’tq.hh
"

36 
şass
 
	gTh»adCÚ‹xt
;

39 şas 
	cEndQu›sûEv’t
 : 
public
 
Ev’t


41 
public
:

43 
Th»adCÚ‹xt
 *
tc
;

45 
EndQu›sûEv’t
(
Th»adCÚ‹xt
 *
_tc
);

48 
vœtu®
 
´oûss
();

51 
vœtu®
 cÚ¡ *
	$desütiÚ
() const;

	@reg_class.cc

31 
	~"ıu/»g_şass.hh
"

33 cÚ¡ *
	gRegCÏssSŒšgs
[] = {

	@reg_class.hh

31 #iâdeà
__CPU__REG_CLASS_HH__


32 
	#__CPU__REG_CLASS_HH__


	)

34 
	~<ÿs£¹
>

35 
	~<c¡ddef
>

37 
	~"¬ch/»gi¡”s.hh
"

38 
	~"cÚfig/the_i§.hh
"

41 
	eRegCÏss
 {

42 
	mIÁRegCÏss
,

43 
	mFlßtRegCÏss
,

44 
	mCCRegCÏss
,

45 
	mMiscRegCÏss


51 cÚ¡ 
	gNumRegCÏs£s
 = 
MiscRegCÏss
 + 1;

65 
šlše


66 
RegCÏss
 
»gIdxToCÏss
(
TheISA
::
RegIndex
 
»g_idx
,

67 
TheISA
::
RegIndex
 *
»l_»g_idx
 = 
NULL
)

69 
as£¹
(
»g_idx
 < 
TheISA
::
Max_Reg_Index
);

70 
RegCÏss
 
	gş
;

71 
	goff£t
;

73 ià(
	g»g_idx
 < 
	gTheISA
::
FP_Reg_Ba£
) {

74 
ş
 = 
IÁRegCÏss
;

75 
	goff£t
 = 0;

76 } ià(
	g»g_idx
 < 
	gTheISA
::
CC_Reg_Ba£
) {

77 
ş
 = 
FlßtRegCÏss
;

78 
	goff£t
 = 
TheISA
::
FP_Reg_Ba£
;

79 } ià(
	g»g_idx
 < 
	gTheISA
::
Misc_Reg_Ba£
) {

83 
ş
 = 
CCRegCÏss
;

84 
	goff£t
 = 
TheISA
::
CC_Reg_Ba£
;

86 
	gş
 = 
MiscRegCÏss
;

87 
	goff£t
 = 
TheISA
::
Misc_Reg_Ba£
;

90 ià(
	g»l_»g_idx
)

91 *
	g»l_»g_idx
 = 
»g_idx
 - 
off£t
;

92  
	gş
;

96 cÚ¡ *
RegCÏssSŒšgs
[];

	@simple/atomic.cc

43 
	~"¬ch/locked_mem.hh
"

44 
	~"¬ch/mm­³d_r.hh
"

45 
	~"¬ch/ut™y.hh
"

46 
	~"ba£/bigšt.hh
"

47 
	~"ba£/ouut.hh
"

48 
	~"cÚfig/the_i§.hh
"

49 
	~"ıu/sim¶e/©omic.hh
"

50 
	~"ıu/ex‘¿û.hh
"

51 
	~"debug/D¿š.hh
"

52 
	~"debug/ExecFauÉšg.hh
"

53 
	~"debug/Sim¶eCPU.hh
"

54 
	~"mem/·ck‘.hh
"

55 
	~"mem/·ck‘_acûss.hh
"

56 
	~"mem/physiÿl.hh
"

57 
	~"·¿ms/AtomicSim¶eCPU.hh
"

58 
	~"sim/çuÉs.hh
"

59 
	~"sim/sy¡em.hh
"

60 
	~"sim/fuÎ_sy¡em.hh
"

62 
usšg
 
Çme¥aû
 
	g¡d
;

63 
usšg
 
Çme¥aû
 
	gTheISA
;

65 
	gAtomicSim¶eCPU
::
TickEv’t
::
	$TickEv’t
(
AtomicSim¶eCPU
 *
c
)

66 : 
	`Ev’t
(
CPU_Tick_Pri
), 
	$ıu
(
c
)

68 
	}
}

72 
	gAtomicSim¶eCPU
::
TickEv’t
::
	$´oûss
()

74 
ıu
->
	`tick
();

75 
	}
}

78 
	gAtomicSim¶eCPU
::
TickEv’t
::
	$desütiÚ
() const

81 
	}
}

84 
	gAtomicSim¶eCPU
::
	$š™
()

86 
Ba£CPU
::
	`š™
();

89 
	`tcBa£
()->
	`š™MemProx›s
(tcBase());

91 ià(
FuÎSy¡em
 && !
	`·¿ms
()->
sw™ched_out
) {

92 
Th»adID
 
size
 = 
th»adCÚ‹xts
.
	`size
();

93 
Th»adID
 
i
 = 0; i < 
size
; ++i) {

94 
Th»adCÚ‹xt
 *
tc
 = 
th»adCÚ‹xts
[
i
];

96 
TheISA
::
	`š™CPU
(
tc
,c->
	`cÚ‹xtId
());

101 
iãtch_»q
.
	`£tTh»adCÚ‹xt
(
_ıuId
, 0);

102 
d©a_»ad_»q
.
	`£tTh»adCÚ‹xt
(
_ıuId
, 0);

103 
d©a_wr™e_»q
.
	`£tTh»adCÚ‹xt
(
_ıuId
, 0);

104 
	}
}

106 
	gAtomicSim¶eCPU
::
	$AtomicSim¶eCPU
(
AtomicSim¶eCPUP¬ams
 *
p
)

107 : 
	`Ba£Sim¶eCPU
(
p
), 
	`tickEv’t
(
this
), 
	`width
Õ->
width
), 
	`locked
(
çl£
),

108 
	`simuÏ‹_d©a_¡®ls
(
p
->
simuÏ‹_d©a_¡®ls
),

109 
	`simuÏ‹_š¡_¡®ls
(
p
->
simuÏ‹_š¡_¡®ls
),

110 
	`d¿š_mªag”
(
NULL
),

111 
	`iÿchePÜt
(
	`Çme
(è+ ".iÿche_pÜt", 
this
),

112 
	`dÿchePÜt
(
	`Çme
(è+ ".dÿche_pÜt", 
this
),

113 
	`ç¡mem
(
p
->
ç¡mem
),

114 
	`simpošt
(
p
->
simpošt_´ofe
),

115 
	`š‹rv®Size
(
p
->
simpošt_š‹rv®
),

116 
	`š‹rv®CouÁ
(0),

117 
	`š‹rv®Driá
(0),

118 
	`simpoštSŒ—m
(
NULL
),

119 
	`cu¼’tBBV
(0, 0),

120 
	$cu¼’tBBVIn¡CouÁ
(0)

122 
_¡©us
 = 
IdË
;

124 ià(
simpošt
) {

125 
simpoštSŒ—m
 = 
simout
.
	`ü—‹
(
p
->
simpošt_´ofe_fe
, 
çl£
);

127 
	}
}

130 
	gAtomicSim¶eCPU
::~
	$AtomicSim¶eCPU
()

132 ià(
tickEv’t
.
	`scheduËd
()) {

133 
	`descheduË
(
tickEv’t
);

135 ià(
simpoštSŒ—m
) {

136 
simout
.
	`şo£
(
simpoštSŒ—m
);

138 
	}
}

141 
	gAtomicSim¶eCPU
::
	$d¿š
(
D¿šMªag”
 *
dm
)

143 
	`as£¹
(!
d¿š_mªag”
);

144 ià(
	`sw™chedOut
())

147 ià(!
	`isD¿šed
()) {

148 
	`DPRINTF
(
D¿š
, "Reque¡šg d¿š: %s\n", 
	`pcS‹
());

149 
d¿š_mªag”
 = 
dm
;

152 ià(
tickEv’t
.
	`scheduËd
())

153 
	`descheduË
(
tickEv’t
);

155 
	`DPRINTF
(
D¿š
, "Notƒxecuting microcode,‚o‚eedo drain.\n");

158 
	}
}

161 
	gAtomicSim¶eCPU
::
	$d¿šResume
()

163 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

164 
	`as£¹
(!
d¿š_mªag”
);

165 ià(
	`sw™chedOut
())

168 
	`DPRINTF
(
Sim¶eCPU
, "Resume\n");

169 
	`v”ifyMemÜyMode
();

171 
	`as£¹
(!
th»adCÚ‹xts
.
	`em±y
());

172 ià(
th»adCÚ‹xts
.
	`size
() > 1)

173 
	`çl
("The‡tomic CPU only supports onehread.\n");

175 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
) {

176 
	`scheduË
(
tickEv’t
, 
	`ÃxtCyşe
());

177 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

178 
nÙIdËF¿ùiÚ
 = 1;

180 
_¡©us
 = 
Ba£Sim¶eCPU
::
IdË
;

181 
nÙIdËF¿ùiÚ
 = 0;

184 
sy¡em
->
tÙ®NumIn¡s
 = 0;

185 
	}
}

187 
boŞ


188 
	gAtomicSim¶eCPU
::
	$ŒyCom¶‘eD¿š
()

190 ià(!
d¿š_mªag”
)

191  
çl£
;

193 
	`DPRINTF
(
D¿š
, "ŒyCom¶‘eD¿š: %s\n", 
	`pcS‹
());

194 ià(!
	`isD¿šed
())

195  
çl£
;

197 
	`DPRINTF
(
D¿š
, "CPU done draining,…rocessing drainƒvent\n");

198 
d¿š_mªag”
->
	`sigÇlD¿šDÚe
();

199 
d¿š_mªag”
 = 
NULL
;

201  
Œue
;

202 
	}
}

206 
	gAtomicSim¶eCPU
::
	$sw™chOut
()

208 
Ba£Sim¶eCPU
::
	`sw™chOut
();

210 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

211 
	`as£¹
(
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
 || _¡©u =ğ
IdË
);

212 
	`as£¹
(
	`isD¿šed
());

213 
	}
}

217 
	gAtomicSim¶eCPU
::
	$keOv”From
(
Ba£CPU
 *
ŞdCPU
)

219 
Ba£Sim¶eCPU
::
	`keOv”From
(
ŞdCPU
);

222 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

224 
iãtch_»q
.
	`£tTh»adCÚ‹xt
(
_ıuId
, 0);

225 
d©a_»ad_»q
.
	`£tTh»adCÚ‹xt
(
_ıuId
, 0);

226 
d©a_wr™e_»q
.
	`£tTh»adCÚ‹xt
(
_ıuId
, 0);

227 
	}
}

230 
	gAtomicSim¶eCPU
::
	$v”ifyMemÜyMode
() const

232 ià(!
sy¡em
->
	`isAtomicMode
()) {

233 
	`çl
("The‡tomic CPU„equireshe memory systemo be in "

236 
	}
}

239 
	gAtomicSim¶eCPU
::
	$aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
)

241 
	`DPRINTF
(
Sim¶eCPU
, "Aùiv©eCÚ‹xˆ%d (%d cyşes)\n", 
th»ad_num
, 
d–ay
);

243 
	`as£¹
(
th»ad_num
 == 0);

244 
	`as£¹
(
th»ad
);

246 
	`as£¹
(
_¡©us
 =ğ
IdË
);

247 
	`as£¹
(!
tickEv’t
.
	`scheduËd
());

249 
nÙIdËF¿ùiÚ
 = 1;

250 
numCyşes
 +ğ
	`ticksToCyşes
(
th»ad
->
Ï¡Aùiv©e
 -h»ad->
Ï¡Su¥’d
);

253 
	`scheduË
(
tickEv’t
, 
	`şockEdge
(
d–ay
));

254 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

255 
	}
}

259 
	gAtomicSim¶eCPU
::
	$su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
)

261 
	`DPRINTF
(
Sim¶eCPU
, "Su¥’dCÚ‹xˆ%d\n", 
th»ad_num
);

263 
	`as£¹
(
th»ad_num
 == 0);

264 
	`as£¹
(
th»ad
);

266 ià(
_¡©us
 =ğ
IdË
)

269 
	`as£¹
(
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
);

273 ià(
tickEv’t
.
	`scheduËd
())

274 
	`descheduË
(
tickEv’t
);

276 
nÙIdËF¿ùiÚ
 = 0;

277 
_¡©us
 = 
IdË
;

278 
	}
}

281 
FauÉ


282 
	gAtomicSim¶eCPU
::
	$»adMem
(
Addr
 
addr
, 
ušt8_t
 * 
d©a
,

283 
size
, 
æags
)

286 
Reque¡
 *
»q
 = &
d©a_»ad_»q
;

288 ià(
ŒaûD©a
) {

289 
ŒaûD©a
->
	`£tAddr
(
addr
);

293 
fuÎSize
 = 
size
;

297 
Addr
 
£cÚdAddr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
	`ÿcheLšeSize
());

299 ià(
£cÚdAddr
 > 
addr
)

300 
size
 = 
£cÚdAddr
 - 
addr
;

302 
dÿche_Ï‹ncy
 = 0;

305 
»q
->
	`£tVœt
(0, 
addr
, 
size
, 
æags
, 
	`d©aMa¡”Id
(), 
th»ad
->
	`pcS‹
().
	`š¡Addr
());

308 
FauÉ
 
çuÉ
 = 
th»ad
->
dtb
->
	`Œª¦©eAtomic
(
»q
, 
tc
, 
Ba£TLB
::
R—d
);

311 ià(
çuÉ
 =ğ
NoFauÉ
 && !
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

312 
Pack‘
 
pkt
 = 
	`Pack‘
(
»q
,

313 
»q
->
	`isLLSC
(è? 
MemCmd
::
LßdLockedReq
 :

314 
MemCmd
::
R—dReq
);

315 
pkt
.
	`d©aStic
(
d©a
);

317 ià(
»q
->
	`isMm­³dI´
())

318 
dÿche_Ï‹ncy
 +ğ
TheISA
::
	`hªdËI´R—d
(
th»ad
->
	`g‘TC
(), &
pkt
);

320 ià(
ç¡mem
 && 
sy¡em
->
	`isMemAddr
(
pkt
.
	`g‘Addr
()))

321 
sy¡em
->
	`g‘PhysMem
().
	`acûss
(&
pkt
);

323 
dÿche_Ï‹ncy
 +ğ
dÿchePÜt
.
	`£ndAtomic
(&
pkt
);

325 
dÿche_acûss
 = 
Œue
;

327 
	`as£¹
(!
pkt
.
	`isE¼Ü
());

329 ià(
»q
->
	`isLLSC
()) {

330 
TheISA
::
	`hªdËLockedR—d
(
th»ad
, 
»q
);

335 ià(
çuÉ
 !ğ
NoFauÉ
) {

336 ià(
»q
->
	`isP»ãtch
()) {

337  
NoFauÉ
;

339  
çuÉ
;

344 ià(
£cÚdAddr
 <ğ
addr
)

346 ià(
»q
->
	`isLocked
(è&& 
çuÉ
 =ğ
NoFauÉ
) {

347 
	`as£¹
(!
locked
);

348 
locked
 = 
Œue
;

350  
çuÉ
;

358 
d©a
 +ğ
size
;

360 
size
 = 
addr
 + 
fuÎSize
 - 
£cÚdAddr
;

362 
addr
 = 
£cÚdAddr
;

364 
	}
}

367 
FauÉ


368 
	gAtomicSim¶eCPU
::
	$wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

369 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
)

372 
Reque¡
 *
»q
 = &
d©a_wr™e_»q
;

374 ià(
ŒaûD©a
) {

375 
ŒaûD©a
->
	`£tAddr
(
addr
);

379 
fuÎSize
 = 
size
;

383 
Addr
 
£cÚdAddr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
	`ÿcheLšeSize
());

385 if(
£cÚdAddr
 > 
addr
)

386 
size
 = 
£cÚdAddr
 - 
addr
;

388 
dÿche_Ï‹ncy
 = 0;

391 
»q
->
	`£tVœt
(0, 
addr
, 
size
, 
æags
, 
	`d©aMa¡”Id
(), 
th»ad
->
	`pcS‹
().
	`š¡Addr
());

394 
FauÉ
 
çuÉ
 = 
th»ad
->
dtb
->
	`Œª¦©eAtomic
(
»q
, 
tc
, 
Ba£TLB
::
Wr™e
);

397 ià(
çuÉ
 =ğ
NoFauÉ
) {

398 
MemCmd
 
cmd
 = MemCmd::
Wr™eReq
;

399 
boŞ
 
do_acûss
 = 
Œue
;

401 ià(
»q
->
	`isLLSC
()) {

402 
cmd
 = 
MemCmd
::
StÜeCÚdReq
;

403 
do_acûss
 = 
TheISA
::
	`hªdËLockedWr™e
(
th»ad
, 
»q
);

404 } ià(
»q
->
	`isSw­
()) {

405 
cmd
 = 
MemCmd
::
Sw­Req
;

406 ià(
»q
->
	`isCÚdSw­
()) {

407 
	`as£¹
(
»s
);

408 
»q
->
	`£tExŒaD©a
(*
»s
);

412 ià(
do_acûss
 && !
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

413 
Pack‘
 
pkt
 = 
	`Pack‘
(
»q
, 
cmd
);

414 
pkt
.
	`d©aStic
(
d©a
);

416 ià(
»q
->
	`isMm­³dI´
()) {

417 
dÿche_Ï‹ncy
 +=

418 
TheISA
::
	`hªdËI´Wr™e
(
th»ad
->
	`g‘TC
(), &
pkt
);

420 ià(
ç¡mem
 && 
sy¡em
->
	`isMemAddr
(
pkt
.
	`g‘Addr
()))

421 
sy¡em
->
	`g‘PhysMem
().
	`acûss
(&
pkt
);

423 
dÿche_Ï‹ncy
 +ğ
dÿchePÜt
.
	`£ndAtomic
(&
pkt
);

425 
dÿche_acûss
 = 
Œue
;

426 
	`as£¹
(!
pkt
.
	`isE¼Ü
());

428 ià(
»q
->
	`isSw­
()) {

429 
	`as£¹
(
»s
);

430 
	`memıy
(
»s
, 
pkt
.
g‘PŒ
<
ušt8_t
>(), 
fuÎSize
);

434 ià(
»s
 && !
»q
->
	`isSw­
()) {

435 *
»s
 = 
»q
->
	`g‘ExŒaD©a
();

441 ià(
çuÉ
 !ğ
NoFauÉ
 || 
£cÚdAddr
 <ğ
addr
)

443 ià(
»q
->
	`isLocked
(è&& 
çuÉ
 =ğ
NoFauÉ
) {

444 
	`as£¹
(
locked
);

445 
locked
 = 
çl£
;

447 ià(
çuÉ
 !ğ
NoFauÉ
 && 
»q
->
	`isP»ãtch
()) {

448  
NoFauÉ
;

450  
çuÉ
;

459 
d©a
 +ğ
size
;

461 
size
 = 
addr
 + 
fuÎSize
 - 
£cÚdAddr
;

463 
addr
 = 
£cÚdAddr
;

465 
	}
}

469 
	gAtomicSim¶eCPU
::
	$tick
()

471 
	`DPRINTF
(
Sim¶eCPU
, "Tick\n");

473 
Tick
 
Ï‹ncy
 = 0;

475 
i
 = 0; i < 
width
 || 
locked
; ++i) {

476 
numCyşes
++;

478 ià(!
curSticIn¡
 || !curSticIn¡->
	`isD–ayedComm™
())

479 
	`checkFÜIÁ”ru±s
();

481 
	`checkPcEv’tQueue
();

483 ià(
_¡©us
 =ğ
IdË
) {

484 
	`ŒyCom¶‘eD¿š
();

488 
FauÉ
 
çuÉ
 = 
NoFauÉ
;

490 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

492 
boŞ
 
ÃedToF‘ch
 = !
	`isRomMiüoPC
(
pcS‹
.
	`miüoPC
()) &&

493 !
curMaüoSticIn¡
;

494 ià(
ÃedToF‘ch
) {

495 
	`£tupF‘chReque¡
(&
iãtch_»q
);

496 
çuÉ
 = 
th»ad
->
™b
->
	`Œª¦©eAtomic
(&
iãtch_»q
, 
tc
,

497 
Ba£TLB
::
Execu‹
);

500 ià(
çuÉ
 =ğ
NoFauÉ
) {

501 
Tick
 
iÿche_Ï‹ncy
 = 0;

502 
boŞ
 
iÿche_acûss
 = 
çl£
;

503 
dÿche_acûss
 = 
çl£
;

505 ià(
ÃedToF‘ch
) {

513 
iÿche_acûss
 = 
Œue
;

514 
Pack‘
 
iãtch_pkt
 = 
	`Pack‘
(&
iãtch_»q
, 
MemCmd
::
R—dReq
);

515 
iãtch_pkt
.
	`d©aStic
(&
š¡
);

517 ià(
ç¡mem
 && 
sy¡em
->
	`isMemAddr
(
iãtch_pkt
.
	`g‘Addr
()))

518 
sy¡em
->
	`g‘PhysMem
().
	`acûss
(&
iãtch_pkt
);

520 
iÿche_Ï‹ncy
 = 
iÿchePÜt
.
	`£ndAtomic
(&
iãtch_pkt
);

522 
	`as£¹
(!
iãtch_pkt
.
	`isE¼Ü
());

529 
	`´eExecu‹
();

531 ià(
curSticIn¡
) {

532 
çuÉ
 = 
curSticIn¡
->
	`execu‹
(
this
, 
ŒaûD©a
);

535 ià(
çuÉ
 =ğ
NoFauÉ
)

536 
	`couÁIn¡
();

537 ià(
ŒaûD©a
 && !
	`DTRACE
(
ExecFauÉšg
)) {

538 
d–‘e
 
ŒaûD©a
;

539 
ŒaûD©a
 = 
NULL
;

542 
	`po¡Execu‹
();

546 ià(
curSticIn¡
 && (!curSticIn¡->
	`isMiüoİ
() ||

547 
curSticIn¡
->
	`isFœ¡Miüoİ
()))

548 
š¡CÁ
++;

551 ià(
simpošt
 && 
curSticIn¡
 && (
çuÉ
 =ğ
NoFauÉ
) &&

552 (!
curSticIn¡
->
	`isMiüoİ
() ||

553 
curSticIn¡
->
	`isLa¡Miüoİ
())) {

554 
	`´ofeSimPošt
();

557 
Tick
 
¡®l_ticks
 = 0;

558 ià(
simuÏ‹_š¡_¡®ls
 && 
iÿche_acûss
)

559 
¡®l_ticks
 +ğ
iÿche_Ï‹ncy
;

561 ià(
simuÏ‹_d©a_¡®ls
 && 
dÿche_acûss
)

562 
¡®l_ticks
 +ğ
dÿche_Ï‹ncy
;

564 ià(
¡®l_ticks
) {

568 
Ï‹ncy
 +ğ
	`divCe
(
¡®l_ticks
, 
	`şockP”iod
()) *

569 
	`şockP”iod
();

573 if(
çuÉ
 !ğ
NoFauÉ
 || !
¡ayAtPC
)

574 
	`advªûPC
(
çuÉ
);

577 ià(
	`ŒyCom¶‘eD¿š
())

581 ià(
Ï‹ncy
 < 
	`şockP”iod
())

582 
Ï‹ncy
 = 
	`şockP”iod
();

584 ià(
_¡©us
 !ğ
IdË
)

585 
	`scheduË
(
tickEv’t
, 
	`curTick
(è+ 
Ï‹ncy
);

586 
	}
}

590 
	gAtomicSim¶eCPU
::
	$´štAddr
(
Addr
 
a
)

592 
dÿchePÜt
.
	`´štAddr
(
a
);

593 
	}
}

596 
	gAtomicSim¶eCPU
::
	$´ofeSimPošt
()

598 ià(!
cu¼’tBBVIn¡CouÁ
)

599 
cu¼’tBBV
.
fœ¡
 = 
th»ad
->
	`pcS‹
().
	`š¡Addr
();

601 ++
š‹rv®CouÁ
;

602 ++
cu¼’tBBVIn¡CouÁ
;

605 ià(
curSticIn¡
->
	`isCÚŒŞ
()) {

606 
cu¼’tBBV
.
£cÚd
 = 
th»ad
->
	`pcS‹
().
	`š¡Addr
();

608 autØ
m­_™r
 = 
bbM­
.
	`fšd
(
cu¼’tBBV
);

609 ià(
m­_™r
 =ğ
bbM­
.
	`’d
()){

612 
BBInfo
 
šfo
;

613 
šfo
.
id
 = 
bbM­
.
	`size
() + 1;

614 
šfo
.
š¡s
 = 
cu¼’tBBVIn¡CouÁ
;

615 
šfo
.
couÁ
 = 
cu¼’tBBVIn¡CouÁ
;

616 
bbM­
.
	`š£¹
(
¡d
::
	`make_·œ
(
cu¼’tBBV
, 
šfo
));

620 
BBInfo
& 
šfo
 = 
m­_™r
->
£cÚd
;

621 
	`as£¹
(
šfo
.
š¡s
 =ğ
cu¼’tBBVIn¡CouÁ
);

622 
šfo
.
couÁ
 +ğ
cu¼’tBBVIn¡CouÁ
;

624 
cu¼’tBBVIn¡CouÁ
 = 0;

629 ià(
š‹rv®CouÁ
 + 
š‹rv®Driá
 >ğ
š‹rv®Size
) {

631 
¡d
::
veùÜ
<
·œ
<
ušt64_t
, ušt64_t> > 
couÁs
;

632 autØ
m­_™r
 = 
bbM­
.
	`begš
(); m­_™¸!ğbbM­.
	`’d
();

633 ++
m­_™r
) {

634 
BBInfo
& 
šfo
 = 
m­_™r
->
£cÚd
;

635 ià(
šfo
.
couÁ
 != 0) {

636 
couÁs
.
	`push_back
(
¡d
::
	`make_·œ
(
šfo
.
id
, info.
couÁ
));

637 
šfo
.
couÁ
 = 0;

640 
¡d
::
	`sÜt
(
couÁs
.
	`begš
(), couÁs.
	`’d
());

643 *
simpoštSŒ—m
 << "T";

644 autØ
út_™r
 = 
couÁs
.
	`begš
(); cÁ_™¸!ğcouÁs.
	`’d
();

645 ++
út_™r
) {

646 *
simpoštSŒ—m
 << ":" << 
út_™r
->
fœ¡


647 << ":" << 
út_™r
->
£cÚd
 << " ";

649 *
simpoštSŒ—m
 << "\n";

651 
š‹rv®Driá
 = (
š‹rv®CouÁ
 + iÁ”v®Driáè- 
š‹rv®Size
;

652 
š‹rv®CouÁ
 = 0;

655 
	}
}

661 
AtomicSim¶eCPU
 *

662 
	gAtomicSim¶eCPUP¬ams
::
	$ü—‹
()

664 
numTh»ads
 = 1;

665 ià(!
FuÎSy¡em
 && 
wÜklßd
.
	`size
() != 1)

666 
	`·nic
("only one workload‡llowed");

667  
Ãw
 
	`AtomicSim¶eCPU
(
this
);

668 
	}
}

	@simple/atomic.hh

43 #iâdeà
__CPU_SIMPLE_ATOMIC_HH__


44 
	#__CPU_SIMPLE_ATOMIC_HH__


	)

46 
	~"ba£/hashm­.hh
"

47 
	~"ıu/sim¶e/ba£.hh
"

48 
	~"·¿ms/AtomicSim¶eCPU.hh
"

56 
	g¡d
::
	t·œ
<
	tAddr
, Addr> 
	tBasicBlockRªge
;

59 
__hash_Çme¥aû_begš


60 
	g‹m¶©e
 <>

61 
	ghash
<
	gBasicBlockRªge
>

63 
	gpublic
:

64 
size_t
 
İ”©Ü
()(cÚ¡ 
BasicBlockRªge
 &
bb
) const {

65  
hash
<
Addr
>()(
bb
.
fœ¡
 + bb.
£cÚd
);

68 
__hash_Çme¥aû_’d


71 şas 
	cAtomicSim¶eCPU
 : 
public
 
Ba£Sim¶eCPU


73 
public
:

75 
AtomicSim¶eCPU
(
AtomicSim¶eCPUP¬ams
 *
·¿ms
);

76 
	mvœtu®
 ~
AtomicSim¶eCPU
();

78 
vœtu®
 
š™
();

80 
	m´iv©e
:

82 
TickEv’t
 : 
public
 
Ev’t


84 
AtomicSim¶eCPU
 *
ıu
;

86 
TickEv’t
(
AtomicSim¶eCPU
 *
c
);

87 
´oûss
();

88 cÚ¡ *
desütiÚ
() const;

91 
TickEv’t
 
	gtickEv’t
;

93 cÚ¡ 
	gwidth
;

94 
boŞ
 
	glocked
;

95 cÚ¡ 
boŞ
 
	gsimuÏ‹_d©a_¡®ls
;

96 cÚ¡ 
boŞ
 
	gsimuÏ‹_š¡_¡®ls
;

103 
D¿šMªag”
 *
	gd¿š_mªag”
;

106 
tick
();

126 
boŞ
 
	$isD¿šed
() {

127  
	`miüoPC
() == 0 &&

128 !
locked
 &&

129 !
¡ayAtPC
;

130 
	}
}

137 
boŞ
 
ŒyCom¶‘eD¿š
();

145 şas 
	cAtomicCPUPÜt
 : 
public
 
Ma¡”PÜt


148 
public
:

150 
AtomicCPUPÜt
(cÚ¡ 
¡d
::
¡ršg
 &
_Çme
, 
Ba£CPU
* 
_ıu
)

151 : 
Ma¡”PÜt
(
_Çme
, 
_ıu
)

154 
	g´Ùeùed
:

156 
vœtu®
 
Tick
 
»cvAtomicSnoİ
(
Pack‘PŒ
 
pkt
)

162 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

164 
·nic
("Atomic CPU doesn'tƒxpect„ecvTimingResp!\n");

165  
	gŒue
;

168 
»cvR‘ry
()

170 
·nic
("Atomic CPU doesn'tƒxpect„ecvRetry!\n");

175 
AtomicCPUPÜt
 
	giÿchePÜt
;

176 
AtomicCPUPÜt
 
	gdÿchePÜt
;

178 
boŞ
 
	gç¡mem
;

179 
Reque¡
 
	giãtch_»q
;

180 
Reque¡
 
	gd©a_»ad_»q
;

181 
Reque¡
 
	gd©a_wr™e_»q
;

183 
boŞ
 
	gdÿche_acûss
;

184 
Tick
 
	gdÿche_Ï‹ncy
;

191 
´ofeSimPošt
();

198 cÚ¡ 
boŞ
 
	gsimpošt
;

200 cÚ¡ 
ušt64_t
 
	gš‹rv®Size
;

203 
ušt64_t
 
	gš‹rv®CouÁ
;

205 
ušt64_t
 
	gš‹rv®Driá
;

207 
	g¡d
::
o¡»am
 *
simpoštSŒ—m
;

210 
	sBBInfo
 {

212 
ušt64_t
 
	gid
;

214 
ušt64_t
 
	gš¡s
;

216 
ušt64_t
 
	gcouÁ
;

220 
	gm5
::
hash_m­
<
BasicBlockRªge
, 
	gBBInfo
> 
	gbbM­
;

222 
BasicBlockRªge
 
	gcu¼’tBBV
;

224 
ušt64_t
 
	gcu¼’tBBVIn¡CouÁ
;

230 
	g´Ùeùed
:

233 
vœtu®
 
Ma¡”PÜt
 &
	$g‘D©aPÜt
(è{  
dÿchePÜt
; 
	}
}

236 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘In¡PÜt
(è{  
iÿchePÜt
; 
	}
}

238 
	gpublic
:

240 
d¿š
(
D¿šMªag”
 *
d¿š_mªag”
);

241 
d¿šResume
();

243 
sw™chOut
();

244 
keOv”From
(
Ba£CPU
 *
ŞdCPU
);

246 
	$v”ifyMemÜyMode
() const;

248 
vœtu®
 
	`aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
);

249 
vœtu®
 
	`su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
);

251 
FauÉ
 
	`»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
);

253 
FauÉ
 
	`wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

254 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

260 
	`´štAddr
(
Addr
 
a
);

261 
	}
};

	@simple/base.cc

44 
	~"¬ch/k”Ãl_¡©s.hh
"

45 
	~"¬ch/¡ackŒaû.hh
"

46 
	~"¬ch/b.hh
"

47 
	~"¬ch/ut™y.hh
"

48 
	~"¬ch/vtİhys.hh
"

49 
	~"ba£/lßd”/symb.hh
"

50 
	~"ba£/ı_ªnÙ©e.hh
"

51 
	~"ba£/ırštf.hh
"

52 
	~"ba£/šife.hh
"

53 
	~"ba£/misc.hh
"

54 
	~"ba£/pŞËv’t.hh
"

55 
	~"ba£/Œaû.hh
"

56 
	~"ba£/ty³s.hh
"

57 
	~"cÚfig/the_i§.hh
"

58 
	~"ıu/sim¶e/ba£.hh
"

59 
	~"ıu/ba£.hh
"

60 
	~"ıu/check”/ıu.hh
"

61 
	~"ıu/check”/th»ad_cÚ‹xt.hh
"

62 
	~"ıu/ex‘¿û.hh
"

63 
	~"ıu/´ofe.hh
"

64 
	~"ıu/sim¶e_th»ad.hh
"

65 
	~"ıu/smt.hh
"

66 
	~"ıu/¡©ic_š¡.hh
"

67 
	~"ıu/th»ad_cÚ‹xt.hh
"

68 
	~"debug/Decode.hh
"

69 
	~"debug/F‘ch.hh
"

70 
	~"debug/Qu›sû.hh
"

71 
	~"mem/mem_objeù.hh
"

72 
	~"mem/·ck‘.hh
"

73 
	~"mem/»que¡.hh
"

74 
	~"·¿ms/Ba£Sim¶eCPU.hh
"

75 
	~"sim/by‹sw­.hh
"

76 
	~"sim/debug.hh
"

77 
	~"sim/çuÉs.hh
"

78 
	~"sim/fuÎ_sy¡em.hh
"

79 
	~"sim/sim_ev’ts.hh
"

80 
	~"sim/sim_objeù.hh
"

81 
	~"sim/¡©s.hh
"

82 
	~"sim/sy¡em.hh
"

84 
usšg
 
Çme¥aû
 
	g¡d
;

85 
usšg
 
Çme¥aû
 
	gTheISA
;

87 
	gBa£Sim¶eCPU
::
	$Ba£Sim¶eCPU
(
Ba£Sim¶eCPUP¬ams
 *
p
)

88 : 
	`Ba£CPU
(
p
), 
	`ŒaûD©a
(
NULL
), 
	$th»ad
(
NULL
)

90 ià(
FuÎSy¡em
)

91 
th»ad
 = 
Ãw
 
	`Sim¶eTh»ad
(
this
, 0, 
p
->
sy¡em
,…->
™b
,…->
dtb
,

92 
p
->
i§
[0]);

94 
th»ad
 = 
Ãw
 
	`Sim¶eTh»ad
(
this
, 0, 
p
->
sy¡em
,

95 
p
->
wÜklßd
[0],…->
™b
,…->
dtb
,…->
i§
[0]);

97 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
H®‹d
);

99 
tc
 = 
th»ad
->
	`g‘TC
();

101 ià(
p
->
check”
) {

102 
Ba£CPU
 *
‹mp_check”
 = 
p
->
check”
;

103 
check”
 = 
dyÇmic_ÿ¡
<
Check”CPU
 *>(
‹mp_check”
);

104 
check”
->
	`£tSy¡em
(
p
->
sy¡em
);

106 
Th»adCÚ‹xt
 *
ıu_tc
 = 
tc
;

107 
tc
 = 
Ãw
 
Check”Th»adCÚ‹xt
<
Th»adCÚ‹xt
>(
ıu_tc
, 
this
->
check”
);

109 
check”
 = 
NULL
;

112 
numIn¡
 = 0;

113 
¡¬tNumIn¡
 = 0;

114 
numOp
 = 0;

115 
¡¬tNumOp
 = 0;

116 
numLßd
 = 0;

117 
¡¬tNumLßd
 = 0;

118 
Ï¡IÿcheSÎ
 = 0;

119 
Ï¡DÿcheSÎ
 = 0;

121 
th»adCÚ‹xts
.
	`push_back
(
tc
);

124 
ãtchOff£t
 = 0;

125 
¡ayAtPC
 = 
çl£
;

126 
	}
}

128 
	gBa£Sim¶eCPU
::~
	$Ba£Sim¶eCPU
()

130 
	}
}

133 
Ba£Sim¶eCPU
::
	$d—Îoÿ‹CÚ‹xt
(
Th»adID
 
th»ad_num
)

136 
	`su¥’dCÚ‹xt
(
th»ad_num
);

137 
	}
}

141 
	gBa£Sim¶eCPU
::
	$h®tCÚ‹xt
(
Th»adID
 
th»ad_num
)

144 
	`su¥’dCÚ‹xt
(
th»ad_num
);

145 
	}
}

149 
	gBa£Sim¶eCPU
::
	$»gSts
()

151 
usšg
 
Çme¥aû
 
Sts
;

153 
Ba£CPU
::
	`»gSts
();

155 
numIn¡s


156 .
	`Çme
(name() + ".committedInsts")

157 .
	`desc
("Number of instructions committed")

160 
numOps


161 .
	`Çme
(name() + ".committedOps")

162 .
	`desc
("Number of ops (including micro ops) committed")

165 
numIÁAluAcûs£s


166 .
	`Çme
(name() + ".num_int_alu_accesses")

167 .
	`desc
("Number of integer‡lu‡ccesses")

170 
numFpAluAcûs£s


171 .
	`Çme
(name() + ".num_fp_alu_accesses")

172 .
	`desc
("Number of float‡lu‡ccesses")

175 
numC®lsR‘uºs


176 .
	`Çme
(name() + ".num_func_calls")

177 .
	`desc
("number ofimes‡ function call or„eturn occured")

180 
numCÚdCŒlIn¡s


181 .
	`Çme
(name() + ".num_conditional_control_insts")

182 .
	`desc
("number of instructionshat‡re conditional controls")

185 
numIÁIn¡s


186 .
	`Çme
(name() + ".num_int_insts")

187 .
	`desc
("number of integer instructions")

190 
numFpIn¡s


191 .
	`Çme
(name() + ".num_fp_insts")

192 .
	`desc
("number of float instructions")

195 
numIÁRegR—ds


196 .
	`Çme
(name() + ".num_int_register_reads")

197 .
	`desc
("number ofimeshe integer„egisters were„ead")

200 
numIÁRegWr™es


201 .
	`Çme
(name() + ".num_int_register_writes")

202 .
	`desc
("number ofimeshe integer„egisters were written")

205 
numFpRegR—ds


206 .
	`Çme
(name() + ".num_fp_register_reads")

207 .
	`desc
("number ofimeshe floating„egisters were„ead")

210 
numFpRegWr™es


211 .
	`Çme
(name() + ".num_fp_register_writes")

212 .
	`desc
("number ofimeshe floating„egisters were written")

215 
numCCRegR—ds


216 .
	`Çme
(name() + ".num_cc_register_reads")

217 .
	`desc
("number ofimeshe CC„egisters were„ead")

218 .
	`æags
(
noz”o
)

221 
numCCRegWr™es


222 .
	`Çme
(name() + ".num_cc_register_writes")

223 .
	`desc
("number ofimeshe CC„egisters were written")

224 .
	`æags
(
noz”o
)

227 
numMemRefs


228 .
	`Çme
(name()+".num_mem_refs")

229 .
	`desc
("number of memory„efs")

232 
numStÜeIn¡s


233 .
	`Çme
(name() + ".num_store_insts")

234 .
	`desc
("Number of store instructions")

237 
numLßdIn¡s


238 .
	`Çme
(name() + ".num_load_insts")

239 .
	`desc
("Number of†oad instructions")

242 
nÙIdËF¿ùiÚ


243 .
	`Çme
(name() + ".not_idle_fraction")

244 .
	`desc
("Percentage of‚on-idle cycles")

247 
idËF¿ùiÚ


248 .
	`Çme
(name() + ".idle_fraction")

249 .
	`desc
("Percentage of idle cycles")

252 
numBusyCyşes


253 .
	`Çme
(name() + ".num_busy_cycles")

254 .
	`desc
("Number of busy cycles")

257 
numIdËCyşes


258 .
	`Çme
(name()+".num_idle_cycles")

259 .
	`desc
("Number of idle cycles")

262 
iÿcheSÎCyşes


263 .
	`Çme
(name() + ".icache_stall_cycles")

264 .
	`desc
("ICacheotal stall cycles")

265 .
	`´”eq
(
iÿcheSÎCyşes
)

268 
dÿcheSÎCyşes


269 .
	`Çme
(name() + ".dcache_stall_cycles")

270 .
	`desc
("DCacheotal stall cycles")

271 .
	`´”eq
(
dÿcheSÎCyşes
)

274 
iÿcheR‘ryCyşes


275 .
	`Çme
(name() + ".icache_retry_cycles")

276 .
	`desc
("ICacheotal„etry cycles")

277 .
	`´”eq
(
iÿcheR‘ryCyşes
)

280 
dÿcheR‘ryCyşes


281 .
	`Çme
(name() + ".dcache_retry_cycles")

282 .
	`desc
("DCacheotal„etry cycles")

283 .
	`´”eq
(
dÿcheR‘ryCyşes
)

286 
idËF¿ùiÚ
 = 
	`cÚ¡ªt
(1.0è- 
nÙIdËF¿ùiÚ
;

287 
numIdËCyşes
 = 
idËF¿ùiÚ
 * 
numCyşes
;

288 
numBusyCyşes
 = (
nÙIdËF¿ùiÚ
)*
numCyşes
;

289 
	}
}

292 
	gBa£Sim¶eCPU
::
	$»£tSts
()

295 
nÙIdËF¿ùiÚ
 = (
_¡©us
 !ğ
IdË
);

296 
	}
}

299 
	gBa£Sim¶eCPU
::
	$£rŸlizeTh»ad
(
o¡»am
 &
os
, 
Th»adID
 
tid
)

301 
	`as£¹
(
_¡©us
 =ğ
IdË
 || _¡©u =ğ
RuÂšg
);

302 
	`as£¹
(
tid
 == 0);

304 
th»ad
->
	`£rŸlize
(
os
);

305 
	}
}

308 
	gBa£Sim¶eCPU
::
	$un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡ršg
 &
£ùiÚ
,

309 
Th»adID
 
tid
)

311 ià(
tid
 != 0)

312 
	`çl
("Tryingo†oad morehan onehread into‡ SimpleCPU\n");

313 
th»ad
->
	`un£rŸlize
(
ı
, 
£ùiÚ
);

314 
	}
}

317 
	$chªge_th»ad_¡©e
(
Th»adID
 
tid
, 
aùiv©e
, 
´iÜ™y
)

319 
	}
}

321 
Addr


322 
	gBa£Sim¶eCPU
::
	$dbg_vtİhys
(
Addr
 
addr
)

324  
	`vtİhys
(
tc
, 
addr
);

325 
	}
}

328 
	gBa£Sim¶eCPU
::
	$wakeup
()

330 ià(
th»ad
->
	`¡©us
(è!ğ
Th»adCÚ‹xt
::
Su¥’ded
)

333 
	`DPRINTF
(
Qu›sû
,"Suspended Processor‡woke\n");

334 
th»ad
->
	`aùiv©e
();

335 
	}
}

338 
	gBa£Sim¶eCPU
::
	$checkFÜIÁ”ru±s
()

340 ià(
	`checkIÁ”ru±s
(
tc
)) {

341 
FauÉ
 
š‹¼u±
 = 
š‹¼u±s
->
	`g‘IÁ”ru±
(
tc
);

343 ià(
š‹¼u±
 !ğ
NoFauÉ
) {

344 
ãtchOff£t
 = 0;

345 
š‹¼u±s
->
	`upd©eIÁrInfo
(
tc
);

346 
š‹¼u±
->
	`švoke
(
tc
);

347 
th»ad
->
decod”
.
	`»£t
();

350 
	}
}

354 
	gBa£Sim¶eCPU
::
	$£tupF‘chReque¡
(
Reque¡
 *
»q
)

356 
Addr
 
š¡Addr
 = 
th»ad
->
	`š¡Addr
();

359 
	`DPRINTF
(
F‘ch
, "F‘ch: PC:%08p\n", 
š¡Addr
);

361 
Addr
 
ãtchPC
 = (
š¡Addr
 & 
PCMask
è+ 
ãtchOff£t
;

362 
»q
->
	`£tVœt
(0, 
ãtchPC
, (
MachIn¡
), 
Reque¡
::
INST_FETCH
, 
	`š¡Ma¡”Id
(),

363 
š¡Addr
);

364 
	}
}

368 
	gBa£Sim¶eCPU
::
	$´eExecu‹
()

371 
th»ad
->
	`£tIÁReg
(
Z”oReg
, 0);

372 #ià
THE_ISA
 =ğ
ALPHA_ISA


373 
th»ad
->
	`£tFlßtReg
(
Z”oReg
, 0.0);

377 
comIn¡Ev’tQueue
[0]->
	`£rviûEv’ts
(
numIn¡
);

378 
sy¡em
->
š¡Ev’tQueue
.
	`£rviûEv’ts
(sy¡em->
tÙ®NumIn¡s
);

381 
š¡
 = 
	`gtoh
(inst);

383 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

385 ià(
	`isRomMiüoPC
(
pcS‹
.
	`miüoPC
())) {

386 
¡ayAtPC
 = 
çl£
;

387 
curSticIn¡
 = 
miüocodeRom
.
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
(),

388 
curMaüoSticIn¡
);

389 } ià(!
curMaüoSticIn¡
) {

391 
SticIn¡PŒ
 
š¡PŒ
 = 
NULL
;

393 
TheISA
::
Decod”
 *
decod”
 = &(
th»ad
->decoder);

397 
Addr
 
ãtchPC
 = (
pcS‹
.
	`š¡Addr
(è& 
PCMask
è+ 
ãtchOff£t
;

399 
decod”
->
	`mÜeBy‹s
(
pcS‹
, 
ãtchPC
, 
š¡
);

405 
š¡PŒ
 = 
decod”
->
	`decode
(
pcS‹
);

406 ià(
š¡PŒ
) {

407 
¡ayAtPC
 = 
çl£
;

408 
th»ad
->
	`pcS‹
(
pcS‹
);

410 
¡ayAtPC
 = 
Œue
;

411 
ãtchOff£t
 +ğ(
MachIn¡
);

416 ià(
š¡PŒ
 && in¡PŒ->
	`isMaüoİ
()) {

417 
curMaüoSticIn¡
 = 
š¡PŒ
;

418 
curSticIn¡
 = 
curMaüoSticIn¡
->
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
());

420 
curSticIn¡
 = 
š¡PŒ
;

424 
curSticIn¡
 = 
curMaüoSticIn¡
->
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
());

428 ià(
curSticIn¡
) {

429 #ià
TRACING_ON


430 
ŒaûD©a
 = 
Œaûr
->
	`g‘In¡RecÜd
(
	`curTick
(), 
tc
,

431 
curSticIn¡
, 
th»ad
->
	`pcS‹
(), 
curMaüoSticIn¡
);

433 
	`DPRINTF
(
Decode
,"Decode: Decoded %s instruction: %#x\n",

434 
curSticIn¡
->
	`g‘Name
(), curSticIn¡->
machIn¡
);

437 
	}
}

440 
	gBa£Sim¶eCPU
::
	$po¡Execu‹
()

442 
	`as£¹
(
curSticIn¡
);

444 
TheISA
::
PCS‹
 
pc
 = 
tc
->
	`pcS‹
();

445 
Addr
 
š¡Addr
 = 
pc
.
	`š¡Addr
();

446 ià(
FuÎSy¡em
 && 
th»ad
->
´ofe
) {

447 
boŞ
 
u£rmode
 = 
TheISA
::
	`šU£rMode
(
tc
);

448 
th»ad
->
´ofePC
 = 
u£rmode
 ? 1 : 
š¡Addr
;

449 
ProfeNode
 *
node
 = 
th»ad
->
´ofe
->
	`cÚsume
(
tc
, 
curSticIn¡
);

450 ià(
node
)

451 
th»ad
->
´ofeNode
 = 
node
;

454 ià(
curSticIn¡
->
	`isMemRef
()) {

455 
numMemRefs
++;

458 ià(
curSticIn¡
->
	`isLßd
()) {

459 ++
numLßd
;

460 
comLßdEv’tQueue
[0]->
	`£rviûEv’ts
(
numLßd
);

463 ià(
CPA
::
	`avaabË
()) {

464 
CPA
::
	`ıa
()->
	`swAutoBegš
(
tc
, 
pc
.
	`ÃxtIn¡Addr
());

469 ià(
curSticIn¡
->
	`isIÁeg”
()){

470 
numIÁAluAcûs£s
++;

471 
numIÁIn¡s
++;

475 ià(
curSticIn¡
->
	`isFlßtšg
()){

476 
numFpAluAcûs£s
++;

477 
numFpIn¡s
++;

481 ià(
curSticIn¡
->
	`isC®l
(è|| curSticIn¡->
	`isR‘uº
()){

482 
numC®lsR‘uºs
++;

486 ià(
curSticIn¡
->
	`isCÚdCŒl
()){

487 
numCÚdCŒlIn¡s
++;

491 ià(
curSticIn¡
->
	`isLßd
()){

492 
numLßdIn¡s
++;

495 ià(
curSticIn¡
->
	`isStÜe
()){

496 
numStÜeIn¡s
++;

500 ià(
FuÎSy¡em
)

501 
	`ŒaûFunùiÚs
(
š¡Addr
);

503 ià(
ŒaûD©a
) {

504 
ŒaûD©a
->
	`dump
();

505 
d–‘e
 
ŒaûD©a
;

506 
ŒaûD©a
 = 
NULL
;

508 
	}
}

512 
	gBa£Sim¶eCPU
::
	$advªûPC
(
FauÉ
 
çuÉ
)

515 
ãtchOff£t
 = 0;

516 ià(
çuÉ
 !ğ
NoFauÉ
) {

517 
curMaüoSticIn¡
 = 
SticIn¡
::
nuÎSticIn¡PŒ
;

518 
çuÉ
->
	`švoke
(
tc
, 
curSticIn¡
);

519 
th»ad
->
decod”
.
	`»£t
();

521 ià(
curSticIn¡
) {

522 ià(
curSticIn¡
->
	`isLa¡Miüoİ
())

523 
curMaüoSticIn¡
 = 
SticIn¡
::
nuÎSticIn¡PŒ
;

524 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

525 
TheISA
::
	`advªûPC
(
pcS‹
, 
curSticIn¡
);

526 
th»ad
->
	`pcS‹
(
pcS‹
);

529 
	}
}

532 
	gBa£Sim¶eCPU
::
	$¡¬tup
()

534 
Ba£CPU
::
	`¡¬tup
();

535 
th»ad
->
	`¡¬tup
();

536 
	}
}

	@simple/base.hh

46 #iâdeà
__CPU_SIMPLE_BASE_HH__


47 
	#__CPU_SIMPLE_BASE_HH__


	)

49 
	~"ba£/¡©i¡ics.hh
"

50 
	~"cÚfig/the_i§.hh
"

51 
	~"ıu/ba£.hh
"

52 
	~"ıu/check”/ıu.hh
"

53 
	~"ıu/pc_ev’t.hh
"

54 
	~"ıu/sim¶e_th»ad.hh
"

55 
	~"ıu/¡©ic_š¡.hh
"

56 
	~"mem/·ck‘.hh
"

57 
	~"mem/pÜt.hh
"

58 
	~"mem/»que¡.hh
"

59 
	~"sim/ev’tq.hh
"

60 
	~"sim/fuÎ_sy¡em.hh
"

61 
	~"sim/sy¡em.hh
"

64 
şass
 
	gCheckpošt
;

65 
şass
 
	gProûss
;

66 
şass
 
	gProûssÜ
;

67 
şass
 
	gTh»adCÚ‹xt
;

69 
Çme¥aû
 
	gTheISA


71 
şass
 
	gDTB
;

72 
şass
 
	gITB
;

75 
Çme¥aû
 
	gT¿û
 {

76 
şass
 
	gIn¡RecÜd
;

79 
	gBa£Sim¶eCPUP¬ams
;

82 şas 
	cBa£Sim¶eCPU
 : 
public
 
Ba£CPU


84 
´Ùeùed
:

85 
TheISA
::
	tMiscReg
 MiscReg;

86 
	mTheISA
::
	tFlßtReg
 FloatReg;

87 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

88 
	mTheISA
::
	tCCReg
 CCReg;

90 
	m´Ùeùed
:

91 
T¿û
::
In¡RecÜd
 *
ŒaûD©a
;

93 
šlše
 
	$checkPcEv’tQueue
() {

94 
Addr
 
Şdpc
, 
pc
 = 
th»ad
->
	`š¡Addr
();

96 
Şdpc
 = 
pc
;

97 
sy¡em
->
pcEv’tQueue
.
	`£rviû
(
tc
);

98 
pc
 = 
th»ad
->
	`š¡Addr
();

99 } 
Şdpc
 !ğ
pc
);

102 
public
:

103 
	`wakeup
();

105 
	$z”o_fl_64
(
Addr
 
addr
) {

106 
w¬Ãd
 = 0;

107 ià(!
w¬Ãd
) {

108 
	`w¬n
 ("WH64 is‚ot implemented");

109 
w¬Ãd
 = 1;

111 
	}
};

113 
	gpublic
:

114 
Ba£Sim¶eCPU
(
Ba£Sim¶eCPUP¬ams
 *
·¿ms
);

115 
	gvœtu®
 ~
Ba£Sim¶eCPU
();

117 
	gpublic
:

119 
Sim¶eTh»ad
 *
th»ad
;

124 
Th»adCÚ‹xt
 *
	gtc
;

126 
Check”CPU
 *
	gcheck”
;

128 
	g´Ùeùed
:

130 
	eStus
 {

131 
IdË
,

132 
	gRuÂšg
,

133 
	gFauÉšg
,

134 
	gITBWa™Re¥Ú£
,

135 
	gIÿcheR‘ry
,

136 
	gIÿcheWa™Re¥Ú£
,

137 
	gIÿcheWa™Sw™ch
,

138 
	gDTBWa™Re¥Ú£
,

139 
	gDÿcheR‘ry
,

140 
	gDÿcheWa™Re¥Ú£
,

141 
	gDÿcheWa™Sw™ch
,

144 
Stus
 
	g_¡©us
;

146 
	gpublic
:

148 
Addr
 
dbg_vtİhys
(Add¸
addr
);

150 
boŞ
 
	gš‹rv®_¡©s
;

153 
	gTheISA
::
MachIn¡
 
š¡
;

155 
SticIn¡PŒ
 
	gcurSticIn¡
;

156 
SticIn¡PŒ
 
	gcurMaüoSticIn¡
;

159 
Addr
 
	gãtchOff£t
;

162 
boŞ
 
	g¡ayAtPC
;

164 
checkFÜIÁ”ru±s
();

165 
£tupF‘chReque¡
(
Reque¡
 *
»q
);

166 
´eExecu‹
();

167 
po¡Execu‹
();

168 
advªûPC
(
FauÉ
 
çuÉ
);

170 
vœtu®
 
d—Îoÿ‹CÚ‹xt
(
Th»adID
 
th»ad_num
);

171 
vœtu®
 
h®tCÚ‹xt
(
Th»adID
 
th»ad_num
);

174 
vœtu®
 
»gSts
();

175 
vœtu®
 
»£tSts
();

177 
vœtu®
 
¡¬tup
();

180 
CouÁ”
 
	gnumIn¡
;

181 
CouÁ”
 
	g¡¬tNumIn¡
;

182 
	gSts
::
SÿÏr
 
numIn¡s
;

183 
CouÁ”
 
	gnumOp
;

184 
CouÁ”
 
	g¡¬tNumOp
;

185 
	gSts
::
SÿÏr
 
numOps
;

187 
	$couÁIn¡
()

189 ià(!
curSticIn¡
->
	`isMiüoİ
(è|| curSticIn¡->
	`isLa¡Miüoİ
()) {

190 
numIn¡
++;

191 
numIn¡s
++;

193 
numOp
++;

194 
numOps
++;

196 
sy¡em
->
tÙ®NumIn¡s
++;

197 
th»ad
->
funcExeIn¡
++;

198 
	}
}

200 
vœtu®
 
CouÁ”
 
	$tÙ®In¡s
() const

202  
numIn¡
 - 
¡¬tNumIn¡
;

203 
	}
}

205 
vœtu®
 
CouÁ”
 
	$tÙ®Ops
() const

207  
numOp
 - 
¡¬tNumOp
;

208 
	}
}

211 
	gSts
::
SÿÏr
 
numIÁAluAcûs£s
;

214 
	gSts
::
SÿÏr
 
numFpAluAcûs£s
;

217 
	gSts
::
SÿÏr
 
numC®lsR‘uºs
;

220 
	gSts
::
SÿÏr
 
numCÚdCŒlIn¡s
;

223 
	gSts
::
SÿÏr
 
numIÁIn¡s
;

226 
	gSts
::
SÿÏr
 
numFpIn¡s
;

229 
	gSts
::
SÿÏr
 
numIÁRegR—ds
;

230 
	gSts
::
SÿÏr
 
numIÁRegWr™es
;

233 
	gSts
::
SÿÏr
 
numFpRegR—ds
;

234 
	gSts
::
SÿÏr
 
numFpRegWr™es
;

237 
	gSts
::
SÿÏr
 
numCCRegR—ds
;

238 
	gSts
::
SÿÏr
 
numCCRegWr™es
;

241 
	gSts
::
SÿÏr
 
numMemRefs
;

242 
	gSts
::
SÿÏr
 
numLßdIn¡s
;

243 
	gSts
::
SÿÏr
 
numStÜeIn¡s
;

246 
	gSts
::
FÜmuÏ
 
numIdËCyşes
;

249 
	gSts
::
FÜmuÏ
 
numBusyCyşes
;

252 
CouÁ”
 
	gnumLßd
;

253 
CouÁ”
 
	g¡¬tNumLßd
;

256 
	gSts
::
Av”age
 
nÙIdËF¿ùiÚ
;

257 
	gSts
::
FÜmuÏ
 
idËF¿ùiÚ
;

260 
	gSts
::
SÿÏr
 
iÿcheSÎCyşes
;

261 
CouÁ”
 
	gÏ¡IÿcheSÎ
;

264 
	gSts
::
SÿÏr
 
iÿcheR‘ryCyşes
;

265 
CouÁ”
 
	gÏ¡IÿcheR‘ry
;

268 
	gSts
::
SÿÏr
 
dÿcheSÎCyşes
;

269 
CouÁ”
 
	gÏ¡DÿcheSÎ
;

272 
	gSts
::
SÿÏr
 
dÿcheR‘ryCyşes
;

273 
CouÁ”
 
	gÏ¡DÿcheR‘ry
;

275 
£rŸlizeTh»ad
(
¡d
::
o¡»am
 &
os
, 
Th»adID
 
tid
);

276 
un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
,

277 
Th»adID
 
tid
);

281 
	$£tEA
(
Addr
 
EA
è{ 
	`·nic
("Ba£Sim¶eCPU::£tEA(ènÙ im¶em’‹d\n"); 
	}
}

282 
Addr
 
	$g‘EA
(è{ 
	`·nic
("BaseSimpleCPU::getEA()‚ot implemented\n");

283 
M5_DUMMY_RETURN
}

296 
ušt64_t
 
	$»adIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

298 
numIÁRegR—ds
++;

299  
th»ad
->
	`»adIÁReg
(
si
->
	`¤cRegIdx
(
idx
));

300 
	}
}

302 
FlßtReg
 
	$»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

304 
numFpRegR—ds
++;

305 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

306  
th»ad
->
	`»adFlßtReg
(
»g_idx
);

307 
	}
}

309 
FlßtRegB™s
 
	$»adFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

311 
numFpRegR—ds
++;

312 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

313  
th»ad
->
	`»adFlßtRegB™s
(
»g_idx
);

314 
	}
}

316 
CCReg
 
	$»adCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

318 
numCCRegR—ds
++;

319 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
CC_Reg_Ba£
;

320  
th»ad
->
	`»adCCReg
(
»g_idx
);

321 
	}
}

323 
	$£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

325 
numIÁRegWr™es
++;

326 
th»ad
->
	`£tIÁReg
(
si
->
	`de¡RegIdx
(
idx
), 
v®
);

327 
	}
}

329 
	$£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
)

331 
numFpRegWr™es
++;

332 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

333 
th»ad
->
	`£tFlßtReg
(
»g_idx
, 
v®
);

334 
	}
}

336 
	$£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

337 
FlßtRegB™s
 
v®
)

339 
numFpRegWr™es
++;

340 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

341 
th»ad
->
	`£tFlßtRegB™s
(
»g_idx
, 
v®
);

342 
	}
}

344 
	$£tCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
CCReg
 
v®
)

346 
numCCRegWr™es
++;

347 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
CC_Reg_Ba£
;

348 
th»ad
->
	`£tCCReg
(
»g_idx
, 
v®
);

349 
	}
}

351 
boŞ
 
	$»adP»diÿ‹
(è{  
th»ad
->
	`»adP»diÿ‹
(); 
	}
}

352 
	$£tP»diÿ‹
(
boŞ
 
v®
)

354 
th»ad
->
	`£tP»diÿ‹
(
v®
);

355 ià(
ŒaûD©a
) {

356 
ŒaûD©a
->
	`£tP»diÿ‹
(
v®
);

358 
	}
}

359 
	gTheISA
::
PCS‹
 
	$pcS‹
(è{  
th»ad
->
	`pcS‹
(); 
	}
}

360 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
è{ 
th»ad
->pcState(val); }

361 
Addr
 
	$š¡Addr
(è{  
th»ad
->
	`š¡Addr
(); 
	}
}

362 
Addr
 
	$ÃxtIn¡Addr
(è{  
th»ad
->
	`ÃxtIn¡Addr
(); 
	}
}

363 
MiüoPC
 
	$miüoPC
(è{  
th»ad
->
	`miüoPC
(); 
	}
}

365 
MiscReg
 
	$»adMiscRegNoEfãù
(
misc_»g
)

367  
th»ad
->
	`»adMiscRegNoEfãù
(
misc_»g
);

368 
	}
}

370 
MiscReg
 
	$»adMiscReg
(
misc_»g
)

372 
numIÁRegR—ds
++;

373  
th»ad
->
	`»adMiscReg
(
misc_»g
);

374 
	}
}

376 
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

378 
numIÁRegWr™es
++;

379  
th»ad
->
	`£tMiscReg
(
misc_»g
, 
v®
);

380 
	}
}

382 
MiscReg
 
	$»adMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

384 
numIÁRegR—ds
++;

385 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
Misc_Reg_Ba£
;

386  
th»ad
->
	`»adMiscReg
(
»g_idx
);

387 
	}
}

389 
	$£tMiscRegO³¿nd
(

390 cÚ¡ 
SticIn¡
 *
si
, 
idx
, cÚ¡ 
MiscReg
 &
v®
)

392 
numIÁRegWr™es
++;

393 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
Misc_Reg_Ba£
;

394  
th»ad
->
	`£tMiscReg
(
»g_idx
, 
v®
);

395 
	}
}

397 
	$dem­Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

399 
th»ad
->
	`dem­Page
(
vaddr
, 
a¢
);

400 
	}
}

402 
	$dem­In¡Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

404 
th»ad
->
	`dem­In¡Page
(
vaddr
, 
a¢
);

405 
	}
}

407 
	$dem­D©aPage
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

409 
th»ad
->
	`dem­D©aPage
(
vaddr
, 
a¢
);

410 
	}
}

412 
	$»adStCÚdFau»s
() {

413  
th»ad
->
	`»adStCÚdFau»s
();

414 
	}
}

416 
	$£tStCÚdFau»s
(
sc_çu»s
) {

417 
th»ad
->
	`£tStCÚdFau»s
(
sc_çu»s
);

418 
	}
}

420 
MiscReg
 
	$»adRegOth”Th»ad
(
»gIdx
, 
Th»adID
 
tid
 = 
Inv®idTh»adID
)

422 
	`·nic
("Simple CPU models do‚ot support multithreaded "

424 
	}
}

426 
	$£tRegOth”Th»ad
(
»gIdx
, cÚ¡ 
MiscReg
 &
v®
,

427 
Th»adID
 
tid
 = 
Inv®idTh»adID
)

429 
	`·nic
("Simple CPU models do‚ot support multithreaded "

431 
	}
}

435 
FauÉ
 
	$hw»i
(è{  
th»ad
->
	`hw»i
(); 
	}
}

436 
boŞ
 
	$simP®Check
(
·lFunc
è{  
th»ad
->
	`simP®Check
Õ®Func); 
	}
}

439 
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

441 ià(
FuÎSy¡em
)

442 
	`·nic
("Syscallƒmulation isn't‡vailable in FS mode.\n");

444 
th»ad
->
	`sysÿÎ
(
ÿÎnum
);

445 
	}
}

447 
boŞ
 
	$mis¥ecuÏtšg
(è{  
th»ad
->
	`mis¥ecuÏtšg
(); 
	}
}

448 
Th»adCÚ‹xt
 *
	$tcBa£
(è{  
tc
; 
	}
}

	@simple/timing.cc

43 
	~"¬ch/locked_mem.hh
"

44 
	~"¬ch/mm­³d_r.hh
"

45 
	~"¬ch/ut™y.hh
"

46 
	~"ba£/bigšt.hh
"

47 
	~"cÚfig/the_i§.hh
"

48 
	~"ıu/sim¶e/timšg.hh
"

49 
	~"ıu/ex‘¿û.hh
"

50 
	~"debug/CÚfig.hh
"

51 
	~"debug/D¿š.hh
"

52 
	~"debug/ExecFauÉšg.hh
"

53 
	~"debug/Sim¶eCPU.hh
"

54 
	~"mem/·ck‘.hh
"

55 
	~"mem/·ck‘_acûss.hh
"

56 
	~"·¿ms/TimšgSim¶eCPU.hh
"

57 
	~"sim/çuÉs.hh
"

58 
	~"sim/fuÎ_sy¡em.hh
"

59 
	~"sim/sy¡em.hh
"

61 
usšg
 
Çme¥aû
 
	g¡d
;

62 
usšg
 
Çme¥aû
 
	gTheISA
;

65 
	gTimšgSim¶eCPU
::
	$š™
()

67 
Ba£CPU
::
	`š™
();

70 
	`tcBa£
()->
	`š™MemProx›s
(tcBase());

72 ià(
FuÎSy¡em
 && !
	`·¿ms
()->
sw™ched_out
) {

73 
i
 = 0; i < 
th»adCÚ‹xts
.
	`size
(); ++i) {

74 
Th»adCÚ‹xt
 *
tc
 = 
th»adCÚ‹xts
[
i
];

76 
TheISA
::
	`š™CPU
(
tc
, 
_ıuId
);

79 
	}
}

82 
	gTimšgSim¶eCPU
::
TimšgCPUPÜt
::
TickEv’t
::
	$scheduË
(
Pack‘PŒ
 
_pkt
, 
Tick
 
t
)

84 
pkt
 = 
_pkt
;

85 
ıu
->
	`scheduË
(
this
, 
t
);

86 
	}
}

88 
	gTimšgSim¶eCPU
::
	$TimšgSim¶eCPU
(
TimšgSim¶eCPUP¬ams
 *
p
)

89 : 
	`Ba£Sim¶eCPU
(
p
), 
	`ãtchT¿n¦©iÚ
(
this
), 
	`iÿchePÜt
(this),

90 
	`dÿchePÜt
(
this
), 
	`iãtch_pkt
(
NULL
), 
	`dÿche_pkt
(NULL), 
	`´eviousCyşe
(0),

91 
	`ãtchEv’t
(
this
), 
	$d¿šMªag”
(
NULL
)

93 
_¡©us
 = 
IdË
;

95 
sy¡em
->
tÙ®NumIn¡s
 = 0;

96 
	}
}

99 
	gTimšgSim¶eCPU
::~
	$TimšgSim¶eCPU
()

101 
	}
}

104 
TimšgSim¶eCPU
::
	$d¿š
(
D¿šMªag”
 *
d¿š_mªag”
)

106 
	`as£¹
(!
d¿šMªag”
);

107 ià(
	`sw™chedOut
())

110 ià(
_¡©us
 =ğ
IdË
 ||

111 (
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
 && 
	`isD¿šed
())) {

112 
	`DPRINTF
(
D¿š
, "No‚eedo drain.\n");

115 
d¿šMªag”
 = 
d¿š_mªag”
;

116 
	`DPRINTF
(
D¿š
, "Reque¡šg d¿š: %s\n", 
	`pcS‹
());

121 ià(
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
 && !
ãtchEv’t
.
	`scheduËd
())

122 
	`scheduË
(
ãtchEv’t
, 
	`şockEdge
());

126 
	}
}

129 
	gTimšgSim¶eCPU
::
	$d¿šResume
()

131 
	`as£¹
(!
ãtchEv’t
.
	`scheduËd
());

132 
	`as£¹
(!
d¿šMªag”
);

133 ià(
	`sw™chedOut
())

136 
	`DPRINTF
(
Sim¶eCPU
, "Resume\n");

137 
	`v”ifyMemÜyMode
();

139 
	`as£¹
(!
th»adCÚ‹xts
.
	`em±y
());

140 ià(
th»adCÚ‹xts
.
	`size
() > 1)

141 
	`çl
("Theiming CPU only supports onehread.\n");

143 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
) {

144 
	`scheduË
(
ãtchEv’t
, 
	`ÃxtCyşe
());

145 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

146 
nÙIdËF¿ùiÚ
 = 1;

148 
_¡©us
 = 
Ba£Sim¶eCPU
::
IdË
;

149 
nÙIdËF¿ùiÚ
 = 0;

151 
	}
}

153 
boŞ


154 
	gTimšgSim¶eCPU
::
	$ŒyCom¶‘eD¿š
()

156 ià(!
d¿šMªag”
)

157  
çl£
;

159 
	`DPRINTF
(
D¿š
, "ŒyCom¶‘eD¿š: %s\n", 
	`pcS‹
());

160 ià(!
	`isD¿šed
())

161  
çl£
;

163 
	`DPRINTF
(
D¿š
, "CPU done draining,…rocessing drainƒvent\n");

164 
d¿šMªag”
->
	`sigÇlD¿šDÚe
();

165 
d¿šMªag”
 = 
NULL
;

167  
Œue
;

168 
	}
}

171 
	gTimšgSim¶eCPU
::
	$sw™chOut
()

173 
Ba£Sim¶eCPU
::
	`sw™chOut
();

175 
	`as£¹
(!
ãtchEv’t
.
	`scheduËd
());

176 
	`as£¹
(
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
 || _¡©u =ğ
IdË
);

177 
	`as£¹
(!
¡ayAtPC
);

178 
	`as£¹
(
	`miüoPC
() == 0);

180 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

181 
	}
}

185 
	gTimšgSim¶eCPU
::
	$keOv”From
(
Ba£CPU
 *
ŞdCPU
)

187 
Ba£Sim¶eCPU
::
	`keOv”From
(
ŞdCPU
);

189 
´eviousCyşe
 = 
	`curCyşe
();

190 
	}
}

193 
	gTimšgSim¶eCPU
::
	$v”ifyMemÜyMode
() const

195 ià(!
sy¡em
->
	`isTimšgMode
()) {

196 
	`çl
("Theiming CPU„equireshe memory systemo be in "

199 
	}
}

202 
	gTimšgSim¶eCPU
::
	$aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
)

204 
	`DPRINTF
(
Sim¶eCPU
, "Aùiv©eCÚ‹xˆ%d (%d cyşes)\n", 
th»ad_num
, 
d–ay
);

206 
	`as£¹
(
th»ad_num
 == 0);

207 
	`as£¹
(
th»ad
);

209 
	`as£¹
(
_¡©us
 =ğ
IdË
);

211 
nÙIdËF¿ùiÚ
 = 1;

212 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

215 
	`scheduË
(
ãtchEv’t
, 
	`şockEdge
(
d–ay
));

216 
	}
}

220 
	gTimšgSim¶eCPU
::
	$su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
)

222 
	`DPRINTF
(
Sim¶eCPU
, "Su¥’dCÚ‹xˆ%d\n", 
th»ad_num
);

224 
	`as£¹
(
th»ad_num
 == 0);

225 
	`as£¹
(
th»ad
);

227 ià(
_¡©us
 =ğ
IdË
)

230 
	`as£¹
(
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
);

235 
nÙIdËF¿ùiÚ
 = 0;

236 
_¡©us
 = 
IdË
;

237 
	}
}

239 
boŞ


240 
	gTimšgSim¶eCPU
::
	$hªdËR—dPack‘
(
Pack‘PŒ
 
pkt
)

242 
Reque¡PŒ
 
»q
 = 
pkt
->req;

243 ià(
»q
->
	`isMm­³dI´
()) {

244 
Cyşes
 
d–ay
 = 
TheISA
::
	`hªdËI´R—d
(
th»ad
->
	`g‘TC
(), 
pkt
);

245 
Ãw
 
	`I´Ev’t
(
pkt
, 
this
, 
	`şockEdge
(
d–ay
));

246 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

247 
dÿche_pkt
 = 
NULL
;

248 } ià(!
dÿchePÜt
.
	`£ndTimšgReq
(
pkt
)) {

249 
_¡©us
 = 
DÿcheR‘ry
;

250 
dÿche_pkt
 = 
pkt
;

252 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

254 
dÿche_pkt
 = 
NULL
;

256  
dÿche_pkt
 =ğ
NULL
;

257 
	}
}

260 
	gTimšgSim¶eCPU
::
	$£ndD©a
(
Reque¡PŒ
 
»q
, 
ušt8_t
 *
d©a
, 
ušt64_t
 *
»s
,

261 
boŞ
 
»ad
)

263 
Pack‘PŒ
 
pkt
;

264 
	`budPack‘
(
pkt
, 
»q
, 
»ad
);

265 
pkt
->
d©aDyÇmicA¼ay
<
ušt8_t
>(
d©a
);

266 ià(
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

267 
	`as£¹
(!
dÿche_pkt
);

268 
pkt
->
	`makeRe¥Ú£
();

269 
	`com¶‘eD©aAcûss
(
pkt
);

270 } ià(
»ad
) {

271 
	`hªdËR—dPack‘
(
pkt
);

273 
boŞ
 
do_acûss
 = 
Œue
;

275 ià(
»q
->
	`isLLSC
()) {

276 
do_acûss
 = 
TheISA
::
	`hªdËLockedWr™e
(
th»ad
, 
»q
);

277 } ià(
»q
->
	`isCÚdSw­
()) {

278 
	`as£¹
(
»s
);

279 
»q
->
	`£tExŒaD©a
(*
»s
);

282 ià(
do_acûss
) {

283 
dÿche_pkt
 = 
pkt
;

284 
	`hªdËWr™ePack‘
();

286 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

287 
	`com¶‘eD©aAcûss
(
pkt
);

290 
	}
}

293 
	gTimšgSim¶eCPU
::
	$£ndS¶™D©a
(
Reque¡PŒ
 
»q1
, Reque¡PŒ 
»q2
,

294 
Reque¡PŒ
 
»q
, 
ušt8_t
 *
d©a
, 
boŞ
 
»ad
)

296 
Pack‘PŒ
 
pkt1
, 
pkt2
;

297 
	`budS¶™Pack‘
(
pkt1
, 
pkt2
, 
»q1
, 
»q2
, 
»q
, 
d©a
, 
»ad
);

298 ià(
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

299 
	`as£¹
(!
dÿche_pkt
);

300 
pkt1
->
	`makeRe¥Ú£
();

301 
	`com¶‘eD©aAcûss
(
pkt1
);

302 } ià(
»ad
) {

303 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 =

304 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(
pkt1
->
£nd”S‹
);

305 ià(
	`hªdËR—dPack‘
(
pkt1
)) {

306 
£nd_¡©e
->
	`ş—rFromP¬’t
();

307 
£nd_¡©e
 = 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(

308 
pkt2
->
£nd”S‹
);

309 ià(
	`hªdËR—dPack‘
(
pkt2
)) {

310 
£nd_¡©e
->
	`ş—rFromP¬’t
();

314 
dÿche_pkt
 = 
pkt1
;

315 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 =

316 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(
pkt1
->
£nd”S‹
);

317 ià(
	`hªdËWr™ePack‘
()) {

318 
£nd_¡©e
->
	`ş—rFromP¬’t
();

319 
dÿche_pkt
 = 
pkt2
;

320 
£nd_¡©e
 = 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(

321 
pkt2
->
£nd”S‹
);

322 ià(
	`hªdËWr™ePack‘
()) {

323 
£nd_¡©e
->
	`ş—rFromP¬’t
();

327 
	}
}

330 
	gTimšgSim¶eCPU
::
	$Œª¦©iÚFauÉ
(
FauÉ
 
çuÉ
)

334 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

335 
´eviousCyşe
 = 
	`curCyşe
();

337 ià(
ŒaûD©a
) {

339 
d–‘e
 
ŒaûD©a
;

340 
ŒaûD©a
 = 
NULL
;

343 
	`po¡Execu‹
();

345 
	`advªûIn¡
(
çuÉ
);

346 
	}
}

349 
	gTimšgSim¶eCPU
::
	$budPack‘
(
Pack‘PŒ
 &
pkt
, 
Reque¡PŒ
 
»q
, 
boŞ
 
»ad
)

351 
MemCmd
 
cmd
;

352 ià(
»ad
) {

353 
cmd
 = 
MemCmd
::
R—dReq
;

354 ià(
»q
->
	`isLLSC
())

355 
cmd
 = 
MemCmd
::
LßdLockedReq
;

357 
cmd
 = 
MemCmd
::
Wr™eReq
;

358 ià(
»q
->
	`isLLSC
()) {

359 
cmd
 = 
MemCmd
::
StÜeCÚdReq
;

360 } ià(
»q
->
	`isSw­
()) {

361 
cmd
 = 
MemCmd
::
Sw­Req
;

364 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
cmd
);

365 
	}
}

368 
	gTimšgSim¶eCPU
::
	$budS¶™Pack‘
(
Pack‘PŒ
 &
pkt1
, Pack‘PŒ &
pkt2
,

369 
Reque¡PŒ
 
»q1
, Reque¡PŒ 
»q2
, Reque¡PŒ 
»q
,

370 
ušt8_t
 *
d©a
, 
boŞ
 
»ad
)

372 
pkt1
 = 
pkt2
 = 
NULL
;

374 
	`as£¹
(!
»q1
->
	`isMm­³dI´
(è&& !
»q2
->isMmappedIpr());

376 ià(
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

377 
	`budPack‘
(
pkt1
, 
»q
, 
»ad
);

381 
	`budPack‘
(
pkt1
, 
»q1
, 
»ad
);

382 
	`budPack‘
(
pkt2
, 
»q2
, 
»ad
);

384 
»q
->
	`£tPhys
(
»q1
->
	`g‘Paddr
(),„eq->
	`g‘Size
(),„eq1->
	`g‘FÏgs
(), 
	`d©aMa¡”Id
());

385 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
pkt1
->
cmd
.
	`»¥Ú£Commªd
());

387 
pkt
->
d©aDyÇmicA¼ay
<
ušt8_t
>(
d©a
);

388 
pkt1
->
d©aStic
<
ušt8_t
>(
d©a
);

389 
pkt2
->
d©aStic
<
ušt8_t
>(
d©a
 + 
»q1
->
	`g‘Size
());

391 
S¶™MašS’d”S‹
 * 
maš_£nd_¡©e
 = 
Ãw
 SplitMainSenderState;

392 
pkt
->
£nd”S‹
 = 
maš_£nd_¡©e
;

393 
maš_£nd_¡©e
->
äagm’ts
[0] = 
pkt1
;

394 
maš_£nd_¡©e
->
äagm’ts
[1] = 
pkt2
;

395 
maš_£nd_¡©e
->
out¡ªdšg
 = 2;

396 
pkt1
->
£nd”S‹
 = 
Ãw
 
	`S¶™F¿gm’tS’d”S‹
(
pkt
, 0);

397 
pkt2
->
£nd”S‹
 = 
Ãw
 
	`S¶™F¿gm’tS’d”S‹
(
pkt
, 1);

398 
	}
}

400 
FauÉ


401 
	gTimšgSim¶eCPU
::
	$»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
,

402 
size
, 
æags
)

404 
FauÉ
 
çuÉ
;

405 cÚ¡ 
asid
 = 0;

406 cÚ¡ 
Th»adID
 
tid
 = 0;

407 cÚ¡ 
Addr
 
pc
 = 
th»ad
->
	`š¡Addr
();

408 
block_size
 = 
	`ÿcheLšeSize
();

409 
Ba£TLB
::
Mode
 
mode
 = Ba£TLB::
R—d
;

411 ià(
ŒaûD©a
) {

412 
ŒaûD©a
->
	`£tAddr
(
addr
);

415 
Reque¡PŒ
 
»q
 = 
Ãw
 
	`Reque¡
(
asid
, 
addr
, 
size
,

416 
æags
, 
	`d©aMa¡”Id
(), 
pc
, 
_ıuId
, 
tid
);

418 
Addr
 
¥l™_addr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
block_size
);

419 
	`as£¹
(
¥l™_addr
 <ğ
addr
 || s¶™_add¸-‡dd¸< 
block_size
);

421 
_¡©us
 = 
DTBWa™Re¥Ú£
;

422 ià(
¥l™_addr
 > 
addr
) {

423 
Reque¡PŒ
 
»q1
, 
»q2
;

424 
	`as£¹
(!
»q
->
	`isLLSC
(è&& !»q->
	`isSw­
());

425 
»q
->
	`¥l™OnVaddr
(
¥l™_addr
, 
»q1
, 
»q2
);

427 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 =

428 
Ãw
 
	`WhŞeT¿n¦©iÚS‹
(
»q
, 
»q1
, 
»q2
,‚ew 
ušt8_t
[
size
],

429 
NULL
, 
mode
);

430 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *> *
Œªs1
 =

431 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *>(
this
, 
¡©e
, 0);

432 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *> *
Œªs2
 =

433 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *>(
this
, 
¡©e
, 1);

435 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q1
, 
tc
, 
Œªs1
, 
mode
);

436 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q2
, 
tc
, 
Œªs2
, 
mode
);

438 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 =

439 
Ãw
 
	`WhŞeT¿n¦©iÚS‹
(
»q
,‚ew 
ušt8_t
[
size
], 
NULL
, 
mode
);

440 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *> *
Œª¦©iÚ


441 ğ
Ãw
 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *>(
this
, 
¡©e
);

442 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q
, 
tc
, 
Œª¦©iÚ
, 
mode
);

445  
NoFauÉ
;

446 
	}
}

448 
boŞ


449 
	gTimšgSim¶eCPU
::
	$hªdËWr™ePack‘
()

451 
Reque¡PŒ
 
»q
 = 
dÿche_pkt
->req;

452 ià(
»q
->
	`isMm­³dI´
()) {

453 
Cyşes
 
d–ay
 = 
TheISA
::
	`hªdËI´Wr™e
(
th»ad
->
	`g‘TC
(), 
dÿche_pkt
);

454 
Ãw
 
	`I´Ev’t
(
dÿche_pkt
, 
this
, 
	`şockEdge
(
d–ay
));

455 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

456 
dÿche_pkt
 = 
NULL
;

457 } ià(!
dÿchePÜt
.
	`£ndTimšgReq
(
dÿche_pkt
)) {

458 
_¡©us
 = 
DÿcheR‘ry
;

460 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

462 
dÿche_pkt
 = 
NULL
;

464  
dÿche_pkt
 =ğ
NULL
;

465 
	}
}

467 
FauÉ


468 
	gTimšgSim¶eCPU
::
	$wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

469 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
)

471 
ušt8_t
 *
ÃwD©a
 = 
Ãw
 ušt8_t[
size
];

472 
	`memıy
(
ÃwD©a
, 
d©a
, 
size
);

474 cÚ¡ 
asid
 = 0;

475 cÚ¡ 
Th»adID
 
tid
 = 0;

476 cÚ¡ 
Addr
 
pc
 = 
th»ad
->
	`š¡Addr
();

477 
block_size
 = 
	`ÿcheLšeSize
();

478 
Ba£TLB
::
Mode
 
mode
 = Ba£TLB::
Wr™e
;

480 ià(
ŒaûD©a
) {

481 
ŒaûD©a
->
	`£tAddr
(
addr
);

484 
Reque¡PŒ
 
»q
 = 
Ãw
 
	`Reque¡
(
asid
, 
addr
, 
size
,

485 
æags
, 
	`d©aMa¡”Id
(), 
pc
, 
_ıuId
, 
tid
);

487 
Addr
 
¥l™_addr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
block_size
);

488 
	`as£¹
(
¥l™_addr
 <ğ
addr
 || s¶™_add¸-‡dd¸< 
block_size
);

490 
_¡©us
 = 
DTBWa™Re¥Ú£
;

491 ià(
¥l™_addr
 > 
addr
) {

492 
Reque¡PŒ
 
»q1
, 
»q2
;

493 
	`as£¹
(!
»q
->
	`isLLSC
(è&& !»q->
	`isSw­
());

494 
»q
->
	`¥l™OnVaddr
(
¥l™_addr
, 
»q1
, 
»q2
);

496 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 =

497 
Ãw
 
	`WhŞeT¿n¦©iÚS‹
(
»q
, 
»q1
, 
»q2
, 
ÃwD©a
, 
»s
, 
mode
);

498 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *> *
Œªs1
 =

499 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *>(
this
, 
¡©e
, 0);

500 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *> *
Œªs2
 =

501 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *>(
this
, 
¡©e
, 1);

503 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q1
, 
tc
, 
Œªs1
, 
mode
);

504 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q2
, 
tc
, 
Œªs2
, 
mode
);

506 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 =

507 
Ãw
 
	`WhŞeT¿n¦©iÚS‹
(
»q
, 
ÃwD©a
, 
»s
, 
mode
);

508 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *> *
Œª¦©iÚ
 =

509 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgSim¶eCPU
 *>(
this
, 
¡©e
);

510 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q
, 
tc
, 
Œª¦©iÚ
, 
mode
);

514  
NoFauÉ
;

515 
	}
}

519 
	gTimšgSim¶eCPU
::
	$fšishT¿n¦©iÚ
(
WhŞeT¿n¦©iÚS‹
 *
¡©e
)

521 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

523 ià(
¡©e
->
	`g‘FauÉ
(è!ğ
NoFauÉ
) {

524 ià(
¡©e
->
	`isP»ãtch
()) {

525 
¡©e
->
	`£tNoFauÉ
();

527 
d–‘e
 [] 
¡©e
->
d©a
;

528 
¡©e
->
	`d–‘eReqs
();

529 
	`Œª¦©iÚFauÉ
(
¡©e
->
	`g‘FauÉ
());

531 ià(!
¡©e
->
isS¶™
) {

532 
	`£ndD©a
(
¡©e
->
mašReq
, s‹->
d©a
, s‹->
»s
,

533 
¡©e
->
mode
 =ğ
Ba£TLB
::
R—d
);

535 
	`£ndS¶™D©a
(
¡©e
->
¤eqLow
, s‹->
¤eqHigh
, s‹->
mašReq
,

536 
¡©e
->
d©a
, s‹->
mode
 =ğ
Ba£TLB
::
R—d
);

540 
d–‘e
 
¡©e
;

541 
	}
}

545 
	gTimšgSim¶eCPU
::
	$ãtch
()

547 
	`DPRINTF
(
Sim¶eCPU
, "Fetch\n");

549 ià(!
curSticIn¡
 || !curSticIn¡->
	`isD–ayedComm™
())

550 
	`checkFÜIÁ”ru±s
();

552 
	`checkPcEv’tQueue
();

555 ià(
_¡©us
 =ğ
IdË
)

558 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

559 
boŞ
 
ÃedToF‘ch
 = !
	`isRomMiüoPC
(
pcS‹
.
	`miüoPC
()è&& !
curMaüoSticIn¡
;

561 ià(
ÃedToF‘ch
) {

562 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

563 
Reque¡
 *
iãtch_»q
 = 
Ãw
 
	`Reque¡
();

564 
iãtch_»q
->
	`£tTh»adCÚ‹xt
(
_ıuId
, 0);

565 
	`£tupF‘chReque¡
(
iãtch_»q
);

566 
	`DPRINTF
(
Sim¶eCPU
, "T¿n¦©šg‡dd»s %#x\n", 
iãtch_»q
->
	`g‘Vaddr
());

567 
th»ad
->
™b
->
	`Œª¦©eTimšg
(
iãtch_»q
, 
tc
, &
ãtchT¿n¦©iÚ
,

568 
Ba£TLB
::
Execu‹
);

570 
_¡©us
 = 
IÿcheWa™Re¥Ú£
;

571 
	`com¶‘eIãtch
(
NULL
);

573 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

574 
´eviousCyşe
 = 
	`curCyşe
();

576 
	}
}

580 
	gTimšgSim¶eCPU
::
	$£ndF‘ch
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
)

582 ià(
çuÉ
 =ğ
NoFauÉ
) {

583 
	`DPRINTF
(
Sim¶eCPU
, "Sending fetch for‡ddr %#x(pa: %#x)\n",

584 
»q
->
	`g‘Vaddr
(),„eq->
	`g‘Paddr
());

585 
iãtch_pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
MemCmd
::
R—dReq
);

586 
iãtch_pkt
->
	`d©aStic
(&
š¡
);

587 
	`DPRINTF
(
Sim¶eCPU
, " --…kˆaddr: %#x\n", 
iãtch_pkt
->
	`g‘Addr
());

589 ià(!
iÿchePÜt
.
	`£ndTimšgReq
(
iãtch_pkt
)) {

591 
_¡©us
 = 
IÿcheR‘ry
;

594 
_¡©us
 = 
IÿcheWa™Re¥Ú£
;

596 
iãtch_pkt
 = 
NULL
;

599 
	`DPRINTF
(
Sim¶eCPU
, "T¿n¦©iÚ oàadd¸%#x fauÉed\n", 
»q
->
	`g‘Vaddr
());

600 
d–‘e
 
»q
;

602 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

603 
	`advªûIn¡
(
çuÉ
);

606 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

607 
´eviousCyşe
 = 
	`curCyşe
();

608 
	}
}

612 
	gTimšgSim¶eCPU
::
	$advªûIn¡
(
FauÉ
 
çuÉ
)

614 ià(
_¡©us
 =ğ
FauÉšg
)

617 ià(
çuÉ
 !ğ
NoFauÉ
) {

618 
	`advªûPC
(
çuÉ
);

619 
	`DPRINTF
(
Sim¶eCPU
, "Fault occured, scheduling fetchƒvent\n");

620 
	`»scheduË
(
ãtchEv’t
, 
	`şockEdge
(), 
Œue
);

621 
_¡©us
 = 
FauÉšg
;

626 ià(!
¡ayAtPC
)

627 
	`advªûPC
(
çuÉ
);

629 ià(
	`ŒyCom¶‘eD¿š
())

632 ià(
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
) {

636 
	`ãtch
();

638 
	}
}

642 
	gTimšgSim¶eCPU
::
	$com¶‘eIãtch
(
Pack‘PŒ
 
pkt
)

644 
	`DPRINTF
(
Sim¶eCPU
, "Com¶‘ICachF‘ch fÜ‡dd¸%#x\n", 
pkt
 ?

645 
pkt
->
	`g‘Addr
() : 0);

650 
	`as£¹
(!
pkt
 || !pkt->
	`isE¼Ü
());

651 
	`as£¹
(
_¡©us
 =ğ
IÿcheWa™Re¥Ú£
);

653 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

655 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

656 
´eviousCyşe
 = 
	`curCyşe
();

658 
	`´eExecu‹
();

659 ià(
curSticIn¡
 && curSticIn¡->
	`isMemRef
()) {

661 
FauÉ
 
çuÉ
 = 
curSticIn¡
->
	`š™Ÿ‹Acc
(
this
, 
ŒaûD©a
);

666 ià(
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
) {

667 ià(
çuÉ
 !ğ
NoFauÉ
 && 
ŒaûD©a
) {

669 
d–‘e
 
ŒaûD©a
;

670 
ŒaûD©a
 = 
NULL
;

673 
	`po¡Execu‹
();

675 ià(
curSticIn¡
 && (!curSticIn¡->
	`isMiüoİ
() ||

676 
curSticIn¡
->
	`isFœ¡Miüoİ
()))

677 
š¡CÁ
++;

678 
	`advªûIn¡
(
çuÉ
);

680 } ià(
curSticIn¡
) {

682 
FauÉ
 
çuÉ
 = 
curSticIn¡
->
	`execu‹
(
this
, 
ŒaûD©a
);

685 ià(
çuÉ
 =ğ
NoFauÉ
)

686 
	`couÁIn¡
();

687 ià(
ŒaûD©a
 && !
	`DTRACE
(
ExecFauÉšg
)) {

688 
d–‘e
 
ŒaûD©a
;

689 
ŒaûD©a
 = 
NULL
;

692 
	`po¡Execu‹
();

694 ià(
curSticIn¡
 && (!curSticIn¡->
	`isMiüoİ
() ||

695 
curSticIn¡
->
	`isFœ¡Miüoİ
()))

696 
š¡CÁ
++;

697 
	`advªûIn¡
(
çuÉ
);

699 
	`advªûIn¡
(
NoFauÉ
);

702 ià(
pkt
) {

703 
d–‘e
 
pkt
->
»q
;

704 
d–‘e
 
pkt
;

706 
	}
}

709 
	gTimšgSim¶eCPU
::
IÿchePÜt
::
ITickEv’t
::
	$´oûss
()

711 
ıu
->
	`com¶‘eIãtch
(
pkt
);

712 
	}
}

714 
boŞ


715 
	gTimšgSim¶eCPU
::
IÿchePÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

717 
	`DPRINTF
(
Sim¶eCPU
, "Reûivedimšg„e¥Ú£ %#x\n", 
pkt
->
	`g‘Addr
());

719 
Tick
 
Ãxt_tick
 = 
ıu
->
	`şockEdge
();

721 ià(
Ãxt_tick
 =ğ
	`curTick
())

722 
ıu
->
	`com¶‘eIãtch
(
pkt
);

724 
tickEv’t
.
	`scheduË
(
pkt
, 
Ãxt_tick
);

726  
Œue
;

727 
	}
}

730 
	gTimšgSim¶eCPU
::
IÿchePÜt
::
	$»cvR‘ry
()

734 
	`as£¹
(
ıu
->
iãtch_pkt
 !ğ
NULL
);

735 
	`as£¹
(
ıu
->
_¡©us
 =ğ
IÿcheR‘ry
);

736 
Pack‘PŒ
 
tmp
 = 
ıu
->
iãtch_pkt
;

737 ià(
	`£ndTimšgReq
(
tmp
)) {

738 
ıu
->
_¡©us
 = 
IÿcheWa™Re¥Ú£
;

739 
ıu
->
iãtch_pkt
 = 
NULL
;

741 
	}
}

744 
	gTimšgSim¶eCPU
::
	$com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
)

748 
	`as£¹
(!
pkt
->
	`isE¼Ü
());

749 
	`as£¹
(
_¡©us
 =ğ
DÿcheWa™Re¥Ú£
 || _¡©u =ğ
DTBWa™Re¥Ú£
 ||

750 
pkt
->
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
));

752 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

753 
´eviousCyşe
 = 
	`curCyşe
();

755 ià(
pkt
->
£nd”S‹
) {

756 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 =

757 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(
pkt
->
£nd”S‹
);

758 
	`as£¹
(
£nd_¡©e
);

759 
d–‘e
 
pkt
->
»q
;

760 
d–‘e
 
pkt
;

761 
Pack‘PŒ
 
big_pkt
 = 
£nd_¡©e
->
bigPkt
;

762 
d–‘e
 
£nd_¡©e
;

764 
S¶™MašS’d”S‹
 * 
maš_£nd_¡©e
 =

765 
dyÇmic_ÿ¡
<
S¶™MašS’d”S‹
 *>(
big_pkt
->
£nd”S‹
);

766 
	`as£¹
(
maš_£nd_¡©e
);

768 
	`as£¹
(
maš_£nd_¡©e
->
out¡ªdšg
 != 0);

769 
maš_£nd_¡©e
->
out¡ªdšg
--;

771 ià(
maš_£nd_¡©e
->
out¡ªdšg
) {

774 
d–‘e
 
maš_£nd_¡©e
;

775 
big_pkt
->
£nd”S‹
 = 
NULL
;

776 
pkt
 = 
big_pkt
;

780 
_¡©us
 = 
Ba£Sim¶eCPU
::
RuÂšg
;

782 
FauÉ
 
çuÉ
 = 
curSticIn¡
->
	`com¶‘eAcc
(
pkt
, 
this
, 
ŒaûD©a
);

785 ià(
çuÉ
 =ğ
NoFauÉ
)

786 
	`couÁIn¡
();

787 ià(
ŒaûD©a
) {

789 
d–‘e
 
ŒaûD©a
;

790 
ŒaûD©a
 = 
NULL
;

795 ià(
pkt
->
	`isR—d
(è&&…kt->
»q
->
	`isLLSC
()) {

796 
TheISA
::
	`hªdËLockedR—d
(
th»ad
, 
pkt
->
»q
);

799 
d–‘e
 
pkt
->
»q
;

800 
d–‘e
 
pkt
;

802 
	`po¡Execu‹
();

804 
	`advªûIn¡
(
çuÉ
);

805 
	}
}

807 
boŞ


808 
	gTimšgSim¶eCPU
::
DÿchePÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

811 
Tick
 
Ãxt_tick
 = 
ıu
->
	`şockEdge
();

813 ià(
Ãxt_tick
 =ğ
	`curTick
()) {

814 
ıu
->
	`com¶‘eD©aAcûss
(
pkt
);

816 ià(!
tickEv’t
.
	`scheduËd
()) {

817 
tickEv’t
.
	`scheduË
(
pkt
, 
Ãxt_tick
);

822 ià(!
»ŒyEv’t
.
	`scheduËd
())

823 
ıu
->
	`scheduË
(
»ŒyEv’t
, 
Ãxt_tick
);

824  
çl£
;

828  
Œue
;

829 
	}
}

832 
	gTimšgSim¶eCPU
::
DÿchePÜt
::
DTickEv’t
::
	$´oûss
()

834 
ıu
->
	`com¶‘eD©aAcûss
(
pkt
);

835 
	}
}

838 
	gTimšgSim¶eCPU
::
DÿchePÜt
::
	$»cvR‘ry
()

842 
	`as£¹
(
ıu
->
dÿche_pkt
 !ğ
NULL
);

843 
	`as£¹
(
ıu
->
_¡©us
 =ğ
DÿcheR‘ry
);

844 
Pack‘PŒ
 
tmp
 = 
ıu
->
dÿche_pkt
;

845 ià(
tmp
->
£nd”S‹
) {

847 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 =

848 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(
tmp
->
£nd”S‹
);

849 
	`as£¹
(
£nd_¡©e
);

850 
Pack‘PŒ
 
big_pkt
 = 
£nd_¡©e
->
bigPkt
;

852 
S¶™MašS’d”S‹
 * 
maš_£nd_¡©e
 =

853 
dyÇmic_ÿ¡
<
S¶™MašS’d”S‹
 *>(
big_pkt
->
£nd”S‹
);

854 
	`as£¹
(
maš_£nd_¡©e
);

856 ià(
	`£ndTimšgReq
(
tmp
)) {

859 
£nd_¡©e
->
	`ş—rFromP¬’t
();

860 
Ùh”_šdex
 = 
maš_£nd_¡©e
->
	`g‘P’dšgF¿gm’t
();

861 ià(
Ùh”_šdex
 > 0) {

862 
tmp
 = 
maš_£nd_¡©e
->
äagm’ts
[
Ùh”_šdex
];

863 
ıu
->
dÿche_pkt
 = 
tmp
;

864 ià((
big_pkt
->
	`isR—d
(è&& 
ıu
->
	`hªdËR—dPack‘
(
tmp
)) ||

865 (
big_pkt
->
	`isWr™e
(è&& 
ıu
->
	`hªdËWr™ePack‘
())) {

866 
maš_£nd_¡©e
->
äagm’ts
[
Ùh”_šdex
] = 
NULL
;

869 
ıu
->
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

871 
ıu
->
dÿche_pkt
 = 
NULL
;

874 } ià(
	`£ndTimšgReq
(
tmp
)) {

875 
ıu
->
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

877 
ıu
->
dÿche_pkt
 = 
NULL
;

879 
	}
}

881 
	gTimšgSim¶eCPU
::
I´Ev’t
::
	$I´Ev’t
(
Pack‘
 *
_pkt
, 
TimšgSim¶eCPU
 *
_ıu
,

882 
Tick
 
t
)

883 : 
	`pkt
(
_pkt
), 
	$ıu
(
_ıu
)

885 
ıu
->
	`scheduË
(
this
, 
t
);

886 
	}
}

889 
	gTimšgSim¶eCPU
::
I´Ev’t
::
	$´oûss
()

891 
ıu
->
	`com¶‘eD©aAcûss
(
pkt
);

892 
	}
}

895 
	gTimšgSim¶eCPU
::
I´Ev’t
::
	$desütiÚ
() const

898 
	}
}

902 
	gTimšgSim¶eCPU
::
	$´štAddr
(
Addr
 
a
)

904 
dÿchePÜt
.
	`´štAddr
(
a
);

905 
	}
}

912 
TimšgSim¶eCPU
 *

913 
	gTimšgSim¶eCPUP¬ams
::
	$ü—‹
()

915 
numTh»ads
 = 1;

916 ià(!
FuÎSy¡em
 && 
wÜklßd
.
	`size
() != 1)

917 
	`·nic
("only one workload‡llowed");

918  
Ãw
 
	`TimšgSim¶eCPU
(
this
);

919 
	}
}

	@simple/timing.hh

43 #iâdeà
__CPU_SIMPLE_TIMING_HH__


44 
	#__CPU_SIMPLE_TIMING_HH__


	)

46 
	~"ıu/sim¶e/ba£.hh
"

47 
	~"ıu/Œª¦©iÚ.hh
"

48 
	~"·¿ms/TimšgSim¶eCPU.hh
"

50 şas 
	cTimšgSim¶eCPU
 : 
public
 
Ba£Sim¶eCPU


52 
public
:

54 
TimšgSim¶eCPU
(
TimšgSim¶eCPUP¬ams
 * 
·¿ms
);

55 
	mvœtu®
 ~
TimšgSim¶eCPU
();

57 
vœtu®
 
š™
();

59 
	m´iv©e
:

71 şas 
	cS¶™MašS’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


73 
public
:

74 
out¡ªdšg
;

75 
Pack‘PŒ
 
	mäagm’ts
[2];

78 
g‘P’dšgF¿gm’t
()

80 ià(
	mäagm’ts
[0]) {

82 } ià(
	mäagm’ts
[1]) {

90 şas 
	cS¶™F¿gm’tS’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


92 
public
:

93 
S¶™F¿gm’tS’d”S‹
(
Pack‘PŒ
 
_bigPkt
, 
_šdex
) :

94 
bigPkt
(
_bigPkt
), 
šdex
(
_šdex
)

96 
Pack‘PŒ
 
	gbigPkt
;

97 
	gšdex
;

100 
ş—rFromP¬’t
()

102 
S¶™MašS’d”S‹
 * 
	gmaš_£nd_¡©e
 =

103 
dyÇmic_ÿ¡
<
S¶™MašS’d”S‹
 *>(
bigPkt
->
£nd”S‹
);

104 
	gmaš_£nd_¡©e
->
	gäagm’ts
[
šdex
] = 
NULL
;

108 şas 
	cF‘chT¿n¦©iÚ
 : 
public
 
Ba£TLB
::
T¿n¦©iÚ


110 
´Ùeùed
:

111 
TimšgSim¶eCPU
 *
ıu
;

113 
	gpublic
:

114 
F‘chT¿n¦©iÚ
(
TimšgSim¶eCPU
 *
_ıu
)

115 : 
ıu
(
_ıu
)

119 
m¬kD–ayed
()

121 
as£¹
(
ıu
->
_¡©us
 =ğ
Ba£Sim¶eCPU
::
RuÂšg
);

122 
	gıu
->
	g_¡©us
 = 
ITBWa™Re¥Ú£
;

126 
fšish
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
,

127 
Ba£TLB
::
Mode
 
mode
)

129 
ıu
->
£ndF‘ch
(
çuÉ
, 
»q
, 
tc
);

132 
F‘chT¿n¦©iÚ
 
	gãtchT¿n¦©iÚ
;

134 
£ndD©a
(
Reque¡PŒ
 
»q
, 
ušt8_t
 *
d©a
, 
ušt64_t
 *
»s
, 
boŞ
 
»ad
);

135 
£ndS¶™D©a
(
Reque¡PŒ
 
»q1
, Reque¡PŒ 
»q2
, Reque¡PŒ 
»q
,

136 
ušt8_t
 *
d©a
, 
boŞ
 
»ad
);

138 
Œª¦©iÚFauÉ
(
FauÉ
 
çuÉ
);

140 
budPack‘
(
Pack‘PŒ
 &
pkt
, 
Reque¡PŒ
 
»q
, 
boŞ
 
»ad
);

141 
budS¶™Pack‘
(
Pack‘PŒ
 &
pkt1
, Pack‘PŒ &
pkt2
,

142 
Reque¡PŒ
 
»q1
, Reque¡PŒ 
»q2
, Reque¡PŒ 
»q
,

143 
ušt8_t
 *
d©a
, 
boŞ
 
»ad
);

145 
boŞ
 
hªdËR—dPack‘
(
Pack‘PŒ
 
pkt
);

147 
boŞ
 
hªdËWr™ePack‘
();

155 şas 
	cTimšgCPUPÜt
 : 
public
 
Ma¡”PÜt


157 
public
:

159 
TimšgCPUPÜt
(cÚ¡ 
¡d
::
¡ršg
& 
_Çme
, 
TimšgSim¶eCPU
* 
_ıu
)

160 : 
Ma¡”PÜt
(
_Çme
, 
_ıu
), 
ıu
(_ıu), 
»ŒyEv’t
(
this
)

163 
	g´Ùeùed
:

168 
vœtu®
 
»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
) { }

170 
TimšgSim¶eCPU
* 
ıu
;

172 
	gTickEv’t
 : 
public
 
Ev’t


174 
Pack‘PŒ
 
pkt
;

175 
TimšgSim¶eCPU
 *
	gıu
;

177 
TickEv’t
(
TimšgSim¶eCPU
 *
_ıu
è: 
pkt
(
NULL
), 
ıu
(_cpu) {}

178 cÚ¡ *
desütiÚ
() const {  "Timing CPUick"; }

179 
scheduË
(
Pack‘PŒ
 
_pkt
, 
Tick
 
t
);

182 
	gEv’tW¿µ”
<
	gMa¡”PÜt
, &Ma¡”PÜt::
£ndR‘ry
> 
»ŒyEv’t
;

185 şas 
	cIÿchePÜt
 : 
public
 
TimšgCPUPÜt


187 
public
:

189 
IÿchePÜt
(
TimšgSim¶eCPU
 *
_ıu
)

190 : 
TimšgCPUPÜt
(
_ıu
->
Çme
() + ".icache_port", _cpu),

191 
tickEv’t
(
_ıu
)

194 
	g´Ùeùed
:

196 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

198 
vœtu®
 
»cvR‘ry
();

200 
	gITickEv’t
 : 
public
 
TickEv’t


203 
ITickEv’t
(
TimšgSim¶eCPU
 *
_ıu
)

204 : 
TickEv’t
(
_ıu
) {}

205 
´oûss
();

206 cÚ¡ *
desütiÚ
() const {  "Timing CPU icacheick"; }

209 
ITickEv’t
 
	gtickEv’t
;

213 şas 
	cDÿchePÜt
 : 
public
 
TimšgCPUPÜt


215 
public
:

217 
DÿchePÜt
(
TimšgSim¶eCPU
 *
_ıu
)

218 : 
TimšgCPUPÜt
(
_ıu
->
Çme
() + ".dcache_port", _cpu),

219 
tickEv’t
(
_ıu
)

222 
	g´Ùeùed
:

224 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

226 
vœtu®
 
»cvR‘ry
();

228 
	gDTickEv’t
 : 
public
 
TickEv’t


230 
DTickEv’t
(
TimšgSim¶eCPU
 *
_ıu
)

231 : 
TickEv’t
(
_ıu
) {}

232 
´oûss
();

233 cÚ¡ *
desütiÚ
() const {  "Timing CPU dcacheick"; }

236 
DTickEv’t
 
	gtickEv’t
;

240 
IÿchePÜt
 
	giÿchePÜt
;

241 
DÿchePÜt
 
	gdÿchePÜt
;

243 
Pack‘PŒ
 
	giãtch_pkt
;

244 
Pack‘PŒ
 
	gdÿche_pkt
;

246 
Tick
 
	g´eviousCyşe
;

248 
	g´Ùeùed
:

251 
vœtu®
 
Ma¡”PÜt
 &
	$g‘D©aPÜt
(è{  
dÿchePÜt
; 
	}
}

254 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘In¡PÜt
(è{  
iÿchePÜt
; 
	}
}

256 
	gpublic
:

258 
d¿š
(
D¿šMªag”
 *
d¿š_mªag”
);

259 
d¿šResume
();

261 
sw™chOut
();

262 
keOv”From
(
Ba£CPU
 *
ŞdCPU
);

264 
	$v”ifyMemÜyMode
() const;

266 
vœtu®
 
	`aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
);

267 
vœtu®
 
	`su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
);

269 
FauÉ
 
	`»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
);

271 
FauÉ
 
	`wr™eMem
(
ušt8_t
 *
d©a
, 
size
,

272 
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

274 
	`ãtch
();

275 
	`£ndF‘ch
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
);

276 
	`com¶‘eIãtch
(
Pack‘PŒ
 );

277 
	`com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
);

278 
	`advªûIn¡
(
FauÉ
 
çuÉ
);

286 
boŞ
 
	$isSquashed
(ècÚ¡ {  
çl£
; 
	}
}

292 
´štAddr
(
Addr
 
a
);

298 
fšishT¿n¦©iÚ
(
WhŞeT¿n¦©iÚS‹
 *
¡©e
);

300 
	g´iv©e
:

302 
Ev’tW¿µ”
<
	tTimšgSim¶eCPU
, &TimšgSim¶eCPU::
	tãtch
> 
	tF‘chEv’t
;

303 
F‘chEv’t
 
	gãtchEv’t
;

305 
	gI´Ev’t
 : 
Ev’t
 {

306 
Pack‘
 *
pkt
;

307 
TimšgSim¶eCPU
 *
	gıu
;

308 
I´Ev’t
(
Pack‘
 *
_pkt
, 
TimšgSim¶eCPU
 *
_ıu
, 
Tick
 
t
);

309 
vœtu®
 
´oûss
();

310 
vœtu®
 cÚ¡ *
desütiÚ
() const;

329 
boŞ
 
	$isD¿šed
() {

330  
	`miüoPC
(è=ğ0 && !
¡ayAtPC
 && !
ãtchEv’t
.
	`scheduËd
();

331 
	}
}

338 
boŞ
 
ŒyCom¶‘eD¿š
();

345 
D¿šMªag”
 *
	gd¿šMªag”
;

	@simple_thread.cc

34 
	~<¡ršg
>

36 
	~"¬ch/i§_Œa™s.hh
"

37 
	~"¬ch/k”Ãl_¡©s.hh
"

38 
	~"¬ch/¡ackŒaû.hh
"

39 
	~"¬ch/ut™y.hh
"

40 
	~"ba£/ÿÎback.hh
"

41 
	~"ba£/ırštf.hh
"

42 
	~"ba£/ouut.hh
"

43 
	~"ba£/Œaû.hh
"

44 
	~"cÚfig/the_i§.hh
"

45 
	~"ıu/ba£.hh
"

46 
	~"ıu/´ofe.hh
"

47 
	~"ıu/qu›sû_ev’t.hh
"

48 
	~"ıu/sim¶e_th»ad.hh
"

49 
	~"ıu/th»ad_cÚ‹xt.hh
"

50 
	~"mem/fs_Œª¦©šg_pÜt_´oxy.hh
"

51 
	~"mem/£_Œª¦©šg_pÜt_´oxy.hh
"

52 
	~"·¿ms/Ba£CPU.hh
"

53 
	~"sim/fuÎ_sy¡em.hh
"

54 
	~"sim/´oûss.hh
"

55 
	~"sim/£rŸlize.hh
"

56 
	~"sim/sim_ex™.hh
"

57 
	~"sim/sy¡em.hh
"

59 
usšg
 
Çme¥aû
 
	g¡d
;

62 
	gSim¶eTh»ad
::
Sim¶eTh»ad
(
Ba£CPU
 *
_ıu
, 
_th»ad_num
, 
Sy¡em
 *
_sys
,

63 
Proûss
 *
_´oûss
, 
TheISA
::
TLB
 *
_™b
,

64 
TheISA
::
TLB
 *
_dtb
, TheISA::
ISA
 *
_i§
)

65 : 
Th»adS‹
(
_ıu
, 
_th»ad_num
, 
_´oûss
), 
i§
(
_i§
), 
sy¡em
(
_sys
),

66 
™b
(
_™b
), 
	$dtb
(
_dtb
)

68 
	`ş—rArchRegs
();

69 
tc
 = 
Ãw
 
ProxyTh»adCÚ‹xt
<
Sim¶eTh»ad
>(
this
);

70 
	}
}

72 
	gSim¶eTh»ad
::
Sim¶eTh»ad
(
Ba£CPU
 *
_ıu
, 
_th»ad_num
, 
Sy¡em
 *
_sys
,

73 
TheISA
::
TLB
 *
_™b
, TheISA::TLB *
_dtb
,

74 
TheISA
::
ISA
 *
_i§
, 
boŞ
 
u£_k”Ãl_¡©s
)

75 : 
Th»adS‹
(
_ıu
, 
_th»ad_num
, 
NULL
), 
i§
(
_i§
), 
sy¡em
(
_sys
), 
™b
(
_™b
),

76 
	$dtb
(
_dtb
)

78 
tc
 = 
Ãw
 
ProxyTh»adCÚ‹xt
<
Sim¶eTh»ad
>(
this
);

80 
qu›sûEv’t
 = 
Ãw
 
	`EndQu›sûEv’t
(
tc
);

82 
	`ş—rArchRegs
();

84 ià(
ba£Cpu
->
	`·¿ms
()->
´ofe
) {

85 
´ofe
 = 
Ãw
 
	`FunùiÚProfe
(
sy¡em
->
k”ÃlSymb
);

86 
C®lback
 *
cb
 =

87 
Ãw
 
MakeC®lback
<
Sim¶eTh»ad
,

88 &
Sim¶eTh»ad
::
dumpFuncProfe
>(
this
);

89 
	`»gi¡”Ex™C®lback
(
cb
);

94 
ProfeNode
 
dummyNode
;

95 
´ofeNode
 = &
dummyNode
;

96 
´ofePC
 = 3;

98 ià(
u£_k”Ãl_¡©s
)

99 
k”ÃlSts
 = 
Ãw
 
TheISA
::
K”Ãl
::
	`Sti¡ics
(
sy¡em
);

100 
	}
}

102 
	gSim¶eTh»ad
::~
	$Sim¶eTh»ad
()

104 
d–‘e
 
tc
;

105 
	}
}

108 
	gSim¶eTh»ad
::
	$keOv”From
(
Th»adCÚ‹xt
 *
ŞdCÚ‹xt
)

110 ::
	`keOv”From
(*
tc
, *
ŞdCÚ‹xt
);

111 
decod”
.
	`keOv”From
(
ŞdCÚ‹xt
->
	`g‘Decod”PŒ
());

113 
k”ÃlSts
 = 
ŞdCÚ‹xt
->
	`g‘K”ÃlSts
();

114 
funcExeIn¡
 = 
ŞdCÚ‹xt
->
	`»adFuncExeIn¡
();

115 
¡ÜeCÚdFau»s
 = 0;

116 
	}
}

119 
	gSim¶eTh»ad
::
	$cİyS‹
(
Th»adCÚ‹xt
 *
ŞdCÚ‹xt
)

122 
_¡©us
 = 
ŞdCÚ‹xt
->
	`¡©us
();

123 
	`cİyArchRegs
(
ŞdCÚ‹xt
);

124 ià(
FuÎSy¡em
)

125 
funcExeIn¡
 = 
ŞdCÚ‹xt
->
	`»adFuncExeIn¡
();

127 
_th»adId
 = 
ŞdCÚ‹xt
->
	`th»adId
();

128 
_cÚ‹xtId
 = 
ŞdCÚ‹xt
->
	`cÚ‹xtId
();

129 
	}
}

132 
	gSim¶eTh»ad
::
	$£rŸlize
(
o¡»am
 &
os
)

134 
Th»adS‹
::
	`£rŸlize
(
os
);

135 ::
	`£rŸlize
(*
tc
, 
os
);

136 
	}
}

140 
	gSim¶eTh»ad
::
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
)

142 
Th»adS‹
::
un£rŸlize
(
ı
, 
£ùiÚ
);

143 ::
un£rŸlize
(*
tc
, 
ı
, 
£ùiÚ
);

147 
	gSim¶eTh»ad
::
	$¡¬tup
()

149 
i§
->
	`¡¬tup
(
tc
);

150 
	}
}

153 
	gSim¶eTh»ad
::
	$dumpFuncProfe
()

155 
¡d
::
o¡»am
 *
os
 = 
simout
.
	`ü—‹
(
	`c¥rštf
("profile.%s.dat",

156 
ba£Cpu
->
	`Çme
()));

157 
´ofe
->
	`dump
(
tc
, *
os
);

158 
	}
}

161 
	gSim¶eTh»ad
::
	$aùiv©e
(
Cyşes
 
d–ay
)

163 ià(
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
)

166 
Ï¡Aùiv©e
 = 
	`curTick
();

173 
_¡©us
 = 
Th»adCÚ‹xt
::
Aùive
;

176 
ba£Cpu
->
	`aùiv©eCÚ‹xt
(
_th»adId
, 
d–ay
);

177 
	}
}

180 
	gSim¶eTh»ad
::
	$su¥’d
()

182 ià(
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Su¥’ded
)

185 
Ï¡Aùiv©e
 = 
	`curTick
();

186 
Ï¡Su¥’d
 = 
	`curTick
();

187 
_¡©us
 = 
Th»adCÚ‹xt
::
Su¥’ded
;

188 
ba£Cpu
->
	`su¥’dCÚ‹xt
(
_th»adId
);

189 
	}
}

193 
	gSim¶eTh»ad
::
	$h®t
()

195 ià(
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
H®‹d
)

198 
_¡©us
 = 
Th»adCÚ‹xt
::
H®‹d
;

199 
ba£Cpu
->
	`h®tCÚ‹xt
(
_th»adId
);

200 
	}
}

204 
	gSim¶eTh»ad
::
	$»gSts
(cÚ¡ 
¡ršg
 &
Çme
)

206 ià(
FuÎSy¡em
 && 
k”ÃlSts
)

207 
k”ÃlSts
->
	`»gSts
(
Çme
 + ".kern");

208 
	}
}

211 
	gSim¶eTh»ad
::
	$cİyArchRegs
(
Th»adCÚ‹xt
 *
¤c_tc
)

213 
TheISA
::
	`cİyRegs
(
¤c_tc
, 
tc
);

214 
	}
}

	@simple_thread.hh

45 #iâdeà
__CPU_SIMPLE_THREAD_HH__


46 
	#__CPU_SIMPLE_THREAD_HH__


	)

48 
	~"¬ch/decod”.hh
"

49 
	~"¬ch/i§.hh
"

50 
	~"¬ch/i§_Œa™s.hh
"

51 
	~"¬ch/»gi¡”s.hh
"

52 
	~"¬ch/b.hh
"

53 
	~"¬ch/ty³s.hh
"

54 
	~"ba£/ty³s.hh
"

55 
	~"cÚfig/the_i§.hh
"

56 
	~"ıu/th»ad_cÚ‹xt.hh
"

57 
	~"ıu/th»ad_¡©e.hh
"

58 
	~"debug/CCRegs.hh
"

59 
	~"debug/FlßtRegs.hh
"

60 
	~"debug/IÁRegs.hh
"

61 
	~"mem/·ge_bË.hh
"

62 
	~"mem/»que¡.hh
"

63 
	~"sim/by‹sw­.hh
"

64 
	~"sim/ev’tq.hh
"

65 
	~"sim/´oûss.hh
"

66 
	~"sim/£rŸlize.hh
"

67 
	~"sim/sy¡em.hh
"

69 
şass
 
	gBa£CPU
;

70 
şass
 
	gCheck”CPU
;

72 
şass
 
	gFunùiÚProfe
;

73 
şass
 
	gProfeNode
;

75 
Çme¥aû
 
	gTheISA
 {

76 
Çme¥aû
 
	gK”Ãl
 {

77 
şass
 
	gSti¡ics
;

97 şas 
	cSim¶eTh»ad
 : 
public
 
Th»adS‹


99 
´Ùeùed
:

100 
TheISA
::
	tMachIn¡
 MachInst;

101 
	mTheISA
::
	tMiscReg
 MiscReg;

102 
	mTheISA
::
	tFlßtReg
 FloatReg;

103 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

104 
	mTheISA
::
	tCCReg
 CCReg;

105 
	mpublic
:

106 
Th»adCÚ‹xt
::
	tStus
 Status;

108 
	m´Ùeùed
:

110 
FlßtReg
 
f
[
TheISA
::
NumFlßtRegs
];

111 
FlßtRegB™s
 
	mi
[
TheISA
::
NumFlßtRegs
];

112 } 
	gæßtRegs
;

113 
	gTheISA
::
IÁReg
 
štRegs
[
TheISA
::
NumIÁRegs
];

114 #ifdeà
ISA_HAS_CC_REGS


115 
	gTheISA
::
CCReg
 
ccRegs
[
TheISA
::
NumCCRegs
];

117 
	gTheISA
::
ISA
 *cÚ¡ 
i§
;

119 
	gTheISA
::
PCS‹
 
_pcS‹
;

122 
boŞ
 
	g´ediÿ‹
;

124 
	gpublic
:

125 
¡d
::
¡ršg
 
	$Çme
() const

127  
	`c¥rštf
("%s.[tid:%i]", 
ba£Cpu
->
	`Çme
(), 
tc
->
	`th»adId
());

128 
	}
}

130 
	gProxyTh»adCÚ‹xt
<
	gSim¶eTh»ad
> *
	gtc
;

132 
Sy¡em
 *
	gsy¡em
;

134 
	gTheISA
::
TLB
 *
™b
;

135 
	gTheISA
::
TLB
 *
dtb
;

137 
	gTheISA
::
Decod”
 
decod”
;

141 
Sim¶eTh»ad
(
Ba£CPU
 *
_ıu
, 
_th»ad_num
, 
Sy¡em
 *
_sy¡em
,

142 
TheISA
::
TLB
 *
_™b
, TheISA::TLB *
_dtb
, TheISA::
ISA
 *
_i§
,

143 
boŞ
 
u£_k”Ãl_¡©s
 = 
Œue
);

145 
Sim¶eTh»ad
(
Ba£CPU
 *
_ıu
, 
_th»ad_num
, 
Sy¡em
 *
_sy¡em
,

146 
Proûss
 *
_´oûss
, 
TheISA
::
TLB
 *
_™b
, TheISA::TLB *
_dtb
,

147 
TheISA
::
ISA
 *
_i§
);

149 
	gvœtu®
 ~
Sim¶eTh»ad
();

151 
vœtu®
 
keOv”From
(
Th»adCÚ‹xt
 *
ŞdCÚ‹xt
);

153 
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
);

155 
cİyS‹
(
Th»adCÚ‹xt
 *
ŞdCÚ‹xt
);

157 
£rŸlize
(
¡d
::
o¡»am
 &
os
);

158 
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
);

159 
¡¬tup
();

170 
Th»adCÚ‹xt
 *
	$g‘TC
(è{  
tc
; 
	}
}

172 
	$dem­Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

174 
™b
->
	`dem­Page
(
vaddr
, 
a¢
);

175 
dtb
->
	`dem­Page
(
vaddr
, 
a¢
);

176 
	}
}

178 
	$dem­In¡Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

180 
™b
->
	`dem­Page
(
vaddr
, 
a¢
);

181 
	}
}

183 
	$dem­D©aPage
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

185 
dtb
->
	`dem­Page
(
vaddr
, 
a¢
);

186 
	}
}

188 
dumpFuncProfe
();

190 
FauÉ
 
hw»i
();

192 
boŞ
 
simP®Check
(
·lFunc
);

198 
Ba£CPU
 *
	$g‘CpuPŒ
(è{  
ba£Cpu
; 
	}
}

200 
	gTheISA
::
TLB
 *
	$g‘ITBPŒ
(è{  
™b
; 
	}
}

202 
	gTheISA
::
TLB
 *
	$g‘DTBPŒ
(è{  
dtb
; 
	}
}

204 
Check”CPU
 *
	$g‘Check”CpuPŒ
(è{  
NULL
; 
	}
}

206 
	gTheISA
::
Decod”
 *
	$g‘Decod”PŒ
(è{  &
decod”
; 
	}
}

208 
Sy¡em
 *
	$g‘Sy¡emPŒ
(è{  
sy¡em
; 
	}
}

210 
Stus
 
	$¡©us
(ècÚ¡ {  
_¡©us
; 
	}
}

212 
	$£tStus
(
Stus
 
ÃwStus
è{ 
_¡©us
 =‚ewStus; 
	}
}

216 
aùiv©e
(
Cyşes
 
d–ay
 = Cycles(1));

219 
su¥’d
();

222 
h®t
();

224 
vœtu®
 
boŞ
 
mis¥ecuÏtšg
();

226 
cİyArchRegs
(
Th»adCÚ‹xt
 *
tc
);

228 
	$ş—rArchRegs
()

230 
_pcS‹
 = 0;

231 
	`mem£t
(
štRegs
, 0, (intRegs));

232 
	`mem£t
(
æßtRegs
.
i
, 0, (floatRegs.i));

233 #ifdeà
ISA_HAS_CC_REGS


234 
	`mem£t
(
ccRegs
, 0, (ccRegs));

236 
i§
->
	`ş—r
();

237 
	}
}

242 
ušt64_t
 
	$»adIÁReg
(
»g_idx
)

244 
æ©Index
 = 
i§
->
	`æ©‹nIÁIndex
(
»g_idx
);

245 
	`as£¹
(
æ©Index
 < 
TheISA
::
NumIÁRegs
);

246 
ušt64_t
 
	`»gV®
(
	`»adIÁRegFÏt
(
æ©Index
));

247 
	`DPRINTF
(
IÁRegs
, "Reading int„eg %d (%d)‡s %#x.\n",

248 
»g_idx
, 
æ©Index
, 
»gV®
);

249  
»gV®
;

250 
	}
}

252 
FlßtReg
 
	$»adFlßtReg
(
»g_idx
)

254 
æ©Index
 = 
i§
->
	`æ©‹nFlßtIndex
(
»g_idx
);

255 
	`as£¹
(
æ©Index
 < 
TheISA
::
NumFlßtRegs
);

256 
FlßtReg
 
	`»gV®
(
	`»adFlßtRegFÏt
(
æ©Index
));

257 
	`DPRINTF
(
FlßtRegs
, "Reading float„eg %d (%d)‡s %f, %#x.\n",

258 
»g_idx
, 
æ©Index
, 
»gV®
, 
æßtRegs
.
i
[flatIndex]);

259  
»gV®
;

260 
	}
}

262 
FlßtRegB™s
 
	$»adFlßtRegB™s
(
»g_idx
)

264 
æ©Index
 = 
i§
->
	`æ©‹nFlßtIndex
(
»g_idx
);

265 
	`as£¹
(
æ©Index
 < 
TheISA
::
NumFlßtRegs
);

266 
FlßtRegB™s
 
	`»gV®
(
	`»adFlßtRegB™sFÏt
(
æ©Index
));

267 
	`DPRINTF
(
FlßtRegs
, "Reading float„eg %d (%d) bits‡s %#x, %f.\n",

268 
»g_idx
, 
æ©Index
, 
»gV®
, 
æßtRegs
.
f
[flatIndex]);

269  
»gV®
;

270 
	}
}

272 
CCReg
 
	$»adCCReg
(
»g_idx
)

274 #ifdeà
ISA_HAS_CC_REGS


275 
æ©Index
 = 
i§
->
	`æ©‹nCCIndex
(
»g_idx
);

276 
	`as£¹
(
æ©Index
 < 
TheISA
::
NumCCRegs
);

277 
ušt64_t
 
	`»gV®
(
	`»adCCRegFÏt
(
æ©Index
));

278 
	`DPRINTF
(
CCRegs
, "Reading CC„eg %d (%d)‡s %#x.\n",

279 
»g_idx
, 
æ©Index
, 
»gV®
);

280  
»gV®
;

282 
	`·nic
("Triedo„ead‡ CC„egister.");

285 
	}
}

287 
	$£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
)

289 
æ©Index
 = 
i§
->
	`æ©‹nIÁIndex
(
»g_idx
);

290 
	`as£¹
(
æ©Index
 < 
TheISA
::
NumIÁRegs
);

291 
	`DPRINTF
(
IÁRegs
, "Setting int„eg %d (%d)o %#x.\n",

292 
»g_idx
, 
æ©Index
, 
v®
);

293 
	`£tIÁRegFÏt
(
æ©Index
, 
v®
);

294 
	}
}

296 
	$£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
)

298 
æ©Index
 = 
i§
->
	`æ©‹nFlßtIndex
(
»g_idx
);

299 
	`as£¹
(
æ©Index
 < 
TheISA
::
NumFlßtRegs
);

300 
	`£tFlßtRegFÏt
(
æ©Index
, 
v®
);

301 
	`DPRINTF
(
FlßtRegs
, "Setting float„eg %d (%d)o %f, %#x.\n",

302 
»g_idx
, 
æ©Index
, 
v®
, 
æßtRegs
.
i
[flatIndex]);

303 
	}
}

305 
	$£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
)

307 
æ©Index
 = 
i§
->
	`æ©‹nFlßtIndex
(
»g_idx
);

308 
	`as£¹
(
æ©Index
 < 
TheISA
::
NumFlßtRegs
);

311 ià(
æ©Index
 < 
TheISA
::
NumFlßtRegs
)

312 
	`£tFlßtRegB™sFÏt
(
æ©Index
, 
v®
);

313 
	`DPRINTF
(
FlßtRegs
, "Setting float„eg %d (%d) bitso %#x, %#f.\n",

314 
»g_idx
, 
æ©Index
, 
v®
, 
æßtRegs
.
f
[flatIndex]);

315 
	}
}

317 
	$£tCCReg
(
»g_idx
, 
CCReg
 
v®
)

319 #ifdeà
ISA_HAS_CC_REGS


320 
æ©Index
 = 
i§
->
	`æ©‹nCCIndex
(
»g_idx
);

321 
	`as£¹
(
æ©Index
 < 
TheISA
::
NumCCRegs
);

322 
	`DPRINTF
(
CCRegs
, "Setting CC„eg %d (%d)o %#x.\n",

323 
»g_idx
, 
æ©Index
, 
v®
);

324 
	`£tCCRegFÏt
(
æ©Index
, 
v®
);

326 
	`·nic
("Triedo set‡ CC„egister.");

328 
	}
}

330 
	gTheISA
::
PCS‹


331 
	$pcS‹
()

333  
_pcS‹
;

334 
	}
}

337 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

339 
_pcS‹
 = 
v®
;

343 
pcS‹NoRecÜd
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
)

345 
_pcS‹
 = 
v®
;

348 
Addr


349 
	$š¡Addr
()

351  
_pcS‹
.
	`š¡Addr
();

352 
	}
}

354 
Addr


355 
	$ÃxtIn¡Addr
()

357  
_pcS‹
.
	`ÃxtIn¡Addr
();

358 
	}
}

360 
MiüoPC


361 
	$miüoPC
()

363  
_pcS‹
.
	`miüoPC
();

364 
	}
}

366 
boŞ
 
	$»adP»diÿ‹
()

368  
´ediÿ‹
;

369 
	}
}

371 
	$£tP»diÿ‹
(
boŞ
 
v®
)

373 
´ediÿ‹
 = 
v®
;

374 
	}
}

376 
MiscReg


377 
	$»adMiscRegNoEfãù
(
misc_»g
, 
Th»adID
 
tid
 = 0)

379  
i§
->
	`»adMiscRegNoEfãù
(
misc_»g
);

380 
	}
}

382 
MiscReg


383 
	$»adMiscReg
(
misc_»g
, 
Th»adID
 
tid
 = 0)

385  
i§
->
	`»adMiscReg
(
misc_»g
, 
tc
);

386 
	}
}

389 
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
, 
Th»adID
 
tid
 = 0)

391  
i§
->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
);

392 
	}
}

395 
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
, 
Th»adID
 
tid
 = 0)

397  
i§
->
	`£tMiscReg
(
misc_»g
, 
v®
, 
tc
);

398 
	}
}

401 
	$æ©‹nIÁIndex
(
»g
)

403  
i§
->
	`æ©‹nIÁIndex
(
»g
);

404 
	}
}

407 
	$æ©‹nFlßtIndex
(
»g
)

409  
i§
->
	`æ©‹nFlßtIndex
(
»g
);

410 
	}
}

413 
	$æ©‹nCCIndex
(
»g
)

415  
i§
->
	`æ©‹nCCIndex
(
»g
);

416 
	}
}

418 
	$»adStCÚdFau»s
(è{  
¡ÜeCÚdFau»s
; 
	}
}

420 
	$£tStCÚdFau»s
(
sc_çu»s
)

421 { 
¡ÜeCÚdFau»s
 = 
sc_çu»s
; 
	}
}

423 
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

425 
´oûss
->
	`sysÿÎ
(
ÿÎnum
, 
tc
);

426 
	}
}

428 
ušt64_t
 
	$»adIÁRegFÏt
(
idx
è{  
štRegs
[idx]; 
	}
}

429 
	$£tIÁRegFÏt
(
idx
, 
ušt64_t
 
v®
è{ 
štRegs
[idx] = v®; 
	}
}

431 
FlßtReg
 
	$»adFlßtRegFÏt
(
idx
è{  
æßtRegs
.
f
[idx]; 
	}
}

432 
	$£tFlßtRegFÏt
(
idx
, 
FlßtReg
 
v®
è{ 
æßtRegs
.
f
[idx] = v®; 
	}
}

434 
FlßtRegB™s
 
	$»adFlßtRegB™sFÏt
(
idx
è{  
æßtRegs
.
i
[idx]; 
	}
}

435 
	$£tFlßtRegB™sFÏt
(
idx
, 
FlßtRegB™s
 
v®
) {

436 
æßtRegs
.
i
[
idx
] = 
v®
;

437 
	}
}

439 #ifdeà
ISA_HAS_CC_REGS


440 
CCReg
 
	$»adCCRegFÏt
(
idx
è{  
ccRegs
[idx]; 
	}
}

441 
	$£tCCRegFÏt
(
idx
, 
CCReg
 
v®
è{ 
ccRegs
[idx] = v®; 
	}
}

443 
CCReg
 
	$»adCCRegFÏt
(
idx
)

444 { 
	`·nic
("»adCCRegFÏˆw/nØCC„egs!\n"); 
	}
}

446 
	$£tCCRegFÏt
(
idx
, 
CCReg
 
v®
)

447 { 
	`·nic
("£tCCRegFÏˆw/nØCC„egs!\n"); 
	}
}

453 
šlše
 
boŞ


454 
	gSim¶eTh»ad
::
	$mis¥ecuÏtšg
()

456  
çl£
;

457 
	}
}

	@smt.hh

36 #iâdeà
__SMT_HH__


37 
	#__SMT_HH__


	)

39 
	~"ba£/ty³s.hh
"

41 #iâdeà
SMT_MAX_THREADS


43 
	#SMT_MAX_THREADS
 4

	)

53 
maxTh»adsP”CPU
;

61 
chªge_th»ad_¡©e
(
Th»adID
 
tid
, 
aùiv©e
, 
´iÜ™y
);

	@static_inst.cc

32 
	~<io¡»am
>

34 
	~"ıu/¡©ic_š¡.hh
"

35 
	~"sim/cÜe.hh
"

37 
SticIn¡PŒ
 
	gSticIn¡
::
nuÎSticIn¡PŒ
;

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
	gSticIn¡
::~
	$SticIn¡
()

43 ià(
ÿchedDi§s£mbly
)

44 
d–‘e
 
ÿchedDi§s£mbly
;

45 
	}
}

47 
boŞ


48 
	gSticIn¡
::
hasB¿nchT¬g‘
(cÚ¡ 
TheISA
::
PCS‹
 &
pc
, 
Th»adCÚ‹xt
 *
tc
,

49 
TheISA
::
PCS‹
 &
tgt
) const

51 ià(
isDœeùCŒl
()) {

52 
tgt
 = 
b¿nchT¬g‘
(
pc
);

53  
	gŒue
;

56 ià(
isIndœeùCŒl
()) {

57 
	gtgt
 = 
b¿nchT¬g‘
(
tc
);

58  
	gŒue
;

61  
	gçl£
;

64 
SticIn¡PŒ


65 
	gSticIn¡
::
	$ãtchMiüoİ
(
MiüoPC
 
upc
) const

67 
	`·nic
("StaticInst::fetchMicroop() called on instruction "

69 
	}
}

71 
	gTheISA
::
PCS‹


72 
SticIn¡
::
b¿nchT¬g‘
(cÚ¡ 
TheISA
::
PCS‹
 &
pc
) const

74 
·nic
("StaticInst::branchTarget() called on instruction "

76 
	gM5_DUMMY_RETURN
;

79 
	gTheISA
::
PCS‹


80 
SticIn¡
::
	$b¿nchT¬g‘
(
Th»adCÚ‹xt
 *
tc
) const

82 
	`·nic
("StaticInst::branchTarget() called on instruction "

84 
M5_DUMMY_RETURN
;

85 
	}
}

87 cÚ¡ 
	g¡ršg
 &

88 
	gSticIn¡
::
	$di§s£mbË
(
Addr
 
pc
, cÚ¡ 
SymbŞTabË
 *
symb
) const

90 ià(!
ÿchedDi§s£mbly
)

91 
ÿchedDi§s£mbly
 = 
Ãw
 
	`¡ršg
(
	`g’”©eDi§s£mbly
(
pc
, 
symb
));

93  *
ÿchedDi§s£mbly
;

94 
	}
}

	@static_inst.hh

32 #iâdeà
__CPU_STATIC_INST_HH__


33 
	#__CPU_STATIC_INST_HH__


	)

35 
	~<b™£t
>

36 
	~<¡ršg
>

38 
	~"¬ch/»gi¡”s.hh
"

39 
	~"¬ch/ty³s.hh
"

40 
	~"ba£/misc.hh
"

41 
	~"ba£/»fút.hh
"

42 
	~"ba£/ty³s.hh
"

43 
	~"cÚfig/the_i§.hh
"

44 
	~"ıu/İ_şass.hh
"

45 
	~"ıu/¡©ic_š¡_fwd.hh
"

46 
	~"ıu/th»ad_cÚ‹xt.hh
"

47 
	~"sim/çuÉ_fwd.hh
"

50 
şass
 
	gPack‘
;

52 
	gO3CPUIm¶
;

53 
	g‹m¶©e
 <
şass
 
	gIm¶
> cÏs 
	gBa£O3DynIn¡
;

54 
	gBa£O3DynIn¡
<
	tO3CPUIm¶
> 
	tO3DynIn¡
;

55 
şass
 
	gInOrd”DynIn¡
;

57 
şass
 
	gCheck”CPU
;

58 
şass
 
	gAtomicSim¶eCPU
;

59 
şass
 
	gTimšgSim¶eCPU
;

60 
şass
 
	gInÜd”CPU
;

61 
şass
 
	gTimšgCGRA
;

62 
şass
 
	gSymbŞTabË
;

64 
Çme¥aû
 
	gT¿û
 {

65 
şass
 
	gIn¡RecÜd
;

76 şas 
	cSticIn¡
 : 
public
 
RefCouÁed


78 
public
:

80 
TheISA
::
	tExtMachIn¡
 ExtMachInst;

82 
	mTheISA
::
	tRegIndex
 RegIndex;

85 
	mMaxIn¡SrcRegs
 = 
TheISA
::
MaxIn¡SrcRegs
,

86 
	mMaxIn¡De¡Regs
 = 
TheISA
::
MaxIn¡De¡Regs


110 
	eFÏgs
 {

111 
	gIsNİ
,

113 
	gIsIÁeg”
,

114 
	gIsFlßtšg
,

115 
	gIsCC
,

117 
	gIsMemRef
,

118 
	gIsLßd
,

119 
	gIsStÜe
,

120 
	gIsStÜeCÚd™iÚ®
,

121 
	gIsIndexed
,

122 
	gIsIn¡P»ãtch
,

123 
	gIsD©aP»ãtch
,

125 
	gIsCÚŒŞ
,

126 
	gIsDœeùCÚŒŞ
,

127 
	gIsIndœeùCÚŒŞ
,

128 
	gIsCÚdCÚŒŞ
,

129 
	gIsUncÚdCÚŒŞ
,

130 
	gIsC®l
,

131 
	gIsR‘uº
,

133 
	gIsCÚdD–aySlÙ
,

135 
	gIsTh»adSync
,

137 
	gIsS”Ÿlizšg
,

139 
	gIsS”ŸlizeBefÜe
,

140 
	gIsS”ŸlizeAá”
,

141 
	gIsMemB¬r›r
,

142 
	gIsWr™eB¬r›r
,

143 
	gIsR—dB¬r›r
,

144 
	gIsERET
,

146 
	gIsNÚS³cuÏtive
,

147 
	gIsQu›sû
,

149 
	gIsI´Acûss
,

150 
	gIsUnv”ifŸbË
,

152 
	gIsSysÿÎ
,

156 
	gIsMaüoİ
,

157 
	gIsMiüoİ
,

158 
	gIsD–ayedComm™
,

159 
	gIsLa¡Miüoİ
,

160 
	gIsFœ¡Miüoİ
,

162 
	gIsMiüoB¿nch
,

163 
	gIsD¥Op
,

164 
	gIsSquashAá”
,

165 
	gNumFÏgs


168 
	g´Ùeùed
:

171 
¡d
::
b™£t
<
NumFÏgs
> 
æags
;

174 
OpCÏss
 
	g_İCÏss
;

177 
št8_t
 
	g_numSrcRegs
;

180 
št8_t
 
	g_numDe¡Regs
;

185 
št8_t
 
	g_numFPDe¡Regs
;

186 
št8_t
 
	g_numIÁDe¡Regs
;

187 
št8_t
 
	g_numCCDe¡Regs
;

190 
	gpublic
:

199 
št8_t
 
	$numSrcRegs
(ècÚ¡ {  
_numSrcRegs
; 
	}
}

201 
št8_t
 
	$numDe¡Regs
(ècÚ¡ {  
_numDe¡Regs
; 
	}
}

203 
št8_t
 
	$numFPDe¡Regs
(ècÚ¡ {  
_numFPDe¡Regs
; 
	}
}

205 
št8_t
 
	$numIÁDe¡Regs
(ècÚ¡ {  
_numIÁDe¡Regs
; 
	}
}

214 
boŞ
 
	$isNİ
(ècÚ¡ {  
æags
[
IsNİ
]; 
	}
}

216 
boŞ
 
	$isMemRef
(ècÚ¡ {  
æags
[
IsMemRef
]; 
	}
}

217 
boŞ
 
	$isLßd
(ècÚ¡ {  
æags
[
IsLßd
]; 
	}
}

218 
boŞ
 
	$isStÜe
(ècÚ¡ {  
æags
[
IsStÜe
]; 
	}
}

219 
boŞ
 
	$isStÜeCÚd™iÚ®
(ècÚ¡ {  
æags
[
IsStÜeCÚd™iÚ®
]; 
	}
}

220 
boŞ
 
	$isIn¡P»ãtch
(ècÚ¡ {  
æags
[
IsIn¡P»ãtch
]; 
	}
}

221 
boŞ
 
	$isD©aP»ãtch
(ècÚ¡ {  
æags
[
IsD©aP»ãtch
]; 
	}
}

222 
boŞ
 
	$isP»ãtch
(ècÚ¡ {  
	`isIn¡P»ãtch
() ||

223 
	`isD©aP»ãtch
(); 
	}
}

225 
boŞ
 
	$isIÁeg”
(ècÚ¡ {  
æags
[
IsIÁeg”
]; 
	}
}

226 
boŞ
 
	$isFlßtšg
(ècÚ¡ {  
æags
[
IsFlßtšg
]; 
	}
}

227 
boŞ
 
	$isCC
(ècÚ¡ {  
æags
[
IsCC
]; 
	}
}

229 
boŞ
 
	$isCÚŒŞ
(ècÚ¡ {  
æags
[
IsCÚŒŞ
]; 
	}
}

230 
boŞ
 
	$isC®l
(ècÚ¡ {  
æags
[
IsC®l
]; 
	}
}

231 
boŞ
 
	$isR‘uº
(ècÚ¡ {  
æags
[
IsR‘uº
]; 
	}
}

232 
boŞ
 
	$isDœeùCŒl
(ècÚ¡ {  
æags
[
IsDœeùCÚŒŞ
]; 
	}
}

233 
boŞ
 
	$isIndœeùCŒl
(ècÚ¡ {  
æags
[
IsIndœeùCÚŒŞ
]; 
	}
}

234 
boŞ
 
	$isCÚdCŒl
(ècÚ¡ {  
æags
[
IsCÚdCÚŒŞ
]; 
	}
}

235 
boŞ
 
	$isUncÚdCŒl
(ècÚ¡ {  
æags
[
IsUncÚdCÚŒŞ
]; 
	}
}

236 
boŞ
 
	$isCÚdD–aySlÙ
(ècÚ¡ {  
æags
[
IsCÚdD–aySlÙ
]; 
	}
}

238 
boŞ
 
	$isTh»adSync
(ècÚ¡ {  
æags
[
IsTh»adSync
]; 
	}
}

239 
boŞ
 
	$isS”Ÿlizšg
(ècÚ¡ {  
æags
[
IsS”Ÿlizšg
] ||

240 
æags
[
IsS”ŸlizeBefÜe
] ||

241 
æags
[
IsS”ŸlizeAá”
]; 
	}
}

242 
boŞ
 
	$isS”ŸlizeBefÜe
(ècÚ¡ {  
æags
[
IsS”ŸlizeBefÜe
]; 
	}
}

243 
boŞ
 
	$isS”ŸlizeAá”
(ècÚ¡ {  
æags
[
IsS”ŸlizeAá”
]; 
	}
}

244 
boŞ
 
	$isSquashAá”
(ècÚ¡ {  
æags
[
IsSquashAá”
]; 
	}
}

245 
boŞ
 
	$isMemB¬r›r
(ècÚ¡ {  
æags
[
IsMemB¬r›r
]; 
	}
}

246 
boŞ
 
	$isWr™eB¬r›r
(ècÚ¡ {  
æags
[
IsWr™eB¬r›r
]; 
	}
}

247 
boŞ
 
	$isNÚS³cuÏtive
(ècÚ¡ {  
æags
[
IsNÚS³cuÏtive
]; 
	}
}

248 
boŞ
 
	$isQu›sû
(ècÚ¡ {  
æags
[
IsQu›sû
]; 
	}
}

249 
boŞ
 
	$isI´Acûss
(ècÚ¡ {  
æags
[
IsI´Acûss
]; 
	}
}

250 
boŞ
 
	$isUnv”ifŸbË
(ècÚ¡ {  
æags
[
IsUnv”ifŸbË
]; 
	}
}

251 
boŞ
 
	$isSysÿÎ
(ècÚ¡ {  
æags
[
IsSysÿÎ
]; 
	}
}

252 
boŞ
 
	$isMaüoİ
(ècÚ¡ {  
æags
[
IsMaüoİ
]; 
	}
}

253 
boŞ
 
	$isMiüoİ
(ècÚ¡ {  
æags
[
IsMiüoİ
]; 
	}
}

254 
boŞ
 
	$isD–ayedComm™
(ècÚ¡ {  
æags
[
IsD–ayedComm™
]; 
	}
}

255 
boŞ
 
	$isLa¡Miüoİ
(ècÚ¡ {  
æags
[
IsLa¡Miüoİ
]; 
	}
}

256 
boŞ
 
	$isFœ¡Miüoİ
(ècÚ¡ {  
æags
[
IsFœ¡Miüoİ
]; 
	}
}

258 
boŞ
 
	$isMiüoB¿nch
(ècÚ¡ {  
æags
[
IsMiüoB¿nch
]; 
	}
}

261 
	$£tLa¡Miüoİ
(è{ 
æags
[
IsLa¡Miüoİ
] = 
Œue
; 
	}
}

262 
	$£tD–ayedComm™
(è{ 
æags
[
IsD–ayedComm™
] = 
Œue
; 
	}
}

263 
	$£tFÏg
(
FÏgs
 
f
è{ 
æags
[f] = 
Œue
; 
	}
}

266 
OpCÏss
 
	$İCÏss
(ècÚ¡ {  
_İCÏss
; 
	}
}

271 
RegIndex
 
	$de¡RegIdx
(
i
ècÚ¡ {  
_de¡RegIdx
[i]; 
	}
}

275 
RegIndex
 
	$¤cRegIdx
(
i
ècÚ¡ {  
_¤cRegIdx
[i]; 
	}
}

280 
SticIn¡PŒ
 
	gnuÎSticIn¡PŒ
;

288 
vœtu®
 const

289 
	gSticIn¡PŒ
 &
	$—CompIn¡
(ècÚ¡ {  
nuÎSticIn¡PŒ
; 
	}
}

297 
vœtu®
 const

298 
	gSticIn¡PŒ
 &
	$memAccIn¡
(ècÚ¡ {  
nuÎSticIn¡PŒ
; 
	}
}

301 cÚ¡ 
ExtMachIn¡
 
	gmachIn¡
;

303 
	g´Ùeùed
:

306 
RegIndex
 
_de¡RegIdx
[
MaxIn¡De¡Regs
];

308 
RegIndex
 
	g_¤cRegIdx
[
MaxIn¡SrcRegs
];

316 cÚ¡ *
	gmÃmÚic
;

322 
mubË
 
	g¡d
::
¡ršg
 *
ÿchedDi§s£mbly
;

327 
vœtu®
 
	g¡d
::
¡ršg


328 
	$g’”©eDi§s£mbly
(
Addr
 
pc
, cÚ¡ 
SymbŞTabË
 *
symb
) const = 0;

335 
	$SticIn¡
(cÚ¡ *
_mÃmÚic
, 
ExtMachIn¡
 
_machIn¡
, 
OpCÏss
 
__İCÏss
)

336 : 
	`_İCÏss
(
__İCÏss
), 
	`_numSrcRegs
(0), 
	`_numDe¡Regs
(0),

337 
	`_numFPDe¡Regs
(0), 
	`_numIÁDe¡Regs
(0),

338 
	`machIn¡
(
_machIn¡
), 
	`mÃmÚic
(
_mÃmÚic
), 
	$ÿchedDi§s£mbly
(0)

339 { 
	}
}

341 
	gpublic
:

342 
vœtu®
 ~
SticIn¡
();

348 
	~"ıu/¡©ic_š¡_exec_sigs.hh
"

350 
vœtu®
 
advªûPC
(
TheISA
::
PCS‹
 &
pcS‹
) const = 0;

356 
vœtu®
 
SticIn¡PŒ
 
	$ãtchMiüoİ
(
MiüoPC
 
upc
) const;

363 
vœtu®
 
TheISA
::
PCS‹
 
	`b¿nchT¬g‘
(cÚ¡ TheISA::PCS‹ &
pc
) const;

372 
vœtu®
 
TheISA
::
PCS‹
 
	$b¿nchT¬g‘
(
Th»adCÚ‹xt
 *
tc
) const;

378 
boŞ
 
	`hasB¿nchT¬g‘
(cÚ¡ 
TheISA
::
PCS‹
 &
pc
, 
Th»adCÚ‹xt
 *
tc
,

379 
TheISA
::
PCS‹
 &
tgt
) const;

388 
vœtu®
 cÚ¡ 
¡d
::
¡ršg
 &
	$di§s£mbË
(
Addr
 
pc
,

389 cÚ¡ 
SymbŞTabË
 *
symb
 = 0) const;

392 
¡d
::
¡ršg
 
	$g‘Name
(è{  
mÃmÚic
; 
	}
}

	@static_inst_fwd.hh

31 #iâdeà
__CPU_STATIC_INST_FWD_HH__


32 
	#__CPU_STATIC_INST_FWD_HH__


	)

34 
şass
 
	gSticIn¡
;

35 
	g‹m¶©e
 <
şass
 
	gT
> cÏs 
	gRefCouÁšgPŒ
;

36 
	gRefCouÁšgPŒ
<
	tSticIn¡
> 
	tSticIn¡PŒ
;

	@testers/directedtest/DirectedGenerator.cc

30 
	~"ıu/‹¡”s/dœeùed‹¡/DœeùedG’”©Ü.hh
"

31 
	~"sim/sy¡em.hh
"

33 
	gDœeùedG’”©Ü
::
	$DœeùedG’”©Ü
(cÚ¡ 
P¬ams
 *
p
)

34 : 
	`SimObjeù
(
p
),

35 
	`ma¡”Id
(
p
->
sy¡em
->
	`g‘Ma¡”Id
(
	$Çme
()))

37 
m_num_ıus
 = 
p
->
num_ıus
;

38 
m_dœeùed_‹¡”
 = 
NULL
;

39 
	}
}

42 
	gDœeùedG’”©Ü
::
	$£tDœeùedTe¡”
(
RubyDœeùedTe¡”
* 
dœeùed_‹¡”
)

44 
	`as£¹
(
m_dœeùed_‹¡”
 =ğ
NULL
);

45 
m_dœeùed_‹¡”
 = 
dœeùed_‹¡”
;

46 
	}
}

	@testers/directedtest/DirectedGenerator.hh

29 #iâdeà
__CPU_DIRECTEDTEST_DIRECTEDGENERATOR_HH__


30 
	#__CPU_DIRECTEDTEST_DIRECTEDGENERATOR_HH__


	)

32 
	~"ıu/‹¡”s/dœeùed‹¡/DœeùedG’”©Ü.hh
"

33 
	~"ıu/‹¡”s/dœeùed‹¡/RubyDœeùedTe¡”.hh
"

34 
	~"·¿ms/DœeùedG’”©Ü.hh
"

35 
	~"sim/sim_objeù.hh
"

37 şas 
	cDœeùedG’”©Ü
 : 
public
 
SimObjeù


39 
public
:

40 
DœeùedG’”©ÜP¬ams
 
	tP¬ams
;

41 
DœeùedG’”©Ü
(cÚ¡ 
P¬ams
 *
p
);

43 
	mvœtu®
 ~
	$DœeùedG’”©Ü
() {}

45 
vœtu®
 
boŞ
 
	`š™Ÿ‹
() = 0;

46 
vœtu®
 
	`³rfÜmC®lback
(
ušt32_t
 
´oc
, 
Addr
 
add»ss
) = 0;

48 
	`£tDœeùedTe¡”
(
RubyDœeùedTe¡”
* 
dœeùed_‹¡”
);

50 
´Ùeùed
:

51 
m_num_ıus
;

52 
Ma¡”ID
 
ma¡”Id
;

53 
RubyDœeùedTe¡”
* 
m_dœeùed_‹¡”
;

54 
	}
};

	@testers/directedtest/InvalidateGenerator.cc

30 
	~"ıu/‹¡”s/dœeùed‹¡/DœeùedG’”©Ü.hh
"

31 
	~"ıu/‹¡”s/dœeùed‹¡/Inv®id©eG’”©Ü.hh
"

32 
	~"ıu/‹¡”s/dœeùed‹¡/RubyDœeùedTe¡”.hh
"

33 
	~"debug/DœeùedTe¡.hh
"

35 
	gInv®id©eG’”©Ü
::
	$Inv®id©eG’”©Ü
(cÚ¡ 
P¬ams
 *
p
)

36 : 
	$DœeùedG’”©Ü
(
p
)

41 
m_¡©us
 = 
Inv®id©eG’”©ÜStus_Lßd_Wa™šg
;

42 
m_aùive_»ad_node
 = 0;

43 
m_aùive_šv_node
 = 0;

44 
m_add»ss
 = 0x0;

45 
m_addr_šüem’t_size
 = 
p
->
addr_šüem’t_size
;

46 
	}
}

48 
	gInv®id©eG’”©Ü
::~
	$Inv®id©eG’”©Ü
()

50 
	}
}

52 
boŞ


53 
Inv®id©eG’”©Ü
::
	$š™Ÿ‹
()

55 
Ma¡”PÜt
* 
pÜt
;

56 
Reque¡
::
FÏgs
 
æags
;

57 
Pack‘PŒ
 
pkt
;

58 
Pack‘
::
Commªd
 
cmd
;

61 
Reque¡
 *
»q
 = 
Ãw
 
	`Reque¡
(
m_add»ss
, 1, 
æags
, 
ma¡”Id
);

66 ià(
m_¡©us
 =ğ
Inv®id©eG’”©ÜStus_Lßd_Wa™šg
) {

67 
	`DPRINTF
(
DœeùedTe¡
, "initiating„ead\n");

68 
cmd
 = 
MemCmd
::
R—dReq
;

69 
pÜt
 = 
m_dœeùed_‹¡”
->
	`g‘CpuPÜt
(
m_aùive_»ad_node
);

70 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
cmd
);

71 } ià(
m_¡©us
 =ğ
Inv®id©eG’”©ÜStus_Inv_Wa™šg
) {

72 
	`DPRINTF
(
DœeùedTe¡
, "initiating invalidating write\n");

73 
cmd
 = 
MemCmd
::
Wr™eReq
;

74 
pÜt
 = 
m_dœeùed_‹¡”
->
	`g‘CpuPÜt
(
m_aùive_šv_node
);

75 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
cmd
);

77 
	`·nic
("initiate was unexpectedly called\n");

79 
ušt8_t
* 
dummyD©a
 = 
Ãw
 uint8_t;

80 *
dummyD©a
 = 0;

81 
pkt
->
	`d©aDyÇmic
(
dummyD©a
);

83 ià(
pÜt
->
	`£ndTimšgReq
(
pkt
)) {

84 
	`DPRINTF
(
DœeùedTe¡
, "initiating„equest - successful\n");

85 ià(
m_¡©us
 =ğ
Inv®id©eG’”©ÜStus_Lßd_Wa™šg
) {

86 
m_¡©us
 = 
Inv®id©eG’”©ÜStus_Lßd_P’dšg
;

88 
m_¡©us
 = 
Inv®id©eG’”©ÜStus_Inv_P’dšg
;

90  
Œue
;

95 
d–‘e
 
pkt
->
»q
;

96 
d–‘e
 
pkt
;

98 
	`DPRINTF
(
DœeùedTe¡
, "failedo issue„equest - sequencer‚ot„eady\n");

99  
çl£
;

101 
	}
}

104 
	gInv®id©eG’”©Ü
::
	$³rfÜmC®lback
(
ušt32_t
 
´oc
, 
Addr
 
add»ss
)

106 
	`as£¹
(
m_add»ss
 =ğ
add»ss
);

108 ià(
m_¡©us
 =ğ
Inv®id©eG’”©ÜStus_Lßd_P’dšg
) {

109 
	`as£¹
(
m_aùive_»ad_node
 =ğ
´oc
);

110 
m_aùive_»ad_node
++;

114 ià(
m_aùive_»ad_node
 =ğ
m_num_ıus
) {

115 
m_¡©us
 = 
Inv®id©eG’”©ÜStus_Inv_Wa™šg
;

116 
m_aùive_»ad_node
 = 0;

118 
m_¡©us
 = 
Inv®id©eG’”©ÜStus_Lßd_Wa™šg
;

120 } ià(
m_¡©us
 =ğ
Inv®id©eG’”©ÜStus_Inv_P’dšg
) {

121 
	`as£¹
(
m_aùive_šv_node
 =ğ
´oc
);

122 
m_aùive_šv_node
++;

123 ià(
m_aùive_šv_node
 =ğ
m_num_ıus
) {

124 
m_add»ss
 +ğ
m_addr_šüem’t_size
;

125 
m_aùive_šv_node
 = 0;

131 
m_dœeùed_‹¡”
->
	`šüem’tCyşeCom¶‘iÚs
();

132 
m_¡©us
 = 
Inv®id©eG’”©ÜStus_Lßd_Wa™šg
;

135 
	}
}

137 
Inv®id©eG’”©Ü
 *

138 
	gInv®id©eG’”©ÜP¬ams
::
	$ü—‹
()

140  
Ãw
 
	`Inv®id©eG’”©Ü
(
this
);

141 
	}
}

	@testers/directedtest/InvalidateGenerator.hh

35 #iâdeà
__CPU_DIRECTEDTEST_INVALIDATEGENERATOR_HH__


36 
	#__CPU_DIRECTEDTEST_INVALIDATEGENERATOR_HH__


	)

38 
	~"ıu/‹¡”s/dœeùed‹¡/DœeùedG’”©Ü.hh
"

39 
	~"ıu/‹¡”s/dœeùed‹¡/RubyDœeùedTe¡”.hh
"

40 
	~"mem/´ÙocŞ/Inv®id©eG’”©ÜStus.hh
"

41 
	~"·¿ms/Inv®id©eG’”©Ü.hh
"

43 şas 
	cInv®id©eG’”©Ü
 : 
public
 
DœeùedG’”©Ü


45 
public
:

46 
Inv®id©eG’”©ÜP¬ams
 
	tP¬ams
;

47 
Inv®id©eG’”©Ü
(cÚ¡ 
P¬ams
 *
p
);

49 ~
Inv®id©eG’”©Ü
();

51 
boŞ
 
š™Ÿ‹
();

52 
³rfÜmC®lback
(
ušt32_t
 
´oc
, 
Addr
 
add»ss
);

54 
	m´iv©e
:

55 
Inv®id©eG’”©ÜStus
 
m_¡©us
;

56 
Addr
 
	mm_add»ss
;

57 
ušt32_t
 
	mm_aùive_»ad_node
;

58 
ušt32_t
 
	mm_aùive_šv_node
;

59 
ušt32_t
 
	mm_addr_šüem’t_size
;

	@testers/directedtest/RubyDirectedTester.cc

42 
	~"ıu/‹¡”s/dœeùed‹¡/DœeùedG’”©Ü.hh
"

43 
	~"ıu/‹¡”s/dœeùed‹¡/RubyDœeùedTe¡”.hh
"

44 
	~"debug/DœeùedTe¡.hh
"

45 
	~"sim/sim_ex™.hh
"

47 
	gRubyDœeùedTe¡”
::
	$RubyDœeùedTe¡”
(cÚ¡ 
P¬ams
 *
p
)

48 : 
	`MemObjeù
(
p
), 
	`dœeùedS¹Ev’t
(
this
),

49 
	`m_»que¡s_to_com¶‘e
(
p
->
»que¡s_to_com¶‘e
),

50 
	`g’”©Ü
(
p
->
g’”©Ü
)

52 
m_»que¡s_com¶‘ed
 = 0;

55 
i
 = 0; i < 
p
->
pÜt_ıuPÜt_cÚÃùiÚ_couÁ
; ++i) {

56 
pÜts
.
	`push_back
(
Ãw
 
	`CpuPÜt
(
	`c¥rštf
("%s-pÜt%d", 
	`Çme
(), 
i
),

57 
this
, 
i
));

61 
	`scheduË
(
dœeùedS¹Ev’t
, 1);

62 
	}
}

64 
	gRubyDœeùedTe¡”
::~
	$RubyDœeùedTe¡”
()

66 
i
 = 0; i < 
pÜts
.
	`size
(); i++)

67 
d–‘e
 
pÜts
[
i
];

68 
	}
}

71 
	gRubyDœeùedTe¡”
::
	$š™
()

73 
	`as£¹
(
pÜts
.
	`size
() > 0);

74 
g’”©Ü
->
	`£tDœeùedTe¡”
(
this
);

75 
	}
}

77 
	gBa£Ma¡”PÜt
 &

78 
	gRubyDœeùedTe¡”
::
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
, 
PÜtID
 
idx
)

80 ià(
	gif_Çme
 != "cpuPort") {

82  
MemObjeù
::
g‘Ma¡”PÜt
(
if_Çme
, 
idx
);

84 ià(
	gidx
 >ğ
¡©ic_ÿ¡
<>(
pÜts
.
size
())) {

85 
·nic
("RubyDœeùedTe¡”::g‘Ma¡”PÜt: unknowÀšdex %d\n", 
idx
);

88  *
	gpÜts
[
idx
];

92 
boŞ


93 
	gRubyDœeùedTe¡”
::
CpuPÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

95 
‹¡”
->
	`h™C®lback
(
id
, 
pkt
->
	`g‘Addr
());

100 
d–‘e
 
pkt
->
»q
;

101 
d–‘e
 
pkt
;

102  
Œue
;

103 
	}
}

105 
Ma¡”PÜt
*

106 
	gRubyDœeùedTe¡”
::
	$g‘CpuPÜt
(
idx
)

108 
	`as£¹
(
idx
 >ğ0 && idx < 
pÜts
.
	`size
());

110  
pÜts
[
idx
];

111 
	}
}

114 
	gRubyDœeùedTe¡”
::
	$h™C®lback
(
NodeID
 
´oc
, 
Addr
 
addr
)

116 
	`DPRINTF
(
DœeùedTe¡
,

118 
´oc
,

119 
addr
);

121 
g’”©Ü
->
	`³rfÜmC®lback
(
´oc
, 
addr
);

122 
	`scheduË
(
dœeùedS¹Ev’t
, 
	`curTick
());

123 
	}
}

126 
	gRubyDœeùedTe¡”
::
	$wakeup
()

128 ià(
m_»que¡s_com¶‘ed
 < 
m_»que¡s_to_com¶‘e
) {

129 ià(!
g’”©Ü
->
	`š™Ÿ‹
()) {

130 
	`scheduË
(
dœeùedS¹Ev’t
, 
	`curTick
() + 1);

133 
	`ex™SimLoİ
("Ruby DirectedTester completed");

135 
	}
}

137 
RubyDœeùedTe¡”
 *

138 
	gRubyDœeùedTe¡”P¬ams
::
	$ü—‹
()

140  
Ãw
 
	`RubyDœeùedTe¡”
(
this
);

141 
	}
}

	@testers/directedtest/RubyDirectedTester.hh

30 #iâdeà
__CPU_DIRECTEDTEST_RUBYDIRECTEDTESTER_HH__


31 
	#__CPU_DIRECTEDTEST_RUBYDIRECTEDTESTER_HH__


	)

33 
	~<io¡»am
>

34 
	~<¡ršg
>

35 
	~<veùÜ
>

37 
	~"mem/ruby/commÚ/D©aBlock.hh
"

38 
	~"mem/ruby/commÚ/Glob®.hh
"

39 
	~"mem/ruby/commÚ/SubBlock.hh
"

40 
	~"mem/ruby/sy¡em/RubyPÜt.hh
"

41 
	~"mem/mem_objeù.hh
"

42 
	~"mem/·ck‘.hh
"

43 
	~"·¿ms/RubyDœeùedTe¡”.hh
"

45 
şass
 
	gDœeùedG’”©Ü
;

47 şas 
	cRubyDœeùedTe¡”
 : 
public
 
MemObjeù


49 
public
:

50 şas 
	cCpuPÜt
 : 
public
 
Ma¡”PÜt


52 
´iv©e
:

53 
RubyDœeùedTe¡”
 *
‹¡”
;

55 
	mpublic
:

56 
CpuPÜt
(cÚ¡ 
¡d
::
¡ršg
 &
_Çme
, 
RubyDœeùedTe¡”
 *
_‹¡”
,

57 
PÜtID
 
_id
)

58 : 
Ma¡”PÜt
(
_Çme
, 
_‹¡”
, 
_id
), 
‹¡”
(_tester)

61 
	m´Ùeùed
:

62 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

63 
vœtu®
 
»cvR‘ry
()

64 { 
·nic
("% dÛ nÙƒx³ù‡„‘ry\n", 
Çme
()); }

67 
RubyDœeùedTe¡”P¬ams
 
	tP¬ams
;

68 
RubyDœeùedTe¡”
(cÚ¡ 
P¬ams
 *
p
);

69 ~
RubyDœeùedTe¡”
();

71 
vœtu®
 
	gBa£Ma¡”PÜt
 &
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
,

72 
PÜtID
 
idx
 = 
Inv®idPÜtID
);

74 
Ma¡”PÜt
* 
g‘CpuPÜt
(
idx
);

76 
vœtu®
 
š™
();

78 
wakeup
();

80 
	$šüem’tCyşeCom¶‘iÚs
(è{ 
m_»que¡s_com¶‘ed
++; 
	}
}

82 
´štSts
(
¡d
::
o¡»am
& 
out
) const {}

83 
	$ş—rSts
(è{
	}
}

84 
´štCÚfig
(
¡d
::
o¡»am
& 
out
) const {}

86 
´št
(
¡d
::
o¡»am
& 
out
) const;

88 
	g´Ùeùed
:

89 şas 
	cDœeùedS¹Ev’t
 : 
public
 
Ev’t


91 
´iv©e
:

92 
RubyDœeùedTe¡”
 *
‹¡”
;

94 
	gpublic
:

95 
DœeùedS¹Ev’t
(
RubyDœeùedTe¡”
 *
_‹¡”
)

96 : 
Ev’t
(
CPU_Tick_Pri
), 
‹¡”
(
_‹¡”
)

98 
´oûss
(è{ 
	g‹¡”
->
wakeup
(); }

99 
vœtu®
 cÚ¡ *
desütiÚ
() const {  "Directedick"; }

102 
DœeùedS¹Ev’t
 
	gdœeùedS¹Ev’t
;

104 
	g´iv©e
:

105 
h™C®lback
(
NodeID
 
´oc
, 
Addr
 
addr
);

107 
checkFÜD—dlock
();

110 
RubyDœeùedTe¡”
(cÚ¡ RubyDœeùedTe¡”& 
obj
);

111 
	gRubyDœeùedTe¡”
& 
	gİ”©Ü
=(cÚ¡ 
RubyDœeùedTe¡”
& 
obj
);

113 
ušt64
 
	gm_»que¡s_com¶‘ed
;

114 
	g¡d
::
veùÜ
<
Ma¡”PÜt
*> 
pÜts
;

115 
ušt64
 
	gm_»que¡s_to_com¶‘e
;

116 
DœeùedG’”©Ü
* 
	gg’”©Ü
;

	@testers/directedtest/SeriesRequestGenerator.cc

30 
	~"ıu/‹¡”s/dœeùed‹¡/DœeùedG’”©Ü.hh
"

31 
	~"ıu/‹¡”s/dœeùed‹¡/RubyDœeùedTe¡”.hh
"

32 
	~"ıu/‹¡”s/dœeùed‹¡/S”›sReque¡G’”©Ü.hh
"

33 
	~"debug/DœeùedTe¡.hh
"

35 
	gS”›sReque¡G’”©Ü
::
	$S”›sReque¡G’”©Ü
(cÚ¡ 
P¬ams
 *
p
)

36 : 
	`DœeùedG’”©Ü
(
p
),

37 
	`m_addr_šüem’t_size
(
p
->
addr_šüem’t_size
),

38 
	`m_³rûÁ_wr™es
(
p
->
³rûÁ_wr™es
)

40 
m_¡©us
 = 
S”›sReque¡G’”©ÜStus_Thškšg
;

41 
m_aùive_node
 = 0;

42 
m_add»ss
 = 0x0;

43 
	}
}

45 
	gS”›sReque¡G’”©Ü
::~
	$S”›sReque¡G’”©Ü
()

47 
	}
}

49 
boŞ


50 
S”›sReque¡G’”©Ü
::
	$š™Ÿ‹
()

52 
	`DPRINTF
(
DœeùedTe¡
, "initiating„equest\n");

53 
	`as£¹
(
m_¡©us
 =ğ
S”›sReque¡G’”©ÜStus_Thškšg
);

55 
Ma¡”PÜt
* 
pÜt
 = 
m_dœeùed_‹¡”
->
	`g‘CpuPÜt
(
m_aùive_node
);

57 
Reque¡
::
FÏgs
 
æags
;

60 
Reque¡
 *
»q
 = 
Ãw
 
	`Reque¡
(
m_add»ss
, 1, 
æags
, 
ma¡”Id
);

62 
Pack‘
::
Commªd
 
cmd
;

63 
boŞ
 
do_wr™e
 = ((
	`¿ndom
(è% 100è< 
m_³rûÁ_wr™es
);

64 ià(
do_wr™e
) {

65 
cmd
 = 
MemCmd
::
Wr™eReq
;

67 
cmd
 = 
MemCmd
::
R—dReq
;

70 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
cmd
);

71 
ušt8_t
* 
dummyD©a
 = 
Ãw
 uint8_t;

72 *
dummyD©a
 = 0;

73 
pkt
->
	`d©aDyÇmic
(
dummyD©a
);

75 ià(
pÜt
->
	`£ndTimšgReq
(
pkt
)) {

76 
	`DPRINTF
(
DœeùedTe¡
, "initiating„equest - successful\n");

77 
m_¡©us
 = 
S”›sReque¡G’”©ÜStus_Reque¡_P’dšg
;

78  
Œue
;

83 
d–‘e
 
pkt
->
»q
;

84 
d–‘e
 
pkt
;

86 
	`DPRINTF
(
DœeùedTe¡
, "failedo initiate„equest - sequencer‚ot„eady\n");

87  
çl£
;

89 
	}
}

92 
	gS”›sReque¡G’”©Ü
::
	$³rfÜmC®lback
(
ušt32_t
 
´oc
, 
Addr
 
add»ss
)

94 
	`as£¹
(
m_aùive_node
 =ğ
´oc
);

95 
	`as£¹
(
m_add»ss
 =ğ
add»ss
);

96 
	`as£¹
(
m_¡©us
 =ğ
S”›sReque¡G’”©ÜStus_Reque¡_P’dšg
);

98 
m_¡©us
 = 
S”›sReque¡G’”©ÜStus_Thškšg
;

99 
m_aùive_node
++;

100 ià(
m_aùive_node
 =ğ
m_num_ıus
) {

105 
m_dœeùed_‹¡”
->
	`šüem’tCyşeCom¶‘iÚs
();

106 
m_add»ss
 +ğ
m_addr_šüem’t_size
;

107 
m_aùive_node
 = 0;

109 
	}
}

111 
S”›sReque¡G’”©Ü
 *

112 
	gS”›sReque¡G’”©ÜP¬ams
::
	$ü—‹
()

114  
Ãw
 
	`S”›sReque¡G’”©Ü
(
this
);

115 
	}
}

	@testers/directedtest/SeriesRequestGenerator.hh

35 #iâdeà
__CPU_DIRECTEDTEST_SERIESREQUESTGENERATOR_HH__


36 
	#__CPU_DIRECTEDTEST_SERIESREQUESTGENERATOR_HH__


	)

38 
	~"ıu/‹¡”s/dœeùed‹¡/DœeùedG’”©Ü.hh
"

39 
	~"ıu/‹¡”s/dœeùed‹¡/RubyDœeùedTe¡”.hh
"

40 
	~"mem/´ÙocŞ/S”›sReque¡G’”©ÜStus.hh
"

41 
	~"·¿ms/S”›sReque¡G’”©Ü.hh
"

43 şas 
	cS”›sReque¡G’”©Ü
 : 
public
 
DœeùedG’”©Ü


45 
public
:

46 
S”›sReque¡G’”©ÜP¬ams
 
	tP¬ams
;

47 
S”›sReque¡G’”©Ü
(cÚ¡ 
P¬ams
 *
p
);

49 ~
S”›sReque¡G’”©Ü
();

51 
boŞ
 
š™Ÿ‹
();

52 
³rfÜmC®lback
(
ušt32_t
 
´oc
, 
Addr
 
add»ss
);

54 
	m´iv©e
:

55 
S”›sReque¡G’”©ÜStus
 
m_¡©us
;

56 
Addr
 
	mm_add»ss
;

57 
ušt32_t
 
	mm_aùive_node
;

58 
ušt32_t
 
	mm_addr_šüem’t_size
;

59 
ušt32_t
 
	mm_³rûÁ_wr™es
;

	@testers/memtest/memtest.cc

34 
	~<iomª
>

35 
	~<£t
>

36 
	~<¡ršg
>

37 
	~<veùÜ
>

39 
	~"ba£/misc.hh
"

40 
	~"ba£/¡©i¡ics.hh
"

41 
	~"ıu/‹¡”s/mem‹¡/mem‹¡.hh
"

42 
	~"debug/MemTe¡.hh
"

43 
	~"mem/mem_objeù.hh
"

44 
	~"mem/·ck‘.hh
"

45 
	~"mem/pÜt.hh
"

46 
	~"mem/»que¡.hh
"

47 
	~"sim/sim_ev’ts.hh
"

48 
	~"sim/¡©s.hh
"

49 
	~"sim/sy¡em.hh
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
	gTESTER_ALLOCATOR
=0;

55 
boŞ


56 
	gMemTe¡
::
CpuPÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

58 
mem‹¡
->
	`com¶‘eReque¡
(
pkt
);

59  
Œue
;

60 
	}
}

63 
	gMemTe¡
::
CpuPÜt
::
	$»cvR‘ry
()

65 
mem‹¡
->
	`doR‘ry
();

66 
	}
}

69 
	gMemTe¡
::
	$£ndPkt
(
Pack‘PŒ
 
pkt
) {

70 ià(
©omic
) {

71 
ÿchePÜt
.
	`£ndAtomic
(
pkt
);

72 
	`com¶‘eReque¡
(
pkt
);

74 ià(!
ÿchePÜt
.
	`£ndTimšgReq
(
pkt
)) {

75 
	`DPRINTF
(
MemTe¡
, "accessRetry settingorue\n");

80 ià(
issueDmas
) {

81 
	`·nic
("Nacked DMA„equests‡re‚ot supported\n");

83 
acûssR‘ry
 = 
Œue
;

84 
»ŒyPkt
 = 
pkt
;

86 ià(
issueDmas
) {

87 
dmaOut¡ªdšg
 = 
Œue
;

91 
	}
}

93 
	gMemTe¡
::
	$MemTe¡
(cÚ¡ 
P¬ams
 *
p
)

94 : 
	`MemObjeù
(
p
),

95 
	`tickEv’t
(
this
),

96 
	`ÿchePÜt
("‹¡", 
this
),

97 
	`funcPÜt
("funùiÚ®", 
this
),

98 
	`funcProxy
(
funcPÜt
, 
p
->
sys
->
	`ÿcheLšeSize
()),

99 
	`»ŒyPkt
(
NULL
),

102 
	`size
(
p
->
memÜy_size
),

103 
	`³rûÁR—ds
(
p
->
³rûÁ_»ads
),

104 
	`³rûÁFunùiÚ®
(
p
->
³rûÁ_funùiÚ®
),

105 
	`³rûÁUnÿch—bË
(
p
->
³rûÁ_unÿch—bË
),

106 
	`issueDmas
(
p
->
issue_dmas
),

107 
	`ma¡”Id
(
p
->
sys
->
	`g‘Ma¡”Id
(
	`Çme
())),

108 
	`blockSize
(
p
->
sys
->
	`ÿcheLšeSize
()),

109 
	`´og»ssIÁ”v®
(
p
->
´og»ss_š‹rv®
),

110 
	`ÃxtProg»ssMes§ge
(
p
->
´og»ss_š‹rv®
),

111 
	`³rûÁSourûUÇligÃd
(
p
->
³rûÁ_sourû_uÇligÃd
),

112 
	`³rûÁDe¡UÇligÃd
(
p
->
³rûÁ_de¡_uÇligÃd
),

113 
	`maxLßds
(
p
->
max_lßds
),

114 
	`©omic
(
p
->
©omic
),

115 
	`suµ»ss_func_w¬nšgs
(
p
->
suµ»ss_func_w¬nšgs
)

117 
id
 = 
TESTER_ALLOCATOR
++;

120 
ŒaûBlockAddr
 = 
p
->
Œaû_addr
;

121 
ba£Addr1
 = 0x100000;

122 
ba£Addr2
 = 0x400000;

123 
unÿcheAddr
 = 0x800000;

125 
blockAddrMask
 = 
blockSize
 - 1;

126 
ŒaûBlockAddr
 = 
	`blockAddr
(traceBlockAddr);

129 
noRe¥Ú£Cyşes
 = 0;

130 
numR—ds
 = 0;

131 
numWr™es
 = 0;

132 
	`scheduË
(
tickEv’t
, 0);

134 
acûssR‘ry
 = 
çl£
;

135 
dmaOut¡ªdšg
 = 
çl£
;

136 
	}
}

138 
	gBa£Ma¡”PÜt
 &

139 
	gMemTe¡
::
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
, 
PÜtID
 
idx
)

141 ià(
	gif_Çme
 == "functional")

142  
funcPÜt
;

143 ià(
	gif_Çme
 == "test")

144  
ÿchePÜt
;

146  
	gMemObjeù
::
g‘Ma¡”PÜt
(
if_Çme
, 
idx
);

150 
	gMemTe¡
::
	$š™
()

154 
	}
}

158 
MemTe¡
::
	$com¶‘eReque¡
(
Pack‘PŒ
 
pkt
)

160 
Reque¡
 *
»q
 = 
pkt
->req;

162 ià(
issueDmas
) {

163 
dmaOut¡ªdšg
 = 
çl£
;

166 
	`DPRINTF
(
MemTe¡
, "completing %s‡t‡ddress %x (blk %x) %s\n",

167 
pkt
->
	`isWr™e
() ? "write" : "read",

168 
»q
->
	`g‘Paddr
(), 
	`blockAddr
(req->getPaddr()),

169 
pkt
->
	`isE¼Ü
() ? "error" : "success");

171 
MemTe¡S’d”S‹
 *
¡©e
 =

172 
dyÇmic_ÿ¡
<
MemTe¡S’d”S‹
 *>(
pkt
->
£nd”S‹
);

174 
ušt8_t
 *
d©a
 = 
¡©e
->data;

175 
ušt8_t
 *
pkt_d©a
 = 
pkt
->
g‘PŒ
<uint8_t>();

178 
¡d
::
£t
<>::
™”©Ü
 
»moveAddr
 =

179 
out¡ªdšgAddrs
.
	`fšd
(
»q
->
	`g‘Paddr
());

180 
	`as£¹
(
»moveAddr
 !ğ
out¡ªdšgAddrs
.
	`’d
());

181 
out¡ªdšgAddrs
.
	`”a£
(
»moveAddr
);

183 ià(
pkt
->
	`isE¼Ü
()) {

184 ià(!
suµ»ss_func_w¬nšgs
) {

185 
	`w¬n
("Functional %s‡ccess failed‡t %#x\n",

186 
pkt
->
	`isWr™e
(è? "wr™e" : "»ad", 
»q
->
	`g‘Paddr
());

189 ià(
pkt
->
	`isR—d
()) {

190 ià(
	`memcmp
(
pkt_d©a
, 
d©a
, 
pkt
->
	`g‘Size
()) != 0) {

191 
	`·nic
("%s:„ead of %x (blk %x) @ cycle %d "

192 "»tuº %x,ƒx³ùed %x\n", 
	`Çme
(),

193 
»q
->
	`g‘Paddr
(), 
	`blockAddr
Ôeq->g‘Paddr()), 
	`curTick
(),

194 *
pkt_d©a
, *
d©a
);

197 
numR—ds
++;

198 
numR—dsSt
++;

200 ià(
numR—ds
 =ğ(
ušt64_t
)
ÃxtProg»ssMes§ge
) {

201 
	`cırštf
(
û¼
, "%s: completed %d„ead, %d write‡ccesses @%d\n",

202 
	`Çme
(), 
numR—ds
, 
numWr™es
, 
	`curTick
());

203 
ÃxtProg»ssMes§ge
 +ğ
´og»ssIÁ”v®
;

206 ià(
maxLßds
 !ğ0 && 
numR—ds
 >= maxLoads)

207 
	`ex™SimLoİ
("maximum‚umber of†oads„eached");

209 
	`as£¹
(
pkt
->
	`isWr™e
());

210 
funcProxy
.
	`wr™eBlob
(
»q
->
	`g‘Paddr
(), 
pkt_d©a
,„eq->
	`g‘Size
());

211 
numWr™es
++;

212 
numWr™esSt
++;

216 
noRe¥Ú£Cyşes
 = 0;

217 
d–‘e
 
¡©e
;

218 
d–‘e
 [] 
d©a
;

219 
d–‘e
 
pkt
->
»q
;

220 
d–‘e
 
pkt
;

221 
	}
}

224 
	gMemTe¡
::
	$»gSts
()

226 
usšg
 
Çme¥aû
 
Sts
;

228 
numR—dsSt


229 .
	`Çme
(name() + ".num_reads")

230 .
	`desc
("number of„ead‡ccesses completed")

233 
numWr™esSt


234 .
	`Çme
(name() + ".num_writes")

235 .
	`desc
("number of write‡ccesses completed")

238 
numCİ›sSt


239 .
	`Çme
(name() + ".num_copies")

240 .
	`desc
("number of copy‡ccesses completed")

242 
	}
}

245 
	gMemTe¡
::
	$tick
()

247 ià(!
tickEv’t
.
	`scheduËd
())

248 
	`scheduË
(
tickEv’t
, 
	`şockEdge
(
	`Cyşes
(1)));

250 ià(++
noRe¥Ú£Cyşes
 >= 500000) {

251 ià(
issueDmas
) {

252 
û¼
 << "DMAester ";

254 
û¼
 << 
	`Çme
(è<< ": d—dlocked‡ˆcyş" << 
	`curTick
(è<< 
’dl
;

255 
	`çl
("");

258 ià(
acûssR‘ry
 || (
issueDmas
 && 
dmaOut¡ªdšg
)) {

259 
	`DPRINTF
(
MemTe¡
, "MemTester waiting on‡ccessRetry or DMA„esponse\n");

264 
cmd
 = 
	`¿ndom
() % 100;

265 
off£t
 = 
	`¿ndom
(è% 
size
;

266 
ba£
 = 
	`¿ndom
() % 2;

267 
ušt64_t
 
d©a
 = 
	`¿ndom
();

268 
acûss_size
 = 
	`¿ndom
() % 4;

269 
boŞ
 
unÿch—bË
 = (
	`¿ndom
(è% 100è< 
³rûÁUnÿch—bË
;

271 
dma_acûss_size
 = 
	`¿ndom
() % 4;

277 
off£t
 = 
	`blockAddr
(offset);

278 
off£t
 +ğ
id
;

279 
acûss_size
 = 0;

280 
dma_acûss_size
 = 0;

282 
Reque¡
::
FÏgs
 
æags
;

283 
Addr
 
·ddr
;

285 ià(
unÿch—bË
) {

286 
æags
.
	`£t
(
Reque¡
::
UNCACHEABLE
);

287 
·ddr
 = 
unÿcheAddr
 + 
off£t
;

289 
·ddr
 = ((
ba£
è? 
ba£Addr1
 : 
ba£Addr2
è+ 
off£t
;

295 ià(
out¡ªdšgAddrs
.
	`fšd
(
·ddr
è!ğout¡ªdšgAddrs.
	`’d
()) {

299 
boŞ
 
do_funùiÚ®
 = (
	`¿ndom
(è% 100 < 
³rûÁFunùiÚ®
è&& !
unÿch—bË
;

300 
Reque¡
 *
»q
 = 
Ãw
 
	`Reque¡
();

301 
ušt8_t
 *
»suÉ
 = 
Ãw
 uint8_t[8];

303 ià(
issueDmas
) {

304 
·ddr
 &ğ~((1 << 
dma_acûss_size
) - 1);

305 
»q
->
	`£tPhys
(
·ddr
, 1 << 
dma_acûss_size
, 
æags
, 
ma¡”Id
);

306 
»q
->
	`£tTh»adCÚ‹xt
(
id
,0);

308 
·ddr
 &ğ~((1 << 
acûss_size
) - 1);

309 
»q
->
	`£tPhys
(
·ddr
, 1 << 
acûss_size
, 
æags
, 
ma¡”Id
);

310 
»q
->
	`£tTh»adCÚ‹xt
(
id
,0);

312 
	`as£¹
(
»q
->
	`g‘Size
() == 1);

314 ià(
cmd
 < 
³rûÁR—ds
) {

316 
out¡ªdšgAddrs
.
	`š£¹
(
·ddr
);

319 
funcProxy
.
	`»adBlob
(
»q
->
	`g‘Paddr
(), 
»suÉ
,„eq->
	`g‘Size
());

321 
	`DPRINTF
(
MemTe¡
,

323 
id
, 
do_funùiÚ®
 ? "funùiÚ® " : "", 
»q
->
	`g‘Paddr
(),

324 
	`blockAddr
(
»q
->
	`g‘Paddr
()), *
»suÉ
);

326 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
MemCmd
::
R—dReq
);

327 
pkt
->
	`d©aDyÇmicA¼ay
(
Ãw
 
ušt8_t
[
»q
->
	`g‘Size
()]);

328 
MemTe¡S’d”S‹
 *
¡©e
 = 
Ãw
 
	`MemTe¡S’d”S‹
(
»suÉ
);

329 
pkt
->
£nd”S‹
 = 
¡©e
;

331 ià(
do_funùiÚ®
) {

332 
	`as£¹
(
pkt
->
	`ÃedsRe¥Ú£
());

333 
pkt
->
	`£tSuµ»ssFuncE¼Ü
();

334 
ÿchePÜt
.
	`£ndFunùiÚ®
(
pkt
);

335 
	`com¶‘eReque¡
(
pkt
);

337 
	`£ndPkt
(
pkt
);

341 
out¡ªdšgAddrs
.
	`š£¹
(
·ddr
);

343 
	`DPRINTF
(
MemTe¡
, "initiating %swrite‡t‡ddr %x (blk %x) value %x\n",

344 
do_funùiÚ®
 ? "funùiÚ® " : "", 
»q
->
	`g‘Paddr
(),

345 
	`blockAddr
(
»q
->
	`g‘Paddr
()), 
d©a
 & 0xff);

347 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
MemCmd
::
Wr™eReq
);

348 
ušt8_t
 *
pkt_d©a
 = 
Ãw
 ušt8_t[
»q
->
	`g‘Size
()];

349 
pkt
->
	`d©aDyÇmicA¼ay
(
pkt_d©a
);

350 
	`memıy
(
pkt_d©a
, &
d©a
, 
»q
->
	`g‘Size
());

351 
MemTe¡S’d”S‹
 *
¡©e
 = 
Ãw
 
	`MemTe¡S’d”S‹
(
»suÉ
);

352 
pkt
->
£nd”S‹
 = 
¡©e
;

354 ià(
do_funùiÚ®
) {

355 
pkt
->
	`£tSuµ»ssFuncE¼Ü
();

356 
ÿchePÜt
.
	`£ndFunùiÚ®
(
pkt
);

357 
	`com¶‘eReque¡
(
pkt
);

359 
	`£ndPkt
(
pkt
);

362 
	}
}

365 
	gMemTe¡
::
	$doR‘ry
()

367 ià(
ÿchePÜt
.
	`£ndTimšgReq
(
»ŒyPkt
)) {

368 
	`DPRINTF
(
MemTe¡
, "accessRetry settingo false\n");

369 
acûssR‘ry
 = 
çl£
;

370 
»ŒyPkt
 = 
NULL
;

372 
	}
}

376 
	gMemTe¡
::
	$´štAddr
(
Addr
 
a
)

378 
ÿchePÜt
.
	`´štAddr
(
a
);

379 
	}
}

382 
MemTe¡
 *

383 
	gMemTe¡P¬ams
::
	$ü—‹
()

385  
Ãw
 
	`MemTe¡
(
this
);

386 
	}
}

	@testers/memtest/memtest.hh

32 #iâdeà
__CPU_MEMTEST_MEMTEST_HH__


33 
	#__CPU_MEMTEST_MEMTEST_HH__


	)

35 
	~<£t
>

37 
	~"ba£/¡©i¡ics.hh
"

38 
	~"mem/mem_objeù.hh
"

39 
	~"mem/pÜt.hh
"

40 
	~"mem/pÜt_´oxy.hh
"

41 
	~"·¿ms/MemTe¡.hh
"

42 
	~"sim/ev’tq.hh
"

43 
	~"sim/sim_ex™.hh
"

44 
	~"sim/sim_objeù.hh
"

45 
	~"sim/¡©s.hh
"

47 
şass
 
	gPack‘
;

48 şas 
	cMemTe¡
 : 
public
 
MemObjeù


50 
public
:

51 
MemTe¡P¬ams
 
	tP¬ams
;

52 
MemTe¡
(cÚ¡ 
P¬ams
 *
p
);

54 
vœtu®
 
š™
();

57 
vœtu®
 
»gSts
();

60 
tick
();

62 
vœtu®
 
	mBa£Ma¡”PÜt
 &
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
,

63 
PÜtID
 
idx
 = 
Inv®idPÜtID
);

69 
´štAddr
(
Addr
 
a
);

71 
	m´Ùeùed
:

72 şas 
	cTickEv’t
 : 
public
 
Ev’t


74 
´iv©e
:

75 
MemTe¡
 *
ıu
;

77 
	mpublic
:

78 
TickEv’t
(
MemTe¡
 *
c
è: 
Ev’t
(
CPU_Tick_Pri
), 
ıu
(c) {}

79 
´oûss
(è{ 
	mıu
->
tick
(); }

80 
vœtu®
 cÚ¡ *
desütiÚ
() const {  "MemTestick"; }

83 
TickEv’t
 
	gtickEv’t
;

85 şas 
	cCpuPÜt
 : 
public
 
Ma¡”PÜt


87 
MemTe¡
 *
mem‹¡
;

89 
	gpublic
:

91 
CpuPÜt
(cÚ¡ 
¡d
::
¡ršg
 &
_Çme
, 
MemTe¡
 *
_mem‹¡
)

92 : 
Ma¡”PÜt
(
_Çme
, 
_mem‹¡
), 
mem‹¡
(_memtest)

95 
	g´Ùeùed
:

97 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

99 
vœtu®
 
»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
) { }

101 
vœtu®
 
Tick
 
»cvAtomicSnoİ
(
Pack‘PŒ
 
pkt
) {  0; }

103 
vœtu®
 
»cvFunùiÚ®Snoİ
(
Pack‘PŒ
 
pkt
) { }

105 
vœtu®
 
»cvR‘ry
();

108 
CpuPÜt
 
	gÿchePÜt
;

109 
CpuPÜt
 
	gfuncPÜt
;

110 
PÜtProxy
 
	gfuncProxy
;

112 şas 
	cMemTe¡S’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


114 
public
:

116 
MemTe¡S’d”S‹
(
ušt8_t
 *
_d©a
)

117 : 
d©a
(
_d©a
)

121 
ušt8_t
 *
d©a
;

124 
Pack‘PŒ
 
	g»ŒyPkt
;

126 
boŞ
 
	gacûssR‘ry
;

131 
boŞ
 
	gdmaOut¡ªdšg
;

133 
	gsize
;

135 
	g³rûÁR—ds
;

136 
	g³rûÁFunùiÚ®
;

137 
	g³rûÁUnÿch—bË
;

139 
boŞ
 
	gissueDmas
;

142 
Ma¡”ID
 
	gma¡”Id
;

144 
	gid
;

146 
	g¡d
::
£t
<> 
out¡ªdšgAddrs
;

148 
	gblockSize
;

150 
Addr
 
	gblockAddrMask
;

152 
Addr
 
	$blockAddr
(
Addr
 
addr
)

154  (
addr
 & ~
blockAddrMask
);

155 
	}
}

157 
Addr
 
	gŒaûBlockAddr
;

159 
Addr
 
	gba£Addr1
;

160 
Addr
 
	gba£Addr2
;

161 
Addr
 
	gunÿcheAddr
;

163 
	g´og»ssIÁ”v®
;

164 
Tick
 
	gÃxtProg»ssMes§ge
;

166 
	g³rûÁSourûUÇligÃd
;

167 
	g³rûÁDe¡UÇligÃd
;

169 
Tick
 
	gnoRe¥Ú£Cyşes
;

171 
ušt64_t
 
	gnumR—ds
;

172 
ušt64_t
 
	gnumWr™es
;

173 
ušt64_t
 
	gmaxLßds
;

175 
boŞ
 
	g©omic
;

176 
boŞ
 
	gsuµ»ss_func_w¬nšgs
;

178 
	gSts
::
SÿÏr
 
numR—dsSt
;

179 
	gSts
::
SÿÏr
 
numWr™esSt
;

180 
	gSts
::
SÿÏr
 
numCİ›sSt
;

183 
com¶‘eReque¡
(
Pack‘PŒ
 
pkt
);

185 
£ndPkt
(
Pack‘PŒ
 
pkt
);

187 
doR‘ry
();

189 
ä›nd
 
şass
 
	gMemCom¶‘eEv’t
;

	@testers/networktest/networktest.cc

31 
	~<cm©h
>

32 
	~<iomª
>

33 
	~<£t
>

34 
	~<¡ršg
>

35 
	~<veùÜ
>

37 
	~"ba£/misc.hh
"

38 
	~"ba£/¡©i¡ics.hh
"

39 
	~"ıu/‹¡”s/ÃtwÜk‹¡/ÃtwÜk‹¡.hh
"

40 
	~"debug/N‘wÜkTe¡.hh
"

41 
	~"mem/mem_objeù.hh
"

42 
	~"mem/·ck‘.hh
"

43 
	~"mem/pÜt.hh
"

44 
	~"mem/»que¡.hh
"

45 
	~"sim/sim_ev’ts.hh
"

46 
	~"sim/¡©s.hh
"

47 
	~"sim/sy¡em.hh
"

49 
usšg
 
Çme¥aû
 
	g¡d
;

51 
	gTESTER_NETWORK
=0;

53 
boŞ


54 
	gN‘wÜkTe¡
::
CpuPÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

56 
ÃtwÜk‹¡
->
	`com¶‘eReque¡
(
pkt
);

57  
Œue
;

58 
	}
}

61 
	gN‘wÜkTe¡
::
CpuPÜt
::
	$»cvR‘ry
()

63 
ÃtwÜk‹¡
->
	`doR‘ry
();

64 
	}
}

67 
	gN‘wÜkTe¡
::
	$£ndPkt
(
Pack‘PŒ
 
pkt
)

69 ià(!
ÿchePÜt
.
	`£ndTimšgReq
(
pkt
)) {

70 
»ŒyPkt
 = 
pkt
;

72 
numPack‘sS’t
++;

73 
	}
}

75 
	gN‘wÜkTe¡
::
	$N‘wÜkTe¡
(cÚ¡ 
P¬ams
 *
p
)

76 : 
	`MemObjeù
(
p
),

77 
	`tickEv’t
(
this
),

78 
	`ÿchePÜt
("ÃtwÜk-‹¡", 
this
),

79 
	`»ŒyPkt
(
NULL
),

80 
	`size
(
p
->
memÜy_size
),

81 
	`blockSizeB™s
(
p
->
block_off£t
),

82 
	`numMemÜ›s
(
p
->
num_memÜ›s
),

83 
	`simCyşes
(
p
->
sim_cyşes
),

84 
	`fixedPkts
(
p
->
fixed_pkts
),

85 
	`maxPack‘s
(
p
->
max_·ck‘s
),

86 
	`ŒafficTy³
(
p
->
Œaffic_ty³
),

87 
	`šjR©e
(
p
->
šj_¿‹
),

88 
	`´ecisiÚ
(
p
->
´ecisiÚ
),

89 
	`ma¡”Id
(
p
->
sy¡em
->
	`g‘Ma¡”Id
(
	$Çme
()))

92 
noRe¥Ú£Cyşes
 = 0;

93 
	`scheduË
(
tickEv’t
, 0);

95 
id
 = 
TESTER_NETWORK
++;

96 
	`DPRINTF
(
N‘wÜkTe¡
,"Config Created: Name = %s ,‡nd id = %d\n",

97 
	`Çme
(), 
id
);

98 
	}
}

100 
	gBa£Ma¡”PÜt
 &

101 
	gN‘wÜkTe¡
::
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
, 
PÜtID
 
idx
)

103 ià(
	gif_Çme
 == "test")

104  
ÿchePÜt
;

106  
	gMemObjeù
::
g‘Ma¡”PÜt
(
if_Çme
, 
idx
);

110 
	gN‘wÜkTe¡
::
	$š™
()

112 
numPack‘sS’t
 = 0;

113 
	}
}

117 
	gN‘wÜkTe¡
::
	$com¶‘eReque¡
(
Pack‘PŒ
 
pkt
)

119 
Reque¡
 *
»q
 = 
pkt
->req;

121 
	`DPRINTF
(
N‘wÜkTe¡
, "Completed injection of %s…acket for‡ddress %x\n",

122 
pkt
->
	`isWr™e
() ? "write" : "read\n",

123 
»q
->
	`g‘Paddr
());

125 
	`as£¹
(
pkt
->
	`isRe¥Ú£
());

126 
noRe¥Ú£Cyşes
 = 0;

127 
d–‘e
 
»q
;

128 
d–‘e
 
pkt
;

129 
	}
}

133 
	gN‘wÜkTe¡
::
	$tick
()

135 ià(++
noRe¥Ú£Cyşes
 >= 500000) {

136 
û¼
 << 
	`Çme
(è<< ": d—dlocked‡ˆcyş" << 
	`curTick
(è<< 
’dl
;

137 
	`çl
("");

144 
boŞ
 
£nd_this_cyşe
;

145 
šjRªge
 = 
	`pow
((è10, (è
´ecisiÚ
);

146 
ŒyS’dšg
 = 
	`¿ndom
(è% (è
šjRªge
;

147 ià(
ŒyS’dšg
 < 
šjR©e
*
šjRªge
)

148 
£nd_this_cyşe
 = 
Œue
;

150 
£nd_this_cyşe
 = 
çl£
;

153 ià(
£nd_this_cyşe
) {

154 ià(
fixedPkts
) {

155 ià(
numPack‘sS’t
 < 
maxPack‘s
) {

156 
	`g’”©ePkt
();

159 
	`g’”©ePkt
();

164 ià(
	`curTick
(è>ğ
simCyşes
)

165 
	`ex™SimLoİ
("Network Tester completed simCycles");

167 ià(!
tickEv’t
.
	`scheduËd
())

168 
	`scheduË
(
tickEv’t
, 
	`şockEdge
(
	`Cyşes
(1)));

170 
	}
}

173 
	gN‘wÜkTe¡
::
	$g’”©ePkt
()

175 
de¡š©iÚ
 = 
id
;

176 ià(
ŒafficTy³
 == 0) {

177 
de¡š©iÚ
 = 
	`¿ndom
(è% 
numMemÜ›s
;

178 } ià(
ŒafficTy³
 == 1) {

179 
ÃtwÜkDim’siÚ
 = (è
	`sq¹
(
numMemÜ›s
);

180 
my_x
 = 
id
%
ÃtwÜkDim’siÚ
;

181 
my_y
 = 
id
/
ÃtwÜkDim’siÚ
;

183 
de¡_x
 = 
my_x
 + (è
	`û
(
ÃtwÜkDim’siÚ
/2) - 1;

184 
de¡_x
 = de¡_x%
ÃtwÜkDim’siÚ
;

185 
de¡_y
 = 
my_y
;

187 
de¡š©iÚ
 = 
de¡_y
*
ÃtwÜkDim’siÚ
 + 
de¡_x
;

188 } ià(
ŒafficTy³
 == 2) {

189 
ÃtwÜkDim’siÚ
 = (è
	`sq¹
(
numMemÜ›s
);

190 
my_x
 = 
id
%
ÃtwÜkDim’siÚ
;

191 
my_y
 = 
id
/
ÃtwÜkDim’siÚ
;

193 
de¡_x
 = 
ÃtwÜkDim’siÚ
 - 
my_x
 - 1;

194 
de¡_y
 = 
ÃtwÜkDim’siÚ
 - 
my_y
 - 1;

196 
de¡š©iÚ
 = 
de¡_y
*
ÃtwÜkDim’siÚ
 + 
de¡_x
;

199 
Reque¡
 *
»q
 = 
Ãw
 
	`Reque¡
();

200 
Reque¡
::
FÏgs
 
æags
;

205 
Addr
 
·ddr
 = 
de¡š©iÚ
;

206 
·ddr
 <<ğ
blockSizeB™s
;

207 
acûss_size
 = 1;

233 
MemCmd
::
Commªd
 
»que¡Ty³
;

235 
¿ndomReqTy³
 = 
	`¿ndom
() % 3;

236 ià(
¿ndomReqTy³
 == 0) {

238 
»que¡Ty³
 = 
MemCmd
::
R—dReq
;

239 
»q
->
	`£tPhys
(
·ddr
, 
acûss_size
, 
æags
, 
ma¡”Id
);

240 } ià(
¿ndomReqTy³
 == 1) {

242 
»que¡Ty³
 = 
MemCmd
::
R—dReq
;

243 
æags
.
	`£t
(
Reque¡
::
INST_FETCH
);

244 
»q
->
	`£tVœt
(0, 0x0, 
acûss_size
, 
æags
, 0x0, 
ma¡”Id
);

245 
»q
->
	`£tPaddr
(
·ddr
);

248 
»que¡Ty³
 = 
MemCmd
::
Wr™eReq
;

249 
»q
->
	`£tPhys
(
·ddr
, 
acûss_size
, 
æags
, 
ma¡”Id
);

252 
»q
->
	`£tTh»adCÚ‹xt
(
id
,0);

257 
	`DPRINTF
(
N‘wÜkTe¡
,

259 
de¡š©iÚ
, 
»q
->
	`g‘Paddr
());

261 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
»que¡Ty³
);

262 
pkt
->
	`d©aDyÇmicA¼ay
(
Ãw
 
ušt8_t
[
»q
->
	`g‘Size
()]);

263 
pkt
->
£nd”S‹
 = 
NULL
;

265 
	`£ndPkt
(
pkt
);

266 
	}
}

269 
	gN‘wÜkTe¡
::
	$doR‘ry
()

271 ià(
ÿchePÜt
.
	`£ndTimšgReq
(
»ŒyPkt
)) {

272 
»ŒyPkt
 = 
NULL
;

274 
	}
}

277 
	gN‘wÜkTe¡
::
	$´štAddr
(
Addr
 
a
)

279 
ÿchePÜt
.
	`´štAddr
(
a
);

280 
	}
}

283 
N‘wÜkTe¡
 *

284 
	gN‘wÜkTe¡P¬ams
::
	$ü—‹
()

286  
Ãw
 
	`N‘wÜkTe¡
(
this
);

287 
	}
}

	@testers/networktest/networktest.hh

31 #iâdeà
__CPU_NETWORKTEST_NETWORKTEST_HH__


32 
	#__CPU_NETWORKTEST_NETWORKTEST_HH__


	)

34 
	~<£t
>

36 
	~"ba£/¡©i¡ics.hh
"

37 
	~"mem/mem_objeù.hh
"

38 
	~"mem/pÜt.hh
"

39 
	~"·¿ms/N‘wÜkTe¡.hh
"

40 
	~"sim/ev’tq.hh
"

41 
	~"sim/sim_ex™.hh
"

42 
	~"sim/sim_objeù.hh
"

43 
	~"sim/¡©s.hh
"

45 
şass
 
	gPack‘
;

46 şas 
	cN‘wÜkTe¡
 : 
public
 
MemObjeù


48 
public
:

49 
N‘wÜkTe¡P¬ams
 
	tP¬ams
;

50 
N‘wÜkTe¡
(cÚ¡ 
P¬ams
 *
p
);

52 
vœtu®
 
š™
();

55 
tick
();

57 
vœtu®
 
	mBa£Ma¡”PÜt
 &
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
,

58 
PÜtID
 
idx
 = 
Inv®idPÜtID
);

64 
´štAddr
(
Addr
 
a
);

66 
	m´Ùeùed
:

67 şas 
	cTickEv’t
 : 
public
 
Ev’t


69 
´iv©e
:

70 
N‘wÜkTe¡
 *
ıu
;

72 
	mpublic
:

73 
TickEv’t
(
N‘wÜkTe¡
 *
c
è: 
Ev’t
(
CPU_Tick_Pri
), 
ıu
(c) {}

74 
´oûss
(è{ 
	mıu
->
tick
(); }

75 
vœtu®
 cÚ¡ *
desütiÚ
() const {  "NetworkTestick"; }

78 
TickEv’t
 
	gtickEv’t
;

80 şas 
	cCpuPÜt
 : 
public
 
Ma¡”PÜt


82 
N‘wÜkTe¡
 *
ÃtwÜk‹¡
;

84 
	gpublic
:

86 
CpuPÜt
(cÚ¡ 
¡d
::
¡ršg
 &
_Çme
, 
N‘wÜkTe¡
 *
_ÃtwÜk‹¡
)

87 : 
Ma¡”PÜt
(
_Çme
, 
_ÃtwÜk‹¡
), 
ÃtwÜk‹¡
(_networktest)

90 
	g´Ùeùed
:

92 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

94 
vœtu®
 
»cvR‘ry
();

97 
CpuPÜt
 
	gÿchePÜt
;

99 şas 
	cN‘wÜkTe¡S’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


101 
public
:

103 
N‘wÜkTe¡S’d”S‹
(
ušt8_t
 *
_d©a
)

104 : 
d©a
(
_d©a
)

108 
ušt8_t
 *
d©a
;

111 
Pack‘PŒ
 
	g»ŒyPkt
;

112 
	gsize
;

113 
	gid
;

115 
	gblockSizeB™s
;

117 
Tick
 
	gnoRe¥Ú£Cyşes
;

119 
	gnumMemÜ›s
;

120 
Tick
 
	gsimCyşes
;

121 
boŞ
 
	gfixedPkts
;

122 
	gmaxPack‘s
;

123 
	gnumPack‘sS’t
;

125 
	gŒafficTy³
;

126 
	gšjR©e
;

127 
	g´ecisiÚ
;

129 
Ma¡”ID
 
	gma¡”Id
;

131 
com¶‘eReque¡
(
Pack‘PŒ
 
pkt
);

133 
g’”©ePkt
();

134 
£ndPkt
(
Pack‘PŒ
 
pkt
);

136 
doR‘ry
();

138 
ä›nd
 
şass
 
	gMemCom¶‘eEv’t
;

	@testers/rubytest/Check.cc

30 
	~"ıu/‹¡”s/ruby‹¡/Check.hh
"

31 
	~"debug/RubyTe¡.hh
"

32 
	~"mem/ruby/commÚ/SubBlock.hh
"

33 
	~"mem/ruby/sy¡em/Sequ’ûr.hh
"

34 
	~"mem/ruby/sy¡em/Sy¡em.hh
"

36 
	gRubyTe¡”
::
	tS’d”S‹
 SenderState;

38 
	gCheck
::
	$Check
(cÚ¡ 
Add»ss
& 
add»ss
, cÚ¡ Add»ss& 
pc
,

39 
_num_wr™”s
, 
_num_»ad”s
, 
RubyTe¡”
* 
_‹¡”
)

40 : 
	`m_num_wr™”s
(
_num_wr™”s
), 
	`m_num_»ad”s
(
_num_»ad”s
),

41 
	$m_‹¡”_±r
(
_‹¡”
)

43 
m_¡©us
 = 
Te¡”Stus_IdË
;

45 
	`pickV®ue
();

46 
	`pickIn™ŸtšgNode
();

47 
	`chªgeAdd»ss
(
add»ss
);

48 
m_pc
 = 
pc
;

49 
m_acûss_mode
 = 
	`RubyAcûssMode
(
	`¿ndom
(è% 
RubyAcûssMode_NUM
);

50 
m_¡Üe_couÁ
 = 0;

51 
	}
}

54 
	gCheck
::
	$š™Ÿ‹
()

56 
	`DPRINTF
(
RubyTe¡
, "initiating\n");

57 
	`debugPršt
();

60 ià(
çl£
 && (
	`¿ndom
() & 0xf) == 0) {

61 
	`š™Ÿ‹P»ãtch
();

64 ià(
m_‹¡”_±r
->
	`g‘CheckFlush
(è&& (
	`¿ndom
() & 0xff) == 0) {

65 
	`š™Ÿ‹Flush
();

68 ià(
m_¡©us
 =ğ
Te¡”Stus_IdË
) {

69 
	`š™Ÿ‹AùiÚ
();

70 } ià(
m_¡©us
 =ğ
Te¡”Stus_R—dy
) {

71 
	`š™Ÿ‹Check
();

74 
	`DPRINTF
(
RubyTe¡
,

77 
	}
}

80 
	gCheck
::
	$š™Ÿ‹P»ãtch
()

82 
	`DPRINTF
(
RubyTe¡
, "initiating…refetch\n");

84 
šdex
 = 
	`¿ndom
(è% 
m_num_»ad”s
;

85 
Ma¡”PÜt
* 
pÜt
 = 
m_‹¡”_±r
->
	`g‘R—dabËCpuPÜt
(
šdex
);

87 
Reque¡
::
FÏgs
 
æags
;

88 
æags
.
	`£t
(
Reque¡
::
PREFETCH
);

90 
Pack‘
::
Commªd
 
cmd
;

93 ià((
	`¿ndom
() & 0x7) != 0) {

94 
cmd
 = 
MemCmd
::
R—dReq
;

97 ià(
m_‹¡”_±r
->
	`isIn¡R—dabËCpuPÜt
(
šdex
)) {

98 
æags
.
	`£t
(
Reque¡
::
INST_FETCH
);

101 
cmd
 = 
MemCmd
::
Wr™eReq
;

102 
æags
.
	`£t
(
Reque¡
::
PF_EXCLUSIVE
);

106 
Reque¡
 *
»q
 = 
Ãw
 
	`Reque¡
(
m_add»ss
.
	`g‘Add»ss
(), 0, 
æags
,

107 
m_‹¡”_±r
->
	`ma¡”Id
(), 
	`curTick
(), 
m_pc
.
	`g‘Add»ss
());

108 
»q
->
	`£tTh»adCÚ‹xt
(
šdex
, 0);

110 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
cmd
);

114 
pkt
->
£nd”S‹
 = 
Ãw
 
	`S’d”S‹
(
m_add»ss
, 
»q
->
	`g‘Size
());

116 ià(
pÜt
->
	`£ndTimšgReq
(
pkt
)) {

117 
	`DPRINTF
(
RubyTe¡
, "successfully initiated…refetch.\n");

120 
d–‘e
 
pkt
->
£nd”S‹
;

121 
d–‘e
 
pkt
->
»q
;

122 
d–‘e
 
pkt
;

124 
	`DPRINTF
(
RubyTe¡
,

127 
	}
}

130 
	gCheck
::
	$š™Ÿ‹Flush
()

133 
	`DPRINTF
(
RubyTe¡
, "initiating Flush\n");

135 
šdex
 = 
	`¿ndom
(è% 
m_num_wr™”s
;

136 
Ma¡”PÜt
* 
pÜt
 = 
m_‹¡”_±r
->
	`g‘Wr™abËCpuPÜt
(
šdex
);

138 
Reque¡
::
FÏgs
 
æags
;

140 
Reque¡
 *
»q
 = 
Ãw
 
	`Reque¡
(
m_add»ss
.
	`g‘Add»ss
(), 
CHECK_SIZE
, 
æags
,

141 
m_‹¡”_±r
->
	`ma¡”Id
(), 
	`curTick
(), 
m_pc
.
	`g‘Add»ss
());

143 
Pack‘
::
Commªd
 
cmd
;

145 
cmd
 = 
MemCmd
::
FlushReq
;

147 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
cmd
);

151 
pkt
->
£nd”S‹
 = 
Ãw
 
	`S’d”S‹
(
m_add»ss
, 
»q
->
	`g‘Size
());

153 ià(
pÜt
->
	`£ndTimšgReq
(
pkt
)) {

154 
	`DPRINTF
(
RubyTe¡
, "initiating Flush - successful\n");

156 
	}
}

159 
	gCheck
::
	$š™Ÿ‹AùiÚ
()

161 
	`DPRINTF
(
RubyTe¡
, "initiating Action\n");

162 
	`as£¹
(
m_¡©us
 =ğ
Te¡”Stus_IdË
);

164 
šdex
 = 
	`¿ndom
(è% 
m_num_wr™”s
;

165 
Ma¡”PÜt
* 
pÜt
 = 
m_‹¡”_±r
->
	`g‘Wr™abËCpuPÜt
(
šdex
);

167 
Reque¡
::
FÏgs
 
æags
;

170 
Add»ss
 
	`wr™eAddr
(
m_add»ss
.
	`g‘Add»ss
(è+ 
m_¡Üe_couÁ
);

173 
Reque¡
 *
»q
 = 
Ãw
 
	`Reque¡
(
wr™eAddr
.
	`g‘Add»ss
(), 1, 
æags
,

174 
m_‹¡”_±r
->
	`ma¡”Id
(), 
	`curTick
(),

175 
m_pc
.
	`g‘Add»ss
());

177 
»q
->
	`£tTh»adCÚ‹xt
(
šdex
, 0);

178 
Pack‘
::
Commªd
 
cmd
;

184 
cmd
 = 
MemCmd
::
Wr™eReq
;

187 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
cmd
);

188 
ušt8_t
 *
wr™eD©a
 = 
Ãw
 uint8_t;

189 *
wr™eD©a
 = 
m_v®ue
 + 
m_¡Üe_couÁ
;

190 
pkt
->
	`d©aDyÇmic
(
wr™eD©a
);

192 
	`DPRINTF
(
RubyTe¡
, "data 0x%x check 0x%x\n",

193 *(
pkt
->
g‘PŒ
<
ušt8_t
>()), *
wr™eD©a
);

197 
pkt
->
£nd”S‹
 = 
Ãw
 
	`S’d”S‹
(
wr™eAddr
, 
»q
->
	`g‘Size
());

199 ià(
pÜt
->
	`£ndTimšgReq
(
pkt
)) {

200 
	`DPRINTF
(
RubyTe¡
, "initiating‡ction - successful\n");

201 
	`DPRINTF
(
RubyTe¡
, "status before‡ction update: %s\n",

202 (
	`Te¡”Stus_to_¡ršg
(
m_¡©us
)).
	`c_¡r
());

203 
m_¡©us
 = 
Te¡”Stus_AùiÚ_P’dšg
;

208 
d–‘e
 
pkt
->
£nd”S‹
;

209 
d–‘e
 
pkt
->
»q
;

210 
d–‘e
 
pkt
;

212 
	`DPRINTF
(
RubyTe¡
, "failedo initiate‡ction - sequencer‚ot„eady\n");

215 
	`DPRINTF
(
RubyTe¡
, "status‡fter‡ction update: %s\n",

216 (
	`Te¡”Stus_to_¡ršg
(
m_¡©us
)).
	`c_¡r
());

217 
	}
}

220 
	gCheck
::
	$š™Ÿ‹Check
()

222 
	`DPRINTF
(
RubyTe¡
, "Initiating Check\n");

223 
	`as£¹
(
m_¡©us
 =ğ
Te¡”Stus_R—dy
);

225 
šdex
 = 
	`¿ndom
(è% 
m_num_»ad”s
;

226 
Ma¡”PÜt
* 
pÜt
 = 
m_‹¡”_±r
->
	`g‘R—dabËCpuPÜt
(
šdex
);

228 
Reque¡
::
FÏgs
 
æags
;

231 ià(
m_‹¡”_±r
->
	`isIn¡R—dabËCpuPÜt
(
šdex
)) {

232 
æags
.
	`£t
(
Reque¡
::
INST_FETCH
);

236 
Reque¡
 *
»q
 = 
Ãw
 
	`Reque¡
(
m_add»ss
.
	`g‘Add»ss
(), 
CHECK_SIZE
, 
æags
,

237 
m_‹¡”_±r
->
	`ma¡”Id
(), 
	`curTick
(), 
m_pc
.
	`g‘Add»ss
());

239 
»q
->
	`£tTh»adCÚ‹xt
(
šdex
, 0);

240 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
MemCmd
::
R—dReq
);

241 
ušt8_t
 *
d©aA¼ay
 = 
Ãw
 ušt8_t[
CHECK_SIZE
];

242 
pkt
->
	`d©aDyÇmicA¼ay
(
d©aA¼ay
);

246 
pkt
->
£nd”S‹
 = 
Ãw
 
	`S’d”S‹
(
m_add»ss
, 
»q
->
	`g‘Size
());

248 ià(
pÜt
->
	`£ndTimšgReq
(
pkt
)) {

249 
	`DPRINTF
(
RubyTe¡
, "initiating check - successful\n");

250 
	`DPRINTF
(
RubyTe¡
, "status before check update: %s\n",

251 
	`Te¡”Stus_to_¡ršg
(
m_¡©us
).
	`c_¡r
());

252 
m_¡©us
 = 
Te¡”Stus_Check_P’dšg
;

257 
d–‘e
 
pkt
->
£nd”S‹
;

258 
d–‘e
 
pkt
->
»q
;

259 
d–‘e
 
pkt
;

261 
	`DPRINTF
(
RubyTe¡
, "failedo initiate check - cpu…ort‚ot„eady\n");

264 
	`DPRINTF
(
RubyTe¡
, "status‡fter check update: %s\n",

265 
	`Te¡”Stus_to_¡ršg
(
m_¡©us
).
	`c_¡r
());

266 
	}
}

269 
	gCheck
::
	$³rfÜmC®lback
(
NodeID
 
´oc
, 
SubBlock
* 
d©a
, 
Time
 
curTime
)

271 
Add»ss
 
add»ss
 = 
d©a
->
	`g‘Add»ss
();

276 
	`as£¹
(
	`g‘Add»ss
().
	`g‘LšeAdd»ss
(è=ğ
add»ss
.getLineAddress());

277 
	`as£¹
(
d©a
 !ğ
NULL
);

279 
	`DPRINTF
(
RubyTe¡
, "RubyTester Callback\n");

280 
	`debugPršt
();

282 ià(
m_¡©us
 =ğ
Te¡”Stus_AùiÚ_P’dšg
) {

283 
	`DPRINTF
(
RubyTe¡
, "Action callback write value: %d, currently %d\n",

284 (
m_v®ue
 + 
m_¡Üe_couÁ
), 
d©a
->
	`g‘By‹
(0));

286 
d©a
->
	`£tBy‹
(0, (
m_v®ue
 + 
m_¡Üe_couÁ
));

287 
m_¡Üe_couÁ
++;

288 ià(
m_¡Üe_couÁ
 =ğ
CHECK_SIZE
) {

289 
m_¡©us
 = 
Te¡”Stus_R—dy
;

291 
m_¡©us
 = 
Te¡”Stus_IdË
;

293 
	`DPRINTF
(
RubyTe¡
, "Action callback„eturn data‚ow %d\n",

294 
d©a
->
	`g‘By‹
(0));

295 } ià(
m_¡©us
 =ğ
Te¡”Stus_Check_P’dšg
) {

296 
	`DPRINTF
(
RubyTe¡
, "Check callback\n");

298 
by‹_numb”
=0; by‹_numb”<
CHECK_SIZE
; byte_number++) {

299 ià(
	`ušt8_t
(
m_v®ue
 + 
by‹_numb”
è!ğ
d©a
->
	`g‘By‹
(byte_number)) {

300 
	`·nic
("Action/check failure:…roc: %d‡ddress: %s data: %s "

303 
´oc
, 
add»ss
, 
d©a
, 
by‹_numb”
,

304 ()
m_v®ue
 + 
by‹_numb”
,

305 ()
d©a
->
	`g‘By‹
(
by‹_numb”
), *
this
, 
curTime
);

308 
	`DPRINTF
(
RubyTe¡
, "Action/check success\n");

309 
	`debugPršt
();

312 
m_‹¡”_±r
->
	`šüem’tCheckCom¶‘iÚs
();

314 
m_¡©us
 = 
Te¡”Stus_IdË
;

315 
	`pickV®ue
();

318 
	`·nic
("Unexpected TesterStatus: %s…roc: %d data: %s m_status: %s "

319 "time: %d\n", *
this
, 
´oc
, 
d©a
, 
m_¡©us
, 
curTime
);

322 
	`DPRINTF
(
RubyTe¡
, "´oc: %d, Add»ss: 0x%x\n", 
´oc
,

323 
	`g‘Add»ss
().
	`g‘LšeAdd»ss
());

324 
	`DPRINTF
(
RubyTe¡
, "Callback done\n");

325 
	`debugPršt
();

326 
	}
}

329 
	gCheck
::
	$chªgeAdd»ss
(cÚ¡ 
Add»ss
& 
add»ss
)

331 
	`as£¹
(
m_¡©us
 =ğ
Te¡”Stus_IdË
 || m_¡©u =ğ
Te¡”Stus_R—dy
);

332 
m_¡©us
 = 
Te¡”Stus_IdË
;

333 
m_add»ss
 = 
add»ss
;

334 
m_¡Üe_couÁ
 = 0;

335 
	}
}

338 
	gCheck
::
	$pickV®ue
()

340 
	`as£¹
(
m_¡©us
 =ğ
Te¡”Stus_IdË
);

341 
m_¡©us
 = 
Te¡”Stus_IdË
;

342 
m_v®ue
 = 
	`¿ndom
() & 0xff;

343 
m_¡Üe_couÁ
 = 0;

344 
	}
}

347 
	gCheck
::
	$pickIn™ŸtšgNode
()

349 
	`as£¹
(
m_¡©us
 =ğ
Te¡”Stus_IdË
 || m_¡©u =ğ
Te¡”Stus_R—dy
);

350 
m_¡©us
 = 
Te¡”Stus_IdË
;

351 
m_š™ŸtšgNode
 = (
	`¿ndom
(è% 
m_num_wr™”s
);

352 
	`DPRINTF
(
RubyTe¡
, "picked in™Ÿtšg‚od%d\n", 
m_š™ŸtšgNode
);

353 
m_¡Üe_couÁ
 = 0;

354 
	}
}

357 
	gCheck
::
´št
(
¡d
::
o¡»am
& 
out
) const

359 
out
 << "["

360 << 
m_add»ss
 << ", value: "

361 << ()
m_v®ue
 << ", status: "

362 << 
m_¡©us
 << ", initiating‚ode: "

363 << 
m_š™ŸtšgNode
 << ", store_count: "

364 << 
m_¡Üe_couÁ


365 << "]" << 
¡d
::
æush
;

369 
	gCheck
::
	$debugPršt
()

371 
	`DPRINTF
(
RubyTe¡
,

373 
m_add»ss
.
	`g‘Add»ss
(), ()
m_v®ue
,

374 
	`Te¡”Stus_to_¡ršg
(
m_¡©us
).
	`c_¡r
(),

375 
m_š™ŸtšgNode
, 
m_¡Üe_couÁ
);

376 
	}
}

	@testers/rubytest/Check.hh

30 #iâdeà
__CPU_RUBYTEST_CHECK_HH__


31 
	#__CPU_RUBYTEST_CHECK_HH__


	)

33 
	~<io¡»am
>

35 
	~"ıu/‹¡”s/ruby‹¡/RubyTe¡”.hh
"

36 
	~"mem/´ÙocŞ/RubyAcûssMode.hh
"

37 
	~"mem/´ÙocŞ/Te¡”Stus.hh
"

38 
	~"mem/ruby/commÚ/Add»ss.hh
"

39 
	~"mem/ruby/commÚ/Glob®.hh
"

41 
şass
 
	gSubBlock
;

43 cÚ¡ 
	gCHECK_SIZE_BITS
 = 2;

44 cÚ¡ 
	gCHECK_SIZE
 = (1 << 
CHECK_SIZE_BITS
);

46 şas 
	cCheck


48 
	mpublic
:

49 
Check
(cÚ¡ 
Add»ss
& 
add»ss
, cÚ¡ Add»ss& 
pc
, 
_num_wr™”s
,

50 
_num_»ad”s
, 
RubyTe¡”
* 
_‹¡”
);

52 
š™Ÿ‹
();

53 
³rfÜmC®lback
(
NodeID
 
´oc
, 
SubBlock
* 
d©a
, 
Time
 
curTime
);

54 cÚ¡ 
	mAdd»ss
& 
	$g‘Add»ss
(è{  
m_add»ss
; }

55 
	`chªgeAdd»ss
(cÚ¡ 
Add»ss
& 
add»ss
);

57 
	`´št
(
¡d
::
o¡»am
& 
out
) const;

59 
´iv©e
:

60 
	`š™Ÿ‹Flush
();

61 
	`š™Ÿ‹P»ãtch
();

62 
	`š™Ÿ‹AùiÚ
();

63 
	`š™Ÿ‹Check
();

65 
	`pickV®ue
();

66 
	`pickIn™ŸtšgNode
();

68 
	`debugPršt
();

70 
Te¡”Stus
 
m_¡©us
;

71 
ušt8_t
 
m_v®ue
;

72 
m_¡Üe_couÁ
;

73 
NodeID
 
m_š™ŸtšgNode
;

74 
Add»ss
 
m_add»ss
;

75 
Add»ss
 
m_pc
;

76 
RubyAcûssMode
 
m_acûss_mode
;

77 
m_num_wr™”s
;

78 
m_num_»ad”s
;

79 
RubyTe¡”
* 
m_‹¡”_±r
;

80 
	}
};

82 
šlše
 
	g¡d
::
o¡»am
&

83 
İ”©Ü
<<(
¡d
::
o¡»am
& 
out
, cÚ¡ 
	gCheck
& 
	gobj
)

85 
	gobj
.
´št
(
out
);

86 
	gout
 << 
	g¡d
::
æush
;

87  
	gout
;

	@testers/rubytest/CheckTable.cc

30 
	~"ba£/štm©h.hh
"

31 
	~"ıu/‹¡”s/ruby‹¡/Check.hh
"

32 
	~"ıu/‹¡”s/ruby‹¡/CheckTabË.hh
"

33 
	~"debug/RubyTe¡.hh
"

35 
	gCheckTabË
::
	$CheckTabË
(
_num_wr™”s
, 
_num_»ad”s
, 
RubyTe¡”
* 
_‹¡”
)

36 : 
	`m_num_wr™”s
(
_num_wr™”s
), 
	`m_num_»ad”s
(
_num_»ad”s
),

37 
	$m_‹¡”_±r
(
_‹¡”
)

39 
physiÿl_add»ss_t
 
physiÿl
 = 0;

40 
Add»ss
 
add»ss
;

42 cÚ¡ 
size1
 = 32;

43 cÚ¡ 
size2
 = 100;

46 
physiÿl
 = 1000;

47 
i
 = 0; i < 
size1
; i++) {

49 
add»ss
.
	`£tAdd»ss
(
physiÿl
);

50 
	`addCheck
(
add»ss
);

51 
physiÿl
 +ğ
CHECK_SIZE
;

56 
physiÿl
 = 1000;

57 
i
 = 0; i < 
size2
; i++) {

59 
add»ss
.
	`£tAdd»ss
(
physiÿl
);

60 
	`addCheck
(
add»ss
);

61 
physiÿl
 += 256;

64 
physiÿl
 = 1000 + 
CHECK_SIZE
;

65 
i
 = 0; i < 
size2
; i++) {

67 
add»ss
.
	`£tAdd»ss
(
physiÿl
);

68 
	`addCheck
(
add»ss
);

69 
physiÿl
 += 256;

71 
	}
}

73 
	gCheckTabË
::~
	$CheckTabË
()

75 
size
 = 
m_check_veùÜ
.
	`size
();

76 
i
 = 0; i < 
size
; i++)

77 
d–‘e
 
m_check_veùÜ
[
i
];

78 
	}
}

81 
	gCheckTabË
::
	$addCheck
(cÚ¡ 
Add»ss
& 
add»ss
)

83 ià(
	`æoÜLog2
(
CHECK_SIZE
) != 0) {

84 ià(
add»ss
.
	`b™S–eù
(0, 
CHECK_SIZE_BITS
 - 1) != 0) {

85 
	`·nic
("Check‚ot‡ligned");

89 
i
 = 0; i < 
CHECK_SIZE
; i++) {

90 ià(
m_lookup_m­
.
	`couÁ
(
	`Add»ss
(
add»ss
.
	`g‘Add»ss
()+
i
))) {

97 
Check
* 
check_±r
 = 
Ãw
 
	`Check
(
add»ss
, 
	`Add»ss
(100 + 
m_check_veùÜ
.
	`size
()),

98 
m_num_wr™”s
, 
m_num_»ad”s
, 
m_‹¡”_±r
);

99 
i
 = 0; i < 
CHECK_SIZE
; i++) {

101 
m_lookup_m­
[
	`Add»ss
(
add»ss
.
	`g‘Add»ss
(è+ 
i
)] = 
check_±r
;

103 
m_check_veùÜ
.
	`push_back
(
check_±r
);

104 
	}
}

106 
Check
*

107 
	gCheckTabË
::
	$g‘RªdomCheck
()

109 
	`as£¹
(
m_check_veùÜ
.
	`size
() > 0);

110  
m_check_veùÜ
[
	`¿ndom
(è% m_check_veùÜ.
	`size
()];

111 
	}
}

113 
Check
*

114 
	gCheckTabË
::
	$g‘Check
(cÚ¡ 
Add»ss
& 
add»ss
)

116 
	`DPRINTF
(
RubyTe¡
, "Lookšg fÜ check by‡dd»ss: %s", 
add»ss
);

118 
m5
::
hash_m­
<
Add»ss
, 
Check
*>::
™”©Ü
 
i
 = 
m_lookup_m­
.
	`fšd
(
add»ss
);

120 ià(
i
 =ğ
m_lookup_m­
.
	`’d
())

121  
NULL
;

123 
Check
* 
check
 = 
i
->
£cÚd
;

124 
	`as£¹
(
check
 !ğ
NULL
);

125  
check
;

126 
	}
}

129 
	gCheckTabË
::
´št
(
¡d
::
o¡»am
& 
out
) const

	@testers/rubytest/CheckTable.hh

30 #iâdeà
__CPU_RUBYTEST_CHECKTABLE_HH__


31 
	#__CPU_RUBYTEST_CHECKTABLE_HH__


	)

33 
	~<io¡»am
>

34 
	~<veùÜ
>

36 
	~"ba£/hashm­.hh
"

37 
	~"mem/ruby/commÚ/Add»ss.hh
"

38 
	~"mem/ruby/commÚ/Glob®.hh
"

40 
şass
 
	gCheck
;

41 
şass
 
	gRubyTe¡”
;

43 şas 
	cCheckTabË


45 
	mpublic
:

46 
CheckTabË
(
_num_wr™”s
, 
_num_»ad”s
, 
RubyTe¡”
* 
_‹¡”
);

47 ~
CheckTabË
();

49 
Check
* 
g‘RªdomCheck
();

50 
Check
* 
g‘Check
(cÚ¡ 
Add»ss
& 
add»ss
);

57 
´št
(
¡d
::
o¡»am
& 
out
) const;

59 
	m´iv©e
:

60 
addCheck
(cÚ¡ 
Add»ss
& 
add»ss
);

63 
CheckTabË
(cÚ¡ CheckTabË& 
obj
);

64 
	mCheckTabË
& 
	mİ”©Ü
=(cÚ¡ 
CheckTabË
& 
obj
);

66 
	m¡d
::
veùÜ
<
Check
*> 
m_check_veùÜ
;

67 
	mm5
::
hash_m­
<
Add»ss
, 
	mCheck
*> 
	mm_lookup_m­
;

69 
	mm_num_wr™”s
;

70 
	mm_num_»ad”s
;

71 
RubyTe¡”
* 
	mm_‹¡”_±r
;

74 
šlše
 
	g¡d
::
o¡»am
&

75 
İ”©Ü
<<(
¡d
::
o¡»am
& 
out
, cÚ¡ 
	gCheckTabË
& 
	gobj
)

77 
	gobj
.
´št
(
out
);

78 
	gout
 << 
	g¡d
::
æush
;

79  
	gout
;

	@testers/rubytest/RubyTester.cc

42 
	~"ba£/misc.hh
"

43 
	~"ıu/‹¡”s/ruby‹¡/Check.hh
"

44 
	~"ıu/‹¡”s/ruby‹¡/RubyTe¡”.hh
"

45 
	~"debug/RubyTe¡.hh
"

46 
	~"mem/ruby/commÚ/Glob®.hh
"

47 
	~"mem/ruby/commÚ/SubBlock.hh
"

48 
	~"mem/ruby/sy¡em/Sy¡em.hh
"

49 
	~"sim/sim_ex™.hh
"

50 
	~"sim/sy¡em.hh
"

52 
	gRubyTe¡”
::
	$RubyTe¡”
(cÚ¡ 
P¬ams
 *
p
)

53 : 
	`MemObjeù
(
p
), 
	`checkS¹Ev’t
(
this
),

54 
	`_ma¡”Id
(
p
->
sy¡em
->
	`g‘Ma¡”Id
(
	`Çme
())),

55 
	`m_num_ıus
(
p
->
num_ıus
),

56 
	`m_checks_to_com¶‘e
(
p
->
checks_to_com¶‘e
),

57 
	`m_d—dlock_th»shŞd
(
p
->
d—dlock_th»shŞd
),

58 
	`m_wakeup_äequ’cy
(
p
->
wakeup_äequ’cy
),

59 
	`m_check_æush
(
p
->
check_æush
),

60 
	`m_num_š¡_pÜts
(
p
->
pÜt_ıuIn¡PÜt_cÚÃùiÚ_couÁ
)

62 
m_checks_com¶‘ed
 = 0;

75 
i
 = 0; i < 
p
->
pÜt_ıuIn¡PÜt_cÚÃùiÚ_couÁ
; ++i) {

76 
»adPÜts
.
	`push_back
(
Ãw
 
	`CpuPÜt
(
	`c¥rštf
("%s-š¡PÜt%d", 
	`Çme
(), 
i
),

77 
this
, 
i
));

79 
i
 = 0; i < 
p
->
pÜt_ıuD©aPÜt_cÚÃùiÚ_couÁ
; ++i) {

80 
CpuPÜt
 *
pÜt
 = 
Ãw
 
	`CpuPÜt
(
	`c¥rštf
("%s-d©aPÜt%d", 
	`Çme
(), 
i
),

81 
this
, 
i
);

82 
»adPÜts
.
	`push_back
(
pÜt
);

83 
wr™ePÜts
.
	`push_back
(
pÜt
);

87 
	`scheduË
(
checkS¹Ev’t
, 1);

88 
	}
}

90 
	gRubyTe¡”
::~
	$RubyTe¡”
()

92 
d–‘e
 
m_checkTabË_±r
;

94 
i
 = 0; i < 
»adPÜts
.
	`size
(); i++)

95 
d–‘e
 
»adPÜts
[
i
];

96 
	}
}

99 
	gRubyTe¡”
::
	$š™
()

101 
	`as£¹
(
wr™ePÜts
.
	`size
(è> 0 && 
»adPÜts
.size() > 0);

103 
m_Ï¡_´og»ss_veùÜ
.
	`»size
(
m_num_ıus
);

104 
i
 = 0; i < 
m_Ï¡_´og»ss_veùÜ
.
	`size
(); i++) {

105 
m_Ï¡_´og»ss_veùÜ
[
i
] = 0;

108 
m_num_wr™”s
 = 
wr™ePÜts
.
	`size
();

109 
m_num_»ad”s
 = 
»adPÜts
.
	`size
();

111 
m_checkTabË_±r
 = 
Ãw
 
	`CheckTabË
(
m_num_wr™”s
, 
m_num_»ad”s
, 
this
);

112 
	}
}

114 
	gBa£Ma¡”PÜt
 &

115 
	gRubyTe¡”
::
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
, 
PÜtID
 
idx
)

117 ià(
	gif_Çme
 !ğ"ıuIn¡PÜt" && 
if_Çme
 != "cpuDataPort") {

119  
MemObjeù
::
g‘Ma¡”PÜt
(
if_Çme
, 
idx
);

121 ià(
	gif_Çme
 == "cpuInstPort") {

122 ià(
idx
 > 
m_num_š¡_pÜts
) {

123 
·nic
("RubyTester::getMasterPort: unknown inst…ort idx %d\n",

124 
idx
);

129  *
	g»adPÜts
[
idx
];

131 
as£¹
(
if_Çme
 == "cpuDataPort");

136 
	g»ad_idx
 = 
idx
 + 
m_num_š¡_pÜts
;

137 ià(
	g»ad_idx
 >ğ
¡©ic_ÿ¡
<
PÜtID
>(
»adPÜts
.
size
())) {

138 
·nic
("RubyTester::getMasterPort: unknown data…ort idx %d\n",

139 
idx
);

141  *
	g»adPÜts
[
»ad_idx
];

146 
boŞ


147 
	gRubyTe¡”
::
CpuPÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

150 
RubyTe¡”
::
S’d”S‹
* 
£nd”S‹
 =

151 
§ã_ÿ¡
<
RubyTe¡”
::
S’d”S‹
*>(
pkt
->
£nd”S‹
);

152 
SubBlock
& 
subblock
 = 
£nd”S‹
->
subBlock
;

154 
‹¡”
->
	`h™C®lback
(
id
, &
subblock
);

158 
d–‘e
 
pkt
->
£nd”S‹
;

159 
d–‘e
 
pkt
->
»q
;

160 
d–‘e
 
pkt
;

161  
Œue
;

162 
	}
}

164 
boŞ


165 
	gRubyTe¡”
::
	$isIn¡R—dabËCpuPÜt
(
idx
)

167  
idx
 < 
m_num_š¡_pÜts
;

168 
	}
}

170 
Ma¡”PÜt
*

171 
	gRubyTe¡”
::
	$g‘R—dabËCpuPÜt
(
idx
)

173 
	`as£¹
(
idx
 >ğ0 && idx < 
»adPÜts
.
	`size
());

175  
»adPÜts
[
idx
];

176 
	}
}

178 
Ma¡”PÜt
*

179 
	gRubyTe¡”
::
	$g‘Wr™abËCpuPÜt
(
idx
)

181 
	`as£¹
(
idx
 >ğ0 && idx < 
wr™ePÜts
.
	`size
());

183  
wr™ePÜts
[
idx
];

184 
	}
}

187 
	gRubyTe¡”
::
	$h™C®lback
(
NodeID
 
´oc
, 
SubBlock
* 
d©a
)

190 
m_Ï¡_´og»ss_veùÜ
[
´oc
] = 
	`curCyşe
();

192 
	`DPRINTF
(
RubyTe¡
, "com¶‘ed„eque¡ fÜ…roc: %d\n", 
´oc
);

193 
	`DPRINTF
(
RubyTe¡
, "addr: 0x%x, size: %d, data: ",

194 
d©a
->
	`g‘Add»ss
(), d©a->
	`g‘Size
());

195 
by‹
 = 0; by‹ < 
d©a
->
	`g‘Size
(); byte++) {

196 
	`DPRINTF
(
RubyTe¡
, "%d", 
d©a
->
	`g‘By‹
(
by‹
));

198 
	`DPRINTF
(
RubyTe¡
, "\n");

202 
Check
* 
check_±r
 = 
m_checkTabË_±r
->
	`g‘Check
(
d©a
->
	`g‘Add»ss
());

203 
	`as£¹
(
check_±r
 !ğ
NULL
);

204 
check_±r
->
	`³rfÜmC®lback
(
´oc
, 
d©a
, 
	`curCyşe
());

205 
	}
}

208 
	gRubyTe¡”
::
	$wakeup
()

210 ià(
m_checks_com¶‘ed
 < 
m_checks_to_com¶‘e
) {

212 
Check
* 
check_±r
 = 
m_checkTabË_±r
->
	`g‘RªdomCheck
();

213 
	`as£¹
(
check_±r
 !ğ
NULL
);

214 
check_±r
->
	`š™Ÿ‹
();

216 
	`checkFÜD—dlock
();

218 
	`scheduË
(
checkS¹Ev’t
, 
	`curTick
(è+ 
m_wakeup_äequ’cy
);

220 
	`ex™SimLoİ
("Ruby Tester completed");

222 
	}
}

225 
	gRubyTe¡”
::
	$checkFÜD—dlock
()

227 
size
 = 
m_Ï¡_´og»ss_veùÜ
.
	`size
();

228 
Time
 
cu¼’t_time
 = 
	`curCyşe
();

229 
´oûssÜ
 = 0;…roûssÜ < 
size
;…rocessor++) {

230 ià((
cu¼’t_time
 - 
m_Ï¡_´og»ss_veùÜ
[
´oûssÜ
]) >

231 
m_d—dlock_th»shŞd
) {

232 
	`·nic
("Deadlock detected: current_time: %d†ast_progress_time: %d "

234 
cu¼’t_time
, 
m_Ï¡_´og»ss_veùÜ
[
´oûssÜ
],

235 
cu¼’t_time
 - 
m_Ï¡_´og»ss_veùÜ
[
´oûssÜ
],…rocessor);

238 
	}
}

241 
	gRubyTe¡”
::
´št
(
¡d
::
o¡»am
& 
out
) const

243 
out
 << "[RubyTe¡”]" << 
¡d
::
’dl
;

246 
RubyTe¡”
 *

247 
	gRubyTe¡”P¬ams
::
	$ü—‹
()

249  
Ãw
 
	`RubyTe¡”
(
this
);

250 
	}
}

	@testers/rubytest/RubyTester.hh

42 #iâdeà
__CPU_RUBYTEST_RUBYTESTER_HH__


43 
	#__CPU_RUBYTEST_RUBYTESTER_HH__


	)

45 
	~<io¡»am
>

46 
	~<¡ršg
>

47 
	~<veùÜ
>

49 
	~"ıu/‹¡”s/ruby‹¡/CheckTabË.hh
"

50 
	~"mem/ruby/commÚ/Glob®.hh
"

51 
	~"mem/ruby/commÚ/SubBlock.hh
"

52 
	~"mem/ruby/sy¡em/RubyPÜt.hh
"

53 
	~"mem/mem_objeù.hh
"

54 
	~"mem/·ck‘.hh
"

55 
	~"·¿ms/RubyTe¡”.hh
"

57 şas 
	cRubyTe¡”
 : 
public
 
MemObjeù


59 
public
:

60 şas 
	cCpuPÜt
 : 
public
 
Ma¡”PÜt


62 
´iv©e
:

63 
RubyTe¡”
 *
‹¡”
;

65 
	mpublic
:

72 
CpuPÜt
(cÚ¡ 
¡d
::
¡ršg
 &
_Çme
, 
RubyTe¡”
 *
_‹¡”
, 
PÜtID
 
_id
)

73 : 
Ma¡”PÜt
(
_Çme
, 
_‹¡”
, 
_id
), 
‹¡”
(_tester)

76 
	m´Ùeùed
:

77 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

78 
vœtu®
 
»cvR‘ry
()

79 { 
·nic
("% dÛ nÙƒx³ù‡„‘ry\n", 
Çme
()); }

82 
	gS’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


84 
SubBlock
 
subBlock
;

86 
S’d”S‹
(
Add»ss
 
addr
, 
size
è: 
subBlock
(addr, size) {}

90 
RubyTe¡”P¬ams
 
	tP¬ams
;

91 
RubyTe¡”
(cÚ¡ 
P¬ams
 *
p
);

92 ~
RubyTe¡”
();

94 
vœtu®
 
	gBa£Ma¡”PÜt
 &
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
,

95 
PÜtID
 
idx
 = 
Inv®idPÜtID
);

97 
boŞ
 
isIn¡R—dabËCpuPÜt
(
idx
);

99 
Ma¡”PÜt
* 
g‘R—dabËCpuPÜt
(
idx
);

100 
Ma¡”PÜt
* 
g‘Wr™abËCpuPÜt
(
idx
);

102 
vœtu®
 
š™
();

104 
wakeup
();

106 
	$šüem’tCheckCom¶‘iÚs
(è{ 
m_checks_com¶‘ed
++; 
	}
}

108 
´štSts
(
¡d
::
o¡»am
& 
out
) const {}

109 
	$ş—rSts
(è{
	}
}

110 
´štCÚfig
(
¡d
::
o¡»am
& 
out
) const {}

112 
´št
(
¡d
::
o¡»am
& 
out
) const;

113 
boŞ
 
	$g‘CheckFlush
(è{  
m_check_æush
; 
	}
}

115 
Ma¡”ID
 
	$ma¡”Id
(è{  
_ma¡”Id
; 
	}
}

116 
	g´Ùeùed
:

117 şas 
	cCheckS¹Ev’t
 : 
public
 
Ev’t


119 
´iv©e
:

120 
RubyTe¡”
 *
‹¡”
;

122 
	gpublic
:

123 
CheckS¹Ev’t
(
RubyTe¡”
 *
_‹¡”
)

124 : 
Ev’t
(
CPU_Tick_Pri
), 
‹¡”
(
_‹¡”
)

126 
´oûss
(è{ 
	g‹¡”
->
wakeup
(); }

127 
vœtu®
 cÚ¡ *
desütiÚ
() const {  "RubyTesterick"; }

130 
CheckS¹Ev’t
 
	gcheckS¹Ev’t
;

132 
Ma¡”ID
 
	g_ma¡”Id
;

134 
	g´iv©e
:

135 
h™C®lback
(
NodeID
 
´oc
, 
SubBlock
* 
d©a
);

137 
checkFÜD—dlock
();

140 
RubyTe¡”
(cÚ¡ RubyTe¡”& 
obj
);

141 
	gRubyTe¡”
& 
	gİ”©Ü
=(cÚ¡ 
RubyTe¡”
& 
obj
);

143 
CheckTabË
* 
	gm_checkTabË_±r
;

144 
	g¡d
::
veùÜ
<
Time
> 
m_Ï¡_´og»ss_veùÜ
;

146 
	gm_num_ıus
;

147 
ušt64
 
	gm_checks_com¶‘ed
;

148 
	g¡d
::
veùÜ
<
Ma¡”PÜt
*> 
wr™ePÜts
;

149 
	g¡d
::
veùÜ
<
Ma¡”PÜt
*> 
»adPÜts
;

150 
ušt64
 
	gm_checks_to_com¶‘e
;

151 
	gm_d—dlock_th»shŞd
;

152 
	gm_num_wr™”s
;

153 
	gm_num_»ad”s
;

154 
	gm_wakeup_äequ’cy
;

155 
boŞ
 
	gm_check_æush
;

156 
	gm_num_š¡_pÜts
;

159 
šlše
 
	g¡d
::
o¡»am
&

160 
İ”©Ü
<<(
¡d
::
o¡»am
& 
out
, cÚ¡ 
	gRubyTe¡”
& 
	gobj
)

162 
	gobj
.
´št
(
out
);

163 
	gout
 << 
	g¡d
::
æush
;

164  
	gout
;

	@testers/traffic_gen/generators.cc

42 
	~"ba£/¿ndom.hh
"

43 
	~"ba£/Œaû.hh
"

44 
	~"ıu/‹¡”s/Œaffic_g’/g’”©Üs.hh
"

45 
	~"debug/T¿fficG’.hh
"

46 
	~"´Ùo/·ck‘.pb.h
"

48 
	gBa£G’
::
Ba£G’
(cÚ¡ 
¡d
::
¡ršg
& 
_Çme
, 
Ma¡”ID
 
ma¡”_id
, 
Tick
 
_du¿tiÚ
)

49 : 
_Çme
(_Çme), 
ma¡”ID
(
ma¡”_id
), 
	$du¿tiÚ
(
_du¿tiÚ
)

51 
	}
}

53 
Pack‘PŒ


54 
	gBa£G’
::
g‘Pack‘
(
Addr
 
addr
, 
size
, cÚ¡ 
MemCmd
& 
cmd
,

55 
Reque¡
::
FÏgsTy³
 
æags
)

58 
Reque¡
 *
»q
 = 
Ãw
 Reque¡(
addr
, 
size
, 
æags
, 
ma¡”ID
);

61 
Pack‘PŒ
 
	gpkt
 = 
Ãw
 
Pack‘
(
»q
, 
cmd
);

63 
ušt8_t
* 
	gpkt_d©a
 = 
Ãw
 ušt8_t[
»q
->
g‘Size
()];

64 
	gpkt
->
d©aDyÇmicA¼ay
(
pkt_d©a
);

66 ià(
	gcmd
.
isWr™e
()) {

67 
mem£t
(
pkt_d©a
, 0xA, 
»q
->
g‘Size
());

70  
	gpkt
;

74 
	gLš—rG’
::
	$’‹r
()

77 
ÃxtAddr
 = 
¡¬tAddr
;

78 
d©aMªuÏ‹d
 = 0;

79 
	}
}

81 
Pack‘PŒ


82 
	gLš—rG’
::
	$g‘NextPack‘
()

85 
boŞ
 
isR—d
 = 
»adP”ûÁ
 != 0 &&

86 (
»adP”ûÁ
 =ğ100 || 
¿ndom_mt
.
¿ndom
<
ušt8_t
>(0, 100) <„eadPercent);

88 
	`as£¹
((
»adP”ûÁ
 =ğ0 && !
isR—d
) || (readPercent == 100 && isRead) ||

89 
»adP”ûÁ
 != 100);

91 
	`DPRINTF
(
T¿fficG’
, "LinearGen::getNextPacket: %co‡ddr %x, size %d\n",

92 
isR—d
 ? 'r' : 'w', 
ÃxtAddr
, 
blocksize
);

95 
d©aMªuÏ‹d
 +ğ
blocksize
;

97 
Pack‘PŒ
 
pkt
 = 
	`g‘Pack‘
(
ÃxtAddr
, 
blocksize
,

98 
isR—d
 ? 
MemCmd
::
R—dReq
 : MemCmd::
Wr™eReq
);

101 
ÃxtAddr
 +ğ
blocksize
;

105 ià(
ÃxtAddr
 > 
’dAddr
) {

106 
	`DPRINTF
(
T¿fficG’
, "Wrapping‡ddressohe start of "

108 
ÃxtAddr
 = 
¡¬tAddr
;

111  
pkt
;

112 
	}
}

114 
Tick


115 
	gLš—rG’
::
	$ÃxtPack‘Tick
(
boŞ
 
–a¡ic
, 
Tick
 
d–ay
) const

120 ià(
d©aLim™
 && 
d©aMªuÏ‹d
 >= dataLimit) {

121 
	`DPRINTF
(
T¿fficG’
, "Data†imit for LinearGen„eached.\n");

123  
MaxTick
;

126 
Tick
 
wa™
 = 
¿ndom_mt
.
¿ndom
<Tick>(
mšP”iod
, 
maxP”iod
);

131 ià(!
–a¡ic
) {

132 ià(
wa™
 < 
d–ay
)

133 
wa™
 = 0;

135 
wa™
 -ğ
d–ay
;

138  
	`curTick
(è+ 
wa™
;

140 
	}
}

143 
	gRªdomG’
::
	$’‹r
()

146 
d©aMªuÏ‹d
 = 0;

147 
	}
}

149 
Pack‘PŒ


150 
	gRªdomG’
::
	$g‘NextPack‘
()

153 
boŞ
 
isR—d
 = 
»adP”ûÁ
 != 0 &&

154 (
»adP”ûÁ
 =ğ100 || 
¿ndom_mt
.
¿ndom
<
ušt8_t
>(0, 100) <„eadPercent);

156 
	`as£¹
((
»adP”ûÁ
 =ğ0 && !
isR—d
) || (readPercent == 100 && isRead) ||

157 
»adP”ûÁ
 != 100);

160 
Addr
 
addr
 = 
¿ndom_mt
.
¿ndom
<Addr>(
¡¬tAddr
, 
’dAddr
 - 1);

163 
addr
 -ğadd¸% 
blocksize
;

165 
	`DPRINTF
(
T¿fficG’
, "RandomGen::getNextPacket: %co‡ddr %x, size %d\n",

166 
isR—d
 ? 'r' : 'w', 
addr
, 
blocksize
);

169 
d©aMªuÏ‹d
 +ğ
blocksize
;

172  
	`g‘Pack‘
(
addr
, 
blocksize
,

173 
isR—d
 ? 
MemCmd
::
R—dReq
 : MemCmd::
Wr™eReq
);

174 
	}
}

176 
Tick


177 
	gRªdomG’
::
	$ÃxtPack‘Tick
(
boŞ
 
–a¡ic
, 
Tick
 
d–ay
) const

182 ià(
d©aLim™
 && 
d©aMªuÏ‹d
 >= dataLimit)

184 
	`DPRINTF
(
T¿fficG’
, "Data†imit for RandomGen„eached.\n");

186  
MaxTick
;

189 
Tick
 
wa™
 = 
¿ndom_mt
.
¿ndom
<Tick>(
mšP”iod
, 
maxP”iod
);

194 ià(!
–a¡ic
) {

195 ià(
wa™
 < 
d–ay
)

196 
wa™
 = 0;

198 
wa™
 -ğ
d–ay
;

201  
	`curTick
(è+ 
wa™
;

203 
	}
}

205 
	gT¿ûG’
::
IÅutSŒ—m
::IÅutSŒ—m(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
)

206 : 
	$Œaû
(
f’ame
)

208 
	`š™
();

209 
	}
}

212 
	gT¿ûG’
::
IÅutSŒ—m
::
	$š™
()

215 
Mes§ge
::
Pack‘H—d”
 
h—d”_msg
;

216 ià(!
Œaû
.
	`»ad
(
h—d”_msg
)) {

217 
	`·nic
("Failedo„ead…acket header fromrace\n");

219 ià(
h—d”_msg
.
	`tick_äeq
(è!ğ
SimClock
::
F»qu’cy
) {

220 
	`·nic
("Trace was„ecorded with‡ differentick frequency %d\n",

221 
h—d”_msg
.
	`tick_äeq
());

224 
	}
}

227 
	gT¿ûG’
::
IÅutSŒ—m
::
	$»£t
()

229 
Œaû
.
	`»£t
();

230 
	`š™
();

231 
	}
}

233 
boŞ


234 
	gT¿ûG’
::
IÅutSŒ—m
::
	$»ad
(
T¿ûEËm’t
& 
–em’t
)

236 
Mes§ge
::
Pack‘
 
pkt_msg
;

237 ià(
Œaû
.
	`»ad
(
pkt_msg
)) {

238 
–em’t
.
cmd
 = 
pkt_msg
.
	`cmd
();

239 
–em’t
.
addr
 = 
pkt_msg
.
	`addr
();

240 
–em’t
.
blocksize
 = 
pkt_msg
.
	`size
();

241 
–em’t
.
tick
 = 
pkt_msg
.
	`tick
();

242 
–em’t
.
æags
 = 
pkt_msg
.
	`has_æags
(è?…kt_msg.
	`æags
() : 0;

243  
Œue
;

247  
çl£
;

248 
	}
}

250 
Tick


251 
	gT¿ûG’
::
	$ÃxtPack‘Tick
(
boŞ
 
–a¡ic
, 
Tick
 
d–ay
) const

253 ià(
ŒaûCom¶‘e
) {

254 
	`DPRINTF
(
T¿fficG’
, "No‚extick‡srace is finished\n");

258  
MaxTick
;

261 
	`as£¹
(
ÃxtEËm’t
.
	`isV®id
());

263 
	`DPRINTF
(
T¿fficG’
, "Nexˆ·ck‘ick i %d\n", 
tickOff£t
 +

264 
ÃxtEËm’t
.
tick
);

267 ià(
–a¡ic
)

268 
tickOff£t
 +ğ
d–ay
;

270  
¡d
::
	`max
(
tickOff£t
 + 
ÃxtEËm’t
.
tick
, 
	`curTick
());

271 
	}
}

274 
	gT¿ûG’
::
	$’‹r
()

277 
tickOff£t
 = 
	`curTick
();

280 
cu¼EËm’t
.
	`ş—r
();

283 
ŒaûCom¶‘e
 = !
Œaû
.
	`»ad
(
ÃxtEËm’t
);

284 
	}
}

286 
Pack‘PŒ


287 
	gT¿ûG’
::
	$g‘NextPack‘
()

290 
cu¼EËm’t
 = 
ÃxtEËm’t
;

291 
ÃxtEËm’t
.
	`ş—r
();

294 
ŒaûCom¶‘e
 = !
Œaû
.
	`»ad
(
ÃxtEËm’t
);

298 
	`as£¹
(
cu¼EËm’t
.
	`isV®id
());

300 
	`DPRINTF
(
T¿fficG’
, "TraceGen::getNextPacket: %c %d %d %d 0x%x\n",

301 
cu¼EËm’t
.
cmd
.
	`isR—d
() ? 'r' : 'w',

302 
cu¼EËm’t
.
addr
,

303 
cu¼EËm’t
.
blocksize
,

304 
cu¼EËm’t
.
tick
,

305 
cu¼EËm’t
.
æags
);

307 
Pack‘PŒ
 
pkt
 = 
	`g‘Pack‘
(
cu¼EËm’t
.
addr
 + 
addrOff£t
,

308 
cu¼EËm’t
.
blocksize
,

309 
cu¼EËm’t
.
cmd
, cu¼EËm’t.
æags
);

311 ià(!
ŒaûCom¶‘e
)

312 
	`DPRINTF
(
T¿fficG’
, "nextElement: %c‡ddr %d size %dick %d (%d)\n",

313 
ÃxtEËm’t
.
cmd
.
	`isR—d
() ? 'r' : 'w',

314 
ÃxtEËm’t
.
addr
,

315 
ÃxtEËm’t
.
blocksize
,

316 
ÃxtEËm’t
.
tick
 + 
tickOff£t
,

317 
ÃxtEËm’t
.
tick
);

319  
pkt
;

320 
	}
}

323 
	gT¿ûG’
::
	$ex™
()

328 ià(!
ŒaûCom¶‘e
) {

329 
	`w¬n
("Trace…layer %s was unableo„eplayheƒntirerace!\n",

330 
	`Çme
());

335 
Œaû
.
	`»£t
();

336 
	}
}

	@testers/traffic_gen/generators.hh

49 #iâdeà
__CPU_TRAFFIC_GEN_GENERATORS_HH__


50 
	#__CPU_TRAFFIC_GEN_GENERATORS_HH__


	)

52 
	~"mem/·ck‘.hh
"

53 
	~"´Ùo/´Ùoio.hh
"

60 şas 
	cBa£G’


63 
	m´Ùeùed
:

66 cÚ¡ 
¡d
::
¡ršg
 
_Çme
;

69 cÚ¡ 
Ma¡”ID
 
	mma¡”ID
;

79 
Pack‘PŒ
 
g‘Pack‘
(
Addr
 
addr
, 
size
, cÚ¡ 
MemCmd
& 
cmd
,

80 
Reque¡
::
FÏgsTy³
 
æags
 = 0);

82 
	mpublic
:

85 cÚ¡ 
Tick
 
du¿tiÚ
;

94 
Ba£G’
(cÚ¡ 
¡d
::
¡ršg
& 
_Çme
, 
Ma¡”ID
 
ma¡”_id
, 
Tick
 
_du¿tiÚ
);

96 
	mvœtu®
 ~
	$Ba£G’
() { }

103 
¡d
::
¡ršg
 
	$Çme
(ècÚ¡ {  
_Çme
; 
	}
}

108 
vœtu®
 
’‹r
() = 0;

115 
vœtu®
 
Pack‘PŒ
 
g‘NextPack‘
() = 0;

120 
vœtu®
 
	$ex™
(è{ 
	}
};

131 
vœtu®
 
Tick
 
	$ÃxtPack‘Tick
(
boŞ
 
–a¡ic
, 
Tick
 
d–ay
) const = 0;

133 
	}
};

138 şas 
	cIdËG’
 : 
public
 
Ba£G’


141 
public
:

143 
IdËG’
(cÚ¡ 
¡d
::
¡ršg
& 
_Çme
, 
Ma¡”ID
 
ma¡”_id
, 
Tick
 
_du¿tiÚ
)

144 : 
	$Ba£G’
(
_Çme
, 
ma¡”_id
, 
_du¿tiÚ
)

147 
	$’‹r
(è{ 
	}
}

149 
Pack‘PŒ
 
	$g‘NextPack‘
(è{  
NULL
; 
	}
}

151 
Tick
 
	$ÃxtPack‘Tick
(
boŞ
 
–a¡ic
, 
Tick
 
d–ay
ècÚ¡ {  
MaxTick
; 
	}
}

161 şas 
	cLš—rG’
 : 
public
 
Ba£G’


164 
public
:

182 
Lš—rG’
(cÚ¡ 
¡d
::
¡ršg
& 
_Çme
, 
Ma¡”ID
 
ma¡”_id
, 
Tick
 
_du¿tiÚ
,

183 
Addr
 
¡¬t_addr
, Add¸
’d_addr
, Add¸
_blocksize
,

184 
Tick
 
mš_³riod
, Tick 
max_³riod
,

185 
ušt8_t
 
»ad_³rûÁ
, 
Addr
 
d©a_lim™
)

186 : 
Ba£G’
(
_Çme
, 
ma¡”_id
, 
_du¿tiÚ
),

187 
¡¬tAddr
(
¡¬t_addr
), 
’dAddr
(
’d_addr
),

188 
blocksize
(
_blocksize
), 
mšP”iod
(
mš_³riod
),

189 
maxP”iod
(
max_³riod
), 
»adP”ûÁ
(
»ad_³rûÁ
),

190 
	$d©aLim™
(
d©a_lim™
)

193 
	`’‹r
();

195 
Pack‘PŒ
 
	`g‘NextPack‘
();

197 
Tick
 
	$ÃxtPack‘Tick
(
boŞ
 
–a¡ic
, 
Tick
 
d–ay
) const;

199 
´iv©e
:

202 cÚ¡ 
Addr
 
¡¬tAddr
;

205 cÚ¡ 
Addr
 
’dAddr
;

208 cÚ¡ 
Addr
 
blocksize
;

211 cÚ¡ 
Tick
 
mšP”iod
;

212 cÚ¡ 
Tick
 
maxP”iod
;

217 cÚ¡ 
ušt8_t
 
»adP”ûÁ
;

220 cÚ¡ 
Addr
 
d©aLim™
;

223 
Addr
 
ÃxtAddr
;

230 
Addr
 
d©aMªuÏ‹d
;

231 
	}
};

238 şas 
	cRªdomG’
 : 
public
 
Ba£G’


241 
public
:

259 
RªdomG’
(cÚ¡ 
¡d
::
¡ršg
& 
_Çme
, 
Ma¡”ID
 
ma¡”_id
, 
Tick
 
_du¿tiÚ
,

260 
Addr
 
¡¬t_addr
, Add¸
’d_addr
, Add¸
_blocksize
,

261 
Tick
 
mš_³riod
, Tick 
max_³riod
,

262 
ušt8_t
 
»ad_³rûÁ
, 
Addr
 
d©a_lim™
)

263 : 
Ba£G’
(
_Çme
, 
ma¡”_id
, 
_du¿tiÚ
),

264 
¡¬tAddr
(
¡¬t_addr
), 
’dAddr
(
’d_addr
),

265 
blocksize
(
_blocksize
), 
mšP”iod
(
mš_³riod
),

266 
maxP”iod
(
max_³riod
), 
»adP”ûÁ
(
»ad_³rûÁ
),

267 
	$d©aLim™
(
d©a_lim™
)

270 
	`’‹r
();

272 
Pack‘PŒ
 
	`g‘NextPack‘
();

274 
Tick
 
	$ÃxtPack‘Tick
(
boŞ
 
–a¡ic
, 
Tick
 
d–ay
) const;

276 
´iv©e
:

279 cÚ¡ 
Addr
 
¡¬tAddr
;

282 cÚ¡ 
Addr
 
’dAddr
;

285 cÚ¡ 
Addr
 
blocksize
;

288 cÚ¡ 
Tick
 
mšP”iod
;

289 cÚ¡ 
Tick
 
maxP”iod
;

294 cÚ¡ 
ušt8_t
 
»adP”ûÁ
;

297 cÚ¡ 
Addr
 
d©aLim™
;

304 
Addr
 
d©aMªuÏ‹d
;

305 
	}
};

312 şas 
	cT¿ûG’
 : 
public
 
Ba£G’


315 
´iv©e
:

320 
	sT¿ûEËm’t
 {

323 
MemCmd
 
cmd
;

326 
Addr
 
	maddr
;

329 
Addr
 
	mblocksize
;

332 
Tick
 
	mtick
;

335 
	mReque¡
::
FÏgsTy³
 
æags
;

342 
boŞ
 
isV®id
() const {

343  
	mcmd
 !ğ
MemCmd
::
Inv®idCmd
;

349 
ş—r
() {

350 
	mcmd
 = 
MemCmd
::
Inv®idCmd
;

359 şas 
	cIÅutSŒ—m


362 
	g´iv©e
:

365 
PrÙoIÅutSŒ—m
 
Œaû
;

367 
	gpublic
:

374 
IÅutSŒ—m
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
);

380 
»£t
();

386 
š™
();

396 
boŞ
 
»ad
(
T¿ûEËm’t
& 
–em’t
);

399 
	gpublic
:

410 
T¿ûG’
(cÚ¡ 
¡d
::
¡ršg
& 
_Çme
, 
Ma¡”ID
 
ma¡”_id
, 
Tick
 
_du¿tiÚ
,

411 cÚ¡ 
¡d
::
¡ršg
& 
Œaû_fe
, 
Addr
 
addr_off£t
)

412 : 
Ba£G’
(
_Çme
, 
ma¡”_id
, 
_du¿tiÚ
),

413 
Œaû
(
Œaû_fe
),

414 
tickOff£t
(0),

415 
addrOff£t
(
addr_off£t
),

416 
	$ŒaûCom¶‘e
(
çl£
)

418 
	}
}

420 
’‹r
();

422 
Pack‘PŒ
 
g‘NextPack‘
();

424 
ex™
();

431 
Tick
 
	$ÃxtPack‘Tick
(
boŞ
 
–a¡ic
, 
Tick
 
d–ay
) const;

433 
´iv©e
:

436 
IÅutSŒ—m
 
Œaû
;

439 
T¿ûEËm’t
 
cu¼EËm’t
;

440 
T¿ûEËm’t
 
ÃxtEËm’t
;

447 
mubË
 
Tick
 
tickOff£t
;

453 
Addr
 
addrOff£t
;

459 
boŞ
 
ŒaûCom¶‘e
;

460 
	}
};

	@testers/traffic_gen/traffic_gen.cc

42 
	~<s¡»am
>

44 
	~"ba£/¿ndom.hh
"

45 
	~"ıu/‹¡”s/Œaffic_g’/Œaffic_g’.hh
"

46 
	~"debug/Checkpošt.hh
"

47 
	~"debug/T¿fficG’.hh
"

48 
	~"sim/¡©s.hh
"

49 
	~"sim/sy¡em.hh
"

51 
usšg
 
Çme¥aû
 
	g¡d
;

53 
	gT¿fficG’
::
	$T¿fficG’
(cÚ¡ 
T¿fficG’P¬ams
* 
p
)

54 : 
	`MemObjeù
(
p
),

55 
	`sy¡em
(
p
->
sy¡em
),

56 
	`ma¡”ID
(
sy¡em
->
	`g‘Ma¡”Id
(
	`Çme
())),

57 
	`cÚfigFe
(
p
->
cÚfig_fe
),

58 
	`–a¡icReq
(
p
->
–a¡ic_»q
),

59 
	`ÃxtT¿ns™iÚTick
(0),

60 
	`ÃxtPack‘Tick
(0),

61 
	`pÜt
(
	`Çme
(è+ ".pÜt", *
this
),

62 
	`»ŒyPkt
(
NULL
),

63 
	`»ŒyPktTick
(0),

64 
	`upd©eEv’t
(
this
),

65 
	$d¿šMªag”
(
NULL
)

67 
	}
}

69 
T¿fficG’
*

70 
	gT¿fficG’P¬ams
::
	$ü—‹
()

72  
Ãw
 
	`T¿fficG’
(
this
);

73 
	}
}

75 
	gBa£Ma¡”PÜt
&

76 
	gT¿fficG’
::
	$g‘Ma¡”PÜt
(cÚ¡ 
¡ršg
& 
if_Çme
, 
PÜtID
 
idx
)

78 ià(
if_Çme
 == "port") {

79  
pÜt
;

81  
MemObjeù
::
	`g‘Ma¡”PÜt
(
if_Çme
, 
idx
);

83 
	}
}

86 
	gT¿fficG’
::
	$š™
()

88 ià(!
pÜt
.
	`isCÚÃùed
())

89 
	`çl
("ThpÜˆoà% i nÙ cÚÃùed!\n", 
	`Çme
());

92 ià(
sy¡em
->
	`isTimšgMode
()) {

93 
	`DPRINTF
(
T¿fficG’
, "Timing mode,‡ctivating„equest generator\n");

95 
	`·r£CÚfig
();

98 
	`’‹rS‹
(
cu¼S‹
);

100 
	`DPRINTF
(
T¿fficG’
,

103 
	}
}

106 
	gT¿fficG’
::
	$š™S‹
()

109 ià(
sy¡em
->
	`isTimšgMode
()) {

111 
ÃxtPack‘Tick
 = 
¡©es
[
cu¼S‹
]->
	`ÃxtPack‘Tick
(
–a¡icReq
, 0);

112 
	`scheduË
(
upd©eEv’t
, 
¡d
::
	`mš
(
ÃxtPack‘Tick
, 
ÃxtT¿ns™iÚTick
));

114 
	`DPRINTF
(
T¿fficG’
,

117 
	}
}

120 
	gT¿fficG’
::
	$d¿š
(
D¿šMªag”
 *
dm
)

122 ià(
»ŒyPkt
 =ğ
NULL
) {

124 
ÃxtPack‘Tick
 = 
MaxTick
;

125 
ÃxtT¿ns™iÚTick
 = 
MaxTick
;

126 
	`descheduË
(
upd©eEv’t
);

129 
d¿šMªag”
 = 
dm
;

132 
	}
}

135 
	gT¿fficG’
::
	$£rŸlize
(
o¡»am
 &
os
)

137 
	`DPRINTF
(
Checkpošt
, "Serializing TrafficGen\n");

140 
Tick
 
ÃxtEv’t
 = 
upd©eEv’t
.
	`scheduËd
(è? upd©eEv’t.
	`wh’
() : 0;

142 
	`DPRINTF
(
T¿fficG’
, "Savšg‚extEv’t=%Îu\n", 
ÃxtEv’t
);

144 
	`SERIALIZE_SCALAR
(
ÃxtEv’t
);

146 
	`SERIALIZE_SCALAR
(
ÃxtT¿ns™iÚTick
);

148 
	`SERIALIZE_SCALAR
(
ÃxtPack‘Tick
);

150 
	`SERIALIZE_SCALAR
(
cu¼S‹
);

151 
	}
}

154 
	gT¿fficG’
::
	$un£rŸlize
(
Checkpošt
* 
ı
, cÚ¡ 
¡ršg
& 
£ùiÚ
)

157 
Tick
 
ÃxtEv’t
;

158 
	`UNSERIALIZE_SCALAR
(
ÃxtEv’t
);

159 ià(
ÃxtEv’t
 != 0) {

160 
	`scheduË
(
upd©eEv’t
, 
ÃxtEv’t
);

163 
	`UNSERIALIZE_SCALAR
(
ÃxtT¿ns™iÚTick
);

165 
	`UNSERIALIZE_SCALAR
(
ÃxtPack‘Tick
);

170 
	`UNSERIALIZE_SCALAR
(
cu¼S‹
);

171 
	}
}

174 
	gT¿fficG’
::
	$upd©e
()

178 ià(
	`curTick
(è>ğ
ÃxtT¿ns™iÚTick
) {

179 
	`Œªs™iÚ
();

181 
	`as£¹
(
	`curTick
(è>ğ
ÃxtPack‘Tick
);

183 
Pack‘PŒ
 
pkt
 = 
¡©es
[
cu¼S‹
]->
	`g‘NextPack‘
();

184 
numPack‘s
++;

185 ià(!
pÜt
.
	`£ndTimšgReq
(
pkt
)) {

186 
»ŒyPkt
 = 
pkt
;

187 
»ŒyPktTick
 = 
	`curTick
();

194 ià(
»ŒyPkt
 =ğ
NULL
) {

197 
ÃxtPack‘Tick
 = 
¡©es
[
cu¼S‹
]->
	`ÃxtPack‘Tick
(
–a¡icReq
, 0);

198 
Tick
 
ÃxtEv’tTick
 = 
¡d
::
	`mš
(
ÃxtPack‘Tick
, 
ÃxtT¿ns™iÚTick
);

199 
	`DPRINTF
(
T¿fficG’
, "Nexˆev’ˆscheduËd‡ˆ%Îd\n", 
ÃxtEv’tTick
);

200 
	`scheduË
(
upd©eEv’t
, 
ÃxtEv’tTick
);

202 
	}
}

205 
	gT¿fficG’
::
	$·r£CÚfig
()

209 
veùÜ
<
T¿ns™iÚ
> 
Œªs™iÚs
;

212 
if¡»am
 
šfe
;

213 
šfe
.
	`İ’
(
cÚfigFe
.
	`c_¡r
(), 
if¡»am
::
š
);

214 ià(!
šfe
.
	`is_İ’
()) {

215 
	`çl
("Traffic generator %s config file‚ot found‡t %s\n",

216 
	`Çme
(), 
cÚfigFe
);

221 
¡ršg
 
keywÜd
;

222 
¡ršg
 
lše
;

224 
	`g‘lše
(
šfe
, 
lše
).
	`good
()) {

226 ià(
lše
.
	`fšd
('#') != 1) {

228 
i¡ršg¡»am
 
	`is
(
lše
);

231 
is
 >> 
keywÜd
;

233 ià(
keywÜd
 == "STATE") {

235 
ušt32_t
 
id
;

236 
Tick
 
du¿tiÚ
;

237 
¡ršg
 
mode
;

239 
is
 >> 
id
 >> 
du¿tiÚ
 >> 
mode
;

241 ià(
mode
 == "TRACE") {

242 
¡ršg
 
ŒaûFe
;

243 
Addr
 
addrOff£t
;

245 
is
 >> 
ŒaûFe
 >> 
addrOff£t
;

247 
¡©es
[
id
] = 
Ãw
 
	`T¿ûG’
(
	`Çme
(), 
ma¡”ID
, 
du¿tiÚ
,

248 
ŒaûFe
, 
addrOff£t
);

249 
	`DPRINTF
(
T¿fficG’
, "S‹: %d T¿ûG’\n", 
id
);

250 } ià(
mode
 == "IDLE") {

251 
¡©es
[
id
] = 
Ãw
 
	`IdËG’
(
	`Çme
(), 
ma¡”ID
, 
du¿tiÚ
);

252 
	`DPRINTF
(
T¿fficG’
, "S‹: %d IdËG’\n", 
id
);

253 } ià(
mode
 == "LINEAR" || mode == "RANDOM") {

254 
ušt32_t
 
»ad_³rûÁ
;

255 
Addr
 
¡¬t_addr
;

256 
Addr
 
’d_addr
;

257 
Addr
 
blocksize
;

258 
Tick
 
mš_³riod
;

259 
Tick
 
max_³riod
;

260 
Addr
 
d©a_lim™
;

262 
is
 >> 
»ad_³rûÁ
 >> 
¡¬t_addr
 >> 
’d_addr
 >>

263 
blocksize
 >> 
mš_³riod
 >> 
max_³riod
 >> 
d©a_lim™
;

265 
	`DPRINTF
(
T¿fficG’
, "%s,‡ddr %xo %x, size %d,"

267 
mode
, 
¡¬t_addr
, 
’d_addr
, 
blocksize
, 
mš_³riod
,

268 
max_³riod
, 
»ad_³rûÁ
);

271 ià(
blocksize
 > 
sy¡em
->
	`ÿcheLšeSize
())

272 
	`çl
("TrafficGen %s block size (%d) is†argerhan "

273 "sy¡em block siz(%d)\n", 
	`Çme
(),

274 
blocksize
, 
sy¡em
->
	`ÿcheLšeSize
());

276 ià(
»ad_³rûÁ
 > 100)

277 
	`çl
("% ÿÂÙ havmÜthª 100%„—ds", 
	`Çme
());

279 ià(
mš_³riod
 > 
max_³riod
)

280 
	`çl
("% ÿÂÙ havmš_³riod > max_³riod", 
	`Çme
());

282 ià(
mode
 == "LINEAR") {

283 
¡©es
[
id
] = 
Ãw
 
	`Lš—rG’
(
	`Çme
(), 
ma¡”ID
,

284 
du¿tiÚ
, 
¡¬t_addr
,

285 
’d_addr
, 
blocksize
,

286 
mš_³riod
, 
max_³riod
,

287 
»ad_³rûÁ
, 
d©a_lim™
);

288 
	`DPRINTF
(
T¿fficG’
, "S‹: %d Lš—rG’\n", 
id
);

289 } ià(
mode
 == "RANDOM") {

290 
¡©es
[
id
] = 
Ãw
 
	`RªdomG’
(
	`Çme
(), 
ma¡”ID
,

291 
du¿tiÚ
, 
¡¬t_addr
,

292 
’d_addr
, 
blocksize
,

293 
mš_³riod
, 
max_³riod
,

294 
»ad_³rûÁ
, 
d©a_lim™
);

295 
	`DPRINTF
(
T¿fficG’
, "S‹: %d RªdomG’\n", 
id
);

298 
	`çl
("%s: Unknownraffic generator mode: %s",

299 
	`Çme
(), 
mode
);

301 } ià(
keywÜd
 == "TRANSITION") {

302 
T¿ns™iÚ
 
Œªs™iÚ
;

304 
is
 >> 
Œªs™iÚ
.
äom
 >>¿ns™iÚ.
to
 >>¿ns™iÚ.
p
;

306 
Œªs™iÚs
.
	`push_back
(
Œªs™iÚ
);

308 
	`DPRINTF
(
T¿fficG’
, "T¿ns™iÚ: %d -> %d\n", 
Œªs™iÚ
.
äom
,

309 
Œªs™iÚ
.
to
);

310 } ià(
keywÜd
 == "INIT") {

312 
is
 >> 
cu¼S‹
;

314 
	`DPRINTF
(
T¿fficG’
, "In™ŸÈ¡©e: %d\n", 
cu¼S‹
);

320 
Œªs™iÚM©rix
.
	`»size
(
¡©es
.
	`size
());

321 
size_t
 
i
 = 0; i < 
¡©es
.
	`size
(); i++) {

322 
Œªs™iÚM©rix
[
i
].
	`»size
(
¡©es
.
	`size
());

325 
veùÜ
<
T¿ns™iÚ
>::
™”©Ü
 
t
 = 
Œªs™iÚs
.
	`begš
();

326 
t
 !ğ
Œªs™iÚs
.
	`’d
(); ++t) {

327 
Œªs™iÚM©rix
[
t
->
äom
][t->
to
] =->
p
;

332 
size_t
 
i
 = 0; i < 
¡©es
.
	`size
(); i++) {

333 
sum
 = 0;

334 
size_t
 
j
 = 0; j < 
¡©es
.
	`size
(); j++) {

335 
sum
 +ğ
Œªs™iÚM©rix
[
i
][
j
];

339 ià(
	`abs
(
sum
 - 1.0) > 0.001)

340 
	`çl
("%s hasransition…robability != 1 for state %d\n",

341 
	`Çme
(), 
i
);

345 
šfe
.
	`şo£
();

346 
	}
}

349 
	gT¿fficG’
::
	$Œªs™iÚ
()

352 
¡©es
[
cu¼S‹
]->
	`ex™
();

355 
p
 = 
¿ndom_mt
.
	`g’_»®1
();

356 
	`as£¹
(
cu¼S‹
 < 
Œªs™iÚM©rix
.
	`size
());

357 
cumuÏtive
 = 0.0;

358 
size_t
 
i
 = 0;

360 
cumuÏtive
 +ğ
Œªs™iÚM©rix
[
cu¼S‹
][
i
];

361 ++
i
;

362 } 
cumuÏtive
 < 
p
 && 
i
 < 
Œªs™iÚM©rix
[
cu¼S‹
].
	`size
());

364 
	`’‹rS‹
(
i
 - 1);

365 
	}
}

368 
	gT¿fficG’
::
	$’‹rS‹
(
ušt32_t
 
ÃwS‹
)

370 
	`DPRINTF
(
T¿fficG’
, "T¿ns™iÚØ¡©%d\n", 
ÃwS‹
);

372 
cu¼S‹
 = 
ÃwS‹
;

376 
ÃxtT¿ns™iÚTick
 = 
	`curTick
(è+ 
¡©es
[
cu¼S‹
]->
du¿tiÚ
;

377 
¡©es
[
cu¼S‹
]->
	`’‹r
();

378 
	}
}

381 
	gT¿fficG’
::
	$»cvR‘ry
()

383 
	`as£¹
(
»ŒyPkt
 !ğ
NULL
);

385 
	`DPRINTF
(
T¿fficG’
, "Received„etry\n");

386 
numR‘r›s
++;

389 ià(
pÜt
.
	`£ndTimšgReq
(
»ŒyPkt
)) {

390 
»ŒyPkt
 = 
NULL
;

394 
Tick
 
d–ay
 = 
	`curTick
(è- 
»ŒyPktTick
;

395 
»ŒyPktTick
 = 0;

396 
»ŒyTicks
 +ğ
d–ay
;

398 ià(
d¿šMªag”
 =ğ
NULL
) {

400 
ÃxtPack‘Tick
 = 
¡©es
[
cu¼S‹
]->
	`ÃxtPack‘Tick
(
–a¡icReq
,

401 
d–ay
);

402 
Tick
 
ÃxtEv’tTick
 = 
¡d
::
	`mš
(
ÃxtPack‘Tick
, 
ÃxtT¿ns™iÚTick
);

403 
	`scheduË
(
upd©eEv’t
, 
¡d
::
	`max
(
	`curTick
(), 
ÃxtEv’tTick
));

406 
ÃxtPack‘Tick
 = 
MaxTick
;

407 
ÃxtT¿ns™iÚTick
 = 
MaxTick
;

408 
d¿šMªag”
->
	`sigÇlD¿šDÚe
();

410 
d¿šMªag”
 = 
NULL
;

413 
	}
}

416 
	gT¿fficG’
::
	$»gSts
()

419 
usšg
 
Çme¥aû
 
Sts
;

421 
numPack‘s


422 .
	`Çme
(name() + ".numPackets")

423 .
	`desc
("Number of…ackets generated");

425 
numR‘r›s


426 .
	`Çme
(name() + ".numRetries")

427 .
	`desc
("Number of„etries");

429 
»ŒyTicks


430 .
	`Çme
(name() + ".retryTicks")

431 .
	`desc
("Time spent waiting dueo back-pressure (ticks)");

432 
	}
}

434 
boŞ


435 
	gT¿fficG’
::
T¿fficG’PÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

437 
d–‘e
 
pkt
->
»q
;

438 
d–‘e
 
pkt
;

440  
Œue
;

441 
	}
}

	@testers/traffic_gen/traffic_gen.hh

41 #iâdeà
__CPU_TRAFFIC_GEN_TRAFFIC_GEN_HH__


42 
	#__CPU_TRAFFIC_GEN_TRAFFIC_GEN_HH__


	)

44 
	~"ba£/hashm­.hh
"

45 
	~"ba£/¡©i¡ics.hh
"

46 
	~"ıu/‹¡”s/Œaffic_g’/g’”©Üs.hh
"

47 
	~"mem/mem_objeù.hh
"

48 
	~"mem/qpÜt.hh
"

49 
	~"·¿ms/T¿fficG’.hh
"

60 şas 
	cT¿fficG’
 : 
public
 
MemObjeù


63 
´iv©e
:

68 
Œªs™iÚ
();

75 
’‹rS‹
(
ušt32_t
 
ÃwS‹
);

81 
·r£CÚfig
();

88 
upd©e
();

94 
»cvR‘ry
();

97 
	sT¿ns™iÚ
 {

98 
ušt32_t
 
	mäom
;

99 
ušt32_t
 
	mto
;

100 
	mp
;

107 
Sy¡em
* 
	gsy¡em
;

112 
Ma¡”ID
 
	gma¡”ID
;

117 cÚ¡ 
	g¡d
::
¡ršg
 
cÚfigFe
;

123 cÚ¡ 
boŞ
 
	g–a¡icReq
;

126 
Tick
 
	gÃxtT¿ns™iÚTick
;

129 
Tick
 
	gÃxtPack‘Tick
;

132 
	g¡d
::
veùÜ
<
¡d
::veùÜ<> > 
Œªs™iÚM©rix
;

135 
ušt32_t
 
	gcu¼S‹
;

138 
	gm5
::
hash_m­
<
ušt32_t
, 
	gBa£G’
*> 
	g¡©es
;

141 şas 
	cT¿fficG’PÜt
 : 
public
 
Ma¡”PÜt


143 
public
:

145 
T¿fficG’PÜt
(cÚ¡ 
¡d
::
¡ršg
& 
Çme
, 
T¿fficG’
& 
Œaffic_g’
)

146 : 
Ma¡”PÜt
(
Çme
, &
Œaffic_g’
), 
ŒafficG’
(traffic_gen)

149 
	g´Ùeùed
:

151 
»cvR‘ry
(è{ 
ŒafficG’
.recvRetry(); }

153 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

155 
	g´iv©e
:

157 
T¿fficG’
& 
ŒafficG’
;

162 
T¿fficG’PÜt
 
	gpÜt
;

165 
Pack‘PŒ
 
	g»ŒyPkt
;

168 
Tick
 
	g»ŒyPktTick
;

171 
	gEv’tW¿µ”
<
	gT¿fficG’
, &T¿fficG’::
upd©e
> 
upd©eEv’t
;

174 
D¿šMªag”
* 
	gd¿šMªag”
;

177 
	gSts
::
SÿÏr
 
numPack‘s
;

180 
	gSts
::
SÿÏr
 
numR‘r›s
;

183 
	gSts
::
SÿÏr
 
»ŒyTicks
;

185 
	gpublic
:

187 
T¿fficG’
(cÚ¡ 
T¿fficG’P¬ams
* 
p
);

189 ~
	$T¿fficG’
(è{
	}
}

191 
vœtu®
 
	gBa£Ma¡”PÜt
& 
g‘Ma¡”PÜt
(cÚ¡ 
¡d
::
¡ršg
 &
if_Çme
,

192 
PÜtID
 
idx
 = 
Inv®idPÜtID
);

194 
š™
();

196 
š™S‹
();

198 
d¿š
(
D¿šMªag”
 *
dm
);

200 
£rŸlize
(
¡d
::
o¡»am
 &
os
);

202 
un£rŸlize
(
Checkpošt
* 
ı
, cÚ¡ 
¡d
::
¡ršg
& 
£ùiÚ
);

205 
»gSts
();

	@thread_context.cc

44 
	~"ba£/misc.hh
"

45 
	~"ba£/Œaû.hh
"

46 
	~"cÚfig/the_i§.hh
"

47 
	~"ıu/ba£.hh
"

48 
	~"ıu/qu›sû_ev’t.hh
"

49 
	~"ıu/th»ad_cÚ‹xt.hh
"

50 
	~"debug/CÚ‹xt.hh
"

51 
	~"sim/fuÎ_sy¡em.hh
"

54 
	gTh»adCÚ‹xt
::
	$com·»
(
Th»adCÚ‹xt
 *
Úe
, Th»adCÚ‹xˆ*
two
)

56 
	`DPRINTF
(
CÚ‹xt
, "Comparinghread contexts\n");

59 
i
 = 0; i < 
TheISA
::
NumIÁRegs
; ++i) {

60 
TheISA
::
IÁReg
 
t1
 = 
Úe
->
	`»adIÁReg
(
i
);

61 
TheISA
::
IÁReg
 
t2
 = 
two
->
	`»adIÁReg
(
i
);

62 ià(
t1
 !ğ
t2
)

63 
	`·nic
("Int„eg idx %d doesn't match, one: %#x,wo: %#x",

64 
i
, 
t1
, 
t2
);

68 
i
 = 0; i < 
TheISA
::
NumFlßtRegs
; ++i) {

69 
TheISA
::
FlßtRegB™s
 
t1
 = 
Úe
->
	`»adFlßtRegB™s
(
i
);

70 
TheISA
::
FlßtRegB™s
 
t2
 = 
two
->
	`»adFlßtRegB™s
(
i
);

71 ià(
t1
 !ğ
t2
)

72 
	`·nic
("Float„eg idx %d doesn't match, one: %#x,wo: %#x",

73 
i
, 
t1
, 
t2
);

75 
i
 = 0; i < 
TheISA
::
NumMiscRegs
; ++i) {

76 
TheISA
::
MiscReg
 
t1
 = 
Úe
->
	`»adMiscRegNoEfãù
(
i
);

77 
TheISA
::
MiscReg
 
t2
 = 
two
->
	`»adMiscRegNoEfãù
(
i
);

78 ià(
t1
 !ğ
t2
)

79 
	`·nic
("Misc„eg idx %d doesn't match, one: %#x,wo: %#x",

80 
i
, 
t1
, 
t2
);

84 
i
 = 0; i < 
TheISA
::
NumCCRegs
; ++i) {

85 
TheISA
::
CCReg
 
t1
 = 
Úe
->
	`»adCCReg
(
i
);

86 
TheISA
::
CCReg
 
t2
 = 
two
->
	`»adCCReg
(
i
);

87 ià(
t1
 !ğ
t2
)

88 
	`·nic
("CC„eg idx %d doesn't match, one: %#x,wo: %#x",

89 
i
, 
t1
, 
t2
);

91 ià(!(
Úe
->
	`pcS‹
(è=ğ
two
->pcState()))

92 
	`·nic
("PC state doesn't match.");

93 
id1
 = 
Úe
->
	`ıuId
();

94 
id2
 = 
two
->
	`ıuId
();

95 ià(
id1
 !ğ
id2
)

96 
	`·nic
("CPU id dÚ'ˆm©ch, oÃ: %d,wo: %d", 
id1
, 
id2
);

98 
id1
 = 
Úe
->
	`cÚ‹xtId
();

99 
id2
 = 
two
->
	`cÚ‹xtId
();

100 ià(
id1
 !ğ
id2
)

101 
	`·nic
("CÚ‹xˆid dÚ'ˆm©ch, oÃ: %d,wo: %d", 
id1
, 
id2
);

104 
	}
}

107 
£rŸlize
(
Th»adCÚ‹xt
 &
tc
, 
¡d
::
o¡»am
 &
os
)

109 
usšg
 
Çme¥aû
 
TheISA
;

111 
FlßtRegB™s
 
	gæßtRegs
[
NumFlßtRegs
];

112 
	gi
 = 0; i < 
	gNumFlßtRegs
; ++i)

113 
	gæßtRegs
[
i
] = 
tc
.
»adFlßtRegB™sFÏt
(i);

116 
¬¿yP¬amOut
(
os
, "æßtRegs.i", 
æßtRegs
, 
NumFlßtRegs
);

118 
IÁReg
 
	gštRegs
[
NumIÁRegs
];

119 
	gi
 = 0; i < 
	gNumIÁRegs
; ++i)

120 
	gštRegs
[
i
] = 
tc
.
»adIÁRegFÏt
(i);

121 
SERIALIZE_ARRAY
(
štRegs
, 
NumIÁRegs
);

123 #ifdeà
ISA_HAS_CC_REGS


124 
CCReg
 
	gccRegs
[
NumCCRegs
];

125 
	gi
 = 0; i < 
	gNumCCRegs
; ++i)

126 
	gccRegs
[
i
] = 
tc
.
»adCCRegFÏt
(i);

127 
SERIALIZE_ARRAY
(
ccRegs
, 
NumCCRegs
);

130 
	gtc
.
pcS‹
().
£rŸlize
(
os
);

136 
un£rŸlize
(
Th»adCÚ‹xt
 &
tc
, 
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
)

138 
usšg
 
Çme¥aû
 
TheISA
;

140 
FlßtRegB™s
 
	gæßtRegs
[
NumFlßtRegs
];

143 
¬¿yP¬amIn
(
ı
, 
£ùiÚ
, "æßtRegs.i", 
æßtRegs
, 
NumFlßtRegs
);

144 
	gi
 = 0; i < 
	gNumFlßtRegs
; ++i)

145 
	gtc
.
£tFlßtRegB™sFÏt
(
i
, 
æßtRegs
[i]);

147 
IÁReg
 
	gštRegs
[
NumIÁRegs
];

148 
UNSERIALIZE_ARRAY
(
štRegs
, 
NumIÁRegs
);

149 
	gi
 = 0; i < 
	gNumIÁRegs
; ++i)

150 
	gtc
.
£tIÁRegFÏt
(
i
, 
štRegs
[i]);

152 #ifdeà
ISA_HAS_CC_REGS


153 
CCReg
 
	gccRegs
[
NumCCRegs
];

154 
UNSERIALIZE_ARRAY
(
ccRegs
, 
NumCCRegs
);

155 
	gi
 = 0; i < 
	gNumCCRegs
; ++i)

156 
	gtc
.
£tCCRegFÏt
(
i
, 
ccRegs
[i]);

159 
PCS‹
 
	gpcS‹
;

160 
	gpcS‹
.
un£rŸlize
(
ı
, 
£ùiÚ
);

161 
	gtc
.
pcS‹
(pcState);

167 
	$keOv”From
(
Th»adCÚ‹xt
 &
Ác
, Th»adCÚ‹xˆ&
Ùc
)

169 
	`as£¹
(
Ác
.
	`g‘ProûssPŒ
(è=ğ
Ùc
.getProcessPtr());

171 
Ác
.
	`£tStus
(
Ùc
.
	`¡©us
());

172 
Ác
.
	`cİyArchRegs
(&
Ùc
);

173 
Ác
.
	`£tCÚ‹xtId
(
Ùc
.
	`cÚ‹xtId
());

174 
Ác
.
	`£tTh»adId
(
Ùc
.
	`th»adId
());

176 ià(
FuÎSy¡em
) {

177 
	`as£¹
(
Ác
.
	`g‘Sy¡emPŒ
(è=ğ
Ùc
.getSystemPtr());

179 
Ba£CPU
 *
	`nıu
(
Ác
.
	`g‘CpuPŒ
());

180 
	`as£¹
(
nıu
);

181 
EndQu›sûEv’t
 *
	`oqe
(
Ùc
.
	`g‘Qu›sûEv’t
());

182 
	`as£¹
(
oqe
);

183 
	`as£¹
(
oqe
->
tc
 =ğ&
Ùc
);

185 
Ba£CPU
 *
	`oıu
(
Ùc
.
	`g‘CpuPŒ
());

186 
	`as£¹
(
oıu
);

187 
EndQu›sûEv’t
 *
	`nqe
(
Ác
.
	`g‘Qu›sûEv’t
());

188 
	`as£¹
(
nqe
);

189 
	`as£¹
(
nqe
->
tc
 =ğ&
Ác
);

191 ià(
oqe
->
	`scheduËd
()) {

192 
nıu
->
	`scheduË
(
nqe
, 
oqe
->
	`wh’
());

193 
oıu
->
	`descheduË
(
oqe
);

197 
Ùc
.
	`£tStus
(
Th»adCÚ‹xt
::
H®‹d
);

198 
	}
}

	@thread_context.hh

44 #iâdeà
__CPU_THREAD_CONTEXT_HH__


45 
	#__CPU_THREAD_CONTEXT_HH__


	)

47 
	~<io¡»am
>

48 
	~<¡ršg
>

50 
	~"¬ch/»gi¡”s.hh
"

51 
	~"¬ch/ty³s.hh
"

52 
	~"ba£/ty³s.hh
"

53 
	~"cÚfig/the_i§.hh
"

57 
Çme¥aû
 
	gTheISA


59 
şass
 
	gDecod”
;

60 
şass
 
	gTLB
;

62 
şass
 
	gBa£CPU
;

63 
şass
 
	gCheck”CPU
;

64 
şass
 
	gCheckpošt
;

65 
şass
 
	gEndQu›sûEv’t
;

66 
şass
 
	gSET¿n¦©šgPÜtProxy
;

67 
şass
 
	gFST¿n¦©šgPÜtProxy
;

68 
şass
 
	gPÜtProxy
;

69 
şass
 
	gProûss
;

70 
şass
 
	gSy¡em
;

71 
Çme¥aû
 
	gTheISA
 {

72 
Çme¥aû
 
	gK”Ãl
 {

73 
şass
 
	gSti¡ics
;

93 şas 
	cTh»adCÚ‹xt


95 
	m´Ùeùed
:

96 
TheISA
::
	tMachIn¡
 MachInst;

97 
	mTheISA
::
	tIÁReg
 IntReg;

98 
	mTheISA
::
	tFlßtReg
 FloatReg;

99 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

100 
	mTheISA
::
	tCCReg
 CCReg;

101 
	mTheISA
::
	tMiscReg
 MiscReg;

102 
	mpublic
:

104 
	eStus


108 
Aùive
,

112 
	mSu¥’ded
,

117 
	mH®‹d


120 
	gvœtu®
 ~
	$Th»adCÚ‹xt
(è{ 
	}
};

122 
vœtu®
 
Ba£CPU
 *
g‘CpuPŒ
() = 0;

124 
vœtu®
 
ıuId
() = 0;

126 
vœtu®
 
th»adId
() = 0;

128 
vœtu®
 
£tTh»adId
(
id
) = 0;

130 
vœtu®
 
cÚ‹xtId
() = 0;

132 
vœtu®
 
£tCÚ‹xtId
(
id
) = 0;

134 
vœtu®
 
	gTheISA
::
TLB
 *
g‘ITBPŒ
() = 0;

136 
vœtu®
 
	gTheISA
::
TLB
 *
g‘DTBPŒ
() = 0;

138 
vœtu®
 
Check”CPU
 *
g‘Check”CpuPŒ
() = 0;

140 
vœtu®
 
	gTheISA
::
Decod”
 *
g‘Decod”PŒ
() = 0;

142 
vœtu®
 
Sy¡em
 *
g‘Sy¡emPŒ
() = 0;

144 
vœtu®
 
	gTheISA
::
K”Ãl
::
Sti¡ics
 *
g‘K”ÃlSts
() = 0;

146 
vœtu®
 
	gPÜtProxy
 &
g‘PhysProxy
() = 0;

148 
vœtu®
 
	gFST¿n¦©šgPÜtProxy
 &
g‘VœtProxy
() = 0;

156 
vœtu®
 
š™MemProx›s
(
Th»adCÚ‹xt
 *
tc
) = 0;

158 
vœtu®
 
	gSET¿n¦©šgPÜtProxy
 &
g‘MemProxy
() = 0;

160 
vœtu®
 
Proûss
 *
g‘ProûssPŒ
() = 0;

162 
vœtu®
 
Stus
 
	$¡©us
() const = 0;

164 
vœtu®
 
	`£tStus
(
Stus
 
Ãw_¡©us
) = 0;

168 
vœtu®
 
	`aùiv©e
(
Cyşes
 
d–ay
 = 
	`Cyşes
(1)) = 0;

171 
vœtu®
 
	`su¥’d
(
Cyşes
 
d–ay
 = 
	`Cyşes
(0)) = 0;

174 
vœtu®
 
	`h®t
(
Cyşes
 
d–ay
 = 
	`Cyşes
(0)) = 0;

176 
vœtu®
 
	`dumpFuncProfe
() = 0;

178 
vœtu®
 
	`keOv”From
(
Th»adCÚ‹xt
 *
Şd_cÚ‹xt
) = 0;

180 
vœtu®
 
	`»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
) = 0;

182 
vœtu®
 
EndQu›sûEv’t
 *
	`g‘Qu›sûEv’t
() = 0;

186 
vœtu®
 
Tick
 
	`»adLa¡Aùiv©e
() = 0;

187 
vœtu®
 
Tick
 
	`»adLa¡Su¥’d
() = 0;

189 
vœtu®
 
	`´ofeCË¬
() = 0;

190 
vœtu®
 
	`´ofeSam¶e
() = 0;

192 
vœtu®
 
	`cİyArchRegs
(
Th»adCÚ‹xt
 *
tc
) = 0;

194 
vœtu®
 
	`ş—rArchRegs
() = 0;

199 
vœtu®
 
ušt64_t
 
	`»adIÁReg
(
»g_idx
) = 0;

201 
vœtu®
 
FlßtReg
 
	`»adFlßtReg
(
»g_idx
) = 0;

203 
vœtu®
 
FlßtRegB™s
 
	`»adFlßtRegB™s
(
»g_idx
) = 0;

205 
vœtu®
 
CCReg
 
	`»adCCReg
(
»g_idx
) = 0;

207 
vœtu®
 
	`£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
) = 0;

209 
vœtu®
 
	`£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
) = 0;

211 
vœtu®
 
	`£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
) = 0;

213 
vœtu®
 
	`£tCCReg
(
»g_idx
, 
CCReg
 
v®
) = 0;

215 
vœtu®
 
TheISA
::
PCS‹
 
	`pcS‹
() = 0;

217 
vœtu®
 
	`pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
) = 0;

219 
vœtu®
 
	`pcS‹NoRecÜd
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
) = 0;

221 
vœtu®
 
Addr
 
	`š¡Addr
() = 0;

223 
vœtu®
 
Addr
 
	`ÃxtIn¡Addr
() = 0;

225 
vœtu®
 
MiüoPC
 
	`miüoPC
() = 0;

227 
vœtu®
 
MiscReg
 
	`»adMiscRegNoEfãù
(
misc_»g
) = 0;

229 
vœtu®
 
MiscReg
 
	`»adMiscReg
(
misc_»g
) = 0;

231 
vœtu®
 
	`£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
) = 0;

233 
vœtu®
 
	`£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
) = 0;

235 
vœtu®
 
	`æ©‹nIÁIndex
(
»g
) = 0;

236 
vœtu®
 
	`æ©‹nFlßtIndex
(
»g
) = 0;

237 
vœtu®
 
	`æ©‹nCCIndex
(
»g
) = 0;

239 
vœtu®
 
ušt64_t


240 
	$»adRegOth”Th»ad
(
misc_»g
, 
Th»adID
 
tid
)

243 
	}
}

245 
vœtu®
 

246 
	$£tRegOth”Th»ad
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
, 
Th»adID
 
tid
)

248 
	}
}

252 
vœtu®
 
»adStCÚdFau»s
() = 0;

254 
vœtu®
 
£tStCÚdFau»s
(
sc_çu»s
) = 0;

257 
vœtu®
 
boŞ
 
mis¥ecuÏtšg
() = 0;

260 
vœtu®
 
CouÁ”
 
»adFuncExeIn¡
() = 0;

262 
vœtu®
 
sysÿÎ
(
št64_t
 
ÿÎnum
) = 0;

267 
vœtu®
 
	$ex™
(è{  1; 
	}
};

270 
com·»
(
Th»adCÚ‹xt
 *
Úe
, Th»adCÚ‹xˆ*
two
);

284 
vœtu®
 
ušt64_t
 
»adIÁRegFÏt
(
idx
) = 0;

285 
vœtu®
 
£tIÁRegFÏt
(
idx
, 
ušt64_t
 
v®
) = 0;

287 
vœtu®
 
FlßtReg
 
»adFlßtRegFÏt
(
idx
) = 0;

288 
vœtu®
 
£tFlßtRegFÏt
(
idx
, 
FlßtReg
 
v®
) = 0;

290 
vœtu®
 
FlßtRegB™s
 
»adFlßtRegB™sFÏt
(
idx
) = 0;

291 
vœtu®
 
£tFlßtRegB™sFÏt
(
idx
, 
FlßtRegB™s
 
v®
) = 0;

293 
vœtu®
 
CCReg
 
»adCCRegFÏt
(
idx
) = 0;

294 
vœtu®
 
£tCCRegFÏt
(
idx
, 
CCReg
 
v®
) = 0;

309 
	g‹m¶©e
 <
şass
 
	gTC
>

310 şas 
	cProxyTh»adCÚ‹xt
 : 
public
 
Th»adCÚ‹xt


312 
public
:

313 
	$ProxyTh»adCÚ‹xt
(
TC
 *
aùu®_tc
)

314 { 
aùu®TC
 = 
aùu®_tc
; }

316 
´iv©e
:

317 
TC
 *
aùu®TC
;

319 
public
:

321 
Ba£CPU
 *
	$g‘CpuPŒ
(è{  
aùu®TC
->
	`g‘CpuPŒ
(); 
	}
}

323 
	$ıuId
(è{  
aùu®TC
->
	`ıuId
(); 
	}
}

325 
	$th»adId
(è{  
aùu®TC
->
	`th»adId
(); 
	}
}

327 
	$£tTh»adId
(
id
è{  
aùu®TC
->
	`£tTh»adId
(id); 
	}
}

329 
	$cÚ‹xtId
(è{  
aùu®TC
->
	`cÚ‹xtId
(); 
	}
}

331 
	$£tCÚ‹xtId
(
id
è{ 
aùu®TC
->
	`£tCÚ‹xtId
(id); 
	}
}

333 
	gTheISA
::
TLB
 *
	$g‘ITBPŒ
(è{  
aùu®TC
->
	`g‘ITBPŒ
(); 
	}
}

335 
	gTheISA
::
TLB
 *
	$g‘DTBPŒ
(è{  
aùu®TC
->
	`g‘DTBPŒ
(); 
	}
}

337 
Check”CPU
 *
	$g‘Check”CpuPŒ
(è{  
aùu®TC
->
	`g‘Check”CpuPŒ
(); 
	}
}

339 
	gTheISA
::
Decod”
 *
	$g‘Decod”PŒ
(è{  
aùu®TC
->
	`g‘Decod”PŒ
(); 
	}
}

341 
Sy¡em
 *
	$g‘Sy¡emPŒ
(è{  
aùu®TC
->
	`g‘Sy¡emPŒ
(); 
	}
}

343 
	gTheISA
::
K”Ãl
::
Sti¡ics
 *
	$g‘K”ÃlSts
()

344 {  
aùu®TC
->
	`g‘K”ÃlSts
(); 
	}
}

346 
	gPÜtProxy
 &
	$g‘PhysProxy
(è{  
aùu®TC
->
	`g‘PhysProxy
(); 
	}
}

348 
	gFST¿n¦©šgPÜtProxy
 &
	$g‘VœtProxy
(è{  
aùu®TC
->
	`g‘VœtProxy
(); 
	}
}

350 
	$š™MemProx›s
(
Th»adCÚ‹xt
 *
tc
è{ 
aùu®TC
->
	`š™MemProx›s
Ñc); 
	}
}

352 
	gSET¿n¦©šgPÜtProxy
 &
	$g‘MemProxy
(è{  
aùu®TC
->
	`g‘MemProxy
(); 
	}
}

354 
Proûss
 *
	$g‘ProûssPŒ
(è{  
aùu®TC
->
	`g‘ProûssPŒ
(); 
	}
}

356 
Stus
 
	$¡©us
(ècÚ¡ {  
aùu®TC
->
	`¡©us
(); 
	}
}

358 
	$£tStus
(
Stus
 
Ãw_¡©us
è{ 
aùu®TC
->
	`£tStus
Òew_¡©us); 
	}
}

362 
aùiv©e
(
Cyşes
 
d–ay
 = 
	$Cyşes
(1))

363 { 
aùu®TC
->
	`aùiv©e
(
d–ay
); 
	}
}

366 
su¥’d
(
Cyşes
 
d–ay
 = 
	$Cyşes
(0)è{ 
aùu®TC
->
	`su¥’d
(); 
	}
}

369 
h®t
(
Cyşes
 
d–ay
 = 
	$Cyşes
(0)è{ 
aùu®TC
->
	`h®t
(); 
	}
}

371 
	$dumpFuncProfe
(è{ 
aùu®TC
->
	`dumpFuncProfe
(); 
	}
}

373 
	$keOv”From
(
Th»adCÚ‹xt
 *
ŞdCÚ‹xt
)

374 { 
aùu®TC
->
	`keOv”From
(
ŞdCÚ‹xt
); 
	}
}

376 
»gSts
(cÚ¡ 
¡d
::
¡ršg
 &
Çme
è{ 
aùu®TC
->regStats(name); }

378 
EndQu›sûEv’t
 *
	$g‘Qu›sûEv’t
(è{  
aùu®TC
->
	`g‘Qu›sûEv’t
(); 
	}
}

380 
Tick
 
	$»adLa¡Aùiv©e
(è{  
aùu®TC
->
	`»adLa¡Aùiv©e
(); 
	}
}

381 
Tick
 
	$»adLa¡Su¥’d
(è{  
aùu®TC
->
	`»adLa¡Su¥’d
(); 
	}
}

383 
	$´ofeCË¬
(è{  
aùu®TC
->
	`´ofeCË¬
(); 
	}
}

384 
	$´ofeSam¶e
(è{  
aùu®TC
->
	`´ofeSam¶e
(); 
	}
}

387 
	$cİyArchRegs
(
Th»adCÚ‹xt
 *
tc
è{ 
aùu®TC
->
	`cİyArchRegs
Ñc); 
	}
}

389 
	$ş—rArchRegs
(è{ 
aùu®TC
->
	`ş—rArchRegs
(); 
	}
}

394 
ušt64_t
 
	$»adIÁReg
(
»g_idx
)

395 {  
aùu®TC
->
	`»adIÁReg
(
»g_idx
); 
	}
}

397 
FlßtReg
 
	$»adFlßtReg
(
»g_idx
)

398 {  
aùu®TC
->
	`»adFlßtReg
(
»g_idx
); 
	}
}

400 
FlßtRegB™s
 
	$»adFlßtRegB™s
(
»g_idx
)

401 {  
aùu®TC
->
	`»adFlßtRegB™s
(
»g_idx
); 
	}
}

403 
CCReg
 
	$»adCCReg
(
»g_idx
)

404 {  
aùu®TC
->
	`»adCCReg
(
»g_idx
); 
	}
}

406 
	$£tIÁReg
(
»g_idx
, 
ušt64_t
 
v®
)

407 { 
aùu®TC
->
	`£tIÁReg
(
»g_idx
, 
v®
); 
	}
}

409 
	$£tFlßtReg
(
»g_idx
, 
FlßtReg
 
v®
)

410 { 
aùu®TC
->
	`£tFlßtReg
(
»g_idx
, 
v®
); 
	}
}

412 
	$£tFlßtRegB™s
(
»g_idx
, 
FlßtRegB™s
 
v®
)

413 { 
aùu®TC
->
	`£tFlßtRegB™s
(
»g_idx
, 
v®
); 
	}
}

415 
	$£tCCReg
(
»g_idx
, 
CCReg
 
v®
)

416 { 
aùu®TC
->
	`£tCCReg
(
»g_idx
, 
v®
); 
	}
}

418 
	gTheISA
::
PCS‹
 
	$pcS‹
(è{  
aùu®TC
->
	`pcS‹
(); 
	}
}

420 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
è{ 
aùu®TC
->pcState(val); }

422 
pcS‹NoRecÜd
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
è{ 
aùu®TC
->
pcS‹
(val); }

424 
Addr
 
	$š¡Addr
(è{  
aùu®TC
->
	`š¡Addr
(); 
	}
}

425 
Addr
 
	$ÃxtIn¡Addr
(è{  
aùu®TC
->
	`ÃxtIn¡Addr
(); 
	}
}

426 
MiüoPC
 
	$miüoPC
(è{  
aùu®TC
->
	`miüoPC
(); 
	}
}

428 
boŞ
 
	$»adP»diÿ‹
(è{  
aùu®TC
->
	`»adP»diÿ‹
(); 
	}
}

430 
	$£tP»diÿ‹
(
boŞ
 
v®
)

431 { 
aùu®TC
->
	`£tP»diÿ‹
(
v®
); 
	}
}

433 
MiscReg
 
	$»adMiscRegNoEfãù
(
misc_»g
)

434 {  
aùu®TC
->
	`»adMiscRegNoEfãù
(
misc_»g
); 
	}
}

436 
MiscReg
 
	$»adMiscReg
(
misc_»g
)

437 {  
aùu®TC
->
	`»adMiscReg
(
misc_»g
); 
	}
}

439 
	$£tMiscRegNoEfãù
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

440 {  
aùu®TC
->
	`£tMiscRegNoEfãù
(
misc_»g
, 
v®
); 
	}
}

442 
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

443 {  
aùu®TC
->
	`£tMiscReg
(
misc_»g
, 
v®
); 
	}
}

445 
	$æ©‹nIÁIndex
(
»g
)

446 {  
aùu®TC
->
	`æ©‹nIÁIndex
(
»g
); 
	}
}

448 
	$æ©‹nFlßtIndex
(
»g
)

449 {  
aùu®TC
->
	`æ©‹nFlßtIndex
(
»g
); 
	}
}

451 
	$æ©‹nCCIndex
(
»g
)

452 {  
aùu®TC
->
	`æ©‹nCCIndex
(
»g
); 
	}
}

454 
	$»adStCÚdFau»s
()

455 {  
aùu®TC
->
	`»adStCÚdFau»s
(); 
	}
}

457 
	$£tStCÚdFau»s
(
sc_çu»s
)

458 { 
aùu®TC
->
	`£tStCÚdFau»s
(
sc_çu»s
); 
	}
}

461 
boŞ
 
	$mis¥ecuÏtšg
(è{  
aùu®TC
->
	`mis¥ecuÏtšg
(); 
	}
}

463 
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

464 { 
aùu®TC
->
	`sysÿÎ
(
ÿÎnum
); 
	}
}

466 
CouÁ”
 
	$»adFuncExeIn¡
(è{  
aùu®TC
->
	`»adFuncExeIn¡
(); 
	}
}

468 
ušt64_t
 
	$»adIÁRegFÏt
(
idx
)

469 {  
aùu®TC
->
	`»adIÁRegFÏt
(
idx
); 
	}
}

471 
	$£tIÁRegFÏt
(
idx
, 
ušt64_t
 
v®
)

472 { 
aùu®TC
->
	`£tIÁRegFÏt
(
idx
, 
v®
); 
	}
}

474 
FlßtReg
 
	$»adFlßtRegFÏt
(
idx
)

475 {  
aùu®TC
->
	`»adFlßtRegFÏt
(
idx
); 
	}
}

477 
	$£tFlßtRegFÏt
(
idx
, 
FlßtReg
 
v®
)

478 { 
aùu®TC
->
	`£tFlßtRegFÏt
(
idx
, 
v®
); 
	}
}

480 
FlßtRegB™s
 
	$»adFlßtRegB™sFÏt
(
idx
)

481 {  
aùu®TC
->
	`»adFlßtRegB™sFÏt
(
idx
); 
	}
}

483 
	$£tFlßtRegB™sFÏt
(
idx
, 
FlßtRegB™s
 
v®
)

484 { 
aùu®TC
->
	`£tFlßtRegB™sFÏt
(
idx
, 
v®
); 
	}
}

486 
CCReg
 
	$»adCCRegFÏt
(
idx
)

487 {  
aùu®TC
->
	`»adCCRegFÏt
(
idx
); 
	}
}

489 
	$£tCCRegFÏt
(
idx
, 
CCReg
 
v®
)

490 { 
aùu®TC
->
	`£tCCRegFÏt
(
idx
, 
v®
); 
	}
}

503 
£rŸlize
(
Th»adCÚ‹xt
 &
tc
, 
¡d
::
o¡»am
 &
os
);

504 
un£rŸlize
(
Th»adCÚ‹xt
 &
tc
, 
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
);

519 
keOv”From
(
Th»adCÚ‹xt
 &
Ãw_tc
, Th»adCÚ‹xˆ&
Şd_tc
);

	@thread_state.cc

31 
	~"¬ch/k”Ãl_¡©s.hh
"

32 
	~"ba£/ouut.hh
"

33 
	~"ıu/ba£.hh
"

34 
	~"ıu/´ofe.hh
"

35 
	~"ıu/qu›sû_ev’t.hh
"

36 
	~"ıu/th»ad_¡©e.hh
"

37 
	~"mem/fs_Œª¦©šg_pÜt_´oxy.hh
"

38 
	~"mem/pÜt.hh
"

39 
	~"mem/pÜt_´oxy.hh
"

40 
	~"mem/£_Œª¦©šg_pÜt_´oxy.hh
"

41 
	~"sim/fuÎ_sy¡em.hh
"

42 
	~"sim/£rŸlize.hh
"

43 
	~"sim/sy¡em.hh
"

45 
	gTh»adS‹
::
	$Th»adS‹
(
Ba£CPU
 *
ıu
, 
Th»adID
 
_tid
, 
Proûss
 *
_´oûss
)

46 : 
	`numIn¡
(0), 
	`numOp
(0), 
	`numLßd
(0), 
	`_¡©us
(
Th»adCÚ‹xt
::
H®‹d
),

47 
	`ba£Cpu
(
ıu
), 
	`_th»adId
(
_tid
), 
	`Ï¡Aùiv©e
(0), 
	`Ï¡Su¥’d
(0),

48 
	`´ofe
(
NULL
), 
	`´ofeNode
(NULL), 
	`´ofePC
(0), 
	`qu›sûEv’t
(NULL),

49 
	`k”ÃlSts
(
NULL
), 
	`´oûss
(
_´oûss
), 
	`physProxy
(NULL), 
	`vœtProxy
(NULL),

50 
	`´oxy
(
NULL
), 
	`funcExeIn¡
(0), 
	$¡ÜeCÚdFau»s
(0)

52 
	}
}

54 
	gTh»adS‹
::~
	$Th»adS‹
()

56 ià(
physProxy
 !ğ
NULL
)

57 
d–‘e
 
physProxy
;

58 ià(
vœtProxy
 !ğ
NULL
)

59 
d–‘e
 
vœtProxy
;

60 ià(
´oxy
 !ğ
NULL
)

61 
d–‘e
 
´oxy
;

62 
	}
}

65 
	gTh»adS‹
::
£rŸlize
(
¡d
::
o¡»am
 &
os
)

67 
SERIALIZE_ENUM
(
_¡©us
);

69 
SERIALIZE_SCALAR
(
funcExeIn¡
);

71 ià(!
	gFuÎSy¡em
)

74 
Tick
 
	gqu›sûEndTick
 = 0;

75 ià(
	gqu›sûEv’t
->
scheduËd
())

76 
	gqu›sûEndTick
 = 
qu›sûEv’t
->
wh’
();

77 
SERIALIZE_SCALAR
(
qu›sûEndTick
);

78 ià(
	gk”ÃlSts
)

79 
	gk”ÃlSts
->
£rŸlize
(
os
);

83 
	gTh»adS‹
::
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
)

86 
UNSERIALIZE_ENUM
(
_¡©us
);

88 
UNSERIALIZE_SCALAR
(
funcExeIn¡
);

90 ià(!
	gFuÎSy¡em
)

93 
Tick
 
	gqu›sûEndTick
;

94 
UNSERIALIZE_SCALAR
(
qu›sûEndTick
);

95 ià(
	gqu›sûEndTick
)

96 
	gba£Cpu
->
scheduË
(
qu›sûEv’t
, 
qu›sûEndTick
);

97 ià(
	gk”ÃlSts
)

98 
	gk”ÃlSts
->
un£rŸlize
(
ı
, 
£ùiÚ
);

102 
	gTh»adS‹
::
	$š™MemProx›s
(
Th»adCÚ‹xt
 *
tc
)

108 ià(
FuÎSy¡em
) {

109 
	`as£¹
(
physProxy
 =ğ
NULL
);

113 
physProxy
 = 
Ãw
 
	`PÜtProxy
(
ba£Cpu
->
	`g‘D©aPÜt
(),

114 
ba£Cpu
->
	`ÿcheLšeSize
());

116 
	`as£¹
(
vœtProxy
 =ğ
NULL
);

117 
vœtProxy
 = 
Ãw
 
	`FST¿n¦©šgPÜtProxy
(
tc
);

119 
	`as£¹
(
´oxy
 =ğ
NULL
);

120 
´oxy
 = 
Ãw
 
	`SET¿n¦©šgPÜtProxy
(
ba£Cpu
->
	`g‘D©aPÜt
(),

121 
´oûss
,

122 
SET¿n¦©šgPÜtProxy
::
NextPage
);

124 
	}
}

126 
	gPÜtProxy
 &

127 
	gTh»adS‹
::
	$g‘PhysProxy
()

129 
	`as£¹
(
FuÎSy¡em
);

130 
	`as£¹
(
physProxy
 !ğ
NULL
);

131  *
physProxy
;

132 
	}
}

134 
	gFST¿n¦©šgPÜtProxy
 &

135 
	gTh»adS‹
::
	$g‘VœtProxy
()

137 
	`as£¹
(
FuÎSy¡em
);

138 
	`as£¹
(
vœtProxy
 !ğ
NULL
);

139  *
vœtProxy
;

140 
	}
}

142 
	gSET¿n¦©šgPÜtProxy
 &

143 
	gTh»adS‹
::
	$g‘MemProxy
()

145 
	`as£¹
(!
FuÎSy¡em
);

146 
	`as£¹
(
´oxy
 !ğ
NULL
);

147  *
´oxy
;

148 
	}
}

151 
	gTh»adS‹
::
	$´ofeCË¬
()

153 ià(
´ofe
)

154 
´ofe
->
	`ş—r
();

155 
	}
}

158 
	gTh»adS‹
::
	$´ofeSam¶e
()

160 ià(
´ofe
)

161 
´ofe
->
	`§m¶e
(
´ofeNode
, 
´ofePC
);

162 
	}
}

	@thread_state.hh

31 #iâdeà
__CPU_THREAD_STATE_HH__


32 
	#__CPU_THREAD_STATE_HH__


	)

34 
	~"¬ch/ty³s.hh
"

35 
	~"cÚfig/the_i§.hh
"

36 
	~"ıu/ba£.hh
"

37 
	~"ıu/´ofe.hh
"

38 
	~"ıu/th»ad_cÚ‹xt.hh
"

39 
	~"mem/mem_objeù.hh
"

40 
	~"sim/´oûss.hh
"

42 
şass
 
	gEndQu›sûEv’t
;

43 
şass
 
	gFunùiÚProfe
;

44 
şass
 
	gProfeNode
;

45 
Çme¥aû
 
	gTheISA
 {

46 
Çme¥aû
 
	gK”Ãl
 {

47 
şass
 
	gSti¡ics
;

51 
şass
 
	gCheckpošt
;

59 
	sTh»adS‹
 {

60 
	mTh»adCÚ‹xt
::
	tStus
 Status;

62 
Th»adS‹
(
Ba£CPU
 *
ıu
, 
Th»adID
 
_tid
, 
Proûss
 *
_´oûss
);

64 
	mvœtu®
 ~
Th»adS‹
();

66 
£rŸlize
(
¡d
::
o¡»am
 &
os
);

68 
un£rŸlize
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
);

70 
ıuId
(è{  
	mba£Cpu
->cpuId(); }

72 
cÚ‹xtId
(è{  
	m_cÚ‹xtId
; }

74 
£tCÚ‹xtId
(
id
è{ 
	m_cÚ‹xtId
 = id; }

76 
£tTh»adId
(
Th»adID
 
id
è{ 
	m_th»adId
 = id; }

78 
Th»adID
 
th»adId
(è{  
	m_th»adId
; }

80 
Tick
 
»adLa¡Aùiv©e
(è{  
	mÏ¡Aùiv©e
; }

82 
Tick
 
»adLa¡Su¥’d
(è{  
	mÏ¡Su¥’d
; }

90 
š™MemProx›s
(
Th»adCÚ‹xt
 *
tc
);

92 
dumpFuncProfe
();

94 
EndQu›sûEv’t
 *
g‘Qu›sûEv’t
(è{  
	mqu›sûEv’t
; }

96 
´ofeCË¬
();

98 
´ofeSam¶e
();

100 
	mTheISA
::
K”Ãl
::
Sti¡ics
 *
g‘K”ÃlSts
(è{  
k”ÃlSts
; }

102 
	mPÜtProxy
 &
g‘PhysProxy
();

104 
	mFST¿n¦©šgPÜtProxy
 &
g‘VœtProxy
();

106 
Proûss
 *
g‘ProûssPŒ
(è{  
	m´oûss
; }

108 
	mSET¿n¦©šgPÜtProxy
 &
g‘MemProxy
();

113 
CouÁ”
 
»adFuncExeIn¡
(è{  
	mfuncExeIn¡
; }

118 
£tFuncExeIn¡
(
CouÁ”
 
Ãw_v®
è{ 
	mfuncExeIn¡
 =‚ew_val; }

121 
Stus
 
¡©us
(ècÚ¡ {  
	m_¡©us
; }

124 
£tStus
(
Stus
 
Ãw_¡©us
è{ 
	m_¡©us
 =‚ew_status; }

126 
	mpublic
:

129 
CouÁ”
 
numIn¡
;

131 
	mSts
::
SÿÏr
 
numIn¡s
;

133 
CouÁ”
 
	mnumOp
;

135 
	mSts
::
SÿÏr
 
numOps
;

137 
	mSts
::
SÿÏr
 
numMemRefs
;

142 
CouÁ”
 
	mnumLßd
;

145 
CouÁ”
 
	m¡¬tNumLßd
;

147 
	m´Ùeùed
:

148 
Th»adCÚ‹xt
::
Stus
 
_¡©us
;

151 
Ba£CPU
 *
	mba£Cpu
;

154 
	m_cÚ‹xtId
;

157 
Th»adID
 
	m_th»adId
;

159 
	mpublic
:

161 
Tick
 
Ï¡Aùiv©e
;

164 
Tick
 
	mÏ¡Su¥’d
;

166 
	mpublic
:

167 
FunùiÚProfe
 *
´ofe
;

168 
ProfeNode
 *
	m´ofeNode
;

169 
Addr
 
	m´ofePC
;

170 
EndQu›sûEv’t
 *
	mqu›sûEv’t
;

172 
	mTheISA
::
K”Ãl
::
Sti¡ics
 *
k”ÃlSts
;

174 
	m´Ùeùed
:

175 
Proûss
 *
´oûss
;

179 
PÜtProxy
 *
	mphysProxy
;

183 
FST¿n¦©šgPÜtProxy
 *
	mvœtProxy
;

184 
SET¿n¦©šgPÜtProxy
 *
	m´oxy
;

186 
	mpublic
:

191 
CouÁ”
 
funcExeIn¡
;

196 
	m¡ÜeCÚdFau»s
;

	@timebuf.hh

32 #iâdeà
__BASE_TIMEBUF_HH__


33 
	#__BASE_TIMEBUF_HH__


	)

35 
	~<ÿs£¹
>

36 
	~<c¡ršg
>

37 
	~<veùÜ
>

39 
	g‹m¶©e
 <
şass
 
	gT
>

40 şas 
	cTimeBufãr


42 
	m´Ùeùed
:

43 
·¡
;

44 
	mfutu»
;

45 
	msize
;

46 
	m_id
;

48 *
	md©a
;

49 
	m¡d
::
veùÜ
<*> 
šdex
;

50 
	mba£
;

52 
	$v®id
(
idx
)

54 
	`as£¹
 (
idx
 >ğ-
·¡
 && idx <ğ
futu»
);

57 
public
:

58 
ä›nd
 
şass
 
wœe
;

59 şas 
	cwœe


61 
ä›nd
 
şass
 
TimeBufãr
;

62 
´Ùeùed
:

63 
TimeBufãr
<
T
> *
bufãr
;

64 
šdex
;

66 
	`£t
(
idx
)

68 
bufãr
->
	`v®id
(
idx
);

69 
šdex
 = 
idx
;

72 
	`wœe
(
TimeBufãr
<
T
> *
buf
, 
i
)

73 : 
	`bufãr
(
buf
), 
	`šdex
(
i
)

76 
public
:

77 
	`wœe
()

80 
	`wœe
(cÚ¡ 
wœe
 &
i
)

81 : 
	`bufãr
(
i
.
bufãr
), 
	`šdex
(i.
šdex
)

84 cÚ¡ 
wœe
 &
İ”©Ü
=(cÚ¡ wœ&
i
)

86 
bufãr
 = 
i
.buffer;

87 
	`£t
(
i
.
šdex
);

88  *
this
;

91 cÚ¡ 
wœe
 &
İ”©Ü
=(
idx
)

93 
	`£t
(
idx
);

94  *
this
;

97 cÚ¡ 
wœe
 &
İ”©Ü
+=(
off£t
)

99 
	`£t
(
šdex
 + 
off£t
);

100  *
this
;

103 cÚ¡ 
wœe
 &
İ”©Ü
-=(
off£t
)

105 
	`£t
(
šdex
 - 
off£t
);

106  *
this
;

109 
wœe
 &
İ”©Ü
++()

111 
	`£t
(
šdex
 + 1);

112  *
this
;

115 
wœe
 &
İ”©Ü
++()

117 
i
 = 
šdex
;

118 
	`£t
(
šdex
 + 1);

119  
	`wœe
(
this
, 
i
);

122 
wœe
 &
İ”©Ü
--()

124 
	`£t
(
šdex
 - 1);

125  *
this
;

128 
wœe
 &
İ”©Ü
--()

130 
i
 = 
šdex
;

131 
	`£t
(
šdex
 - 1);

132  
	`wœe
(
this
, 
i
);

134 
T
 &
İ”©Ü
*(ècÚ¡ {  *
bufãr
->
	`acûss
(
šdex
); }

135 
T
 *
İ”©Ü
->(ècÚ¡ {  
bufãr
->
	`acûss
(
šdex
); }

136 
	}
};

139 
	gpublic
:

140 
	$TimeBufãr
(
p
, 
f
)

141 : 
	`·¡
(
p
), 
	`futu»
(
f
), 
	`size
(
·¡
 + 
futu»
 + 1),

142 
	`d©a
(
Ãw
 [
size
 * (
T
)]), 
	`šdex
(size), 
	$ba£
(0)

144 
	`as£¹
(
·¡
 >ğ0 && 
futu»
 >= 0);

145 *
±r
 = 
d©a
;

146 
i
 = 0; i < 
size
; i++) {

147 
šdex
[
i
] = 
±r
;

148 
¡d
::
	`mem£t
(
±r
, 0, (
T
));

149 
	`Ãw
 (
±r
è
T
;

150 
±r
 +ğ(
T
);

153 
_id
 = -1;

154 
	}
}

156 
	$TimeBufãr
()

157 : 
	$d©a
(
NULL
)

159 
	}
}

161 ~
	$TimeBufãr
()

163 
i
 = 0; i < 
size
; ++i)

164 (
»š‹½»t_ÿ¡
<
T
 *>(
šdex
[
i
]))->~
	`T
();

165 
d–‘e
 [] 
d©a
;

166 
	}
}

168 
	$id
(
id
)

170 
_id
 = 
id
;

171 
	}
}

173 
	$id
()

175  
_id
;

176 
	}
}

179 
	$advªû
()

181 ià(++
ba£
 >ğ
size
)

182 
ba£
 = 0;

184 
±r
 = 
ba£
 + 
futu»
;

185 ià(
±r
 >ğ()
size
)

186 
±r
 -ğ
size
;

187 (
»š‹½»t_ÿ¡
<
T
 *>(
šdex
[
±r
]))->~
	`T
();

188 
¡d
::
	`mem£t
(
šdex
[
±r
], 0, (
T
));

189 
	`Ãw
 (
šdex
[
±r
]è
T
;

190 
	}
}

192 
T
 *
	$acûss
(
idx
)

195 
	`v®id
(
idx
);

197 
veùÜ_šdex
 = 
idx
 + 
ba£
;

198 ià(
veùÜ_šdex
 >ğ()
size
) {

199 
veùÜ_šdex
 -ğ
size
;

200 } ià(
veùÜ_šdex
 < 0) {

201 
veùÜ_šdex
 +ğ
size
;

204  
»š‹½»t_ÿ¡
<
T
 *>(
šdex
[
veùÜ_šdex
]);

205 
	}
}

207 
	gT
 &
	gİ”©Ü
[](
	gidx
)

210 
v®id
(
idx
);

212 
	gveùÜ_šdex
 = 
idx
 + 
ba£
;

213 ià(
	gveùÜ_šdex
 >ğ()
size
) {

214 
veùÜ_šdex
 -ğ
size
;

215 } ià(
	gveùÜ_šdex
 < 0) {

216 
	gveùÜ_šdex
 +ğ
size
;

219  
	g»š‹½»t_ÿ¡
<
	gT
 &>(*
	gšdex
[
veùÜ_šdex
]);

222 
wœe
 
	$g‘Wœe
(
idx
)

224 
	`v®id
(
idx
);

226  
	`wœe
(
this
, 
idx
);

227 
	}
}

229 
wœe
 
	$z”o
()

231  
	`wœe
(
this
, 0);

232 
	}
}

234 
	$g‘Size
()

236  
size
;

237 
	}
}

	@timingcgra/CGRAController.cpp

8 
	~"CGRACÚŒŞËr.h
"

11 
	gCGRA_CÚŒŞËr
::
	$CGRA_CÚŒŞËr
()

14 
PC
=0;

16 
	}
}

18 
	gCGRA_CÚŒŞËr
::~
	$CGRA_CÚŒŞËr
()

21 
	}
}

23 
CGRA_CÚŒŞËr
::
	$Inü—£PC
()

25 
PC
=PC+
L’
;

26 
	}
}

28 
	gCGRA_CÚŒŞËr
::
	$Upd©ePCK”Ãl
()

31 ià((
PC
-
PrŞog
*
L’
)==(
II
*Len))

33 
PC
=
PrŞog
*
L’
;

35 
	}
}

37 
	gCGRA_CÚŒŞËr
::
	$g‘PC
()

39  
PC
;

40 
	}
}

41 
	gCGRA_CÚŒŞËr
::
	$S‘L’
(
Ën
)

43 
this
->
L’
=
Ën
;

44 
	}
}

46 
	gCGRA_CÚŒŞËr
::
	$S‘II
(
II
)

48 
this
->
II
=II;

49 
	}
}

50 
	gCGRA_CÚŒŞËr
::
	$S‘PrŞog
(
´Şog
)

52 
this
->
PrŞog
=
´Şog
;

54 
	}
}

55 
	gCGRA_CÚŒŞËr
::
	$S‘Epog
(
•og
)

57 
this
->
Epog
=
•og
;

58 
	}
}

61 
boŞ
 
	gCGRA_CÚŒŞËr
::
	$isPrŞog
()

63  (
PC
<
PrŞog
*
L’
);

64 
	}
}

66 
boŞ
 
	gCGRA_CÚŒŞËr
::
	$isOv”
()

68  (
PC
>=(
PrŞog
+
II
+
Epog
)*
L’
);

69 
	}
}

	@timingcgra/CGRAController.h

8 #iâdeà
CONTROLLER_H_


9 
	#CONTROLLER_H_


	)

11 şas 
	cCGRA_CÚŒŞËr


13 
	mpublic
:

14 
CGRA_CÚŒŞËr
();

15 
	mvœtu®
 ~
CGRA_CÚŒŞËr
();

16 
Inü—£PC
();

17 
Upd©ePCK”Ãl
();

18 
g‘PC
();

19 
S‘L’
(
Ën
);

20 
S‘II
(
II
);

21 
S‘PrŞog
(
´Şog
);

22 
S‘Epog
(
•og
);

24 
boŞ
 
isPrŞog
();

26 
boŞ
 
isOv”
();

30 
	m´iv©e
:

31 
PC
;

32 
	mII
;

33 
	mEpog
;

34 
	mPrŞog
;

35 
	mL’
;

	@timingcgra/CGRADataMemory.cpp

7 
	#CGRADEBUG


	)

9 
	~"CGRAD©aMemÜy.h
"

11 
	gCGRA_D©aMemÜy
::
	$CGRA_D©aMemÜy
()

14 
d©a
 = 
Ãw
 [
DMEMSIZE
];

17 
	}
}

19 
	gCGRA_D©aMemÜy
::~
	$CGRA_D©aMemÜy
()

21 
	`d–‘e
(
d©a
);

23 
	}
}

26 
	gCGRA_D©aMemÜy
::
	$R—d
(
add»ss
) {

27 ià(
add»ss
 >ğ
DMEMSIZE
) {

28 
throw
 
Ãw
 
	`CGRAExû±iÚ
("CGRA Data Memory„ead‡ddress is out of„ange");

30 #ifdeà
CGRADEBUG


33  
d©a
[
add»ss
];

34 
	}
}

37 
	gCGRA_D©aMemÜy
::
	$Wr™e
(
add»ss
, 
šD©a
)

39 ià(
add»ss
 >ğ
DMEMSIZE
)

41 
throw
 
Ãw
 
	`CGRAExû±iÚ
("CGRA Data Memory write‡ddress is out of„ange");

43 #ifdeà
CGRADEBUG


46 
d©a
[
add»ss
] = 
šD©a
;

47 
	}
}

	@timingcgra/CGRADataMemory.h

8 #iâdeà
DATAMEMORY_H_


9 
	#DATAMEMORY_H_


	)

10 
	~"CGRAdefš™iÚs.h
"

13 şas 
	cCGRA_D©aMemÜy


15 
	mpublic
:

16 
CGRA_D©aMemÜy
();

17 
	mvœtu®
 ~
CGRA_D©aMemÜy
();

21 
R—d
(
add»ss
);

22 
Wr™e
(
add»ss
,
šD©a
);

23 
	m´iv©e
:

27 * 
d©a
;

	@timingcgra/CGRADecoder.cpp

8 
	~"CGRADecod”.h
"

11 
	gCGRADecod”
::
	$CGRADecod”
()

13 
š¡
 = 
Ãw
 
CGRA_In¡ruùiÚ
*[
CGRA_XDim
*
CGRA_YDim
];

14 
»ady_to_ãtch
=
Œue
;

15 
couÁ”
=0;

16 
	}
}

17 
	gCGRADecod”
::~
	$CGRADecod”
()

20 
	}
}

21 
boŞ
 
CGRADecod”
::
	$is_R—dy
()

23  
»ady_to_ãtch
;

24 
	}
}

25 
boŞ
 
	gCGRADecod”
::
	$is_ãtch_com¶‘ed
()

27  !
»ady_to_ãtch
;

28 
	}
}

29 
	gCGRADecod”
::
	$Add_MÜe_PE_In¡ruùiÚ
(
CGRA_In¡ruùiÚ
 *
šs
)

31 
š¡
[
couÁ”
]=
šs
;

32 
couÁ”
++;

33 ià(
couÁ”
==
CGRA_YDim
)

35 
»ady_to_ãtch
=
çl£
;

37 
	}
}

38 
	gCGRADecod”
::
	$Make_R—dy_Next
()

40 
couÁ”
=0;

41 
»ady_to_ãtch
=
Œue
;

42 
	}
}

43 
CGRA_In¡ruùiÚ
** 
	gCGRADecod”
::
	$g‘_š¡ruùiÚs
()

45  
š¡
;

46 
	}
}

	@timingcgra/CGRADecoder.h

10 
	~"CGRAIn¡ruùiÚ.h
"

13 şas 
	cCGRADecod”
{

15 
	mpublic
:

16 
CGRADecod”
();

18 
	mvœtu®
 ~
CGRADecod”
();

20 
	m´iv©e
:

21 
boŞ
 
»ady_to_ãtch
;

22 
	mcouÁ”
;

23 
CGRA_In¡ruùiÚ
 **
	mš¡
;

25 
	mpublic
:

26 
boŞ
 
is_R—dy
();

28 
Add_MÜe_PE_In¡ruùiÚ
(
CGRA_In¡ruùiÚ
 *
šs
);

29 
Make_R—dy_Next
();

31 
boŞ
 
is_ãtch_com¶‘ed
();

33 
CGRA_In¡ruùiÚ
** 
g‘_š¡ruùiÚs
();

	@timingcgra/CGRAException.cpp

8 
	~"CGRAExû±iÚ.h
"

10 
	gCGRAExû±iÚ
::
	$CGRAExû±iÚ
(
¡ršg
 
mes§ge
):
	$exû±iÚ
() {

11 
cout
<<
mes§ge
<<
’dl
;

15 
	}
}

	@timingcgra/CGRAException.h

8 #iâdeà
CGRAEXCEPTION_H_


9 
	#CGRAEXCEPTION_H_


	)

11 
	~<exû±iÚ
>

12 
	~<¡ršg
>

13 
	~<io¡»am
>

14 
	~<¡dio.h
>

15 
usšg
 
Çme¥aû
 
	g¡d
;

16 şas 
	cCGRAExû±iÚ
:
public
 
¡d
::
exû±iÚ
 {

17 
public
:

18 
CGRAExû±iÚ
(
¡ršg
 
mes§ge
);

	@timingcgra/CGRAInstruction.cpp

8 
	~"CGRAIn¡ruùiÚ.h
"

10 
	gCGRA_In¡ruùiÚ
::
	$CGRA_In¡ruùiÚ
()

14 
	}
}

15 
CGRA_In¡ruùiÚ
::
	$CGRA_In¡ruùiÚ
(
In¡ruùiÚwÜd
){

17 
InsWÜd
 = 
In¡ruùiÚwÜd
;

18 
	`ENCODE_š¡ruùiÚ
();

19 
	}
}

20 
	gCGRA_In¡ruùiÚ
::
	$CGRA_In¡ruùiÚ
(
OPCode
 
İc
,
´edic
,
PEIÅutMux
 
LMuxS–
, PEIÅutMux 
RMuxS–
, 
RRegAdd1
,
RRegAdd2
, 
WAdd
, 
boŞ
 
WE
, 
ImmV®
, boŞ 
EDMAdd
, boŞ 
DMD©a
)

22 
İCode
=
İc
;

23 
P»diÿtÜ
=
´edic
;

24 
LeáMuxS–eùÜ
=
LMuxS–
;

25 
RightMuxS–eùÜ
=
RMuxS–
;

26 
R—dRegAdd»ss1
=
RRegAdd1
;

27 
R—dRegAdd»ss2
=
RRegAdd2
;

28 
Wr™eRegAdd»ss
=
WAdd
;

29 
Wr™eRegi¡”EÇbË
=
WE
;

30 
ImmedŸ‹V®ue
=
ImmV®
;

31 
S–eùD©aMemÜyAdd»ssBus
=
EDMAdd
;

32 
S–eùD©aMemÜyD©aBus
=
DMD©a
;

33 
	}
}

35 
	gCGRA_In¡ruùiÚ
::~
	$CGRA_In¡ruùiÚ
()

38 
	}
}

40 
OPCode
 
CGRA_In¡ruùiÚ
::
	$g‘OpCode
()

42  
İCode
;

43 
	}
}

46 
	gCGRA_In¡ruùiÚ
::
	$g‘P»diÿtÜ
()

48  
P»diÿtÜ
;

49 
	}
}

51 
PEIÅutMux
 
	gCGRA_In¡ruùiÚ
::
	$g‘LeáMuxS–eùÜ
()

53  
LeáMuxS–eùÜ
;

54 
	}
}

56 
PEIÅutMux
 
	gCGRA_In¡ruùiÚ
::
	$g‘RightMuxS–eùÜ
()

58  
RightMuxS–eùÜ
;

59 
	}
}

62 
	gCGRA_In¡ruùiÚ
::
	$g‘R—dRegAdd»ss1
()

64  
R—dRegAdd»ss1
;

65 
	}
}

67 
	gCGRA_In¡ruùiÚ
::
	$g‘R—dRegAdd»ss2
()

69  
R—dRegAdd»ss2
;

70 
	}
}

72 
	gCGRA_In¡ruùiÚ
::
	$g‘Wr™eRegAdd»ss
()

74  
Wr™eRegAdd»ss
;

75 
	}
}

79 
boŞ
 
	gCGRA_In¡ruùiÚ
::
	$g‘Wr™eRegi¡”EÇbË
()

81  
Wr™eRegi¡”EÇbË
;

82 
	}
}

84 
	gCGRA_In¡ruùiÚ
::
	$g‘ImmedŸ‹V®ue
()

86  
ImmedŸ‹V®ue
;

87 
	}
}

89 
boŞ
 
	gCGRA_In¡ruùiÚ
::
	$g‘S–eùD©aMemÜyAdd»ssBus
()

91  
S–eùD©aMemÜyAdd»ssBus
;

92 
	}
}

95 
boŞ
 
	gCGRA_In¡ruùiÚ
::
	$g‘S–eùD©aMemÜyD©aBus
()

97  
S–eùD©aMemÜyD©aBus
;

98 
	}
}

100 
	gCGRA_In¡ruùiÚ
::
	$ENCODE_š¡ruùiÚ
()

102 (
InsWÜd
 & 
INS_OPCODE
è>> 
SHIFT_OPCODE
){

103 
Add
:

104 
İCode
 = 
Add
;

106 
Sub
:

107 
İCode
 = 
Sub
;

109 
MuÉ
:

110 
İCode
 = 
MuÉ
;

112 
AND
:

113 
İCode
 = 
AND
;

115 
OR
:

116 
İCode
 = 
OR
;

118 
XOR
:

119 
İCode
 = 
XOR
;

121 
cg¿ASR
:

122 
İCode
 = 
cg¿ASR
;

124 
cg¿ASL
:

125 
İCode
 = 
cg¿ASL
;

127 
NOOP
:

128 
İCode
ğ
NOOP
;

130 
GT
:

131 
İCode
ğ
GT
;

133 
LT
:

134 
İCode
ğ
LT
;

136 
EQ
:

137 
İCode
ğ
EQ
;

139 
NEQ
:

140 
İCode
ğ
NEQ
;

142 
LDi
:

143 
İCode
ğ
LDi
;

145 
LDMi
:

146 
İCode
ğ
LDMi
;

148 
LDUi
:

149 
İCode
ğ
LDUi
;

152 
P»diÿtÜ
ğ(
InsWÜd
 & 
INS_PREDICT
 )>>
SHIFT_PREDICT
;

154 (
InsWÜd
 & 
INS_LMUX
 ) >> 
SHIFT_LMUX
){

155 
Regi¡”
:

156 
LeáMuxS–eùÜ
 = 
Regi¡”
;

158 
Leá
:

159 
LeáMuxS–eùÜ
 = 
Leá
;

161 
Right
:

162 
LeáMuxS–eùÜ
 = 
Right
;

164 
Up
:

165 
LeáMuxS–eùÜ
 = 
Up
;

167 
Down
:

168 
LeáMuxS–eùÜ
 = 
Down
;

170 
D©aBus
:

171 
LeáMuxS–eùÜ
 = 
D©aBus
;

173 
ImmedŸ‹
:

174 
LeáMuxS–eùÜ
 = 
ImmedŸ‹
;

176 
S–f
:

177 
LeáMuxS–eùÜ
ğ
S–f
;

180 (
InsWÜd
 & 
INS_RMUX
 ) >> 
SHIFT_RMUX
){

181 
Regi¡”
:

182 
RightMuxS–eùÜ
 = 
Regi¡”
;

184 
Leá
:

185 
RightMuxS–eùÜ
 = 
Leá
;

187 
Right
:

188 
RightMuxS–eùÜ
 = 
Right
;

190 
Up
:

191 
RightMuxS–eùÜ
 = 
Up
;

193 
Down
:

194 
RightMuxS–eùÜ
 = 
Down
;

196 
D©aBus
:

197 
RightMuxS–eùÜ
 = 
D©aBus
;

199 
ImmedŸ‹
:

200 
RightMuxS–eùÜ
 = 
ImmedŸ‹
;

202 
S–f
:

203 
RightMuxS–eùÜ
ğ
S–f
;

207 
R—dRegAdd»ss1
ğ(
InsWÜd
 & 
INS_R1
 )>>
SHIFT_R1
 ;

208 
R—dRegAdd»ss2
ğ(
InsWÜd
 & 
INS_R2
 )>>
SHIFT_R2
 ;

209 
Wr™eRegAdd»ss
ğ(
InsWÜd
 & 
INS_RW
 )>>
SHIFT_RW
 ;

210 
Wr™eRegi¡”EÇbË
ğ(
InsWÜd
 & 
INS_WE
 )>>
SHIFT_WE
 ;

211 
ImmedŸ‹V®ue
ğ(
InsWÜd
 & 
INS_IMMEDIATE
 )>>
SHIFT_IMMEDIATE
 ;

212 
S–eùD©aMemÜyAdd»ssBus
ğ(
InsWÜd
 & 
INS_AB
 )>>
SHIFT_ABUS
 ;

213 
S–eùD©aMemÜyD©aBus
ğ(
InsWÜd
 & 
INS_DB
 )>>
SHIFT_DBUS
 ;

225 
	}
}

229 
	gCGRA_In¡ruùiÚ
::
	$g‘OpCode_DECODE
()

231 
InsWÜd
 = 0;

232 
InsWÜd
 |=
İCode
;

233 
InsWÜd
 <<ğ
SHIFT_OPCODE
;

234 
InsWÜd
 &ğ
INS_OPCODE
;

236  
InsWÜd
;

237 
	}
}

241 
	gCGRA_In¡ruùiÚ
::
	$g‘P»diÿtÜ_DECODE
()

243 
InsWÜd
 = 0;

244 
InsWÜd
 |=
P»diÿtÜ
;

245 
InsWÜd
 <<ğ
SHIFT_PREDICT
;

246 
InsWÜd
 &ğ
INS_PREDICT
;

248  
InsWÜd
;

249 
	}
}

253 
	gCGRA_In¡ruùiÚ
::
	$g‘LeáMuxS–eùÜ_DECODE
()

255 
InsWÜd
 = 0;

256 
InsWÜd
 |=
LeáMuxS–eùÜ
;

257 
InsWÜd
 <<ğ
SHIFT_LMUX
;

258 
InsWÜd
 &ğ
INS_LMUX
;

260  
InsWÜd
;

261 
	}
}

266 
	gCGRA_In¡ruùiÚ
::
	$g‘RightMuxS–eùÜ_DECODE
()

268 
InsWÜd
 = 0;

269 
InsWÜd
 |=
RightMuxS–eùÜ
;

270 
InsWÜd
 <<ğ
SHIFT_RMUX
;

271 
InsWÜd
 &ğ
INS_RMUX
;

273  
InsWÜd
;

274 
	}
}

279 
	gCGRA_In¡ruùiÚ
::
	$g‘R—dRegAdd»ss1_DECODE
()

281 
InsWÜd
 = 0;

282 
InsWÜd
 |ğ
R—dRegAdd»ss1
;

283 
InsWÜd
 <<ğ
SHIFT_R1
;

284 
InsWÜd
 &ğ
INS_R1
;

286  
InsWÜd
;

287 
	}
}

292 
	gCGRA_In¡ruùiÚ
::
	$g‘R—dRegAdd»ss2_DECODE
()

294 
InsWÜd
 = 0;

295 
InsWÜd
 |ğ
R—dRegAdd»ss2
;

296 
InsWÜd
 <<ğ
SHIFT_R2
;

297 
InsWÜd
 &ğ
INS_R2
;

299  
InsWÜd
;

300 
	}
}

305 
	gCGRA_In¡ruùiÚ
::
	$g‘Wr™eRegAdd»ss_DECODE
()

307 
InsWÜd
 = 0;

308 
InsWÜd
 |ğ
Wr™eRegAdd»ss
;

309 
InsWÜd
 <<ğ
SHIFT_RW
;

310 
InsWÜd
 &ğ
INS_RW
;

312  
InsWÜd
;

313 
	}
}

317 
	gCGRA_In¡ruùiÚ
::
	$g‘Wr™eRegi¡”EÇbË_DECODE
()

319 
InsWÜd
 = 0;

320 
InsWÜd
 |ğ
Wr™eRegi¡”EÇbË
;

321 
InsWÜd
 <<ğ
SHIFT_WE
;

322 
InsWÜd
 &ğ
INS_WE
;

324  
InsWÜd
;

325 
	}
}

330 
	gCGRA_In¡ruùiÚ
::
	$g‘ImmedŸ‹V®ue_DECODE
()

332 
InsWÜd
 = 0;

333 if(
ImmedŸ‹V®ue
 > 0Xfff){

334 
	`´štf
("ERROR: CAN'T HOLD IMMEDIATE VALUE, SETTING VALUE = 0xfff\n");

335 
ImmedŸ‹V®ue
 = 0xfff;

337 
InsWÜd
 |ğ
ImmedŸ‹V®ue
;

338 
InsWÜd
 <<ğ
SHIFT_IMMEDIATE
;

339 
InsWÜd
 &ğ
INS_IMMEDIATE
;

341  
InsWÜd
;

342 
	}
}

346 
	gCGRA_In¡ruùiÚ
::
	$g‘S–eùD©aMemÜyAdd»ssBus_DECODE
()

348 
InsWÜd
 = 0;

349 
InsWÜd
 |ğ
S–eùD©aMemÜyAdd»ssBus
;

350 
InsWÜd
 <<ğ
SHIFT_ABUS
;

351 
InsWÜd
 &ğ
INS_AB
;

353  
InsWÜd
;

354 
	}
}

359 
	gCGRA_In¡ruùiÚ
::
	$g‘S–eùD©aMemÜyD©aBus_DECODE
()

361 
InsWÜd
 = 0;

362 
InsWÜd
 |ğ
S–eùD©aMemÜyD©aBus
;

363 
InsWÜd
 <<ğ
SHIFT_DBUS
;

364 
InsWÜd
 &ğ
INS_DB
;

366  
InsWÜd
;

367 
	}
}

370 
	gCGRA_In¡ruùiÚ
::
	$DecodeIn¡ruùiÚ
(
CGRA_In¡ruùiÚ
* 
Ins
)

372 
InsWÜd
 =0;

373 
InsWÜd
 |ğ
Ins
->
	`g‘OpCode_DECODE
();

374 
InsWÜd
 |ğ
Ins
->
	`g‘P»diÿtÜ_DECODE
();

375 
InsWÜd
 |ğ
Ins
->
	`g‘LeáMuxS–eùÜ_DECODE
();

376 
InsWÜd
 |ğ
Ins
->
	`g‘RightMuxS–eùÜ_DECODE
();

377 
InsWÜd
 |ğ
Ins
->
	`g‘R—dRegAdd»ss1_DECODE
();

378 
InsWÜd
 |ğ
Ins
->
	`g‘R—dRegAdd»ss2_DECODE
();

379 
InsWÜd
 |ğ
Ins
->
	`g‘Wr™eRegAdd»ss_DECODE
();

380 
InsWÜd
 |ğ
Ins
->
	`g‘Wr™eRegi¡”EÇbË_DECODE
();

381 
InsWÜd
 |ğ
Ins
->
	`g‘S–eùD©aMemÜyAdd»ssBus_DECODE
();

382 
InsWÜd
 |ğ
Ins
->
	`g‘S–eùD©aMemÜyD©aBus_DECODE
();

383 
InsWÜd
 |ğ
Ins
->
	`g‘ImmedŸ‹V®ue_DECODE
();

384  
InsWÜd
;

385 
	}
}

	@timingcgra/CGRAInstruction.h

8 #iâdeà
INSTRUCTION_H_


9 
	#INSTRUCTION_H_


	)

11 
	~"CGRAdefš™iÚs.h
"

13 şas 
	cCGRA_In¡ruùiÚ


16 
	mpublic
:

17 
CGRA_In¡ruùiÚ
();

19 
CGRA_In¡ruùiÚ
(
In¡ruùiÚWÜd
);

21 
CGRA_In¡ruùiÚ
(
OPCode
 
İc
,
´edic
,
PEIÅutMux
 
LMuxS–
,PEIÅutMux 
RMuxS–
,\

22 
RRegAdd1
,
RRegAdd2
, 
WAdd
, 
boŞ
 
WE
, 
ImmV®
, boŞ 
EDMAdd
, boŞ 
DMD©a
);

24 
	mvœtu®
 ~
CGRA_In¡ruùiÚ
();

26 
OPCode
 
g‘OpCode
();

27 
g‘P»diÿtÜ
();

28 
PEIÅutMux
 
g‘LeáMuxS–eùÜ
();

29 
PEIÅutMux
 
g‘RightMuxS–eùÜ
();

30 
g‘R—dRegAdd»ss1
();

31 
g‘R—dRegAdd»ss2
();

32 
g‘Wr™eRegAdd»ss
();

33 
boŞ
 
g‘Wr™eRegi¡”EÇbË
();

34 
g‘ImmedŸ‹V®ue
();

35 
boŞ
 
g‘S–eùD©aMemÜyAdd»ssBus
();

36 
boŞ
 
g‘S–eùD©aMemÜyD©aBus
();

38 
ENCODE_š¡ruùiÚ
();

40 
g‘OpCode_DECODE
();

41 
g‘P»diÿtÜ_DECODE
();

42 
g‘LeáMuxS–eùÜ_DECODE
();

43 
g‘RightMuxS–eùÜ_DECODE
();

44 
g‘R—dRegAdd»ss1_DECODE
();

45 
g‘R—dRegAdd»ss2_DECODE
();

46 
g‘Wr™eRegAdd»ss_DECODE
();

47 
g‘Wr™eRegi¡”EÇbË_DECODE
();

48 
g‘ImmedŸ‹V®ue_DECODE
();

49 
g‘S–eùD©aMemÜyAdd»ssBus_DECODE
();

50 
g‘S–eùD©aMemÜyD©aBus_DECODE
();

52 
DecodeIn¡ruùiÚ
(
CGRA_In¡ruùiÚ
* 
Ins
);

54 
	m´iv©e
:

55 
OPCode
 
İCode
;

56 
	mP»diÿtÜ
;

57 
PEIÅutMux
 
	mLeáMuxS–eùÜ
;

58 
PEIÅutMux
 
	mRightMuxS–eùÜ
;

59 
	mR—dRegAdd»ss1
;

60 
	mR—dRegAdd»ss2
;

61 
	mWr™eRegAdd»ss
;

62 
boŞ
 
	mWr™eRegi¡”EÇbË
;

63 
	mImmedŸ‹V®ue
;

64 
boŞ
 
	mS–eùD©aMemÜyAdd»ssBus
;

65 
boŞ
 
	mS–eùD©aMemÜyD©aBus
;

67 
	mInsWÜd
;

	@timingcgra/CGRAPE.cpp

8 
	~"CGRAPE.h
"

9 
	~<iomª
>

10 
	gCGRA_PE
::
	$CGRA_PE
()

12 
RegFe
=
Ãw
 
	`CGRA_Regi¡”Fe
();

13 
Ouut
=0;

14 
CyşeCouÁ”
=0;

17 
	}
}

19 
	gCGRA_PE
::~
	$CGRA_PE
()

23 
	}
}

25 
CGRA_PE
::
	$g‘Ouut
()

27  
Ouut
;

28 
	}
}

30 
	gCGRA_PE
::
	$F‘ch
(
CGRA_In¡ruùiÚ
* 
šs
)

32 
this
->
šs
 = ins;

34 
	}
}

35 
	gCGRA_PE
::
	$Decode
()

39 
»g
 = 
šs
->
	`g‘R—dRegAdd»ss1
();

40 if((
šs
->
	`g‘OpCode
())!=
NOOP
)

42 
šs
->
	`g‘LeáMuxS–eùÜ
())

44 
Regi¡”
:

47 if(
šs
->
	`g‘S–eùD©aMemÜyAdd»ssBus
())

48 
»g
 +ğ
REGFILESIZE
;

50 
IÅut1
 = 
RegFe
->
	`R—d
(
»g
);

52 
Leá
:

53 
IÅut1
 = 
LeáNeighbour
->
	`g‘Ouut
();

55 
Right
:

56 
IÅut1
 = 
RightNeighbour
->
	`g‘Ouut
();

58 
Up
:

59 
IÅut1
 = 
UpNeighbour
->
	`g‘Ouut
();

61 
Down
:

62 
IÅut1
 = 
DownNeighbour
->
	`g‘Ouut
();

64 
D©aBus
:

65 
IÅut1
 = 
MemÜyPÜt
->
	`g‘Ouut
();

66 
	`´štf
("\n******** DB INPUT1 %d************\n",
IÅut1
);

68 
ImmedŸ‹
:

69 
IÅut1
=
šs
->
	`g‘ImmedŸ‹V®ue
();

71 
S–f
:

72 
IÅut1
=
Ouut
;

75 
throw
 
Ãw
 
	`CGRAExû±iÚ
("CGRA Left Mux selector out of„ange");

78 
šs
->
	`g‘RightMuxS–eùÜ
())

80 
Regi¡”
:

81 
IÅut2
 = 
RegFe
->
	`R—d
(
šs
->
	`g‘R—dRegAdd»ss2
());

83 
Leá
:

84 
IÅut2
 = 
LeáNeighbour
->
	`g‘Ouut
();

86 
Right
:

87 
IÅut2
 = 
RightNeighbour
->
	`g‘Ouut
();

89 
Up
:

90 
IÅut2
 = 
UpNeighbour
->
	`g‘Ouut
();

92 
Down
:

93 
IÅut2
 = 
DownNeighbour
->
	`g‘Ouut
();

95 
D©aBus
:

96 
IÅut2
 = 
MemÜyPÜt
->
	`g‘Ouut
();

97 
	`´štf
("\n******** DB INPUT2 %d************\n",
IÅut2
);

99 
ImmedŸ‹
:

100 
IÅut2
=
šs
->
	`g‘ImmedŸ‹V®ue
();

102 
S–f
:

103 
IÅut2
=
Ouut
;

106 
throw
 
Ãw
 
	`CGRAExû±iÚ
("CGRA Right Mux selector out of„ange");

109 
	}
}

111 
	gCGRA_PE
::
	$Execu‹
()

113 
šs_İcode
=
šs
->
	`g‘OpCode
();

114 
šs_İcode
)

116 
Add
:

117 
Ouut
=
IÅut1
+
IÅut2
;

119 
Sub
:

120 
Ouut
=
IÅut1
-
IÅut2
;

122 
MuÉ
:

123 
Ouut
=
IÅut1
*
IÅut2
;

125 
AND
:

126 
Ouut
=
IÅut1
&
IÅut2
;

128 
OR
:

129 
Ouut
=
IÅut1
|
IÅut2
;

131 
XOR
:

132 
Ouut
=
IÅut1
^
IÅut2
;

134 
cg¿ASR
:

135 
Ouut
=
IÅut1
>>
IÅut2
;

137 
cg¿ASL
:

138 
Ouut
=
IÅut1
<<
IÅut2
;

140 
GT
:

141 
Ouut
=
IÅut1
>
IÅut2
;

143 
LT
:

144 
Ouut
=
IÅut1
<
IÅut2
;

146 
EQ
:

147 
Ouut
=
IÅut1
==
IÅut2
;

149 
NEQ
:

150 
Ouut
=
IÅut1
!=
IÅut2
;

152 
LDi
:

153 
LDMi
:

154 
LDUi
:

155 
Ouut
=
IÅut1
;

157 
NOOP
:

161 
throw
 
Ãw
 
	`CGRAExû±iÚ
("Unknown CGRA Opcode");

164 ià(
šs
->
	`g‘S–eùD©aMemÜyAdd»ssBus
())

166 
	`´štf
("\n*********S‘tšg Add»s %x ******\n",()
Ouut
);

167 
MemÜyPÜt
->
	`£tAdd»ss
(
Ouut
);

168 
MemÜyPÜt
->
	`R—d
();

170 ià(
šs
->
	`g‘S–eùD©aMemÜyD©aBus
())

172 
	`´štf
("\n******** DB Ouuˆ%d************\n",
Ouut
);

173 
MemÜyPÜt
->
	`£tD©a
(
Ouut
);

175 ià(
šs
->
	`g‘Wr™eRegi¡”EÇbË
())

180 
wr™eRegi¡”Numb”
 = 
šs
->
	`g‘Wr™eRegAdd»ss
();

181 if(
šs_İcode
==
LDi
)

183 
wr™eRegi¡”Numb”
 = wr™eRegi¡”Numb” + 
REGFILESIZE
;

184 
RegFe
->
	`Wr™e
(
wr™eRegi¡”Numb”
,
Ouut
);

186 if(
šs_İcode
==
LDMi
)

188 
wr™eRegi¡”Numb”
 = wr™eRegi¡”Numb” + 
REGFILESIZE
;

189 
Ouut
=(Ouut<<12è| ( 
RegFe
->
	`R—d
(
wr™eRegi¡”Numb”
));

190 
RegFe
->
	`Wr™e
(
wr™eRegi¡”Numb”
,
Ouut
);

192 if(
šs_İcode
==
LDUi
)

194 
wr™eRegi¡”Numb”
 = wr™eRegi¡”Numb” + 
REGFILESIZE
;

195 
Ouut
=(Ouut<<24è| ( 
RegFe
->
	`R—d
(
wr™eRegi¡”Numb”
));

196 
RegFe
->
	`Wr™e
(
wr™eRegi¡”Numb”
,
Ouut
);

199 
RegFe
->
	`Wr™e
(
wr™eRegi¡”Numb”
,
Ouut
);

201 
	`advªûTime
();

203 if(
šs_İcode
==
EQ
 || ins_İcode==
NEQ
 || ins_İcode==
GT
 || ins_İcode==
LT
)

206 
	`´štf
("\nCOMPARE INSTRUCTION OUTPUT = %d\n",
Ouut
);

207 *(
this
->
CÚŒŞËr_Reg
)=
Ouut
;

210 
	}
}

212 
	gCGRA_PE
::
	$Wr™eBack
()

214 ià(
šs
->
	`g‘S–eùD©aMemÜyD©aBus
())

216 
MemÜyPÜt
->
	`Wr™e
();

218 
	}
}

219 
	gCGRA_PE
::
	$S‘Neighbours
(
CGRA_PE
* 
Leá
,CGRA_PE* 
Right
,CGRA_PE* 
Up
,CGRA_PE* 
Down
)

221 
this
->
LeáNeighbour
=
Leá
;

222 
this
->
RightNeighbour
=
Right
;

223 
this
->
UpNeighbour
=
Up
;

224 
this
->
DownNeighbour
=
Down
;

226 
	}
}

227 
	gCGRA_PE
::
	$£tII
(
II
)

229 
this
->
II
=II;

230 
	}
}

231 
	gCGRA_PE
::
	$S‘CGRA_MemÜyPÜt
(
CGRA_MemÜyPÜt
 *
MP
)

233 
this
->
MemÜyPÜt
=
MP
;

234 
	}
}

235 
	gCGRA_PE
::
	$S‘CÚŒŞËr_Reg
(* 
»g
)

237 
this
->
CÚŒŞËr_Reg
=
»g
;

238 
	}
}

239 
	gCGRA_PE
::
	$advªûTime
()

241 
CyşeCouÁ”
++;

242 ià(
CyşeCouÁ”
%
II
==0)

244 
RegFe
->
	`NextI‹¿tiÚ
();

247 
	}
}

249 
	gCGRA_PE
::
	$D_R—dRegfe
()

251 
cout
 <<"R0:"<<
	`£tw
(6)<< 
RegFe
->
	`R—d
(0)<<"\t"\

252 <<"R1:"<<
	`£tw
(6)<< 
RegFe
->
	`R—d
(1)<<"\t"\

253 <<"R2:"<<
	`£tw
(6)<< 
RegFe
->
	`R—d
(2)<<"\t"\

254 <<"R3:"<<
	`£tw
(6)<< 
RegFe
->
	`R—d
(3)<<"\t"\

255 <<"Ouut:"<<
	`£tw
(6)<<
Ouut
<<"\n";

257 
	}
}

259 
	gCGRA_PE
::
	$D_Wr™eRegfe
(
add»ss
, 
v®ue
)

261 
RegFe
->
	`Wr™e
(
add»ss
,
v®ue
);

262 
	}
}

	@timingcgra/CGRAPE.h

8 
	~"CGRARegi¡”Fe.h
"

9 
	~"CGRAIn¡ruùiÚ.h
"

10 
	~"CGRA_MemÜyPÜt.h
"

13 #iâdeà
PE_H_


14 
	#PE_H_


	)

16 
	#CGRA_DEBUG


	)

18 
şass
 
	gCGRA_Regi¡”Fe
;

19 
şass
 
	gCGRA_In¡ruùiÚ
;

21 şas 
	cCGRA_PE


23 
	mpublic
:

24 
CGRA_PE
();

25 
	mvœtu®
 ~
CGRA_PE
();

28 
F‘ch
(
CGRA_In¡ruùiÚ
* 
šs
);

29 
Decode
();

30 
Execu‹
();

31 
Wr™eBack
();

33 
g‘Ouut
();

35 
S‘Neighbours
(
CGRA_PE
* 
Leá
,CGRA_PE* 
Right
,CGRA_PE* 
Up
,CGRA_PE* 
Down
);

37 
£tII
(
II
);

38 
advªûTime
();

39 
S‘CGRA_MemÜyPÜt
(
CGRA_MemÜyPÜt
 *
MP
);

40 
S‘CÚŒŞËr_Reg
(* 
»g
);

41 
D_R—dRegfe
();

42 
D_Wr™eRegfe
(
add»ss
, 
v®ue
);

43 
	m´iv©e
:

44 
CGRA_Regi¡”Fe
* 
RegFe
;

45 
	mCyşeCouÁ”
;

46 
	mII
;

47 
	mIÅut1
;

48 
	mIÅut2
;

49 
	mOuut
;

50 
CGRA_In¡ruùiÚ
* 
	mšs
;

52 
CGRA_PE
* 
	mLeáNeighbour
;

53 
CGRA_PE
* 
	mRightNeighbour
;

54 
CGRA_PE
* 
	mUpNeighbour
;

55 
CGRA_PE
* 
	mDownNeighbour
;

57 
CGRA_MemÜyPÜt
 *
	mMemÜyPÜt
;

59 * 
	mCÚŒŞËr_Reg
;

	@timingcgra/CGRARegisterFile.cpp

8 
	~"CGRARegi¡”Fe.h
"

10 
	gCGRA_Regi¡”Fe
::
	$CGRA_Regi¡”Fe
()

14 
d©a
 = 
Ãw
 [2*
REGFILESIZE
];

15 
di¡ªû
=0;

16 
i
=0;i<2*
REGFILESIZE
;i++)

18 
d©a
[
i
]=0;

22 
	}
}

24 
	gCGRA_Regi¡”Fe
::~
	$CGRA_Regi¡”Fe
()

26 
	`d–‘e
(
d©a
);

28 
	}
}

30 
	gCGRA_Regi¡”Fe
::
	$R—d
(
add»ss
)

32 ià(
add»ss
 >ğ2*
REGFILESIZE
)

34 
throw
 
Ãw
 
	`CGRAExû±iÚ
("Register‡ccess out of„ange");

39 if(
add»ss
 < 
REGFILESIZE
)

40  
d©a
[(
add»ss
+
di¡ªû
)%
REGFILESIZE
];

42  
d©a
[
add»ss
];

43 
	}
}

44 
	gCGRA_Regi¡”Fe
::
	$Wr™e
(
add»ss
, 
v®ue
)

46 ià(
add»ss
 >ğ2*
REGFILESIZE
)

48 
throw
 
Ãw
 
	`CGRAExû±iÚ
("Register‡ccess out of„ange");

54 if(
add»ss
 < 
REGFILESIZE
)

55 
d©a
[(
add»ss
+
di¡ªû
)%
REGFILESIZE
] = 
v®ue
;

57 
d©a
[
add»ss
] = 
v®ue
;

59 
	}
}

60 
	gCGRA_Regi¡”Fe
::
	$NextI‹¿tiÚ
()

62 
di¡ªû
++;

63 
di¡ªû
=di¡ªû%
REGFILESIZE
;

65 
	}
}

	@timingcgra/CGRARegisterFile.h

8 #iâdeà
REGISTERFILE_H_


9 
	#REGISTERFILE_H_


	)

11 
	~"CGRAdefš™iÚs.h
"

13 şas 
	cCGRA_Regi¡”Fe


15 
	mpublic
:

16 
CGRA_Regi¡”Fe
();

17 
	mvœtu®
 ~
CGRA_Regi¡”Fe
();

18 
R—d
(
add»ss
);

19 
Wr™e
(
add»ss
, 
v®ue
);

20 
NextI‹¿tiÚ
();

21 
	m´iv©e
:

22 *
d©a
;

24 
	mdi¡ªû
;

	@timingcgra/CGRA_MemoryPort.cpp

8 
	~"CGRA_MemÜyPÜt.h
"

10 
	gCGRA_MemÜyPÜt
::
	$CGRA_MemÜyPÜt
(* 
¡©usIÁ”çû
, * 
D©aBus
, 
ušt64_t
* 
add»ssBus
)

13 
this
->
¡©us
=
¡©usIÁ”çû
;

14 
this
->
d©a
 = 
D©aBus
;

15 
this
->
add»ss
 = 
add»ssBus
;

17 
	}
}

19 
	gCGRA_MemÜyPÜt
::~
	$CGRA_MemÜyPÜt
()

22 
	}
}

24 
CGRA_MemÜyPÜt
::
	$g‘Ouut
()

26  (*
d©a
);

27 
	}
}

28 
	gCGRA_MemÜyPÜt
::
	$£tD©a
(
d©a
)

30 (*
this
->
d©a
)=data;

31 
	}
}

32 
	gCGRA_MemÜyPÜt
::
	$£tAdd»ss
(
add»ss
)

34 (*
this
->
add»ss
)=address;

35 
	}
}

37 
	gCGRA_MemÜyPÜt
::
	$R—d
()

39 (*
¡©us
)=
CGRA_MEMORY_READ
;

40 
	}
}

41 
	gCGRA_MemÜyPÜt
::
	$Wr™e
()

43 (*
¡©us
)=
CGRA_MEMORY_WRITE
;

44 
	}
}

	@timingcgra/CGRA_MemoryPort.h

8 #iâdeà
CGRA_MEMORYPORT_H_


9 
	#CGRA_MEMORYPORT_H_


	)

10 
	~"CGRAD©aMemÜy.h
"

12 şas 
	cCGRA_MemÜyPÜt


14 
	mpublic
:

15 
CGRA_MemÜyPÜt
(* 
¡©usIÁeçû
, * 
D©aBus
, 
ušt64_t
* 
add»ssBus
);

16 
	mvœtu®
 ~
CGRA_MemÜyPÜt
();

17 
g‘Ouut
();

18 
£tD©a
(
d©a
);

19 
£tAdd»ss
(
add»ss
);

23 
R—d
();

24 
Wr™e
();

25 
	m´iv©e
:

26 * 
¡©us
;

27 * 
	md©a
;

28 
ušt64_t
* 
	madd»ss
;

	@timingcgra/CGRAdefinitions.h

8 #iâdeà
DEFINITIONS_H_


9 
	#DEFINITIONS_H_


	)

11 
	~"CGRAExû±iÚ.h
"

13 
	#IMEMSIZE
 10000000

	)

14 
	#DMEMSIZE
 100000

	)

15 
	#REGFILESIZE
 4

	)

17 
	#CGRA_XDim
 4

	)

18 
	#CGRA_YDim
 4

	)

20 
	#CGRA_MEMORY_READ
 1

	)

21 
	#CGRA_MEMORY_WRITE
 2

	)

29 
	#WIDTH_OPCODE
 0xf

	)

30 
	#WIDTH_PREDICT
 0x1

	)

31 
	#WIDTH_MUX
 0x7

	)

32 
	#WIDTH_REGISTER
 0x3

	)

33 
	#WIDTH_ENABLE
 0x1

	)

34 
	#WIDTH_IMMEDIATE
 0xfff

	)

36 
	#SHIFT_OPCODE
 28

	)

37 
	#SHIFT_PREDICT
 27

	)

38 
	#SHIFT_LMUX
 24

	)

39 
	#SHIFT_RMUX
 21

	)

40 
	#SHIFT_R1
 19

	)

41 
	#SHIFT_R2
 17

	)

42 
	#SHIFT_RW
 15

	)

43 
	#SHIFT_WE
 14

	)

44 
	#SHIFT_ABUS
 13

	)

45 
	#SHIFT_DBUS
 12

	)

46 
	#SHIFT_IMMEDIATE
 00

	)

48 
	#INS_OPCODE
 (
WIDTH_OPCODE
)<<
SHIFT_OPCODE


	)

49 
	#INS_PREDICT
 (
WIDTH_PREDICT
)<<
SHIFT_PREDICT


	)

50 
	#INS_LMUX
 (
WIDTH_MUX
)<<
SHIFT_LMUX


	)

51 
	#INS_RMUX
 (
WIDTH_MUX
)<<
SHIFT_RMUX


	)

52 
	#INS_R1
 (
WIDTH_REGISTER
)<<
SHIFT_R1


	)

53 
	#INS_R2
 (
WIDTH_REGISTER
)<<
SHIFT_R2


	)

54 
	#INS_RW
 (
WIDTH_REGISTER
)<<
SHIFT_RW


	)

55 
	#INS_WE
 (
WIDTH_ENABLE
)<<
SHIFT_WE


	)

56 
	#INS_AB
 (
WIDTH_ENABLE
)<<
SHIFT_ABUS


	)

57 
	#INS_DB
 (
WIDTH_ENABLE
)<<
SHIFT_DBUS


	)

58 
	#INS_IMMEDIATE
 (
WIDTH_IMMEDIATE
)<<
SHIFT_IMMEDIATE


	)

60 
	eOPCode


62 
	mAdd
=0,

63 
	mSub
,

64 
	mMuÉ
,

65 
	mAND
,

66 
	mOR
,

67 
	mXOR
,

69 
	mcg¿ASR
,

71 
	mNOOP
,

73 
	mcg¿ASL
,

75 
	mLDi
,

76 
	mLDMi
,

77 
	mLDUi
,

79 
	mEQ
,

80 
	mNEQ
,

81 
	mGT
,

82 
	mLT


85 
	ePEIÅutMux


87 
	mRegi¡”
=0,

88 
	mLeá
,

89 
	mRight
,

90 
	mUp
,

91 
	mDown
,

92 
	mD©aBus
,

93 
	mImmedŸ‹
,

94 
	mS–f


	@timingcgra/base.cc

44 
	~"¬ch/k”Ãl_¡©s.hh
"

45 
	~"¬ch/¡ackŒaû.hh
"

46 
	~"¬ch/b.hh
"

47 
	~"¬ch/ut™y.hh
"

48 
	~"¬ch/vtİhys.hh
"

49 
	~"ba£/lßd”/symb.hh
"

50 
	~"ba£/ı_ªnÙ©e.hh
"

51 
	~"ba£/ırštf.hh
"

52 
	~"ba£/šife.hh
"

53 
	~"ba£/misc.hh
"

54 
	~"ba£/pŞËv’t.hh
"

55 
	~"ba£/Œaû.hh
"

56 
	~"ba£/ty³s.hh
"

57 
	~"cÚfig/the_i§.hh
"

58 
	~"ıu/timšgcg¿/ba£.hh
"

59 
	~"ıu/ba£.hh
"

60 
	~"ıu/check”/ıu.hh
"

61 
	~"ıu/check”/th»ad_cÚ‹xt.hh
"

62 
	~"ıu/ex‘¿û.hh
"

63 
	~"ıu/´ofe.hh
"

64 
	~"ıu/sim¶e_th»ad.hh
"

65 
	~"ıu/smt.hh
"

66 
	~"ıu/¡©ic_š¡.hh
"

67 
	~"ıu/th»ad_cÚ‹xt.hh
"

68 
	~"debug/Decode.hh
"

69 
	~"debug/F‘ch.hh
"

70 
	~"debug/Qu›sû.hh
"

71 
	~"mem/mem_objeù.hh
"

72 
	~"mem/·ck‘.hh
"

73 
	~"mem/»que¡.hh
"

74 
	~"·¿ms/Ba£CGRA.hh
"

75 
	~"sim/by‹sw­.hh
"

76 
	~"sim/debug.hh
"

77 
	~"sim/çuÉs.hh
"

78 
	~"sim/fuÎ_sy¡em.hh
"

79 
	~"sim/sim_ev’ts.hh
"

80 
	~"sim/sim_objeù.hh
"

81 
	~"sim/¡©s.hh
"

82 
	~"sim/sy¡em.hh
"

84 
usšg
 
Çme¥aû
 
	g¡d
;

85 
usšg
 
Çme¥aû
 
	gTheISA
;

87 
	gBa£CGRA
::
	$Ba£CGRA
(
Ba£CGRAP¬ams
 *
p
)

88 : 
	`Ba£CPU
(
p
), 
	`ŒaûD©a
(
NULL
), 
	$th»ad
(
NULL
)

90 ià(
FuÎSy¡em
)

91 
th»ad
 = 
Ãw
 
	`Sim¶eTh»ad
(
this
, 0, 
p
->
sy¡em
,…->
™b
,…->
dtb
,

92 
p
->
i§
[0]);

94 
th»ad
 = 
Ãw
 
	`Sim¶eTh»ad
(
this
, 0, 
p
->
sy¡em
,

95 
p
->
wÜklßd
[0],…->
™b
,…->
dtb
,…->
i§
[0]);

97 
th»ad
->
	`£tStus
(
Th»adCÚ‹xt
::
H®‹d
);

99 
tc
 = 
th»ad
->
	`g‘TC
();

101 ià(
p
->
check”
) {

102 
Ba£CPU
 *
‹mp_check”
 = 
p
->
check”
;

103 
check”
 = 
dyÇmic_ÿ¡
<
Check”CPU
 *>(
‹mp_check”
);

104 
check”
->
	`£tSy¡em
(
p
->
sy¡em
);

106 
Th»adCÚ‹xt
 *
ıu_tc
 = 
tc
;

107 
tc
 = 
Ãw
 
Check”Th»adCÚ‹xt
<
Th»adCÚ‹xt
>(
ıu_tc
, 
this
->
check”
);

109 
check”
 = 
NULL
;

112 
numIn¡
 = 0;

113 
¡¬tNumIn¡
 = 0;

114 
numOp
 = 0;

115 
¡¬tNumOp
 = 0;

116 
numLßd
 = 0;

117 
¡¬tNumLßd
 = 0;

118 
Ï¡IÿcheSÎ
 = 0;

119 
Ï¡DÿcheSÎ
 = 0;

121 
th»adCÚ‹xts
.
	`push_back
(
tc
);

124 
ãtchOff£t
 = 0;

125 
¡ayAtPC
 = 
çl£
;

126 
	}
}

128 
	gBa£CGRA
::~
	$Ba£CGRA
()

130 
	}
}

133 
Ba£CGRA
::
	$d—Îoÿ‹CÚ‹xt
(
Th»adID
 
th»ad_num
)

136 
	`su¥’dCÚ‹xt
(
th»ad_num
);

137 
	}
}

141 
	gBa£CGRA
::
	$h®tCÚ‹xt
(
Th»adID
 
th»ad_num
)

144 
	`su¥’dCÚ‹xt
(
th»ad_num
);

145 
	}
}

149 
	gBa£CGRA
::
	$»gSts
()

151 
usšg
 
Çme¥aû
 
Sts
;

153 
Ba£CPU
::
	`»gSts
();

155 
numIn¡s


156 .
	`Çme
(name() + ".committedInsts")

157 .
	`desc
("Number of instructions committed")

160 
numOps


161 .
	`Çme
(name() + ".committedOps")

162 .
	`desc
("Number of ops (including micro ops) committed")

165 
numIÁAluAcûs£s


166 .
	`Çme
(name() + ".num_int_alu_accesses")

167 .
	`desc
("Number of integer‡lu‡ccesses")

170 
numFpAluAcûs£s


171 .
	`Çme
(name() + ".num_fp_alu_accesses")

172 .
	`desc
("Number of float‡lu‡ccesses")

175 
numC®lsR‘uºs


176 .
	`Çme
(name() + ".num_func_calls")

177 .
	`desc
("number ofimes‡ function call or„eturn occured")

180 
numCÚdCŒlIn¡s


181 .
	`Çme
(name() + ".num_conditional_control_insts")

182 .
	`desc
("number of instructionshat‡re conditional controls")

185 
numIÁIn¡s


186 .
	`Çme
(name() + ".num_int_insts")

187 .
	`desc
("number of integer instructions")

190 
numFpIn¡s


191 .
	`Çme
(name() + ".num_fp_insts")

192 .
	`desc
("number of float instructions")

195 
numIÁRegR—ds


196 .
	`Çme
(name() + ".num_int_register_reads")

197 .
	`desc
("number ofimeshe integer„egisters were„ead")

200 
numIÁRegWr™es


201 .
	`Çme
(name() + ".num_int_register_writes")

202 .
	`desc
("number ofimeshe integer„egisters were written")

205 
numFpRegR—ds


206 .
	`Çme
(name() + ".num_fp_register_reads")

207 .
	`desc
("number ofimeshe floating„egisters were„ead")

210 
numFpRegWr™es


211 .
	`Çme
(name() + ".num_fp_register_writes")

212 .
	`desc
("number ofimeshe floating„egisters were written")

215 
numCCRegR—ds


216 .
	`Çme
(name() + ".num_cc_register_reads")

217 .
	`desc
("number ofimeshe CC„egisters were„ead")

218 .
	`æags
(
noz”o
)

221 
numCCRegWr™es


222 .
	`Çme
(name() + ".num_cc_register_writes")

223 .
	`desc
("number ofimeshe CC„egisters were written")

224 .
	`æags
(
noz”o
)

227 
numMemRefs


228 .
	`Çme
(name()+".num_mem_refs")

229 .
	`desc
("number of memory„efs")

232 
numStÜeIn¡s


233 .
	`Çme
(name() + ".num_store_insts")

234 .
	`desc
("Number of store instructions")

237 
numLßdIn¡s


238 .
	`Çme
(name() + ".num_load_insts")

239 .
	`desc
("Number of†oad instructions")

242 
nÙIdËF¿ùiÚ


243 .
	`Çme
(name() + ".not_idle_fraction")

244 .
	`desc
("Percentage of‚on-idle cycles")

247 
idËF¿ùiÚ


248 .
	`Çme
(name() + ".idle_fraction")

249 .
	`desc
("Percentage of idle cycles")

252 
numBusyCyşes


253 .
	`Çme
(name() + ".num_busy_cycles")

254 .
	`desc
("Number of busy cycles")

257 
numIdËCyşes


258 .
	`Çme
(name()+".num_idle_cycles")

259 .
	`desc
("Number of idle cycles")

262 
iÿcheSÎCyşes


263 .
	`Çme
(name() + ".icache_stall_cycles")

264 .
	`desc
("ICacheotal stall cycles")

265 .
	`´”eq
(
iÿcheSÎCyşes
)

268 
dÿcheSÎCyşes


269 .
	`Çme
(name() + ".dcache_stall_cycles")

270 .
	`desc
("DCacheotal stall cycles")

271 .
	`´”eq
(
dÿcheSÎCyşes
)

274 
iÿcheR‘ryCyşes


275 .
	`Çme
(name() + ".icache_retry_cycles")

276 .
	`desc
("ICacheotal„etry cycles")

277 .
	`´”eq
(
iÿcheR‘ryCyşes
)

280 
dÿcheR‘ryCyşes


281 .
	`Çme
(name() + ".dcache_retry_cycles")

282 .
	`desc
("DCacheotal„etry cycles")

283 .
	`´”eq
(
dÿcheR‘ryCyşes
)

286 
idËF¿ùiÚ
 = 
	`cÚ¡ªt
(1.0è- 
nÙIdËF¿ùiÚ
;

287 
numIdËCyşes
 = 
idËF¿ùiÚ
 * 
numCyşes
;

288 
numBusyCyşes
 = (
nÙIdËF¿ùiÚ
)*
numCyşes
;

289 
	}
}

292 
	gBa£CGRA
::
	$»£tSts
()

295 
nÙIdËF¿ùiÚ
 = (
_¡©us
 !ğ
IdË
);

296 
	}
}

299 
	gBa£CGRA
::
	$£rŸlizeTh»ad
(
o¡»am
 &
os
, 
Th»adID
 
tid
)

301 
	`as£¹
(
_¡©us
 =ğ
IdË
 || _¡©u =ğ
RuÂšg
);

302 
	`as£¹
(
tid
 == 0);

304 
th»ad
->
	`£rŸlize
(
os
);

305 
	}
}

308 
	gBa£CGRA
::
	$un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡ršg
 &
£ùiÚ
,

309 
Th»adID
 
tid
)

311 ià(
tid
 != 0)

312 
	`çl
("Tryingo†oad morehan onehread into‡ SimpleCPU\n");

313 
th»ad
->
	`un£rŸlize
(
ı
, 
£ùiÚ
);

314 
	}
}

322 
Addr


323 
	gBa£CGRA
::
	$dbg_vtİhys
(
Addr
 
addr
)

325  
	`vtİhys
(
tc
, 
addr
);

326 
	}
}

329 
	gBa£CGRA
::
	$wakeup
()

331 ià(
th»ad
->
	`¡©us
(è!ğ
Th»adCÚ‹xt
::
Su¥’ded
)

334 
	`DPRINTF
(
Qu›sû
,"Suspended Processor‡woke\n");

335 
th»ad
->
	`aùiv©e
();

336 
	}
}

339 
	gBa£CGRA
::
	$checkFÜIÁ”ru±s
()

341 ià(
	`checkIÁ”ru±s
(
tc
)) {

342 
FauÉ
 
š‹¼u±
 = 
š‹¼u±s
->
	`g‘IÁ”ru±
(
tc
);

344 ià(
š‹¼u±
 !ğ
NoFauÉ
) {

345 
ãtchOff£t
 = 0;

346 
š‹¼u±s
->
	`upd©eIÁrInfo
(
tc
);

347 
š‹¼u±
->
	`švoke
(
tc
);

348 
th»ad
->
decod”
.
	`»£t
();

351 
	}
}

355 
	gBa£CGRA
::
	$£tupF‘chReque¡
(
Reque¡
 *
»q
)

357 
Addr
 
š¡Addr
 = 
th»ad
->
	`š¡Addr
();

360 
	`DPRINTF
(
F‘ch
, "F‘ch: PC:%08p\n", 
š¡Addr
);

362 
Addr
 
ãtchPC
 = (
š¡Addr
 & 
PCMask
è+ 
ãtchOff£t
;

363 
»q
->
	`£tVœt
(0, 
ãtchPC
, (
MachIn¡
), 
Reque¡
::
INST_FETCH
, 
	`š¡Ma¡”Id
(),

364 
š¡Addr
);

365 
	}
}

369 
	gBa£CGRA
::
	$´eExecu‹
()

372 
th»ad
->
	`£tIÁReg
(
Z”oReg
, 0);

373 #ià
THE_ISA
 =ğ
ALPHA_ISA


374 
th»ad
->
	`£tFlßtReg
(
Z”oReg
, 0.0);

378 
comIn¡Ev’tQueue
[0]->
	`£rviûEv’ts
(
numIn¡
);

379 
sy¡em
->
š¡Ev’tQueue
.
	`£rviûEv’ts
(sy¡em->
tÙ®NumIn¡s
);

382 
š¡
 = 
	`gtoh
(inst);

384 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

386 ià(
	`isRomMiüoPC
(
pcS‹
.
	`miüoPC
())) {

387 
¡ayAtPC
 = 
çl£
;

388 
curSticIn¡
 = 
miüocodeRom
.
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
(),

389 
curMaüoSticIn¡
);

390 } ià(!
curMaüoSticIn¡
) {

392 
SticIn¡PŒ
 
š¡PŒ
 = 
NULL
;

394 
TheISA
::
Decod”
 *
decod”
 = &(
th»ad
->decoder);

398 
Addr
 
ãtchPC
 = (
pcS‹
.
	`š¡Addr
(è& 
PCMask
è+ 
ãtchOff£t
;

400 
decod”
->
	`mÜeBy‹s
(
pcS‹
, 
ãtchPC
, 
š¡
);

406 
š¡PŒ
 = 
decod”
->
	`decode
(
pcS‹
);

407 ià(
š¡PŒ
) {

408 
¡ayAtPC
 = 
çl£
;

409 
th»ad
->
	`pcS‹
(
pcS‹
);

411 
¡ayAtPC
 = 
Œue
;

412 
ãtchOff£t
 +ğ(
MachIn¡
);

417 ià(
š¡PŒ
 && in¡PŒ->
	`isMaüoİ
()) {

418 
curMaüoSticIn¡
 = 
š¡PŒ
;

419 
curSticIn¡
 = 
curMaüoSticIn¡
->
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
());

421 
curSticIn¡
 = 
š¡PŒ
;

425 
curSticIn¡
 = 
curMaüoSticIn¡
->
	`ãtchMiüoİ
(
pcS‹
.
	`miüoPC
());

429 ià(
curSticIn¡
) {

430 #ià
TRACING_ON


431 
ŒaûD©a
 = 
Œaûr
->
	`g‘In¡RecÜd
(
	`curTick
(), 
tc
,

432 
curSticIn¡
, 
th»ad
->
	`pcS‹
(), 
curMaüoSticIn¡
);

434 
	`DPRINTF
(
Decode
,"Decode: Decoded %s instruction: %#x\n",

435 
curSticIn¡
->
	`g‘Name
(), curSticIn¡->
machIn¡
);

438 
	}
}

441 
	gBa£CGRA
::
	$po¡Execu‹
()

443 
	`as£¹
(
curSticIn¡
);

445 
TheISA
::
PCS‹
 
pc
 = 
tc
->
	`pcS‹
();

446 
Addr
 
š¡Addr
 = 
pc
.
	`š¡Addr
();

447 ià(
FuÎSy¡em
 && 
th»ad
->
´ofe
) {

448 
boŞ
 
u£rmode
 = 
TheISA
::
	`šU£rMode
(
tc
);

449 
th»ad
->
´ofePC
 = 
u£rmode
 ? 1 : 
š¡Addr
;

450 
ProfeNode
 *
node
 = 
th»ad
->
´ofe
->
	`cÚsume
(
tc
, 
curSticIn¡
);

451 ià(
node
)

452 
th»ad
->
´ofeNode
 = 
node
;

455 ià(
curSticIn¡
->
	`isMemRef
()) {

456 
numMemRefs
++;

459 ià(
curSticIn¡
->
	`isLßd
()) {

460 ++
numLßd
;

461 
comLßdEv’tQueue
[0]->
	`£rviûEv’ts
(
numLßd
);

464 ià(
CPA
::
	`avaabË
()) {

465 
CPA
::
	`ıa
()->
	`swAutoBegš
(
tc
, 
pc
.
	`ÃxtIn¡Addr
());

470 ià(
curSticIn¡
->
	`isIÁeg”
()){

471 
numIÁAluAcûs£s
++;

472 
numIÁIn¡s
++;

476 ià(
curSticIn¡
->
	`isFlßtšg
()){

477 
numFpAluAcûs£s
++;

478 
numFpIn¡s
++;

482 ià(
curSticIn¡
->
	`isC®l
(è|| curSticIn¡->
	`isR‘uº
()){

483 
numC®lsR‘uºs
++;

487 ià(
curSticIn¡
->
	`isCÚdCŒl
()){

488 
numCÚdCŒlIn¡s
++;

492 ià(
curSticIn¡
->
	`isLßd
()){

493 
numLßdIn¡s
++;

496 ià(
curSticIn¡
->
	`isStÜe
()){

497 
numStÜeIn¡s
++;

501 ià(
FuÎSy¡em
)

502 
	`ŒaûFunùiÚs
(
š¡Addr
);

504 ià(
ŒaûD©a
) {

505 
ŒaûD©a
->
	`dump
();

506 
d–‘e
 
ŒaûD©a
;

507 
ŒaûD©a
 = 
NULL
;

509 
	}
}

513 
	gBa£CGRA
::
	$advªûPC
(
FauÉ
 
çuÉ
)

516 
ãtchOff£t
 = 0;

517 ià(
çuÉ
 !ğ
NoFauÉ
) {

518 
curMaüoSticIn¡
 = 
SticIn¡
::
nuÎSticIn¡PŒ
;

519 
çuÉ
->
	`švoke
(
tc
, 
curSticIn¡
);

520 
th»ad
->
decod”
.
	`»£t
();

522 ià(
curSticIn¡
) {

523 ià(
curSticIn¡
->
	`isLa¡Miüoİ
())

524 
curMaüoSticIn¡
 = 
SticIn¡
::
nuÎSticIn¡PŒ
;

525 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

526 
TheISA
::
	`advªûPC
(
pcS‹
, 
curSticIn¡
);

527 
th»ad
->
	`pcS‹
(
pcS‹
);

530 
	}
}

533 
	gBa£CGRA
::
	$¡¬tup
()

535 
Ba£CPU
::
	`¡¬tup
();

536 
th»ad
->
	`¡¬tup
();

537 
	}
}

	@timingcgra/base.hh

46 #iâdeà
__CGRA_BASE_HH__


47 
	#__CGRA_BASE_HH__


	)

49 
	~"ba£/¡©i¡ics.hh
"

50 
	~"cÚfig/the_i§.hh
"

51 
	~"ıu/ba£.hh
"

52 
	~"ıu/check”/ıu.hh
"

53 
	~"ıu/pc_ev’t.hh
"

54 
	~"ıu/sim¶e_th»ad.hh
"

55 
	~"ıu/¡©ic_š¡.hh
"

56 
	~"mem/·ck‘.hh
"

57 
	~"mem/pÜt.hh
"

58 
	~"mem/»que¡.hh
"

59 
	~"sim/ev’tq.hh
"

60 
	~"sim/fuÎ_sy¡em.hh
"

61 
	~"sim/sy¡em.hh
"

64 
şass
 
	gCheckpošt
;

65 
şass
 
	gProûss
;

66 
şass
 
	gProûssÜ
;

67 
şass
 
	gTh»adCÚ‹xt
;

69 
Çme¥aû
 
	gTheISA


71 
şass
 
	gDTB
;

72 
şass
 
	gITB
;

75 
Çme¥aû
 
	gT¿û
 {

76 
şass
 
	gIn¡RecÜd
;

79 
	gBa£CGRAP¬ams
;

82 şas 
	cBa£CGRA
 : 
public
 
Ba£CPU


84 
´Ùeùed
:

85 
TheISA
::
	tMiscReg
 MiscReg;

86 
	mTheISA
::
	tFlßtReg
 FloatReg;

87 
	mTheISA
::
	tFlßtRegB™s
 FloatRegBits;

88 
	mTheISA
::
	tCCReg
 CCReg;

90 
	m´Ùeùed
:

91 
T¿û
::
In¡RecÜd
 *
ŒaûD©a
;

93 
šlše
 
	$checkPcEv’tQueue
() {

94 
Addr
 
Şdpc
, 
pc
 = 
th»ad
->
	`š¡Addr
();

96 
Şdpc
 = 
pc
;

97 
sy¡em
->
pcEv’tQueue
.
	`£rviû
(
tc
);

98 
pc
 = 
th»ad
->
	`š¡Addr
();

99 } 
Şdpc
 !ğ
pc
);

102 
public
:

103 
	`wakeup
();

105 
	$z”o_fl_64
(
Addr
 
addr
) {

106 
w¬Ãd
 = 0;

107 ià(!
w¬Ãd
) {

108 
	`w¬n
 ("WH64 is‚ot implemented");

109 
w¬Ãd
 = 1;

111 
	}
};

113 
	gpublic
:

114 
Ba£CGRA
(
Ba£CGRAP¬ams
 *
·¿ms
);

115 
	gvœtu®
 ~
Ba£CGRA
();

117 
	gpublic
:

119 
Sim¶eTh»ad
 *
th»ad
;

124 
Th»adCÚ‹xt
 *
	gtc
;

126 
Check”CPU
 *
	gcheck”
;

128 
	g´Ùeùed
:

130 
	eStus
 {

131 
IdË
,

132 
	gRuÂšg
,

133 
	gFauÉšg
,

134 
	gITBWa™Re¥Ú£
,

135 
	gIÿcheR‘ry
,

136 
	gIÿcheWa™Re¥Ú£
,

137 
	gIÿcheWa™Sw™ch
,

138 
	gDTBWa™Re¥Ú£
,

139 
	gDÿcheR‘ry
,

140 
	gDÿcheWa™Re¥Ú£
,

141 
	gDÿcheWa™Sw™ch
,

144 
Stus
 
	g_¡©us
;

146 
	gpublic
:

148 
Addr
 
dbg_vtİhys
(Add¸
addr
);

150 
boŞ
 
	gš‹rv®_¡©s
;

153 
	gTheISA
::
MachIn¡
 
š¡
;

155 
SticIn¡PŒ
 
	gcurSticIn¡
;

156 
SticIn¡PŒ
 
	gcurMaüoSticIn¡
;

159 
Addr
 
	gãtchOff£t
;

162 
boŞ
 
	g¡ayAtPC
;

164 
checkFÜIÁ”ru±s
();

165 
£tupF‘chReque¡
(
Reque¡
 *
»q
);

166 
´eExecu‹
();

167 
po¡Execu‹
();

168 
advªûPC
(
FauÉ
 
çuÉ
);

170 
vœtu®
 
d—Îoÿ‹CÚ‹xt
(
Th»adID
 
th»ad_num
);

171 
vœtu®
 
h®tCÚ‹xt
(
Th»adID
 
th»ad_num
);

174 
vœtu®
 
»gSts
();

175 
vœtu®
 
»£tSts
();

177 
vœtu®
 
¡¬tup
();

180 
CouÁ”
 
	gnumIn¡
;

181 
CouÁ”
 
	g¡¬tNumIn¡
;

182 
	gSts
::
SÿÏr
 
numIn¡s
;

183 
CouÁ”
 
	gnumOp
;

184 
CouÁ”
 
	g¡¬tNumOp
;

185 
	gSts
::
SÿÏr
 
numOps
;

187 
	$couÁIn¡
()

189 ià(!
curSticIn¡
->
	`isMiüoİ
(è|| curSticIn¡->
	`isLa¡Miüoİ
()) {

190 
numIn¡
++;

191 
numIn¡s
++;

193 
numOp
++;

194 
numOps
++;

196 
sy¡em
->
tÙ®NumIn¡s
++;

197 
th»ad
->
funcExeIn¡
++;

198 
	}
}

200 
vœtu®
 
CouÁ”
 
	$tÙ®In¡s
() const

202  
numIn¡
 - 
¡¬tNumIn¡
;

203 
	}
}

205 
vœtu®
 
CouÁ”
 
	$tÙ®Ops
() const

207  
numOp
 - 
¡¬tNumOp
;

208 
	}
}

211 
	gSts
::
SÿÏr
 
numIÁAluAcûs£s
;

214 
	gSts
::
SÿÏr
 
numFpAluAcûs£s
;

217 
	gSts
::
SÿÏr
 
numC®lsR‘uºs
;

220 
	gSts
::
SÿÏr
 
numCÚdCŒlIn¡s
;

223 
	gSts
::
SÿÏr
 
numIÁIn¡s
;

226 
	gSts
::
SÿÏr
 
numFpIn¡s
;

229 
	gSts
::
SÿÏr
 
numIÁRegR—ds
;

230 
	gSts
::
SÿÏr
 
numIÁRegWr™es
;

233 
	gSts
::
SÿÏr
 
numFpRegR—ds
;

234 
	gSts
::
SÿÏr
 
numFpRegWr™es
;

237 
	gSts
::
SÿÏr
 
numCCRegR—ds
;

238 
	gSts
::
SÿÏr
 
numCCRegWr™es
;

241 
	gSts
::
SÿÏr
 
numMemRefs
;

242 
	gSts
::
SÿÏr
 
numLßdIn¡s
;

243 
	gSts
::
SÿÏr
 
numStÜeIn¡s
;

246 
	gSts
::
FÜmuÏ
 
numIdËCyşes
;

249 
	gSts
::
FÜmuÏ
 
numBusyCyşes
;

252 
CouÁ”
 
	gnumLßd
;

253 
CouÁ”
 
	g¡¬tNumLßd
;

256 
	gSts
::
Av”age
 
nÙIdËF¿ùiÚ
;

257 
	gSts
::
FÜmuÏ
 
idËF¿ùiÚ
;

260 
	gSts
::
SÿÏr
 
iÿcheSÎCyşes
;

261 
CouÁ”
 
	gÏ¡IÿcheSÎ
;

264 
	gSts
::
SÿÏr
 
iÿcheR‘ryCyşes
;

265 
CouÁ”
 
	gÏ¡IÿcheR‘ry
;

268 
	gSts
::
SÿÏr
 
dÿcheSÎCyşes
;

269 
CouÁ”
 
	gÏ¡DÿcheSÎ
;

272 
	gSts
::
SÿÏr
 
dÿcheR‘ryCyşes
;

273 
CouÁ”
 
	gÏ¡DÿcheR‘ry
;

275 
£rŸlizeTh»ad
(
¡d
::
o¡»am
 &
os
, 
Th»adID
 
tid
);

276 
un£rŸlizeTh»ad
(
Checkpošt
 *
ı
, cÚ¡ 
¡d
::
¡ršg
 &
£ùiÚ
,

277 
Th»adID
 
tid
);

281 
	$£tEA
(
Addr
 
EA
è{ 
	`·nic
("Ba£CGRA::£tEA(ènÙ im¶em’‹d\n"); 
	}
}

282 
Addr
 
	$g‘EA
(è{ 
	`·nic
("BaseCGRA::getEA()‚ot implemented\n");

283 
M5_DUMMY_RETURN
}

296 
ušt64_t
 
	$»adIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

298 
numIÁRegR—ds
++;

299  
th»ad
->
	`»adIÁReg
(
si
->
	`¤cRegIdx
(
idx
));

300 
	}
}

302 
FlßtReg
 
	$»adFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

304 
numFpRegR—ds
++;

305 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

306  
th»ad
->
	`»adFlßtReg
(
»g_idx
);

307 
	}
}

309 
FlßtRegB™s
 
	$»adFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

311 
numFpRegR—ds
++;

312 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

313  
th»ad
->
	`»adFlßtRegB™s
(
»g_idx
);

314 
	}
}

316 
CCReg
 
	$»adCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

318 
numCCRegR—ds
++;

319 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
CC_Reg_Ba£
;

320  
th»ad
->
	`»adCCReg
(
»g_idx
);

321 
	}
}

323 
	$£tIÁRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
ušt64_t
 
v®
)

325 
numIÁRegWr™es
++;

326 
th»ad
->
	`£tIÁReg
(
si
->
	`de¡RegIdx
(
idx
), 
v®
);

327 
	}
}

329 
	$£tFlßtRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
FlßtReg
 
v®
)

331 
numFpRegWr™es
++;

332 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

333 
th»ad
->
	`£tFlßtReg
(
»g_idx
, 
v®
);

334 
	}
}

336 
	$£tFlßtRegO³¿ndB™s
(cÚ¡ 
SticIn¡
 *
si
, 
idx
,

337 
FlßtRegB™s
 
v®
)

339 
numFpRegWr™es
++;

340 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
FP_Reg_Ba£
;

341 
th»ad
->
	`£tFlßtRegB™s
(
»g_idx
, 
v®
);

342 
	}
}

344 
	$£tCCRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
, 
CCReg
 
v®
)

346 
numCCRegWr™es
++;

347 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
CC_Reg_Ba£
;

348 
th»ad
->
	`£tCCReg
(
»g_idx
, 
v®
);

349 
	}
}

351 
boŞ
 
	$»adP»diÿ‹
(è{  
th»ad
->
	`»adP»diÿ‹
(); 
	}
}

352 
	$£tP»diÿ‹
(
boŞ
 
v®
)

354 
th»ad
->
	`£tP»diÿ‹
(
v®
);

355 ià(
ŒaûD©a
) {

356 
ŒaûD©a
->
	`£tP»diÿ‹
(
v®
);

358 
	}
}

359 
	gTheISA
::
PCS‹
 
	$pcS‹
(è{  
th»ad
->
	`pcS‹
(); 
	}
}

360 
pcS‹
(cÚ¡ 
TheISA
::
PCS‹
 &
v®
è{ 
th»ad
->pcState(val); }

361 
Addr
 
	$š¡Addr
(è{  
th»ad
->
	`š¡Addr
(); 
	}
}

362 
Addr
 
	$ÃxtIn¡Addr
(è{  
th»ad
->
	`ÃxtIn¡Addr
(); 
	}
}

363 
MiüoPC
 
	$miüoPC
(è{  
th»ad
->
	`miüoPC
(); 
	}
}

365 
MiscReg
 
	$»adMiscRegNoEfãù
(
misc_»g
)

367  
th»ad
->
	`»adMiscRegNoEfãù
(
misc_»g
);

368 
	}
}

370 
MiscReg
 
	$»adMiscReg
(
misc_»g
)

372 
numIÁRegR—ds
++;

373  
th»ad
->
	`»adMiscReg
(
misc_»g
);

374 
	}
}

376 
	$£tMiscReg
(
misc_»g
, cÚ¡ 
MiscReg
 &
v®
)

378 
numIÁRegWr™es
++;

379  
th»ad
->
	`£tMiscReg
(
misc_»g
, 
v®
);

380 
	}
}

382 
MiscReg
 
	$»adMiscRegO³¿nd
(cÚ¡ 
SticIn¡
 *
si
, 
idx
)

384 
numIÁRegR—ds
++;

385 
»g_idx
 = 
si
->
	`¤cRegIdx
(
idx
è- 
TheISA
::
Misc_Reg_Ba£
;

386  
th»ad
->
	`»adMiscReg
(
»g_idx
);

387 
	}
}

389 
	$£tMiscRegO³¿nd
(

390 cÚ¡ 
SticIn¡
 *
si
, 
idx
, cÚ¡ 
MiscReg
 &
v®
)

392 
numIÁRegWr™es
++;

393 
»g_idx
 = 
si
->
	`de¡RegIdx
(
idx
è- 
TheISA
::
Misc_Reg_Ba£
;

394  
th»ad
->
	`£tMiscReg
(
»g_idx
, 
v®
);

395 
	}
}

397 
	$dem­Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

399 
th»ad
->
	`dem­Page
(
vaddr
, 
a¢
);

400 
	}
}

402 
	$dem­In¡Page
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

404 
th»ad
->
	`dem­In¡Page
(
vaddr
, 
a¢
);

405 
	}
}

407 
	$dem­D©aPage
(
Addr
 
vaddr
, 
ušt64_t
 
a¢
)

409 
th»ad
->
	`dem­D©aPage
(
vaddr
, 
a¢
);

410 
	}
}

412 
	$»adStCÚdFau»s
() {

413  
th»ad
->
	`»adStCÚdFau»s
();

414 
	}
}

416 
	$£tStCÚdFau»s
(
sc_çu»s
) {

417 
th»ad
->
	`£tStCÚdFau»s
(
sc_çu»s
);

418 
	}
}

420 
MiscReg
 
	$»adRegOth”Th»ad
(
»gIdx
, 
Th»adID
 
tid
 = 
Inv®idTh»adID
)

422 
	`·nic
("Simple CPU models do‚ot support multithreaded "

424 
	}
}

426 
	$£tRegOth”Th»ad
(
»gIdx
, cÚ¡ 
MiscReg
 &
v®
,

427 
Th»adID
 
tid
 = 
Inv®idTh»adID
)

429 
	`·nic
("Simple CPU models do‚ot support multithreaded "

431 
	}
}

435 
FauÉ
 
	$hw»i
(è{  
th»ad
->
	`hw»i
(); 
	}
}

436 
boŞ
 
	$simP®Check
(
·lFunc
è{  
th»ad
->
	`simP®Check
Õ®Func); 
	}
}

439 
	$sysÿÎ
(
št64_t
 
ÿÎnum
)

441 ià(
FuÎSy¡em
)

442 
	`·nic
("Syscallƒmulation isn't‡vailable in FS mode.\n");

444 
th»ad
->
	`sysÿÎ
(
ÿÎnum
);

445 
	}
}

447 
boŞ
 
	$mis¥ecuÏtšg
(è{  
th»ad
->
	`mis¥ecuÏtšg
(); 
	}
}

448 
Th»adCÚ‹xt
 *
	$tcBa£
(è{  
tc
; 
	}
}

	@timingcgra/timingcgra.cc

43 
	~"¬ch/locked_mem.hh
"

44 
	~"¬ch/mm­³d_r.hh
"

45 
	~"¬ch/ut™y.hh
"

46 
	~"ba£/bigšt.hh
"

47 
	~"cÚfig/the_i§.hh
"

48 
	~"ıu/timšgcg¿/timšgcg¿.hh
"

49 
	~"ıu/ex‘¿û.hh
"

50 
	~"debug/CÚfig.hh
"

51 
	~"debug/D¿š.hh
"

52 
	~"debug/ExecFauÉšg.hh
"

53 
	~"debug/Sim¶eCPU.hh
"

54 
	~"mem/·ck‘.hh
"

55 
	~"mem/·ck‘_acûss.hh
"

56 
	~"·¿ms/TimšgCGRA.hh
"

57 
	~"sim/çuÉs.hh
"

58 
	~"sim/fuÎ_sy¡em.hh
"

59 
	~"sim/sy¡em.hh
"

61 
usšg
 
Çme¥aû
 
	g¡d
;

62 
usšg
 
Çme¥aû
 
	gTheISA
;

65 
	gTimšgCGRA
::
	$š™
()

67 
Ba£CPU
::
	`š™
();

70 
	`tcBa£
()->
	`š™MemProx›s
(tcBase());

72 ià(
FuÎSy¡em
 && !
	`·¿ms
()->
sw™ched_out
) {

73 
i
 = 0; i < 
th»adCÚ‹xts
.
	`size
(); ++i) {

74 
Th»adCÚ‹xt
 *
tc
 = 
th»adCÚ‹xts
[
i
];

76 
TheISA
::
	`š™CPU
(
tc
, 
_ıuId
);

79 
	}
}

82 
	gTimšgCGRA
::
TimšgCPUPÜt
::
TickEv’t
::
	$scheduË
(
Pack‘PŒ
 
_pkt
, 
Tick
 
t
)

84 
pkt
 = 
_pkt
;

85 
ıu
->
	`scheduË
(
this
, 
t
);

86 
	}
}

89 
	gTimšgCGRA
::
	$TimšgCGRA
(
TimšgCGRAP¬ams
 *
p
)

90 : 
	`Ba£CGRA
(
p
), 
	`ãtchT¿n¦©iÚ
(
this
), 
	`iÿchePÜt
(this),

91 
	`dÿchePÜt
(
this
),
	`dÿchePÜt1
Ñhis,"1"),
	`dÿchePÜt2
Ñhis,"2"),
	`dÿchePÜt3
Ñhis,"3"),
	`dÿchePÜt4
Ñhis,"4"), 
	`iãtch_pkt
(
NULL
), 
	`dÿche_pkt
(NULL), 
	`´eviousCyşe
(0),

92 
	`ãtchEv’t
(
this
), 
	$d¿šMªag”
(
NULL
)

94 
_¡©us
 = 
IdË
;

96 
sy¡em
->
tÙ®NumIn¡s
 = 0;

99 
CGRA_Mode
 = 0;

100 
	`S‘up_CGRA
();

101 
	`´štf
("CGRA instantiated\n");

103 
	`´štf
("\nMa¡” PORT ID %d\n",
	`d©aMa¡”Id
());

104 
	`´štf
("\nPORT ID %d\n",
dÿchePÜt
.
	`g‘Id
());

105 
	`´štf
("\nPORT1 ID %d\n",
dÿchePÜt1
.
	`g‘Id
());

106 
	`´štf
("\nPORT2 ID %d\n",
dÿchePÜt2
.
	`g‘Id
());

107 
	`´štf
("\nPORT3 ID %d\n",
dÿchePÜt3
.
	`g‘Id
());

108 
	`´štf
("\nPORT4 ID %d\n",
dÿchePÜt4
.
	`g‘Id
());

111 
	}
}

114 
	gTimšgCGRA
::~
	$TimšgCGRA
()

116 
	}
}

119 
TimšgCGRA
::
	$d¿š
(
D¿šMªag”
 *
d¿š_mªag”
)

121 
	`as£¹
(!
d¿šMªag”
);

122 ià(
	`sw™chedOut
())

125 ià(
_¡©us
 =ğ
IdË
 ||

126 (
_¡©us
 =ğ
Ba£CGRA
::
RuÂšg
 && 
	`isD¿šed
())) {

127 
	`DPRINTF
(
D¿š
, "No‚eedo drain.\n");

130 
d¿šMªag”
 = 
d¿š_mªag”
;

131 
	`DPRINTF
(
D¿š
, "Reque¡šg d¿š: %s\n", 
	`pcS‹
());

136 ià(
_¡©us
 =ğ
Ba£CGRA
::
RuÂšg
 && !
ãtchEv’t
.
	`scheduËd
())

137 
	`scheduË
(
ãtchEv’t
, 
	`şockEdge
());

141 
	}
}

144 
	gTimšgCGRA
::
	$d¿šResume
()

146 
	`as£¹
(!
ãtchEv’t
.
	`scheduËd
());

147 
	`as£¹
(!
d¿šMªag”
);

148 ià(
	`sw™chedOut
())

151 
	`DPRINTF
(
Sim¶eCPU
, "Resume\n");

152 
	`v”ifyMemÜyMode
();

154 
	`as£¹
(!
th»adCÚ‹xts
.
	`em±y
());

155 ià(
th»adCÚ‹xts
.
	`size
() > 1)

156 
	`çl
("Theiming CPU only supports onehread.\n");

158 ià(
th»ad
->
	`¡©us
(è=ğ
Th»adCÚ‹xt
::
Aùive
) {

159 
	`scheduË
(
ãtchEv’t
, 
	`ÃxtCyşe
());

160 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

161 
nÙIdËF¿ùiÚ
 = 1;

163 
_¡©us
 = 
Ba£CGRA
::
IdË
;

164 
nÙIdËF¿ùiÚ
 = 0;

166 
	}
}

168 
boŞ


169 
	gTimšgCGRA
::
	$ŒyCom¶‘eD¿š
()

171 ià(!
d¿šMªag”
)

172  
çl£
;

174 
	`DPRINTF
(
D¿š
, "ŒyCom¶‘eD¿š: %s\n", 
	`pcS‹
());

175 ià(!
	`isD¿šed
())

176  
çl£
;

178 
	`DPRINTF
(
D¿š
, "CPU done draining,…rocessing drainƒvent\n");

179 
d¿šMªag”
->
	`sigÇlD¿šDÚe
();

180 
d¿šMªag”
 = 
NULL
;

182  
Œue
;

183 
	}
}

186 
	gTimšgCGRA
::
	$sw™chOut
()

188 
Ba£CGRA
::
	`sw™chOut
();

190 
	`as£¹
(!
ãtchEv’t
.
	`scheduËd
());

191 
	`as£¹
(
_¡©us
 =ğ
Ba£CGRA
::
RuÂšg
 || _¡©u =ğ
IdË
);

192 
	`as£¹
(!
¡ayAtPC
);

193 
	`as£¹
(
	`miüoPC
() == 0);

195 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

196 
	}
}

200 
	gTimšgCGRA
::
	$keOv”From
(
Ba£CPU
 *
ŞdCPU
)

202 
Ba£CGRA
::
	`keOv”From
(
ŞdCPU
);

204 
´eviousCyşe
 = 
	`curCyşe
();

205 
	}
}

208 
	gTimšgCGRA
::
	$v”ifyMemÜyMode
() const

210 ià(!
sy¡em
->
	`isTimšgMode
()) {

211 
	`çl
("Theiming CPU„equireshe memory systemo be in "

214 
	}
}

217 
	gTimšgCGRA
::
	$aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
)

219 
	`DPRINTF
(
Sim¶eCPU
, "Aùiv©eCÚ‹xˆ%d (%d cyşes)\n", 
th»ad_num
, 
d–ay
);

221 
	`as£¹
(
th»ad_num
 == 0);

222 
	`as£¹
(
th»ad
);

224 
	`as£¹
(
_¡©us
 =ğ
IdË
);

226 
nÙIdËF¿ùiÚ
 = 1;

227 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

230 
	`scheduË
(
ãtchEv’t
, 
	`şockEdge
(
d–ay
));

231 
	}
}

235 
	gTimšgCGRA
::
	$su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
)

237 
	`DPRINTF
(
Sim¶eCPU
, "Su¥’dCÚ‹xˆ%d\n", 
th»ad_num
);

239 
	`as£¹
(
th»ad_num
 == 0);

240 
	`as£¹
(
th»ad
);

242 ià(
_¡©us
 =ğ
IdË
)

245 
	`as£¹
(
_¡©us
 =ğ
Ba£CGRA
::
RuÂšg
);

250 
nÙIdËF¿ùiÚ
 = 0;

251 
_¡©us
 = 
IdË
;

252 
	}
}

255 
boŞ


256 
	gTimšgCGRA
::
	$hªdËR—dPack‘
(
Pack‘PŒ
 
pkt
)

258 
Reque¡PŒ
 
»q
 = 
pkt
->req;

259 ià(
»q
->
	`isMm­³dI´
()) {

260 
Cyşes
 
d–ay
 = 
TheISA
::
	`hªdËI´R—d
(
th»ad
->
	`g‘TC
(), 
pkt
);

261 
Ãw
 
	`I´Ev’t
(
pkt
, 
this
, 
	`şockEdge
(
d–ay
));

262 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

263 
dÿche_pkt
 = 
NULL
;

264 } ià(!
dÿchePÜt
.
	`£ndTimšgReq
(
pkt
)) {

265 
_¡©us
 = 
DÿcheR‘ry
;

266 
dÿche_pkt
 = 
pkt
;

268 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

270 
dÿche_pkt
 = 
NULL
;

272  
dÿche_pkt
 =ğ
NULL
;

273 
	}
}

276 
	gTimšgCGRA
::
	$£ndD©a
(
Reque¡PŒ
 
»q
, 
ušt8_t
 *
d©a
, 
ušt64_t
 *
»s
,
boŞ
 
»ad
)

278 
Pack‘PŒ
 
pkt
;

279 
	`budPack‘
(
pkt
, 
»q
, 
»ad
);

280 
pkt
->
d©aDyÇmicA¼ay
<
ušt8_t
>(
d©a
);

281 ià(
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

282 
	`as£¹
(!
dÿche_pkt
);

283 
pkt
->
	`makeRe¥Ú£
();

284 
	`com¶‘eD©aAcûss
(
pkt
);

285 } ià(
»ad
) {

286 
	`hªdËR—dPack‘
(
pkt
);

288 
boŞ
 
do_acûss
 = 
Œue
;

290 ià(
»q
->
	`isLLSC
()) {

291 
do_acûss
 = 
TheISA
::
	`hªdËLockedWr™e
(
th»ad
, 
»q
);

292 } ià(
»q
->
	`isCÚdSw­
()) {

293 
	`as£¹
(
»s
);

294 
»q
->
	`£tExŒaD©a
(*
»s
);

297 ià(
do_acûss
) {

298 
dÿche_pkt
 = 
pkt
;

299 
	`hªdËWr™ePack‘
();

301 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

302 
	`com¶‘eD©aAcûss
(
pkt
);

305 
	}
}

309 
	gTimšgCGRA
::
	$£ndS¶™D©a
(
Reque¡PŒ
 
»q1
, Reque¡PŒ 
»q2
,

310 
Reque¡PŒ
 
»q
, 
ušt8_t
 *
d©a
, 
boŞ
 
»ad
)

312 
Pack‘PŒ
 
pkt1
, 
pkt2
;

313 
	`budS¶™Pack‘
(
pkt1
, 
pkt2
, 
»q1
, 
»q2
, 
»q
, 
d©a
, 
»ad
);

314 ià(
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

315 
	`as£¹
(!
dÿche_pkt
);

316 
pkt1
->
	`makeRe¥Ú£
();

317 
	`com¶‘eD©aAcûss
(
pkt1
);

318 } ià(
»ad
) {

319 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 =

320 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(
pkt1
->
£nd”S‹
);

321 ià(
	`hªdËR—dPack‘
(
pkt1
)) {

322 
£nd_¡©e
->
	`ş—rFromP¬’t
();

323 
£nd_¡©e
 = 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(

324 
pkt2
->
£nd”S‹
);

325 ià(
	`hªdËR—dPack‘
(
pkt2
)) {

326 
£nd_¡©e
->
	`ş—rFromP¬’t
();

330 
dÿche_pkt
 = 
pkt1
;

331 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 =

332 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(
pkt1
->
£nd”S‹
);

333 ià(
	`hªdËWr™ePack‘
()) {

334 
£nd_¡©e
->
	`ş—rFromP¬’t
();

335 
dÿche_pkt
 = 
pkt2
;

336 
£nd_¡©e
 = 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(

337 
pkt2
->
£nd”S‹
);

338 ià(
	`hªdËWr™ePack‘
()) {

339 
£nd_¡©e
->
	`ş—rFromP¬’t
();

343 
	}
}

346 
	gTimšgCGRA
::
	$Œª¦©iÚFauÉ
(
FauÉ
 
çuÉ
)

350 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

351 
´eviousCyşe
 = 
	`curCyşe
();

353 ià(
ŒaûD©a
) {

355 
d–‘e
 
ŒaûD©a
;

356 
ŒaûD©a
 = 
NULL
;

359 
	`po¡Execu‹
();

361 
	`advªûIn¡
(
çuÉ
);

362 
	}
}

364 
	gTimšgCGRA
::
	$budPack‘
(
Pack‘PŒ
 &
pkt
, 
Reque¡PŒ
 
»q
, 
boŞ
 
»ad
)

366 
MemCmd
 
cmd
;

367 ià(
»ad
) {

368 
cmd
 = 
MemCmd
::
R—dReq
;

369 ià(
»q
->
	`isLLSC
())

370 
cmd
 = 
MemCmd
::
LßdLockedReq
;

372 
cmd
 = 
MemCmd
::
Wr™eReq
;

373 ià(
»q
->
	`isLLSC
()) {

374 
cmd
 = 
MemCmd
::
StÜeCÚdReq
;

375 } ià(
»q
->
	`isSw­
()) {

376 
cmd
 = 
MemCmd
::
Sw­Req
;

379 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
cmd
);

380 
	}
}

383 
	gTimšgCGRA
::
	$budS¶™Pack‘
(
Pack‘PŒ
 &
pkt1
, Pack‘PŒ &
pkt2
,

384 
Reque¡PŒ
 
»q1
, Reque¡PŒ 
»q2
, Reque¡PŒ 
»q
,

385 
ušt8_t
 *
d©a
, 
boŞ
 
»ad
)

387 
pkt1
 = 
pkt2
 = 
NULL
;

389 
	`as£¹
(!
»q1
->
	`isMm­³dI´
(è&& !
»q2
->isMmappedIpr());

391 ià(
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
)) {

392 
	`budPack‘
(
pkt1
, 
»q
, 
»ad
);

396 
	`budPack‘
(
pkt1
, 
»q1
, 
»ad
);

397 
	`budPack‘
(
pkt2
, 
»q2
, 
»ad
);

399 
»q
->
	`£tPhys
(
»q1
->
	`g‘Paddr
(),„eq->
	`g‘Size
(),„eq1->
	`g‘FÏgs
(), 
	`d©aMa¡”Id
());

400 
Pack‘PŒ
 
pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
pkt1
->
cmd
.
	`»¥Ú£Commªd
());

402 
pkt
->
d©aDyÇmicA¼ay
<
ušt8_t
>(
d©a
);

403 
pkt1
->
d©aStic
<
ušt8_t
>(
d©a
);

404 
pkt2
->
d©aStic
<
ušt8_t
>(
d©a
 + 
»q1
->
	`g‘Size
());

406 
S¶™MašS’d”S‹
 * 
maš_£nd_¡©e
 = 
Ãw
 SplitMainSenderState;

407 
pkt
->
£nd”S‹
 = 
maš_£nd_¡©e
;

408 
maš_£nd_¡©e
->
äagm’ts
[0] = 
pkt1
;

409 
maš_£nd_¡©e
->
äagm’ts
[1] = 
pkt2
;

410 
maš_£nd_¡©e
->
out¡ªdšg
 = 2;

411 
pkt1
->
£nd”S‹
 = 
Ãw
 
	`S¶™F¿gm’tS’d”S‹
(
pkt
, 0);

412 
pkt2
->
£nd”S‹
 = 
Ãw
 
	`S¶™F¿gm’tS’d”S‹
(
pkt
, 1);

413 
	}
}

415 
FauÉ
 
	gTimšgCGRA
::
	$»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
,
size
, 
æags
)

417  
	`»adMem
(
addr
,
d©a
,
size
,
æags
,-1);

418 
	}
}

419 
FauÉ
 
	gTimšgCGRA
::
	$»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
,
size
, 
æags
, 
ydim
)

421 
	`´štf
("%s,%s,%d ydim: %d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,
ydim
,(è
tc
->
	`š¡Addr
());

422 
FauÉ
 
çuÉ
;

423 cÚ¡ 
asid
 = 0;

424 cÚ¡ 
Th»adID
 
tid
 = 0;

425 cÚ¡ 
Addr
 
pc
 = 
th»ad
->
	`š¡Addr
();

426 
block_size
 = 
	`ÿcheLšeSize
();

427 
Ba£TLB
::
Mode
 
mode
 = Ba£TLB::
R—d
;

429 ià(
ŒaûD©a
) {

430 
ŒaûD©a
->
	`£tAddr
(
addr
);

433 
Reque¡PŒ
 
»q
 = 
Ãw
 
	`Reque¡
(
asid
, 
addr
, 
size
,

434 
æags
, 
	`d©aMa¡”Id
(), 
pc
, 
_ıuId
, 
tid
);

436 
Addr
 
¥l™_addr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
block_size
);

437 
	`as£¹
(
¥l™_addr
 <ğ
addr
 || s¶™_add¸-‡dd¸< 
block_size
);

439 
_¡©us
 = 
DTBWa™Re¥Ú£
;

440 ià(
¥l™_addr
 > 
addr
) {

441 
Reque¡PŒ
 
»q1
, 
»q2
;

442 
	`as£¹
(!
»q
->
	`isLLSC
(è&& !»q->
	`isSw­
());

443 
»q
->
	`¥l™OnVaddr
(
¥l™_addr
, 
»q1
, 
»q2
);

445 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 =

446 
Ãw
 
	`WhŞeT¿n¦©iÚS‹
(
»q
, 
»q1
, 
»q2
,‚ew 
ušt8_t
[
size
],

447 
NULL
, 
mode
);

448 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *> *
Œªs1
 =

449 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *>(
this
, 
¡©e
, 0);

450 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *> *
Œªs2
 =

451 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *>(
this
, 
¡©e
, 1);

453 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q1
, 
tc
, 
Œªs1
, 
mode
);

454 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q2
, 
tc
, 
Œªs2
, 
mode
);

456 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 = 
Ãw
 
	`WhŞeT¿n¦©iÚS‹
(
»q
,‚ew 
ušt8_t
[
size
], 
NULL
, 
mode
);

458 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *> *
Œª¦©iÚ
 = 
Ãw
 D©aT¿n¦©iÚ<TimšgCGRA *>(
this
, 
¡©e
);

460 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q
, 
tc
, 
Œª¦©iÚ
, 
mode
);

463  
NoFauÉ
;

464 
	}
}

468 
boŞ


469 
	gTimšgCGRA
::
	$hªdËWr™ePack‘
()

471 
Reque¡PŒ
 
»q
 = 
dÿche_pkt
->req;

472 ià(
»q
->
	`isMm­³dI´
()) {

473 
Cyşes
 
d–ay
 = 
TheISA
::
	`hªdËI´Wr™e
(
th»ad
->
	`g‘TC
(), 
dÿche_pkt
);

474 
Ãw
 
	`I´Ev’t
(
dÿche_pkt
, 
this
, 
	`şockEdge
(
d–ay
));

475 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

476 
dÿche_pkt
 = 
NULL
;

477 } ià(!
dÿchePÜt
.
	`£ndTimšgReq
(
dÿche_pkt
)) {

478 
_¡©us
 = 
DÿcheR‘ry
;

480 
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

482 
dÿche_pkt
 = 
NULL
;

484  
dÿche_pkt
 =ğ
NULL
;

485 
	}
}

487 
FauÉ
 
	gTimšgCGRA
::
	$wr™eMem
(
ušt8_t
 *
d©a
, 
size
,
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
)

489  
	`wr™eMem
(
d©a
,
size
,
addr
,
æags
,
»s
,-1);

490 
	}
}

491 
FauÉ
 
	gTimšgCGRA
::
	$wr™eMem
(
ušt8_t
 *
d©a
, 
size
,
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
,
ydim
)

493 
	`´štf
("%s,%s,%d ydim: %d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,
ydim
,(è
tc
->
	`š¡Addr
());

494 
ušt8_t
 *
ÃwD©a
 = 
Ãw
 ušt8_t[
size
];

495 
	`memıy
(
ÃwD©a
, 
d©a
, 
size
);

497 cÚ¡ 
asid
 = 0;

498 cÚ¡ 
Th»adID
 
tid
 = 0;

499 cÚ¡ 
Addr
 
pc
 = 
th»ad
->
	`š¡Addr
();

500 
block_size
 = 
	`ÿcheLšeSize
();

501 
Ba£TLB
::
Mode
 
mode
 = Ba£TLB::
Wr™e
;

503 ià(
ŒaûD©a
) {

504 
ŒaûD©a
->
	`£tAddr
(
addr
);

507 
Reque¡PŒ
 
»q
 = 
Ãw
 
	`Reque¡
(
asid
, 
addr
, 
size
,

508 
æags
, 
	`d©aMa¡”Id
(), 
pc
, 
_ıuId
, 
tid
);

510 
Addr
 
¥l™_addr
 = 
	`roundDown
(
addr
 + 
size
 - 1, 
block_size
);

511 
	`as£¹
(
¥l™_addr
 <ğ
addr
 || s¶™_add¸-‡dd¸< 
block_size
);

513 
_¡©us
 = 
DTBWa™Re¥Ú£
;

514 ià(
¥l™_addr
 > 
addr
) {

515 
Reque¡PŒ
 
»q1
, 
»q2
;

516 
	`as£¹
(!
»q
->
	`isLLSC
(è&& !»q->
	`isSw­
());

517 
»q
->
	`¥l™OnVaddr
(
¥l™_addr
, 
»q1
, 
»q2
);

519 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 =

520 
Ãw
 
	`WhŞeT¿n¦©iÚS‹
(
»q
, 
»q1
, 
»q2
, 
ÃwD©a
, 
»s
, 
mode
);

521 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *> *
Œªs1
 =

522 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *>(
this
, 
¡©e
, 0);

523 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *> *
Œªs2
 =

524 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *>(
this
, 
¡©e
, 1);

526 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q1
, 
tc
, 
Œªs1
, 
mode
);

527 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q2
, 
tc
, 
Œªs2
, 
mode
);

529 
WhŞeT¿n¦©iÚS‹
 *
¡©e
 =

530 
Ãw
 
	`WhŞeT¿n¦©iÚS‹
(
»q
, 
ÃwD©a
, 
»s
, 
mode
);

531 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *> *
Œª¦©iÚ
 =

532 
Ãw
 
D©aT¿n¦©iÚ
<
TimšgCGRA
 *>(
this
, 
¡©e
);

533 
th»ad
->
dtb
->
	`Œª¦©eTimšg
(
»q
, 
tc
, 
Œª¦©iÚ
, 
mode
);

537  
NoFauÉ
;

538 
	}
}

542 
	gTimšgCGRA
::
	$fšishT¿n¦©iÚ
(
WhŞeT¿n¦©iÚS‹
 *
¡©e
)

544 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

546 ià(
¡©e
->
	`g‘FauÉ
(è!ğ
NoFauÉ
) {

547 ià(
¡©e
->
	`isP»ãtch
()) {

548 
¡©e
->
	`£tNoFauÉ
();

550 
d–‘e
 [] 
¡©e
->
d©a
;

551 
¡©e
->
	`d–‘eReqs
();

552 
	`Œª¦©iÚFauÉ
(
¡©e
->
	`g‘FauÉ
());

554 ià(!
¡©e
->
isS¶™
) {

555 
	`£ndD©a
(
¡©e
->
mašReq
, s‹->
d©a
, s‹->
»s
,

556 
¡©e
->
mode
 =ğ
Ba£TLB
::
R—d
);

558 
	`£ndS¶™D©a
(
¡©e
->
¤eqLow
, s‹->
¤eqHigh
, s‹->
mašReq
,

559 
¡©e
->
d©a
, s‹->
mode
 =ğ
Ba£TLB
::
R—d
);

563 
d–‘e
 
¡©e
;

564 
	}
}

567 
	gTimšgCGRA
::
	$ãtch
()

569 
	`DPRINTF
(
Sim¶eCPU
, "Fetch\n");

571 ià(!
curSticIn¡
 || !curSticIn¡->
	`isD–ayedComm™
())

572 
	`checkFÜIÁ”ru±s
();

574 
	`checkPcEv’tQueue
();

577 ià(
_¡©us
 =ğ
IdË
)

580 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

581 
boŞ
 
ÃedToF‘ch
 = !
	`isRomMiüoPC
(
pcS‹
.
	`miüoPC
()è&& !
curMaüoSticIn¡
;

584 if(!
	`is_CPU
())

586 
i
 = 0; i < 
CGRA_YDim
; i++)

588 
MemBusStus
[
i
] = 0;

591 
MemAcûssCouÁ
 = 0;

592 
AcûssCouÁ
 = 0;

595 ià(
ÃedToF‘ch
) {

596 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

597 
Reque¡
 *
iãtch_»q
 = 
Ãw
 
	`Reque¡
();

598 
iãtch_»q
->
	`£tTh»adCÚ‹xt
(
_ıuId
, 0);

599 
	`£tupF‘chReque¡
(
iãtch_»q
);

600 
	`DPRINTF
(
Sim¶eCPU
, "T¿n¦©šg‡dd»s %#x\n", 
iãtch_»q
->
	`g‘Vaddr
());

601 
th»ad
->
™b
->
	`Œª¦©eTimšg
(
iãtch_»q
, 
tc
, &
ãtchT¿n¦©iÚ
,

602 
Ba£TLB
::
Execu‹
);

604 
_¡©us
 = 
IÿcheWa™Re¥Ú£
;

605 
	`com¶‘eIãtch
(
NULL
);

606 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

607 
´eviousCyşe
 = 
	`curCyşe
();

611 
	}
}

614 
	gTimšgCGRA
::
	$£ndF‘ch
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
)

617 ià(
çuÉ
 =ğ
NoFauÉ
) {

618 
	`DPRINTF
(
Sim¶eCPU
, "Sending fetch for‡ddr %#x(pa: %#x)\n",

619 
»q
->
	`g‘Vaddr
(),„eq->
	`g‘Paddr
());

620 
iãtch_pkt
 = 
Ãw
 
	`Pack‘
(
»q
, 
MemCmd
::
R—dReq
);

622 ià(
	`is_CPU
())

623 
iãtch_pkt
->
	`d©aStic
(&
š¡
);

625 
iãtch_pkt
->
	`d©aStic
(
CGRA_š¡ruùiÚs
);

627 
	`DPRINTF
(
Sim¶eCPU
, " --…kˆaddr: %#x\n", 
iãtch_pkt
->
	`g‘Addr
());

629 ià(!
iÿchePÜt
.
	`£ndTimšgReq
(
iãtch_pkt
)) {

631 
_¡©us
 = 
IÿcheR‘ry
;

634 
_¡©us
 = 
IÿcheWa™Re¥Ú£
;

636 
iãtch_pkt
 = 
NULL
;

639 
	`DPRINTF
(
Sim¶eCPU
, "T¿n¦©iÚ oàadd¸%#x fauÉed\n", 
»q
->
	`g‘Vaddr
());

640 
d–‘e
 
»q
;

642 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

643 
	`advªûIn¡
(
çuÉ
);

646 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

647 
´eviousCyşe
 = 
	`curCyşe
();

648 
	}
}

652 
	gTimšgCGRA
::
	$advªûIn¡
(
FauÉ
 
çuÉ
)

655 
Th»adCÚ‹xt
 *
tc
 = 
th»adCÚ‹xts
[0];

657 ià(
	`is_CPU
())

660 ià((è
tc
->
	`»adIÁReg
(11) == 15)

662 
	`´štf
("************************Setting UPhe CGRA************\n");

663 
	`S‘up_CGRA_ExecutiÚ
();

664 if(
PrŞog
>0 || 
K”ÃlCouÁ”
>0 || 
EPILog
>0)

666 
	`Sw™ch_To_CGRA
();

667 
	`»scheduË
(
ãtchEv’t
, 
	`ÃxtCyşe
(), 
Œue
);

672 
	`P»·»_to_Sw™ch_Back_to_CPU
();

673 
	`Re¡Üe_CPU_ExecutiÚ
();

674 
	`Sw™ch_To_CPU
();

675 
TimšgCGRA
::
	`advªûIn¡
(
çuÉ
);

684 ià(
_¡©us
 =ğ
FauÉšg
)

687 ià(
çuÉ
 !ğ
NoFauÉ
) {

688 
	`advªûPC
(
çuÉ
);

689 
	`DPRINTF
(
Sim¶eCPU
, "Fault occured, scheduling fetchƒvent\n");

690 
	`»scheduË
(
ãtchEv’t
, 
	`şockEdge
(), 
Œue
);

691 
_¡©us
 = 
FauÉšg
;

696 ià(!
¡ayAtPC
)

697 
	`advªûPC
(
çuÉ
);

699 ià(
	`ŒyCom¶‘eD¿š
())

702 ià(
_¡©us
 =ğ
Ba£CGRA
::
RuÂšg
) {

706 
	`ãtch
();

713 
	`´štf
("advanceInst CGRA MODE\n");

714 if(
L’
==0)

716 if(
¡©e
==
EPI
)

717 
¡©e
=
FINISH
;

720 if(
¡©e
==
FINISH
)

722 
	`´štf
("************************PREPARING TO MOVE TO CPU************\n");

723 
	`P»·»_to_Sw™ch_Back_to_CPU
();

727 ià((è
tc
->
	`»adIÁReg
(8) == 66)

729 
	`´štf
("ÃwPC=%ld, II=%ld, EPILog=%ld, PrŞog=%ld, L’=%ld\n", (è
ÃwPC
, (è
II
, (è
EPILog
, (è
PrŞog
, (è
L’
);

730 
	`´štf
("**********************CGRA Execution is over**********************\n");

731 
	`Re¡Üe_CPU_ExecutiÚ
();

732 
	`Sw™ch_To_CPU
();

733 
	`´štf
("******REG R11ğ%d*********\n",()
tc
->
	`»adIÁReg
(11));

734 
	`´štf
("AFTER COMPLETETION PC: %x\n",(è
tc
->
	`š¡Addr
());

735 
TimšgCGRA
::
	`advªûIn¡
(
çuÉ
);

739 
	`CGRA_advªûIn¡
(
çuÉ
);

743 
	}
}

747 
	gTimšgCGRA
::
	$CGRA_com¶‘eIãtch
(
Pack‘PŒ
 
pkt
)

749 
memAcûssFÏg
=0;

753 
L’
--;

754 
	`as£¹
(!
pkt
 || !pkt->
	`isE¼Ü
());

755 
	`as£¹
(
_¡©us
 =ğ
IÿcheWa™Re¥Ú£
);

756 
	`´štf
("sizoàd©¨i %d\n", 
pkt
->
	`g‘Size
());

759 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

761 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

762 
´eviousCyşe
 = 
	`curCyşe
();

765 ià(
	`g‘D¿šS‹
(è=ğ
D¿šabË
::
D¿ššg
)

767 ià(
pkt
)

769 
d–‘e
 
pkt
->
»q
;

770 
d–‘e
 
pkt
;

773 
	`com¶‘eD¿š
();

778 
i
 = 0; i < 
CGRA_YDim
; i++)

780 
j
 = 0; j < 
CGRA_XDim
; j++)

782 
CGRA_In¡ruùiÚ
 *
cu¼’tIns
 = 
Ãw
 
	`CGRA_In¡ruùiÚ
(
CGRA_š¡ruùiÚs
[
i
 * 
CGRA_XDim
 + 
j
]);

783 
cg¿_PEs
[
i
 * 
CGRA_YDim
 + 
j
].
	`F‘ch
(
cu¼’tIns
);

789 
i
 = 0; i < 
CGRA_YDim
; i++)

791 
j
 = 0; j < 
CGRA_XDim
; j++)

793 
cg¿_PEs
[
i
 * 
CGRA_YDim
 + 
j
].
	`Decode
();

798 
i
 = 0; i < 
CGRA_YDim
; i++)

800 
j
 = 0; j < 
CGRA_XDim
; j++)

802 
cg¿_PEs
[
i
 * 
CGRA_YDim
 + 
j
].
	`Execu‹
();

807 
i
 = 0; i < 
CGRA_YDim
; i++)

809 
j
 = 0; j < 
CGRA_XDim
; j++)

811 
cg¿_PEs
[
i
 * 
CGRA_YDim
 + 
j
].
	`Wr™eBack
();

816 
i
 = 0; i < 
CGRA_YDim
; i++)

818 ià(
MemBusStus
[
i
] =ğ
CGRA_MEMORY_READ
)

820 
memAcûssFÏg
=1;

821 
	`´štf
("%s,%s,%d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,(è
tc
->
	`š¡Addr
());

822 
	`»adMem
((
Addr
è
MemAdd»ss
[
i
], (
ušt8_t
 *è&
MemD©a
[i], () 4, () 163,i);

823 
MemAcûssCouÁ
++;

825 ià(
MemBusStus
[
i
] =ğ
CGRA_MEMORY_WRITE
)

827 
memAcûssFÏg
=1;

828 
	`´štf
("%s,%s,%d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,(è
tc
->
	`š¡Addr
());

829 
	`wr™eMem
((
ušt8_t
 *è&
MemD©a
[
i
], (è4, (
Addr
è
MemAdd»ss
[i], (è131, 
unknownRes
,i);

830 
MemAcûssCouÁ
++;

835 if(!
memAcûssFÏg
)

836 
	`advªûIn¡
(
NoFauÉ
);

839 ià(
pkt
)

841 
d–‘e
 
pkt
->
»q
;

842 
d–‘e
 
pkt
;

937 
	}
}

947 
	gTimšgCGRA
::
	$com¶‘eIãtch
(
Pack‘PŒ
 
pkt
)

951 ià(
	`is_CPU
())

954 
	`DPRINTF
(
Sim¶eCPU
, "Com¶‘ICachF‘ch fÜ‡dd¸%#x\n", 
pkt
 ?

955 
pkt
->
	`g‘Addr
() : 0);

960 
	`as£¹
(!
pkt
 || !pkt->
	`isE¼Ü
());

961 
	`as£¹
(
_¡©us
 =ğ
IÿcheWa™Re¥Ú£
);

963 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

965 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

966 
´eviousCyşe
 = 
	`curCyşe
();

968 
	`´eExecu‹
();

969 ià(
curSticIn¡
 && curSticIn¡->
	`isMemRef
()) {

971 
FauÉ
 
çuÉ
 = 
curSticIn¡
->
	`š™Ÿ‹Acc
(
this
, 
ŒaûD©a
);

976 ià(
_¡©us
 =ğ
Ba£CGRA
::
RuÂšg
) {

977 ià(
çuÉ
 !ğ
NoFauÉ
 && 
ŒaûD©a
) {

979 
d–‘e
 
ŒaûD©a
;

980 
ŒaûD©a
 = 
NULL
;

983 
	`po¡Execu‹
();

985 ià(
curSticIn¡
 && (!curSticIn¡->
	`isMiüoİ
() ||

986 
curSticIn¡
->
	`isFœ¡Miüoİ
()))

987 
š¡CÁ
++;

988 
	`advªûIn¡
(
çuÉ
);

990 } ià(
curSticIn¡
) {

992 
FauÉ
 
çuÉ
 = 
curSticIn¡
->
	`execu‹
(
this
, 
ŒaûD©a
);

995 ià(
çuÉ
 =ğ
NoFauÉ
)

996 
	`couÁIn¡
();

997 ià(
ŒaûD©a
 && !
	`DTRACE
(
ExecFauÉšg
)) {

998 
d–‘e
 
ŒaûD©a
;

999 
ŒaûD©a
 = 
NULL
;

1002 
	`po¡Execu‹
();

1004 ià(
curSticIn¡
 && (!curSticIn¡->
	`isMiüoİ
() ||

1005 
curSticIn¡
->
	`isFœ¡Miüoİ
()))

1006 
š¡CÁ
++;

1007 
	`advªûIn¡
(
çuÉ
);

1009 
	`advªûIn¡
(
NoFauÉ
);

1012 ià(
pkt
) {

1013 
d–‘e
 
pkt
->
»q
;

1014 
d–‘e
 
pkt
;

1019 
	`CGRA_com¶‘eIãtch
(
pkt
);

1026 
	}
}

1029 
	gTimšgCGRA
::
IÿchePÜt
::
ITickEv’t
::
	$´oûss
()

1031 
ıu
->
	`com¶‘eIãtch
(
pkt
);

1032 
	}
}

1034 
boŞ


1035 
	gTimšgCGRA
::
IÿchePÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

1037 
	`DPRINTF
(
Sim¶eCPU
, "Reûivedimšg„e¥Ú£ %#x\n", 
pkt
->
	`g‘Addr
());

1040 if(
ıu
->
CGRA_Mode
 == 0)

1042 
Tick
 
Ãxt_tick
 = 
ıu
->
	`şockEdge
();

1044 ià(
Ãxt_tick
 =ğ
	`curTick
())

1045 
ıu
->
	`com¶‘eIãtch
(
pkt
);

1047 
tickEv’t
.
	`scheduË
(
pkt
, 
Ãxt_tick
);

1051 
ıu
->
	`com¶‘eIãtch
(
pkt
);

1054  
Œue
;

1055 
	}
}

1057 
	gTimšgCGRA
::
IÿchePÜt
::
	$»cvR‘ry
()

1061 
	`as£¹
(
ıu
->
iãtch_pkt
 !ğ
NULL
);

1062 
	`as£¹
(
ıu
->
_¡©us
 =ğ
IÿcheR‘ry
);

1063 
Pack‘PŒ
 
tmp
 = 
ıu
->
iãtch_pkt
;

1064 ià(
	`£ndTimšgReq
(
tmp
)) {

1065 
ıu
->
_¡©us
 = 
IÿcheWa™Re¥Ú£
;

1066 
ıu
->
iãtch_pkt
 = 
NULL
;

1068 
	}
}

1072 
	gTimšgCGRA
::
	$CGRA_com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
)

1075 
	`´štf
("%s,%s,%d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,(è
tc
->
	`š¡Addr
());

1078 
	`as£¹
(!
pkt
->
	`isE¼Ü
());

1079 
	`as£¹
(
_¡©us
 =ğ
DÿcheWa™Re¥Ú£
 || _¡©u =ğ
DTBWa™Re¥Ú£
 || 
pkt
->
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
));

1080 
AcûssCouÁ
++;

1082 ià(
pkt
->
£nd”S‹
)

1084 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 = 
dyÇmic_ÿ¡
<S¶™F¿gm’tS’d”S‹ *>(
pkt
->
£nd”S‹
);

1085 
	`as£¹
(
£nd_¡©e
);

1086 
d–‘e
 
pkt
->
»q
;

1087 
d–‘e
 
pkt
;

1088 
Pack‘PŒ
 
big_pkt
 = 
£nd_¡©e
->
bigPkt
;

1089 
d–‘e
 
£nd_¡©e
;

1091 
S¶™MašS’d”S‹
 * 
maš_£nd_¡©e
 = 
dyÇmic_ÿ¡
<S¶™MašS’d”S‹ *>(
big_pkt
->
£nd”S‹
);

1092 
	`as£¹
(
maš_£nd_¡©e
);

1094 
	`as£¹
(
maš_£nd_¡©e
->
out¡ªdšg
 != 0);

1095 
maš_£nd_¡©e
->
out¡ªdšg
--;

1097 ià(
maš_£nd_¡©e
->
out¡ªdšg
)

1103 
d–‘e
 
maš_£nd_¡©e
;

1104 
big_pkt
->
£nd”S‹
 = 
NULL
;

1105 
pkt
 = 
big_pkt
;

1109 ià(
AcûssCouÁ
 =ğ
MemAcûssCouÁ
)

1112 
	`´štf
("%s,%s,%d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,(è
tc
->
	`š¡Addr
());

1113 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

1114 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

1115 
´eviousCyşe
 = 
	`curCyşe
();

1117 
i
 = 0; i < 
CGRA_YDim
; i++)

1119 
Addr
 
vœddr
=
pkt
->
»q
->
	`g‘Vaddr
();

1120 *
‹mpd©a
=(*)
pkt
->
d©a
;

1121 ià(
MemBusStus
[
i
] =ğ
CGRA_MEMORY_READ
)

1122 if(
vœddr
==
MemAdd»ss
[
i
])

1123 
MemD©a
[
i
]=*
‹mpd©a
;

1125 
d–‘e
 
pkt
->
»q
;

1126 
	`´štf
("%s,%s,%d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,(è
tc
->
	`š¡Addr
());

1127 
d–‘e
 
pkt
;

1129 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

1130 
´eviousCyşe
 = 
	`curCyşe
();

1132 ià(
AcûssCouÁ
 =ğ
MemAcûssCouÁ
)

1134 
	`´štf
("%s,%s,%d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,(è
tc
->
	`š¡Addr
());

1135 
	`advªûIn¡
 (
NoFauÉ
);

1139 
	}
}

1143 
	gTimšgCGRA
::
	$com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
)

1145 ià(
	`is_CPU
())

1150 
	`as£¹
(!
pkt
->
	`isE¼Ü
());

1151 
	`as£¹
(
_¡©us
 =ğ
DÿcheWa™Re¥Ú£
 || _¡©u =ğ
DTBWa™Re¥Ú£
 ||

1152 
pkt
->
»q
->
	`g‘FÏgs
().
	`isS‘
(
Reque¡
::
NO_ACCESS
));

1154 
numCyşes
 +ğ
	`curCyşe
(è- 
´eviousCyşe
;

1155 
´eviousCyşe
 = 
	`curCyşe
();

1157 ià(
pkt
->
£nd”S‹
) {

1158 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 =

1159 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(
pkt
->
£nd”S‹
);

1160 
	`as£¹
(
£nd_¡©e
);

1161 
d–‘e
 
pkt
->
»q
;

1162 
d–‘e
 
pkt
;

1163 
Pack‘PŒ
 
big_pkt
 = 
£nd_¡©e
->
bigPkt
;

1164 
d–‘e
 
£nd_¡©e
;

1166 
S¶™MašS’d”S‹
 * 
maš_£nd_¡©e
 =

1167 
dyÇmic_ÿ¡
<
S¶™MašS’d”S‹
 *>(
big_pkt
->
£nd”S‹
);

1168 
	`as£¹
(
maš_£nd_¡©e
);

1170 
	`as£¹
(
maš_£nd_¡©e
->
out¡ªdšg
 != 0);

1171 
maš_£nd_¡©e
->
out¡ªdšg
--;

1173 ià(
maš_£nd_¡©e
->
out¡ªdšg
) {

1176 
d–‘e
 
maš_£nd_¡©e
;

1177 
big_pkt
->
£nd”S‹
 = 
NULL
;

1178 
pkt
 = 
big_pkt
;

1182 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

1184 
FauÉ
 
çuÉ
 = 
curSticIn¡
->
	`com¶‘eAcc
(
pkt
, 
this
, 
ŒaûD©a
);

1187 ià(
çuÉ
 =ğ
NoFauÉ
)

1188 
	`couÁIn¡
();

1189 ià(
ŒaûD©a
) {

1191 
d–‘e
 
ŒaûD©a
;

1192 
ŒaûD©a
 = 
NULL
;

1197 ià(
pkt
->
	`isR—d
(è&&…kt->
»q
->
	`isLLSC
()) {

1198 
TheISA
::
	`hªdËLockedR—d
(
th»ad
, 
pkt
->
»q
);

1201 
d–‘e
 
pkt
->
»q
;

1202 
d–‘e
 
pkt
;

1204 
	`po¡Execu‹
();

1206 
	`advªûIn¡
(
çuÉ
);

1211 
	`CGRA_com¶‘eD©aAcûss
(
pkt
);

1214 
	}
}

1216 
boŞ


1217 
	gTimšgCGRA
::
DÿchePÜt
::
	$»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
)

1220 
Tick
 
Ãxt_tick
 = 
ıu
->
	`şockEdge
();

1222 ià(
Ãxt_tick
 =ğ
	`curTick
()) {

1223 
ıu
->
	`com¶‘eD©aAcûss
(
pkt
);

1225 ià(!
tickEv’t
.
	`scheduËd
()) {

1226 
tickEv’t
.
	`scheduË
(
pkt
, 
Ãxt_tick
);

1231 ià(!
»ŒyEv’t
.
	`scheduËd
())

1232 
ıu
->
	`scheduË
(
»ŒyEv’t
, 
Ãxt_tick
);

1233  
çl£
;

1237  
Œue
;

1238 
	}
}

1241 
	gTimšgCGRA
::
DÿchePÜt
::
DTickEv’t
::
	$´oûss
()

1243 
ıu
->
	`com¶‘eD©aAcûss
(
pkt
);

1244 
	}
}

1248 
	gTimšgCGRA
::
DÿchePÜt
::
	$»cvR‘ry
()

1252 
	`as£¹
(
ıu
->
dÿche_pkt
 !ğ
NULL
);

1253 
	`as£¹
(
ıu
->
_¡©us
 =ğ
DÿcheR‘ry
);

1254 
Pack‘PŒ
 
tmp
 = 
ıu
->
dÿche_pkt
;

1255 ià(
tmp
->
£nd”S‹
) {

1257 
S¶™F¿gm’tS’d”S‹
 * 
£nd_¡©e
 =

1258 
dyÇmic_ÿ¡
<
S¶™F¿gm’tS’d”S‹
 *>(
tmp
->
£nd”S‹
);

1259 
	`as£¹
(
£nd_¡©e
);

1260 
Pack‘PŒ
 
big_pkt
 = 
£nd_¡©e
->
bigPkt
;

1262 
S¶™MašS’d”S‹
 * 
maš_£nd_¡©e
 =

1263 
dyÇmic_ÿ¡
<
S¶™MašS’d”S‹
 *>(
big_pkt
->
£nd”S‹
);

1264 
	`as£¹
(
maš_£nd_¡©e
);

1266 ià(
	`£ndTimšgReq
(
tmp
)) {

1269 
£nd_¡©e
->
	`ş—rFromP¬’t
();

1270 
Ùh”_šdex
 = 
maš_£nd_¡©e
->
	`g‘P’dšgF¿gm’t
();

1271 ià(
Ùh”_šdex
 > 0) {

1272 
tmp
 = 
maš_£nd_¡©e
->
äagm’ts
[
Ùh”_šdex
];

1273 
ıu
->
dÿche_pkt
 = 
tmp
;

1274 ià((
big_pkt
->
	`isR—d
(è&& 
ıu
->
	`hªdËR—dPack‘
(
tmp
)) ||

1275 (
big_pkt
->
	`isWr™e
(è&& 
ıu
->
	`hªdËWr™ePack‘
())) {

1276 
maš_£nd_¡©e
->
äagm’ts
[
Ùh”_šdex
] = 
NULL
;

1279 
ıu
->
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

1281 
ıu
->
dÿche_pkt
 = 
NULL
;

1284 } ià(
	`£ndTimšgReq
(
tmp
)) {

1285 
ıu
->
_¡©us
 = 
DÿcheWa™Re¥Ú£
;

1287 
ıu
->
dÿche_pkt
 = 
NULL
;

1289 
	}
}

1291 
	gTimšgCGRA
::
I´Ev’t
::
	$I´Ev’t
(
Pack‘
 *
_pkt
, 
TimšgCGRA
 *
_ıu
,

1292 
Tick
 
t
)

1293 : 
	`pkt
(
_pkt
), 
	$ıu
(
_ıu
)

1295 
ıu
->
	`scheduË
(
this
, 
t
);

1296 
	}
}

1299 
	gTimšgCGRA
::
I´Ev’t
::
	$´oûss
()

1301 
ıu
->
	`com¶‘eD©aAcûss
(
pkt
);

1302 
	}
}

1305 
	gTimšgCGRA
::
I´Ev’t
::
	$desütiÚ
() const

1308 
	}
}

1312 
	gTimšgCGRA
::
	$´štAddr
(
Addr
 
a
)

1314 
dÿchePÜt
.
	`´štAddr
(
a
);

1315 
	}
}

1322 
TimšgCGRA
 *

1323 
	gTimšgCGRAP¬ams
::
	$ü—‹
()

1325 
numTh»ads
 = 1;

1326 ià(!
FuÎSy¡em
 && 
wÜklßd
.
	`size
() != 1)

1327 
	`·nic
("only one workload‡llowed");

1328  
Ãw
 
	`TimšgCGRA
(
this
);

1329 
	}
}

1333 
	gTimšgCGRA
::
	$S‘up_CGRA
()

1336 
CÚd™iÚ®_Reg
=
Ãw
 ;

1337 
CGRA_š¡ruùiÚs
 = 
Ãw
 
ušt32_t
[16];

1338 
unknownRes
 = 
Ãw
 
ušt64_t
[16];

1339 
wr™‹n
 = 0;

1341 
cg¿_PEs
 = 
Ãw
 
CGRA_PE
[
CGRA_YDim
 * 
CGRA_XDim
];

1346 
cg¿_decod”
 = 
Ãw
 
	`CGRADecod”
();

1351 
CGRA_DMem
 = 
Ãw
 
	`CGRA_D©aMemÜy
();

1354 
MemPÜt
 = 
Ãw
 
CGRA_MemÜyPÜt
*[
CGRA_YDim
];

1355 
i
 = 0; i < 
CGRA_YDim
; i++)

1357 
MemPÜt
[
i
] = 
Ãw
 
	`CGRA_MemÜyPÜt
(&
MemBusStus
[i], &
MemD©a
[i], &
MemAdd»ss
[i]);

1361 
i
 = 0; i < 
CGRA_YDim
; i++)

1363 
j
 = 0; j < 
CGRA_XDim
; j++)

1365 
iIndex
;

1366 
jIndex
;

1367 ià(
i
 == 0)

1369 
iIndex
 = 4;

1373 
iIndex
 = 
i
;

1375 ià(
j
 == 0)

1377 
jIndex
 = 4;

1381 
jIndex
 = 
j
;

1384 
cg¿_PEs
[
i
 * 
CGRA_YDim
 + 
j
].
	`£tII
(10);

1385 
cg¿_PEs
[
i
 * 
CGRA_YDim
 + 
j
].
	`S‘Neighbours
(&cg¿_PEs[˜* CGRA_YDim + ((
jIndex
 - 1è% 
CGRA_XDim
)],

1386 &
cg¿_PEs
[
i
 * 
CGRA_YDim
 + ((
jIndex
 + 1è% 
CGRA_XDim
)],

1387 &
cg¿_PEs
[(((
iIndex
 - 1è% 
CGRA_YDim
è* CGRA_YDimè+ 
j
],

1388 &
cg¿_PEs
[(((
iIndex
 + 1è% 
CGRA_YDim
è* CGRA_YDimè+ 
j
]);

1390 
cg¿_PEs
[
i
 * 
CGRA_YDim
 + 
j
].
	`S‘CGRA_MemÜyPÜt
(
MemPÜt
[i]);

1391 
cg¿_PEs
[
i
 * 
CGRA_YDim
 + 
j
].
	`S‘CÚŒŞËr_Reg
(
CÚd™iÚ®_Reg
);

1395 
	}
}

1410 
	gTimšgCGRA
::
	$S‘up_CGRA_ExecutiÚ
()

1413 
	`´štf
("CGRA: OLD PC: %x\n",(è
tc
->
	`š¡Addr
());

1414 
TheISA
::
PCS‹
 
pcS‹
 = 
th»ad
->
	`pcS‹
();

1415 
TheISA
::
	`advªûPC
(
pcS‹
, 
curSticIn¡
);

1416 
th»ad
->
	`pcS‹
(
pcS‹
);

1419 
K”ÃlPC
 = (è
tc
->
	`»adIÁReg
(5);

1420 
PROLogPC
 = (è
tc
->
	`»adIÁReg
(12);

1421 
EPILogPC
 = (è
tc
->
	`»adIÁReg
(10);

1423 
II
 = (è
tc
->
	`»adIÁReg
(6);

1424 
EPILog
 = (è
tc
->
	`»adIÁReg
(1);

1425 
PrŞog
 = (è
tc
->
	`»adIÁReg
(2);

1426 
K”ÃlCouÁ”
ğ(è
tc
->
	`»adIÁReg
(8)+1;

1429 if(
PrŞog
>0)

1431 
	`´štf
("CGRA!!! PROLOG\n");

1432 
ÃwPC
=
PROLogPC
;

1433 
L’
=
PrŞog
;

1434 
¡©e
=
PRO
;

1436 if(
K”ÃlCouÁ”
>0)

1438 
	`´štf
("CGRA!!! KERNEL\n");

1439 
ÃwPC
=
K”ÃlPC
;

1440 
L’
=
II
;

1441 
¡©e
=
KERN
;

1443 if(
EPILog
>0)

1445 
	`´štf
("CGRA!!! EPILOG\n");

1446 
ÃwPC
=
EPILogPC
;

1447 
L’
=
EPILog
;

1448 
¡©e
=
EPI
;

1451 
	`´štf
("CGRA PARAMETERS: PROLOGğ%d, EPILOG=%d, II=%d, K”ÃlCouÁ”=%d\n",
PrŞog
,
EPILog
,
II
,
K”ÃlCouÁ”
);

1452 
	`´štf
("CGRA PARAMETERS: PROLOGPCğ%x, EPILOGPC=%x, K”ÃlPC=%x\n",()
PROLogPC
,()
EPILogPC
,()
K”ÃlPC
);

1453 
	`´štf
("CGRA PC : %x\n",()
ÃwPC
);

1454 
	`´štf
("**********************CGRA Execution is started**************************** \n");

1455 
backPC
 = 
tc
->
	`pcS‹
();

1456 
tc
->
	`pcS‹
((
Addr
è
ÃwPC
);

1457 
	}
}

1459 
	gTimšgCGRA
::
	$P»·»_to_Sw™ch_Back_to_CPU
()

1461 
tc
->
	`£tIÁReg
(11, 16);

1464 
tc
->
	`£tIÁReg
(8, 66);

1467 
_¡©us
 = 
Ba£CGRA
::
RuÂšg
;

1468 
	}
}

1470 
	gTimšgCGRA
::
	$Re¡Üe_CPU_ExecutiÚ
()

1472 
tc
->
	`pcS‹
(
backPC
);

1473 
	}
}

1475 
	gTimšgCGRA
::
	$Sw™ch_To_CPU
()

1477 
CGRA_Mode
 = 0;

1478 
	}
}

1479 
	gTimšgCGRA
::
	$Sw™ch_To_CGRA
()

1481 
CGRA_Mode
 = 1;

1482 
	}
}

1483 
boŞ
 
	gTimšgCGRA
::
	$is_CPU
()

1485  (
CGRA_Mode
==0);

1486 
	}
}

1489 
	gTimšgCGRA
::
	$£tupF‘chReque¡
(
Reque¡
 *
»q
)

1491 
Ba£CGRA
::
	`£tupF‘chReque¡
(
»q
);

1493 ià(!
	`is_CPU
())

1495 
»q
->
	`£tSize
(64);

1498 
	}
}

1500 
	gTimšgCGRA
::
	$CGRA_advªûPC
()

1503 
	`´štf
("*******IN ADVANCE PC******\n");

1505 
	`´štf
("%s,%s,%d,PC:%x\n",
__FILE__
,
__func__
,
__LINE__
,(è
tc
->
	`š¡Addr
());

1506 if(
L’
==0)

1508 if(
¡©e
==
PRO
)

1510 
	`´štf
("\nPROLOG->KERNEL\n");

1511 
ÃwPC
=
K”ÃlPC
;

1512 
¡©e
=
KERN
;

1513 
L’
=
II
;

1514 *
CÚd™iÚ®_Reg
=1;

1516 if(
¡©e
==
KERN
)

1518 if(*
CÚd™iÚ®_Reg
)

1520 
L’
=
II
;

1521 
ÃwPC
=
K”ÃlPC
;

1522 *
CÚd™iÚ®_Reg
=0;

1526 
¡©e
=
EPI
;

1527 
ÃwPC
=
EPILogPC
;

1528 
L’
=
EPILog
;

1534 
ÃwPC
+=64;

1535 
tc
->
	`pcS‹
((
Addr
è
ÃwPC
);

1536 
	}
}

1538 
	gTimšgCGRA
::
	$CGRA_advªûIn¡
(
FauÉ
 
çuÉ
)

1541 ià(
_¡©us
 =ğ
FauÉšg
)

1544 ià(
çuÉ
 !ğ
NoFauÉ
)

1546 
	`CGRA_advªûPC
();

1547 
	`»scheduË
(
ãtchEv’t
, 
	`ÃxtCyşe
(), 
Œue
);

1548 
_¡©us
 = 
FauÉšg
;

1552 ià(!
¡ayAtPC
)

1554 
	`CGRA_advªûPC
();

1557 ià(
_¡©us
 =ğ
Ba£CGRA
::
RuÂšg
)

1563 
	`ãtch
();

1566 
	}
}

1568 
	gTimšgCGRA
::
	$com¶‘eD¿š
()

1570 
	`DPRINTF
(
D¿š
, "CPU done draining,…rocessing drainƒvent\n");

1571 
	`£tD¿šS‹
(
D¿šabË
::
D¿šed
);

1572 
d¿šMªag”
->
	`sigÇlD¿šDÚe
();

1573 
	}
}

	@timingcgra/timingcgra.hh

43 #iâdeà
__CGRA_TIMING_HH__


44 
	#__CGRA_TIMING_HH__


	)

46 
	~"ıu/timšgcg¿/ba£.hh
"

47 
	~"ıu/Œª¦©iÚ.hh
"

48 
	~"·¿ms/TimšgCGRA.hh
"

51 
	~"ıu/timšgcg¿/CGRAPE.h
"

52 
	~"ıu/timšgcg¿/CGRA_MemÜyPÜt.h
"

53 
	~"ıu/timšgcg¿/CGRACÚŒŞËr.h
"

54 
	~"ıu/timšgcg¿/CGRADecod”.h
"

55 
	#PRO
 1

	)

56 
	#KERN
 2

	)

57 
	#EPI
 3

	)

58 
	#FINISH
 4

	)

61 şas 
	cTimšgCGRA
 : 
public
 
Ba£CGRA


63 
public
:

65 
TimšgCGRA
(
TimšgCGRAP¬ams
 * 
·¿ms
);

66 
	mvœtu®
 ~
TimšgCGRA
();

68 
vœtu®
 
š™
();

71 
	mCGRA_Mode
;

73 
ušt32_t
 *
	mCGRA_š¡ruùiÚs
;

74 
	mF‘chedIn¡uùiÚ
;

76 
CGRA_ãtch
();

77 
CGRA_com¶‘eIãtch
(
Pack‘PŒ
 
pkt
);

78 
£ndF‘chCGRA
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
);

79 
CGRA_com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
);

80 
CGRA_advªûIn¡
(
FauÉ
 
çuÉ
);

81 
CGRA_advªûPC
();

84 
S‘up_CGRA
();

86 
P»·»_to_Sw™ch_Back_to_CPU
();

87 
S‘up_CGRA_ExecutiÚ
();

88 
Re¡Üe_CPU_ExecutiÚ
();

90 
Sw™ch_To_CPU
();

91 
Sw™ch_To_CGRA
();

92 
boŞ
 
is_CPU
();

94 
	mMemBusStus
[
CGRA_YDim
];

95 
	mMemD©a
[
CGRA_YDim
];

96 
ušt64_t
 
	mMemAdd»ss
[
CGRA_YDim
];

97 
	mMemAcûssCouÁ
;

98 
	mAcûssCouÁ
;

100 
ušt64_t
* 
	munknownRes
;

102 
com¶‘eD¿š
();

103 
£tupF‘chReque¡
(
Reque¡
 *
»q
);

105 
	m´iv©e
:

106 
ÃwPC
;

107 
	mEPILogPC
;

108 
	mPROLogPC
;

109 
	mK”ÃlPC
;

110 
	mII
;

111 
	mEPILog
;

112 
	mPrŞog
;

113 
	mL’
;

114 
	mÜigš®L’
;

115 
	mK”ÃlCouÁ”
;

117 
	m¡©e
;

119 
boŞ
 
	mwr™‹n
;

120 
	mwr™eV®ue
;

121 
	mİ”ªd1
;

123 * 
	mCÚd™iÚ®_Reg
;

125 
CGRA_PE
* 
	mcg¿_PEs
;

127 
CGRA_MemÜyPÜt
 **
	mMemPÜt
;

128 
CGRA_D©aMemÜy
* 
	mCGRA_DMem
;

130 
CGRA_CÚŒŞËr
* 
	mCGRA_CÚŒŞUn™
;

131 
CGRADecod”
* 
	mcg¿_decod”
;

133 
	mTheISA
::
PCS‹
 
backPC
;

137 
	m´iv©e
:

149 şas 
	cS¶™MašS’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


151 
public
:

152 
out¡ªdšg
;

153 
Pack‘PŒ
 
	mäagm’ts
[2];

156 
g‘P’dšgF¿gm’t
()

158 ià(
	mäagm’ts
[0]) {

160 } ià(
	mäagm’ts
[1]) {

168 şas 
	cS¶™F¿gm’tS’d”S‹
 : 
public
 
Pack‘
::
S’d”S‹


170 
public
:

171 
S¶™F¿gm’tS’d”S‹
(
Pack‘PŒ
 
_bigPkt
, 
_šdex
) :

172 
bigPkt
(
_bigPkt
), 
šdex
(
_šdex
)

174 
Pack‘PŒ
 
	gbigPkt
;

175 
	gšdex
;

178 
ş—rFromP¬’t
()

180 
S¶™MašS’d”S‹
 * 
	gmaš_£nd_¡©e
 =

181 
dyÇmic_ÿ¡
<
S¶™MašS’d”S‹
 *>(
bigPkt
->
£nd”S‹
);

182 
	gmaš_£nd_¡©e
->
	gäagm’ts
[
šdex
] = 
NULL
;

186 şas 
	cF‘chT¿n¦©iÚ
 : 
public
 
Ba£TLB
::
T¿n¦©iÚ


188 
´Ùeùed
:

189 
TimšgCGRA
 *
ıu
;

191 
	gpublic
:

192 
F‘chT¿n¦©iÚ
(
TimšgCGRA
 *
_ıu
)

193 : 
ıu
(
_ıu
)

197 
m¬kD–ayed
()

199 
as£¹
(
ıu
->
_¡©us
 =ğ
Ba£CGRA
::
RuÂšg
);

200 
	gıu
->
	g_¡©us
 = 
ITBWa™Re¥Ú£
;

204 
fšish
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
,

205 
Ba£TLB
::
Mode
 
mode
)

207 
ıu
->
£ndF‘ch
(
çuÉ
, 
»q
, 
tc
);

210 
F‘chT¿n¦©iÚ
 
	gãtchT¿n¦©iÚ
;

212 
£ndD©a
(
Reque¡PŒ
 
»q
, 
ušt8_t
 *
d©a
, 
ušt64_t
 *
»s
, 
boŞ
 
»ad
);

213 
£ndS¶™D©a
(
Reque¡PŒ
 
»q1
, Reque¡PŒ 
»q2
, Reque¡PŒ 
»q
,

214 
ušt8_t
 *
d©a
, 
boŞ
 
»ad
);

216 
Œª¦©iÚFauÉ
(
FauÉ
 
çuÉ
);

218 
budPack‘
(
Pack‘PŒ
 &
pkt
, 
Reque¡PŒ
 
»q
, 
boŞ
 
»ad
);

219 
budS¶™Pack‘
(
Pack‘PŒ
 &
pkt1
, Pack‘PŒ &
pkt2
,

220 
Reque¡PŒ
 
»q1
, Reque¡PŒ 
»q2
, Reque¡PŒ 
»q
,

221 
ušt8_t
 *
d©a
, 
boŞ
 
»ad
);

223 
boŞ
 
hªdËR—dPack‘
(
Pack‘PŒ
 
pkt
);

225 
boŞ
 
hªdËWr™ePack‘
();

233 şas 
	cTimšgCPUPÜt
 : 
public
 
Ma¡”PÜt


235 
public
:

237 
TimšgCPUPÜt
(cÚ¡ 
¡d
::
¡ršg
& 
_Çme
, 
TimšgCGRA
* 
_ıu
)

238 : 
Ma¡”PÜt
(
_Çme
, 
_ıu
), 
ıu
(_ıu), 
»ŒyEv’t
(
this
)

241 
	g´Ùeùed
:

246 
vœtu®
 
»cvTimšgSnoİReq
(
Pack‘PŒ
 
pkt
) { }

248 
TimšgCGRA
* 
ıu
;

250 
	gTickEv’t
 : 
public
 
Ev’t


252 
Pack‘PŒ
 
pkt
;

253 
TimšgCGRA
 *
	gıu
;

255 
TickEv’t
(
TimšgCGRA
 *
_ıu
è: 
pkt
(
NULL
), 
ıu
(_cpu) {}

256 cÚ¡ *
desütiÚ
() const {  "Timing CPUick"; }

257 
scheduË
(
Pack‘PŒ
 
_pkt
, 
Tick
 
t
);

260 
	gEv’tW¿µ”
<
	gMa¡”PÜt
, &Ma¡”PÜt::
£ndR‘ry
> 
»ŒyEv’t
;

263 şas 
	cIÿchePÜt
 : 
public
 
TimšgCPUPÜt


265 
public
:

267 
IÿchePÜt
(
TimšgCGRA
 *
_ıu
)

268 : 
TimšgCPUPÜt
(
_ıu
->
Çme
() + ".icache_port", _cpu),

269 
tickEv’t
(
_ıu
)

272 
	g´Ùeùed
:

274 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

276 
vœtu®
 
»cvR‘ry
();

278 
	gITickEv’t
 : 
public
 
TickEv’t


281 
ITickEv’t
(
TimšgCGRA
 *
_ıu
)

282 : 
TickEv’t
(
_ıu
) {}

283 
´oûss
();

284 cÚ¡ *
desütiÚ
() const {  "Timing CPU icacheick"; }

287 
ITickEv’t
 
	gtickEv’t
;

291 şas 
	cDÿchePÜt
 : 
public
 
TimšgCPUPÜt


293 
public
:

295 
DÿchePÜt
(
TimšgCGRA
 *
_ıu
)

296 : 
TimšgCPUPÜt
(
_ıu
->
Çme
() + ".dcache_port", _cpu),

297 
tickEv’t
(
_ıu
)

301 
DÿchePÜt
(
TimšgCGRA
 *
_ıu
,
¡d
::
¡ršg
 
num
)

302 : 
TimšgCPUPÜt
(
_ıu
->
Çme
(è+ ".dÿche_pÜt"+
num
, _cpu),

303 
tickEv’t
(
_ıu
)

306 
	g´Ùeùed
:

308 
vœtu®
 
boŞ
 
»cvTimšgRe¥
(
Pack‘PŒ
 
pkt
);

310 
vœtu®
 
»cvR‘ry
();

312 
	gDTickEv’t
 : 
public
 
TickEv’t


314 
DTickEv’t
(
TimšgCGRA
 *
_ıu
)

315 : 
TickEv’t
(
_ıu
) {}

316 
´oûss
();

317 cÚ¡ *
desütiÚ
() const {  "Timing CPU dcacheick"; }

320 
DTickEv’t
 
	gtickEv’t
;

325 
IÿchePÜt
 
	giÿchePÜt
;

326 
DÿchePÜt
 
	gdÿchePÜt
;

329 
DÿchePÜt
 
	gdÿchePÜt1
;

330 
DÿchePÜt
 
	gdÿchePÜt2
;

331 
DÿchePÜt
 
	gdÿchePÜt3
;

332 
DÿchePÜt
 
	gdÿchePÜt4
;

335 
Pack‘PŒ
 
	giãtch_pkt
;

336 
Pack‘PŒ
 
	gdÿche_pkt
;

339 
Pack‘PŒ
 
	gdÿche_pkt1
;

340 
Pack‘PŒ
 
	gdÿche_pkt2
;

341 
Pack‘PŒ
 
	gdÿche_pkt3
;

342 
Pack‘PŒ
 
	gdÿche_pkt4
;

344 
Tick
 
	g´eviousCyşe
;

346 
	g´Ùeùed
:

349 
vœtu®
 
Ma¡”PÜt
 &
	$g‘D©aPÜt
(è{  
dÿchePÜt
; 
	}
}

352 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘D©aPÜt1
(è{  
dÿchePÜt1
; 
	}
}

353 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘D©aPÜt2
(è{  
dÿchePÜt2
; 
	}
}

354 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘D©aPÜt3
(è{  
dÿchePÜt3
; 
	}
}

355 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘D©aPÜt4
(è{  
dÿchePÜt4
; 
	}
}

358 
vœtu®
 
	gMa¡”PÜt
 &
	$g‘In¡PÜt
(è{  
iÿchePÜt
; 
	}
}

360 
	gpublic
:

362 
d¿š
(
D¿šMªag”
 *
d¿š_mªag”
);

363 
d¿šResume
();

365 
sw™chOut
();

366 
keOv”From
(
Ba£CPU
 *
ŞdCPU
);

368 
	$v”ifyMemÜyMode
() const;

370 
vœtu®
 
	`aùiv©eCÚ‹xt
(
Th»adID
 
th»ad_num
, 
Cyşes
 
d–ay
);

371 
vœtu®
 
	`su¥’dCÚ‹xt
(
Th»adID
 
th»ad_num
);

373 
FauÉ
 
	`»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
,
ydim
);

374 
FauÉ
 
	`»adMem
(
Addr
 
addr
, 
ušt8_t
 *
d©a
, 
size
, 
æags
);

376 
FauÉ
 
	`wr™eMem
(
ušt8_t
 *
d©a
, 
size
,
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
);

377 
FauÉ
 
	`wr™eMem
(
ušt8_t
 *
d©a
, 
size
,
Addr
 
addr
, 
æags
, 
ušt64_t
 *
»s
,
ydim
);

379 
	`ãtch
();

380 
	`£ndF‘ch
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
);

381 
	`com¶‘eIãtch
(
Pack‘PŒ
 );

382 
	`com¶‘eD©aAcûss
(
Pack‘PŒ
 
pkt
);

383 
	`advªûIn¡
(
FauÉ
 
çuÉ
);

391 
boŞ
 
	$isSquashed
(ècÚ¡ {  
çl£
; 
	}
}

397 
´štAddr
(
Addr
 
a
);

403 
fšishT¿n¦©iÚ
(
WhŞeT¿n¦©iÚS‹
 *
¡©e
);

405 
	g´iv©e
:

407 
Ev’tW¿µ”
<
	tTimšgCGRA
, &TimšgCGRA::
	tãtch
> 
	tF‘chEv’t
;

408 
F‘chEv’t
 
	gãtchEv’t
;

410 
	gI´Ev’t
 : 
Ev’t
 {

411 
Pack‘
 *
pkt
;

412 
TimšgCGRA
 *
	gıu
;

413 
I´Ev’t
(
Pack‘
 *
_pkt
, 
TimšgCGRA
 *
_ıu
, 
Tick
 
t
);

414 
vœtu®
 
´oûss
();

415 
vœtu®
 cÚ¡ *
desütiÚ
() const;

434 
boŞ
 
	$isD¿šed
() {

435  
	`miüoPC
(è=ğ0 && !
¡ayAtPC
 && !
ãtchEv’t
.
	`scheduËd
();

436 
	}
}

443 
boŞ
 
ŒyCom¶‘eD¿š
();

450 
D¿šMªag”
 *
	gd¿šMªag”
;

	@translation.hh

45 #iâdeà
__CPU_TRANSLATION_HH__


46 
	#__CPU_TRANSLATION_HH__


	)

48 
	~"sim/çuÉs.hh
"

49 
	~"sim/b.hh
"

61 şas 
	cWhŞeT¿n¦©iÚS‹


63 
	m´Ùeùed
:

64 
out¡ªdšg
;

65 
FauÉ
 
	mçuÉs
[2];

67 
	mpublic
:

68 
boŞ
 
d–ay
;

69 
boŞ
 
	misS¶™
;

70 
Reque¡PŒ
 
	mmašReq
;

71 
Reque¡PŒ
 
	m¤eqLow
;

72 
Reque¡PŒ
 
	m¤eqHigh
;

73 
ušt8_t
 *
	md©a
;

74 
ušt64_t
 *
	m»s
;

75 
	mBa£TLB
::
Mode
 
mode
;

81 
WhŞeT¿n¦©iÚS‹
(
Reque¡PŒ
 
_»q
, 
ušt8_t
 *
_d©a
, 
ušt64_t
 *
_»s
,

82 
Ba£TLB
::
Mode
 
_mode
)

83 : 
out¡ªdšg
(1), 
d–ay
(
çl£
), 
isS¶™
(çl£), 
mašReq
(
_»q
),

84 
¤eqLow
(
NULL
), 
¤eqHigh
(NULL), 
d©a
(
_d©a
), 
»s
(
_»s
), 
	$mode
(
_mode
)

86 
çuÉs
[0] = fauÉs[1] = 
NoFauÉ
;

87 
	`as£¹
(
mode
 =ğ
Ba£TLB
::
R—d
 || mod=ğBa£TLB::
Wr™e
);

95 
	`WhŞeT¿n¦©iÚS‹
(
Reque¡PŒ
 
_»q
, Reque¡PŒ 
_¤eqLow
,

96 
Reque¡PŒ
 
_¤eqHigh
, 
ušt8_t
 *
_d©a
, 
ušt64_t
 *
_»s
,

97 
Ba£TLB
::
Mode
 
_mode
)

98 : 
	`out¡ªdšg
(2), 
	`d–ay
(
çl£
), 
	`isS¶™
(
Œue
), 
	`mašReq
(
_»q
),

99 
	`¤eqLow
(
_¤eqLow
), 
	`¤eqHigh
(
_¤eqHigh
), 
	`d©a
(
_d©a
), 
	`»s
(
_»s
),

100 
	$mode
(
_mode
)

102 
çuÉs
[0] = fauÉs[1] = 
NoFauÉ
;

103 
	`as£¹
(
mode
 =ğ
Ba£TLB
::
R—d
 || mod=ğBa£TLB::
Wr™e
);

104 
	}
}

113 
boŞ


114 
	$fšish
(
FauÉ
 
çuÉ
, 
šdex
)

116 
	`as£¹
(
out¡ªdšg
);

117 
çuÉs
[
šdex
] = 
çuÉ
;

118 
out¡ªdšg
--;

119 ià(
isS¶™
 && 
out¡ªdšg
 == 0) {

122 ià(
çuÉs
[0] =ğ
NoFauÉ
) {

123 
mašReq
->
	`£tPaddr
(
¤eqLow
->
	`g‘Paddr
());

125 
mašReq
->
	`£tFÏgs
(
¤eqLow
->
	`g‘FÏgs
());

126 
mašReq
->
	`£tFÏgs
(
¤eqHigh
->
	`g‘FÏgs
());

128  
out¡ªdšg
 == 0;

129 
	}
}

135 
FauÉ


136 
	$g‘FauÉ
() const

138 ià(!
isS¶™
)

139  
çuÉs
[0];

140 ià(
çuÉs
[0] !ğ
NoFauÉ
)

141  
çuÉs
[0];

142 ià(
çuÉs
[1] !ğ
NoFauÉ
)

143  
çuÉs
[1];

145  
NoFauÉ
;

146 
	}
}

150 
	$£tNoFauÉ
()

152 
çuÉs
[0] = fauÉs[1] = 
NoFauÉ
;

153 
	}
}

160 
boŞ


161 
	$isUnÿch—bË
() const

163  
mašReq
->
	`isUnÿch—bË
();

164 
	}
}

171 
boŞ


172 
	$isP»ãtch
() const

174  
mašReq
->
	`isP»ãtch
();

175 
	}
}

178 
Addr


179 
	$g‘Paddr
() const

181  
mašReq
->
	`g‘Paddr
();

182 
	}
}

190 
	$g‘FÏgs
()

192  
mašReq
->
	`g‘FÏgs
();

193 
	}
}

197 
	$d–‘eReqs
()

199 
d–‘e
 
mašReq
;

200 ià(
isS¶™
) {

201 
d–‘e
 
¤eqLow
;

202 
d–‘e
 
¤eqHigh
;

204 
	}
}

217 
	g‹m¶©e
 <
şass
 
	gExecCÚ‹xtPŒ
>

218 şas 
	cD©aT¿n¦©iÚ
 : 
public
 
Ba£TLB
::
T¿n¦©iÚ


220 
´Ùeùed
:

221 
ExecCÚ‹xtPŒ
 
xc
;

222 
WhŞeT¿n¦©iÚS‹
 *
	m¡©e
;

223 
	mšdex
;

225 
	mpublic
:

226 
	$D©aT¿n¦©iÚ
(
ExecCÚ‹xtPŒ
 
_xc
, 
WhŞeT¿n¦©iÚS‹
* 
_¡©e
)

227 : 
	`xc
(
_xc
), 
	`¡©e
(
_¡©e
), 
	$šdex
(0)

231 
	$D©aT¿n¦©iÚ
(
ExecCÚ‹xtPŒ
 
_xc
, 
WhŞeT¿n¦©iÚS‹
* 
_¡©e
,

232 
_šdex
)

233 : 
	`xc
(
_xc
), 
	`¡©e
(
_¡©e
), 
	$šdex
(
_šdex
)

235 
	}
}

242 
	$m¬kD–ayed
()

244 
¡©e
->
d–ay
 = 
Œue
;

245 
	}
}

252 
fšish
(
FauÉ
 
çuÉ
, 
Reque¡PŒ
 
»q
, 
Th»adCÚ‹xt
 *
tc
,

253 
Ba£TLB
::
Mode
 
mode
)

255 
as£¹
(
¡©e
);

256 
as£¹
(
mode
 =ğ
¡©e
->mode);

257 ià(
	g¡©e
->
fšish
(
çuÉ
, 
šdex
)) {

258 
	gxc
->
fšishT¿n¦©iÚ
(
¡©e
);

260 
d–‘e
 
	gthis
;

263 
boŞ


264 
	$squashed
() const

266  
xc
->
	`isSquashed
();

267 
	}
}

	@/usr/include/fcntl.h

24 #iâdef 
_FCNTL_H


25 
	#_FCNTL_H
 1

	)

27 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 
	~<b™s/fú.h
>

37 #ifdeà
__USE_XOPEN


38 
	~<sys/¡©.h
>

41 #ifdef 
__USE_MISC


42 #iâdeà
R_OK


45 
	#R_OK
 4

	)

46 
	#W_OK
 2

	)

47 
	#X_OK
 1

	)

48 
	#F_OK
 0

	)

53 #ifdeà
__USE_XOPEN


54 
	#SEEK_SET
 0

	)

55 
	#SEEK_CUR
 1

	)

56 
	#SEEK_END
 2

	)

64 
fú
 (
__fd
, 
__cmd
, ...);

72 #iâdeà
__USE_FILE_OFFSET64


73 
	$İ’
 (
__cÚ¡
 *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

75 #ifdeà
__REDIRECT


76 
	`__REDIRECT
 (
İ’
, (
__cÚ¡
 *
__fe
, 
__oæag
, ...), 
İ’64
)

77 
	`__nÚnuÎ
 ((1));

79 
	#İ’
 
İ’64


	)

82 #ifdeà
__USE_LARGEFILE64


83 
	$İ’64
 (
__cÚ¡
 *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

86 #ifdeà
__USE_ATFILE


96 #iâdeà
__USE_FILE_OFFSET64


97 
	$İ’©
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
, ...)

98 
	`__nÚnuÎ
 ((2));

100 #ifdeà
__REDIRECT


101 
	`__REDIRECT
 (
İ’©
, (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
,

102 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

104 
	#İ’©
 
İ’©64


	)

108 
	$İ’©64
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__oæag
, ...)

109 
	`__nÚnuÎ
 ((2));

117 #iâdeà
__USE_FILE_OFFSET64


118 
	$ü—t
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

120 #ifdeà
__REDIRECT


121 
	`__REDIRECT
 (
ü—t
, (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
),

122 
ü—t64
è
	`__nÚnuÎ
 ((1));

124 
	#ü—t
 
ü—t64


	)

127 #ifdeà
__USE_LARGEFILE64


128 
	$ü—t64
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

131 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

132 && !
defšed
 
__USE_POSIX
))

141 
	#F_ULOCK
 0

	)

142 
	#F_LOCK
 1

	)

143 
	#F_TLOCK
 2

	)

144 
	#F_TEST
 3

	)

146 #iâdeà
__USE_FILE_OFFSET64


147 
	`lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
);

149 #ifdeà
__REDIRECT


150 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

152 
	#lockf
 
lockf64


	)

155 #ifdeà
__USE_LARGEFILE64


156 
	`lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
);

160 #ifdeà
__USE_XOPEN2K


163 #iâdeà
__USE_FILE_OFFSET64


164 
	$posix_çdvi£
 (
__fd
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
,

165 
__advi£
è
__THROW
;

167 #ifdeà
__REDIRECT_NTH


168 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

169 
__off64_t
 
__Ën
, 
__advi£
),

170 
posix_çdvi£64
);

172 
	#posix_çdvi£
 
posix_çdvi£64


	)

175 #ifdeà
__USE_LARGEFILE64


176 
	$posix_çdvi£64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__Ën
,

177 
__advi£
è
__THROW
;

185 #iâdeà
__USE_FILE_OFFSET64


186 
	`posix_çÎoÿ‹
 (
__fd
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
);

188 #ifdeà
__REDIRECT


189 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

190 
__off64_t
 
__Ën
),

191 
posix_çÎoÿ‹64
);

193 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

196 #ifdeà
__USE_LARGEFILE64


197 
	`posix_çÎoÿ‹64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__Ën
);

203 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše
 \

204 && 
defšed
 
__va_¬g_·ck_Ën


205 
	~<b™s/fú2.h
>

208 
__END_DECLS


	@/usr/include/inttypes.h

23 #iâdeà
_INTTYPES_H


24 
	#_INTTYPES_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	~<¡dšt.h
>

31 #iâdeà
____gwch¬_t_defšed


32 #ifdeà
__ılu¥lus


33 
	#__gwch¬_t
 
wch¬_t


	)

34 #–ià
defšed
 
__WCHAR_TYPE__


35 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

37 
	#__Ãed_wch¬_t


	)

38 
	~<¡ddef.h
>

39 
wch¬_t
 
	t__gwch¬_t
;

41 
	#____gwch¬_t_defšed
 1

	)

47 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_FORMAT_MACROS


49 #ià
__WORDSIZE
 == 64

50 
	#__PRI64_PREFIX
 "l"

	)

51 
	#__PRIPTR_PREFIX
 "l"

	)

53 
	#__PRI64_PREFIX
 "Î"

	)

54 
	#__PRIPTR_PREFIX


	)

60 
	#PRId8
 "d"

	)

61 
	#PRId16
 "d"

	)

62 
	#PRId32
 "d"

	)

63 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

65 
	#PRIdLEAST8
 "d"

	)

66 
	#PRIdLEAST16
 "d"

	)

67 
	#PRIdLEAST32
 "d"

	)

68 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIdFAST8
 "d"

	)

71 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

72 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

73 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

76 
	#PRIi8
 "i"

	)

77 
	#PRIi16
 "i"

	)

78 
	#PRIi32
 "i"

	)

79 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

81 
	#PRIiLEAST8
 "i"

	)

82 
	#PRIiLEAST16
 "i"

	)

83 
	#PRIiLEAST32
 "i"

	)

84 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIiFAST8
 "i"

	)

87 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

88 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

89 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

92 
	#PRIo8
 "o"

	)

93 
	#PRIo16
 "o"

	)

94 
	#PRIo32
 "o"

	)

95 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

97 
	#PRIoLEAST8
 "o"

	)

98 
	#PRIoLEAST16
 "o"

	)

99 
	#PRIoLEAST32
 "o"

	)

100 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIoFAST8
 "o"

	)

103 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

104 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

105 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

108 
	#PRIu8
 "u"

	)

109 
	#PRIu16
 "u"

	)

110 
	#PRIu32
 "u"

	)

111 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

113 
	#PRIuLEAST8
 "u"

	)

114 
	#PRIuLEAST16
 "u"

	)

115 
	#PRIuLEAST32
 "u"

	)

116 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIuFAST8
 "u"

	)

119 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

120 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

121 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

124 
	#PRIx8
 "x"

	)

125 
	#PRIx16
 "x"

	)

126 
	#PRIx32
 "x"

	)

127 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

129 
	#PRIxLEAST8
 "x"

	)

130 
	#PRIxLEAST16
 "x"

	)

131 
	#PRIxLEAST32
 "x"

	)

132 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIxFAST8
 "x"

	)

135 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

136 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

137 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

140 
	#PRIX8
 "X"

	)

141 
	#PRIX16
 "X"

	)

142 
	#PRIX32
 "X"

	)

143 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

145 
	#PRIXLEAST8
 "X"

	)

146 
	#PRIXLEAST16
 "X"

	)

147 
	#PRIXLEAST32
 "X"

	)

148 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

150 
	#PRIXFAST8
 "X"

	)

151 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

152 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

153 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

157 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

158 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

159 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

160 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

161 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

162 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

166 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

167 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

168 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

169 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

170 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

171 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

177 
	#SCNd8
 "hhd"

	)

178 
	#SCNd16
 "hd"

	)

179 
	#SCNd32
 "d"

	)

180 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

182 
	#SCNdLEAST8
 "hhd"

	)

183 
	#SCNdLEAST16
 "hd"

	)

184 
	#SCNdLEAST32
 "d"

	)

185 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNdFAST8
 "hhd"

	)

188 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

189 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

190 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

193 
	#SCNi8
 "hhi"

	)

194 
	#SCNi16
 "hi"

	)

195 
	#SCNi32
 "i"

	)

196 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

198 
	#SCNiLEAST8
 "hhi"

	)

199 
	#SCNiLEAST16
 "hi"

	)

200 
	#SCNiLEAST32
 "i"

	)

201 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNiFAST8
 "hhi"

	)

204 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

205 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

206 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

209 
	#SCNu8
 "hhu"

	)

210 
	#SCNu16
 "hu"

	)

211 
	#SCNu32
 "u"

	)

212 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

214 
	#SCNuLEAST8
 "hhu"

	)

215 
	#SCNuLEAST16
 "hu"

	)

216 
	#SCNuLEAST32
 "u"

	)

217 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNuFAST8
 "hhu"

	)

220 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

221 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

222 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

225 
	#SCNo8
 "hho"

	)

226 
	#SCNo16
 "ho"

	)

227 
	#SCNo32
 "o"

	)

228 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

230 
	#SCNoLEAST8
 "hho"

	)

231 
	#SCNoLEAST16
 "ho"

	)

232 
	#SCNoLEAST32
 "o"

	)

233 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNoFAST8
 "hho"

	)

236 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

237 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

238 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

241 
	#SCNx8
 "hhx"

	)

242 
	#SCNx16
 "hx"

	)

243 
	#SCNx32
 "x"

	)

244 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

246 
	#SCNxLEAST8
 "hhx"

	)

247 
	#SCNxLEAST16
 "hx"

	)

248 
	#SCNxLEAST32
 "x"

	)

249 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

251 
	#SCNxFAST8
 "hhx"

	)

252 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

253 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

254 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

258 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

259 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

260 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

261 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

262 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

265 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

266 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

267 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

268 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

269 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

274 
	g__BEGIN_DECLS


276 #ià
__WORDSIZE
 == 64

281 
	mquÙ
;

282 
	m»m
;

283 } 
	timaxdiv_t
;

290 
	mquÙ
;

291 
	m»m
;

292 } 
	timaxdiv_t
;

298 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

301 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

302 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

305 
štmax_t
 
	$¡¹oimax
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

306 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

309 
uštmax_t
 
	$¡¹oumax
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

310 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

313 
štmax_t
 
	$wc¡oimax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

314 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

315 
__THROW
;

318 
uštmax_t
 
	$wc¡oumax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

319 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

320 
__THROW
;

322 #ifdeà
__USE_EXTERN_INLINES


324 #ià
__WORDSIZE
 == 64

326 
	$__¡¹Ş_š‹º®
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

327 **
__»¡riù
 
__’d±r
,

328 
__ba£
, 
__group
)

329 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

331 
__ex‹º_šlše
 
štmax_t


332 
	`__NTH
 (
	$¡¹oimax
 (
__cÚ¡
 *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

333 
ba£
))

335  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

336 
	}
}

338 
	$__¡¹oul_š‹º®
 (
__cÚ¡
 *

339 
__»¡riù
 
__ÅŒ
,

340 ** 
__»¡riù
 
__’d±r
,

341 
__ba£
, 
__group
)

342 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

344 
__ex‹º_šlše
 
uštmax_t


345 
	`__NTH
 (
	$¡¹oumax
 (
__cÚ¡
 *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

346 
ba£
))

348  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

349 
	}
}

351 
	$__wc¡Ş_š‹º®
 (
__cÚ¡
 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

352 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

353 
__ba£
, 
__group
)

354 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

356 
__ex‹º_šlše
 
štmax_t


357 
	`__NTH
 (
	$wc¡oimax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

358 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

360  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

361 
	}
}

363 
	$__wc¡oul_š‹º®
 (
__cÚ¡
 
__gwch¬_t
 *

364 
__»¡riù
 
__ÅŒ
,

365 
__gwch¬_t
 **

366 
__»¡riù
 
__’d±r
,

367 
__ba£
, 
__group
)

368 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

370 
__ex‹º_šlše
 
uštmax_t


371 
	`__NTH
 (
	$wc¡oumax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

372 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

374  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

375 
	}
}

379 
__ex‹nsiÚ__


380 
	$__¡¹Şl_š‹º®
 (
__cÚ¡
 *
__»¡riù
 
__ÅŒ
,

381 **
__»¡riù
 
__’d±r
,

382 
__ba£
, 
__group
)

383 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

385 
__ex‹º_šlše
 
štmax_t


386 
	`__NTH
 (
	$¡¹oimax
 (
__cÚ¡
 *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

387 
ba£
))

389  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

390 
	}
}

392 
__ex‹nsiÚ__


393 
	$__¡¹ouÎ_š‹º®
 (
__cÚ¡
 *

394 
__»¡riù
 
__ÅŒ
,

396 
__»¡riù
 
__’d±r
,

397 
__ba£
,

398 
__group
)

399 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

401 
__ex‹º_šlše
 
uštmax_t


402 
	`__NTH
 (
	$¡¹oumax
 (
__cÚ¡
 *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

403 
ba£
))

405  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

406 
	}
}

408 
__ex‹nsiÚ__


409 
	$__wc¡Şl_š‹º®
 (
__cÚ¡
 
__gwch¬_t
 *

410 
__»¡riù
 
__ÅŒ
,

411 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

412 
__ba£
, 
__group
)

413 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

415 
__ex‹º_šlše
 
štmax_t


416 
	`__NTH
 (
	$wc¡oimax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

417 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

419  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

420 
	}
}

423 
__ex‹nsiÚ__


424 
	$__wc¡ouÎ_š‹º®
 (
__cÚ¡
 
__gwch¬_t
 *

425 
__»¡riù
 
__ÅŒ
,

426 
__gwch¬_t
 **

427 
__»¡riù
 
__’d±r
,

428 
__ba£
,

429 
__group
)

430 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

432 
__ex‹º_šlše
 
uštmax_t


433 
	`__NTH
 (
	$wc¡oumax
 (
__cÚ¡
 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

434 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

436  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

437 
	}
}

442 
	g__END_DECLS


	@/usr/include/linux/kvm.h

1 #iâdeà
__LINUX_KVM_H


2 
	#__LINUX_KVM_H


	)

10 
	~<lšux/ty³s.h
>

12 
	~<lšux/ioùl.h
>

13 
	~<asm/kvm.h
>

15 
	#KVM_API_VERSION
 12

	)

18 
	skvm_u£r_Œaû_£tup
 {

19 
__u32
 
	mbuf_size
;

20 
__u32
 
	mbuf_Ä
;

24 
	skvm_memÜy_»giÚ
 {

25 
__u32
 
	m¦Ù
;

26 
__u32
 
	mæags
;

27 
__u64
 
	mgue¡_phys_addr
;

28 
__u64
 
	mmemÜy_size
;

32 
	skvm_u£r¥aû_memÜy_»giÚ
 {

33 
__u32
 
	m¦Ù
;

34 
__u32
 
	mæags
;

35 
__u64
 
	mgue¡_phys_addr
;

36 
__u64
 
	mmemÜy_size
;

37 
__u64
 
	mu£r¥aû_addr
;

41 
	#KVM_MEM_LOG_DIRTY_PAGES
 1UL

	)

45 
	skvm_œq_Ëv–
 {

52 
__u32
 
	mœq
;

53 
__s32
 
	m¡©us
;

55 
__u32
 
	mËv–
;

59 
	skvm_œqch
 {

60 
__u32
 
	mch_id
;

61 
__u32
 
	m·d
;

63 
	mdummy
[512];

64 #ifdeà
__KVM_HAVE_PIT


65 
kvm_pic_¡©e
 
	mpic
;

67 #ifdeà
__KVM_HAVE_IOAPIC


68 
kvm_ißpic_¡©e
 
	mißpic
;

70 } 
	mch
;

74 
	skvm_p™_cÚfig
 {

75 
__u32
 
	mæags
;

76 
__u32
 
	m·d
[15];

79 
	#KVM_PIT_SPEAKER_DUMMY
 1

	)

81 
	#KVM_EXIT_UNKNOWN
 0

	)

82 
	#KVM_EXIT_EXCEPTION
 1

	)

83 
	#KVM_EXIT_IO
 2

	)

84 
	#KVM_EXIT_HYPERCALL
 3

	)

85 
	#KVM_EXIT_DEBUG
 4

	)

86 
	#KVM_EXIT_HLT
 5

	)

87 
	#KVM_EXIT_MMIO
 6

	)

88 
	#KVM_EXIT_IRQ_WINDOW_OPEN
 7

	)

89 
	#KVM_EXIT_SHUTDOWN
 8

	)

90 
	#KVM_EXIT_FAIL_ENTRY
 9

	)

91 
	#KVM_EXIT_INTR
 10

	)

92 
	#KVM_EXIT_SET_TPR
 11

	)

93 
	#KVM_EXIT_TPR_ACCESS
 12

	)

94 
	#KVM_EXIT_S390_SIEIC
 13

	)

95 
	#KVM_EXIT_S390_RESET
 14

	)

96 
	#KVM_EXIT_DCR
 15

	)

97 
	#KVM_EXIT_NMI
 16

	)

98 
	#KVM_EXIT_INTERNAL_ERROR
 17

	)

101 
	#KVM_INTERNAL_ERROR_EMULATION
 1

	)

104 
	skvm_run
 {

106 
__u8
 
	m»que¡_š‹¼u±_wšdow
;

107 
__u8
 
	m·ddšg1
[7];

110 
__u32
 
	mex™_»asÚ
;

111 
__u8
 
	m»ady_fÜ_š‹¼u±_šjeùiÚ
;

112 
__u8
 
	mif_æag
;

113 
__u8
 
	m·ddšg2
[2];

116 
__u64
 
	mü8
;

117 
__u64
 
	m­ic_ba£
;

119 #ifdeà
__KVM_S390


121 
__u64
 
	mpsw_mask
;

122 
__u64
 
	mpsw_addr
;

127 
__u64
 
	mh¬dw¬e_ex™_»asÚ
;

128 } 
	mhw
;

131 
__u64
 
	mh¬dw¬e_’Œy_çu»_»asÚ
;

132 } 
	mç_’Œy
;

135 
__u32
 
	mexû±iÚ
;

136 
__u32
 
	m”rÜ_code
;

137 } 
	mex
;

140 
	#KVM_EXIT_IO_IN
 0

	)

141 
	#KVM_EXIT_IO_OUT
 1

	)

142 
__u8
 
	mdœeùiÚ
;

143 
__u8
 
	msize
;

144 
__u16
 
	mpÜt
;

145 
__u32
 
	mcouÁ
;

146 
__u64
 
	md©a_off£t
;

147 } 
	mio
;

149 
kvm_debug_ex™_¬ch
 
	m¬ch
;

150 } 
	mdebug
;

153 
__u64
 
	mphys_addr
;

154 
__u8
 
	md©a
[8];

155 
__u32
 
	mËn
;

156 
__u8
 
	mis_wr™e
;

157 } 
	mmmio
;

160 
__u64
 
	mÄ
;

161 
__u64
 
	m¬gs
[6];

162 
__u64
 
	m»t
;

163 
__u32
 
	mlÚgmode
;

164 
__u32
 
	m·d
;

165 } 
	mhy³rÿÎ
;

168 
__u64
 
	mr
;

169 
__u32
 
	mis_wr™e
;

170 
__u32
 
	m·d
;

171 } 
	mr_acûss
;

174 
__u8
 
	miıtcode
;

175 
__u16
 
	ma
;

176 
__u32
 
	mb
;

177 } 
	ms390_s›ic
;

179 
	#KVM_S390_RESET_POR
 1

	)

180 
	#KVM_S390_RESET_CLEAR
 2

	)

181 
	#KVM_S390_RESET_SUBSYSTEM
 4

	)

182 
	#KVM_S390_RESET_CPU_INIT
 8

	)

183 
	#KVM_S390_RESET_IPL
 16

	)

184 
__u64
 
	ms390_»£t_æags
;

187 
__u32
 
	mdün
;

188 
__u32
 
	md©a
;

189 
__u8
 
	mis_wr™e
;

190 } 
	mdü
;

192 
__u32
 
	msub”rÜ
;

193 } 
	mš‹º®
;

195 
	m·ddšg
[256];

201 
	skvm_cßËsûd_mmio_zÚe
 {

202 
__u64
 
	maddr
;

203 
__u32
 
	msize
;

204 
__u32
 
	m·d
;

207 
	skvm_cßËsûd_mmio
 {

208 
__u64
 
	mphys_addr
;

209 
__u32
 
	mËn
;

210 
__u32
 
	m·d
;

211 
__u8
 
	md©a
[8];

214 
	skvm_cßËsûd_mmio_ršg
 {

215 
__u32
 
	mfœ¡
, 
	mÏ¡
;

216 
kvm_cßËsûd_mmio
 
	mcßËsûd_mmio
[0];

219 
	#KVM_COALESCED_MMIO_MAX
 \

220 ((
PAGE_SIZE
 - (
kvm_cßËsûd_mmio_ršg
)) / \

221 (
kvm_cßËsûd_mmio
))

	)

224 
	skvm_Œª¦©iÚ
 {

226 
__u64
 
	mlš—r_add»ss
;

229 
__u64
 
	mphysiÿl_add»ss
;

230 
__u8
 
	mv®id
;

231 
__u8
 
	mwr™—bË
;

232 
__u8
 
	mu£rmode
;

233 
__u8
 
	m·d
[5];

237 
	skvm_š‹¼u±
 {

239 
__u32
 
	mœq
;

243 
	skvm_dœty_log
 {

244 
__u32
 
	m¦Ù
;

245 
__u32
 
	m·ddšg1
;

247 *
	mdœty_b™m­
;

248 
__u64
 
	m·ddšg2
;

253 
	skvm_sigÇl_mask
 {

254 
__u32
 
	mËn
;

255 
__u8
 
	msig£t
[0];

259 
	skvm_r_acûss_ùl
 {

260 
__u32
 
	m’abËd
;

261 
__u32
 
	mæags
;

262 
__u32
 
	m»£rved
[8];

266 
	skvm_v­ic_addr
 {

267 
__u64
 
	mv­ic_addr
;

272 
	#KVM_MP_STATE_RUNNABLE
 0

	)

273 
	#KVM_MP_STATE_UNINITIALIZED
 1

	)

274 
	#KVM_MP_STATE_INIT_RECEIVED
 2

	)

275 
	#KVM_MP_STATE_HALTED
 3

	)

276 
	#KVM_MP_STATE_SIPI_RECEIVED
 4

	)

278 
	skvm_mp_¡©e
 {

279 
__u32
 
	mmp_¡©e
;

282 
	skvm_s390_psw
 {

283 
__u64
 
	mmask
;

284 
__u64
 
	maddr
;

288 
	#KVM_S390_SIGP_STOP
 0xffã0000u

	)

289 
	#KVM_S390_PROGRAM_INT
 0xffã0001u

	)

290 
	#KVM_S390_SIGP_SET_PREFIX
 0xffã0002u

	)

291 
	#KVM_S390_RESTART
 0xffã0003u

	)

292 
	#KVM_S390_INT_VIRTIO
 0xffff2603u

	)

293 
	#KVM_S390_INT_SERVICE
 0xffff2401u

	)

294 
	#KVM_S390_INT_EMERGENCY
 0xffff1201u

	)

296 
	skvm_s390_š‹¼u±
 {

297 
__u32
 
	mty³
;

298 
__u32
 
	m·rm
;

299 
__u64
 
	m·rm64
;

304 
	#KVM_GUESTDBG_ENABLE
 0x00000001

	)

305 
	#KVM_GUESTDBG_SINGLESTEP
 0x00000002

	)

307 
	skvm_gue¡_debug
 {

308 
__u32
 
	mcÚŒŞ
;

309 
__u32
 
	m·d
;

310 
kvm_gue¡_debug_¬ch
 
	m¬ch
;

314 
	mkvm_iÛv’tfd_æag_Ä_d©am©ch
,

315 
	mkvm_iÛv’tfd_æag_Ä_pio
,

316 
	mkvm_iÛv’tfd_æag_Ä_d—ssign
,

317 
	mkvm_iÛv’tfd_æag_Ä_max
,

320 
	#KVM_IOEVENTFD_FLAG_DATAMATCH
 (1 << 
kvm_iÛv’tfd_æag_Ä_d©am©ch
)

	)

321 
	#KVM_IOEVENTFD_FLAG_PIO
 (1 << 
kvm_iÛv’tfd_æag_Ä_pio
)

	)

322 
	#KVM_IOEVENTFD_FLAG_DEASSIGN
 (1 << 
kvm_iÛv’tfd_æag_Ä_d—ssign
)

	)

324 
	#KVM_IOEVENTFD_VALID_FLAG_MASK
 ((1 << 
kvm_iÛv’tfd_æag_Ä_max
è- 1)

	)

326 
	skvm_iÛv’tfd
 {

327 
__u64
 
	md©am©ch
;

328 
__u64
 
	maddr
;

329 
__u32
 
	mËn
;

330 
__s32
 
	mfd
;

331 
__u32
 
	mæags
;

332 
__u8
 
	m·d
[36];

335 
	#KVM_TRC_SHIFT
 16

	)

339 
	#KVM_TRC_ENTRYEXIT
 (1 << 
KVM_TRC_SHIFT
)

	)

340 
	#KVM_TRC_HANDLER
 (1 << (
KVM_TRC_SHIFT
 + 1)è

	)

345 
	#KVM_TRC_VMENTRY
 (
KVM_TRC_ENTRYEXIT
 + 0x01)

	)

346 
	#KVM_TRC_VMEXIT
 (
KVM_TRC_ENTRYEXIT
 + 0x02)

	)

347 
	#KVM_TRC_PAGE_FAULT
 (
KVM_TRC_HANDLER
 + 0x01)

	)

349 
	#KVM_TRC_HEAD_SIZE
 12

	)

350 
	#KVM_TRC_CYCLE_SIZE
 8

	)

351 
	#KVM_TRC_EXTRA_MAX
 7

	)

353 
	#KVMIO
 0xAE

	)

358 
	#KVM_GET_API_VERSION
 
	`_IO
(
KVMIO
, 0x00)

	)

359 
	#KVM_CREATE_VM
 
	`_IO
(
KVMIO
, 0x01è

	)

360 
	#KVM_GET_MSR_INDEX_LIST
 
	`_IOWR
(
KVMIO
, 0x02, 
kvm_m¤_li¡
)

	)

362 
	#KVM_S390_ENABLE_SIE
 
	`_IO
(
KVMIO
, 0x06)

	)

367 
	#KVM_CHECK_EXTENSION
 
	`_IO
(
KVMIO
, 0x03)

	)

371 
	#KVM_GET_VCPU_MMAP_SIZE
 
	`_IO
(
KVMIO
, 0x04è

	)

372 
	#KVM_GET_SUPPORTED_CPUID
 
	`_IOWR
(
KVMIO
, 0x05, 
kvm_ıuid2
)

	)

376 
	#KVM_TRACE_ENABLE
 
	`_IOW
(
KVMIO
, 0x06, 
kvm_u£r_Œaû_£tup
)

	)

377 
	#KVM_TRACE_PAUSE
 
	`_IO
(
KVMIO
, 0x07)

	)

378 
	#KVM_TRACE_DISABLE
 
	`_IO
(
KVMIO
, 0x08)

	)

382 
	#KVM_CAP_IRQCHIP
 0

	)

383 
	#KVM_CAP_HLT
 1

	)

384 
	#KVM_CAP_MMU_SHADOW_CACHE_CONTROL
 2

	)

385 
	#KVM_CAP_USER_MEMORY
 3

	)

386 
	#KVM_CAP_SET_TSS_ADDR
 4

	)

387 
	#KVM_CAP_VAPIC
 6

	)

388 
	#KVM_CAP_EXT_CPUID
 7

	)

389 
	#KVM_CAP_CLOCKSOURCE
 8

	)

390 
	#KVM_CAP_NR_VCPUS
 9

	)

391 
	#KVM_CAP_NR_MEMSLOTS
 10

	)

392 
	#KVM_CAP_PIT
 11

	)

393 
	#KVM_CAP_NOP_IO_DELAY
 12

	)

394 
	#KVM_CAP_PV_MMU
 13

	)

395 
	#KVM_CAP_MP_STATE
 14

	)

396 
	#KVM_CAP_COALESCED_MMIO
 15

	)

397 
	#KVM_CAP_SYNC_MMU
 16

	)

398 #ifdeà
__KVM_HAVE_DEVICE_ASSIGNMENT


399 
	#KVM_CAP_DEVICE_ASSIGNMENT
 17

	)

401 
	#KVM_CAP_IOMMU
 18

	)

402 #ifdeà
__KVM_HAVE_MSI


403 
	#KVM_CAP_DEVICE_MSI
 20

	)

406 
	#KVM_CAP_DESTROY_MEMORY_REGION_WORKS
 21

	)

407 #ifdeà
__KVM_HAVE_USER_NMI


408 
	#KVM_CAP_USER_NMI
 22

	)

410 #ifdeà
__KVM_HAVE_GUEST_DEBUG


411 
	#KVM_CAP_SET_GUEST_DEBUG
 23

	)

413 #ifdeà
__KVM_HAVE_PIT


414 
	#KVM_CAP_REINJECT_CONTROL
 24

	)

416 #ifdeà
__KVM_HAVE_IOAPIC


417 
	#KVM_CAP_IRQ_ROUTING
 25

	)

419 
	#KVM_CAP_IRQ_INJECT_STATUS
 26

	)

420 #ifdeà
__KVM_HAVE_DEVICE_ASSIGNMENT


421 
	#KVM_CAP_DEVICE_DEASSIGNMENT
 27

	)

423 #ifdeà
__KVM_HAVE_MSIX


424 
	#KVM_CAP_DEVICE_MSIX
 28

	)

426 
	#KVM_CAP_ASSIGN_DEV_IRQ
 29

	)

428 
	#KVM_CAP_JOIN_MEMORY_REGIONS_WORKS
 30

	)

429 #ifdeà
__KVM_HAVE_MCE


430 
	#KVM_CAP_MCE
 31

	)

432 
	#KVM_CAP_IRQFD
 32

	)

433 #ifdeà
__KVM_HAVE_PIT


434 
	#KVM_CAP_PIT2
 33

	)

436 
	#KVM_CAP_SET_BOOT_CPU_ID
 34

	)

437 #ifdeà
__KVM_HAVE_PIT_STATE2


438 
	#KVM_CAP_PIT_STATE2
 35

	)

440 
	#KVM_CAP_IOEVENTFD
 36

	)

441 
	#KVM_CAP_SET_IDENTITY_MAP_ADDR
 37

	)

442 
	#KVM_CAP_ADJUST_CLOCK
 39

	)

444 #ifdeà
KVM_CAP_IRQ_ROUTING


446 
	skvm_œq_routšg_œqch
 {

447 
__u32
 
	mœqch
;

448 
__u32
 
	mpš
;

451 
	skvm_œq_routšg_msi
 {

452 
__u32
 
	madd»ss_lo
;

453 
__u32
 
	madd»ss_hi
;

454 
__u32
 
	md©a
;

455 
__u32
 
	m·d
;

459 
	#KVM_IRQ_ROUTING_IRQCHIP
 1

	)

460 
	#KVM_IRQ_ROUTING_MSI
 2

	)

462 
	skvm_œq_routšg_’Œy
 {

463 
__u32
 
	mgsi
;

464 
__u32
 
	mty³
;

465 
__u32
 
	mæags
;

466 
__u32
 
	m·d
;

468 
kvm_œq_routšg_œqch
 
	mœqch
;

469 
kvm_œq_routšg_msi
 
	mmsi
;

470 
__u32
 
	m·d
[8];

471 } 
	mu
;

474 
	skvm_œq_routšg
 {

475 
__u32
 
	mÄ
;

476 
__u32
 
	mæags
;

477 
kvm_œq_routšg_’Œy
 
	m’Œ›s
[0];

481 
	#KVM_CAP_S390_PSW
 42

	)

483 #ifdeà
KVM_CAP_MCE


485 
	skvm_x86_mû
 {

486 
__u64
 
	m¡©us
;

487 
__u64
 
	maddr
;

488 
__u64
 
	mmisc
;

489 
__u64
 
	mmcg_¡©us
;

490 
__u8
 
	mbªk
;

491 
__u8
 
	m·d1
[7];

492 
__u64
 
	m·d2
[3];

496 
	#KVM_IRQFD_FLAG_DEASSIGN
 (1 << 0)

	)

498 
	skvm_œqfd
 {

499 
__u32
 
	mfd
;

500 
__u32
 
	mgsi
;

501 
__u32
 
	mæags
;

502 
__u8
 
	m·d
[20];

505 
	skvm_şock_d©a
 {

506 
__u64
 
	mşock
;

507 
__u32
 
	mæags
;

508 
__u32
 
	m·d
[9];

514 
	#KVM_SET_MEMORY_REGION
 
	`_IOW
(
KVMIO
, 0x40, 
kvm_memÜy_»giÚ
)

	)

519 
	#KVM_CREATE_VCPU
 
	`_IO
(
KVMIO
, 0x41)

	)

520 
	#KVM_GET_DIRTY_LOG
 
	`_IOW
(
KVMIO
, 0x42, 
kvm_dœty_log
)

	)

521 
	#KVM_SET_MEMORY_ALIAS
 
	`_IOW
(
KVMIO
, 0x43, 
kvm_memÜy_®Ÿs
)

	)

522 
	#KVM_SET_NR_MMU_PAGES
 
	`_IO
(
KVMIO
, 0x44)

	)

523 
	#KVM_GET_NR_MMU_PAGES
 
	`_IO
(
KVMIO
, 0x45)

	)

524 
	#KVM_SET_USER_MEMORY_REGION
 
	`_IOW
(
KVMIO
, 0x46,\

525 
kvm_u£r¥aû_memÜy_»giÚ
)

	)

526 
	#KVM_SET_TSS_ADDR
 
	`_IO
(
KVMIO
, 0x47)

	)

527 
	#KVM_SET_IDENTITY_MAP_ADDR
 
	`_IOW
(
KVMIO
, 0x48, 
__u64
)

	)

529 
	#KVM_CREATE_IRQCHIP
 
	`_IO
(
KVMIO
, 0x60)

	)

530 
	#KVM_IRQ_LINE
 
	`_IOW
(
KVMIO
, 0x61, 
kvm_œq_Ëv–
)

	)

531 
	#KVM_GET_IRQCHIP
 
	`_IOWR
(
KVMIO
, 0x62, 
kvm_œqch
)

	)

532 
	#KVM_SET_IRQCHIP
 
	`_IOR
(
KVMIO
, 0x63, 
kvm_œqch
)

	)

533 
	#KVM_CREATE_PIT
 
	`_IO
(
KVMIO
, 0x64)

	)

534 
	#KVM_GET_PIT
 
	`_IOWR
(
KVMIO
, 0x65, 
kvm_p™_¡©e
)

	)

535 
	#KVM_SET_PIT
 
	`_IOR
(
KVMIO
, 0x66, 
kvm_p™_¡©e
)

	)

536 
	#KVM_IRQ_LINE_STATUS
 
	`_IOWR
(
KVMIO
, 0x67, 
kvm_œq_Ëv–
)

	)

537 
	#KVM_REGISTER_COALESCED_MMIO
 \

538 
	`_IOW
(
KVMIO
, 0x67, 
kvm_cßËsûd_mmio_zÚe
)

	)

539 
	#KVM_UNREGISTER_COALESCED_MMIO
 \

540 
	`_IOW
(
KVMIO
, 0x68, 
kvm_cßËsûd_mmio_zÚe
)

	)

541 
	#KVM_ASSIGN_PCI_DEVICE
 
	`_IOR
(
KVMIO
, 0x69, \

542 
kvm_assigÃd_pci_dev
)

	)

543 
	#KVM_SET_GSI_ROUTING
 
	`_IOW
(
KVMIO
, 0x6a, 
kvm_œq_routšg
)

	)

545 
	#KVM_ASSIGN_IRQ
 
	`_IOR
(
KVMIO
, 0x70, \

546 
kvm_assigÃd_œq
)

	)

547 
	#KVM_ASSIGN_DEV_IRQ
 
	`_IOW
(
KVMIO
, 0x70, 
kvm_assigÃd_œq
)

	)

548 
	#KVM_REINJECT_CONTROL
 
	`_IO
(
KVMIO
, 0x71)

	)

549 
	#KVM_DEASSIGN_PCI_DEVICE
 
	`_IOW
(
KVMIO
, 0x72, \

550 
kvm_assigÃd_pci_dev
)

	)

551 
	#KVM_ASSIGN_SET_MSIX_NR
 \

552 
	`_IOW
(
KVMIO
, 0x73, 
kvm_assigÃd_msix_Ä
)

	)

553 
	#KVM_ASSIGN_SET_MSIX_ENTRY
 \

554 
	`_IOW
(
KVMIO
, 0x74, 
kvm_assigÃd_msix_’Œy
)

	)

555 
	#KVM_DEASSIGN_DEV_IRQ
 
	`_IOW
(
KVMIO
, 0x75, 
kvm_assigÃd_œq
)

	)

556 
	#KVM_IRQFD
 
	`_IOW
(
KVMIO
, 0x76, 
kvm_œqfd
)

	)

557 
	#KVM_CREATE_PIT2
 
	`_IOW
(
KVMIO
, 0x77, 
kvm_p™_cÚfig
)

	)

558 
	#KVM_SET_BOOT_CPU_ID
 
	`_IO
(
KVMIO
, 0x78)

	)

559 
	#KVM_IOEVENTFD
 
	`_IOW
(
KVMIO
, 0x79, 
kvm_iÛv’tfd
)

	)

560 
	#KVM_SET_CLOCK
 
	`_IOW
(
KVMIO
, 0x7b, 
kvm_şock_d©a
)

	)

561 
	#KVM_GET_CLOCK
 
	`_IOR
(
KVMIO
, 0x7c, 
kvm_şock_d©a
)

	)

566 
	#KVM_RUN
 
	`_IO
(
KVMIO
, 0x80)

	)

567 
	#KVM_GET_REGS
 
	`_IOR
(
KVMIO
, 0x81, 
kvm_»gs
)

	)

568 
	#KVM_SET_REGS
 
	`_IOW
(
KVMIO
, 0x82, 
kvm_»gs
)

	)

569 
	#KVM_GET_SREGS
 
	`_IOR
(
KVMIO
, 0x83, 
kvm_¤egs
)

	)

570 
	#KVM_SET_SREGS
 
	`_IOW
(
KVMIO
, 0x84, 
kvm_¤egs
)

	)

571 
	#KVM_TRANSLATE
 
	`_IOWR
(
KVMIO
, 0x85, 
kvm_Œª¦©iÚ
)

	)

572 
	#KVM_INTERRUPT
 
	`_IOW
(
KVMIO
, 0x86, 
kvm_š‹¼u±
)

	)

574 
	#KVM_DEBUG_GUEST
 
__KVM_DEPRECATED_DEBUG_GUEST


	)

575 
	#KVM_GET_MSRS
 
	`_IOWR
(
KVMIO
, 0x88, 
kvm_m¤s
)

	)

576 
	#KVM_SET_MSRS
 
	`_IOW
(
KVMIO
, 0x89, 
kvm_m¤s
)

	)

577 
	#KVM_SET_CPUID
 
	`_IOW
(
KVMIO
, 0x8a, 
kvm_ıuid
)

	)

578 
	#KVM_SET_SIGNAL_MASK
 
	`_IOW
(
KVMIO
, 0x8b, 
kvm_sigÇl_mask
)

	)

579 
	#KVM_GET_FPU
 
	`_IOR
(
KVMIO
, 0x8c, 
kvm_åu
)

	)

580 
	#KVM_SET_FPU
 
	`_IOW
(
KVMIO
, 0x8d, 
kvm_åu
)

	)

581 
	#KVM_GET_LAPIC
 
	`_IOR
(
KVMIO
, 0x8e, 
kvm_Ïpic_¡©e
)

	)

582 
	#KVM_SET_LAPIC
 
	`_IOW
(
KVMIO
, 0x8f, 
kvm_Ïpic_¡©e
)

	)

583 
	#KVM_SET_CPUID2
 
	`_IOW
(
KVMIO
, 0x90, 
kvm_ıuid2
)

	)

584 
	#KVM_GET_CPUID2
 
	`_IOWR
(
KVMIO
, 0x91, 
kvm_ıuid2
)

	)

586 
	#KVM_TPR_ACCESS_REPORTING
 
	`_IOWR
(
KVMIO
, 0x92, 
kvm_r_acûss_ùl
)

	)

588 
	#KVM_SET_VAPIC_ADDR
 
	`_IOW
(
KVMIO
, 0x93, 
kvm_v­ic_addr
)

	)

590 
	#KVM_S390_INTERRUPT
 
	`_IOW
(
KVMIO
, 0x94, 
kvm_s390_š‹¼u±
)

	)

592 
	#KVM_S390_STORE_STATUS_NOADDR
 (-1ul)

	)

593 
	#KVM_S390_STORE_STATUS_PREFIXED
 (-2ul)

	)

594 
	#KVM_S390_STORE_STATUS
 
	`_IOW
(
KVMIO
, 0x95, )

	)

596 
	#KVM_S390_SET_INITIAL_PSW
 
	`_IOW
(
KVMIO
, 0x96, 
kvm_s390_psw
)

	)

598 
	#KVM_S390_INITIAL_RESET
 
	`_IO
(
KVMIO
, 0x97)

	)

599 
	#KVM_GET_MP_STATE
 
	`_IOR
(
KVMIO
, 0x98, 
kvm_mp_¡©e
)

	)

600 
	#KVM_SET_MP_STATE
 
	`_IOW
(
KVMIO
, 0x99, 
kvm_mp_¡©e
)

	)

602 
	#KVM_NMI
 
	`_IO
(
KVMIO
, 0x9a)

	)

604 
	#KVM_SET_GUEST_DEBUG
 
	`_IOW
(
KVMIO
, 0x9b, 
kvm_gue¡_debug
)

	)

606 
	#KVM_X86_SETUP_MCE
 
	`_IOW
(
KVMIO
, 0x9c, 
__u64
)

	)

607 
	#KVM_X86_GET_MCE_CAP_SUPPORTED
 
	`_IOR
(
KVMIO
, 0x9d, 
__u64
)

	)

608 
	#KVM_X86_SET_MCE
 
	`_IOW
(
KVMIO
, 0x9e, 
kvm_x86_mû
)

	)

613 
	skvm_b»akpošt
 {

614 
__u32
 
	m’abËd
;

615 
__u32
 
	m·ddšg
;

616 
__u64
 
	madd»ss
;

619 
	skvm_debug_gue¡
 {

620 
__u32
 
	m’abËd
;

621 
__u32
 
	m·d
;

622 
kvm_b»akpošt
 
	mb»akpošts
[4];

623 
__u32
 
	msšgË¡•
;

626 
	#__KVM_DEPRECATED_DEBUG_GUEST
 
	`_IOW
(
KVMIO
, 0x87, 
kvm_debug_gue¡
)

	)

628 
	#KVM_IA64_VCPU_GET_STACK
 
	`_IOR
(
KVMIO
, 0x9a, *)

	)

629 
	#KVM_IA64_VCPU_SET_STACK
 
	`_IOW
(
KVMIO
, 0x9b, *)

	)

631 
	#KVM_GET_PIT2
 
	`_IOR
(
KVMIO
, 0x9f, 
kvm_p™_¡©e2
)

	)

632 
	#KVM_SET_PIT2
 
	`_IOW
(
KVMIO
, 0xa0, 
kvm_p™_¡©e2
)

	)

634 
	#KVM_TRC_INJ_VIRQ
 (
KVM_TRC_HANDLER
 + 0x02)

	)

635 
	#KVM_TRC_REDELIVER_EVT
 (
KVM_TRC_HANDLER
 + 0x03)

	)

636 
	#KVM_TRC_PEND_INTR
 (
KVM_TRC_HANDLER
 + 0x04)

	)

637 
	#KVM_TRC_IO_READ
 (
KVM_TRC_HANDLER
 + 0x05)

	)

638 
	#KVM_TRC_IO_WRITE
 (
KVM_TRC_HANDLER
 + 0x06)

	)

639 
	#KVM_TRC_CR_READ
 (
KVM_TRC_HANDLER
 + 0x07)

	)

640 
	#KVM_TRC_CR_WRITE
 (
KVM_TRC_HANDLER
 + 0x08)

	)

641 
	#KVM_TRC_DR_READ
 (
KVM_TRC_HANDLER
 + 0x09)

	)

642 
	#KVM_TRC_DR_WRITE
 (
KVM_TRC_HANDLER
 + 0x0A)

	)

643 
	#KVM_TRC_MSR_READ
 (
KVM_TRC_HANDLER
 + 0x0B)

	)

644 
	#KVM_TRC_MSR_WRITE
 (
KVM_TRC_HANDLER
 + 0x0C)

	)

645 
	#KVM_TRC_CPUID
 (
KVM_TRC_HANDLER
 + 0x0D)

	)

646 
	#KVM_TRC_INTR
 (
KVM_TRC_HANDLER
 + 0x0E)

	)

647 
	#KVM_TRC_NMI
 (
KVM_TRC_HANDLER
 + 0x0F)

	)

648 
	#KVM_TRC_VMMCALL
 (
KVM_TRC_HANDLER
 + 0x10)

	)

649 
	#KVM_TRC_HLT
 (
KVM_TRC_HANDLER
 + 0x11)

	)

650 
	#KVM_TRC_CLTS
 (
KVM_TRC_HANDLER
 + 0x12)

	)

651 
	#KVM_TRC_LMSW
 (
KVM_TRC_HANDLER
 + 0x13)

	)

652 
	#KVM_TRC_APIC_ACCESS
 (
KVM_TRC_HANDLER
 + 0x14)

	)

653 
	#KVM_TRC_TDP_FAULT
 (
KVM_TRC_HANDLER
 + 0x15)

	)

654 
	#KVM_TRC_GTLB_WRITE
 (
KVM_TRC_HANDLER
 + 0x16)

	)

655 
	#KVM_TRC_STLB_WRITE
 (
KVM_TRC_HANDLER
 + 0x17)

	)

656 
	#KVM_TRC_STLB_INVAL
 (
KVM_TRC_HANDLER
 + 0x18)

	)

657 
	#KVM_TRC_PPC_INSTR
 (
KVM_TRC_HANDLER
 + 0x19)

	)

659 
	#KVM_DEV_ASSIGN_ENABLE_IOMMU
 (1 << 0)

	)

661 
	skvm_assigÃd_pci_dev
 {

662 
__u32
 
	massigÃd_dev_id
;

663 
__u32
 
	mbu¢r
;

664 
__u32
 
	mdevâ
;

665 
__u32
 
	mæags
;

667 
__u32
 
	m»£rved
[12];

671 
	#KVM_DEV_IRQ_HOST_INTX
 (1 << 0)

	)

672 
	#KVM_DEV_IRQ_HOST_MSI
 (1 << 1)

	)

673 
	#KVM_DEV_IRQ_HOST_MSIX
 (1 << 2)

	)

675 
	#KVM_DEV_IRQ_GUEST_INTX
 (1 << 8)

	)

676 
	#KVM_DEV_IRQ_GUEST_MSI
 (1 << 9)

	)

677 
	#KVM_DEV_IRQ_GUEST_MSIX
 (1 << 10)

	)

679 
	#KVM_DEV_IRQ_HOST_MASK
 0x00ff

	)

680 
	#KVM_DEV_IRQ_GUEST_MASK
 0xff00

	)

682 
	skvm_assigÃd_œq
 {

683 
__u32
 
	massigÃd_dev_id
;

684 
__u32
 
	mho¡_œq
;

685 
__u32
 
	mgue¡_œq
;

686 
__u32
 
	mæags
;

689 
__u32
 
	maddr_lo
;

690 
__u32
 
	maddr_hi
;

691 
__u32
 
	md©a
;

692 } 
	mgue¡_msi
;

693 
__u32
 
	m»£rved
[12];

698 
	skvm_assigÃd_msix_Ä
 {

699 
__u32
 
	massigÃd_dev_id
;

700 
__u16
 
	m’Œy_Ä
;

701 
__u16
 
	m·ddšg
;

704 
	#KVM_MAX_MSIX_PER_DEV
 256

	)

705 
	skvm_assigÃd_msix_’Œy
 {

706 
__u32
 
	massigÃd_dev_id
;

707 
__u32
 
	mgsi
;

708 
__u16
 
	m’Œy
;

709 
__u16
 
	m·ddšg
[3];

	@/usr/include/linux/perf_event.h

14 #iâdeà
_LINUX_PERF_EVENT_H


15 
	#_LINUX_PERF_EVENT_H


	)

17 
	~<lšux/ty³s.h
>

18 
	~<lšux/ioùl.h
>

19 
	~<asm/by‹Üd”.h
>

28 
	e³rf_ty³_id
 {

29 
	mPERF_TYPE_HARDWARE
 = 0,

30 
	mPERF_TYPE_SOFTWARE
 = 1,

31 
	mPERF_TYPE_TRACEPOINT
 = 2,

32 
	mPERF_TYPE_HW_CACHE
 = 3,

33 
	mPERF_TYPE_RAW
 = 4,

35 
	mPERF_TYPE_MAX
,

43 
	e³rf_hw_id
 {

47 
	mPERF_COUNT_HW_CPU_CYCLES
 = 0,

48 
	mPERF_COUNT_HW_INSTRUCTIONS
 = 1,

49 
	mPERF_COUNT_HW_CACHE_REFERENCES
 = 2,

50 
	mPERF_COUNT_HW_CACHE_MISSES
 = 3,

51 
	mPERF_COUNT_HW_BRANCH_INSTRUCTIONS
 = 4,

52 
	mPERF_COUNT_HW_BRANCH_MISSES
 = 5,

53 
	mPERF_COUNT_HW_BUS_CYCLES
 = 6,

55 
	mPERF_COUNT_HW_MAX
,

65 
	e³rf_hw_ÿche_id
 {

66 
	mPERF_COUNT_HW_CACHE_L1D
 = 0,

67 
	mPERF_COUNT_HW_CACHE_L1I
 = 1,

68 
	mPERF_COUNT_HW_CACHE_LL
 = 2,

69 
	mPERF_COUNT_HW_CACHE_DTLB
 = 3,

70 
	mPERF_COUNT_HW_CACHE_ITLB
 = 4,

71 
	mPERF_COUNT_HW_CACHE_BPU
 = 5,

73 
	mPERF_COUNT_HW_CACHE_MAX
,

76 
	e³rf_hw_ÿche_İ_id
 {

77 
	mPERF_COUNT_HW_CACHE_OP_READ
 = 0,

78 
	mPERF_COUNT_HW_CACHE_OP_WRITE
 = 1,

79 
	mPERF_COUNT_HW_CACHE_OP_PREFETCH
 = 2,

81 
	mPERF_COUNT_HW_CACHE_OP_MAX
,

84 
	e³rf_hw_ÿche_İ_»suÉ_id
 {

85 
	mPERF_COUNT_HW_CACHE_RESULT_ACCESS
 = 0,

86 
	mPERF_COUNT_HW_CACHE_RESULT_MISS
 = 1,

88 
	mPERF_COUNT_HW_CACHE_RESULT_MAX
,

97 
	e³rf_sw_ids
 {

98 
	mPERF_COUNT_SW_CPU_CLOCK
 = 0,

99 
	mPERF_COUNT_SW_TASK_CLOCK
 = 1,

100 
	mPERF_COUNT_SW_PAGE_FAULTS
 = 2,

101 
	mPERF_COUNT_SW_CONTEXT_SWITCHES
 = 3,

102 
	mPERF_COUNT_SW_CPU_MIGRATIONS
 = 4,

103 
	mPERF_COUNT_SW_PAGE_FAULTS_MIN
 = 5,

104 
	mPERF_COUNT_SW_PAGE_FAULTS_MAJ
 = 6,

106 
	mPERF_COUNT_SW_MAX
,

113 
	e³rf_ev’t_§m¶e_fÜm©
 {

114 
	mPERF_SAMPLE_IP
 = 1U << 0,

115 
	mPERF_SAMPLE_TID
 = 1U << 1,

116 
	mPERF_SAMPLE_TIME
 = 1U << 2,

117 
	mPERF_SAMPLE_ADDR
 = 1U << 3,

118 
	mPERF_SAMPLE_READ
 = 1U << 4,

119 
	mPERF_SAMPLE_CALLCHAIN
 = 1U << 5,

120 
	mPERF_SAMPLE_ID
 = 1U << 6,

121 
	mPERF_SAMPLE_CPU
 = 1U << 7,

122 
	mPERF_SAMPLE_PERIOD
 = 1U << 8,

123 
	mPERF_SAMPLE_STREAM_ID
 = 1U << 9,

124 
	mPERF_SAMPLE_RAW
 = 1U << 10,

126 
	mPERF_SAMPLE_MAX
 = 1U << 11,

149 
	e³rf_ev’t_»ad_fÜm©
 {

150 
	mPERF_FORMAT_TOTAL_TIME_ENABLED
 = 1U << 0,

151 
	mPERF_FORMAT_TOTAL_TIME_RUNNING
 = 1U << 1,

152 
	mPERF_FORMAT_ID
 = 1U << 2,

153 
	mPERF_FORMAT_GROUP
 = 1U << 3,

155 
	mPERF_FORMAT_MAX
 = 1U << 4,

158 
	#PERF_ATTR_SIZE_VER0
 64

	)

163 
	s³rf_ev’t_©Œ
 {

168 
__u32
 
	mty³
;

173 
__u32
 
	msize
;

178 
__u64
 
	mcÚfig
;

181 
__u64
 
	m§m¶e_³riod
;

182 
__u64
 
	m§m¶e_äeq
;

185 
__u64
 
	m§m¶e_ty³
;

186 
__u64
 
	m»ad_fÜm©
;

188 
__u64
 
	mdi§bËd
 : 1,

189 
	mšh”™
 : 1,

190 
	mpšÃd
 : 1,

191 
	mexşusive
 : 1,

192 
	mexşude_u£r
 : 1,

193 
	mexşude_k”Ãl
 : 1,

194 
	mexşude_hv
 : 1,

195 
	mexşude_idË
 : 1,

196 
	mmm­
 : 1,

197 
	mcomm
 : 1,

198 
	mäeq
 : 1,

199 
	mšh”™_¡©
 : 1,

200 
	m’abË_Ú_exec
 : 1,

201 
	msk
 : 1,

202 
	mw©”m¬k
 : 1,

204 
	m__»£rved_1
 : 49;

207 
__u32
 
	mwakeup_ev’ts
;

208 
__u32
 
	mwakeup_w©”m¬k
;

210 
__u32
 
	m__»£rved_2
;

212 
__u64
 
	m__»£rved_3
;

218 
	#PERF_EVENT_IOC_ENABLE
 
	`_IO
 ('$', 0)

	)

219 
	#PERF_EVENT_IOC_DISABLE
 
	`_IO
 ('$', 1)

	)

220 
	#PERF_EVENT_IOC_REFRESH
 
	`_IO
 ('$', 2)

	)

221 
	#PERF_EVENT_IOC_RESET
 
	`_IO
 ('$', 3)

	)

222 
	#PERF_EVENT_IOC_PERIOD
 
	`_IOW
('$', 4, 
__u64
)

	)

223 
	#PERF_EVENT_IOC_SET_OUTPUT
 
	`_IO
 ('$', 5)

	)

225 
	e³rf_ev’t_ioc_æags
 {

226 
	mPERF_IOC_FLAG_GROUP
 = 1U << 0,

232 
	s³rf_ev’t_mm­_·ge
 {

233 
__u32
 
	mv”siÚ
;

234 
__u32
 
	mcom·t_v”siÚ
;

258 
__u32
 
	mlock
;

259 
__u32
 
	mšdex
;

260 
__s64
 
	moff£t
;

261 
__u64
 
	mtime_’abËd
;

262 
__u64
 
	mtime_ruÂšg
;

268 
__u64
 
	m__»£rved
[123];

281 
__u64
 
	md©a_h—d
;

282 
__u64
 
	md©a_
;

285 
	#PERF_RECORD_MISC_CPUMODE_MASK
 (3 << 0)

	)

286 
	#PERF_RECORD_MISC_CPUMODE_UNKNOWN
 (0 << 0)

	)

287 
	#PERF_RECORD_MISC_KERNEL
 (1 << 0)

	)

288 
	#PERF_RECORD_MISC_USER
 (2 << 0)

	)

289 
	#PERF_RECORD_MISC_HYPERVISOR
 (3 << 0)

	)

291 
	s³rf_ev’t_h—d”
 {

292 
__u32
 
	mty³
;

293 
__u16
 
	mmisc
;

294 
__u16
 
	msize
;

297 
	e³rf_ev’t_ty³
 {

313 
	mPERF_RECORD_MMAP
 = 1,

322 
	mPERF_RECORD_LOST
 = 2,

332 
	mPERF_RECORD_COMM
 = 3,

342 
	mPERF_RECORD_EXIT
 = 4,

352 
	mPERF_RECORD_THROTTLE
 = 5,

353 
	mPERF_RECORD_UNTHROTTLE
 = 6,

363 
	mPERF_RECORD_FORK
 = 7,

373 
	mPERF_RECORD_READ
 = 8,

408 
	mPERF_RECORD_SAMPLE
 = 9,

410 
	mPERF_RECORD_MAX
,

413 
	e³rf_ÿÎchaš_cÚ‹xt
 {

414 
	mPERF_CONTEXT_HV
 = (
__u64
)-32,

415 
	mPERF_CONTEXT_KERNEL
 = (
__u64
)-128,

416 
	mPERF_CONTEXT_USER
 = (
__u64
)-512,

418 
	mPERF_CONTEXT_GUEST
 = (
__u64
)-2048,

419 
	mPERF_CONTEXT_GUEST_KERNEL
 = (
__u64
)-2176,

420 
	mPERF_CONTEXT_GUEST_USER
 = (
__u64
)-2560,

422 
	mPERF_CONTEXT_MAX
 = (
__u64
)-4095,

425 
	#PERF_FLAG_FD_NO_GROUP
 (1U << 0)

	)

426 
	#PERF_FLAG_FD_OUTPUT
 (1U << 1)

	)

	@/usr/include/signal.h

23 #iâdef 
_SIGNAL_H


25 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


26 
	#_SIGNAL_H


	)

29 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


33 
	~<b™s/sig£t.h
>

37 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


38 #iâdeà
__sig_©omic_t_defšed


39 
	#__sig_©omic_t_defšed


	)

40 
__BEGIN_NAMESPACE_STD


41 
__sig_©omic_t
 
	tsig_©omic_t
;

42 
	g__END_NAMESPACE_STD


44 #undeà
__Ãed_sig_©omic_t


47 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

48 #iâdeà
__sig£t_t_defšed


49 
	#__sig£t_t_defšed


	)

50 
__sig£t_t
 
	tsig£t_t
;

52 #undeà
__Ãed_sig£t_t


55 #ifdeà
_SIGNAL_H


57 
	~<b™s/ty³s.h
>

58 
	~<b™s/signum.h
>

60 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


61 #iâdeà
__pid_t_defšed


62 
__pid_t
 
	tpid_t
;

63 
	#__pid_t_defšed


	)

65 #ifdeà
__USE_XOPEN


67 #iâdeà
__uid_t_defšed


68 
__uid_t
 
	tuid_t
;

69 
	#__uid_t_defšed


	)

73 #ifdeà
__USE_POSIX199309


75 
	#__Ãed_time¥ec


	)

76 
	~<time.h
>

79 
	~<b™s/sigšfo.h
>

84 (*
	t__sighªdËr_t
) ();

89 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

90 
__THROW
;

91 #ifdeà
__USE_GNU


92 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

93 
__THROW
;

99 
__BEGIN_NAMESPACE_STD


100 #ifdeà
__USE_BSD


101 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

102 
__THROW
;

105 #ifdeà
__REDIRECT_NTH


106 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

107 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

108 
__sysv_sigÇl
);

110 
	#sigÇl
 
__sysv_sigÇl


	)

113 
__END_NAMESPACE_STD


115 #ifdeà
__USE_XOPEN


118 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

119 
__THROW
;

125 #ifdeà
__USE_POSIX


126 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

129 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


133 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

136 
__BEGIN_NAMESPACE_STD


138 
	$¿i£
 (
__sig
è
__THROW
;

139 
__END_NAMESPACE_STD


141 #ifdeà
__USE_SVID


143 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

144 
__THROW
;

145 
	$gsigÇl
 (
__sig
è
__THROW
;

148 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K


150 
	`psigÇl
 (
__sig
, 
__cÚ¡
 *
__s
);

153 #ifdeà
__USE_XOPEN2K


155 
	`psigšfo
 (
__cÚ¡
 
sigšfo_t
 *
__pšfo
, __cÚ¡ *
__s
);

168 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

170 #ifdeà
__FAVOR_BSD


173 
	$sig·u£
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

175 #ifdeà
__USE_XOPEN


176 #ifdeà
__GNUC__


177 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

180 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

186 #ifdeà
__USE_BSD


193 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

196 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

199 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

202 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

206 #ifdeà
__USE_MISC


207 
	#NSIG
 
_NSIG


	)

210 #ifdeà
__USE_GNU


211 
__sighªdËr_t
 
	tsighªdËr_t
;

215 #ifdeà
__USE_BSD


216 
__sighªdËr_t
 
	tsig_t
;

219 #ifdeà
__USE_POSIX


222 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

228 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

231 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

234 
	$sigismemb”
 (
__cÚ¡
 
sig£t_t
 *
__£t
, 
__signo
)

235 
__THROW
 
	`__nÚnuÎ
 ((1));

237 #ifdeà
__USE_GNU


239 
	$sigi£m±y£t
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

242 
	$sigªd£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

243 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

246 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, 
__cÚ¡
 sig£t_ˆ*
__Ëá
,

247 
__cÚ¡
 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

252 
	~<b™s/sigaùiÚ.h
>

255 
	$sig´ocmask
 (
__how
, 
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

256 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

263 
	$sigsu¥’d
 (
__cÚ¡
 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

266 
	$sigaùiÚ
 (
__sig
, 
__cÚ¡
 
sigaùiÚ
 *
__»¡riù
 
__aù
,

267 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

270 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

277 
	$sigwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

278 
	`__nÚnuÎ
 ((1, 2));

280 #ifdeà
__USE_POSIX199309


285 
	$sigwa™šfo
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

286 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

293 
	$sigtimedwa™
 (
__cÚ¡
 
sig£t_t
 *
__»¡riù
 
__£t
,

294 
sigšfo_t
 *
__»¡riù
 
__šfo
,

295 
__cÚ¡
 
time¥ec
 *
__»¡riù
 
__timeout
)

296 
	`__nÚnuÎ
 ((1));

300 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, 
__cÚ¡
 
sigv®
 
__v®
)

301 
__THROW
;

306 #ifdeà
__USE_BSD


310 
__cÚ¡
 *__cÚ¡ 
_sys_sigli¡
[
_NSIG
];

311 
__cÚ¡
 *__cÚ¡ 
sys_sigli¡
[
_NSIG
];

314 
	ssigvec


316 
__sighªdËr_t
 
sv_hªdËr
;

317 
sv_mask
;

319 
sv_æags
;

320 
	#sv_Ú¡ack
 
sv_æags


	)

324 
	#SV_ONSTACK
 (1 << 0)

	)

325 
	#SV_INTERRUPT
 (1 << 1)

	)

326 
	#SV_RESETHAND
 (1 << 2)

	)

334 
	$sigvec
 (
__sig
, 
__cÚ¡
 
sigvec
 *
__vec
,

335 
sigvec
 *
__ovec
è
__THROW
;

339 
	~<b™s/sigcÚ‹xt.h
>

342 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

347 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


348 
	#__Ãed_size_t


	)

349 
	~<¡ddef.h
>

354 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

356 
	~<b™s/sig¡ack.h
>

357 #ifdeà
__USE_XOPEN


359 
	~<sys/ucÚ‹xt.h
>

365 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

366 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

370 
	$sig®t¡ack
 (
__cÚ¡
 
sig®t¡ack
 *
__»¡riù
 
__ss
,

371 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

375 #ifdeà
__USE_XOPEN_EXTENDED


379 
	$sighŞd
 (
__sig
è
__THROW
;

382 
	$sig»l£
 (
__sig
è
__THROW
;

385 
	$sigignÜe
 (
__sig
è
__THROW
;

388 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

391 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


394 
	~<b™s/±h»adty³s.h
>

395 
	~<b™s/sigth»ad.h
>

402 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

404 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

408 
__END_DECLS


	@/usr/include/stdio.h

24 #iâdeà
_STDIO_H


26 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


27 
	#_STDIO_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	#__Ãed_size_t


	)

33 
	#__Ãed_NULL


	)

34 
	~<¡ddef.h
>

36 
	~<b™s/ty³s.h
>

37 
	#__Ãed_FILE


	)

38 
	#__Ãed___FILE


	)

42 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


45 
	g_IO_FILE
;

47 
__BEGIN_NAMESPACE_STD


49 
_IO_FILE
 
	tFILE
;

50 
	g__END_NAMESPACE_STD


51 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

52 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

53 || 
defšed
 
__USE_POSIX2


54 
	$__USING_NAMESPACE_STD
(
FILE
)

57 
	#__FILE_defšed
 1

	)

59 #undeà
__Ãed_FILE


62 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


65 
_IO_FILE
 
	t__FILE
;

67 
	#____FILE_defšed
 1

	)

69 #undeà
__Ãed___FILE


72 #ifdef 
_STDIO_H


73 
	#_STDIO_USES_IOSTREAM


	)

75 
	~<libio.h
>

77 #ifdeà
__USE_XOPEN


78 #ifdeà
__GNUC__


79 #iâdeà
_VA_LIST_DEFINED


80 
_G_va_li¡
 
	tva_li¡
;

81 
	#_VA_LIST_DEFINED


	)

84 
	~<¡d¬g.h
>

89 
__BEGIN_NAMESPACE_STD


90 #iâdeà
__USE_FILE_OFFSET64


91 
_G_åos_t
 
	tåos_t
;

93 
_G_åos64_t
 
	tåos_t
;

95 
__END_NAMESPACE_STD


96 #ifdeà
__USE_LARGEFILE64


97 
_G_åos64_t
 
	tåos64_t
;

101 
	#_IOFBF
 0

	)

102 
	#_IOLBF
 1

	)

103 
	#_IONBF
 2

	)

107 #iâdeà
BUFSIZ


108 
	#BUFSIZ
 
_IO_BUFSIZ


	)

114 #iâdeà
EOF


115 
	#EOF
 (-1)

	)

121 
	#SEEK_SET
 0

	)

122 
	#SEEK_CUR
 1

	)

123 
	#SEEK_END
 2

	)

126 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


128 
	#P_tmpdœ
 "/tmp"

	)

141 
	~<b™s/¡dio_lim.h
>

145 
_IO_FILE
 *
¡dš
;

146 
_IO_FILE
 *
¡dout
;

147 
_IO_FILE
 *
¡d”r
;

149 
	#¡dš
 
¡dš


	)

150 
	#¡dout
 
¡dout


	)

151 
	#¡d”r
 
¡d”r


	)

153 
__BEGIN_NAMESPACE_STD


155 
	$»move
 (
__cÚ¡
 *
__f’ame
è
__THROW
;

157 
	$»Çme
 (
__cÚ¡
 *
__Şd
, __cÚ¡ *
__Ãw
è
__THROW
;

158 
__END_NAMESPACE_STD


160 #ifdeà
__USE_ATFILE


162 
	$»Çm—t
 (
__Şdfd
, 
__cÚ¡
 *
__Şd
, 
__Ãwfd
,

163 
__cÚ¡
 *
__Ãw
è
__THROW
;

166 
__BEGIN_NAMESPACE_STD


171 #iâdeà
__USE_FILE_OFFSET64


172 
FILE
 *
	$tmpfe
 (è
__wur
;

174 #ifdeà
__REDIRECT


175 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

177 
	#tmpfe
 
tmpfe64


	)

181 #ifdeà
__USE_LARGEFILE64


182 
FILE
 *
	$tmpfe64
 (è
__wur
;

186 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

187 
__END_NAMESPACE_STD


189 #ifdeà
__USE_MISC


192 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

196 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


204 *
	$‹m²am
 (
__cÚ¡
 *
__dœ
, __cÚ¡ *
__pfx
)

205 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

209 
__BEGIN_NAMESPACE_STD


214 
	`fşo£
 (
FILE
 *
__¡»am
);

219 
	`fæush
 (
FILE
 *
__¡»am
);

220 
__END_NAMESPACE_STD


222 #ifdeà
__USE_MISC


229 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

232 #ifdeà
__USE_GNU


239 
	`fşo£®l
 ();

243 
__BEGIN_NAMESPACE_STD


244 #iâdeà
__USE_FILE_OFFSET64


249 
FILE
 *
	$fİ’
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

250 
__cÚ¡
 *
__»¡riù
 
__modes
è
__wur
;

255 
FILE
 *
	$äeİ’
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

256 
__cÚ¡
 *
__»¡riù
 
__modes
,

257 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

259 #ifdeà
__REDIRECT


260 
FILE
 *
	`__REDIRECT
 (
fİ’
, (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

261 
__cÚ¡
 *
__»¡riù
 
__modes
), 
fİ’64
)

262 
__wur
;

263 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

264 
__cÚ¡
 *
__»¡riù
 
__modes
,

265 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

266 
__wur
;

268 
	#fİ’
 
fİ’64


	)

269 
	#äeİ’
 
äeİ’64


	)

272 
__END_NAMESPACE_STD


273 #ifdeà
__USE_LARGEFILE64


274 
FILE
 *
	$fİ’64
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

275 
__cÚ¡
 *
__»¡riù
 
__modes
è
__wur
;

276 
FILE
 *
	$äeİ’64
 (
__cÚ¡
 *
__»¡riù
 
__f’ame
,

277 
__cÚ¡
 *
__»¡riù
 
__modes
,

278 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

281 #ifdef 
__USE_POSIX


283 
FILE
 *
	$fdİ’
 (
__fd
, 
__cÚ¡
 *
__modes
è
__THROW
 
__wur
;

286 #ifdef 
__USE_GNU


289 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

290 
__cÚ¡
 *
__»¡riù
 
__modes
,

291 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

294 #ifdeà
__USE_XOPEN2K8


296 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, 
__cÚ¡
 *
__modes
)

297 
__THROW
 
__wur
;

302 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

306 
__BEGIN_NAMESPACE_STD


309 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

313 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

314 
__modes
, 
size_t
 
__n
è
__THROW
;

315 
__END_NAMESPACE_STD


317 #ifdef 
__USE_BSD


320 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

321 
size_t
 
__size
è
__THROW
;

324 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

328 
__BEGIN_NAMESPACE_STD


333 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

334 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

339 
	`´štf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

341 
	$¥rštf
 (*
__»¡riù
 
__s
,

342 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

348 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

349 
_G_va_li¡
 
__¬g
);

354 
	`v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

356 
	$v¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

357 
_G_va_li¡
 
__¬g
è
__THROW
;

358 
__END_NAMESPACE_STD


360 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


361 
__BEGIN_NAMESPACE_C99


363 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

364 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...)

365 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

367 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

368 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

369 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

370 
__END_NAMESPACE_C99


373 #ifdeà
__USE_GNU


376 
	$va¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__f
,

377 
_G_va_li¡
 
__¬g
)

378 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

379 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

380 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

381 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

382 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

383 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

384 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

387 #ifdeà
__USE_XOPEN2K8


394 
	$vd´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
,

395 
_G_va_li¡
 
__¬g
)

396 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

397 
	$d´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

398 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

402 
__BEGIN_NAMESPACE_STD


407 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

408 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

413 
	$sÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

415 
	$ssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

416 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

418 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

419 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

420 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

421 #ifdeà
__REDIRECT


425 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

426 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

427 
__isoc99_fsÿnf
è
__wur
;

428 
	`__REDIRECT
 (
sÿnf
, (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

429 
__isoc99_sÿnf
è
__wur
;

430 
	`__REDIRECT
 (
ssÿnf
, (
__cÚ¡
 *
__»¡riù
 
__s
,

431 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...),

432 
__isoc99_ssÿnf
è
__THROW
;

434 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

435 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

436 
	$__isoc99_sÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__wur
;

437 
	$__isoc99_ssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

438 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

439 
	#fsÿnf
 
__isoc99_fsÿnf


	)

440 
	#sÿnf
 
__isoc99_sÿnf


	)

441 
	#ssÿnf
 
__isoc99_ssÿnf


	)

445 
__END_NAMESPACE_STD


447 #ifdef 
__USE_ISOC99


448 
__BEGIN_NAMESPACE_C99


453 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fÜm©
,

454 
_G_va_li¡
 
__¬g
)

455 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

461 
	$vsÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

462 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

465 
	$vssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

466 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

467 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

469 #ià!
defšed
 
__USE_GNU
 \

470 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

471 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

472 #ifdeà
__REDIRECT


476 
	`__REDIRECT
 (
vfsÿnf
,

477 (
FILE
 *
__»¡riù
 
__s
,

478 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

479 
__isoc99_vfsÿnf
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

481 
	`__REDIRECT
 (
vsÿnf
, (
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

482 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

483 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

484 
	`__REDIRECT
 (
vssÿnf
,

485 (
__cÚ¡
 *
__»¡riù
 
__s
,

486 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

487 
__isoc99_vssÿnf
)

488 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

490 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

491 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

492 
_G_va_li¡
 
__¬g
è
__wur
;

493 
	$__isoc99_vsÿnf
 (
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

494 
_G_va_li¡
 
__¬g
è
__wur
;

495 
	$__isoc99_vssÿnf
 (
__cÚ¡
 *
__»¡riù
 
__s
,

496 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

497 
_G_va_li¡
 
__¬g
è
__THROW
;

498 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

499 
	#vsÿnf
 
__isoc99_vsÿnf


	)

500 
	#vssÿnf
 
__isoc99_vssÿnf


	)

504 
__END_NAMESPACE_C99


508 
__BEGIN_NAMESPACE_STD


513 
	`fg‘c
 (
FILE
 *
__¡»am
);

514 
	`g‘c
 (
FILE
 *
__¡»am
);

520 
	`g‘ch¬
 ();

521 
__END_NAMESPACE_STD


525 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

527 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


532 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

533 
	`g‘ch¬_uÆocked
 ();

536 #ifdeà
__USE_MISC


543 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

547 
__BEGIN_NAMESPACE_STD


555 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

556 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

562 
	`putch¬
 (
__c
);

563 
__END_NAMESPACE_STD


567 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

569 #ifdeà
__USE_MISC


576 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

579 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


584 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

585 
	`putch¬_uÆocked
 (
__c
);

589 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

590 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

592 
	`g‘w
 (
FILE
 *
__¡»am
);

595 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

599 
__BEGIN_NAMESPACE_STD


604 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

605 
__wur
;

612 *
	$g‘s
 (*
__s
è
__wur
;

613 
__END_NAMESPACE_STD


615 #ifdeà
__USE_GNU


622 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

623 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

627 #ifdef 
__USE_XOPEN2K8


638 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

639 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

640 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

641 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

642 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

643 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

651 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

652 
size_t
 *
__»¡riù
 
__n
,

653 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

657 
__BEGIN_NAMESPACE_STD


662 
	`åuts
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

668 
	`puts
 (
__cÚ¡
 *
__s
);

675 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

682 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

683 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

688 
size_t
 
	`fwr™e
 (
__cÚ¡
 *
__»¡riù
 
__±r
, size_ˆ
__size
,

689 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

690 
__END_NAMESPACE_STD


692 #ifdeà
__USE_GNU


699 
	`åuts_uÆocked
 (
__cÚ¡
 *
__»¡riù
 
__s
,

700 
FILE
 *
__»¡riù
 
__¡»am
);

703 #ifdeà
__USE_MISC


710 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

711 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

712 
size_t
 
	`fwr™e_uÆocked
 (
__cÚ¡
 *
__»¡riù
 
__±r
, size_ˆ
__size
,

713 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

717 
__BEGIN_NAMESPACE_STD


722 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

727 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

732 
	`»wšd
 (
FILE
 *
__¡»am
);

733 
__END_NAMESPACE_STD


740 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


741 #iâdeà
__USE_FILE_OFFSET64


746 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

751 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

753 #ifdeà
__REDIRECT


754 
	`__REDIRECT
 (
f£eko
,

755 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

756 
f£eko64
);

757 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

759 
	#f£eko
 
f£eko64


	)

760 
	#á–lo
 
á–lo64


	)

765 
__BEGIN_NAMESPACE_STD


766 #iâdeà
__USE_FILE_OFFSET64


771 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

776 
	`f£os
 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos_t
 *
__pos
);

778 #ifdeà
__REDIRECT


779 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

780 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

781 
	`__REDIRECT
 (
f£os
,

782 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos_t
 *
__pos
), 
f£os64
);

784 
	#fg‘pos
 
fg‘pos64


	)

785 
	#f£os
 
f£os64


	)

788 
__END_NAMESPACE_STD


790 #ifdeà
__USE_LARGEFILE64


791 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

792 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

793 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

794 
	`f£os64
 (
FILE
 *
__¡»am
, 
__cÚ¡
 
åos64_t
 *
__pos
);

797 
__BEGIN_NAMESPACE_STD


799 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

801 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

803 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

804 
__END_NAMESPACE_STD


806 #ifdeà
__USE_MISC


808 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

809 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

810 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

814 
__BEGIN_NAMESPACE_STD


819 
	`³¼Ü
 (
__cÚ¡
 *
__s
);

820 
__END_NAMESPACE_STD


826 
	~<b™s/sys_”¾i¡.h
>

829 #ifdef 
__USE_POSIX


831 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

834 #ifdeà
__USE_MISC


836 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

840 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

841 
defšed
 
__USE_MISC
)

846 
FILE
 *
	$pİ’
 (
__cÚ¡
 *
__commªd
, __cÚ¡ *
__modes
è
__wur
;

852 
	`pşo£
 (
FILE
 *
__¡»am
);

856 #ifdef 
__USE_POSIX


858 *
	$ù”mid
 (*
__s
è
__THROW
;

862 #ifdeà
__USE_XOPEN


864 *
	`cu£rid
 (*
__s
);

868 #ifdef 
__USE_GNU


869 
ob¡ack
;

872 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

873 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...)

874 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

875 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

876 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

877 
_G_va_li¡
 
__¬gs
)

878 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

882 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


886 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

890 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

893 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

896 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


900 
	#__Ãed_g‘İt


	)

901 
	~<g‘İt.h
>

906 #ifdeà
__USE_EXTERN_INLINES


907 
	~<b™s/¡dio.h
>

909 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


910 
	~<b™s/¡dio2.h
>

912 #ifdeà
__LDBL_COMPAT


913 
	~<b™s/¡dio-ldbl.h
>

916 
__END_DECLS


	@/usr/include/sys/ioctl.h

19 #iâdef 
_SYS_IOCTL_H


20 
	#_SYS_IOCTL_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	g__BEGIN_DECLS


27 
	~<b™s/ioùls.h
>

30 
	~<b™s/ioùl-ty³s.h
>

37 
	~<sys/‰ydeçuÉs.h
>

42 
	$ioùl
 (
__fd
, 
__»que¡
, ...è
__THROW
;

44 
__END_DECLS


	@/usr/include/sys/ipc.h

19 #iâdeà
_SYS_IPC_H


20 
	#_SYS_IPC_H
 1

	)

22 
	~<ã©u»s.h
>

24 #ià!
defšed
 
__USE_SVID
 && !defšed 
__USE_XOPEN
 && 
__GNUC__
 >= 2

29 
	~<b™s/ùy³s.h
>

30 
	~<b™s/c.h
>

32 #iâdeà
__uid_t_defšed


33 
__uid_t
 
	tuid_t
;

34 
	#__uid_t_defšed


	)

37 #iâdeà
__gid_t_defšed


38 
__gid_t
 
	tgid_t
;

39 
	#__gid_t_defšed


	)

42 #iâdeà
__mode_t_defšed


43 
__mode_t
 
	tmode_t
;

44 
	#__mode_t_defšed


	)

47 #iâdeà
__key_t_defšed


48 
__key_t
 
	tkey_t
;

49 
	#__key_t_defšed


	)

52 
__BEGIN_DECLS


55 
key_t
 
	$áok
 (
__cÚ¡
 *
__·thÇme
, 
__´oj_id
è
__THROW
;

57 
__END_DECLS


	@/usr/include/sys/mman.h

20 #iâdef 
_SYS_MMAN_H


21 
	#_SYS_MMAN_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<b™s/ty³s.h
>

25 
	#__Ãed_size_t


	)

26 
	~<¡ddef.h
>

28 #iâdeà
__off_t_defšed


29 #iâdeà
__USE_FILE_OFFSET64


30 
__off_t
 
	toff_t
;

32 
__off64_t
 
	toff_t
;

34 
	#__off_t_defšed


	)

37 #iâdeà
__mode_t_defšed


38 
__mode_t
 
	tmode_t
;

39 
	#__mode_t_defšed


	)

42 
	~<b™s/mmª.h
>

45 
	#MAP_FAILED
 ((*è-1)

	)

47 
	g__BEGIN_DECLS


57 #iâdeà
__USE_FILE_OFFSET64


58 *
	$mm­
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

59 
__æags
, 
__fd
, 
__off_t
 
__off£t
è
__THROW
;

61 #ifdeà
__REDIRECT_NTH


62 * 
	`__REDIRECT_NTH
 (
mm­
,

63 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

64 
__æags
, 
__fd
, 
__off64_t
 
__off£t
),

65 
mm­64
);

67 
	#mm­
 
mm­64


	)

70 #ifdeà
__USE_LARGEFILE64


71 *
	$mm­64
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

72 
__æags
, 
__fd
, 
__off64_t
 
__off£t
è
__THROW
;

77 
	$munm­
 (*
__addr
, 
size_t
 
__Ën
è
__THROW
;

82 
	$m´Ùeù
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
è
__THROW
;

90 
	`msync
 (*
__addr
, 
size_t
 
__Ën
, 
__æags
);

92 #ifdeà
__USE_BSD


95 
	$madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

97 #ifdeà
__USE_XOPEN2K


99 
	$posix_madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

104 
	$mlock
 (
__cÚ¡
 *
__addr
, 
size_t
 
__Ën
è
__THROW
;

107 
	$muÆock
 (
__cÚ¡
 *
__addr
, 
size_t
 
__Ën
è
__THROW
;

112 
	$mlock®l
 (
__æags
è
__THROW
;

116 
	$muÆock®l
 (è
__THROW
;

118 #ifdeà
__USE_MISC


124 
	$mšcÜe
 (*
__¡¬t
, 
size_t
 
__Ën
, *
__vec
)

125 
__THROW
;

128 #ifdeà
__USE_GNU


134 *
	$m»m­
 (*
__addr
, 
size_t
 
__Şd_Ën
, size_ˆ
__Ãw_Ën
,

135 
__æags
, ...è
__THROW
;

139 
	$»m­_fe_·ges
 (*
__¡¬t
, 
size_t
 
__size
, 
__´Ù
,

140 
size_t
 
__pgoff
, 
__æags
è
__THROW
;

145 
	`shm_İ’
 (
__cÚ¡
 *
__Çme
, 
__oæag
, 
mode_t
 
__mode
);

148 
	`shm_uÆšk
 (
__cÚ¡
 *
__Çme
);

150 
__END_DECLS


	@/usr/include/sys/shm.h

19 #iâdeà
_SYS_SHM_H


20 
	#_SYS_SHM_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

28 
	~<sys/c.h
>

31 
	~<b™s/shm.h
>

34 
	#__Ãed_time_t


	)

35 
	~<time.h
>

37 #ifdeà
__USE_XOPEN


38 #iâdeà
__pid_t_defšed


39 
__pid_t
 
	tpid_t
;

40 
	#__pid_t_defšed


	)

45 
__BEGIN_DECLS


51 
	$shmùl
 (
__shmid
, 
__cmd
, 
shmid_ds
 *
__buf
è
__THROW
;

54 
	$shmg‘
 (
key_t
 
__key
, 
size_t
 
__size
, 
__shmæg
è
__THROW
;

57 *
	$shm©
 (
__shmid
, 
__cÚ¡
 *
__shmaddr
, 
__shmæg
)

58 
__THROW
;

61 
	$shmdt
 (
__cÚ¡
 *
__shmaddr
è
__THROW
;

63 
__END_DECLS


	@/usr/include/sys/stat.h

24 #iâdef 
_SYS_STAT_H


25 
	#_SYS_STAT_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	~<b™s/ty³s.h
>

31 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K
 || defšed 
__USE_MISC
 \

32 || 
defšed
 
	g__USE_ATFILE


33 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_time_t


	)

36 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ATFILE


37 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


45 #iâdeà
__dev_t_defšed


46 
__dev_t
 
	tdev_t
;

47 
	#__dev_t_defšed


	)

50 #iâdeà
__gid_t_defšed


51 
__gid_t
 
	tgid_t
;

52 
	#__gid_t_defšed


	)

55 #iâdeà
__šo_t_defšed


56 #iâdeà
__USE_FILE_OFFSET64


57 
__šo_t
 
	tšo_t
;

59 
__šo64_t
 
	tšo_t
;

61 
	#__šo_t_defšed


	)

64 #iâdeà
__mode_t_defšed


65 
__mode_t
 
	tmode_t
;

66 
	#__mode_t_defšed


	)

69 #iâdeà
__Æšk_t_defšed


70 
__Æšk_t
 
	tÆšk_t
;

71 
	#__Æšk_t_defšed


	)

74 #iâdeà
__off_t_defšed


75 #iâdeà
__USE_FILE_OFFSET64


76 
__off_t
 
	toff_t
;

78 
__off64_t
 
	toff_t
;

80 
	#__off_t_defšed


	)

83 #iâdeà
__uid_t_defšed


84 
__uid_t
 
	tuid_t
;

85 
	#__uid_t_defšed


	)

89 #ifdeà
__USE_UNIX98


90 #iâdeà
__blkút_t_defšed


91 #iâdeà
__USE_FILE_OFFSET64


92 
__blkút_t
 
	tblkút_t
;

94 
__blkút64_t
 
	tblkút_t
;

96 
	#__blkút_t_defšed


	)

99 #iâdeà
__blksize_t_defšed


100 
__blksize_t
 
	tblksize_t
;

101 
	#__blksize_t_defšed


	)

105 
	g__BEGIN_DECLS


107 
	~<b™s/¡©.h
>

109 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


110 
	#S_IFMT
 
__S_IFMT


	)

111 
	#S_IFDIR
 
__S_IFDIR


	)

112 
	#S_IFCHR
 
__S_IFCHR


	)

113 
	#S_IFBLK
 
__S_IFBLK


	)

114 
	#S_IFREG
 
__S_IFREG


	)

115 #ifdeà
__S_IFIFO


116 
	#S_IFIFO
 
__S_IFIFO


	)

118 #ifdeà
__S_IFLNK


119 
	#S_IFLNK
 
__S_IFLNK


	)

121 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_UNIX98
) \

122 && 
defšed
 
	g__S_IFSOCK


123 
	#S_IFSOCK
 
__S_IFSOCK


	)

129 
	#__S_ISTYPE
(
mode
, 
mask
è(((modeè& 
__S_IFMT
è=ğ(mask))

	)

131 
	#S_ISDIR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

132 
	#S_ISCHR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

133 
	#S_ISBLK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

134 
	#S_ISREG
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

135 #ifdeà
__S_IFIFO


136 
	#S_ISFIFO
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

138 #ifdeà
__S_IFLNK


139 
	#S_ISLNK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

142 #ià
defšed
 
__USE_BSD
 && !defšed 
__S_IFLNK


143 
	#S_ISLNK
(
mode
è0

	)

146 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K
) \

147 && 
defšed
 
	g__S_IFSOCK


148 
	#S_ISSOCK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

155 #ifdef 
__USE_POSIX199309


156 
	#S_TYPEISMQ
(
buf
è
	`__S_TYPEISMQ
(buf)

	)

157 
	#S_TYPEISSEM
(
buf
è
	`__S_TYPEISSEM
(buf)

	)

158 
	#S_TYPEISSHM
(
buf
è
	`__S_TYPEISSHM
(buf)

	)

164 
	#S_ISUID
 
__S_ISUID


	)

165 
	#S_ISGID
 
__S_ISGID


	)

167 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


169 
	#S_ISVTX
 
__S_ISVTX


	)

172 
	#S_IRUSR
 
__S_IREAD


	)

173 
	#S_IWUSR
 
__S_IWRITE


	)

174 
	#S_IXUSR
 
__S_IEXEC


	)

176 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

178 #ià
defšed
 
__USE_MISC
 && defšed 
__USE_BSD


179 
	#S_IREAD
 
S_IRUSR


	)

180 
	#S_IWRITE
 
S_IWUSR


	)

181 
	#S_IEXEC
 
S_IXUSR


	)

184 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

185 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

186 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

188 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

190 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

191 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

192 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

194 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

197 #ifdef 
__USE_BSD


199 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
è

	)

200 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

201 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

203 
	#S_BLKSIZE
 512

	)

207 #iâdeà
__USE_FILE_OFFSET64


209 
	$¡©
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

210 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

214 
	$f¡©
 (
__fd
, 
¡©
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

216 #ifdeà
__REDIRECT_NTH


217 
	`__REDIRECT_NTH
 (
¡©
, (
__cÚ¡
 *
__»¡riù
 
__fe
,

218 
¡©
 *
__»¡riù
 
__buf
), 
¡©64
)

219 
	`__nÚnuÎ
 ((1, 2));

220 
	`__REDIRECT_NTH
 (
f¡©
, (
__fd
, 
¡©
 *
__buf
), 
f¡©64
)

221 
	`__nÚnuÎ
 ((2));

223 
	#¡©
 
¡©64


	)

224 
	#f¡©
 
f¡©64


	)

227 #ifdeà
__USE_LARGEFILE64


228 
	$¡©64
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

229 
¡©64
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

230 
	$f¡©64
 (
__fd
, 
¡©64
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

233 #ifdeà
__USE_ATFILE


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$f¡©©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

239 
¡©
 *
__»¡riù
 
__buf
, 
__æag
)

240 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

242 #ifdeà
__REDIRECT_NTH


243 
	`__REDIRECT_NTH
 (
f¡©©
, (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

244 
¡©
 *
__»¡riù
 
__buf
,

245 
__æag
),

246 
f¡©©64
è
	`__nÚnuÎ
 ((2, 3));

248 
	#f¡©©
 
f¡©©64


	)

252 #ifdeà
__USE_LARGEFILE64


253 
	$f¡©©64
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fe
,

254 
¡©64
 *
__»¡riù
 
__buf
, 
__æag
)

255 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

259 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


260 #iâdeà
__USE_FILE_OFFSET64


263 
	$l¡©
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

264 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

266 #ifdeà
__REDIRECT_NTH


267 
	`__REDIRECT_NTH
 (
l¡©
,

268 (
__cÚ¡
 *
__»¡riù
 
__fe
,

269 
¡©
 *
__»¡riù
 
__buf
), 
l¡©64
)

270 
	`__nÚnuÎ
 ((1, 2));

272 
	#l¡©
 
l¡©64


	)

275 #ifdeà
__USE_LARGEFILE64


276 
	$l¡©64
 (
__cÚ¡
 *
__»¡riù
 
__fe
,

277 
¡©64
 *
__»¡riù
 
__buf
)

278 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

284 
	$chmod
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
)

285 
__THROW
 
	`__nÚnuÎ
 ((1));

287 #ifdeà
__USE_BSD


291 
	$lchmod
 (
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
)

292 
__THROW
 
	`__nÚnuÎ
 ((1));

296 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


297 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
è
__THROW
;

300 #ifdeà
__USE_ATFILE


303 
	$fchmod©
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__mode_t
 
__mode
,

304 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

312 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
è
__THROW
;

314 #ifdef 
__USE_GNU


317 
__mode_t
 
	$g‘umask
 (è
__THROW
;

321 
	$mkdœ
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

322 
__THROW
 
	`__nÚnuÎ
 ((1));

324 #ifdeà
__USE_ATFILE


328 
	$mkdœ©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

329 
__THROW
 
	`__nÚnuÎ
 ((2));

335 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


336 
	$mknod
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

337 
__THROW
 
	`__nÚnuÎ
 ((1));

339 #ifdeà
__USE_ATFILE


343 
	$mknod©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

344 
__dev_t
 
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2));

350 
	$mkfifo
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

351 
__THROW
 
	`__nÚnuÎ
 ((1));

353 #ifdeà
__USE_ATFILE


357 
	$mkfifßt
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

361 #ifdeà
__USE_ATFILE


364 
	$utim’§t
 (
__fd
, 
__cÚ¡
 *
__·th
,

365 
__cÚ¡
 
time¥ec
 
__times
[2],

366 
__æags
)

367 
__THROW
 
	`__nÚnuÎ
 ((2));

370 #ifdeà
__USE_XOPEN2K8


372 
	$futim’s
 (
__fd
, 
__cÚ¡
 
time¥ec
 
__times
[2]è
__THROW
;

390 #iâdeà
_STAT_VER


391 
	#_STAT_VER
 0

	)

393 #iâdeà
_MKNOD_VER


394 
	#_MKNOD_VER
 0

	)

398 #iâdeà
__USE_FILE_OFFSET64


399 
	$__fx¡©
 (
__v”
, 
__fdes
, 
¡©
 *
__¡©_buf
)

400 
__THROW
 
	`__nÚnuÎ
 ((3));

401 
	$__x¡©
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

402 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

403 
	$__lx¡©
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

404 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

405 
	$__fx¡©©
 (
__v”
, 
__fdes
, 
__cÚ¡
 *
__f’ame
,

406 
¡©
 *
__¡©_buf
, 
__æag
)

407 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

409 #ifdeà
__REDIRECT_NTH


410 
	`__REDIRECT_NTH
 (
__fx¡©
, (
__v”
, 
__fdes
,

411 
¡©
 *
__¡©_buf
), 
__fx¡©64
)

412 
	`__nÚnuÎ
 ((3));

413 
	`__REDIRECT_NTH
 (
__x¡©
, (
__v”
, 
__cÚ¡
 *
__f’ame
,

414 
¡©
 *
__¡©_buf
), 
__x¡©64
)

415 
	`__nÚnuÎ
 ((2, 3));

416 
	`__REDIRECT_NTH
 (
__lx¡©
, (
__v”
, 
__cÚ¡
 *
__f’ame
,

417 
¡©
 *
__¡©_buf
), 
__lx¡©64
)

418 
	`__nÚnuÎ
 ((2, 3));

419 
	`__REDIRECT_NTH
 (
__fx¡©©
, (
__v”
, 
__fdes
,

420 
__cÚ¡
 *
__f’ame
,

421 
¡©
 *
__¡©_buf
, 
__æag
),

422 
__fx¡©©64
è
	`__nÚnuÎ
 ((3, 4));

425 
	#__fx¡©
 
__fx¡©64


	)

426 
	#__x¡©
 
__x¡©64


	)

427 
	#__lx¡©
 
__lx¡©64


	)

431 #ifdeà
__USE_LARGEFILE64


432 
	$__fx¡©64
 (
__v”
, 
__fdes
, 
¡©64
 *
__¡©_buf
)

433 
__THROW
 
	`__nÚnuÎ
 ((3));

434 
	$__x¡©64
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

435 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

436 
	$__lx¡©64
 (
__v”
, 
__cÚ¡
 *
__f’ame
,

437 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

438 
	$__fx¡©©64
 (
__v”
, 
__fdes
, 
__cÚ¡
 *
__f’ame
,

439 
¡©64
 *
__¡©_buf
, 
__æag
)

440 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

442 
	$__xmknod
 (
__v”
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

443 
__dev_t
 *
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

445 
	$__xmknod©
 (
__v”
, 
__fd
, 
__cÚ¡
 *
__·th
,

446 
__mode_t
 
__mode
, 
__dev_t
 *
__dev
)

447 
__THROW
 
	`__nÚnuÎ
 ((3, 5));

449 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES_IN_LIBC


452 
__ex‹º_šlše
 

453 
	`__NTH
 (
	$¡©
 (
__cÚ¡
 *
__·th
, 
¡©
 *
__¡©buf
))

455  
	`__x¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

456 
	}
}

458 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


459 
__ex‹º_šlše
 

460 
__NTH
 (
	$l¡©
 (
__cÚ¡
 *
__·th
, 
¡©
 *
__¡©buf
))

462  
	`__lx¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

463 
	}
}

466 
__ex‹º_šlše
 

467 
__NTH
 (
	$f¡©
 (
__fd
, 
¡©
 *
__¡©buf
))

469  
	`__fx¡©
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

470 
	}
}

472 #ifdeà
__USE_ATFILE


473 
__ex‹º_šlše
 

474 
__NTH
 (
	$f¡©©
 (
__fd
, 
__cÚ¡
 *
__f’ame
, 
¡©
 *
__¡©buf
,

475 
__æag
))

477  
	`__fx¡©©
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

478 
	}
}

481 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_BSD


482 
__ex‹º_šlše
 

483 
__NTH
 (
	$mknod
 (
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
))

485  
	`__xmknod
 (
_MKNOD_VER
, 
__·th
, 
__mode
, &
__dev
);

486 
	}
}

489 #ifdeà
__USE_ATFILE


490 
__ex‹º_šlše
 

491 
__NTH
 (
	$mknod©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__mode_t
 
__mode
,

492 
__dev_t
 
__dev
))

494  
	`__xmknod©
 (
_MKNOD_VER
, 
__fd
, 
__·th
, 
__mode
, &
__dev
);

495 
	}
}

498 #ià
defšed
 
__USE_LARGEFILE64
 \

499 && (! 
defšed
 
	g__USE_FILE_OFFSET64
 \

500 || (
defšed
 
	g__REDIRECT_NTH
 && defšed 
	g__OPTIMIZE__
))

501 
__ex‹º_šlše
 

502 
__NTH
 (
	$¡©64
 (
__cÚ¡
 *
__·th
, 
¡©64
 *
__¡©buf
))

504  
	`__x¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

505 
	}
}

507 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


508 
__ex‹º_šlše
 

509 
__NTH
 (
	$l¡©64
 (
__cÚ¡
 *
__·th
, 
¡©64
 *
__¡©buf
))

511  
	`__lx¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

512 
	}
}

515 
__ex‹º_šlše
 

516 
__NTH
 (
	$f¡©64
 (
__fd
, 
¡©64
 *
__¡©buf
))

518  
	`__fx¡©64
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

519 
	}
}

521 #ifdeà
__USE_ATFILE


522 
__ex‹º_šlše
 

523 
__NTH
 (
	$f¡©©64
 (
__fd
, 
__cÚ¡
 *
__f’ame
, 
¡©64
 *
__¡©buf
,

524 
__æag
))

526  
	`__fx¡©©64
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

527 
	}
}

534 
	g__END_DECLS


	@/usr/include/sys/syscall.h

19 #iâdeà
_SYSCALL_H


20 
	#_SYSCALL_H
 1

	)

25 
	~<asm/uni¡d.h
>

27 #iâdeà
_LIBC


32 
	~<b™s/sysÿÎ.h
>

	@/usr/include/sys/types.h

24 #iâdef 
_SYS_TYPES_H


25 
	#_SYS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

33 #ifdef 
__USE_BSD


34 #iâdeà
__u_ch¬_defšed


35 
__u_ch¬
 
	tu_ch¬
;

36 
__u_shÜt
 
	tu_shÜt
;

37 
__u_št
 
	tu_št
;

38 
__u_lÚg
 
	tu_lÚg
;

39 
__quad_t
 
	tquad_t
;

40 
__u_quad_t
 
	tu_quad_t
;

41 
__fsid_t
 
	tfsid_t
;

42 
	#__u_ch¬_defšed


	)

46 
__loff_t
 
	tloff_t
;

48 #iâdeà
__šo_t_defšed


49 #iâdeà
__USE_FILE_OFFSET64


50 
__šo_t
 
	tšo_t
;

52 
__šo64_t
 
	tšo_t
;

54 
	#__šo_t_defšed


	)

56 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


57 
__šo64_t
 
	tšo64_t
;

58 
	#__šo64_t_defšed


	)

61 #iâdeà
__dev_t_defšed


62 
__dev_t
 
	tdev_t
;

63 
	#__dev_t_defšed


	)

66 #iâdeà
__gid_t_defšed


67 
__gid_t
 
	tgid_t
;

68 
	#__gid_t_defšed


	)

71 #iâdeà
__mode_t_defšed


72 
__mode_t
 
	tmode_t
;

73 
	#__mode_t_defšed


	)

76 #iâdeà
__Æšk_t_defšed


77 
__Æšk_t
 
	tÆšk_t
;

78 
	#__Æšk_t_defšed


	)

81 #iâdeà
__uid_t_defšed


82 
__uid_t
 
	tuid_t
;

83 
	#__uid_t_defšed


	)

86 #iâdeà
__off_t_defšed


87 #iâdeà
__USE_FILE_OFFSET64


88 
__off_t
 
	toff_t
;

90 
__off64_t
 
	toff_t
;

92 
	#__off_t_defšed


	)

94 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


95 
__off64_t
 
	toff64_t
;

96 
	#__off64_t_defšed


	)

99 #iâdeà
__pid_t_defšed


100 
__pid_t
 
	tpid_t
;

101 
	#__pid_t_defšed


	)

104 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__id_t_defšed


105 
__id_t
 
	tid_t
;

106 
	#__id_t_defšed


	)

109 #iâdeà
__ssize_t_defšed


110 
__ssize_t
 
	tssize_t
;

111 
	#__ssize_t_defšed


	)

114 #ifdef 
__USE_BSD


115 #iâdeà
__daddr_t_defšed


116 
__daddr_t
 
	tdaddr_t
;

117 
__ÿddr_t
 
	tÿddr_t
;

118 
	#__daddr_t_defšed


	)

122 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


123 
__key_t
 
	tkey_t
;

124 
	#__key_t_defšed


	)

127 #ifdeà
__USE_XOPEN


128 
	#__Ãed_şock_t


	)

130 
	#__Ãed_time_t


	)

131 
	#__Ãed_tim”_t


	)

132 
	#__Ãed_şockid_t


	)

133 
	~<time.h
>

135 #ifdeà
__USE_XOPEN


136 #iâdeà
__u£cÚds_t_defšed


137 
__u£cÚds_t
 
	tu£cÚds_t
;

138 
	#__u£cÚds_t_defšed


	)

140 #iâdeà
__su£cÚds_t_defšed


141 
__su£cÚds_t
 
	tsu£cÚds_t
;

142 
	#__su£cÚds_t_defšed


	)

146 
	#__Ãed_size_t


	)

147 
	~<¡ddef.h
>

149 #ifdeà
__USE_MISC


151 
	tulÚg
;

152 
	tushÜt
;

153 
	tušt
;

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 #iâdeà
__št8_t_defšed


162 
	#__št8_t_defšed


	)

163 
	tšt8_t
;

164 
	tšt16_t
;

165 
	tšt32_t
;

166 #ià
__WORDSIZE
 == 64

167 
	tšt64_t
;

168 #–ià
__GLIBC_HAVE_LONG_LONG


169 
__ex‹nsiÚ__
 
	tšt64_t
;

174 
	tu_št8_t
;

175 
	tu_št16_t
;

176 
	tu_št32_t
;

177 #ià
__WORDSIZE
 == 64

178 
	tu_št64_t
;

179 #–ià
__GLIBC_HAVE_LONG_LONG


180 
__ex‹nsiÚ__
 
	tu_št64_t
;

183 
	t»gi¡”_t
;

188 
	#__štN_t
(
N
, 
MODE
) \

189 ##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

190 
	t__u_štN_t
(
	tN
, 
	tMODE
) \

191 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

193 #iâdeà
	t__št8_t_defšed


194 
	t__št8_t_defšed


	)

195 
	t__štN_t
 (8, 
	t__QI__
);

196 
__štN_t
 (16, 
__HI__
);

197 
__štN_t
 (32, 
__SI__
);

198 
__štN_t
 (64, 
__DI__
);

201 
__u_štN_t
 (8, 
__QI__
);

202 
__u_štN_t
 (16, 
__HI__
);

203 
__u_štN_t
 (32, 
__SI__
);

204 
__u_štN_t
 (64, 
__DI__
);

206 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

212 
	#__BIT_TYPES_DEFINED__
 1

	)

215 #ifdef 
__USE_BSD


217 
	~<’dŸn.h
>

220 
	~<sys/£Ëù.h
>

223 
	~<sys/sysmaüos.h
>

227 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__blksize_t_defšed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_defšed


	)

233 #iâdeà
__USE_FILE_OFFSET64


234 #iâdeà
__blkút_t_defšed


235 
__blkút_t
 
	tblkút_t
;

236 
	#__blkút_t_defšed


	)

238 #iâdeà
__fsblkút_t_defšed


239 
__fsblkút_t
 
	tfsblkút_t
;

240 
	#__fsblkút_t_defšed


	)

242 #iâdeà
__fsfút_t_defšed


243 
__fsfút_t
 
	tfsfút_t
;

244 
	#__fsfút_t_defšed


	)

247 #iâdeà
__blkút_t_defšed


248 
__blkút64_t
 
	tblkút_t
;

249 
	#__blkút_t_defšed


	)

251 #iâdeà
__fsblkút_t_defšed


252 
__fsblkút64_t
 
	tfsblkút_t
;

253 
	#__fsblkút_t_defšed


	)

255 #iâdeà
__fsfút_t_defšed


256 
__fsfút64_t
 
	tfsfút_t
;

257 
	#__fsfút_t_defšed


	)

261 #ifdeà
__USE_LARGEFILE64


262 
__blkút64_t
 
	tblkút64_t
;

263 
__fsblkút64_t
 
	tfsblkút64_t
;

264 
__fsfút64_t
 
	tfsfút64_t
;

269 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


270 
	~<b™s/±h»adty³s.h
>

273 
	g__END_DECLS


	@/usr/include/syscall.h

1 
	~<sys/sysÿÎ.h
>

	@/usr/include/unistd.h

23 #iâdef 
_UNISTD_H


24 
	#_UNISTD_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


33 #ifdeà
__USE_XOPEN2K8


35 
	#_POSIX_VERSION
 200809L

	)

36 #–ià
defšed
 
__USE_XOPEN2K


38 
	#_POSIX_VERSION
 200112L

	)

39 #–ià
defšed
 
__USE_POSIX199506


41 
	#_POSIX_VERSION
 199506L

	)

42 #–ià
defšed
 
__USE_POSIX199309


44 
	#_POSIX_VERSION
 199309L

	)

47 
	#_POSIX_VERSION
 199009L

	)

53 #ifdeà
__USE_XOPEN2K8


54 
	#__POSIX2_THIS_VERSION
 200809L

	)

56 #–ià
defšed
 
__USE_XOPEN2K


58 
	#__POSIX2_THIS_VERSION
 200112L

	)

59 #–ià
defšed
 
__USE_POSIX199506


61 
	#__POSIX2_THIS_VERSION
 199506L

	)

64 
	#__POSIX2_THIS_VERSION
 199209L

	)

68 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

72 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

76 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

80 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

84 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

87 #ifdeà
__USE_XOPEN2K8


88 
	#_XOPEN_VERSION
 700

	)

89 #–ià
defšed
 
__USE_XOPEN2K


90 
	#_XOPEN_VERSION
 600

	)

91 #–ià
defšed
 
__USE_UNIX98


92 
	#_XOPEN_VERSION
 500

	)

94 
	#_XOPEN_VERSION
 4

	)

98 
	#_XOPEN_XCU_VERSION
 4

	)

101 
	#_XOPEN_XPG2
 1

	)

102 
	#_XOPEN_XPG3
 1

	)

103 
	#_XOPEN_XPG4
 1

	)

106 
	#_XOPEN_UNIX
 1

	)

109 
	#_XOPEN_CRYPT
 1

	)

113 
	#_XOPEN_ENH_I18N
 1

	)

116 
	#_XOPEN_LEGACY
 1

	)

203 
	~<b™s/posix_İt.h
>

206 #ifdeà
__USE_UNIX98


207 
	~<b™s/’vœÚm’ts.h
>

211 
	#STDIN_FILENO
 0

	)

212 
	#STDOUT_FILENO
 1

	)

213 
	#STDERR_FILENO
 2

	)

218 
	~<b™s/ty³s.h
>

220 #iâdef 
__ssize_t_defšed


221 
__ssize_t
 
	tssize_t
;

222 
	#__ssize_t_defšed


	)

225 
	#__Ãed_size_t


	)

226 
	#__Ãed_NULL


	)

227 
	~<¡ddef.h
>

229 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


232 #iâdeà
__gid_t_defšed


233 
__gid_t
 
	tgid_t
;

234 
	#__gid_t_defšed


	)

237 #iâdeà
__uid_t_defšed


238 
__uid_t
 
	tuid_t
;

239 
	#__uid_t_defšed


	)

242 #iâdeà
__off_t_defšed


243 #iâdeà
__USE_FILE_OFFSET64


244 
__off_t
 
	toff_t
;

246 
__off64_t
 
	toff_t
;

248 
	#__off_t_defšed


	)

250 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


251 
__off64_t
 
	toff64_t
;

252 
	#__off64_t_defšed


	)

255 #iâdeà
__u£cÚds_t_defšed


256 
__u£cÚds_t
 
	tu£cÚds_t
;

257 
	#__u£cÚds_t_defšed


	)

260 #iâdeà
__pid_t_defšed


261 
__pid_t
 
	tpid_t
;

262 
	#__pid_t_defšed


	)

266 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


267 #iâdeà
__šŒ_t_defšed


268 
__šŒ_t
 
	tšŒ_t
;

269 
	#__šŒ_t_defšed


	)

273 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


274 #iâdeà
__sockËn_t_defšed


275 
__sockËn_t
 
	tsockËn_t
;

276 
	#__sockËn_t_defšed


	)

282 
	#R_OK
 4

	)

283 
	#W_OK
 2

	)

284 
	#X_OK
 1

	)

285 
	#F_OK
 0

	)

288 
	$acûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

290 #ifdeà
__USE_GNU


293 
	$euidacûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
)

294 
__THROW
 
	`__nÚnuÎ
 ((1));

297 
	$—cûss
 (
__cÚ¡
 *
__Çme
, 
__ty³
)

298 
__THROW
 
	`__nÚnuÎ
 ((1));

301 #ifdeà
__USE_ATFILE


305 
	$çcûs§t
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__ty³
, 
__æag
)

306 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

311 #iâdef 
_STDIO_H


312 
	#SEEK_SET
 0

	)

313 
	#SEEK_CUR
 1

	)

314 
	#SEEK_END
 2

	)

317 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


319 
	#L_SET
 
SEEK_SET


	)

320 
	#L_INCR
 
SEEK_CUR


	)

321 
	#L_XTND
 
SEEK_END


	)

330 #iâdeà
__USE_FILE_OFFSET64


331 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

333 #ifdeà
__REDIRECT_NTH


334 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

335 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

336 
l£ek64
);

338 
	#l£ek
 
l£ek64


	)

341 #ifdeà
__USE_LARGEFILE64


342 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

343 
__THROW
;

350 
	`şo£
 (
__fd
);

357 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

363 
ssize_t
 
	$wr™e
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
è
__wur
;

365 #ifdeà
__USE_UNIX98


366 #iâdeà
__USE_FILE_OFFSET64


373 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

374 
__off_t
 
__off£t
è
__wur
;

381 
ssize_t
 
	$pwr™e
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

382 
__off_t
 
__off£t
è
__wur
;

384 #ifdeà
__REDIRECT


385 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

386 
__off64_t
 
__off£t
),

387 
´—d64
è
__wur
;

388 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, 
__cÚ¡
 *
__buf
,

389 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

390 
pwr™e64
è
__wur
;

392 
	#´—d
 
´—d64


	)

393 
	#pwr™e
 
pwr™e64


	)

397 #ifdeà
__USE_LARGEFILE64


401 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

402 
__off64_t
 
__off£t
è
__wur
;

405 
ssize_t
 
	$pwr™e64
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

406 
__off64_t
 
__off£t
è
__wur
;

414 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

416 #ifdeà
__USE_GNU


419 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

429 
	$®¬m
 (
__£cÚds
è
__THROW
;

441 
	`¦“p
 (
__£cÚds
);

443 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


448 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

449 
__THROW
;

456 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

465 
	`·u£
 ();

469 
	$chown
 (
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

470 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

472 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


474 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

479 
	$lchown
 (
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

480 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

484 #ifdeà
__USE_ATFILE


487 
	$fchowÇt
 (
__fd
, 
__cÚ¡
 *
__fe
, 
__uid_t
 
__owÃr
,

488 
__gid_t
 
__group
, 
__æag
)

489 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

493 
	$chdœ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

495 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


497 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

507 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

509 #ifdef 
__USE_GNU


513 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

516 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


520 *
	$g‘wd
 (*
__buf
)

521 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

526 
	$dup
 (
__fd
è
__THROW
 
__wur
;

529 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

531 #ifdeà
__USE_GNU


534 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

538 **
__’vœÚ
;

539 #ifdeà
__USE_GNU


540 **
’vœÚ
;

546 
	$execve
 (
__cÚ¡
 *
__·th
, *__cÚ¡ 
__¬gv
[],

547 *
__cÚ¡
 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1));

549 #ifdeà
__USE_XOPEN2K8


552 
	$ãxecve
 (
__fd
, *
__cÚ¡
 
__¬gv
[], *__cÚ¡ 
__’vp
[])

553 
__THROW
;

558 
	$execv
 (
__cÚ¡
 *
__·th
, *__cÚ¡ 
__¬gv
[])

559 
__THROW
 
	`__nÚnuÎ
 ((1));

563 
	$exeşe
 (
__cÚ¡
 *
__·th
, __cÚ¡ *
__¬g
, ...)

564 
__THROW
 
	`__nÚnuÎ
 ((1));

568 
	$exeş
 (
__cÚ¡
 *
__·th
, __cÚ¡ *
__¬g
, ...)

569 
__THROW
 
	`__nÚnuÎ
 ((1));

573 
	$execvp
 (
__cÚ¡
 *
__fe
, *__cÚ¡ 
__¬gv
[])

574 
__THROW
 
	`__nÚnuÎ
 ((1));

579 
	$exeşp
 (
__cÚ¡
 *
__fe
, __cÚ¡ *
__¬g
, ...)

580 
__THROW
 
	`__nÚnuÎ
 ((1));

582 #ifdeà
__USE_GNU


585 
	$execv³
 (
__cÚ¡
 *
__fe
, *__cÚ¡ 
__¬gv
[],

586 *
__cÚ¡
 
__’vp
[])

587 
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


593 
	$niû
 (
__šc
è
__THROW
 
__wur
;

598 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

604 
	~<b™s/cÚâame.h
>

607 
	$·thcÚf
 (
__cÚ¡
 *
__·th
, 
__Çme
)

608 
__THROW
 
	`__nÚnuÎ
 ((1));

611 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

614 
	$syscÚf
 (
__Çme
è
__THROW
;

616 #ifdef 
__USE_POSIX2


618 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

623 
__pid_t
 
	$g‘pid
 (è
__THROW
;

626 
__pid_t
 
	$g‘µid
 (è
__THROW
;

630 #iâdeà
__FAVOR_BSD


631 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

633 #ifdeà
__REDIRECT_NTH


634 
__pid_t
 
	`__REDIRECT_NTH
 (
g‘pg½
, (__pid_ˆ
__pid
), 
__g‘pgid
);

636 
	#g‘pg½
 
__g‘pgid


	)

641 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

642 #ifdeà
__USE_XOPEN_EXTENDED


643 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

650 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

652 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


663 #iâdeà
__FAVOR_BSD


667 
	$£g½
 (è
__THROW
;

672 #ifdeà
__REDIRECT_NTH


673 
	`__REDIRECT_NTH
 (
£g½
, (
__pid_t
 
__pid
, __pid_ˆ
__pg½
), 
£gid
);

675 
	#£g½
 
£gid


	)

684 
__pid_t
 
	$£tsid
 (è
__THROW
;

686 #ifdeà
__USE_XOPEN_EXTENDED


688 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

692 
__uid_t
 
	$g‘uid
 (è
__THROW
;

695 
__uid_t
 
	$g‘euid
 (è
__THROW
;

698 
__gid_t
 
	$g‘gid
 (è
__THROW
;

701 
__gid_t
 
	$g‘egid
 (è
__THROW
;

706 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

708 #ifdef 
__USE_GNU


710 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

717 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
;

719 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


722 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


727 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
;

734 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
;

736 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


739 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
;

742 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


744 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
;

747 #ifdeà
__USE_GNU


750 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

751 
__THROW
;

755 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

756 
__THROW
;

760 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

761 
__THROW
;

765 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

766 
__THROW
;

773 
__pid_t
 
	$fÜk
 (è
__THROW
;

775 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


780 
__pid_t
 
	$vfÜk
 (è
__THROW
;

786 *
	$‰yÇme
 (
__fd
è
__THROW
;

790 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

791 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

795 
	$i§‰y
 (
__fd
è
__THROW
;

797 #ià
defšed
 
__USE_BSD
 \

798 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

801 
	$‰y¦Ù
 (è
__THROW
;

806 
	$lšk
 (
__cÚ¡
 *
__äom
, __cÚ¡ *
__to
)

807 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

809 #ifdeà
__USE_ATFILE


812 
	$lšk©
 (
__äomfd
, 
__cÚ¡
 *
__äom
, 
__tofd
,

813 
__cÚ¡
 *
__to
, 
__æags
)

814 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

817 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


819 
	$symlšk
 (
__cÚ¡
 *
__äom
, __cÚ¡ *
__to
)

820 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

825 
ssize_t
 
	$»adlšk
 (
__cÚ¡
 *
__»¡riù
 
__·th
,

826 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

827 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

830 #ifdeà
__USE_ATFILE


832 
	$symlšk©
 (
__cÚ¡
 *
__äom
, 
__tofd
,

833 
__cÚ¡
 *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

836 
ssize_t
 
	$»adlšk©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

837 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

838 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

842 
	$uÆšk
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

844 #ifdeà
__USE_ATFILE


846 
	$uÆšk©
 (
__fd
, 
__cÚ¡
 *
__Çme
, 
__æag
)

847 
__THROW
 
	`__nÚnuÎ
 ((2));

851 
	$rmdœ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

855 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

858 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

865 *
	`g‘logš
 ();

866 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


873 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

876 #ifdef 
__USE_BSD


878 
	$£ogš
 (
__cÚ¡
 *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

882 #ifdef 
__USE_POSIX2


886 
	#__Ãed_g‘İt


	)

887 
	~<g‘İt.h
>

891 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


895 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

899 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

902 
	$£tho¡Çme
 (
__cÚ¡
 *
__Çme
, 
size_t
 
__Ën
)

903 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

907 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

913 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

914 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

915 
	$£tdomašÇme
 (
__cÚ¡
 *
__Çme
, 
size_t
 
__Ën
)

916 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

922 
	$vhªgup
 (è
__THROW
;

925 
	$»voke
 (
__cÚ¡
 *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

933 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

934 
size_t
 
__off£t
, 
__sÿË
)

935 
__THROW
 
	`__nÚnuÎ
 ((1));

941 
	$acù
 (
__cÚ¡
 *
__Çme
è
__THROW
;

945 *
	$g‘u£rsh–l
 (è
__THROW
;

946 
	$’du£rsh–l
 (è
__THROW
;

947 
	$£tu£rsh–l
 (è
__THROW
;

953 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

957 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

960 
	$chroÙ
 (
__cÚ¡
 *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

964 *
	$g‘·ss
 (
__cÚ¡
 *
__´om±
è
	`__nÚnuÎ
 ((1));

968 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


973 
	`fsync
 (
__fd
);

977 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


980 
	`g‘ho¡id
 ();

983 
	$sync
 (è
__THROW
;

988 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

993 
	$g‘dbËsize
 (è
__THROW
;

997 #iâdeà
__USE_FILE_OFFSET64


998 
	$Œunÿ‹
 (
__cÚ¡
 *
__fe
, 
__off_t
 
__Ëngth
)

999 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1001 #ifdeà
__REDIRECT_NTH


1002 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

1003 (
__cÚ¡
 *
__fe
, 
__off64_t
 
__Ëngth
),

1004 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1006 
	#Œunÿ‹
 
Œunÿ‹64


	)

1009 #ifdeà
__USE_LARGEFILE64


1010 
	$Œunÿ‹64
 (
__cÚ¡
 *
__fe
, 
__off64_t
 
__Ëngth
)

1011 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1016 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1019 #iâdeà
__USE_FILE_OFFSET64


1020 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1022 #ifdeà
__REDIRECT_NTH


1023 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1024 
árunÿ‹64
è
__wur
;

1026 
	#árunÿ‹
 
árunÿ‹64


	)

1029 #ifdeà
__USE_LARGEFILE64


1030 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1036 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


1040 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1046 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1050 #ifdeà
__USE_MISC


1061 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1066 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1078 
	#F_ULOCK
 0

	)

1079 
	#F_LOCK
 1

	)

1080 
	#F_TLOCK
 2

	)

1081 
	#F_TEST
 3

	)

1083 #iâdeà
__USE_FILE_OFFSET64


1084 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1086 #ifdeà
__REDIRECT


1087 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1088 
lockf64
è
__wur
;

1090 
	#lockf
 
lockf64


	)

1093 #ifdeà
__USE_LARGEFILE64


1094 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1099 #ifdeà
__USE_GNU


1104 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1105 (
__ex‹nsiÚ__
 \

1106 ({ 
__»suÉ
; \

1107 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1108 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1109 
__»suÉ
; 
	}
}))

	)

1112 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1115 
fd©async
 (
__fdes
);

1121 #ifdef 
__USE_XOPEN


1123 *
	$üy±
 (
__cÚ¡
 *
__key
, __cÚ¡ *
__§É
)

1124 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1128 
	$’üy±
 (*
__block
, 
__edæag
è
__THROW
 
	`__nÚnuÎ
 ((1));

1135 
	$swab
 (
__cÚ¡
 *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1136 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1142 #ifdeà
__USE_XOPEN


1144 *
	$ù”mid
 (*
__s
è
__THROW
;

1149 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


1150 
	~<b™s/uni¡d.h
>

1153 
__END_DECLS


	@/usr/include/asm/byteorder.h

1 #iâdeà
_ASM_X86_BYTEORDER_H


2 
	#_ASM_X86_BYTEORDER_H


	)

4 
	~<lšux/by‹Üd”/l™e_’dŸn.h
>

	@/usr/include/asm/kvm.h

1 #iâdeà
_ASM_X86_KVM_H


2 
	#_ASM_X86_KVM_H


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/ioùl.h
>

13 
	#__KVM_HAVE_PIT


	)

14 
	#__KVM_HAVE_IOAPIC


	)

15 
	#__KVM_HAVE_DEVICE_ASSIGNMENT


	)

16 
	#__KVM_HAVE_MSI


	)

17 
	#__KVM_HAVE_USER_NMI


	)

18 
	#__KVM_HAVE_GUEST_DEBUG


	)

19 
	#__KVM_HAVE_MSIX


	)

20 
	#__KVM_HAVE_MCE


	)

21 
	#__KVM_HAVE_PIT_STATE2


	)

24 
	#KVM_NR_INTERRUPTS
 256

	)

26 
	skvm_memÜy_®Ÿs
 {

27 
__u32
 
	m¦Ù
;

28 
__u32
 
	mæags
;

29 
__u64
 
	mgue¡_phys_addr
;

30 
__u64
 
	mmemÜy_size
;

31 
__u64
 
	mrg‘_phys_addr
;

35 
	skvm_pic_¡©e
 {

36 
__u8
 
	mÏ¡_œr
;

37 
__u8
 
	mœr
;

38 
__u8
 
	mimr
;

39 
__u8
 
	mi¤
;

40 
__u8
 
	m´iÜ™y_add
;

41 
__u8
 
	mœq_ba£
;

42 
__u8
 
	m»ad_»g_£Ëù
;

43 
__u8
 
	mpŞl
;

44 
__u8
 
	m¥ecŸl_mask
;

45 
__u8
 
	mš™_¡©e
;

46 
__u8
 
	mauto_eoi
;

47 
__u8
 
	mrÙ©e_Ú_auto_eoi
;

48 
__u8
 
	m¥ecŸl_fuÎy_Ã¡ed_mode
;

49 
__u8
 
	mš™4
;

50 
__u8
 
	m–ü
;

51 
__u8
 
	m–ü_mask
;

54 
	#KVM_IOAPIC_NUM_PINS
 24

	)

55 
	skvm_ißpic_¡©e
 {

56 
__u64
 
	mba£_add»ss
;

57 
__u32
 
	miÜeg£l
;

58 
__u32
 
	mid
;

59 
__u32
 
	mœr
;

60 
__u32
 
	m·d
;

62 
__u64
 
	mb™s
;

64 
__u8
 
	mveùÜ
;

65 
__u8
 
	md–iv”y_mode
:3;

66 
__u8
 
	mde¡_mode
:1;

67 
__u8
 
	md–iv”y_¡©us
:1;

68 
__u8
 
	mpŞ¬™y
:1;

69 
__u8
 
	m»mÙe_œr
:1;

70 
__u8
 
	mŒig_mode
:1;

71 
__u8
 
	mmask
:1;

72 
__u8
 
	m»£rve
:7;

73 
__u8
 
	m»£rved
[4];

74 
__u8
 
	mde¡_id
;

75 } 
	mf›lds
;

76 } 
	m»dœtbl
[
KVM_IOAPIC_NUM_PINS
];

79 
	#KVM_IRQCHIP_PIC_MASTER
 0

	)

80 
	#KVM_IRQCHIP_PIC_SLAVE
 1

	)

81 
	#KVM_IRQCHIP_IOAPIC
 2

	)

84 
	skvm_»gs
 {

86 
__u64
 
	m¿x
, 
	mrbx
, 
	mrcx
, 
	mrdx
;

87 
__u64
 
	mrsi
, 
	mrdi
, 
	mr¥
, 
	mrbp
;

88 
__u64
 
	mr8
, 
	mr9
, 
	mr10
, 
	mr11
;

89 
__u64
 
	mr12
, 
	mr13
, 
	mr14
, 
	mr15
;

90 
__u64
 
	mr
, 
	mræags
;

94 
	#KVM_APIC_REG_SIZE
 0x400

	)

95 
	skvm_Ïpic_¡©e
 {

96 
	m»gs
[
KVM_APIC_REG_SIZE
];

99 
	skvm_£gm’t
 {

100 
__u64
 
	mba£
;

101 
__u32
 
	mlim™
;

102 
__u16
 
	m£ËùÜ
;

103 
__u8
 
	mty³
;

104 
__u8
 
	m´e£Á
, 
	md¶
, 
	mdb
, 
	ms
, 
	ml
, 
	mg
, 
	mavl
;

105 
__u8
 
	munu§bË
;

106 
__u8
 
	m·ddšg
;

109 
	skvm_dbË
 {

110 
__u64
 
	mba£
;

111 
__u16
 
	mlim™
;

112 
__u16
 
	m·ddšg
[3];

117 
	skvm_¤egs
 {

119 
kvm_£gm’t
 
	mcs
, 
	mds
, 
	mes
, 
	mfs
, 
	mgs
, 
	mss
;

120 
kvm_£gm’t
 
	mŒ
, 
	mldt
;

121 
kvm_dbË
 
	mgdt
, 
	midt
;

122 
__u64
 
	mü0
, 
	mü2
, 
	mü3
, 
	mü4
, 
	mü8
;

123 
__u64
 
	meãr
;

124 
__u64
 
	m­ic_ba£
;

125 
__u64
 
	mš‹¼u±_b™m­
[(
KVM_NR_INTERRUPTS
 + 63) / 64];

129 
	skvm_åu
 {

130 
__u8
 
	mår
[8][16];

131 
__u16
 
	mfcw
;

132 
__u16
 
	mfsw
;

133 
__u8
 
	máwx
;

134 
__u8
 
	m·d1
;

135 
__u16
 
	mÏ¡_İcode
;

136 
__u64
 
	mÏ¡_
;

137 
__u64
 
	mÏ¡_dp
;

138 
__u8
 
	mxmm
[16][16];

139 
__u32
 
	mmxc¤
;

140 
__u32
 
	m·d2
;

143 
	skvm_m¤_’Œy
 {

144 
__u32
 
	mšdex
;

145 
__u32
 
	m»£rved
;

146 
__u64
 
	md©a
;

150 
	skvm_m¤s
 {

151 
__u32
 
	mnm¤s
;

152 
__u32
 
	m·d
;

154 
kvm_m¤_’Œy
 
	m’Œ›s
[0];

158 
	skvm_m¤_li¡
 {

159 
__u32
 
	mnm¤s
;

160 
__u32
 
	mšdiûs
[0];

164 
	skvm_ıuid_’Œy
 {

165 
__u32
 
	mfunùiÚ
;

166 
__u32
 
	m—x
;

167 
__u32
 
	mebx
;

168 
__u32
 
	mecx
;

169 
__u32
 
	medx
;

170 
__u32
 
	m·ddšg
;

174 
	skvm_ıuid
 {

175 
__u32
 
	mÃÁ
;

176 
__u32
 
	m·ddšg
;

177 
kvm_ıuid_’Œy
 
	m’Œ›s
[0];

180 
	skvm_ıuid_’Œy2
 {

181 
__u32
 
	mfunùiÚ
;

182 
__u32
 
	mšdex
;

183 
__u32
 
	mæags
;

184 
__u32
 
	m—x
;

185 
__u32
 
	mebx
;

186 
__u32
 
	mecx
;

187 
__u32
 
	medx
;

188 
__u32
 
	m·ddšg
[3];

191 
	#KVM_CPUID_FLAG_SIGNIFCANT_INDEX
 1

	)

192 
	#KVM_CPUID_FLAG_STATEFUL_FUNC
 2

	)

193 
	#KVM_CPUID_FLAG_STATE_READ_NEXT
 4

	)

196 
	skvm_ıuid2
 {

197 
__u32
 
	mÃÁ
;

198 
__u32
 
	m·ddšg
;

199 
kvm_ıuid_’Œy2
 
	m’Œ›s
[0];

203 
	skvm_p™_chªÃl_¡©e
 {

204 
__u32
 
	mcouÁ
;

205 
__u16
 
	mÏtched_couÁ
;

206 
__u8
 
	mcouÁ_Ïtched
;

207 
__u8
 
	m¡©us_Ïtched
;

208 
__u8
 
	m¡©us
;

209 
__u8
 
	m»ad_¡©e
;

210 
__u8
 
	mwr™e_¡©e
;

211 
__u8
 
	mwr™e_Ïtch
;

212 
__u8
 
	mrw_mode
;

213 
__u8
 
	mmode
;

214 
__u8
 
	mbcd
;

215 
__u8
 
	mg©e
;

216 
__s64
 
	mcouÁ_lßd_time
;

219 
	skvm_debug_ex™_¬ch
 {

220 
__u32
 
	mexû±iÚ
;

221 
__u32
 
	m·d
;

222 
__u64
 
	mpc
;

223 
__u64
 
	mdr6
;

224 
__u64
 
	mdr7
;

227 
	#KVM_GUESTDBG_USE_SW_BP
 0x00010000

	)

228 
	#KVM_GUESTDBG_USE_HW_BP
 0x00020000

	)

229 
	#KVM_GUESTDBG_INJECT_DB
 0x00040000

	)

230 
	#KVM_GUESTDBG_INJECT_BP
 0x00080000

	)

233 
	skvm_gue¡_debug_¬ch
 {

234 
__u64
 
	mdebug»g
[8];

237 
	skvm_p™_¡©e
 {

238 
kvm_p™_chªÃl_¡©e
 
	mchªÃls
[3];

241 
	#KVM_PIT_FLAGS_HPET_LEGACY
 0x00000001

	)

243 
	skvm_p™_¡©e2
 {

244 
kvm_p™_chªÃl_¡©e
 
	mchªÃls
[3];

245 
__u32
 
	mæags
;

246 
__u32
 
	m»£rved
[9];

249 
	skvm_»šjeù_cÚŒŞ
 {

250 
__u8
 
	mp™_»šjeù
;

251 
__u8
 
	m»£rved
[31];

	@/usr/include/asm/unistd.h

1 #ifdeà
__i386__


2 
	~"uni¡d_32.h
"

4 
	~"uni¡d_64.h
"

	@/usr/include/bits/confname.h

21 #iâdeà
_UNISTD_H


28 
	m_PC_LINK_MAX
,

29 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

30 
	m_PC_MAX_CANON
,

31 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

32 
	m_PC_MAX_INPUT
,

33 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

34 
	m_PC_NAME_MAX
,

35 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

36 
	m_PC_PATH_MAX
,

37 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

38 
	m_PC_PIPE_BUF
,

39 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

40 
	m_PC_CHOWN_RESTRICTED
,

41 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

42 
	m_PC_NO_TRUNC
,

43 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

44 
	m_PC_VDISABLE
,

45 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

46 
	m_PC_SYNC_IO
,

47 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

48 
	m_PC_ASYNC_IO
,

49 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

50 
	m_PC_PRIO_IO
,

51 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

52 
	m_PC_SOCK_MAXBUF
,

53 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

54 
	m_PC_FILESIZEBITS
,

55 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

56 
	m_PC_REC_INCR_XFER_SIZE
,

57 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

58 
	m_PC_REC_MAX_XFER_SIZE
,

59 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

60 
	m_PC_REC_MIN_XFER_SIZE
,

61 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

62 
	m_PC_REC_XFER_ALIGN
,

63 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

64 
	m_PC_ALLOC_SIZE_MIN
,

65 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

66 
	m_PC_SYMLINK_MAX
,

67 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

68 
	m_PC_2_SYMLINKS


69 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

75 
	m_SC_ARG_MAX
,

76 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

77 
	m_SC_CHILD_MAX
,

78 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

79 
	m_SC_CLK_TCK
,

80 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

81 
	m_SC_NGROUPS_MAX
,

82 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

83 
	m_SC_OPEN_MAX
,

84 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

85 
	m_SC_STREAM_MAX
,

86 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

87 
	m_SC_TZNAME_MAX
,

88 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

89 
	m_SC_JOB_CONTROL
,

90 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

91 
	m_SC_SAVED_IDS
,

92 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

93 
	m_SC_REALTIME_SIGNALS
,

94 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

95 
	m_SC_PRIORITY_SCHEDULING
,

96 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

97 
	m_SC_TIMERS
,

98 
	#_SC_TIMERS
 
_SC_TIMERS


	)

99 
	m_SC_ASYNCHRONOUS_IO
,

100 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

101 
	m_SC_PRIORITIZED_IO
,

102 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

103 
	m_SC_SYNCHRONIZED_IO
,

104 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

105 
	m_SC_FSYNC
,

106 
	#_SC_FSYNC
 
_SC_FSYNC


	)

107 
	m_SC_MAPPED_FILES
,

108 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

109 
	m_SC_MEMLOCK
,

110 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

111 
	m_SC_MEMLOCK_RANGE
,

112 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

113 
	m_SC_MEMORY_PROTECTION
,

114 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

115 
	m_SC_MESSAGE_PASSING
,

116 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

117 
	m_SC_SEMAPHORES
,

118 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

119 
	m_SC_SHARED_MEMORY_OBJECTS
,

120 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

121 
	m_SC_AIO_LISTIO_MAX
,

122 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

123 
	m_SC_AIO_MAX
,

124 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

125 
	m_SC_AIO_PRIO_DELTA_MAX
,

126 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

127 
	m_SC_DELAYTIMER_MAX
,

128 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

129 
	m_SC_MQ_OPEN_MAX
,

130 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

131 
	m_SC_MQ_PRIO_MAX
,

132 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

133 
	m_SC_VERSION
,

134 
	#_SC_VERSION
 
_SC_VERSION


	)

135 
	m_SC_PAGESIZE
,

136 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

137 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

138 
	m_SC_RTSIG_MAX
,

139 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

140 
	m_SC_SEM_NSEMS_MAX
,

141 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

142 
	m_SC_SEM_VALUE_MAX
,

143 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

144 
	m_SC_SIGQUEUE_MAX
,

145 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

146 
	m_SC_TIMER_MAX
,

147 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

151 
	m_SC_BC_BASE_MAX
,

152 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

153 
	m_SC_BC_DIM_MAX
,

154 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

155 
	m_SC_BC_SCALE_MAX
,

156 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

157 
	m_SC_BC_STRING_MAX
,

158 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

159 
	m_SC_COLL_WEIGHTS_MAX
,

160 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

161 
	m_SC_EQUIV_CLASS_MAX
,

162 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

163 
	m_SC_EXPR_NEST_MAX
,

164 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

165 
	m_SC_LINE_MAX
,

166 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

167 
	m_SC_RE_DUP_MAX
,

168 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

169 
	m_SC_CHARCLASS_NAME_MAX
,

170 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

172 
	m_SC_2_VERSION
,

173 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

174 
	m_SC_2_C_BIND
,

175 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

176 
	m_SC_2_C_DEV
,

177 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

178 
	m_SC_2_FORT_DEV
,

179 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

180 
	m_SC_2_FORT_RUN
,

181 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

182 
	m_SC_2_SW_DEV
,

183 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

184 
	m_SC_2_LOCALEDEF
,

185 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

187 
	m_SC_PII
,

188 
	#_SC_PII
 
_SC_PII


	)

189 
	m_SC_PII_XTI
,

190 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

191 
	m_SC_PII_SOCKET
,

192 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

193 
	m_SC_PII_INTERNET
,

194 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

195 
	m_SC_PII_OSI
,

196 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

197 
	m_SC_POLL
,

198 
	#_SC_POLL
 
_SC_POLL


	)

199 
	m_SC_SELECT
,

200 
	#_SC_SELECT
 
_SC_SELECT


	)

201 
	m_SC_UIO_MAXIOV
,

202 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

203 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

204 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

205 
	m_SC_PII_INTERNET_STREAM
,

206 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

207 
	m_SC_PII_INTERNET_DGRAM
,

208 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

209 
	m_SC_PII_OSI_COTS
,

210 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

211 
	m_SC_PII_OSI_CLTS
,

212 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

213 
	m_SC_PII_OSI_M
,

214 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

215 
	m_SC_T_IOV_MAX
,

216 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

219 
	m_SC_THREADS
,

220 
	#_SC_THREADS
 
_SC_THREADS


	)

221 
	m_SC_THREAD_SAFE_FUNCTIONS
,

222 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

223 
	m_SC_GETGR_R_SIZE_MAX
,

224 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

225 
	m_SC_GETPW_R_SIZE_MAX
,

226 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

227 
	m_SC_LOGIN_NAME_MAX
,

228 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

229 
	m_SC_TTY_NAME_MAX
,

230 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

231 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

232 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

233 
	m_SC_THREAD_KEYS_MAX
,

234 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

235 
	m_SC_THREAD_STACK_MIN
,

236 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

237 
	m_SC_THREAD_THREADS_MAX
,

238 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

239 
	m_SC_THREAD_ATTR_STACKADDR
,

240 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

241 
	m_SC_THREAD_ATTR_STACKSIZE
,

242 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

243 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

244 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

245 
	m_SC_THREAD_PRIO_INHERIT
,

246 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

247 
	m_SC_THREAD_PRIO_PROTECT
,

248 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

249 
	m_SC_THREAD_PROCESS_SHARED
,

250 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

252 
	m_SC_NPROCESSORS_CONF
,

253 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

254 
	m_SC_NPROCESSORS_ONLN
,

255 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

256 
	m_SC_PHYS_PAGES
,

257 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

258 
	m_SC_AVPHYS_PAGES
,

259 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

260 
	m_SC_ATEXIT_MAX
,

261 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

262 
	m_SC_PASS_MAX
,

263 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

265 
	m_SC_XOPEN_VERSION
,

266 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

267 
	m_SC_XOPEN_XCU_VERSION
,

268 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

269 
	m_SC_XOPEN_UNIX
,

270 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

271 
	m_SC_XOPEN_CRYPT
,

272 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

273 
	m_SC_XOPEN_ENH_I18N
,

274 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

275 
	m_SC_XOPEN_SHM
,

276 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

278 
	m_SC_2_CHAR_TERM
,

279 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

280 
	m_SC_2_C_VERSION
,

281 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

282 
	m_SC_2_UPE
,

283 
	#_SC_2_UPE
 
_SC_2_UPE


	)

285 
	m_SC_XOPEN_XPG2
,

286 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

287 
	m_SC_XOPEN_XPG3
,

288 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

289 
	m_SC_XOPEN_XPG4
,

290 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

292 
	m_SC_CHAR_BIT
,

293 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

294 
	m_SC_CHAR_MAX
,

295 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

296 
	m_SC_CHAR_MIN
,

297 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

298 
	m_SC_INT_MAX
,

299 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

300 
	m_SC_INT_MIN
,

301 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

302 
	m_SC_LONG_BIT
,

303 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

304 
	m_SC_WORD_BIT
,

305 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

306 
	m_SC_MB_LEN_MAX
,

307 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

308 
	m_SC_NZERO
,

309 
	#_SC_NZERO
 
_SC_NZERO


	)

310 
	m_SC_SSIZE_MAX
,

311 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

312 
	m_SC_SCHAR_MAX
,

313 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

314 
	m_SC_SCHAR_MIN
,

315 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

316 
	m_SC_SHRT_MAX
,

317 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

318 
	m_SC_SHRT_MIN
,

319 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

320 
	m_SC_UCHAR_MAX
,

321 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

322 
	m_SC_UINT_MAX
,

323 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

324 
	m_SC_ULONG_MAX
,

325 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

326 
	m_SC_USHRT_MAX
,

327 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

329 
	m_SC_NL_ARGMAX
,

330 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

331 
	m_SC_NL_LANGMAX
,

332 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

333 
	m_SC_NL_MSGMAX
,

334 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

335 
	m_SC_NL_NMAX
,

336 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

337 
	m_SC_NL_SETMAX
,

338 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

339 
	m_SC_NL_TEXTMAX
,

340 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

342 
	m_SC_XBS5_ILP32_OFF32
,

343 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

344 
	m_SC_XBS5_ILP32_OFFBIG
,

345 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

346 
	m_SC_XBS5_LP64_OFF64
,

347 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

348 
	m_SC_XBS5_LPBIG_OFFBIG
,

349 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

351 
	m_SC_XOPEN_LEGACY
,

352 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

353 
	m_SC_XOPEN_REALTIME
,

354 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

355 
	m_SC_XOPEN_REALTIME_THREADS
,

356 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

358 
	m_SC_ADVISORY_INFO
,

359 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

360 
	m_SC_BARRIERS
,

361 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

362 
	m_SC_BASE
,

363 
	#_SC_BASE
 
_SC_BASE


	)

364 
	m_SC_C_LANG_SUPPORT
,

365 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

366 
	m_SC_C_LANG_SUPPORT_R
,

367 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

368 
	m_SC_CLOCK_SELECTION
,

369 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

370 
	m_SC_CPUTIME
,

371 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

372 
	m_SC_THREAD_CPUTIME
,

373 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

374 
	m_SC_DEVICE_IO
,

375 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

376 
	m_SC_DEVICE_SPECIFIC
,

377 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

378 
	m_SC_DEVICE_SPECIFIC_R
,

379 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

380 
	m_SC_FD_MGMT
,

381 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

382 
	m_SC_FIFO
,

383 
	#_SC_FIFO
 
_SC_FIFO


	)

384 
	m_SC_PIPE
,

385 
	#_SC_PIPE
 
_SC_PIPE


	)

386 
	m_SC_FILE_ATTRIBUTES
,

387 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

388 
	m_SC_FILE_LOCKING
,

389 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

390 
	m_SC_FILE_SYSTEM
,

391 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

392 
	m_SC_MONOTONIC_CLOCK
,

393 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

394 
	m_SC_MULTI_PROCESS
,

395 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

396 
	m_SC_SINGLE_PROCESS
,

397 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

398 
	m_SC_NETWORKING
,

399 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

400 
	m_SC_READER_WRITER_LOCKS
,

401 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

402 
	m_SC_SPIN_LOCKS
,

403 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

404 
	m_SC_REGEXP
,

405 
	#_SC_REGEXP
 
_SC_REGEXP


	)

406 
	m_SC_REGEX_VERSION
,

407 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

408 
	m_SC_SHELL
,

409 
	#_SC_SHELL
 
_SC_SHELL


	)

410 
	m_SC_SIGNALS
,

411 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

412 
	m_SC_SPAWN
,

413 
	#_SC_SPAWN
 
_SC_SPAWN


	)

414 
	m_SC_SPORADIC_SERVER
,

415 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

416 
	m_SC_THREAD_SPORADIC_SERVER
,

417 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

418 
	m_SC_SYSTEM_DATABASE
,

419 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

420 
	m_SC_SYSTEM_DATABASE_R
,

421 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

422 
	m_SC_TIMEOUTS
,

423 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

424 
	m_SC_TYPED_MEMORY_OBJECTS
,

425 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

426 
	m_SC_USER_GROUPS
,

427 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

428 
	m_SC_USER_GROUPS_R
,

429 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

430 
	m_SC_2_PBS
,

431 
	#_SC_2_PBS
 
_SC_2_PBS


	)

432 
	m_SC_2_PBS_ACCOUNTING
,

433 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

434 
	m_SC_2_PBS_LOCATE
,

435 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

436 
	m_SC_2_PBS_MESSAGE
,

437 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

438 
	m_SC_2_PBS_TRACK
,

439 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

440 
	m_SC_SYMLOOP_MAX
,

441 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

442 
	m_SC_STREAMS
,

443 
	#_SC_STREAMS
 
_SC_STREAMS


	)

444 
	m_SC_2_PBS_CHECKPOINT
,

445 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

447 
	m_SC_V6_ILP32_OFF32
,

448 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

449 
	m_SC_V6_ILP32_OFFBIG
,

450 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

451 
	m_SC_V6_LP64_OFF64
,

452 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

453 
	m_SC_V6_LPBIG_OFFBIG
,

454 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

456 
	m_SC_HOST_NAME_MAX
,

457 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

458 
	m_SC_TRACE
,

459 
	#_SC_TRACE
 
_SC_TRACE


	)

460 
	m_SC_TRACE_EVENT_FILTER
,

461 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

462 
	m_SC_TRACE_INHERIT
,

463 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

464 
	m_SC_TRACE_LOG
,

465 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

467 
	m_SC_LEVEL1_ICACHE_SIZE
,

468 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

469 
	m_SC_LEVEL1_ICACHE_ASSOC
,

470 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

471 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

472 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

473 
	m_SC_LEVEL1_DCACHE_SIZE
,

474 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

475 
	m_SC_LEVEL1_DCACHE_ASSOC
,

476 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

477 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

478 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

479 
	m_SC_LEVEL2_CACHE_SIZE
,

480 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

481 
	m_SC_LEVEL2_CACHE_ASSOC
,

482 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

483 
	m_SC_LEVEL2_CACHE_LINESIZE
,

484 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

485 
	m_SC_LEVEL3_CACHE_SIZE
,

486 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

487 
	m_SC_LEVEL3_CACHE_ASSOC
,

488 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

489 
	m_SC_LEVEL3_CACHE_LINESIZE
,

490 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

491 
	m_SC_LEVEL4_CACHE_SIZE
,

492 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

493 
	m_SC_LEVEL4_CACHE_ASSOC
,

494 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

495 
	m_SC_LEVEL4_CACHE_LINESIZE
,

496 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

499 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

500 
	#_SC_IPV6
 
_SC_IPV6


	)

501 
	m_SC_RAW_SOCKETS
,

502 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

504 
	m_SC_V7_ILP32_OFF32
,

505 
	#_SC_V7_ILP32_OFF32
 
_SC_V7_ILP32_OFF32


	)

506 
	m_SC_V7_ILP32_OFFBIG
,

507 
	#_SC_V7_ILP32_OFFBIG
 
_SC_V7_ILP32_OFFBIG


	)

508 
	m_SC_V7_LP64_OFF64
,

509 
	#_SC_V7_LP64_OFF64
 
_SC_V7_LP64_OFF64


	)

510 
	m_SC_V7_LPBIG_OFFBIG
,

511 
	#_SC_V7_LPBIG_OFFBIG
 
_SC_V7_LPBIG_OFFBIG


	)

513 
	m_SC_SS_REPL_MAX
,

514 
	#_SC_SS_REPL_MAX
 
_SC_SS_REPL_MAX


	)

516 
	m_SC_TRACE_EVENT_NAME_MAX
,

517 
	#_SC_TRACE_EVENT_NAME_MAX
 
_SC_TRACE_EVENT_NAME_MAX


	)

518 
	m_SC_TRACE_NAME_MAX
,

519 
	#_SC_TRACE_NAME_MAX
 
_SC_TRACE_NAME_MAX


	)

520 
	m_SC_TRACE_SYS_MAX
,

521 
	#_SC_TRACE_SYS_MAX
 
_SC_TRACE_SYS_MAX


	)

522 
	m_SC_TRACE_USER_EVENT_MAX
,

523 
	#_SC_TRACE_USER_EVENT_MAX
 
_SC_TRACE_USER_EVENT_MAX


	)

525 
	m_SC_XOPEN_STREAMS
,

526 
	#_SC_XOPEN_STREAMS
 
_SC_XOPEN_STREAMS


	)

528 
	m_SC_THREAD_ROBUST_PRIO_INHERIT
,

529 
	#_SC_THREAD_ROBUST_PRIO_INHERIT
 
_SC_THREAD_ROBUST_PRIO_INHERIT


	)

530 
	m_SC_THREAD_ROBUST_PRIO_PROTECT


531 
	#_SC_THREAD_ROBUST_PRIO_PROTECT
 
_SC_THREAD_ROBUST_PRIO_PROTECT


	)

537 
	m_CS_PATH
,

538 
	#_CS_PATH
 
_CS_PATH


	)

540 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

541 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

542 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

544 
	m_CS_GNU_LIBC_VERSION
,

545 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

546 
	m_CS_GNU_LIBPTHREAD_VERSION
,

547 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

549 
	m_CS_V5_WIDTH_RESTRICTED_ENVS
,

550 
	#_CS_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

551 
	#_CS_POSIX_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

553 
	m_CS_V7_WIDTH_RESTRICTED_ENVS
,

554 
	#_CS_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

555 
	#_CS_POSIX_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

557 
	m_CS_LFS_CFLAGS
 = 1000,

558 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

559 
	m_CS_LFS_LDFLAGS
,

560 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

561 
	m_CS_LFS_LIBS
,

562 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

563 
	m_CS_LFS_LINTFLAGS
,

564 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

565 
	m_CS_LFS64_CFLAGS
,

566 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

567 
	m_CS_LFS64_LDFLAGS
,

568 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

569 
	m_CS_LFS64_LIBS
,

570 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

571 
	m_CS_LFS64_LINTFLAGS
,

572 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

574 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

575 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

576 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

577 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

578 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

579 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

580 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

581 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

582 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

583 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

584 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

585 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

586 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

587 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

588 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

589 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

590 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

591 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

592 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

593 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

594 
	m_CS_XBS5_LP64_OFF64_LIBS
,

595 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

596 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

597 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

598 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

599 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

600 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

601 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

602 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

603 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

604 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

605 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

607 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

608 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

609 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

610 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

611 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

612 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

613 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

614 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

615 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

616 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

617 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

618 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

619 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

620 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

621 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

622 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

623 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

624 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

625 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

626 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

627 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

628 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

629 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

630 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

631 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

632 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

633 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

634 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

635 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

636 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

637 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
,

638 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

640 
	m_CS_POSIX_V7_ILP32_OFF32_CFLAGS
,

641 
	#_CS_POSIX_V7_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_CFLAGS


	)

642 
	m_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
,

643 
	#_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LDFLAGS


	)

644 
	m_CS_POSIX_V7_ILP32_OFF32_LIBS
,

645 
	#_CS_POSIX_V7_ILP32_OFF32_LIBS
 
_CS_POSIX_V7_ILP32_OFF32_LIBS


	)

646 
	m_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
,

647 
	#_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS


	)

648 
	m_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
,

649 
	#_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS


	)

650 
	m_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
,

651 
	#_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS


	)

652 
	m_CS_POSIX_V7_ILP32_OFFBIG_LIBS
,

653 
	#_CS_POSIX_V7_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V7_ILP32_OFFBIG_LIBS


	)

654 
	m_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
,

655 
	#_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS


	)

656 
	m_CS_POSIX_V7_LP64_OFF64_CFLAGS
,

657 
	#_CS_POSIX_V7_LP64_OFF64_CFLAGS
 
_CS_POSIX_V7_LP64_OFF64_CFLAGS


	)

658 
	m_CS_POSIX_V7_LP64_OFF64_LDFLAGS
,

659 
	#_CS_POSIX_V7_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LDFLAGS


	)

660 
	m_CS_POSIX_V7_LP64_OFF64_LIBS
,

661 
	#_CS_POSIX_V7_LP64_OFF64_LIBS
 
_CS_POSIX_V7_LP64_OFF64_LIBS


	)

662 
	m_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
,

663 
	#_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LINTFLAGS


	)

664 
	m_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
,

665 
	#_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS


	)

666 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
,

667 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS


	)

668 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
,

669 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LIBS


	)

670 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


671 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


	)

	@/usr/include/bits/environments.h

19 #iâdeà
_UNISTD_H


23 
	~<b™s/wÜdsize.h
>

43 #ià
__WORDSIZE
 == 64

57 
	#_POSIX_V7_LPBIG_OFFBIG
 -1

	)

58 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

59 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

62 
	#_POSIX_V7_LP64_OFF64
 1

	)

63 
	#_POSIX_V6_LP64_OFF64
 1

	)

64 
	#_XBS5_LP64_OFF64
 1

	)

70 
	#_POSIX_V7_ILP32_OFF32
 1

	)

71 
	#_POSIX_V7_ILP32_OFFBIG
 1

	)

72 
	#_POSIX_V6_ILP32_OFF32
 1

	)

73 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

74 
	#_XBS5_ILP32_OFF32
 1

	)

75 
	#_XBS5_ILP32_OFFBIG
 1

	)

92 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

93 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

94 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

95 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

96 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

97 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/fcntl.h

20 #iâdef 
_FCNTL_H


24 
	~<sys/ty³s.h
>

25 
	~<b™s/wÜdsize.h
>

26 #ifdeà
__USE_GNU


27 
	~<b™s/uio.h
>

33 
	#O_ACCMODE
 0003

	)

34 
	#O_RDONLY
 00

	)

35 
	#O_WRONLY
 01

	)

36 
	#O_RDWR
 02

	)

37 
	#O_CREAT
 0100

	)

38 
	#O_EXCL
 0200

	)

39 
	#O_NOCTTY
 0400

	)

40 
	#O_TRUNC
 01000

	)

41 
	#O_APPEND
 02000

	)

42 
	#O_NONBLOCK
 04000

	)

43 
	#O_NDELAY
 
O_NONBLOCK


	)

44 
	#O_SYNC
 010000

	)

45 
	#O_FSYNC
 
O_SYNC


	)

46 
	#O_ASYNC
 020000

	)

48 #ifdeà
__USE_GNU


49 
	#O_DIRECT
 040000

	)

50 
	#O_DIRECTORY
 0200000

	)

51 
	#O_NOFOLLOW
 0400000

	)

52 
	#O_NOATIME
 01000000

	)

53 
	#O_CLOEXEC
 02000000

	)

59 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


60 
	#O_DSYNC
 
O_SYNC


	)

61 
	#O_RSYNC
 
O_SYNC


	)

64 #ifdeà
__USE_LARGEFILE64


65 #ià
__WORDSIZE
 == 64

66 
	#O_LARGEFILE
 0

	)

68 
	#O_LARGEFILE
 0100000

	)

73 
	#F_DUPFD
 0

	)

74 
	#F_GETFD
 1

	)

75 
	#F_SETFD
 2

	)

76 
	#F_GETFL
 3

	)

77 
	#F_SETFL
 4

	)

78 #ià
__WORDSIZE
 == 64

79 
	#F_GETLK
 5

	)

80 
	#F_SETLK
 6

	)

81 
	#F_SETLKW
 7

	)

83 
	#F_GETLK64
 5

	)

84 
	#F_SETLK64
 6

	)

85 
	#F_SETLKW64
 7

	)

87 #iâdeà
__USE_FILE_OFFSET64


88 
	#F_GETLK
 5

	)

89 
	#F_SETLK
 6

	)

90 
	#F_SETLKW
 7

	)

92 
	#F_GETLK
 
F_GETLK64


	)

93 
	#F_SETLK
 
F_SETLK64


	)

94 
	#F_SETLKW
 
F_SETLKW64


	)

96 
	#F_GETLK64
 12

	)

97 
	#F_SETLK64
 13

	)

98 
	#F_SETLKW64
 14

	)

101 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


102 
	#F_SETOWN
 8

	)

103 
	#F_GETOWN
 9

	)

106 #ifdeà
__USE_GNU


107 
	#F_SETSIG
 10

	)

108 
	#F_GETSIG
 11

	)

109 
	#F_SETOWN_EX
 15

	)

110 
	#F_GETOWN_EX
 16

	)

113 #ifdeà
__USE_GNU


114 
	#F_SETLEASE
 1024

	)

115 
	#F_GETLEASE
 1025

	)

116 
	#F_NOTIFY
 1026

	)

117 
	#F_DUPFD_CLOEXEC
 1030

	)

122 
	#FD_CLOEXEC
 1

	)

125 
	#F_RDLCK
 0

	)

126 
	#F_WRLCK
 1

	)

127 
	#F_UNLCK
 2

	)

130 
	#F_EXLCK
 4

	)

131 
	#F_SHLCK
 8

	)

133 #ifdeà
__USE_BSD


135 
	#LOCK_SH
 1

	)

136 
	#LOCK_EX
 2

	)

137 
	#LOCK_NB
 4

	)

139 
	#LOCK_UN
 8

	)

142 #ifdeà
__USE_GNU


143 
	#LOCK_MAND
 32

	)

144 
	#LOCK_READ
 64

	)

145 
	#LOCK_WRITE
 128

	)

146 
	#LOCK_RW
 192

	)

149 #ifdeà
__USE_GNU


151 
	#DN_ACCESS
 0x00000001

	)

152 
	#DN_MODIFY
 0x00000002

	)

153 
	#DN_CREATE
 0x00000004

	)

154 
	#DN_DELETE
 0x00000008

	)

155 
	#DN_RENAME
 0x00000010

	)

156 
	#DN_ATTRIB
 0x00000020

	)

157 
	#DN_MULTISHOT
 0x80000000

	)

160 
	sæock


162 
	ml_ty³
;

163 
	ml_wh’û
;

164 #iâdeà
__USE_FILE_OFFSET64


165 
__off_t
 
	ml_¡¬t
;

166 
__off_t
 
	ml_Ën
;

168 
__off64_t
 
	ml_¡¬t
;

169 
__off64_t
 
	ml_Ën
;

171 
__pid_t
 
	ml_pid
;

174 #ifdeà
__USE_LARGEFILE64


175 
	sæock64


177 
	ml_ty³
;

178 
	ml_wh’û
;

179 
__off64_t
 
	ml_¡¬t
;

180 
__off64_t
 
	ml_Ën
;

181 
__pid_t
 
	ml_pid
;

185 #ifdeà
__USE_GNU


187 
	e__pid_ty³


189 
	mF_OWNER_TID
 = 0,

190 
	mF_OWNER_PID
,

191 
	mF_OWNER_GID


195 
	sf_owÃr_ex


197 
__pid_ty³
 
	mty³
;

198 
__pid_t
 
	mpid
;

204 #ifdef 
__USE_BSD


205 
	#FAPPEND
 
O_APPEND


	)

206 
	#FFSYNC
 
O_FSYNC


	)

207 
	#FASYNC
 
O_ASYNC


	)

208 
	#FNONBLOCK
 
O_NONBLOCK


	)

209 
	#FNDELAY
 
O_NDELAY


	)

213 #ifdeà
__USE_XOPEN2K


214 
	#POSIX_FADV_NORMAL
 0

	)

215 
	#POSIX_FADV_RANDOM
 1

	)

216 
	#POSIX_FADV_SEQUENTIAL
 2

	)

217 
	#POSIX_FADV_WILLNEED
 3

	)

218 
	#POSIX_FADV_DONTNEED
 4

	)

219 
	#POSIX_FADV_NOREUSE
 5

	)

223 #ifdeà
__USE_GNU


225 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

228 
	#SYNC_FILE_RANGE_WRITE
 2

	)

231 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

236 
	#SPLICE_F_MOVE
 1

	)

237 
	#SPLICE_F_NONBLOCK
 2

	)

240 
	#SPLICE_F_MORE
 4

	)

241 
	#SPLICE_F_GIFT
 8

	)

245 #ifdeà
__USE_ATFILE


246 
	#AT_FDCWD
 -100

	)

249 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

250 
	#AT_REMOVEDIR
 0x200

	)

252 
	#AT_SYMLINK_FOLLOW
 0x400

	)

253 
	#AT_EACCESS
 0x200

	)

257 
	g__BEGIN_DECLS


259 #ifdeà
__USE_GNU


262 
ssize_t
 
	$»adah—d
 (
__fd
, 
__off64_t
 
__off£t
, 
size_t
 
__couÁ
)

263 
__THROW
;

267 
	`sync_fe_¿nge
 (
__fd
, 
__off64_t
 
__äom
, __off64_ˆ
__to
,

268 
__æags
);

272 
ssize_t
 
	`vm¥liû
 (
__fdout
, cÚ¡ 
iovec
 *
__iov
,

273 
size_t
 
__couÁ
, 
__æags
);

276 
ssize_t
 
	`¥liû
 (
__fdš
, 
__off64_t
 *
__offš
, 
__fdout
,

277 
__off64_t
 *
__offout
, 
size_t
 
__Ën
,

278 
__æags
);

281 
ssize_t
 
	`‹e
 (
__fdš
, 
__fdout
, 
size_t
 
__Ën
,

282 
__æags
);

285 #iâdeà
__USE_FILE_OFFSET64


286 
	`çÎoÿ‹
 (
__fd
, 
__mode
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
);

288 #ifdeà
__REDIRECT


289 
	`__REDIRECT
 (
çÎoÿ‹
, (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

290 
__off64_t
 
__Ën
),

291 
çÎoÿ‹64
);

293 
	#çÎoÿ‹
 
çÎoÿ‹64


	)

296 #ifdeà
__USE_LARGEFILE64


297 
	`çÎoÿ‹64
 (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

298 
__off64_t
 
__Ën
);

302 
__END_DECLS


	@/usr/include/bits/fcntl2.h

20 #iâdef 
_FCNTL_H


26 #iâdeà
__USE_FILE_OFFSET64


27 
	$__İ’_2
 (
__cÚ¡
 *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

28 
	`__REDIRECT
 (
__İ’_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
, ...),

29 
İ’
è
	`__nÚnuÎ
 ((1));

31 
	`__REDIRECT
 (
__İ’_2
, (
__cÚ¡
 *
__·th
, 
__oæag
),

32 
__İ’64_2
è
	`__nÚnuÎ
 ((1));

33 
	`__REDIRECT
 (
__İ’_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
, ...),

34 
İ’64
è
	`__nÚnuÎ
 ((1));

36 
	`__”rÜdeş
 (
__İ’_too_mªy_¬gs
,

38 
	`__”rÜdeş
 (
__İ’_missšg_mode
,

41 
__ex‹º_®ways_šlše
 

42 
	$İ’
 (
__cÚ¡
 *
__·th
, 
__oæag
, ...)

44 ià(
	`__va_¬g_·ck_Ën
 () > 1)

45 
	`__İ’_too_mªy_¬gs
 ();

47 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

49 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

51 
	`__İ’_missšg_mode
 ();

52  
	`__İ’_2
 (
__·th
, 
__oæag
);

54  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

57 ià(
	`__va_¬g_·ck_Ën
 () < 1)

58  
	`__İ’_2
 (
__·th
, 
__oæag
);

60  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

61 
	}
}

64 #ifdeà
__USE_LARGEFILE64


65 
	$__İ’64_2
 (
__cÚ¡
 *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

66 
	`__REDIRECT
 (
__İ’64_®Ÿs
, (
__cÚ¡
 *
__·th
, 
__oæag
,

67 ...), 
İ’64
è
	`__nÚnuÎ
 ((1));

68 
	`__”rÜdeş
 (
__İ’64_too_mªy_¬gs
,

70 
	`__”rÜdeş
 (
__İ’64_missšg_mode
,

73 
__ex‹º_®ways_šlše
 

74 
	$İ’64
 (
__cÚ¡
 *
__·th
, 
__oæag
, ...)

76 ià(
	`__va_¬g_·ck_Ën
 () > 1)

77 
	`__İ’64_too_mªy_¬gs
 ();

79 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

81 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

83 
	`__İ’64_missšg_mode
 ();

84  
	`__İ’64_2
 (
__·th
, 
__oæag
);

86  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

89 ià(
	`__va_¬g_·ck_Ën
 () < 1)

90  
	`__İ’64_2
 (
__·th
, 
__oæag
);

92  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

93 
	}
}

97 #ifdeà
__USE_ATFILE


98 #iâdeà
__USE_FILE_OFFSET64


99 
	$__İ’©_2
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
)

100 
	`__nÚnuÎ
 ((2));

101 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

102 
__oæag
, ...), 
İ’©
)

103 
	`__nÚnuÎ
 ((2));

105 
	`__REDIRECT
 (
__İ’©_2
, (
__fd
, 
__cÚ¡
 *
__·th
,

106 
__oæag
), 
__İ’©64_2
)

107 
	`__nÚnuÎ
 ((2));

108 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

109 
__oæag
, ...), 
İ’©64
)

110 
	`__nÚnuÎ
 ((2));

112 
	`__”rÜdeş
 (
__İ’©_too_mªy_¬gs
,

114 
	`__”rÜdeş
 (
__İ’©_missšg_mode
,

117 
__ex‹º_®ways_šlše
 

118 
	$İ’©
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
, ...)

120 ià(
	`__va_¬g_·ck_Ën
 () > 1)

121 
	`__İ’©_too_mªy_¬gs
 ();

123 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

125 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

127 
	`__İ’©_missšg_mode
 ();

128  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

130  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

133 ià(
	`__va_¬g_·ck_Ën
 () < 1)

134  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

136  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

137 
	}
}

140 #ifdeà
__USE_LARGEFILE64


141 
	$__İ’©64_2
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
)

142 
	`__nÚnuÎ
 ((2));

143 
	`__REDIRECT
 (
__İ’©64_®Ÿs
, (
__fd
, 
__cÚ¡
 *
__·th
,

144 
__oæag
, ...), 
İ’©64
)

145 
	`__nÚnuÎ
 ((2));

146 
	`__”rÜdeş
 (
__İ’©64_too_mªy_¬gs
,

148 
	`__”rÜdeş
 (
__İ’©64_missšg_mode
,

151 
__ex‹º_®ways_šlše
 

152 
	$İ’©64
 (
__fd
, 
__cÚ¡
 *
__·th
, 
__oæag
, ...)

154 ià(
	`__va_¬g_·ck_Ën
 () > 1)

155 
	`__İ’©64_too_mªy_¬gs
 ();

157 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

159 ià((
__oæag
 & 
O_CREAT
è!ğ0 && 
	`__va_¬g_·ck_Ën
 () < 1)

161 
	`__İ’©64_missšg_mode
 ();

162  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

164  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

167 ià(
	`__va_¬g_·ck_Ën
 () < 1)

168  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

170  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

171 
	}
}

	@/usr/include/bits/ioctl-types.h

20 #iâdeà
_SYS_IOCTL_H


25 
	~<asm/ioùls.h
>

28 
	swšsize


30 
	mws_row
;

31 
	mws_cŞ
;

32 
	mws_xpix–
;

33 
	mws_ypix–
;

36 
	#NCC
 8

	)

37 
	s‹rmio


39 
	mc_iæag
;

40 
	mc_oæag
;

41 
	mc_cæag
;

42 
	mc_læag
;

43 
	mc_lše
;

44 
	mc_cc
[
NCC
];

48 
	#TIOCM_LE
 0x001

	)

49 
	#TIOCM_DTR
 0x002

	)

50 
	#TIOCM_RTS
 0x004

	)

51 
	#TIOCM_ST
 0x008

	)

52 
	#TIOCM_SR
 0x010

	)

53 
	#TIOCM_CTS
 0x020

	)

54 
	#TIOCM_CAR
 0x040

	)

55 
	#TIOCM_RNG
 0x080

	)

56 
	#TIOCM_DSR
 0x100

	)

57 
	#TIOCM_CD
 
TIOCM_CAR


	)

58 
	#TIOCM_RI
 
TIOCM_RNG


	)

63 
	#N_TTY
 0

	)

64 
	#N_SLIP
 1

	)

65 
	#N_MOUSE
 2

	)

66 
	#N_PPP
 3

	)

67 
	#N_STRIP
 4

	)

68 
	#N_AX25
 5

	)

69 
	#N_X25
 6

	)

70 
	#N_6PACK
 7

	)

71 
	#N_MASC
 8

	)

72 
	#N_R3964
 9

	)

73 
	#N_PROFIBUS_FDL
 10

	)

74 
	#N_IRDA
 11

	)

75 
	#N_SMSBLOCK
 12

	)

76 
	#N_HDLC
 13

	)

77 
	#N_SYNC_PPP
 14

	)

78 
	#N_HCI
 15

	)

	@/usr/include/bits/ioctls.h

19 #iâdeà
_SYS_IOCTL_H


24 
	~<asm/ioùls.h
>

27 
	#SIOCADDRT
 0x890B

	)

28 
	#SIOCDELRT
 0x890C

	)

29 
	#SIOCRTMSG
 0x890D

	)

32 
	#SIOCGIFNAME
 0x8910

	)

33 
	#SIOCSIFLINK
 0x8911

	)

34 
	#SIOCGIFCONF
 0x8912

	)

35 
	#SIOCGIFFLAGS
 0x8913

	)

36 
	#SIOCSIFFLAGS
 0x8914

	)

37 
	#SIOCGIFADDR
 0x8915

	)

38 
	#SIOCSIFADDR
 0x8916

	)

39 
	#SIOCGIFDSTADDR
 0x8917

	)

40 
	#SIOCSIFDSTADDR
 0x8918

	)

41 
	#SIOCGIFBRDADDR
 0x8919

	)

42 
	#SIOCSIFBRDADDR
 0x891¨

	)

43 
	#SIOCGIFNETMASK
 0x891b

	)

44 
	#SIOCSIFNETMASK
 0x891ø

	)

45 
	#SIOCGIFMETRIC
 0x891d

	)

46 
	#SIOCSIFMETRIC
 0x891

	)

47 
	#SIOCGIFMEM
 0x891à

	)

48 
	#SIOCSIFMEM
 0x8920

	)

49 
	#SIOCGIFMTU
 0x8921

	)

50 
	#SIOCSIFMTU
 0x8922

	)

51 
	#SIOCSIFNAME
 0x8923

	)

52 
	#SIOCSIFHWADDR
 0x8924

	)

53 
	#SIOCGIFENCAP
 0x8925

	)

54 
	#SIOCSIFENCAP
 0x8926

	)

55 
	#SIOCGIFHWADDR
 0x8927

	)

56 
	#SIOCGIFSLAVE
 0x8929

	)

57 
	#SIOCSIFSLAVE
 0x8930

	)

58 
	#SIOCADDMULTI
 0x8931

	)

59 
	#SIOCDELMULTI
 0x8932

	)

60 
	#SIOCGIFINDEX
 0x8933

	)

61 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

62 
	#SIOCSIFPFLAGS
 0x8934

	)

63 
	#SIOCGIFPFLAGS
 0x8935

	)

64 
	#SIOCDIFADDR
 0x8936

	)

65 
	#SIOCSIFHWBROADCAST
 0x8937

	)

66 
	#SIOCGIFCOUNT
 0x8938

	)

68 
	#SIOCGIFBR
 0x8940

	)

69 
	#SIOCSIFBR
 0x8941

	)

71 
	#SIOCGIFTXQLEN
 0x8942

	)

72 
	#SIOCSIFTXQLEN
 0x8943

	)

77 
	#SIOCDARP
 0x8953

	)

78 
	#SIOCGARP
 0x8954

	)

79 
	#SIOCSARP
 0x8955

	)

82 
	#SIOCDRARP
 0x8960

	)

83 
	#SIOCGRARP
 0x8961

	)

84 
	#SIOCSRARP
 0x8962

	)

88 
	#SIOCGIFMAP
 0x8970

	)

89 
	#SIOCSIFMAP
 0x8971

	)

93 
	#SIOCADDDLCI
 0x8980

	)

94 
	#SIOCDELDLCI
 0x8981

	)

103 
	#SIOCDEVPRIVATE
 0x89F0

	)

109 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/bits/ipc.h

19 #iâdeà
_SYS_IPC_H


23 
	~<b™s/ty³s.h
>

26 
	#IPC_CREAT
 01000

	)

27 
	#IPC_EXCL
 02000

	)

28 
	#IPC_NOWAIT
 04000

	)

31 
	#IPC_RMID
 0

	)

32 
	#IPC_SET
 1

	)

33 
	#IPC_STAT
 2

	)

34 #ifdeà
__USE_GNU


35 
	#IPC_INFO
 3

	)

39 
	#IPC_PRIVATE
 ((
__key_t
è0è

	)

43 
	sc_³rm


45 
__key_t
 
	m__key
;

46 
__uid_t
 
	muid
;

47 
__gid_t
 
	mgid
;

48 
__uid_t
 
	mcuid
;

49 
__gid_t
 
	mcgid
;

50 
	mmode
;

51 
	m__·d1
;

52 
	m__£q
;

53 
	m__·d2
;

54 
	m__unu£d1
;

55 
	m__unu£d2
;

	@/usr/include/bits/ipctypes.h

24 #iâdeà
_BITS_IPCTYPES_H


25 
	#_BITS_IPCTYPES_H
 1

	)

27 
	~<b™s/ty³s.h
>

30 #ià
__WORDSIZE
 == 32

31 
	t__c_pid_t
;

33 
	t__c_pid_t
;

	@/usr/include/bits/mman.h

20 #iâdeà
_SYS_MMAN_H


33 
	#PROT_READ
 0x1

	)

34 
	#PROT_WRITE
 0x2

	)

35 
	#PROT_EXEC
 0x4

	)

36 
	#PROT_NONE
 0x0

	)

37 
	#PROT_GROWSDOWN
 0x01000000

	)

39 
	#PROT_GROWSUP
 0x02000000

	)

43 
	#MAP_SHARED
 0x01

	)

44 
	#MAP_PRIVATE
 0x02

	)

45 #ifdeà
__USE_MISC


46 
	#MAP_TYPE
 0x0à

	)

50 
	#MAP_FIXED
 0x10

	)

51 #ifdeà
__USE_MISC


52 
	#MAP_FILE
 0

	)

53 
	#MAP_ANONYMOUS
 0x20

	)

54 
	#MAP_ANON
 
MAP_ANONYMOUS


	)

55 
	#MAP_32BIT
 0x40

	)

59 #ifdeà
__USE_MISC


60 
	#MAP_GROWSDOWN
 0x00100

	)

61 
	#MAP_DENYWRITE
 0x00800

	)

62 
	#MAP_EXECUTABLE
 0x01000

	)

63 
	#MAP_LOCKED
 0x02000

	)

64 
	#MAP_NORESERVE
 0x04000

	)

65 
	#MAP_POPULATE
 0x08000

	)

66 
	#MAP_NONBLOCK
 0x10000

	)

67 
	#MAP_STACK
 0x20000

	)

71 
	#MS_ASYNC
 1

	)

72 
	#MS_SYNC
 4

	)

73 
	#MS_INVALIDATE
 2

	)

76 
	#MCL_CURRENT
 1

	)

77 
	#MCL_FUTURE
 2

	)

81 #ifdeà
__USE_GNU


82 
	#MREMAP_MAYMOVE
 1

	)

83 
	#MREMAP_FIXED
 2

	)

87 #ifdeà
__USE_BSD


88 
	#MADV_NORMAL
 0

	)

89 
	#MADV_RANDOM
 1

	)

90 
	#MADV_SEQUENTIAL
 2

	)

91 
	#MADV_WILLNEED
 3

	)

92 
	#MADV_DONTNEED
 4

	)

93 
	#MADV_REMOVE
 9

	)

94 
	#MADV_DONTFORK
 10

	)

95 
	#MADV_DOFORK
 11

	)

96 
	#MADV_MERGEABLE
 12

	)

97 
	#MADV_UNMERGEABLE
 13

	)

98 
	#MADV_HWPOISON
 100

	)

102 #ifdeà
__USE_XOPEN2K


103 
	#POSIX_MADV_NORMAL
 0

	)

104 
	#POSIX_MADV_RANDOM
 1

	)

105 
	#POSIX_MADV_SEQUENTIAL
 2

	)

106 
	#POSIX_MADV_WILLNEED
 3

	)

107 
	#POSIX_MADV_DONTNEED
 4

	)

	@/usr/include/bits/posix_opt.h

20 #iâdef 
_BITS_POSIX_OPT_H


21 
	#_BITS_POSIX_OPT_H
 1

	)

24 
	#_POSIX_JOB_CONTROL
 1

	)

27 
	#_POSIX_SAVED_IDS
 1

	)

30 
	#_POSIX_PRIORITY_SCHEDULING
 200809L

	)

33 
	#_POSIX_SYNCHRONIZED_IO
 200809L

	)

36 
	#_POSIX_FSYNC
 200809L

	)

39 
	#_POSIX_MAPPED_FILES
 200809L

	)

42 
	#_POSIX_MEMLOCK
 200809L

	)

45 
	#_POSIX_MEMLOCK_RANGE
 200809L

	)

48 
	#_POSIX_MEMORY_PROTECTION
 200809L

	)

51 
	#_POSIX_CHOWN_RESTRICTED
 0

	)

55 
	#_POSIX_VDISABLE
 '\0'

	)

58 
	#_POSIX_NO_TRUNC
 1

	)

61 
	#_XOPEN_REALTIME
 1

	)

64 
	#_XOPEN_REALTIME_THREADS
 1

	)

67 
	#_XOPEN_SHM
 1

	)

70 
	#_POSIX_THREADS
 200809L

	)

73 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

74 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200809L

	)

77 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200809L

	)

80 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200809L

	)

83 
	#_POSIX_THREAD_ATTR_STACKADDR
 200809L

	)

86 
	#_POSIX_THREAD_PRIO_INHERIT
 200809L

	)

90 
	#_POSIX_THREAD_PRIO_PROTECT
 200809L

	)

92 #ifdeà
__USE_XOPEN2K8


94 
	#_POSIX_THREAD_ROBUST_PRIO_INHERIT
 200809L

	)

97 
	#_POSIX_THREAD_ROBUST_PRIO_PROTECT
 -1

	)

101 
	#_POSIX_SEMAPHORES
 200809L

	)

104 
	#_POSIX_REALTIME_SIGNALS
 200809L

	)

107 
	#_POSIX_ASYNCHRONOUS_IO
 200809L

	)

108 
	#_POSIX_ASYNC_IO
 1

	)

110 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

112 
	#_POSIX_PRIORITIZED_IO
 200809L

	)

115 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

118 
	#_LFS_LARGEFILE
 1

	)

119 
	#_LFS64_LARGEFILE
 1

	)

120 
	#_LFS64_STDIO
 1

	)

123 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200809L

	)

126 
	#_POSIX_CPUTIME
 0

	)

129 
	#_POSIX_THREAD_CPUTIME
 0

	)

132 
	#_POSIX_REGEXP
 1

	)

135 
	#_POSIX_READER_WRITER_LOCKS
 200809L

	)

138 
	#_POSIX_SHELL
 1

	)

141 
	#_POSIX_TIMEOUTS
 200809L

	)

144 
	#_POSIX_SPIN_LOCKS
 200809L

	)

147 
	#_POSIX_SPAWN
 200809L

	)

150 
	#_POSIX_TIMERS
 200809L

	)

153 
	#_POSIX_BARRIERS
 200809L

	)

156 
	#_POSIX_MESSAGE_PASSING
 200809L

	)

159 
	#_POSIX_THREAD_PROCESS_SHARED
 200809L

	)

162 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

165 
	#_POSIX_CLOCK_SELECTION
 200809L

	)

168 
	#_POSIX_ADVISORY_INFO
 200809L

	)

171 
	#_POSIX_IPV6
 200809L

	)

174 
	#_POSIX_RAW_SOCKETS
 200809L

	)

177 
	#_POSIX2_CHAR_TERM
 200809L

	)

180 
	#_POSIX_SPORADIC_SERVER
 -1

	)

181 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

184 
	#_POSIX_TRACE
 -1

	)

185 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

186 
	#_POSIX_TRACE_INHERIT
 -1

	)

187 
	#_POSIX_TRACE_LOG
 -1

	)

190 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

	@/usr/include/bits/pthreadtypes.h

20 #iâdeà
_BITS_PTHREADTYPES_H


21 
	#_BITS_PTHREADTYPES_H
 1

	)

23 
	~<b™s/wÜdsize.h
>

25 #ià
__WORDSIZE
 == 64

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

29 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

30 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

31 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

32 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

34 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

36 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

37 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

38 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

39 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

40 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

43 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

50 
	t±h»ad_t
;

55 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

56 
	m__®ign
;

57 } 
	t±h»ad_©Œ_t
;

60 #ià
__WORDSIZE
 == 64

61 
	s__±h»ad_š‹º®_li¡


63 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

64 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

65 } 
	t__±h»ad_li¡_t
;

67 
	s__±h»ad_š‹º®_¦i¡


69 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

70 } 
	t__±h»ad_¦i¡_t
;

78 
	s__±h»ad_mu‹x_s


80 
	m__lock
;

81 
	m__couÁ
;

82 
	m__owÃr
;

83 #ià
__WORDSIZE
 == 64

84 
	m__nu£rs
;

88 
	m__kšd
;

89 #ià
__WORDSIZE
 == 64

90 
	m__¥šs
;

91 
__±h»ad_li¡_t
 
	m__li¡
;

92 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

94 
	m__nu£rs
;

95 
__ex‹nsiÚ__
 union

97 
	m__¥šs
;

98 
__±h»ad_¦i¡_t
 
	m__li¡
;

101 } 
	m__d©a
;

102 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

103 
	m__®ign
;

104 } 
	t±h»ad_mu‹x_t
;

108 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

109 
	m__®ign
;

110 } 
	t±h»ad_mu‹x©Œ_t
;

119 
	m__lock
;

120 
	m__fu‹x
;

121 
__ex‹nsiÚ__
 
	m__tÙ®_£q
;

122 
__ex‹nsiÚ__
 
	m__wakeup_£q
;

123 
__ex‹nsiÚ__
 
	m__wok’_£q
;

124 *
	m__mu‹x
;

125 
	m__nwa™”s
;

126 
	m__brßdÿ¡_£q
;

127 } 
	m__d©a
;

128 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

129 
__ex‹nsiÚ__
 
	m__®ign
;

130 } 
	t±h»ad_cÚd_t
;

134 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

135 
	m__®ign
;

136 } 
	t±h»ad_cÚd©Œ_t
;

140 
	t±h»ad_key_t
;

144 
	t±h»ad_Úû_t
;

147 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


152 #ià
__WORDSIZE
 == 64

155 
	m__lock
;

156 
	m__Ä_»ad”s
;

157 
	m__»ad”s_wakeup
;

158 
	m__wr™”_wakeup
;

159 
	m__Ä_»ad”s_queued
;

160 
	m__Ä_wr™”s_queued
;

161 
	m__wr™”
;

162 
	m__sh¬ed
;

163 
	m__·d1
;

164 
	m__·d2
;

167 
	m__æags
;

168 } 
	m__d©a
;

172 
	m__lock
;

173 
	m__Ä_»ad”s
;

174 
	m__»ad”s_wakeup
;

175 
	m__wr™”_wakeup
;

176 
	m__Ä_»ad”s_queued
;

177 
	m__Ä_wr™”s_queued
;

180 
	m__æags
;

181 
	m__sh¬ed
;

182 
	m__·d1
;

183 
	m__·d2
;

184 
	m__wr™”
;

185 } 
	m__d©a
;

187 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

188 
	m__®ign
;

189 } 
	t±h»ad_rwlock_t
;

193 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

194 
	m__®ign
;

195 } 
	t±h»ad_rwlock©Œ_t
;

199 #ifdeà
__USE_XOPEN2K


201 vŞ©
	t±h»ad_¥šlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

209 
	m__®ign
;

210 } 
	t±h»ad_b¬r›r_t
;

214 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

215 
	m__®ign
;

216 } 
	t±h»ad_b¬r›¿‰r_t
;

220 #ià
__WORDSIZE
 == 32

222 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/shm.h

20 #iâdeà
_SYS_SHM_H


24 
	~<b™s/ty³s.h
>

27 
	#SHM_R
 0400

	)

28 
	#SHM_W
 0200

	)

31 
	#SHM_RDONLY
 010000

	)

32 
	#SHM_RND
 020000

	)

33 
	#SHM_REMAP
 040000

	)

34 
	#SHM_EXEC
 0100000

	)

37 
	#SHM_LOCK
 11

	)

38 
	#SHM_UNLOCK
 12

	)

40 
	g__BEGIN_DECLS


43 
	#SHMLBA
 (
	`__g‘·gesize
 ())

	)

44 
	$__g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

48 
	tshm©t_t
;

51 
	sshmid_ds


53 
c_³rm
 
shm_³rm
;

54 
size_t
 
shm_£gsz
;

55 
__time_t
 
shm_©ime
;

56 #ià
__WORDSIZE
 == 32

57 
__unu£d1
;

59 
__time_t
 
shm_dtime
;

60 #ià
__WORDSIZE
 == 32

61 
__unu£d2
;

63 
__time_t
 
shm_ùime
;

64 #ià
__WORDSIZE
 == 32

65 
__unu£d3
;

67 
__pid_t
 
shm_ıid
;

68 
__pid_t
 
shm_Íid
;

69 
shm©t_t
 
shm_Ç‰ch
;

70 
__unu£d4
;

71 
__unu£d5
;

74 #ifdeà
__USE_MISC


77 
	#SHM_STAT
 13

	)

78 
	#SHM_INFO
 14

	)

81 
	#SHM_DEST
 01000

	)

82 
	#SHM_LOCKED
 02000

	)

83 
	#SHM_HUGETLB
 04000

	)

84 
	#SHM_NORESERVE
 010000

	)

86 
	sshmšfo


88 
shmmax
;

89 
shmmš
;

90 
shmmni
;

91 
shm£g
;

92 
shm®l
;

93 
__unu£d1
;

94 
__unu£d2
;

95 
__unu£d3
;

96 
__unu£d4
;

99 
	sshm_šfo


101 
u£d_ids
;

102 
shm_tÙ
;

103 
shm_rss
;

104 
shm_swp
;

105 
sw­_©‹m±s
;

106 
sw­_sucûs£s
;

111 
__END_DECLS


	@/usr/include/bits/sigaction.h

20 #iâdeà
_SIGNAL_H


25 
	ssigaùiÚ


28 #ifdeà
__USE_POSIX199309


32 
__sighªdËr_t
 
	m§_hªdËr
;

34 (*
	m§_sigaùiÚ
è(, 
	msigšfo_t
 *, *);

36 
	m__sigaùiÚ_hªdËr
;

37 
	#§_hªdËr
 
__sigaùiÚ_hªdËr
.
§_hªdËr


	)

38 
	#§_sigaùiÚ
 
__sigaùiÚ_hªdËr
.
§_sigaùiÚ


	)

40 
__sighªdËr_t
 
	m§_hªdËr
;

44 
__sig£t_t
 
	m§_mask
;

47 
	m§_æags
;

50 (*
	m§_»¡Ü”
) ();

54 
	#SA_NOCLDSTOP
 1

	)

55 
	#SA_NOCLDWAIT
 2

	)

56 
	#SA_SIGINFO
 4

	)

58 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_MISC


59 
	#SA_ONSTACK
 0x08000000

	)

60 
	#SA_RESTART
 0x10000000

	)

61 
	#SA_NODEFER
 0x40000000

	)

63 
	#SA_RESETHAND
 0x80000000

	)

65 #ifdeà
__USE_MISC


66 
	#SA_INTERRUPT
 0x20000000

	)

69 
	#SA_NOMASK
 
SA_NODEFER


	)

70 
	#SA_ONESHOT
 
SA_RESETHAND


	)

71 
	#SA_STACK
 
SA_ONSTACK


	)

75 
	#SIG_BLOCK
 0

	)

76 
	#SIG_UNBLOCK
 1

	)

77 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

19 #iâdeà
_BITS_SIGCONTEXT_H


20 
	#_BITS_SIGCONTEXT_H
 1

	)

22 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_SYS_UCONTEXT_H


26 
	~<b™s/wÜdsize.h
>

28 
	s_å»g


30 
	msignifiÿnd
[4];

31 
	mexpÚ’t
;

34 
	s_åx»g


36 
	msignifiÿnd
[4];

37 
	mexpÚ’t
;

38 
	m·ddšg
[3];

41 
	s_xmm»g


43 
__ušt32_t
 
	m–em’t
[4];

48 #ià
__WORDSIZE
 == 32

50 
	s_å¡©e


53 
__ušt32_t
 
	mcw
;

54 
__ušt32_t
 
	msw
;

55 
__ušt32_t
 
	mg
;

56 
__ušt32_t
 
	moff
;

57 
__ušt32_t
 
	mcs£l
;

58 
__ušt32_t
 
	md©aoff
;

59 
__ušt32_t
 
	md©a£l
;

60 
_å»g
 
	m_¡
[8];

61 
	m¡©us
;

62 
	mmagic
;

65 
__ušt32_t
 
	m_fx¤_’v
[6];

66 
__ušt32_t
 
	mmxc¤
;

67 
__ušt32_t
 
	m»£rved
;

68 
_åx»g
 
	m_fx¤_¡
[8];

69 
_xmm»g
 
	m_xmm
[8];

70 
__ušt32_t
 
	m·ddšg
[56];

73 #iâdeà
sigcÚ‹xt_¡ruù


78 
	#sigcÚ‹xt_¡ruù
 
sigcÚ‹xt


	)

81 
	ssigcÚ‹xt


83 
	mgs
, 
	m__gsh
;

84 
	mfs
, 
	m__fsh
;

85 
	mes
, 
	m__esh
;

86 
	mds
, 
	m__dsh
;

87 
	medi
;

88 
	mesi
;

89 
	mebp
;

90 
	me¥
;

91 
	mebx
;

92 
	medx
;

93 
	mecx
;

94 
	m—x
;

95 
	mŒ­no
;

96 
	m”r
;

97 
	me
;

98 
	mcs
, 
	m__csh
;

99 
	meæags
;

100 
	me¥_©_sigÇl
;

101 
	mss
, 
	m__ssh
;

102 
_å¡©e
 * 
	må¡©e
;

103 
	mŞdmask
;

104 
	mü2
;

109 
	s_å¡©e


112 
__ušt16_t
 
	mcwd
;

113 
__ušt16_t
 
	mswd
;

114 
__ušt16_t
 
	máw
;

115 
__ušt16_t
 
	mfİ
;

116 
__ušt64_t
 
	mr
;

117 
__ušt64_t
 
	mrdp
;

118 
__ušt32_t
 
	mmxc¤
;

119 
__ušt32_t
 
	mmxü_mask
;

120 
_åx»g
 
	m_¡
[8];

121 
_xmm»g
 
	m_xmm
[16];

122 
__ušt32_t
 
	m·ddšg
[24];

125 
	ssigcÚ‹xt


127 
	mr8
;

128 
	mr9
;

129 
	mr10
;

130 
	mr11
;

131 
	mr12
;

132 
	mr13
;

133 
	mr14
;

134 
	mr15
;

135 
	mrdi
;

136 
	mrsi
;

137 
	mrbp
;

138 
	mrbx
;

139 
	mrdx
;

140 
	m¿x
;

141 
	mrcx
;

142 
	mr¥
;

143 
	mr
;

144 
	meæags
;

145 
	mcs
;

146 
	mgs
;

147 
	mfs
;

148 
	m__·d0
;

149 
	m”r
;

150 
	mŒ­no
;

151 
	mŞdmask
;

152 
	mü2
;

153 
_å¡©e
 * 
	må¡©e
;

154 
	m__»£rved1
 [8];

	@/usr/include/bits/siginfo.h

20 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
__Ãed_sigšfo_t
 \

21 && !
defšed
 
	g__Ãed_sigev’t_t


25 
	~<b™s/wÜdsize.h
>

27 #ià(!
defšed
 
__have_sigv®_t
 \

28 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
 \

29 || 
defšed
 
	g__Ãed_sigev’t_t
))

30 
	#__have_sigv®_t
 1

	)

33 
	usigv®


35 
	msiv®_št
;

36 *
	msiv®_±r
;

37 } 
	tsigv®_t
;

40 #ià(!
defšed
 
__have_sigšfo_t
 \

41 && (
defšed
 
	g_SIGNAL_H
 || defšed 
	g__Ãed_sigšfo_t
))

42 
	#__have_sigšfo_t
 1

	)

44 
	#__SI_MAX_SIZE
 128

	)

45 #ià
__WORDSIZE
 == 64

46 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 4)

	)

48 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()è- 3)

	)

51 
	ssigšfo


53 
	msi_signo
;

54 
	msi_”ºo
;

56 
	msi_code
;

60 
	m_·d
[
__SI_PAD_SIZE
];

65 
__pid_t
 
	msi_pid
;

66 
__uid_t
 
	msi_uid
;

67 } 
	m_kl
;

72 
	msi_tid
;

73 
	msi_ov”run
;

74 
sigv®_t
 
	msi_sigv®
;

75 } 
	m_tim”
;

80 
__pid_t
 
	msi_pid
;

81 
__uid_t
 
	msi_uid
;

82 
sigv®_t
 
	msi_sigv®
;

83 } 
	m_¹
;

88 
__pid_t
 
	msi_pid
;

89 
__uid_t
 
	msi_uid
;

90 
	msi_¡©us
;

91 
__şock_t
 
	msi_utime
;

92 
__şock_t
 
	msi_¡ime
;

93 } 
	m_sigchld
;

98 *
	msi_addr
;

99 } 
	m_sigçuÉ
;

104 
	msi_bªd
;

105 
	msi_fd
;

106 } 
	m_sigpŞl
;

107 } 
	m_sif›lds
;

108 } 
	tsigšfo_t
;

112 
	#si_pid
 
_sif›lds
.
_kl
.
si_pid


	)

113 
	#si_uid
 
_sif›lds
.
_kl
.
si_uid


	)

114 
	#si_tim”id
 
_sif›lds
.
_tim”
.
si_tid


	)

115 
	#si_ov”run
 
_sif›lds
.
_tim”
.
si_ov”run


	)

116 
	#si_¡©us
 
_sif›lds
.
_sigchld
.
si_¡©us


	)

117 
	#si_utime
 
_sif›lds
.
_sigchld
.
si_utime


	)

118 
	#si_¡ime
 
_sif›lds
.
_sigchld
.
si_¡ime


	)

119 
	#si_v®ue
 
_sif›lds
.
_¹
.
si_sigv®


	)

120 
	#si_št
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_št


	)

121 
	#si_±r
 
_sif›lds
.
_¹
.
si_sigv®
.
siv®_±r


	)

122 
	#si_addr
 
_sif›lds
.
_sigçuÉ
.
si_addr


	)

123 
	#si_bªd
 
_sif›lds
.
_sigpŞl
.
si_bªd


	)

124 
	#si_fd
 
_sif›lds
.
_sigpŞl
.
si_fd


	)

131 
	mSI_ASYNCNL
 = -60,

132 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

133 
	mSI_TKILL
 = -6,

134 
	#SI_TKILL
 
SI_TKILL


	)

135 
	mSI_SIGIO
,

136 
	#SI_SIGIO
 
SI_SIGIO


	)

137 
	mSI_ASYNCIO
,

138 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

139 
	mSI_MESGQ
,

140 
	#SI_MESGQ
 
SI_MESGQ


	)

141 
	mSI_TIMER
,

142 
	#SI_TIMER
 
SI_TIMER


	)

143 
	mSI_QUEUE
,

144 
	#SI_QUEUE
 
SI_QUEUE


	)

145 
	mSI_USER
,

146 
	#SI_USER
 
SI_USER


	)

147 
	mSI_KERNEL
 = 0x80

148 
	#SI_KERNEL
 
SI_KERNEL


	)

155 
	mILL_ILLOPC
 = 1,

156 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

157 
	mILL_ILLOPN
,

158 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

159 
	mILL_ILLADR
,

160 
	#ILL_ILLADR
 
ILL_ILLADR


	)

161 
	mILL_ILLTRP
,

162 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

163 
	mILL_PRVOPC
,

164 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

165 
	mILL_PRVREG
,

166 
	#ILL_PRVREG
 
ILL_PRVREG


	)

167 
	mILL_COPROC
,

168 
	#ILL_COPROC
 
ILL_COPROC


	)

169 
	mILL_BADSTK


170 
	#ILL_BADSTK
 
ILL_BADSTK


	)

176 
	mFPE_INTDIV
 = 1,

177 
	#FPE_INTDIV
 
FPE_INTDIV


	)

178 
	mFPE_INTOVF
,

179 
	#FPE_INTOVF
 
FPE_INTOVF


	)

180 
	mFPE_FLTDIV
,

181 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

182 
	mFPE_FLTOVF
,

183 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

184 
	mFPE_FLTUND
,

185 
	#FPE_FLTUND
 
FPE_FLTUND


	)

186 
	mFPE_FLTRES
,

187 
	#FPE_FLTRES
 
FPE_FLTRES


	)

188 
	mFPE_FLTINV
,

189 
	#FPE_FLTINV
 
FPE_FLTINV


	)

190 
	mFPE_FLTSUB


191 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

197 
	mSEGV_MAPERR
 = 1,

198 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

199 
	mSEGV_ACCERR


200 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

206 
	mBUS_ADRALN
 = 1,

207 
	#BUS_ADRALN
 
BUS_ADRALN


	)

208 
	mBUS_ADRERR
,

209 
	#BUS_ADRERR
 
BUS_ADRERR


	)

210 
	mBUS_OBJERR


211 
	#BUS_OBJERR
 
BUS_OBJERR


	)

217 
	mTRAP_BRKPT
 = 1,

218 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

219 
	mTRAP_TRACE


220 
	#TRAP_TRACE
 
TRAP_TRACE


	)

226 
	mCLD_EXITED
 = 1,

227 
	#CLD_EXITED
 
CLD_EXITED


	)

228 
	mCLD_KILLED
,

229 
	#CLD_KILLED
 
CLD_KILLED


	)

230 
	mCLD_DUMPED
,

231 
	#CLD_DUMPED
 
CLD_DUMPED


	)

232 
	mCLD_TRAPPED
,

233 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

234 
	mCLD_STOPPED
,

235 
	#CLD_STOPPED
 
CLD_STOPPED


	)

236 
	mCLD_CONTINUED


237 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

243 
	mPOLL_IN
 = 1,

244 
	#POLL_IN
 
POLL_IN


	)

245 
	mPOLL_OUT
,

246 
	#POLL_OUT
 
POLL_OUT


	)

247 
	mPOLL_MSG
,

248 
	#POLL_MSG
 
POLL_MSG


	)

249 
	mPOLL_ERR
,

250 
	#POLL_ERR
 
POLL_ERR


	)

251 
	mPOLL_PRI
,

252 
	#POLL_PRI
 
POLL_PRI


	)

253 
	mPOLL_HUP


254 
	#POLL_HUP
 
POLL_HUP


	)

257 #undeà
__Ãed_sigšfo_t


261 #ià(
defšed
 
_SIGNAL_H
 || defšed 
__Ãed_sigev’t_t
) \

262 && !
defšed
 
	g__have_sigev’t_t


263 
	#__have_sigev’t_t
 1

	)

266 
	#__SIGEV_MAX_SIZE
 64

	)

267 #ià
__WORDSIZE
 == 64

268 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 4)

	)

270 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()è- 3)

	)

273 
	ssigev’t


275 
sigv®_t
 
	msigev_v®ue
;

276 
	msigev_signo
;

277 
	msigev_nÙify
;

281 
	m_·d
[
__SIGEV_PAD_SIZE
];

285 
__pid_t
 
	m_tid
;

289 (*
	m_funùiÚ
è(
	msigv®_t
);

290 *
	m_©Œibu‹
;

291 } 
	m_sigev_th»ad
;

292 } 
	m_sigev_un
;

293 } 
	tsigev’t_t
;

296 
	#sigev_nÙify_funùiÚ
 
_sigev_un
.
_sigev_th»ad
.
_funùiÚ


	)

297 
	#sigev_nÙify_©Œibu‹s
 
_sigev_un
.
_sigev_th»ad
.
_©Œibu‹


	)

302 
	mSIGEV_SIGNAL
 = 0,

303 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

304 
	mSIGEV_NONE
,

305 
	#SIGEV_NONE
 
SIGEV_NONE


	)

306 
	mSIGEV_THREAD
,

307 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

309 
	mSIGEV_THREAD_ID
 = 4

310 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/signum.h

20 #ifdef 
_SIGNAL_H


23 
	#SIG_ERR
 ((
__sighªdËr_t
è-1è

	)

24 
	#SIG_DFL
 ((
__sighªdËr_t
è0è

	)

25 
	#SIG_IGN
 ((
__sighªdËr_t
è1è

	)

27 #ifdeà
__USE_UNIX98


28 
	#SIG_HOLD
 ((
__sighªdËr_t
è2è

	)

33 
	#SIGHUP
 1

	)

34 
	#SIGINT
 2

	)

35 
	#SIGQUIT
 3

	)

36 
	#SIGILL
 4

	)

37 
	#SIGTRAP
 5

	)

38 
	#SIGABRT
 6

	)

39 
	#SIGIOT
 6

	)

40 
	#SIGBUS
 7

	)

41 
	#SIGFPE
 8

	)

42 
	#SIGKILL
 9

	)

43 
	#SIGUSR1
 10

	)

44 
	#SIGSEGV
 11

	)

45 
	#SIGUSR2
 12

	)

46 
	#SIGPIPE
 13

	)

47 
	#SIGALRM
 14

	)

48 
	#SIGTERM
 15

	)

49 
	#SIGSTKFLT
 16

	)

50 
	#SIGCLD
 
SIGCHLD


	)

51 
	#SIGCHLD
 17

	)

52 
	#SIGCONT
 18

	)

53 
	#SIGSTOP
 19

	)

54 
	#SIGTSTP
 20

	)

55 
	#SIGTTIN
 21

	)

56 
	#SIGTTOU
 22

	)

57 
	#SIGURG
 23

	)

58 
	#SIGXCPU
 24

	)

59 
	#SIGXFSZ
 25

	)

60 
	#SIGVTALRM
 26

	)

61 
	#SIGPROF
 27

	)

62 
	#SIGWINCH
 28

	)

63 
	#SIGPOLL
 
SIGIO


	)

64 
	#SIGIO
 29

	)

65 
	#SIGPWR
 30

	)

66 
	#SIGSYS
 31

	)

67 
	#SIGUNUSED
 31

	)

69 
	#_NSIG
 65

	)

72 
	#SIGRTMIN
 (
	`__libc_cu¼’t_sig¹mš
 ())

	)

73 
	#SIGRTMAX
 (
	`__libc_cu¼’t_sig¹max
 ())

	)

77 
	#__SIGRTMIN
 32

	)

78 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigset.h

21 #iâdef 
_SIGSET_H_ty³s


22 
	#_SIGSET_H_ty³s
 1

	)

24 
	t__sig_©omic_t
;

28 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

31 
	m__v®
[
_SIGSET_NWORDS
];

32 } 
	t__sig£t_t
;

43 #ià!
defšed
 
_SIGSET_H_âs
 && defšed 
_SIGNAL_H


44 
	#_SIGSET_H_âs
 1

	)

46 #iâdeà
_EXTERN_INLINE


47 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

51 
	#__sigmask
(
sig
) \

52 (((è1è<< (((
sig
è- 1è% (8 *  ())))

	)

55 
	#__sigwÜd
(
sig
è(((sigè- 1è/ (8 *  ()))

	)

57 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

58 
	#__sigem±y£t
(
£t
) \

59 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

60 
sig£t_t
 *
__£t
 = (
£t
); \

61 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = 0; \

62 0; }))

	)

63 
	#__sigfl£t
(
£t
) \

64 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

65 
sig£t_t
 *
__£t
 = (
£t
); \

66 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = ~0UL; \

67 0; }))

	)

69 #ifdeà
__USE_GNU


73 
	#__sigi£m±y£t
(
£t
) \

74 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

75 cÚ¡ 
sig£t_t
 *
__£t
 = (
£t
); \

76 
__»t
 = 
__£t
->
__v®
[--
__út
]; \

77 !
__»t
 && --
__út
 >= 0) \

78 
__»t
 = 
__£t
->
__v®
[
__út
]; \

79 
__»t
 =ğ0; }))

	)

80 
	#__sigªd£t
(
de¡
, 
Ëá
, 
right
) \

81 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

82 
sig£t_t
 *
__de¡
 = (
de¡
); \

83 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

84 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

85 --
__út
 >= 0) \

86 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

87 & 
__right
->
__v®
[
__út
]); \

88 0; }))

	)

89 
	#__sigÜ£t
(
de¡
, 
Ëá
, 
right
) \

90 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

91 
sig£t_t
 *
__de¡
 = (
de¡
); \

92 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

93 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

94 --
__út
 >= 0) \

95 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

96 | 
__right
->
__v®
[
__út
]); \

97 0; }))

	)

104 
__sigismemb”
 (
__cÚ¡
 
__sig£t_t
 *, );

105 
__sigadd£t
 (
__sig£t_t
 *, );

106 
__sigd–£t
 (
__sig£t_t
 *, );

108 #ifdeà
__USE_EXTERN_INLINES


109 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

110 
_EXTERN_INLINE
 \

111 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

113 
__mask
 = 
	`__sigmask
 (
__sig
); \

114 
__wÜd
 = 
	`__sigwÜd
 (
__sig
); \

115  
BODY
; \

116 }

	)

118 
__SIGSETFN
 (
__sigismemb”
, (
__£t
->
__v®
[
__wÜd
] & 
__mask
è? 1 : 0, 
__cÚ¡
)

119 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__v®
[
__wÜd
] |ğ
__mask
), 0), )

120 
__SIGSETFN
 (
__sigd–£t
, ((
__£t
->
__v®
[
__wÜd
] &ğ~
__mask
), 0), )

122 #undeà
__SIGSETFN


	@/usr/include/bits/sigstack.h

20 #iâdeà
_SIGNAL_H


26 
	ssig¡ack


28 *
	mss_¥
;

29 
	mss_Ú¡ack
;

36 
	mSS_ONSTACK
 = 1,

37 
	#SS_ONSTACK
 
SS_ONSTACK


	)

38 
	mSS_DISABLE


39 
	#SS_DISABLE
 
SS_DISABLE


	)

43 
	#MINSIGSTKSZ
 2048

	)

46 
	#SIGSTKSZ
 8192

	)

50 
	ssig®t¡ack


52 *
	mss_¥
;

53 
	mss_æags
;

54 
size_t
 
	mss_size
;

55 } 
	t¡ack_t
;

	@/usr/include/bits/sigthread.h

20 #iâdeà
_BITS_SIGTHREAD_H


21 
	#_BITS_SIGTHREAD_H
 1

	)

23 #ià!
defšed
 
_SIGNAL_H
 && !defšed 
_PTHREAD_H


31 
	$±h»ad_sigmask
 (
__how
,

32 
__cÚ¡
 
__sig£t_t
 *
__»¡riù
 
__Ãwmask
,

33 
__sig£t_t
 *
__»¡riù
 
__Şdmask
)
__THROW
;

36 
	$±h»ad_kl
 (
±h»ad_t
 
__th»adid
, 
__signo
è
__THROW
;

38 #ifdeà
__USE_GNU


40 
	$±h»ad_sigqueue
 (
±h»ad_t
 
__th»adid
, 
__signo
,

41 cÚ¡ 
sigv®
 
__v®ue
è
__THROW
;

	@/usr/include/bits/stat.h

19 #iâdeà
_SYS_STAT_H


24 
	#_STAT_VER_KERNEL
 0

	)

26 #ià
__WORDSIZE
 == 32

27 
	#_STAT_VER_SVR4
 2

	)

28 
	#_STAT_VER_LINUX
 3

	)

31 
	#_MKNOD_VER_LINUX
 1

	)

32 
	#_MKNOD_VER_SVR4
 2

	)

33 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

35 
	#_STAT_VER_LINUX
 1

	)

38 
	#_MKNOD_VER_LINUX
 0

	)

41 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

43 
	s¡©


45 
__dev_t
 
	m¡_dev
;

46 #ià
__WORDSIZE
 == 32

47 
	m__·d1
;

49 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


50 
__šo_t
 
	m¡_šo
;

52 
__šo_t
 
	m__¡_šo
;

54 #ià
__WORDSIZE
 == 32

55 
__mode_t
 
	m¡_mode
;

56 
__Æšk_t
 
	m¡_Æšk
;

58 
__Æšk_t
 
	m¡_Æšk
;

59 
__mode_t
 
	m¡_mode
;

61 
__uid_t
 
	m¡_uid
;

62 
__gid_t
 
	m¡_gid
;

63 #ià
__WORDSIZE
 == 64

64 
	m__·d0
;

66 
__dev_t
 
	m¡_rdev
;

67 #ià
__WORDSIZE
 == 32

68 
	m__·d2
;

70 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


71 
__off_t
 
	m¡_size
;

73 
__off64_t
 
	m¡_size
;

75 
__blksize_t
 
	m¡_blksize
;

76 #ià
__WORDSIZE
 =ğ64 || !
defšed
 
__USE_FILE_OFFSET64


77 
__blkút_t
 
	m¡_blocks
;

79 
__blkút64_t
 
	m¡_blocks
;

81 #ifdeà
__USE_MISC


88 
time¥ec
 
	m¡_©im
;

89 
time¥ec
 
	m¡_mtim
;

90 
time¥ec
 
	m¡_ùim
;

91 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

92 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

93 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

95 
__time_t
 
	m¡_©ime
;

96 
	m¡_©im’£c
;

97 
__time_t
 
	m¡_mtime
;

98 
	m¡_mtim’£c
;

99 
__time_t
 
	m¡_ùime
;

100 
	m¡_ùim’£c
;

102 #ià
__WORDSIZE
 == 64

103 
	m__unu£d
[3];

105 #iâdeà
__USE_FILE_OFFSET64


106 
	m__unu£d4
;

107 
	m__unu£d5
;

109 
__šo64_t
 
	m¡_šo
;

114 #ifdeà
__USE_LARGEFILE64


116 
	s¡©64


118 
__dev_t
 
	m¡_dev
;

119 #ià
__WORDSIZE
 == 64

120 
__šo64_t
 
	m¡_šo
;

121 
__Æšk_t
 
	m¡_Æšk
;

122 
__mode_t
 
	m¡_mode
;

124 
	m__·d1
;

125 
__šo_t
 
	m__¡_šo
;

126 
__mode_t
 
	m¡_mode
;

127 
__Æšk_t
 
	m¡_Æšk
;

129 
__uid_t
 
	m¡_uid
;

130 
__gid_t
 
	m¡_gid
;

131 #ià
__WORDSIZE
 == 64

132 
	m__·d0
;

133 
__dev_t
 
	m¡_rdev
;

134 
__off_t
 
	m¡_size
;

136 
__dev_t
 
	m¡_rdev
;

137 
	m__·d2
;

138 
__off64_t
 
	m¡_size
;

140 
__blksize_t
 
	m¡_blksize
;

141 
__blkút64_t
 
	m¡_blocks
;

142 #ifdeà
__USE_MISC


149 
time¥ec
 
	m¡_©im
;

150 
time¥ec
 
	m¡_mtim
;

151 
time¥ec
 
	m¡_ùim
;

152 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

153 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

154 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

156 
__time_t
 
	m¡_©ime
;

157 
	m¡_©im’£c
;

158 
__time_t
 
	m¡_mtime
;

159 
	m¡_mtim’£c
;

160 
__time_t
 
	m¡_ùime
;

161 
	m¡_ùim’£c
;

163 #ià
__WORDSIZE
 == 64

164 
	m__unu£d
[3];

166 
__šo64_t
 
	m¡_šo
;

172 
	#_STATBUF_ST_BLKSIZE


	)

173 
	#_STATBUF_ST_RDEV


	)

175 
	#_STATBUF_ST_NSEC


	)

179 
	#__S_IFMT
 0170000

	)

182 
	#__S_IFDIR
 0040000

	)

183 
	#__S_IFCHR
 0020000

	)

184 
	#__S_IFBLK
 0060000

	)

185 
	#__S_IFREG
 0100000

	)

186 
	#__S_IFIFO
 0010000

	)

187 
	#__S_IFLNK
 0120000

	)

188 
	#__S_IFSOCK
 0140000

	)

192 
	#__S_TYPEISMQ
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

193 
	#__S_TYPEISSEM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

194 
	#__S_TYPEISSHM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

198 
	#__S_ISUID
 04000

	)

199 
	#__S_ISGID
 02000

	)

200 
	#__S_ISVTX
 01000

	)

201 
	#__S_IREAD
 0400

	)

202 
	#__S_IWRITE
 0200

	)

203 
	#__S_IEXEC
 0100

	)

205 #ifdeà
__USE_ATFILE


206 
	#UTIME_NOW
 ((1È<< 30è- 1l)

	)

207 
	#UTIME_OMIT
 ((1È<< 30è- 2l)

	)

	@/usr/include/bits/stdio-ldbl.h

20 #iâdeà
_STDIO_H


24 
__BEGIN_NAMESPACE_STD


25 
	$__LDBL_REDIR_DECL
 (
årštf
)

26 
	$__LDBL_REDIR_DECL
 (
´štf
)

27 
	$__LDBL_REDIR_DECL
 (
¥rštf
)

28 
	$__LDBL_REDIR_DECL
 (
vårštf
)

29 
	$__LDBL_REDIR_DECL
 (
v´štf
)

30 
	$__LDBL_REDIR_DECL
 (
v¥rštf
)

31 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

32 && !
defšed
 
__REDIRECT
 \

33 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

34 
	$__LDBL_REDIR1_DECL
 (
fsÿnf
, 
__Ædbl___isoc99_fsÿnf
)

35 
	$__LDBL_REDIR1_DECL
 (
sÿnf
, 
__Ædbl___isoc99_sÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
ssÿnf
, 
__Ædbl___isoc99_ssÿnf
)

38 
	$__LDBL_REDIR_DECL
 (
fsÿnf
)

39 
	$__LDBL_REDIR_DECL
 (
sÿnf
)

40 
	$__LDBL_REDIR_DECL
 (
ssÿnf
)

42 
__END_NAMESPACE_STD


44 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


45 
__BEGIN_NAMESPACE_C99


46 
	$__LDBL_REDIR_DECL
 (
¢´štf
)

47 
	$__LDBL_REDIR_DECL
 (
v¢´štf
)

48 
__END_NAMESPACE_C99


51 #ifdef 
__USE_ISOC99


52 
__BEGIN_NAMESPACE_C99


53 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

54 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

55 
	$__LDBL_REDIR1_DECL
 (
vfsÿnf
, 
__Ædbl___isoc99_vfsÿnf
)

56 
	$__LDBL_REDIR1_DECL
 (
vsÿnf
, 
__Ædbl___isoc99_vsÿnf
)

57 
	$__LDBL_REDIR1_DECL
 (
vssÿnf
, 
__Ædbl___isoc99_vssÿnf
)

59 
	$__LDBL_REDIR_DECL
 (
vfsÿnf
)

60 
	$__LDBL_REDIR_DECL
 (
vssÿnf
)

61 
	$__LDBL_REDIR_DECL
 (
vsÿnf
)

63 
__END_NAMESPACE_C99


66 #ifdeà
__USE_GNU


67 
	$__LDBL_REDIR_DECL
 (
vd´štf
)

68 
	$__LDBL_REDIR_DECL
 (
d´štf
)

69 
	$__LDBL_REDIR_DECL
 (
va¥rštf
)

70 
	$__LDBL_REDIR_DECL
 (
__a¥rštf
)

71 
	$__LDBL_REDIR_DECL
 (
a¥rštf
)

72 
	$__LDBL_REDIR_DECL
 (
ob¡ack_´štf
)

73 
	$__LDBL_REDIR_DECL
 (
ob¡ack_v´štf
)

76 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


77 
	$__LDBL_REDIR_DECL
 (
__¥rštf_chk
)

78 
	$__LDBL_REDIR_DECL
 (
__v¥rštf_chk
)

79 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


80 
	$__LDBL_REDIR_DECL
 (
__¢´štf_chk
)

81 
	$__LDBL_REDIR_DECL
 (
__v¢´štf_chk
)

83 #ià
__USE_FORTIFY_LEVEL
 > 1

84 
	$__LDBL_REDIR_DECL
 (
__årštf_chk
)

85 
	$__LDBL_REDIR_DECL
 (
__´štf_chk
)

86 
	$__LDBL_REDIR_DECL
 (
__vårštf_chk
)

87 
	$__LDBL_REDIR_DECL
 (
__v´štf_chk
)

88 #ifdeà
__USE_GNU


89 
	$__LDBL_REDIR_DECL
 (
__a¥rštf_chk
)

90 
	$__LDBL_REDIR_DECL
 (
__va¥rštf_chk
)

91 
	$__LDBL_REDIR_DECL
 (
__d´štf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__vd´štf_chk
)

93 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_´štf_chk
)

94 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_v´štf_chk
)

	@/usr/include/bits/stdio.h

20 #iâdeà
_STDIO_H


24 #iâdeà
__ex‹º_šlše


25 
	#__STDIO_INLINE
 
šlše


	)

27 
	#__STDIO_INLINE
 
__ex‹º_šlše


	)

31 #ifdeà
__USE_EXTERN_INLINES


34 #ià!(
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše
)

36 
__STDIO_INLINE
 

37 
	$v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

39  
	`vårštf
 (
¡dout
, 
__fmt
, 
__¬g
);

40 
	}
}

44 
__STDIO_INLINE
 

45 
	$g‘ch¬
 ()

47  
	`_IO_g‘c
 (
¡dš
);

48 
	}
}

51 #ifdeà
__USE_MISC


53 
__STDIO_INLINE
 

54 
	$fg‘c_uÆocked
 (
FILE
 *
__å
)

56  
	`_IO_g‘c_uÆocked
 (
__å
);

57 
	}
}

61 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


63 
__STDIO_INLINE
 

64 
	$g‘c_uÆocked
 (
FILE
 *
__å
)

66  
	`_IO_g‘c_uÆocked
 (
__å
);

67 
	}
}

70 
__STDIO_INLINE
 

71 
	$g‘ch¬_uÆocked
 ()

73  
	`_IO_g‘c_uÆocked
 (
¡dš
);

74 
	}
}

79 
__STDIO_INLINE
 

80 
	$putch¬
 (
__c
)

82  
	`_IO_putc
 (
__c
, 
¡dout
);

83 
	}
}

86 #ifdeà
__USE_MISC


88 
__STDIO_INLINE
 

89 
	$åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

91  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

92 
	}
}

96 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


98 
__STDIO_INLINE
 

99 
	$putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

101  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

102 
	}
}

105 
__STDIO_INLINE
 

106 
	$putch¬_uÆocked
 (
__c
)

108  
	`_IO_putc_uÆocked
 (
__c
, 
¡dout
);

109 
	}
}

113 #ifdef 
__USE_GNU


115 
__STDIO_INLINE
 
_IO_ssize_t


116 
	$g‘lše
 (**
__lš•Œ
, 
size_t
 *
__n
, 
FILE
 *
__¡»am
)

118  
	`__g‘d–im
 (
__lš•Œ
, 
__n
, '\n', 
__¡»am
);

119 
	}
}

123 #ifdeà
__USE_MISC


125 
__STDIO_INLINE
 

126 
__NTH
 (
	$ãof_uÆocked
 (
FILE
 *
__¡»am
))

128  
	`_IO_ãof_uÆocked
 (
__¡»am
);

129 
	}
}

132 
__STDIO_INLINE
 

133 
__NTH
 (
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
))

135  
	`_IO_ã¼Ü_uÆocked
 (
__¡»am
);

136 
	}
}

142 #ià
defšed
 
__USE_MISC
 && defšed 
__GNUC__
 && defšed 
__OPTIMIZE__
 \

143 && !
defšed
 
	g__ılu¥lus


145 
	#ä—d_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

146 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

147 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

148 && (
size_t
è(
size
) != 0) \

149 ? ({ *
__±r
 = (*è(
±r
); \

150 
FILE
 *
__¡»am
 = (
¡»am
); \

151 
size_t
 
__út
; \

152 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

153 
__út
 > 0; --__cnt) \

155 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
); \

156 ià(
__c
 =ğ
EOF
) \

158 *
__±r
++ = 
__c
; \

160 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

161 / (
size_t
è(
size
); }) \

162 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

163 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

165 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

166 (è(
n
), (
size_t
) 0) \

167 : 
	`ä—d_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

169 
	#fwr™e_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

170 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

171 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

172 && (
size_t
è(
size
) != 0) \

173 ? ({ cÚ¡ *
__±r
 = (cÚ¡ *è(
±r
); \

174 
FILE
 *
__¡»am
 = (
¡»am
); \

175 
size_t
 
__út
; \

176 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

177 
__út
 > 0; --__cnt) \

178 ià(
	`_IO_putc_uÆocked
 (*
__±r
++, 
__¡»am
è=ğ
EOF
) \

180 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

181 / (
size_t
è(
size
); }) \

182 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

183 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

185 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

186 (è(
n
), (
size_t
) 0) \

187 : 
	`fwr™e_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

191 #undeà
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

20 #iâdeà
_STDIO_H


24 
	$__¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

25 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

26 
	$__v¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

27 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

28 
_G_va_li¡
 
__­
è
__THROW
;

30 #ifdeà
__va_¬g_·ck


31 
__ex‹º_®ways_šlše
 

32 
	`__NTH
 (
	$¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...))

34  
	`__butš___¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

35 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

36 
	}
}

37 #–ià!
defšed
 
__ılu¥lus


38 
	#¥rštf
(
¡r
, ...) \

39 
	`__butš___¥rštf_chk
 (
¡r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

40 
__VA_ARGS__
)

	)

43 
__ex‹º_®ways_šlše
 

44 
__NTH
 (
	$v¥rštf
 (*
__»¡riù
 
__s
, 
__cÚ¡
 *__»¡riù 
__fmt
,

45 
_G_va_li¡
 
__­
))

47  
	`__butš___v¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

48 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

49 
	}
}

51 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


53 
	$__¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

54 
size_t
 
__¦’
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

55 ...è
__THROW
;

56 
	$__v¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

57 
size_t
 
__¦’
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

58 
_G_va_li¡
 
__­
è
__THROW
;

60 #ifdeà
__va_¬g_·ck


61 
__ex‹º_®ways_šlše
 

62 
	`__NTH
 (
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

63 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...))

65  
	`__butš___¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

66 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

67 
	}
}

68 #–ià!
defšed
 
__ılu¥lus


69 
	#¢´štf
(
¡r
, 
Ën
, ...) \

70 
	`__butš___¢´štf_chk
 (
¡r
, 
Ën
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

71 
__VA_ARGS__
)

	)

74 
__ex‹º_®ways_šlše
 

75 
__NTH
 (
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

76 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

78  
	`__butš___v¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

79 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

80 
	}
}

84 #ià
__USE_FORTIFY_LEVEL
 > 1

86 
__årštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

87 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

88 
__´štf_chk
 (
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, ...);

89 
__vårštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

90 
__cÚ¡
 *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__­
);

91 
__v´štf_chk
 (
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

92 
_G_va_li¡
 
__­
);

94 #ifdeà
__va_¬g_·ck


95 
__ex‹º_®ways_šlše
 

96 
	$årštf
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...)

98  
	`__årštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

99 
	`__va_¬g_·ck
 ());

100 
	}
}

102 
__ex‹º_®ways_šlše
 

103 
	$´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

105  
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

106 
	}
}

107 #–ià!
defšed
 
__ılu¥lus


108 
	#´štf
(...) \

109 
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

110 
	#årštf
(
¡»am
, ...) \

111 
	`__årštf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

114 
__ex‹º_®ways_šlše
 

115 
	$v´štf
 (
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

117 #ifdeà
__USE_EXTERN_INLINES


118  
	`__vårštf_chk
 (
¡dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

120  
	`__v´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

122 
	}
}

124 
__ex‹º_®ways_šlše
 

125 
	$vårštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

126 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

128  
	`__vårštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

129 
	}
}

131 #ifdeà
__USE_GNU


133 
	$__a¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

134 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

135 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 4))è
__wur
;

136 
	$__va¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

137 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

138 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 0))è
__wur
;

139 
	$__d´štf_chk
 (
__fd
, 
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fmt
,

140 ...è
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

141 
	$__vd´štf_chk
 (
__fd
, 
__æag
,

142 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

143 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

144 
	$__ob¡ack_´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

145 
__æag
, 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

147 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

148 
	$__ob¡ack_v´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

149 
__æag
,

150 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

151 
_G_va_li¡
 
__¬gs
)

152 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

154 #ifdeà
__va_¬g_·ck


155 
__ex‹º_®ways_šlše
 

156 
	`__NTH
 (
	$a¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
, ...))

158  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

159 
	`__va_¬g_·ck
 ());

160 
	}
}

162 
__ex‹º_®ways_šlše
 

163 
__NTH
 (
	$__a¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
,

166  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

167 
	`__va_¬g_·ck
 ());

168 
	}
}

170 
__ex‹º_®ways_šlše
 

171 
	$d´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...)

173  
	`__d´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

174 
	`__va_¬g_·ck
 ());

175 
	}
}

177 
__ex‹º_®ways_šlše
 

178 
__NTH
 (
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

179 
__cÚ¡
 *
__»¡riù
 
__fmt
, ...))

181  
	`__ob¡ack_´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

182 
	`__va_¬g_·ck
 ());

183 
	}
}

184 #–ià!
defšed
 
__ılu¥lus


185 
	#a¥rštf
(
±r
, ...) \

186 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

187 
	#__a¥rštf
(
±r
, ...) \

188 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

189 
	#d´štf
(
fd
, ...) \

190 
	`__d´štf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

191 
	#ob¡ack_´štf
(
ob¡ack
, ...) \

192 
	`__ob¡ack_´štf_chk
 (
ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

195 
__ex‹º_®ways_šlše
 

196 
__NTH
 (
	$va¥rštf
 (**
__»¡riù
 
__±r
, 
__cÚ¡
 *__»¡riù 
__fmt
,

197 
_G_va_li¡
 
__­
))

199  
	`__va¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

200 
	}
}

202 
__ex‹º_®ways_šlše
 

203 
	$vd´štf
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

205  
	`__vd´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

206 
	}
}

208 
__ex‹º_®ways_šlše
 

209 
__NTH
 (
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

210 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

212  
	`__ob¡ack_v´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

213 
__­
);

214 
	}
}

220 *
	$__g‘s_chk
 (*
__¡r
, 
size_t
è
__wur
;

221 *
	`__REDIRECT
 (
__g‘s_w¬n
, (*
__¡r
), 
g‘s
)

222 
__wur
 
	`__w¬Ç‰r
 ("please use fgets or getline instead, gets can't "

225 
__ex‹º_®ways_šlše
 
__wur
 *

226 
	$g‘s
 (*
__¡r
)

228 ià(
	`__bos
 (
__¡r
è!ğ(
size_t
) -1)

229  
	`__g‘s_chk
 (
__¡r
, 
	`__bos
 (__str));

230  
	`__g‘s_w¬n
 (
__¡r
);

231 
	}
}

233 *
	$__fg‘s_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

234 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

235 *
	`__REDIRECT
 (
__fg‘s_®Ÿs
,

236 (*
__»¡riù
 
__s
, 
__n
,

237 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s
è
__wur
;

238 *
	`__REDIRECT
 (
__fg‘s_chk_w¬n
,

239 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

240 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_chk
)

241 
__wur
 
	`__w¬Ç‰r
 ("fgets called with bigger sizehan†ength "

244 
__ex‹º_®ways_šlše
 
__wur
 *

245 
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

247 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

249 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

250  
	`__fg‘s_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

252 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

253  
	`__fg‘s_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

255  
	`__fg‘s_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

256 
	}
}

258 
size_t
 
	$__ä—d_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

259 
size_t
 
__size
, size_ˆ
__n
,

260 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

261 
size_t
 
	`__REDIRECT
 (
__ä—d_®Ÿs
,

262 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

263 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

264 
ä—d
è
__wur
;

265 
size_t
 
	`__REDIRECT
 (
__ä—d_chk_w¬n
,

266 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

267 
size_t
 
__size
, size_ˆ
__n
,

268 
FILE
 *
__»¡riù
 
__¡»am
),

269 
__ä—d_chk
)

270 
__wur
 
	`__w¬Ç‰r
 ("fread called with bigger size *‚membhan†ength "

273 
__ex‹º_®ways_šlše
 
__wur
 
size_t


274 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

275 
FILE
 *
__»¡riù
 
__¡»am
)

277 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

279 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

280 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

281 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

282  
	`__ä—d_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

284 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

285  
	`__ä—d_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

287  
	`__ä—d_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

288 
	}
}

290 #ifdeà
__USE_GNU


291 *
	$__fg‘s_uÆocked_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
,

292 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

293 *
	`__REDIRECT
 (
__fg‘s_uÆocked_®Ÿs
,

294 (*
__»¡riù
 
__s
, 
__n
,

295 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s_uÆocked
è
__wur
;

296 *
	`__REDIRECT
 (
__fg‘s_uÆocked_chk_w¬n
,

297 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

298 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_uÆocked_chk
)

299 
__wur
 
	`__w¬Ç‰r
 ("fgets_unlocked called with bigger sizehan†ength "

302 
__ex‹º_®ways_šlše
 
__wur
 *

303 
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

305 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

307 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

308  
	`__fg‘s_uÆocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

310 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

311  
	`__fg‘s_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

313  
	`__fg‘s_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

314 
	}
}

317 #ifdeà
__USE_MISC


318 #undeà
ä—d_uÆocked


319 
size_t
 
	$__ä—d_uÆocked_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

320 
size_t
 
__size
, size_ˆ
__n
,

321 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

322 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_®Ÿs
,

323 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

324 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

325 
ä—d_uÆocked
è
__wur
;

326 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_chk_w¬n
,

327 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

328 
size_t
 
__size
, size_ˆ
__n
,

329 
FILE
 *
__»¡riù
 
__¡»am
),

330 
__ä—d_uÆocked_chk
)

331 
__wur
 
	`__w¬Ç‰r
 ("fread_unlocked called with bigger size *‚membhan "

334 
__ex‹º_®ways_šlše
 
__wur
 
size_t


335 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

336 
FILE
 *
__»¡riù
 
__¡»am
)

338 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

340 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

341 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

342 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

343  
	`__ä—d_uÆocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

344 
__¡»am
);

346 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

347  
	`__ä—d_uÆocked_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

348 
__¡»am
);

351 #ifdeà
__USE_EXTERN_INLINES


352 ià(
	`__butš_cÚ¡ªt_p
 (
__size
)

353 && 
	`__butš_cÚ¡ªt_p
 (
__n
)

354 && (
__size
 | 
__n
è< (((
size_t
) 1) << (8 *  (size_t) / 2))

355 && 
__size
 * 
__n
 <= 8)

357 
size_t
 
__út
 = 
__size
 * 
__n
;

358 *
__ıŒ
 = (*è
__±r
;

359 ià(
__út
 == 0)

362 ; 
__út
 > 0; --__cnt)

364 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
);

365 ià(
__c
 =ğ
EOF
)

367 *
__ıŒ
++ = 
__c
;

369  (
__ıŒ
 - (*è
__±r
è/ 
__size
;

372  
	`__ä—d_uÆocked_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

373 
	}
}

	@/usr/include/bits/stdio_lim.h

19 #ià!
defšed
 
_STDIO_H
 && !defšed 
__Ãed_FOPEN_MAX
 && !defšed 
__Ãed_IOV_MAX


23 #ifdeà
_STDIO_H


24 
	#L_tm²am
 20

	)

25 
	#TMP_MAX
 238328

	)

26 
	#FILENAME_MAX
 4096

	)

28 #ifdeà
__USE_POSIX


29 
	#L_ù”mid
 9

	)

30 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


31 
	#L_cu£rid
 9

	)

36 #ià
defšed
 
__Ãed_FOPEN_MAX
 || defšed 
_STDIO_H


37 #undeà
FOPEN_MAX


38 
	#FOPEN_MAX
 16

	)

41 #ià
defšed
 
__Ãed_IOV_MAX
 && !defšed 
IOV_MAX


42 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/sys_errlist.h

20 #iâdeà
_STDIO_H


26 #ifdeà 
__USE_BSD


27 
sys_Ã¼
;

28 
__cÚ¡
 *__cÚ¡ 
sys_”¾i¡
[];

30 #ifdeà 
__USE_GNU


31 
_sys_Ã¼
;

32 
__cÚ¡
 *__cÚ¡ 
_sys_”¾i¡
[];

	@/usr/include/bits/syscall.h

3 #iâdeà
_SYSCALL_H


7 
	~<b™s/wÜdsize.h
>

9 
	#SYS__sysùl
 
__NR__sysùl


	)

10 
	#SYS_acûss
 
__NR_acûss


	)

11 
	#SYS_acù
 
__NR_acù


	)

12 
	#SYS_add_key
 
__NR_add_key


	)

13 
	#SYS_adjtimex
 
__NR_adjtimex


	)

14 
	#SYS_afs_sysÿÎ
 
__NR_afs_sysÿÎ


	)

15 
	#SYS_®¬m
 
__NR_®¬m


	)

16 
	#SYS_brk
 
__NR_brk


	)

17 
	#SYS_ÿpg‘
 
__NR_ÿpg‘


	)

18 
	#SYS_ÿp£t
 
__NR_ÿp£t


	)

19 
	#SYS_chdœ
 
__NR_chdœ


	)

20 
	#SYS_chmod
 
__NR_chmod


	)

21 
	#SYS_chown
 
__NR_chown


	)

22 
	#SYS_chroÙ
 
__NR_chroÙ


	)

23 
	#SYS_şock_g‘»s
 
__NR_şock_g‘»s


	)

24 
	#SYS_şock_g‘time
 
__NR_şock_g‘time


	)

25 
	#SYS_şock_Çno¦“p
 
__NR_şock_Çno¦“p


	)

26 
	#SYS_şock_£‰ime
 
__NR_şock_£‰ime


	)

27 
	#SYS_şÚe
 
__NR_şÚe


	)

28 
	#SYS_şo£
 
__NR_şo£


	)

29 
	#SYS_ü—t
 
__NR_ü—t


	)

30 
	#SYS_ü—‹_moduË
 
__NR_ü—‹_moduË


	)

31 
	#SYS_d–‘e_moduË
 
__NR_d–‘e_moduË


	)

32 
	#SYS_dup
 
__NR_dup


	)

33 
	#SYS_dup2
 
__NR_dup2


	)

34 
	#SYS_dup3
 
__NR_dup3


	)

35 
	#SYS_•Şl_ü—‹
 
__NR_•Şl_ü—‹


	)

36 
	#SYS_•Şl_ü—‹1
 
__NR_•Şl_ü—‹1


	)

37 
	#SYS_•Şl_ùl
 
__NR_•Şl_ùl


	)

38 
	#SYS_•Şl_pwa™
 
__NR_•Şl_pwa™


	)

39 
	#SYS_•Şl_wa™
 
__NR_•Şl_wa™


	)

40 
	#SYS_ev’tfd
 
__NR_ev’tfd


	)

41 
	#SYS_ev’tfd2
 
__NR_ev’tfd2


	)

42 
	#SYS_execve
 
__NR_execve


	)

43 
	#SYS_ex™
 
__NR_ex™


	)

44 
	#SYS_ex™_group
 
__NR_ex™_group


	)

45 
	#SYS_çcûs§t
 
__NR_çcûs§t


	)

46 
	#SYS_çdvi£64
 
__NR_çdvi£64


	)

47 
	#SYS_çÎoÿ‹
 
__NR_çÎoÿ‹


	)

48 
	#SYS_fchdœ
 
__NR_fchdœ


	)

49 
	#SYS_fchmod
 
__NR_fchmod


	)

50 
	#SYS_fchmod©
 
__NR_fchmod©


	)

51 
	#SYS_fchown
 
__NR_fchown


	)

52 
	#SYS_fchowÇt
 
__NR_fchowÇt


	)

53 
	#SYS_fú
 
__NR_fú


	)

54 
	#SYS_fd©async
 
__NR_fd©async


	)

55 
	#SYS_fg‘x©Œ
 
__NR_fg‘x©Œ


	)

56 
	#SYS_æi¡x©Œ
 
__NR_æi¡x©Œ


	)

57 
	#SYS_æock
 
__NR_æock


	)

58 
	#SYS_fÜk
 
__NR_fÜk


	)

59 
	#SYS_äemovex©Œ
 
__NR_äemovex©Œ


	)

60 
	#SYS_f£tx©Œ
 
__NR_f£tx©Œ


	)

61 
	#SYS_f¡©
 
__NR_f¡©


	)

62 
	#SYS_f¡©fs
 
__NR_f¡©fs


	)

63 
	#SYS_fsync
 
__NR_fsync


	)

64 
	#SYS_árunÿ‹
 
__NR_árunÿ‹


	)

65 
	#SYS_fu‹x
 
__NR_fu‹x


	)

66 
	#SYS_futime§t
 
__NR_futime§t


	)

67 
	#SYS_g‘_k”Ãl_syms
 
__NR_g‘_k”Ãl_syms


	)

68 
	#SYS_g‘_mempŞicy
 
__NR_g‘_mempŞicy


	)

69 
	#SYS_g‘_robu¡_li¡
 
__NR_g‘_robu¡_li¡


	)

70 
	#SYS_g‘_th»ad_¬—
 
__NR_g‘_th»ad_¬—


	)

71 
	#SYS_g‘cwd
 
__NR_g‘cwd


	)

72 
	#SYS_g‘d’ts
 
__NR_g‘d’ts


	)

73 
	#SYS_g‘d’ts64
 
__NR_g‘d’ts64


	)

74 
	#SYS_g‘egid
 
__NR_g‘egid


	)

75 
	#SYS_g‘euid
 
__NR_g‘euid


	)

76 
	#SYS_g‘gid
 
__NR_g‘gid


	)

77 
	#SYS_g‘groups
 
__NR_g‘groups


	)

78 
	#SYS_g‘™im”
 
__NR_g‘™im”


	)

79 
	#SYS_g‘pgid
 
__NR_g‘pgid


	)

80 
	#SYS_g‘pg½
 
__NR_g‘pg½


	)

81 
	#SYS_g‘pid
 
__NR_g‘pid


	)

82 
	#SYS_g‘pmsg
 
__NR_g‘pmsg


	)

83 
	#SYS_g‘µid
 
__NR_g‘µid


	)

84 
	#SYS_g‘´iÜ™y
 
__NR_g‘´iÜ™y


	)

85 
	#SYS_g‘»sgid
 
__NR_g‘»sgid


	)

86 
	#SYS_g‘»suid
 
__NR_g‘»suid


	)

87 
	#SYS_g‘¾im™
 
__NR_g‘¾im™


	)

88 
	#SYS_g‘ru§ge
 
__NR_g‘ru§ge


	)

89 
	#SYS_g‘sid
 
__NR_g‘sid


	)

90 
	#SYS_g‘tid
 
__NR_g‘tid


	)

91 
	#SYS_g‘timeofday
 
__NR_g‘timeofday


	)

92 
	#SYS_g‘uid
 
__NR_g‘uid


	)

93 
	#SYS_g‘x©Œ
 
__NR_g‘x©Œ


	)

94 
	#SYS_š™_moduË
 
__NR_š™_moduË


	)

95 
	#SYS_šÙify_add_w©ch
 
__NR_šÙify_add_w©ch


	)

96 
	#SYS_šÙify_š™
 
__NR_šÙify_š™


	)

97 
	#SYS_šÙify_š™1
 
__NR_šÙify_š™1


	)

98 
	#SYS_šÙify_rm_w©ch
 
__NR_šÙify_rm_w©ch


	)

99 
	#SYS_io_ÿnûl
 
__NR_io_ÿnûl


	)

100 
	#SYS_io_de¡roy
 
__NR_io_de¡roy


	)

101 
	#SYS_io_g‘ev’ts
 
__NR_io_g‘ev’ts


	)

102 
	#SYS_io_£tup
 
__NR_io_£tup


	)

103 
	#SYS_io_subm™
 
__NR_io_subm™


	)

104 
	#SYS_ioùl
 
__NR_ioùl


	)

105 
	#SYS_iİ”m
 
__NR_iİ”m


	)

106 
	#SYS_iİl
 
__NR_iİl


	)

107 
	#SYS_iİrio_g‘
 
__NR_iİrio_g‘


	)

108 
	#SYS_iİrio_£t
 
__NR_iİrio_£t


	)

109 
	#SYS_kexec_lßd
 
__NR_kexec_lßd


	)

110 
	#SYS_keyùl
 
__NR_keyùl


	)

111 
	#SYS_kl
 
__NR_kl


	)

112 
	#SYS_lchown
 
__NR_lchown


	)

113 
	#SYS_lg‘x©Œ
 
__NR_lg‘x©Œ


	)

114 
	#SYS_lšk
 
__NR_lšk


	)

115 
	#SYS_lšk©
 
__NR_lšk©


	)

116 
	#SYS_li¡x©Œ
 
__NR_li¡x©Œ


	)

117 
	#SYS_Îi¡x©Œ
 
__NR_Îi¡x©Œ


	)

118 
	#SYS_lookup_dcook›
 
__NR_lookup_dcook›


	)

119 
	#SYS_Ìemovex©Œ
 
__NR_Ìemovex©Œ


	)

120 
	#SYS_l£ek
 
__NR_l£ek


	)

121 
	#SYS_l£tx©Œ
 
__NR_l£tx©Œ


	)

122 
	#SYS_l¡©
 
__NR_l¡©


	)

123 
	#SYS_madvi£
 
__NR_madvi£


	)

124 
	#SYS_mbšd
 
__NR_mbšd


	)

125 
	#SYS_mig¿‹_·ges
 
__NR_mig¿‹_·ges


	)

126 
	#SYS_mšcÜe
 
__NR_mšcÜe


	)

127 
	#SYS_mkdœ
 
__NR_mkdœ


	)

128 
	#SYS_mkdœ©
 
__NR_mkdœ©


	)

129 
	#SYS_mknod
 
__NR_mknod


	)

130 
	#SYS_mknod©
 
__NR_mknod©


	)

131 
	#SYS_mlock
 
__NR_mlock


	)

132 
	#SYS_mlock®l
 
__NR_mlock®l


	)

133 
	#SYS_mm­
 
__NR_mm­


	)

134 
	#SYS_modify_ldt
 
__NR_modify_ldt


	)

135 
	#SYS_mouÁ
 
__NR_mouÁ


	)

136 
	#SYS_move_·ges
 
__NR_move_·ges


	)

137 
	#SYS_m´Ùeù
 
__NR_m´Ùeù


	)

138 
	#SYS_mq_g‘£‰r
 
__NR_mq_g‘£‰r


	)

139 
	#SYS_mq_nÙify
 
__NR_mq_nÙify


	)

140 
	#SYS_mq_İ’
 
__NR_mq_İ’


	)

141 
	#SYS_mq_timed»ûive
 
__NR_mq_timed»ûive


	)

142 
	#SYS_mq_timed£nd
 
__NR_mq_timed£nd


	)

143 
	#SYS_mq_uÆšk
 
__NR_mq_uÆšk


	)

144 
	#SYS_m»m­
 
__NR_m»m­


	)

145 
	#SYS_msync
 
__NR_msync


	)

146 
	#SYS_muÆock
 
__NR_muÆock


	)

147 
	#SYS_muÆock®l
 
__NR_muÆock®l


	)

148 
	#SYS_munm­
 
__NR_munm­


	)

149 
	#SYS_Çno¦“p
 
__NR_Çno¦“p


	)

150 
	#SYS_nfs£rvùl
 
__NR_nfs£rvùl


	)

151 
	#SYS_İ’
 
__NR_İ’


	)

152 
	#SYS_İ’©
 
__NR_İ’©


	)

153 
	#SYS_·u£
 
__NR_·u£


	)

154 
	#SYS_³rf_ev’t_İ’
 
__NR_³rf_ev’t_İ’


	)

155 
	#SYS_³rsÚ®™y
 
__NR_³rsÚ®™y


	)

156 
	#SYS_pe
 
__NR_pe


	)

157 
	#SYS_pe2
 
__NR_pe2


	)

158 
	#SYS_pivÙ_roÙ
 
__NR_pivÙ_roÙ


	)

159 
	#SYS_pŞl
 
__NR_pŞl


	)

160 
	#SYS_µŞl
 
__NR_µŞl


	)

161 
	#SYS_´ùl
 
__NR_´ùl


	)

162 
	#SYS_´—d64
 
__NR_´—d64


	)

163 
	#SYS_´—dv
 
__NR_´—dv


	)

164 
	#SYS_p£Ëù6
 
__NR_p£Ëù6


	)

165 
	#SYS_±¿û
 
__NR_±¿û


	)

166 
	#SYS_pumsg
 
__NR_pumsg


	)

167 
	#SYS_pwr™e64
 
__NR_pwr™e64


	)

168 
	#SYS_pwr™ev
 
__NR_pwr™ev


	)

169 
	#SYS_qu”y_moduË
 
__NR_qu”y_moduË


	)

170 
	#SYS_quÙaùl
 
__NR_quÙaùl


	)

171 
	#SYS_»ad
 
__NR_»ad


	)

172 
	#SYS_»adah—d
 
__NR_»adah—d


	)

173 
	#SYS_»adlšk
 
__NR_»adlšk


	)

174 
	#SYS_»adlšk©
 
__NR_»adlšk©


	)

175 
	#SYS_»adv
 
__NR_»adv


	)

176 
	#SYS_»boÙ
 
__NR_»boÙ


	)

177 
	#SYS_»m­_fe_·ges
 
__NR_»m­_fe_·ges


	)

178 
	#SYS_»movex©Œ
 
__NR_»movex©Œ


	)

179 
	#SYS_»Çme
 
__NR_»Çme


	)

180 
	#SYS_»Çm—t
 
__NR_»Çm—t


	)

181 
	#SYS_»que¡_key
 
__NR_»que¡_key


	)

182 
	#SYS_»¡¬t_sysÿÎ
 
__NR_»¡¬t_sysÿÎ


	)

183 
	#SYS_rmdœ
 
__NR_rmdœ


	)

184 
	#SYS_¹_sigaùiÚ
 
__NR_¹_sigaùiÚ


	)

185 
	#SYS_¹_sig³ndšg
 
__NR_¹_sig³ndšg


	)

186 
	#SYS_¹_sig´ocmask
 
__NR_¹_sig´ocmask


	)

187 
	#SYS_¹_sigqueuešfo
 
__NR_¹_sigqueuešfo


	)

188 
	#SYS_¹_sig»tuº
 
__NR_¹_sig»tuº


	)

189 
	#SYS_¹_sigsu¥’d
 
__NR_¹_sigsu¥’d


	)

190 
	#SYS_¹_sigtimedwa™
 
__NR_¹_sigtimedwa™


	)

191 
	#SYS_¹_tgsigqueuešfo
 
__NR_¹_tgsigqueuešfo


	)

192 
	#SYS_sched_g‘_´iÜ™y_max
 
__NR_sched_g‘_´iÜ™y_max


	)

193 
	#SYS_sched_g‘_´iÜ™y_mš
 
__NR_sched_g‘_´iÜ™y_mš


	)

194 
	#SYS_sched_g‘affš™y
 
__NR_sched_g‘affš™y


	)

195 
	#SYS_sched_g‘·¿m
 
__NR_sched_g‘·¿m


	)

196 
	#SYS_sched_g‘scheduËr
 
__NR_sched_g‘scheduËr


	)

197 
	#SYS_sched_¼_g‘_š‹rv®
 
__NR_sched_¼_g‘_š‹rv®


	)

198 
	#SYS_sched_£ffš™y
 
__NR_sched_£ffš™y


	)

199 
	#SYS_sched_£¬am
 
__NR_sched_£¬am


	)

200 
	#SYS_sched_£tscheduËr
 
__NR_sched_£tscheduËr


	)

201 
	#SYS_sched_y›ld
 
__NR_sched_y›ld


	)

202 
	#SYS_£Ëù
 
__NR_£Ëù


	)

203 
	#SYS_£ndfe
 
__NR_£ndfe


	)

204 
	#SYS_£t_mempŞicy
 
__NR_£t_mempŞicy


	)

205 
	#SYS_£t_robu¡_li¡
 
__NR_£t_robu¡_li¡


	)

206 
	#SYS_£t_th»ad_¬—
 
__NR_£t_th»ad_¬—


	)

207 
	#SYS_£t_tid_add»ss
 
__NR_£t_tid_add»ss


	)

208 
	#SYS_£tdomašÇme
 
__NR_£tdomašÇme


	)

209 
	#SYS_£tfsgid
 
__NR_£tfsgid


	)

210 
	#SYS_£tfsuid
 
__NR_£tfsuid


	)

211 
	#SYS_£tgid
 
__NR_£tgid


	)

212 
	#SYS_£tgroups
 
__NR_£tgroups


	)

213 
	#SYS_£tho¡Çme
 
__NR_£tho¡Çme


	)

214 
	#SYS_£t™im”
 
__NR_£t™im”


	)

215 
	#SYS_£gid
 
__NR_£gid


	)

216 
	#SYS_£riÜ™y
 
__NR_£riÜ™y


	)

217 
	#SYS_£Œegid
 
__NR_£Œegid


	)

218 
	#SYS_£Œesgid
 
__NR_£Œesgid


	)

219 
	#SYS_£Œesuid
 
__NR_£Œesuid


	)

220 
	#SYS_£Œeuid
 
__NR_£Œeuid


	)

221 
	#SYS_£Œlim™
 
__NR_£Œlim™


	)

222 
	#SYS_£tsid
 
__NR_£tsid


	)

223 
	#SYS_£‰imeofday
 
__NR_£‰imeofday


	)

224 
	#SYS_£tuid
 
__NR_£tuid


	)

225 
	#SYS_£tx©Œ
 
__NR_£tx©Œ


	)

226 
	#SYS_sig®t¡ack
 
__NR_sig®t¡ack


	)

227 
	#SYS_sigÇlfd
 
__NR_sigÇlfd


	)

228 
	#SYS_sigÇlfd4
 
__NR_sigÇlfd4


	)

229 
	#SYS_¥liû
 
__NR_¥liû


	)

230 
	#SYS_¡©
 
__NR_¡©


	)

231 
	#SYS_¡©fs
 
__NR_¡©fs


	)

232 
	#SYS_sw­off
 
__NR_sw­off


	)

233 
	#SYS_sw­Ú
 
__NR_sw­Ú


	)

234 
	#SYS_symlšk
 
__NR_symlšk


	)

235 
	#SYS_symlšk©
 
__NR_symlšk©


	)

236 
	#SYS_sync
 
__NR_sync


	)

237 
	#SYS_sync_fe_¿nge
 
__NR_sync_fe_¿nge


	)

238 
	#SYS_sysfs
 
__NR_sysfs


	)

239 
	#SYS_sysšfo
 
__NR_sysšfo


	)

240 
	#SYS_sy¦og
 
__NR_sy¦og


	)

241 
	#SYS_‹e
 
__NR_‹e


	)

242 
	#SYS_tgkl
 
__NR_tgkl


	)

243 
	#SYS_time
 
__NR_time


	)

244 
	#SYS_tim”_ü—‹
 
__NR_tim”_ü—‹


	)

245 
	#SYS_tim”_d–‘e
 
__NR_tim”_d–‘e


	)

246 
	#SYS_tim”_g‘ov”run
 
__NR_tim”_g‘ov”run


	)

247 
	#SYS_tim”_g‘time
 
__NR_tim”_g‘time


	)

248 
	#SYS_tim”_£‰ime
 
__NR_tim”_£‰ime


	)

249 
	#SYS_tim”fd_ü—‹
 
__NR_tim”fd_ü—‹


	)

250 
	#SYS_tim”fd_g‘time
 
__NR_tim”fd_g‘time


	)

251 
	#SYS_tim”fd_£‰ime
 
__NR_tim”fd_£‰ime


	)

252 
	#SYS_times
 
__NR_times


	)

253 
	#SYS_tkl
 
__NR_tkl


	)

254 
	#SYS_Œunÿ‹
 
__NR_Œunÿ‹


	)

255 
	#SYS_umask
 
__NR_umask


	)

256 
	#SYS_umouÁ2
 
__NR_umouÁ2


	)

257 
	#SYS_uÇme
 
__NR_uÇme


	)

258 
	#SYS_uÆšk
 
__NR_uÆšk


	)

259 
	#SYS_uÆšk©
 
__NR_uÆšk©


	)

260 
	#SYS_unsh¬e
 
__NR_unsh¬e


	)

261 
	#SYS_u£lib
 
__NR_u£lib


	)

262 
	#SYS_u¡©
 
__NR_u¡©


	)

263 
	#SYS_utime
 
__NR_utime


	)

264 
	#SYS_utim’§t
 
__NR_utim’§t


	)

265 
	#SYS_utimes
 
__NR_utimes


	)

266 
	#SYS_vfÜk
 
__NR_vfÜk


	)

267 
	#SYS_vhªgup
 
__NR_vhªgup


	)

268 
	#SYS_vm¥liû
 
__NR_vm¥liû


	)

269 
	#SYS_v£rv”
 
__NR_v£rv”


	)

270 
	#SYS_wa™4
 
__NR_wa™4


	)

271 
	#SYS_wa™id
 
__NR_wa™id


	)

272 
	#SYS_wr™e
 
__NR_wr™e


	)

273 
	#SYS_wr™ev
 
__NR_wr™ev


	)

274 #ià
__WORDSIZE
 == 64

275 
	#SYS_acû±
 
__NR_acû±


	)

276 
	#SYS_acû±4
 
__NR_acû±4


	)

277 
	#SYS_¬ch_´ùl
 
__NR_¬ch_´ùl


	)

278 
	#SYS_bšd
 
__NR_bšd


	)

279 
	#SYS_cÚÃù
 
__NR_cÚÃù


	)

280 
	#SYS_•Şl_ùl_Şd
 
__NR_•Şl_ùl_Şd


	)

281 
	#SYS_•Şl_wa™_Şd
 
__NR_•Şl_wa™_Şd


	)

282 
	#SYS_g‘³”Çme
 
__NR_g‘³”Çme


	)

283 
	#SYS_g‘sockÇme
 
__NR_g‘sockÇme


	)

284 
	#SYS_g‘sockİt
 
__NR_g‘sockİt


	)

285 
	#SYS_li¡’
 
__NR_li¡’


	)

286 
	#SYS_msgùl
 
__NR_msgùl


	)

287 
	#SYS_msgg‘
 
__NR_msgg‘


	)

288 
	#SYS_msgrcv
 
__NR_msgrcv


	)

289 
	#SYS_msg¢d
 
__NR_msg¢d


	)

290 
	#SYS_Ãwf¡©©
 
__NR_Ãwf¡©©


	)

291 
	#SYS_»cväom
 
__NR_»cväom


	)

292 
	#SYS_»cvmsg
 
__NR_»cvmsg


	)

293 
	#SYS_£cur™y
 
__NR_£cur™y


	)

294 
	#SYS_£mùl
 
__NR_£mùl


	)

295 
	#SYS_£mg‘
 
__NR_£mg‘


	)

296 
	#SYS_£mİ
 
__NR_£mİ


	)

297 
	#SYS_£mtimedİ
 
__NR_£mtimedİ


	)

298 
	#SYS_£ndmsg
 
__NR_£ndmsg


	)

299 
	#SYS_£ndto
 
__NR_£ndto


	)

300 
	#SYS_£tsockİt
 
__NR_£tsockİt


	)

301 
	#SYS_shm©
 
__NR_shm©


	)

302 
	#SYS_shmùl
 
__NR_shmùl


	)

303 
	#SYS_shmdt
 
__NR_shmdt


	)

304 
	#SYS_shmg‘
 
__NR_shmg‘


	)

305 
	#SYS_shutdown
 
__NR_shutdown


	)

306 
	#SYS_sock‘
 
__NR_sock‘


	)

307 
	#SYS_sock‘·œ
 
__NR_sock‘·œ


	)

308 
	#SYS_tuxÿÎ
 
__NR_tuxÿÎ


	)

310 
	#SYS__Î£ek
 
__NR__Î£ek


	)

311 
	#SYS__Ãw£Ëù
 
__NR__Ãw£Ëù


	)

312 
	#SYS_bdæush
 
__NR_bdæush


	)

313 
	#SYS_b»ak
 
__NR_b»ak


	)

314 
	#SYS_chown32
 
__NR_chown32


	)

315 
	#SYS_çdvi£64_64
 
__NR_çdvi£64_64


	)

316 
	#SYS_fchown32
 
__NR_fchown32


	)

317 
	#SYS_fú64
 
__NR_fú64


	)

318 
	#SYS_f¡©64
 
__NR_f¡©64


	)

319 
	#SYS_f¡©©64
 
__NR_f¡©©64


	)

320 
	#SYS_f¡©fs64
 
__NR_f¡©fs64


	)

321 
	#SYS_áime
 
__NR_áime


	)

322 
	#SYS_árunÿ‹64
 
__NR_árunÿ‹64


	)

323 
	#SYS_g‘ıu
 
__NR_g‘ıu


	)

324 
	#SYS_g‘egid32
 
__NR_g‘egid32


	)

325 
	#SYS_g‘euid32
 
__NR_g‘euid32


	)

326 
	#SYS_g‘gid32
 
__NR_g‘gid32


	)

327 
	#SYS_g‘groups32
 
__NR_g‘groups32


	)

328 
	#SYS_g‘»sgid32
 
__NR_g‘»sgid32


	)

329 
	#SYS_g‘»suid32
 
__NR_g‘»suid32


	)

330 
	#SYS_g‘uid32
 
__NR_g‘uid32


	)

331 
	#SYS_g‰y
 
__NR_g‰y


	)

332 
	#SYS_idË
 
__NR_idË


	)

333 
	#SYS_c
 
__NR_c


	)

334 
	#SYS_lchown32
 
__NR_lchown32


	)

335 
	#SYS_lock
 
__NR_lock


	)

336 
	#SYS_l¡©64
 
__NR_l¡©64


	)

337 
	#SYS_madvi£1
 
__NR_madvi£1


	)

338 
	#SYS_mm­2
 
__NR_mm­2


	)

339 
	#SYS_mpx
 
__NR_mpx


	)

340 
	#SYS_niû
 
__NR_niû


	)

341 
	#SYS_Şdf¡©
 
__NR_Şdf¡©


	)

342 
	#SYS_Şdl¡©
 
__NR_Şdl¡©


	)

343 
	#SYS_ŞdŞduÇme
 
__NR_ŞdŞduÇme


	)

344 
	#SYS_Şd¡©
 
__NR_Şd¡©


	)

345 
	#SYS_ŞduÇme
 
__NR_ŞduÇme


	)

346 
	#SYS_´of
 
__NR_´of


	)

347 
	#SYS_´of
 
__NR_´of


	)

348 
	#SYS_»addœ
 
__NR_»addœ


	)

349 
	#SYS_£ndfe64
 
__NR_£ndfe64


	)

350 
	#SYS_£tfsgid32
 
__NR_£tfsgid32


	)

351 
	#SYS_£tfsuid32
 
__NR_£tfsuid32


	)

352 
	#SYS_£tgid32
 
__NR_£tgid32


	)

353 
	#SYS_£tgroups32
 
__NR_£tgroups32


	)

354 
	#SYS_£Œegid32
 
__NR_£Œegid32


	)

355 
	#SYS_£Œesgid32
 
__NR_£Œesgid32


	)

356 
	#SYS_£Œesuid32
 
__NR_£Œesuid32


	)

357 
	#SYS_£Œeuid32
 
__NR_£Œeuid32


	)

358 
	#SYS_£tuid32
 
__NR_£tuid32


	)

359 
	#SYS_sg‘mask
 
__NR_sg‘mask


	)

360 
	#SYS_sigaùiÚ
 
__NR_sigaùiÚ


	)

361 
	#SYS_sigÇl
 
__NR_sigÇl


	)

362 
	#SYS_sig³ndšg
 
__NR_sig³ndšg


	)

363 
	#SYS_sig´ocmask
 
__NR_sig´ocmask


	)

364 
	#SYS_sig»tuº
 
__NR_sig»tuº


	)

365 
	#SYS_sigsu¥’d
 
__NR_sigsu¥’d


	)

366 
	#SYS_sock‘ÿÎ
 
__NR_sock‘ÿÎ


	)

367 
	#SYS_s£tmask
 
__NR_s£tmask


	)

368 
	#SYS_¡©64
 
__NR_¡©64


	)

369 
	#SYS_¡©fs64
 
__NR_¡©fs64


	)

370 
	#SYS_¡ime
 
__NR_¡ime


	)

371 
	#SYS_¡ty
 
__NR_¡ty


	)

372 
	#SYS_Œunÿ‹64
 
__NR_Œunÿ‹64


	)

373 
	#SYS_ug‘¾im™
 
__NR_ug‘¾im™


	)

374 
	#SYS_ulim™
 
__NR_ulim™


	)

375 
	#SYS_umouÁ
 
__NR_umouÁ


	)

376 
	#SYS_vm86
 
__NR_vm86


	)

377 
	#SYS_vm86Şd
 
__NR_vm86Şd


	)

378 
	#SYS_wa™pid
 
__NR_wa™pid


	)

	@/usr/include/bits/types.h

24 #iâdef 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	t__u_ch¬
;

32 
	t__u_shÜt
;

33 
	t__u_št
;

34 
	t__u_lÚg
;

37 sigÃd 
	t__št8_t
;

38 
	t__ušt8_t
;

39 sigÃd 
	t__št16_t
;

40 
	t__ušt16_t
;

41 sigÃd 
	t__št32_t
;

42 
	t__ušt32_t
;

43 #ià
__WORDSIZE
 == 64

44 sigÃd 
	t__št64_t
;

45 
	t__ušt64_t
;

46 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


47 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

48 
__ex‹nsiÚ__
 
	t__ušt64_t
;

52 #ià
__WORDSIZE
 == 64

53 
	t__quad_t
;

54 
	t__u_quad_t
;

55 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


56 
__ex‹nsiÚ__
 
	t__quad_t
;

57 
__ex‹nsiÚ__
 
	t__u_quad_t
;

61 
	m__v®
[2];

62 } 
	t__quad_t
;

65 
__u_lÚg
 
	m__v®
[2];

66 } 
	t__u_quad_t
;

99 
	#__S16_TYPE
 

	)

100 
	#__U16_TYPE
 

	)

101 
	#__S32_TYPE
 

	)

102 
	#__U32_TYPE
 

	)

103 
	#__SLONGWORD_TYPE
 

	)

104 
	#__ULONGWORD_TYPE
 

	)

105 #ià
__WORDSIZE
 == 32

106 
	#__SQUAD_TYPE
 
__quad_t


	)

107 
	#__UQUAD_TYPE
 
__u_quad_t


	)

108 
	#__SWORD_TYPE
 

	)

109 
	#__UWORD_TYPE
 

	)

110 
	#__SLONG32_TYPE
 

	)

111 
	#__ULONG32_TYPE
 

	)

112 
	#__S64_TYPE
 
__quad_t


	)

113 
	#__U64_TYPE
 
__u_quad_t


	)

116 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

117 #–ià
__WORDSIZE
 == 64

118 
	t__SQUAD_TYPE
 

	)

119 
	t__UQUAD_TYPE
 

	)

120 
	t__SWORD_TYPE
 

	)

121 
	t__UWORD_TYPE
 

	)

122 
	t__SLONG32_TYPE
 

	)

123 
	t__ULONG32_TYPE
 

	)

124 
	t__S64_TYPE
 

	)

125 
	t__U64_TYPE
 

	)

127 
	t__STD_TYPE
 

	)

131 
	~<b™s/ty³sizes.h
>

134 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

135 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

136 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

137 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

138 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

139 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

140 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

141 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

142 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

143 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

144 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

145 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

146 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

147 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

148 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

149 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

150 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

151 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

153 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

154 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

155 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

158 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

161 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

164 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

169 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

170 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

173 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

174 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

177 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

178 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

180 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__off64_t
 
	t__loff_t
;

185 
__quad_t
 *
	t__qaddr_t
;

186 *
	t__ÿddr_t
;

189 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

192 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

195 #undeà
__STD_TYPE


	@/usr/include/bits/unistd.h

20 #iâdeà
_UNISTD_H


24 
ssize_t
 
	$__»ad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

25 
size_t
 
__buæ’
è
__wur
;

26 
ssize_t
 
	`__REDIRECT
 (
__»ad_®Ÿs
, (
__fd
, *
__buf
,

27 
size_t
 
__nby‹s
), 
»ad
è
__wur
;

28 
ssize_t
 
	`__REDIRECT
 (
__»ad_chk_w¬n
,

29 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

30 
size_t
 
__buæ’
), 
__»ad_chk
)

31 
__wur
 
	`__w¬Ç‰r
 ("read called with bigger†engthhan size of "

34 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


35 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
)

37 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

39 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

40  
	`__»ad_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

42 ià(
__nby‹s
 > 
	`__bos0
 (
__buf
))

43  
	`__»ad_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

45  
	`__»ad_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
);

46 
	}
}

48 #ifdeà
__USE_UNIX98


49 
ssize_t
 
	$__´—d_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

50 
__off_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

51 
ssize_t
 
	$__´—d64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

52 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

53 
ssize_t
 
	`__REDIRECT
 (
__´—d_®Ÿs
,

54 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

55 
__off_t
 
__off£t
), 
´—d
è
__wur
;

56 
ssize_t
 
	`__REDIRECT
 (
__´—d64_®Ÿs
,

57 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

58 
__off64_t
 
__off£t
), 
´—d64
è
__wur
;

59 
ssize_t
 
	`__REDIRECT
 (
__´—d_chk_w¬n
,

60 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

61 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__´—d_chk
)

62 
__wur
 
	`__w¬Ç‰r
 ("pread called with bigger†engthhan size of "

64 
ssize_t
 
	`__REDIRECT
 (
__´—d64_chk_w¬n
,

65 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

66 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

67 
__´—d64_chk
)

68 
__wur
 
	`__w¬Ç‰r
 ("pread64 called with bigger†engthhan size of "

71 #iâdeà
__USE_FILE_OFFSET64


72 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


73 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off_t
 
__off£t
)

75 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

77 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

78  
	`__´—d_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

80 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

81  
	`__´—d_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

82 
	`__bos0
 (
__buf
));

84  
	`__´—d_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

85 
	}
}

87 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


88 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

90 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

92 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

93  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

95 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

96  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

97 
	`__bos0
 (
__buf
));

100  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

101 
	}
}

104 #ifdeà
__USE_LARGEFILE64


105 
__ex‹º_®ways_šlše
 
__wur
 
ssize_t


106 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

108 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

110 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

111  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

113 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

114  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

115 
	`__bos0
 (
__buf
));

118  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

119 
	}
}

123 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


124 
ssize_t
 
	$__»adlšk_chk
 (
__cÚ¡
 *
__»¡riù
 
__·th
,

125 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

126 
size_t
 
__buæ’
)

127 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

128 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_®Ÿs
,

129 (
__cÚ¡
 *
__»¡riù
 
__·th
,

130 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
), 
»adlšk
)

131 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

132 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_chk_w¬n
,

133 (
__cÚ¡
 *
__»¡riù
 
__·th
,

134 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

135 
size_t
 
__buæ’
), 
__»adlšk_chk
)

136 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
	`__w¬Ç‰r
 ("readlink called with bigger†ength "

139 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
ssize_t


140 
	`__NTH
 (
	$»adlšk
 (
__cÚ¡
 *
__»¡riù
 
__·th
, *__»¡riù 
__buf
,

141 
size_t
 
__Ën
))

143 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

145 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

146  
	`__»adlšk_chk
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

148 iàĞ
__Ën
 > 
	`__bos
 (
__buf
))

149  
	`__»adlšk_chk_w¬n
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

151  
	`__»adlšk_®Ÿs
 (
__·th
, 
__buf
, 
__Ën
);

152 
	}
}

155 #ifdeà
__USE_ATFILE


156 
ssize_t
 
	$__»adlšk©_chk
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

157 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

158 
size_t
 
__buæ’
)

159 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

160 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_®Ÿs
,

161 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

162 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
),

163 
»adlšk©
)

164 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

165 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_chk_w¬n
,

166 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

167 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

168 
size_t
 
__buæ’
), 
__»adlšk©_chk
)

169 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
	`__w¬Ç‰r
 ("readlinkat called with bigger "

173 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
ssize_t


174 
	`__NTH
 (
	$»adlšk©
 (
__fd
, 
__cÚ¡
 *
__»¡riù
 
__·th
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
))

177 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

179 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

180  
	`__»adlšk©_chk
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

182 ià(
__Ën
 > 
	`__bos
 (
__buf
))

183  
	`__»adlšk©_chk_w¬n
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
,

184 
	`__bos
 (
__buf
));

186  
	`__»adlšk©_®Ÿs
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
);

187 
	}
}

190 *
	$__g‘cwd_chk
 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
)

191 
__THROW
 
__wur
;

192 *
	`__REDIRECT_NTH
 (
__g‘cwd_®Ÿs
,

193 (*
__buf
, 
size_t
 
__size
), 
g‘cwd
è
__wur
;

194 *
	`__REDIRECT_NTH
 (
__g‘cwd_chk_w¬n
,

195 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
),

196 
__g‘cwd_chk
)

197 
__wur
 
	`__w¬Ç‰r
 ("getcwd caller with bigger†engthhan size of "

200 
__ex‹º_®ways_šlše
 
__wur
 *

201 
	`__NTH
 (
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
))

203 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

205 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
))

206  
	`__g‘cwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

208 ià(
__size
 > 
	`__bos
 (
__buf
))

209  
	`__g‘cwd_chk_w¬n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

211  
	`__g‘cwd_®Ÿs
 (
__buf
, 
__size
);

212 
	}
}

214 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


215 *
	$__g‘wd_chk
 (*
__buf
, 
size_t
 
buæ’
)

216 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

217 *
	`__REDIRECT_NTH
 (
__g‘wd_w¬n
, (*
__buf
), 
g‘wd
)

218 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("please use getcwd instead,‡s getwd "

221 
__ex‹º_®ways_šlše
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
 *

222 
	`__NTH
 (
	$g‘wd
 (*
__buf
))

224 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

225  
	`__g‘wd_chk
 (
__buf
, 
	`__bos
 (__buf));

226  
	`__g‘wd_w¬n
 (
__buf
);

227 
	}
}

230 
size_t
 
	$__cÚf¡r_chk
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

231 
size_t
 
__buæ’
è
__THROW
;

232 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_®Ÿs
, (
__Çme
, *
__buf
,

233 
size_t
 
__Ën
), 
cÚf¡r
);

234 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_chk_w¬n
,

235 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

236 
size_t
 
__buæ’
), 
__cÚf¡r_chk
)

237 
	`__w¬Ç‰r
 ("confstr called with bigger†engthhan size of destination "

240 
__ex‹º_®ways_šlše
 
size_t


241 
	`__NTH
 (
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
))

243 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

245 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

246  
	`__cÚf¡r_chk
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

248 ià(
	`__bos
 (
__buf
è< 
__Ën
)

249  
	`__cÚf¡r_chk_w¬n
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

251  
	`__cÚf¡r_®Ÿs
 (
__Çme
, 
__buf
, 
__Ën
);

252 
	}
}

255 
	$__g‘groups_chk
 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
)

256 
__THROW
 
__wur
;

257 
	`__REDIRECT_NTH
 (
__g‘groups_®Ÿs
, (
__size
, 
__gid_t
 
__li¡
[]),

258 
g‘groups
è
__wur
;

259 
	`__REDIRECT_NTH
 (
__g‘groups_chk_w¬n
,

260 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
),

261 
__g‘groups_chk
)

262 
__wur
 
	`__w¬Ç‰r
 ("getgroups called with bigger group counthan what "

265 
__ex‹º_®ways_šlše
 

266 
	`__NTH
 (
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]))

268 ià(
	`__bos
 (
__li¡
è!ğ(
size_t
) -1)

270 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
) || __size < 0)

271  
	`__g‘groups_chk
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

273 ià(
__size
 *  (
__gid_t
è> 
	`__bos
 (
__li¡
))

274  
	`__g‘groups_chk_w¬n
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

276  
	`__g‘groups_®Ÿs
 (
__size
, 
__li¡
);

277 
	}
}

280 
	$__‰yÇme_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

281 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

282 
	`__REDIRECT_NTH
 (
__‰yÇme_r_®Ÿs
, (
__fd
, *
__buf
,

283 
size_t
 
__buæ’
), 
‰yÇme_r
)

284 
	`__nÚnuÎ
 ((2));

285 
	`__REDIRECT_NTH
 (
__‰yÇme_r_chk_w¬n
,

286 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

287 
size_t
 
__Ä—l
), 
__‰yÇme_r_chk
)

288 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ttyname_r called with bigger buflenhan "

291 
__ex‹º_®ways_šlše
 

292 
	`__NTH
 (
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

294 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

296 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

297  
	`__‰yÇme_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

299 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

300  
	`__‰yÇme_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

302  
	`__‰yÇme_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

303 
	}
}

306 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


307 
	$__g‘logš_r_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

308 
	`__nÚnuÎ
 ((1));

309 
	`__REDIRECT
 (
__g‘logš_r_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

310 
g‘logš_r
è
	`__nÚnuÎ
 ((1));

311 
	`__REDIRECT
 (
__g‘logš_r_chk_w¬n
,

312 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

313 
__g‘logš_r_chk
)

314 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("getlogin_r called with bigger buflenhan "

317 
__ex‹º_®ways_šlše
 

318 
	$g‘logš_r
 (*
__buf
, 
size_t
 
__buæ’
)

320 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

322 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

323  
	`__g‘logš_r_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

325 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

326  
	`__g‘logš_r_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

328  
	`__g‘logš_r_®Ÿs
 (
__buf
, 
__buæ’
);

329 
	}
}

333 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98


334 
	$__g‘ho¡Çme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

335 
__THROW
 
	`__nÚnuÎ
 ((1));

336 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

337 
g‘ho¡Çme
è
	`__nÚnuÎ
 ((1));

338 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_chk_w¬n
,

339 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

340 
__g‘ho¡Çme_chk
)

341 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("gethostname called with bigger buflenhan "

344 
__ex‹º_®ways_šlše
 

345 
	`__NTH
 (
	$g‘ho¡Çme
 (*
__buf
, 
size_t
 
__buæ’
))

347 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

349 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

350  
	`__g‘ho¡Çme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

352 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

353  
	`__g‘ho¡Çme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

355  
	`__g‘ho¡Çme_®Ÿs
 (
__buf
, 
__buæ’
);

356 
	}
}

360 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

361 
	$__g‘domašÇme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

362 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

363 
	`__REDIRECT_NTH
 (
__g‘domašÇme_®Ÿs
, (*
__buf
,

364 
size_t
 
__buæ’
),

365 
g‘domašÇme
è
	`__nÚnuÎ
 ((1)è
__wur
;

366 
	`__REDIRECT_NTH
 (
__g‘domašÇme_chk_w¬n
,

367 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

368 
__g‘domašÇme_chk
)

369 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("getdomainname called with bigger "

373 
__ex‹º_®ways_šlše
 

374 
	`__NTH
 (
	$g‘domašÇme
 (*
__buf
, 
size_t
 
__buæ’
))

376 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

378 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

379  
	`__g‘domašÇme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

381 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

382  
	`__g‘domašÇme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

384  
	`__g‘domašÇme_®Ÿs
 (
__buf
, 
__buæ’
);

385 
	}
}

	@/usr/include/endian.h

19 #iâdef 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<ã©u»s.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<b™s/’dŸn.h
>

41 #iâdeà
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

54 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

59 #ifdeà
__USE_BSD


61 
	~<b™s/by‹sw­.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è(x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è(x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è(x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è(x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è(x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

19 #iâdef 
_FEATURES_H


20 
	#_FEATURES_H
 1

	)

95 #undeà
__USE_ISOC99


96 #undeà
__USE_ISOC95


97 #undeà
__USE_POSIX


98 #undeà
__USE_POSIX2


99 #undeà
__USE_POSIX199309


100 #undeà
__USE_POSIX199506


101 #undeà
__USE_XOPEN


102 #undeà
__USE_XOPEN_EXTENDED


103 #undeà
__USE_UNIX98


104 #undeà
__USE_XOPEN2K


105 #undeà
__USE_XOPEN2K8


106 #undeà
__USE_LARGEFILE


107 #undeà
__USE_LARGEFILE64


108 #undeà
__USE_FILE_OFFSET64


109 #undeà
__USE_BSD


110 #undeà
__USE_SVID


111 #undeà
__USE_MISC


112 #undeà
__USE_ATFILE


113 #undeà
__USE_GNU


114 #undeà
__USE_REENTRANT


115 #undeà
__USE_FORTIFY_LEVEL


116 #undeà
__FAVOR_BSD


117 #undeà
__KERNEL_STRICT_NAMES


121 #iâdeà
_LOOSE_KERNEL_NAMES


122 
	#__KERNEL_STRICT_NAMES


	)

126 
	#__USE_ANSI
 1

	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

144 #ià
defšed
 
_BSD_SOURCE
 && \

145 !(
defšed
 
	g_POSIX_SOURCE
 || defšed 
	g_POSIX_C_SOURCE
 || \

146 
defšed
 
	g_XOPEN_SOURCE
 || defšed 
	g_XOPEN_SOURCE_EXTENDED
 || \

147 
defšed
 
	g_GNU_SOURCE
 || defšed 
	g_SVID_SOURCE
)

148 
	#__FAVOR_BSD
 1

	)

152 #ifdeà
_GNU_SOURCE


153 #undeà
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #undeà
_POSIX_SOURCE


156 
	#_POSIX_SOURCE
 1

	)

157 #undeà
_POSIX_C_SOURCE


158 
	#_POSIX_C_SOURCE
 200809L

	)

159 #undeà
_XOPEN_SOURCE


160 
	#_XOPEN_SOURCE
 700

	)

161 #undeà
_XOPEN_SOURCE_EXTENDED


162 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

163 #undeà
_LARGEFILE64_SOURCE


164 
	#_LARGEFILE64_SOURCE
 1

	)

165 #undeà
_BSD_SOURCE


166 
	#_BSD_SOURCE
 1

	)

167 #undeà
_SVID_SOURCE


168 
	#_SVID_SOURCE
 1

	)

169 #undeà
_ATFILE_SOURCE


170 
	#_ATFILE_SOURCE
 1

	)

175 #ià(!
defšed
 
__STRICT_ANSI__
 && !defšed 
_ISOC99_SOURCE
 && \

176 !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 && \

177 !
defšed
 
	g_XOPEN_SOURCE
 && !defšed 
	g_XOPEN_SOURCE_EXTENDED
 && \

178 !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
)

179 
	#_BSD_SOURCE
 1

	)

180 
	#_SVID_SOURCE
 1

	)

187 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

188 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

189 
	#__USE_ISOC99
 1

	)

193 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

194 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

195 
	#__USE_ISOC95
 1

	)

200 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

201 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

202 
	#_POSIX_SOURCE
 1

	)

203 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

204 
	#_POSIX_C_SOURCE
 2

	)

205 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

206 
	#_POSIX_C_SOURCE
 199506L

	)

207 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

208 
	#_POSIX_C_SOURCE
 200112L

	)

210 
	#_POSIX_C_SOURCE
 200809L

	)

212 
	#__USE_POSIX_IMPLICITLY
 1

	)

215 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


216 
	#__USE_POSIX
 1

	)

219 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


220 
	#__USE_POSIX2
 1

	)

223 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

224 
	#__USE_POSIX199309
 1

	)

227 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

228 
	#__USE_POSIX199506
 1

	)

231 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

232 
	#__USE_XOPEN2K
 1

	)

233 #undeà
__USE_ISOC99


234 
	#__USE_ISOC99
 1

	)

237 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

238 
	#__USE_XOPEN2K8
 1

	)

239 #undeà
_ATFILE_SOURCE


240 
	#_ATFILE_SOURCE
 1

	)

243 #ifdef 
_XOPEN_SOURCE


244 
	#__USE_XOPEN
 1

	)

245 #ià(
_XOPEN_SOURCE
 - 0) >= 500

246 
	#__USE_XOPEN_EXTENDED
 1

	)

247 
	#__USE_UNIX98
 1

	)

248 #undeà
_LARGEFILE_SOURCE


249 
	#_LARGEFILE_SOURCE
 1

	)

250 #ià(
_XOPEN_SOURCE
 - 0) >= 600

251 #ià(
_XOPEN_SOURCE
 - 0) >= 700

252 
	#__USE_XOPEN2K8
 1

	)

254 
	#__USE_XOPEN2K
 1

	)

255 #undeà
__USE_ISOC99


256 
	#__USE_ISOC99
 1

	)

259 #ifdeà
_XOPEN_SOURCE_EXTENDED


260 
	#__USE_XOPEN_EXTENDED
 1

	)

265 #ifdeà
_LARGEFILE_SOURCE


266 
	#__USE_LARGEFILE
 1

	)

269 #ifdeà
_LARGEFILE64_SOURCE


270 
	#__USE_LARGEFILE64
 1

	)

273 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

274 
	#__USE_FILE_OFFSET64
 1

	)

277 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


278 
	#__USE_MISC
 1

	)

281 #ifdef 
_BSD_SOURCE


282 
	#__USE_BSD
 1

	)

285 #ifdef 
_SVID_SOURCE


286 
	#__USE_SVID
 1

	)

289 #ifdef 
_ATFILE_SOURCE


290 
	#__USE_ATFILE
 1

	)

293 #ifdef 
_GNU_SOURCE


294 
	#__USE_GNU
 1

	)

297 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


298 
	#__USE_REENTRANT
 1

	)

301 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

302 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

303 #ià
_FORTIFY_SOURCE
 > 1

304 
	#__USE_FORTIFY_LEVEL
 2

	)

306 
	#__USE_FORTIFY_LEVEL
 1

	)

309 
	#__USE_FORTIFY_LEVEL
 0

	)

313 
	~<b™s/´edefs.h
>

316 
	#__STDC_ISO_10646__
 200009L

	)

324 #undeà
__GNU_LIBRARY__


325 
	#__GNU_LIBRARY__
 6

	)

329 
	#__GLIBC__
 2

	)

330 
	#__GLIBC_MINOR__
 11

	)

332 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

333 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

336 #ià
defšed
 
__GNUC__
 \

337 || (
defšed
 
	g__PGI
 && defšed 
	g__i386__
 ) \

338 || (
defšed
 
	g__INTEL_COMPILER
 && (defšed 
	g__i386__
 || defšed 
	g__Ÿ64__
)) \

339 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

340 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

344 #iâdeà
__ASSEMBLER__


345 #iâdeà
_SYS_CDEFS_H


346 
	~<sys/cdefs.h
>

351 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


352 
	#__USE_LARGEFILE
 1

	)

353 
	#__USE_LARGEFILE64
 1

	)

359 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

360 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

361 && 
defšed
 
	g__ex‹º_šlše


362 
	#__USE_EXTERN_INLINES
 1

	)

367 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

368 && (
defšed
 
	g_LIBC
 || !defšed 
	g__OPTIMIZE_SIZE__
è&& !defšed 
	g__NO_INLINE__
 \

369 && 
defšed
 
	g__ex‹º_šlše


370 
	#__USE_EXTERN_INLINES_IN_LIBC
 1

	)

378 
	~<gnu/¡ubs.h
>

	@/usr/include/getopt.h

21 #iâdeà
_GETOPT_H


23 #iâdeà
__Ãed_g‘İt


24 
	#_GETOPT_H
 1

	)

34 #ià!
defšed
 
__GNU_LIBRARY__


35 
	~<ùy³.h
>

38 #iâdeà
__THROW


39 #iâdeà
__GNUC_PREREQ


40 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

42 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

43 
	#__THROW
 
	`throw
 ()

	)

45 
	#__THROW


	)

49 #ifdef 
__ılu¥lus


59 *
İrg
;

73 
İtšd
;

78 
İ‹¼
;

82 
İtİt
;

84 #iâdeà
__Ãed_g‘İt


106 
	sİtiÚ


108 cÚ¡ *
	gÇme
;

111 
	ghas_¬g
;

112 *
	gæag
;

113 
	gv®
;

118 
	#no_¬gum’t
 0

	)

119 
	#»quœed_¬gum’t
 1

	)

120 
	#İtiÚ®_¬gum’t
 2

	)

148 #ifdeà
__GNU_LIBRARY__


152 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

153 
__THROW
;

155 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

156 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


160 #ifdeà
__REDIRECT


161 
__REDIRECT
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

162 cÚ¡ *
__shÜtİts
),

163 
__posix_g‘İt
è
__THROW
;

165 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

166 cÚ¡ *
__shÜtİts
è
__THROW
;

167 
	#g‘İt
 
__posix_g‘İt


	)

171 
g‘İt
 ();

174 #iâdeà
__Ãed_g‘İt


175 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

176 cÚ¡ *
__shÜtİts
,

177 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

178 
__THROW
;

179 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

180 cÚ¡ *
__shÜtİts
,

181 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

182 
__THROW
;

186 #ifdef 
__ılu¥lus


191 #undeà
__Ãed_g‘İt


	@/usr/include/libio.h

29 #iâdeà
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_cÚfig.h
>

34 
	#_IO_pos_t
 
_G_åos_t


	)

35 
	#_IO_åos_t
 
_G_åos_t


	)

36 
	#_IO_åos64_t
 
_G_åos64_t


	)

37 
	#_IO_size_t
 
_G_size_t


	)

38 
	#_IO_ssize_t
 
_G_ssize_t


	)

39 
	#_IO_off_t
 
_G_off_t


	)

40 
	#_IO_off64_t
 
_G_off64_t


	)

41 
	#_IO_pid_t
 
_G_pid_t


	)

42 
	#_IO_uid_t
 
_G_uid_t


	)

43 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

44 
	#_IO_HAVE_SYS_WAIT
 
_G_HAVE_SYS_WAIT


	)

45 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

46 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

47 
	#_IO_va_li¡
 
_G_va_li¡


	)

48 
	#_IO_wšt_t
 
_G_wšt_t


	)

50 #ifdeà
_G_NEED_STDARG_H


52 
	#__Ãed___va_li¡


	)

53 
	~<¡d¬g.h
>

54 #ifdeà
__GNUC_VA_LIST


55 #undeà
_IO_va_li¡


56 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

60 #iâdeà
__P


61 #ià
_G_HAVE_SYS_CDEFS


62 
	~<sys/cdefs.h
>

64 #ifdeà
__STDC__


65 
	#__P
(
p
è
	)
p

66 
	#__PMT
(
p
è
	)
p

68 
	#__P
(
p
è()

	)

69 
	#__PMT
(
p
è()

	)

75 #iâdeà
_PARAMS


76 
	#_PARAMS
(
´Ùos
è
	`__P
ÕrÙos)

	)

79 #iâdeà
__STDC__


81 cÚ¡

	)

84 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

85 #iâdeà
_G_HAVE_PRINTF_FP


86 
	#_IO_USE_DTOA
 1

	)

89 #iâdeà
EOF


90 
	#EOF
 (-1)

	)

92 #iâdeà
NULL


93 #ià
defšed
 
__GNUG__
 && \

94 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

95 
	#NULL
 (
__nuÎ
)

	)

97 #ià!
defšed
(
__ılu¥lus
)

98 
	#NULL
 ((*)0)

	)

100 
	#NULL
 (0)

	)

105 
	#_IOS_INPUT
 1

	)

106 
	#_IOS_OUTPUT
 2

	)

107 
	#_IOS_ATEND
 4

	)

108 
	#_IOS_APPEND
 8

	)

109 
	#_IOS_TRUNC
 16

	)

110 
	#_IOS_NOCREATE
 32

	)

111 
	#_IOS_NOREPLACE
 64

	)

112 
	#_IOS_BIN
 128

	)

120 
	#_IO_MAGIC
 0xFBAD0000

	)

121 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

122 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

123 
	#_IO_USER_BUF
 1

	)

124 
	#_IO_UNBUFFERED
 2

	)

125 
	#_IO_NO_READS
 4

	)

126 
	#_IO_NO_WRITES
 8

	)

127 
	#_IO_EOF_SEEN
 0x10

	)

128 
	#_IO_ERR_SEEN
 0x20

	)

129 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

130 
	#_IO_LINKED
 0x80

	)

131 
	#_IO_IN_BACKUP
 0x100

	)

132 
	#_IO_LINE_BUF
 0x200

	)

133 
	#_IO_TIED_PUT_GET
 0x400

	)

134 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

135 
	#_IO_IS_APPENDING
 0x1000

	)

136 
	#_IO_IS_FILEBUF
 0x2000

	)

137 
	#_IO_BAD_SEEN
 0x4000

	)

138 
	#_IO_USER_LOCK
 0x8000

	)

140 
	#_IO_FLAGS2_MMAP
 1

	)

141 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

142 #ifdeà
_LIBC


143 
	#_IO_FLAGS2_FORTIFY
 4

	)

145 
	#_IO_FLAGS2_USER_WBUF
 8

	)

146 #ifdeà
_LIBC


147 
	#_IO_FLAGS2_SCANF_STD
 16

	)

151 
	#_IO_SKIPWS
 01

	)

152 
	#_IO_LEFT
 02

	)

153 
	#_IO_RIGHT
 04

	)

154 
	#_IO_INTERNAL
 010

	)

155 
	#_IO_DEC
 020

	)

156 
	#_IO_OCT
 040

	)

157 
	#_IO_HEX
 0100

	)

158 
	#_IO_SHOWBASE
 0200

	)

159 
	#_IO_SHOWPOINT
 0400

	)

160 
	#_IO_UPPERCASE
 01000

	)

161 
	#_IO_SHOWPOS
 02000

	)

162 
	#_IO_SCIENTIFIC
 04000

	)

163 
	#_IO_FIXED
 010000

	)

164 
	#_IO_UNITBUF
 020000

	)

165 
	#_IO_STDIO
 040000

	)

166 
	#_IO_DONT_CLOSE
 0100000

	)

167 
	#_IO_BOOLALPHA
 0200000

	)

170 
_IO_jump_t
; 
	g_IO_FILE
;

173 #ifdeà
_IO_MTSAFE_IO


174 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

175 
	~<b™s/¡dio-lock.h
>

180 
	t_IO_lock_t
;

186 
	s_IO_m¬k”
 {

187 
_IO_m¬k”
 *
	m_Ãxt
;

188 
_IO_FILE
 *
	m_sbuf
;

192 
	m_pos
;

194 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

195 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

196 
	mpublic
:

197 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

198 ~
¡»amm¬k”
();

199 
§všg
(è{  
	m_¥os
 == -2; }

200 
d–
(
¡»amm¬k”
&);

201 
d–
();

206 
	e__codecvt_»suÉ


208 
	m__codecvt_ok
,

209 
	m__codecvt_·¹Ÿl
,

210 
	m__codecvt_”rÜ
,

211 
	m__codecvt_nocÚv


214 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


217 
	s_IO_codecvt


219 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

220 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

221 
	m__mb¡©e_t
 *,

222 cÚ¡ 
	mwch¬_t
 *,

223 cÚ¡ 
	mwch¬_t
 *,

224 cÚ¡ 
	mwch¬_t
 **, *,

226 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

227 
	m__mb¡©e_t
 *, *,

229 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

230 
	m__mb¡©e_t
 *,

232 cÚ¡ **, 
	mwch¬_t
 *,

233 
	mwch¬_t
 *, wchar_t **);

234 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

235 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

236 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

237 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

238 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

240 
_IO_icÚv_t
 
	m__cd_š
;

241 
_IO_icÚv_t
 
	m__cd_out
;

245 
	s_IO_wide_d©a


247 
wch¬_t
 *
	m_IO_»ad_±r
;

248 
wch¬_t
 *
	m_IO_»ad_’d
;

249 
wch¬_t
 *
	m_IO_»ad_ba£
;

250 
wch¬_t
 *
	m_IO_wr™e_ba£
;

251 
wch¬_t
 *
	m_IO_wr™e_±r
;

252 
wch¬_t
 *
	m_IO_wr™e_’d
;

253 
wch¬_t
 *
	m_IO_buf_ba£
;

254 
wch¬_t
 *
	m_IO_buf_’d
;

256 
wch¬_t
 *
	m_IO_§ve_ba£
;

257 
wch¬_t
 *
	m_IO_backup_ba£
;

259 
wch¬_t
 *
	m_IO_§ve_’d
;

261 
__mb¡©e_t
 
	m_IO_¡©e
;

262 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

263 
_IO_codecvt
 
	m_codecvt
;

265 
wch¬_t
 
	m_shÜtbuf
[1];

267 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

271 
	s_IO_FILE
 {

272 
	m_æags
;

273 
	#_IO_fe_æags
 
_æags


	)

277 * 
	m_IO_»ad_±r
;

278 * 
	m_IO_»ad_’d
;

279 * 
	m_IO_»ad_ba£
;

280 * 
	m_IO_wr™e_ba£
;

281 * 
	m_IO_wr™e_±r
;

282 * 
	m_IO_wr™e_’d
;

283 * 
	m_IO_buf_ba£
;

284 * 
	m_IO_buf_’d
;

286 *
	m_IO_§ve_ba£
;

287 *
	m_IO_backup_ba£
;

288 *
	m_IO_§ve_’d
;

290 
_IO_m¬k”
 *
	m_m¬k”s
;

292 
_IO_FILE
 *
	m_chaš
;

294 
	m_f’o
;

296 
	m_blksize
;

298 
	m_æags2
;

300 
_IO_off_t
 
	m_Şd_off£t
;

302 
	#__HAVE_COLUMN


	)

304 
	m_cur_cŞumn
;

305 sigÃd 
	m_vbË_off£t
;

306 
	m_shÜtbuf
[1];

310 
_IO_lock_t
 *
	m_lock
;

311 #ifdeà
_IO_USE_OLD_IO_FILE


314 
	s_IO_FILE_com¶‘e


316 
_IO_FILE
 
	m_fe
;

318 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

319 
_IO_off64_t
 
	m_off£t
;

320 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


322 
_IO_codecvt
 *
	m_codecvt
;

323 
_IO_wide_d©a
 *
	m_wide_d©a
;

324 
_IO_FILE
 *
	m_ä“»s_li¡
;

325 *
	m_ä“»s_buf
;

326 
size_t
 
	m_ä“»s_size
;

328 *
	m__·d1
;

329 *
	m__·d2
;

330 *
	m__·d3
;

331 *
	m__·d4
;

332 
size_t
 
	m__·d5
;

334 
	m_mode
;

336 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

340 #iâdeà
__ılu¥lus


341 
_IO_FILE
 
	t_IO_FILE
;

344 
	g_IO_FILE_¶us
;

346 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

347 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

348 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

349 #iâdeà
_LIBC


350 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

351 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

352 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

354 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

355 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

356 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

364 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

372 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, 
	t__cÚ¡
 *
	t__buf
,

373 
	tsize_t
 
	t__n
);

381 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

384 
	t__io_şo£_â
 (*
	t__cook›
);

387 #ifdeà
_GNU_SOURCE


389 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

390 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

391 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

392 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

397 
__io_»ad_â
 *
	m»ad
;

398 
__io_wr™e_â
 *
	mwr™e
;

399 
__io_£ek_â
 *
	m£ek
;

400 
__io_şo£_â
 *
	mşo£
;

401 } 
	t_IO_cook›_io_funùiÚs_t
;

402 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

404 
	g_IO_cook›_fe
;

407 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

408 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

412 #ifdeà
__ılu¥lus


416 
__und”æow
 (
_IO_FILE
 *);

417 
__uæow
 (
_IO_FILE
 *);

418 
__ov”æow
 (
_IO_FILE
 *, );

419 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


420 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

421 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

422 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

425 #ià 
__GNUC__
 >= 3

426 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

428 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

431 
	#_IO_g‘c_uÆocked
(
_å
) \

432 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

433 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

434 
	#_IO_³ekc_uÆocked
(
_å
) \

435 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

436 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

437 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

438 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

439 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

440 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

441 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

443 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


444 
	#_IO_g‘wc_uÆocked
(
_å
) \

445 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

446 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

447 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

448 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

449 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

450 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

451 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

452 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

453 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

454 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

457 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

458 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

460 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

461 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

462 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

463 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

465 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

468 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

469 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

471 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

472 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

473 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

475 #ifdeà
_IO_MTSAFE_IO


476 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

477 
	#_IO_æockfe
(
_å
) \

478 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

479 
	#_IO_fuÆockfe
(
_å
) \

480 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

482 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

483 
	#_IO_æockfe
(
_å
è

	)

484 
	#_IO_fuÆockfe
(
_å
è

	)

485 
	#_IO_árylockfe
(
_å
è

	)

486 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

487 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

490 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

491 
_IO_va_li¡
, *
__»¡riù
);

492 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

493 
_IO_va_li¡
);

494 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

495 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

497 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

498 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

500 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

502 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


503 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

504 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

505 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

506 #ià
__GNUC__
 >= 2

509 #ià
defšed
 
_LIBC
 && defšed 
SHARED


510 
	~<shlib-com·t.h
>

511 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

512 
	#_IO_fwide_maybe_šcom·tibË
 \

513 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

514 cÚ¡ 
_IO_¡dš_u£d
;

515 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

518 #iâdeà
_IO_fwide_maybe_šcom·tibË


519 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

523 
	#_IO_fwide
(
__å
, 
__mode
) \

524 ({ 
__»suÉ
 = (
__mode
); \

525 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

527 ià((
__å
)->
_mode
 == 0) \

529 (
__å
)->
_mode
 = -1; \

530 
__»suÉ
 = (
__å
)->
_mode
; \

532 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

533 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

535 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

536 
__»suÉ
; })

	)

539 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

540 
_IO_va_li¡
, *
__»¡riù
);

541 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

542 
_IO_va_li¡
);

543 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

544 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

547 #ifdeà
__LDBL_COMPAT


548 
	~<b™s/libio-ldbl.h
>

551 #ifdeà
__ılu¥lus


	@/usr/include/linux/ioctl.h

1 #iâdeà
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/ioùl.h
>

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

	@/usr/include/stdint.h

23 #iâdeà
_STDINT_H


24 
	#_STDINT_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wch¬.h
>

28 
	~<b™s/wÜdsize.h
>

35 #iâdeà
__št8_t_defšed


36 
	#__št8_t_defšed


	)

37 sigÃd 
	tšt8_t
;

38 
	tšt16_t
;

39 
	tšt32_t
;

40 #ià
__WORDSIZE
 == 64

41 
	tšt64_t
;

43 
__ex‹nsiÚ__


44 
	tšt64_t
;

49 
	tušt8_t
;

50 
	tušt16_t
;

51 #iâdeà
__ušt32_t_defšed


52 
	tušt32_t
;

53 
	#__ušt32_t_defšed


	)

55 #ià
__WORDSIZE
 == 64

56 
	tušt64_t
;

58 
__ex‹nsiÚ__


59 
	tušt64_t
;

66 sigÃd 
	tšt_Ëa¡8_t
;

67 
	tšt_Ëa¡16_t
;

68 
	tšt_Ëa¡32_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_Ëa¡64_t
;

72 
__ex‹nsiÚ__


73 
	tšt_Ëa¡64_t
;

77 
	tušt_Ëa¡8_t
;

78 
	tušt_Ëa¡16_t
;

79 
	tušt_Ëa¡32_t
;

80 #ià
__WORDSIZE
 == 64

81 
	tušt_Ëa¡64_t
;

83 
__ex‹nsiÚ__


84 
	tušt_Ëa¡64_t
;

91 sigÃd 
	tšt_ç¡8_t
;

92 #ià
__WORDSIZE
 == 64

93 
	tšt_ç¡16_t
;

94 
	tšt_ç¡32_t
;

95 
	tšt_ç¡64_t
;

97 
	tšt_ç¡16_t
;

98 
	tšt_ç¡32_t
;

99 
__ex‹nsiÚ__


100 
	tšt_ç¡64_t
;

104 
	tušt_ç¡8_t
;

105 #ià
__WORDSIZE
 == 64

106 
	tušt_ç¡16_t
;

107 
	tušt_ç¡32_t
;

108 
	tušt_ç¡64_t
;

110 
	tušt_ç¡16_t
;

111 
	tušt_ç¡32_t
;

112 
__ex‹nsiÚ__


113 
	tušt_ç¡64_t
;

118 #ià
__WORDSIZE
 == 64

119 #iâdeà
__šŒ_t_defšed


120 
	tšŒ_t
;

121 
	#__šŒ_t_defšed


	)

123 
	tušŒ_t
;

125 #iâdeà
__šŒ_t_defšed


126 
	tšŒ_t
;

127 
	#__šŒ_t_defšed


	)

129 
	tušŒ_t
;

134 #ià
__WORDSIZE
 == 64

135 
	tštmax_t
;

136 
	tuštmax_t
;

138 
__ex‹nsiÚ__


139 
	tštmax_t
;

140 
__ex‹nsiÚ__


141 
	tuštmax_t
;

147 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_LIMIT_MACROS


149 #ià
__WORDSIZE
 == 64

150 
	#__INT64_C
(
c
èø## 
L


	)

151 
	#__UINT64_C
(
c
èø## 
UL


	)

153 
	#__INT64_C
(
c
èø## 
LL


	)

154 
	#__UINT64_C
(
c
èø## 
ULL


	)

160 
	#INT8_MIN
 (-128)

	)

161 
	#INT16_MIN
 (-32767-1)

	)

162 
	#INT32_MIN
 (-2147483647-1)

	)

163 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

165 
	#INT8_MAX
 (127)

	)

166 
	#INT16_MAX
 (32767)

	)

167 
	#INT32_MAX
 (2147483647)

	)

168 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

171 
	#UINT8_MAX
 (255)

	)

172 
	#UINT16_MAX
 (65535)

	)

173 
	#UINT32_MAX
 (4294967295U)

	)

174 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

178 
	#INT_LEAST8_MIN
 (-128)

	)

179 
	#INT_LEAST16_MIN
 (-32767-1)

	)

180 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

181 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

183 
	#INT_LEAST8_MAX
 (127)

	)

184 
	#INT_LEAST16_MAX
 (32767)

	)

185 
	#INT_LEAST32_MAX
 (2147483647)

	)

186 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

189 
	#UINT_LEAST8_MAX
 (255)

	)

190 
	#UINT_LEAST16_MAX
 (65535)

	)

191 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

192 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

196 
	#INT_FAST8_MIN
 (-128)

	)

197 #ià
__WORDSIZE
 == 64

198 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

199 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

201 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

202 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

204 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

206 
	#INT_FAST8_MAX
 (127)

	)

207 #ià
__WORDSIZE
 == 64

208 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

209 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

211 
	#INT_FAST16_MAX
 (2147483647)

	)

212 
	#INT_FAST32_MAX
 (2147483647)

	)

214 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

217 
	#UINT_FAST8_MAX
 (255)

	)

218 #ià
__WORDSIZE
 == 64

219 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

220 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

222 
	#UINT_FAST16_MAX
 (4294967295U)

	)

223 
	#UINT_FAST32_MAX
 (4294967295U)

	)

225 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

229 #ià
__WORDSIZE
 == 64

230 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

231 
	#INTPTR_MAX
 (9223372036854775807L)

	)

232 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

234 
	#INTPTR_MIN
 (-2147483647-1)

	)

235 
	#INTPTR_MAX
 (2147483647)

	)

236 
	#UINTPTR_MAX
 (4294967295U)

	)

241 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

243 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

246 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

252 #ià
__WORDSIZE
 == 64

253 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

254 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

256 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

257 
	#PTRDIFF_MAX
 (2147483647)

	)

261 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

262 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

265 #ià
__WORDSIZE
 == 64

266 
	#SIZE_MAX
 (18446744073709551615UL)

	)

268 
	#SIZE_MAX
 (4294967295U)

	)

272 #iâdeà
WCHAR_MIN


274 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

275 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

279 
	#WINT_MIN
 (0u)

	)

280 
	#WINT_MAX
 (4294967295u)

	)

287 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_CONSTANT_MACROS


290 
	#INT8_C
(
c
è
	)
c

291 
	#INT16_C
(
c
è
	)
c

292 
	#INT32_C
(
c
è
	)
c

293 #ià
__WORDSIZE
 == 64

294 
	#INT64_C
(
c
èø## 
L


	)

296 
	#INT64_C
(
c
èø## 
LL


	)

300 
	#UINT8_C
(
c
è
	)
c

301 
	#UINT16_C
(
c
è
	)
c

302 
	#UINT32_C
(
c
èø## 
U


	)

303 #ià
__WORDSIZE
 == 64

304 
	#UINT64_C
(
c
èø## 
UL


	)

306 
	#UINT64_C
(
c
èø## 
ULL


	)

310 #ià
__WORDSIZE
 == 64

311 
	#INTMAX_C
(
c
èø## 
L


	)

312 
	#UINTMAX_C
(
c
èø## 
UL


	)

314 
	#INTMAX_C
(
c
èø## 
LL


	)

315 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/sys/select.h

22 #iâdeà
_SYS_SELECT_H


23 
	#_SYS_SELECT_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

31 
	~<b™s/£Ëù.h
>

34 
	~<b™s/sig£t.h
>

36 #iâdeà
__sig£t_t_defšed


37 
	#__sig£t_t_defšed


	)

38 
__sig£t_t
 
	tsig£t_t
;

42 
	#__Ãed_time_t


	)

43 
	#__Ãed_time¥ec


	)

44 
	~<time.h
>

45 
	#__Ãed_timev®


	)

46 
	~<b™s/time.h
>

48 #iâdeà
__su£cÚds_t_defšed


49 
__su£cÚds_t
 
	tsu£cÚds_t
;

50 
	#__su£cÚds_t_defšed


	)

55 
	t__fd_mask
;

58 #undeà
__NFDBITS


59 #undeà
__FDELT


60 #undeà
__FDMASK


62 
	#__NFDBITS
 (8 * (è (
__fd_mask
))

	)

63 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

64 
	#__FDMASK
(
d
è((
__fd_mask
è1 << ((dè% 
__NFDBITS
))

	)

71 #ifdeà
__USE_XOPEN


72 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

75 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

76 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

78 } 
	tfd_£t
;

81 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

83 #ifdeà
__USE_MISC


85 
__fd_mask
 
	tfd_mask
;

88 
	#NFDBITS
 
__NFDBITS


	)

93 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

94 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

95 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

96 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

99 
__BEGIN_DECLS


109 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

110 
fd_£t
 *
__»¡riù
 
__wr™efds
,

111 
fd_£t
 *
__»¡riù
 
__exû±fds
,

112 
timev®
 *
__»¡riù
 
__timeout
);

114 #ifdeà
__USE_XOPEN2K


121 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

122 
fd_£t
 *
__»¡riù
 
__wr™efds
,

123 
fd_£t
 *
__»¡riù
 
__exû±fds
,

124 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

125 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

128 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

21 #iâdeà
_SYS_SYSMACROS_H


22 
	#_SYS_SYSMACROS_H
 1

	)

24 
	~<ã©u»s.h
>

29 #ifdeà
__GLIBC_HAVE_LONG_LONG


30 
__ex‹nsiÚ__


31 
	$gnu_dev_majÜ
 (
__dev
)

32 
__THROW
;

33 
__ex‹nsiÚ__


34 
	$gnu_dev_mšÜ
 (
__dev
)

35 
__THROW
;

36 
__ex‹nsiÚ__


37 
	$gnu_dev_makedev
 (
__majÜ
,

38 
__mšÜ
)

39 
__THROW
;

41 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES


42 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

43 
	`__NTH
 (
	$gnu_dev_majÜ
 (
__dev
))

45  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

46 
	}
}

48 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

49 
__NTH
 (
	$gnu_dev_mšÜ
 (
__dev
))

51  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

52 
	}
}

54 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

55 
__NTH
 (
	$gnu_dev_makedev
 (
__majÜ
, 
__mšÜ
))

57  ((
__mšÜ
 & 0xffè| ((
__majÜ
 & 0xfff) << 8)

58 | (((è(
__mšÜ
 & ~0xff)) << 12)

59 | (((è(
__majÜ
 & ~0xfff)) << 32));

60 
	}
}

65 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

66 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

67 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/sys/ttydefaults.h

40 #iâdeà
_SYS_TTYDEFAULTS_H_


41 
	#_SYS_TTYDEFAULTS_H_


	)

46 
	#TTYDEF_IFLAG
 (
BRKINT
 | 
ISTRIP
 | 
ICRNL
 | 
IMAXBEL
 | 
IXON
 | 
IXANY
)

	)

47 
	#TTYDEF_OFLAG
 (
OPOST
 | 
ONLCR
 | 
XTABS
)

	)

48 
	#TTYDEF_LFLAG
 (
ECHO
 | 
ICANON
 | 
ISIG
 | 
IEXTEN
 | 
ECHOE
|
ECHOKE
|
ECHOCTL
)

	)

49 
	#TTYDEF_CFLAG
 (
CREAD
 | 
CS7
 | 
PARENB
 | 
HUPCL
)

	)

50 
	#TTYDEF_SPEED
 (
B9600
)

	)

55 
	#CTRL
(
x
è(x&037)

	)

56 
	#CEOF
 
	`CTRL
('d')

	)

57 #ifdeà
_POSIX_VDISABLE


58 
	#CEOL
 
_POSIX_VDISABLE


	)

60 
	#CEOL
 '\0'

	)

62 
	#CERASE
 0177

	)

63 
	#CINTR
 
	`CTRL
('c')

	)

64 #ifdeà
_POSIX_VDISABLE


65 
	#CSTATUS
 
_POSIX_VDISABLE


	)

67 
	#CSTATUS
 '\0'

	)

69 
	#CKILL
 
	`CTRL
('u')

	)

70 
	#CMIN
 1

	)

71 
	#CQUIT
 034

	)

72 
	#CSUSP
 
	`CTRL
('z')

	)

73 
	#CTIME
 0

	)

74 
	#CDSUSP
 
	`CTRL
('y')

	)

75 
	#CSTART
 
	`CTRL
('q')

	)

76 
	#CSTOP
 
	`CTRL
('s')

	)

77 
	#CLNEXT
 
	`CTRL
('v')

	)

78 
	#CDISCARD
 
	`CTRL
('o')

	)

79 
	#CWERASE
 
	`CTRL
('w')

	)

80 
	#CREPRINT
 
	`CTRL
('r')

	)

81 
	#CEOT
 
CEOF


	)

83 
	#CBRK
 
CEOL


	)

84 
	#CRPRNT
 
CREPRINT


	)

85 
	#CFLUSH
 
CDISCARD


	)

93 #ifdeà
TTYDEFCHARS


94 
cc_t
 
	g‰ydefch¬s
[
NCCS
] = {

95 
CEOF
, 
CEOL
, CEOL, 
CERASE
, 
CWERASE
, 
CKILL
, 
CREPRINT
,

96 
_POSIX_VDISABLE
, 
CINTR
, 
CQUIT
, 
CSUSP
, 
CDSUSP
, 
CSTART
, 
CSTOP
, 
CLNEXT
,

97 
CDISCARD
, 
CMIN
, 
CTIME
, 
CSTATUS
, 
_POSIX_VDISABLE


99 #undeà
TTYDEFCHARS


	@/usr/include/sys/ucontext.h

19 #iâdeà
_SYS_UCONTEXT_H


20 
	#_SYS_UCONTEXT_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<sigÇl.h
>

24 
	~<b™s/wÜdsize.h
>

28 
	~<b™s/sigcÚ‹xt.h
>

30 #ià
__WORDSIZE
 == 64

33 
	tg»g_t
;

36 
	#NGREG
 23

	)

39 
g»g_t
 
	tg»g£t_t
[
NGREG
];

41 #ifdeà
__USE_GNU


45 
	mREG_R8
 = 0,

46 
	#REG_R8
 
REG_R8


	)

47 
	mREG_R9
,

48 
	#REG_R9
 
REG_R9


	)

49 
	mREG_R10
,

50 
	#REG_R10
 
REG_R10


	)

51 
	mREG_R11
,

52 
	#REG_R11
 
REG_R11


	)

53 
	mREG_R12
,

54 
	#REG_R12
 
REG_R12


	)

55 
	mREG_R13
,

56 
	#REG_R13
 
REG_R13


	)

57 
	mREG_R14
,

58 
	#REG_R14
 
REG_R14


	)

59 
	mREG_R15
,

60 
	#REG_R15
 
REG_R15


	)

61 
	mREG_RDI
,

62 
	#REG_RDI
 
REG_RDI


	)

63 
	mREG_RSI
,

64 
	#REG_RSI
 
REG_RSI


	)

65 
	mREG_RBP
,

66 
	#REG_RBP
 
REG_RBP


	)

67 
	mREG_RBX
,

68 
	#REG_RBX
 
REG_RBX


	)

69 
	mREG_RDX
,

70 
	#REG_RDX
 
REG_RDX


	)

71 
	mREG_RAX
,

72 
	#REG_RAX
 
REG_RAX


	)

73 
	mREG_RCX
,

74 
	#REG_RCX
 
REG_RCX


	)

75 
	mREG_RSP
,

76 
	#REG_RSP
 
REG_RSP


	)

77 
	mREG_RIP
,

78 
	#REG_RIP
 
REG_RIP


	)

79 
	mREG_EFL
,

80 
	#REG_EFL
 
REG_EFL


	)

81 
	mREG_CSGSFS
,

82 
	#REG_CSGSFS
 
REG_CSGSFS


	)

83 
	mREG_ERR
,

84 
	#REG_ERR
 
REG_ERR


	)

85 
	mREG_TRAPNO
,

86 
	#REG_TRAPNO
 
REG_TRAPNO


	)

87 
	mREG_OLDMASK
,

88 
	#REG_OLDMASK
 
REG_OLDMASK


	)

89 
	mREG_CR2


90 
	#REG_CR2
 
REG_CR2


	)

94 
	s_libc_åx»g


96 
	msignifiÿnd
[4];

97 
	mexpÚ’t
;

98 
	m·ddšg
[3];

101 
	s_libc_xmm»g


103 
__ušt32_t
 
	m–em’t
[4];

106 
	s_libc_å¡©e


109 
__ušt16_t
 
	mcwd
;

110 
__ušt16_t
 
	mswd
;

111 
__ušt16_t
 
	máw
;

112 
__ušt16_t
 
	mfİ
;

113 
__ušt64_t
 
	mr
;

114 
__ušt64_t
 
	mrdp
;

115 
__ušt32_t
 
	mmxc¤
;

116 
__ušt32_t
 
	mmxü_mask
;

117 
_libc_åx»g
 
	m_¡
[8];

118 
_libc_xmm»g
 
	m_xmm
[16];

119 
__ušt32_t
 
	m·ddšg
[24];

123 
_libc_å¡©e
 *
	tå»g£t_t
;

128 
g»g£t_t
 
	mg»gs
;

130 
å»g£t_t
 
	må»gs
;

131 
	m__»£rved1
 [8];

132 } 
	tmcÚ‹xt_t
;

135 
	sucÚ‹xt


137 
	muc_æags
;

138 
ucÚ‹xt
 *
	muc_lšk
;

139 
¡ack_t
 
	muc_¡ack
;

140 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

141 
__sig£t_t
 
	muc_sigmask
;

142 
_libc_å¡©e
 
	m__å»gs_mem
;

143 } 
	tucÚ‹xt_t
;

148 
	tg»g_t
;

151 
	#NGREG
 19

	)

154 
g»g_t
 
	tg»g£t_t
[
NGREG
];

156 #ifdeà
__USE_GNU


160 
	mREG_GS
 = 0,

161 
	#REG_GS
 
REG_GS


	)

162 
	mREG_FS
,

163 
	#REG_FS
 
REG_FS


	)

164 
	mREG_ES
,

165 
	#REG_ES
 
REG_ES


	)

166 
	mREG_DS
,

167 
	#REG_DS
 
REG_DS


	)

168 
	mREG_EDI
,

169 
	#REG_EDI
 
REG_EDI


	)

170 
	mREG_ESI
,

171 
	#REG_ESI
 
REG_ESI


	)

172 
	mREG_EBP
,

173 
	#REG_EBP
 
REG_EBP


	)

174 
	mREG_ESP
,

175 
	#REG_ESP
 
REG_ESP


	)

176 
	mREG_EBX
,

177 
	#REG_EBX
 
REG_EBX


	)

178 
	mREG_EDX
,

179 
	#REG_EDX
 
REG_EDX


	)

180 
	mREG_ECX
,

181 
	#REG_ECX
 
REG_ECX


	)

182 
	mREG_EAX
,

183 
	#REG_EAX
 
REG_EAX


	)

184 
	mREG_TRAPNO
,

185 
	#REG_TRAPNO
 
REG_TRAPNO


	)

186 
	mREG_ERR
,

187 
	#REG_ERR
 
REG_ERR


	)

188 
	mREG_EIP
,

189 
	#REG_EIP
 
REG_EIP


	)

190 
	mREG_CS
,

191 
	#REG_CS
 
REG_CS


	)

192 
	mREG_EFL
,

193 
	#REG_EFL
 
REG_EFL


	)

194 
	mREG_UESP
,

195 
	#REG_UESP
 
REG_UESP


	)

196 
	mREG_SS


197 
	#REG_SS
 
REG_SS


	)

202 
	s_libc_å»g


204 
	msignifiÿnd
[4];

205 
	mexpÚ’t
;

208 
	s_libc_å¡©e


210 
	mcw
;

211 
	msw
;

212 
	mg
;

213 
	moff
;

214 
	mcs£l
;

215 
	md©aoff
;

216 
	md©a£l
;

217 
_libc_å»g
 
	m_¡
[8];

218 
	m¡©us
;

222 
_libc_å¡©e
 *
	tå»g£t_t
;

227 
g»g£t_t
 
	mg»gs
;

230 
å»g£t_t
 
	må»gs
;

231 
	mŞdmask
;

232 
	mü2
;

233 } 
	tmcÚ‹xt_t
;

236 
	sucÚ‹xt


238 
	muc_æags
;

239 
ucÚ‹xt
 *
	muc_lšk
;

240 
¡ack_t
 
	muc_¡ack
;

241 
mcÚ‹xt_t
 
	muc_mcÚ‹xt
;

242 
__sig£t_t
 
	muc_sigmask
;

243 
_libc_å¡©e
 
	m__å»gs_mem
;

244 } 
	tucÚ‹xt_t
;

	@/usr/include/time.h

23 #iâdef 
_TIME_H


25 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

26 ! 
defšed
 
	g__Ãed_time¥ec
)

27 
	#_TIME_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 #ifdef 
_TIME_H


36 
	#__Ãed_size_t


	)

37 
	#__Ãed_NULL


	)

38 
	~<¡ddef.h
>

42 
	~<b™s/time.h
>

45 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


46 #iâdeà
CLK_TCK


47 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

53 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

54 
	#__şock_t_defšed
 1

	)

56 
	~<b™s/ty³s.h
>

58 
__BEGIN_NAMESPACE_STD


60 
__şock_t
 
	tşock_t
;

61 
	g__END_NAMESPACE_STD


62 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


63 
	$__USING_NAMESPACE_STD
(
şock_t
)

67 #undeà
__Ãed_şock_t


69 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

70 
	#__time_t_defšed
 1

	)

72 
	~<b™s/ty³s.h
>

74 
__BEGIN_NAMESPACE_STD


76 
__time_t
 
	ttime_t
;

77 
__END_NAMESPACE_STD


78 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


79 
	$__USING_NAMESPACE_STD
(
time_t
)

83 #undeà
__Ãed_time_t


85 #ià!
defšed
 
__şockid_t_defšed
 && \

86 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

87 
	#__şockid_t_defšed
 1

	)

89 
	~<b™s/ty³s.h
>

92 
__şockid_t
 
	tşockid_t
;

95 #undeà
__şockid_time_t


97 #ià!
defšed
 
__tim”_t_defšed
 && \

98 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

99 
	#__tim”_t_defšed
 1

	)

101 
	~<b™s/ty³s.h
>

104 
__tim”_t
 
	ttim”_t
;

107 #undeà
__Ãed_tim”_t


110 #ià!
defšed
 
__time¥ec_defšed
 && \

111 ((
defšed
 
_TIME_H
 && \

112 (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
)) || \

113 
defšed
 
__Ãed_time¥ec
)

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 
__cÚ¡
 *
tm_zÚe
;

149 
__tm_gmtoff
;

150 
__cÚ¡
 *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 
__BEGIN_NAMESPACE_STD


183 
şock_t
 
	$şock
 (è
__THROW
;

186 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

189 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

190 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

193 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

199 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

200 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

201 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

202 
__END_NAMESPACE_STD


204 #ifdeà
__USE_XOPEN


207 *
	$¡½time
 (
__cÚ¡
 *
__»¡riù
 
__s
,

208 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
)

209 
__THROW
;

212 #ifdeà
__USE_XOPEN2K8


215 
	~<xloÿË.h
>

217 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

218 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

219 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

220 
__loÿË_t
 
__loc
è
__THROW
;

223 #ifdeà
__USE_GNU


224 *
	$¡½time_l
 (
__cÚ¡
 *
__»¡riù
 
__s
,

225 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

230 
__BEGIN_NAMESPACE_STD


233 
tm
 *
	$gmtime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

237 
tm
 *
	$loÿÉime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

238 
__END_NAMESPACE_STD


240 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


243 
tm
 *
	$gmtime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

244 
tm
 *
__»¡riù
 
__
è
__THROW
;

248 
tm
 *
	$loÿÉime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

249 
tm
 *
__»¡riù
 
__
è
__THROW
;

252 
__BEGIN_NAMESPACE_STD


255 *
	$asùime
 (
__cÚ¡
 
tm
 *
__
è
__THROW
;

258 *
	$ùime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

259 
__END_NAMESPACE_STD


261 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


266 *
	$asùime_r
 (
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

267 *
__»¡riù
 
__buf
è
__THROW
;

270 *
	$ùime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

271 *
__»¡riù
 
__buf
è
__THROW
;

276 *
__tzÇme
[2];

277 
__daylight
;

278 
__timezÚe
;

281 #ifdef 
__USE_POSIX


283 *
tzÇme
[2];

287 
	$tz£t
 (è
__THROW
;

290 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


291 
daylight
;

292 
timezÚe
;

295 #ifdeà
__USE_SVID


298 
	$¡ime
 (
__cÚ¡
 
time_t
 *
__wh’
è
__THROW
;

304 
	#__i¦—p
(
y—r
) \

305 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

308 #ifdeà
__USE_MISC


313 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

316 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

319 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

323 #ifdeà
__USE_POSIX199309


328 
	`Çno¦“p
 (
__cÚ¡
 
time¥ec
 *
__»que¡ed_time
,

329 
time¥ec
 *
__»maššg
);

333 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

336 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

339 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, 
__cÚ¡
 
time¥ec
 *
__
)

340 
__THROW
;

342 #ifdeà
__USE_XOPEN2K


347 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

348 
__cÚ¡
 
time¥ec
 *
__»q
,

349 
time¥ec
 *
__»m
);

352 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

357 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

358 
sigev’t
 *
__»¡riù
 
__evp
,

359 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

362 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

365 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

366 
__cÚ¡
 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

367 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

370 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

371 
__THROW
;

374 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

378 #ifdeà
__USE_XOPEN_EXTENDED


390 
g‘d©e_”r
;

399 
tm
 *
	`g‘d©e
 (
__cÚ¡
 *
__¡ršg
);

402 #ifdeà
__USE_GNU


413 
	`g‘d©e_r
 (
__cÚ¡
 *
__»¡riù
 
__¡ršg
,

414 
tm
 *
__»¡riù
 
__»sbuå
);

417 
__END_DECLS


	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

21 
	#_G_size_t
 
size_t


	)

24 
__off_t
 
	m__pos
;

25 
__mb¡©e_t
 
	m__¡©e
;

26 } 
	t_G_åos_t
;

29 
__off64_t
 
	m__pos
;

30 
__mb¡©e_t
 
	m__¡©e
;

31 } 
	t_G_åos64_t
;

32 
	#_G_ssize_t
 
__ssize_t


	)

33 
	#_G_off_t
 
__off_t


	)

34 
	#_G_off64_t
 
__off64_t


	)

35 
	#_G_pid_t
 
__pid_t


	)

36 
	#_G_uid_t
 
__uid_t


	)

37 
	#_G_wch¬_t
 
wch¬_t


	)

38 
	#_G_wšt_t
 
wšt_t


	)

39 
	#_G_¡©64
 
¡©64


	)

40 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


41 
	~<gcÚv.h
>

44 
__gcÚv_šfo
 
	m__cd
;

47 
__gcÚv_šfo
 
	m__cd
;

48 
__gcÚv_¡•_d©a
 
	m__d©a
;

49 } 
	m__combšed
;

50 } 
	t_G_icÚv_t
;

53 
	t_G_št16_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HI__
)));

54 
	t_G_št32_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__SI__
)));

55 
	t_G_ušt16_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HI__
)));

56 
	t_G_ušt32_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__SI__
)));

58 
	#_G_HAVE_BOOL
 1

	)

62 
	#_G_HAVE_ATEXIT
 1

	)

63 
	#_G_HAVE_SYS_CDEFS
 1

	)

64 
	#_G_HAVE_SYS_WAIT
 1

	)

65 
	#_G_NEED_STDARG_H
 1

	)

66 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

68 
	#_G_HAVE_PRINTF_FP
 1

	)

69 
	#_G_HAVE_MMAP
 1

	)

70 
	#_G_HAVE_MREMAP
 1

	)

71 
	#_G_HAVE_LONG_DOUBLE_IO
 1

	)

72 
	#_G_HAVE_IO_FILE_OPEN
 1

	)

73 
	#_G_HAVE_IO_GETLINE_INFO
 1

	)

75 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

77 
	#_G_OPEN64
 
__İ’64


	)

78 
	#_G_LSEEK64
 
__l£ek64


	)

79 
	#_G_MMAP64
 
__mm­64


	)

80 
	#_G_FSTAT64
(
fd
,
buf
è
	`__fx¡©64
 (
_STAT_VER
, fd, buf)

	)

83 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

85 
	#_G_BUFSIZ
 8192

	)

88 
	#_G_NAMES_HAVE_UNDERSCORE
 0

	)

89 
	#_G_VTABLE_LABEL_HAS_LENGTH
 1

	)

90 
	#_G_USING_THUNKS
 1

	)

91 
	#_G_VTABLE_LABEL_PREFIX
 "__vt_"

	)

92 
	#_G_VTABLE_LABEL_PREFIX_ID
 
__vt_


	)

95 #ià
defšed
 
__ılu¥lus
 || defšed 
__STDC__


96 
	#_G_ARGS
(
ARGLIST
è
	)
ARGLIST

98 
	#_G_ARGS
(
ARGLIST
è()

	)

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/asm/ioctls.h

1 
	~<asm-g’”ic/ioùls.h
>

	@/usr/include/asm/types.h

1 #iâdeà
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	#dma_addr_t
 
dma_addr_t


	)

6 
	~<asm-g’”ic/ty³s.h
>

	@/usr/include/bits/byteswap.h

21 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


25 #iâdeà
_BITS_BYTESWAP_H


26 
	#_BITS_BYTESWAP_H
 1

	)

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8))

	)

34 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

35 
	#__bsw­_16
(
x
) \

36 (
__ex‹nsiÚ__
 \

37 ({ 
__v
, 
__x
 = (
x
); \

38 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

39 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

41 
	`__asm__
 ("rorw $8, %w0" \

42 : "ô" (
__v
) \

43 : "0" (
__x
) \

45 
__v
; }))

	)

48 
	#__bsw­_16
(
x
) \

49 (
__ex‹nsiÚ__
 \

50 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_16
 (__x); }))

	)

55 
	#__bsw­_cÚ¡ªt_32
(
x
) \

56 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

57 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

59 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

60 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

61 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

62 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

63 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

64 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

65 || 
defšed
 
	g__amdçm10__
)

68 
	#__bsw­_32
(
x
) \

69 (
__ex‹nsiÚ__
 \

70 ({ 
__v
, 
__x
 = (
x
); \

71 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

72 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

74 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

75 
__v
; }))

	)

77 
	#__bsw­_32
(
x
) \

78 (
__ex‹nsiÚ__
 \

79 ({ 
__v
, 
__x
 = (
x
); \

80 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

81 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

83 
	`__asm__
 ("rorw $8, %w0;" \

86 : "ô" (
__v
) \

87 : "0" (
__x
) \

89 
__v
; }))

	)

92 
	#__bsw­_32
(
x
) \

93 (
__ex‹nsiÚ__
 \

94 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

98 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

100 
	#__bsw­_cÚ¡ªt_64
(
x
) \

101 ((((
x
) & 0xff00000000000000ull) >> 56) \

102 | (((
x
) & 0x00ff000000000000ull) >> 40) \

103 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

104 | (((
x
) & 0x000000ff00000000ull) >> 8) \

105 | (((
x
) & 0x00000000ff000000ull) << 8) \

106 | (((
x
) & 0x0000000000ff0000ull) << 24) \

107 | (((
x
) & 0x000000000000ff00ull) << 40) \

108 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

110 #ià
__WORDSIZE
 == 64

111 
	#__bsw­_64
(
x
) \

112 (
__ex‹nsiÚ__
 \

113 ({ 
__v
, 
__x
 = (
x
); \

114 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

115 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

117 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

118 
__v
; }))

	)

120 
	#__bsw­_64
(
x
) \

121 (
__ex‹nsiÚ__
 \

122 ({ uniÚ { 
__ex‹nsiÚ__
 
__Î
; \

123 
__l
[2]; } 
__w
, 
__r
; \

124 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

125 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

128 
__w
.
__Î
 = (
x
); \

129 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

130 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

132 
__r
.
__Î
; }))

	)

	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/libio-ldbl.h

20 #iâdeà
_IO_STDIO_H


24 
	$__LDBL_REDIR_DECL
 (
_IO_vfsÿnf
)

25 
	`__LDBL_REDIR_DECL
 (
_IO_vårštf
)

	@/usr/include/bits/predefs.h

19 #iâdeà
_FEATURES_H


23 #iâdeà
_PREDEFS_H


24 
	#_PREDEFS_H


	)

27 
	#__STDC_IEC_559__
 1

	)

28 
	#__STDC_IEC_559_COMPLEX__
 1

	)

	@/usr/include/bits/select.h

19 #iâdeà
_SYS_SELECT_H


23 
	~<b™s/wÜdsize.h
>

26 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

28 #ià
__WORDSIZE
 == 64

29 
	#__FD_ZERO_STOS
 "¡osq"

	)

31 
	#__FD_ZERO_STOS
 "¡o¦"

	)

34 
	#__FD_ZERO
(
fd¥
) \

36 
__d0
, 
__d1
; \

37 
__asm__
 
	`__vŞ©e__
 ("şd;„•; " 
__FD_ZERO_STOS
 \

38 : "=c" (
__d0
), "=D" (
__d1
) \

39 : "a" (0), "0" ( (
fd_£t
) \

40 /  (
__fd_mask
)), \

41 "1" (&
	`__FDS_BITS
 (
fd¥
)[0]) \

43 } 0)

	)

49 
	#__FD_ZERO
(
£t
) \

51 
__i
; \

52 
fd_£t
 *
__¬r
 = (
£t
); \

53 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

54 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

55 } 0)

	)

59 
	#__FD_SET
(
d
, 
£t
è(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] |ğ
	`__FDMASK
 (d))

	)

60 
	#__FD_CLR
(
d
, 
£t
è(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] &ğ~
	`__FDMASK
 (d))

	)

61 
	#__FD_ISSET
(
d
, 
£t
) \

62 ((
	`__FDS_BITS
 (
£t
)[
	`__FDELT
 (
d
)] & 
	`__FDMASK
 (d)è!ğ0)

	)

	@/usr/include/bits/stdio-lock.h

20 #iâdeà
_BITS_STDIO_LOCK_H


21 
	#_BITS_STDIO_LOCK_H
 1

	)

23 
	~<b™s/libc-lock.h
>

24 
	~<lowËv–lock.h
>

28 
	#_IO_lock_šex³nsive
 1

	)

30 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t_IO_lock_t
;

32 
	#_IO_lock_š™Ÿliz”
 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

34 
	#_IO_lock_š™
(
_Çme
) \

35 ((
_Çme
èğ(
_IO_lock_t
è
_IO_lock_š™Ÿliz”
 , 0)

	)

37 
	#_IO_lock_fši
(
_Çme
) \

38 ((è0)

	)

40 
	#_IO_lock_lock
(
_Çme
) \

42 *
__£lf
 = 
THREAD_SELF
; \

43 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

45 
	`Îl_lock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

46 (
_Çme
).
owÃr
 = 
__£lf
; \

48 ++(
_Çme
).
út
; \

49 } 0)

	)

51 
	#_IO_lock_Œylock
(
_Çme
) \

53 
__»suÉ
 = 0; \

54 *
__£lf
 = 
THREAD_SELF
; \

55 ià((
_Çme
).
owÃr
 !ğ
__£lf
) \

57 ià(
	`Îl_Œylock
 ((
_Çme
).
lock
) == 0) \

59 (
_Çme
).
owÃr
 = 
__£lf
; \

60 (
_Çme
).
út
 = 1; \

63 
__»suÉ
 = 
EBUSY
; \

66 ++(
_Çme
).
út
; \

67 
__»suÉ
; \

68 })

	)

70 
	#_IO_lock_uÆock
(
_Çme
) \

72 ià(--(
_Çme
).
út
 == 0) \

74 (
_Çme
).
owÃr
 = 
NULL
; \

75 
	`Îl_uÆock
 ((
_Çme
).
lock
, 
LLL_PRIVATE
); \

77 } 0)

	)

81 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
) \

82 
	`__libc_ş—nup_»giÚ_¡¬t
 (((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0, 
_fù
, _å)

	)

83 
	#_IO_ş—nup_»giÚ_¡¬t_nßrg
(
_fù
) \

84 
	`__libc_ş—nup_»giÚ_¡¬t
 (1, 
_fù
, 
NULL
)

	)

85 
	#_IO_ş—nup_»giÚ_’d
(
_do™
) \

86 
	`__libc_ş—nup_»giÚ_’d
 (
_do™
)

	)

88 #ià
defšed
 
_LIBC
 && !defšed 
NOT_IN_libc


90 #ifdeà
__EXCEPTIONS


91 
	#_IO_acquœe_lock
(
_å
) \

93 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

94 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_fù
))) \

95 ğ(
_å
); \

96 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

97 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
) \

99 
_IO_FILE
 *
_IO_acquœe_lock_fe
 \

100 
	`__©Œibu‹__
((
	`ş—nup
 (
_IO_acquœe_lock_ş—r_æags2_fù
))) \

101 ğ(
_å
); \

102 
	`_IO_æockfe
 (
_IO_acquœe_lock_fe
);

	)

104 
	#_IO_acquœe_lock
(
_å
è
_IO_acquœe_lock_Ãeds_exû±iÚs_’abËd


	)

105 
	#_IO_acquœe_lock_ş—r_æags2
(
_å
è
	`_IO_acquœe_lock
 (_å)

	)

107 
	#_IO_»Ëa£_lock
(
_å
è; } 0)

	)

	@/usr/include/bits/time.h

24 #iâdeà
__Ãed_timev®


25 #iâdeà
_BITS_TIME_H


26 
	#_BITS_TIME_H
 1

	)

34 
	#CLOCKS_PER_SEC
 1000000l

	)

36 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


39 
	~<b™s/ty³s.h
>

40 
__syscÚf
 ();

41 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

44 #ifdeà
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

55 
	#TIMER_ABSTIME
 1

	)

61 #ifdeà
__Ãed_timev®


62 #undeà
__Ãed_timev®


63 #iâdeà
_STRUCT_TIMEVAL


64 
	#_STRUCT_TIMEVAL
 1

	)

65 
	~<b™s/ty³s.h
>

69 
	stimev®


71 
__time_t
 
	mtv_£c
;

72 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/typesizes.h

20 #iâdeà
_BITS_TYPES_H


24 #iâdef 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 *

	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uio.h

19 #ià!
defšed
 
_SYS_UIO_H
 && !defšed 
_FCNTL_H


23 #iâdeà
_BITS_UIO_H


24 
	#_BITS_UIO_H
 1

	)

26 
	~<sys/ty³s.h
>

40 
	#UIO_MAXIOV
 1024

	)

44 
	siovec


46 *
	miov_ba£
;

47 
size_t
 
	miov_Ën
;

	@/usr/include/bits/wchar.h

20 #iâdeà
_BITS_WCHAR_H


21 
	#_BITS_WCHAR_H
 1

	)

24 #ifdeà
__WCHAR_MAX__


25 
	#__WCHAR_MAX
 
__WCHAR_MAX__


	)

27 
	#__WCHAR_MAX
 (2147483647)

	)

32 #ifdeà
__WCHAR_UNSIGNED__


33 
	#__WCHAR_MIN
 
L
'\0'

	)

37 #–ià
L
'\0' - 1 > 0

38 
	#__WCHAR_MIN
 
L
'\0'

	)

40 
	#__WCHAR_MIN
 (-
__WCHAR_MAX
 - 1)

	)

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__


4 
	#__WORDSIZE
 64

	)

5 
	#__WORDSIZE_COMPAT32
 1

	)

7 
	#__WORDSIZE
 32

	)

	@/usr/include/ctype.h

24 #iâdef 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

30 
	g__BEGIN_DECLS


32 #iâdeà
_ISb™


41 
	~<’dŸn.h
>

42 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


43 
	#_ISb™
(
b™
è(1 << (b™))

	)

45 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

50 
	m_ISuµ”
 = 
_ISb™
 (0),

51 
	m_ISlow”
 = 
_ISb™
 (1),

52 
	m_IS®pha
 = 
_ISb™
 (2),

53 
	m_ISdig™
 = 
_ISb™
 (3),

54 
	m_ISxdig™
 = 
_ISb™
 (4),

55 
	m_IS¥aû
 = 
_ISb™
 (5),

56 
	m_IS´št
 = 
_ISb™
 (6),

57 
	m_ISg¿ph
 = 
_ISb™
 (7),

58 
	m_ISbÏnk
 = 
_ISb™
 (8),

59 
	m_ISúŒl
 = 
_ISb™
 (9),

60 
	m_ISpunù
 = 
_ISb™
 (10),

61 
	m_IS®num
 = 
_ISb™
 (11)

81 
__cÚ¡
 **
	$__ùy³_b_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

83 
__cÚ¡
 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

85 
__cÚ¡
 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

86 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡
));

88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

91 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

92 
	#__tßscii
(
c
è((cè& 0x7fè

	)

94 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

96 
__BEGIN_NAMESPACE_STD


102 
	`__exùy³
 (
i§Êum
);

103 
	`__exùy³
 (
i§Íha
);

104 
	`__exùy³
 (
isúŒl
);

105 
	`__exùy³
 (
isdig™
);

106 
	`__exùy³
 (
i¦ow”
);

107 
	`__exùy³
 (
isg¿ph
);

108 
	`__exùy³
 (
i¥ršt
);

109 
	`__exùy³
 (
i¥unù
);

110 
	`__exùy³
 (
is¥aû
);

111 
	`__exùy³
 (
isuµ”
);

112 
	`__exùy³
 (
isxdig™
);

116 
	$tŞow”
 (
__c
è
__THROW
;

119 
	$touµ”
 (
__c
è
__THROW
;

121 
__END_NAMESPACE_STD


125 #ifdef 
__USE_ISOC99


126 
__BEGIN_NAMESPACE_C99


128 
	`__exùy³
 (
isbÏnk
);

130 
__END_NAMESPACE_C99


133 #ifdeà
__USE_GNU


135 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

138 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


142 
	$i§scii
 (
__c
è
__THROW
;

146 
	$tßscii
 (
__c
è
__THROW
;

150 
	`__exùy³
 (
_touµ”
);

151 
	`__exùy³
 (
_tŞow”
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

156 (
__ex‹nsiÚ__
 \

157 ({ 
__»s
; \

158 ià( (
c
) > 1) \

160 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

166 
__»s
 = 
f
 
¬gs
; \

169 
__»s
 = (
a
)[(è(
c
)]; \

170 
__»s
; 
	}
}))

	)

172 #ià!
defšed
 
__NO_CTYPE
 && !defšed 
__ılu¥lus


173 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

174 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

175 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

176 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

177 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

178 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

179 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

180 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

181 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

182 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

183 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

185 #ifdeà
__USE_ISOC99


186 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

189 #ifdeà
__USE_EXTERN_INLINES


190 
__ex‹º_šlše
 

191 
__NTH
 (
	$tŞow”
 (
__c
))

193  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

194 
	}
}

196 
__ex‹º_šlše
 

197 
__NTH
 (
	$touµ”
 (
__c
))

199  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

200 
	}
}

203 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


204 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

205 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

208 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


209 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

210 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

212 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

213 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

219 #ifdeà
__USE_XOPEN2K8


233 
	~<xloÿË.h
>

237 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

238 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

240 
	#__exùy³_l
(
Çme
) \

241 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

247 
__exùy³_l
 (
i§Êum_l
);

248 
__exùy³_l
 (
i§Íha_l
);

249 
__exùy³_l
 (
isúŒl_l
);

250 
__exùy³_l
 (
isdig™_l
);

251 
__exùy³_l
 (
i¦ow”_l
);

252 
__exùy³_l
 (
isg¿ph_l
);

253 
__exùy³_l
 (
i¥ršt_l
);

254 
__exùy³_l
 (
i¥unù_l
);

255 
__exùy³_l
 (
is¥aû_l
);

256 
__exùy³_l
 (
isuµ”_l
);

257 
__exùy³_l
 (
isxdig™_l
);

259 
__exùy³_l
 (
isbÏnk_l
);

263 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

264 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

267 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

268 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

270 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


271 
	#__tŞow”_l
(
c
, 
loÿË
) \

272 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

273 
	#__touµ”_l
(
c
, 
loÿË
) \

274 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

275 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

276 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

280 #iâdeà
__NO_CTYPE


281 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

282 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

283 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

284 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

285 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

286 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

287 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

288 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

289 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

290 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

291 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

293 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

295 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


296 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

297 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

300 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

301 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

302 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

303 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

304 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

305 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

306 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

307 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

308 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

309 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

310 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

312 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

314 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


315 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

316 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

323 
__END_DECLS


	@/usr/include/gnu/stubs.h

4 
	~<b™s/wÜdsize.h
>

6 #ià
__WORDSIZE
 == 32

7 
	~<gnu/¡ubs-32.h
>

8 #–ià
__WORDSIZE
 == 64

9 
	~<gnu/¡ubs-64.h
>

	@/usr/include/linux/byteorder/little_endian.h

1 #iâdeà
_LINUX_BYTEORDER_LITTLE_ENDIAN_H


2 
	#_LINUX_BYTEORDER_LITTLE_ENDIAN_H


	)

4 #iâdeà
__LITTLE_ENDIAN


5 
	#__LITTLE_ENDIAN
 1234

	)

7 #iâdeà
__LITTLE_ENDIAN_BITFIELD


8 
	#__LITTLE_ENDIAN_BITFIELD


	)

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/swab.h
>

14 
	#__cÚ¡ªt_htÚl
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

15 
	#__cÚ¡ªt_Áohl
(
x
è
	`___cÚ¡ªt_swab32
((
__be32
)(x))

	)

16 
	#__cÚ¡ªt_htÚs
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

17 
	#__cÚ¡ªt_Áohs
(
x
è
	`___cÚ¡ªt_swab16
((
__be16
)(x))

	)

18 
	#__cÚ¡ªt_ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

19 
	#__cÚ¡ªt_Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

20 
	#__cÚ¡ªt_ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

21 
	#__cÚ¡ªt_Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

22 
	#__cÚ¡ªt_ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

23 
	#__cÚ¡ªt_Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

24 
	#__cÚ¡ªt_ıu_to_be64
(
x
è((
__be64
)
	`___cÚ¡ªt_swab64
((x)))

	)

25 
	#__cÚ¡ªt_be64_to_ıu
(
x
è
	`___cÚ¡ªt_swab64
((
__u64
)(
__be64
)(x))

	)

26 
	#__cÚ¡ªt_ıu_to_be32
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

27 
	#__cÚ¡ªt_be32_to_ıu
(
x
è
	`___cÚ¡ªt_swab32
((
__u32
)(
__be32
)(x))

	)

28 
	#__cÚ¡ªt_ıu_to_be16
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

29 
	#__cÚ¡ªt_be16_to_ıu
(
x
è
	`___cÚ¡ªt_swab16
((
__u16
)(
__be16
)(x))

	)

30 
	#__ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

31 
	#__Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

32 
	#__ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

33 
	#__Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

34 
	#__ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

35 
	#__Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

36 
	#__ıu_to_be64
(
x
è((
__be64
)
	`__swab64
((x)))

	)

37 
	#__be64_to_ıu
(
x
è
	`__swab64
((
__u64
)(
__be64
)(x))

	)

38 
	#__ıu_to_be32
(
x
è((
__be32
)
	`__swab32
((x)))

	)

39 
	#__be32_to_ıu
(
x
è
	`__swab32
((
__u32
)(
__be32
)(x))

	)

40 
	#__ıu_to_be16
(
x
è((
__be16
)
	`__swab16
((x)))

	)

41 
	#__be16_to_ıu
(
x
è
	`__swab16
((
__u16
)(
__be16
)(x))

	)

43 
__šlše__
 
__Ë64
 
	$__ıu_to_Ë64p
(cÚ¡ 
__u64
 *
p
)

45  (
__Ë64
)*
p
;

46 
	}
}

47 
__šlše__
 
__u64
 
	$__Ë64_to_ıup
(cÚ¡ 
__Ë64
 *
p
)

49  (
__u64
)*
p
;

50 
	}
}

51 
__šlše__
 
__Ë32
 
	$__ıu_to_Ë32p
(cÚ¡ 
__u32
 *
p
)

53  (
__Ë32
)*
p
;

54 
	}
}

55 
__šlše__
 
__u32
 
	$__Ë32_to_ıup
(cÚ¡ 
__Ë32
 *
p
)

57  (
__u32
)*
p
;

58 
	}
}

59 
__šlše__
 
__Ë16
 
	$__ıu_to_Ë16p
(cÚ¡ 
__u16
 *
p
)

61  (
__Ë16
)*
p
;

62 
	}
}

63 
__šlše__
 
__u16
 
	$__Ë16_to_ıup
(cÚ¡ 
__Ë16
 *
p
)

65  (
__u16
)*
p
;

66 
	}
}

67 
__šlše__
 
__be64
 
	$__ıu_to_be64p
(cÚ¡ 
__u64
 *
p
)

69  (
__be64
)
	`__swab64p
(
p
);

70 
	}
}

71 
__šlše__
 
__u64
 
	$__be64_to_ıup
(cÚ¡ 
__be64
 *
p
)

73  
	`__swab64p
((
__u64
 *)
p
);

74 
	}
}

75 
__šlše__
 
__be32
 
	$__ıu_to_be32p
(cÚ¡ 
__u32
 *
p
)

77  (
__be32
)
	`__swab32p
(
p
);

78 
	}
}

79 
__šlše__
 
__u32
 
	$__be32_to_ıup
(cÚ¡ 
__be32
 *
p
)

81  
	`__swab32p
((
__u32
 *)
p
);

82 
	}
}

83 
__šlše__
 
__be16
 
	$__ıu_to_be16p
(cÚ¡ 
__u16
 *
p
)

85  (
__be16
)
	`__swab16p
(
p
);

86 
	}
}

87 
__šlše__
 
__u16
 
	$__be16_to_ıup
(cÚ¡ 
__be16
 *
p
)

89  
	`__swab16p
((
__u16
 *)
p
);

90 
	}
}

91 
	#__ıu_to_Ë64s
(
x
èdØ{ ()(x); } 0)

	)

92 
	#__Ë64_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

93 
	#__ıu_to_Ë32s
(
x
èdØ{ ()(x); } 0)

	)

94 
	#__Ë32_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

95 
	#__ıu_to_Ë16s
(
x
èdØ{ ()(x); } 0)

	)

96 
	#__Ë16_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

97 
	#__ıu_to_be64s
(
x
è
	`__swab64s
((x))

	)

98 
	#__be64_to_ıus
(
x
è
	`__swab64s
((x))

	)

99 
	#__ıu_to_be32s
(
x
è
	`__swab32s
((x))

	)

100 
	#__be32_to_ıus
(
x
è
	`__swab32s
((x))

	)

101 
	#__ıu_to_be16s
(
x
è
	`__swab16s
((x))

	)

102 
	#__be16_to_ıus
(
x
è
	`__swab16s
((x))

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #undeà
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #undeà
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #undeà
__FDELT


31 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

33 #undeà
__FDMASK


34 
	#__FDMASK
(
d
è(1UL << ((dè% 
__NFDBITS
))

	)

37 
	mfds_b™s
 [
__FDSET_LONGS
];

38 } 
	t__k”Ãl_fd_£t
;

41 (*
	t__k”Ãl_sighªdËr_t
)();

44 
	t__k”Ãl_key_t
;

45 
	t__k”Ãl_mqd_t
;

47 
	~<asm/posix_ty³s.h
>

	@/usr/include/sys/cdefs.h

20 #iâdef 
_SYS_CDEFS_H


21 
	#_SYS_CDEFS_H
 1

	)

24 #iâdeà
_FEATURES_H


25 
	~<ã©u»s.h
>

31 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


36 #undeà
__P


37 #undeà
__PMT


39 #ifdeà
__GNUC__


46 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

47 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

48 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

50 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

51 
	#__THROW
 
	`throw
 ()

	)

52 
	#__NTH
(
fù
èfù 
	`throw
 ()

	)

54 
	#__THROW


	)

55 
	#__NTH
(
fù
è
	)
fct

61 
	#__šlše


	)

63 
	#__THROW


	)

64 
	#__NTH
(
fù
è
	)
fct

66 
	#__cÚ¡
 cÚ¡

	)

67 
	#__sigÃd
 sigÃd

	)

68 
	#__vŞ©e
 vŞ©e

	)

74 
	#__P
(
¬gs
è
	)
args

75 
	#__PMT
(
¬gs
è
	)
args

80 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

81 
	#__STRING
(
x
è#x

	)

84 
	#__±r_t
 *

	)

85 
	#__lÚg_doubË_t
 

	)

89 #ifdef 
__ılu¥lus


90 
	#__BEGIN_DECLS
 "C" {

	)

91 
	#__END_DECLS
 }

	)

93 
	#__BEGIN_DECLS


	)

94 
	#__END_DECLS


	)

103 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


104 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

105 
	#__END_NAMESPACE_STD
 }

	)

106 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

107 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

108 
	#__END_NAMESPACE_C99
 }

	)

109 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

114 
	#__BEGIN_NAMESPACE_STD


	)

115 
	#__END_NAMESPACE_STD


	)

116 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

117 
	#__BEGIN_NAMESPACE_C99


	)

118 
	#__END_NAMESPACE_C99


	)

119 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

124 #iâdeà
__BOUNDED_POINTERS__


125 
	#__bounded


	)

126 
	#__unbounded


	)

127 
	#__±rv®ue


	)

132 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

135 #ià
__GNUC_PREREQ
 (4,3)

136 
	#__w¬ndeş
(
Çme
, 
msg
) \

137 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

138 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

139 
	#__”rÜdeş
(
Çme
, 
msg
) \

140 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

142 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

143 
	#__w¬Ç‰r
(
msg
)

	)

144 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

148 #ià
__GNUC_PREREQ
 (2,97)

150 
	#__æex¬r
 []

	)

152 #ifdeà
__GNUC__


153 
	#__æex¬r
 [0]

	)

155 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

156 
	#__æex¬r
 []

	)

159 
	#__æex¬r
 [1]

	)

175 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

177 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

178 #ifdeà
__ılu¥lus


179 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

180 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

182 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

183 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

185 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

186 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

199 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

200 
	#__©Œibu‹__
(
xyz
è

	)

206 #ià
__GNUC_PREREQ
 (2,96)

207 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

209 
	#__©Œibu‹_m®loc__


	)

215 #ià
__GNUC_PREREQ
 (2,96)

216 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

218 
	#__©Œibu‹_pu»__


	)

224 #ià
__GNUC_PREREQ
 (3,1)

225 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

226 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

228 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

229 
	#__©Œibu‹_nošlše__


	)

233 #ià
__GNUC_PREREQ
 (3,2)

234 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

236 
	#__©Œibu‹_d•»ÿ‹d__


	)

245 #ià
__GNUC_PREREQ
 (2,8)

246 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

248 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

255 #ià
__GNUC_PREREQ
 (2,97)

256 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

257 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

259 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

264 #ià
__GNUC_PREREQ
 (3,3)

265 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

267 
	#__nÚnuÎ
(
·¿ms
)

	)

272 #ià
__GNUC_PREREQ
 (3,4)

273 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

274 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

275 #ià
__USE_FORTIFY_LEVEL
 > 0

276 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

279 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

281 #iâdeà
__wur


282 
	#__wur


	)

286 #ià
__GNUC_PREREQ
 (3,2)

287 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

289 
	#__®ways_šlše
 
__šlše


	)

294 #ià!
defšed
 
__ılu¥lus
 || 
__GNUC_PREREQ
 (4,3)

295 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


296 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

297 #ià
__GNUC_PREREQ
 (4,3)

298 
	#__ex‹º_®ways_šlše
 \

299 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
, 
__¬tificŸl__
))

	)

301 
	#__ex‹º_®ways_šlše
 \

302 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

305 
	#__ex‹º_šlše
 
__šlše


	)

306 #ià
__GNUC_PREREQ
 (4,3)

307 
	#__ex‹º_®ways_šlše
 \

308 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

310 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

317 #ià
__GNUC_PREREQ
 (4,3)

318 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

319 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

326 #ià!
__GNUC_PREREQ
 (2,8)

327 
	#__ex‹nsiÚ__


	)

331 #ià!
__GNUC_PREREQ
 (2,92)

332 
	#__»¡riù


	)

338 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


339 
	#__»¡riù_¬r
 
__»¡riù


	)

341 #ifdeà
__GNUC__


342 
	#__»¡riù_¬r


	)

344 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

345 
	#__»¡riù_¬r
 
»¡riù


	)

348 
	#__»¡riù_¬r


	)

353 
	~<b™s/wÜdsize.h
>

355 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


356 
	#__LDBL_COMPAT
 1

	)

357 #ifdeà
__REDIRECT


358 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

359 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

360 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

361 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

362 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

363 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

364 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

365 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

366 
	#__LDBL_REDIR_DECL
(
Çme
) \

367 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

368 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

369 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

370 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

371 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

374 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


375 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

376 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

377 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

378 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

379 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

380 #ifdeà
__REDIRECT


381 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

382 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

383 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

	@/usr/include/xlocale.h

21 #iâdeà
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loÿË_¡ruù


31 
loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

40 } *
	t__loÿË_t
;

43 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/asm-generic/ioctl.h

1 #iâdeà
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #iâdeà
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #iâdeà
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

53 #iâdeà
_IOC_NONE


54 
	#_IOC_NONE
 0U

	)

57 #iâdeà
_IOC_WRITE


58 
	#_IOC_WRITE
 1U

	)

61 #iâdeà
_IOC_READ


62 
	#_IOC_READ
 2U

	)

65 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

66 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

67 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

68 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

69 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

71 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

74 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

75 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

76 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

77 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

78 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

79 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

80 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

83 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

84 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

85 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

86 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

90 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

91 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

92 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

93 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

94 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm-generic/ioctls.h

1 #iâdeà
__ASM_GENERIC_IOCTLS_H


2 
	#__ASM_GENERIC_IOCTLS_H


	)

4 
	~<lšux/ioùl.h
>

19 
	#TCGETS
 0x5401

	)

20 
	#TCSETS
 0x5402

	)

21 
	#TCSETSW
 0x5403

	)

22 
	#TCSETSF
 0x5404

	)

23 
	#TCGETA
 0x5405

	)

24 
	#TCSETA
 0x5406

	)

25 
	#TCSETAW
 0x5407

	)

26 
	#TCSETAF
 0x5408

	)

27 
	#TCSBRK
 0x5409

	)

28 
	#TCXONC
 0x540A

	)

29 
	#TCFLSH
 0x540B

	)

30 
	#TIOCEXCL
 0x540C

	)

31 
	#TIOCNXCL
 0x540D

	)

32 
	#TIOCSCTTY
 0x540E

	)

33 
	#TIOCGPGRP
 0x540F

	)

34 
	#TIOCSPGRP
 0x5410

	)

35 
	#TIOCOUTQ
 0x5411

	)

36 
	#TIOCSTI
 0x5412

	)

37 
	#TIOCGWINSZ
 0x5413

	)

38 
	#TIOCSWINSZ
 0x5414

	)

39 
	#TIOCMGET
 0x5415

	)

40 
	#TIOCMBIS
 0x5416

	)

41 
	#TIOCMBIC
 0x5417

	)

42 
	#TIOCMSET
 0x5418

	)

43 
	#TIOCGSOFTCAR
 0x5419

	)

44 
	#TIOCSSOFTCAR
 0x541A

	)

45 
	#FIONREAD
 0x541B

	)

46 
	#TIOCINQ
 
FIONREAD


	)

47 
	#TIOCLINUX
 0x541C

	)

48 
	#TIOCCONS
 0x541D

	)

49 
	#TIOCGSERIAL
 0x541E

	)

50 
	#TIOCSSERIAL
 0x541F

	)

51 
	#TIOCPKT
 0x5420

	)

52 
	#FIONBIO
 0x5421

	)

53 
	#TIOCNOTTY
 0x5422

	)

54 
	#TIOCSETD
 0x5423

	)

55 
	#TIOCGETD
 0x5424

	)

56 
	#TCSBRKP
 0x5425

	)

57 
	#TIOCSBRK
 0x5427

	)

58 
	#TIOCCBRK
 0x5428

	)

59 
	#TIOCGSID
 0x5429

	)

60 
	#TCGETS2
 
	`_IOR
('T', 0x2A, 
‹rmios2
)

	)

61 
	#TCSETS2
 
	`_IOW
('T', 0x2B, 
‹rmios2
)

	)

62 
	#TCSETSW2
 
	`_IOW
('T', 0x2C, 
‹rmios2
)

	)

63 
	#TCSETSF2
 
	`_IOW
('T', 0x2D, 
‹rmios2
)

	)

64 
	#TIOCGRS485
 0x542E

	)

65 
	#TIOCSRS485
 0x542F

	)

66 
	#TIOCGPTN
 
	`_IOR
('T', 0x30, è

	)

67 
	#TIOCSPTLCK
 
	`_IOW
('T', 0x31, è

	)

68 
	#TCGETX
 0x5432

	)

69 
	#TCSETX
 0x5433

	)

70 
	#TCSETXF
 0x5434

	)

71 
	#TCSETXW
 0x5435

	)

73 
	#FIONCLEX
 0x5450

	)

74 
	#FIOCLEX
 0x5451

	)

75 
	#FIOASYNC
 0x5452

	)

76 
	#TIOCSERCONFIG
 0x5453

	)

77 
	#TIOCSERGWILD
 0x5454

	)

78 
	#TIOCSERSWILD
 0x5455

	)

79 
	#TIOCGLCKTRMIOS
 0x5456

	)

80 
	#TIOCSLCKTRMIOS
 0x5457

	)

81 
	#TIOCSERGSTRUCT
 0x5458

	)

82 
	#TIOCSERGETLSR
 0x5459

	)

83 
	#TIOCSERGETMULTI
 0x545A

	)

84 
	#TIOCSERSETMULTI
 0x545B

	)

86 
	#TIOCMIWAIT
 0x545C

	)

87 
	#TIOCGICOUNT
 0x545D

	)

93 #iâdeà
FIOQSIZE


94 
	#TIOCGHAYESESP
 0x545E

	)

95 
	#TIOCSHAYESESP
 0x545F

	)

96 
	#FIOQSIZE
 0x5460

	)

100 
	#TIOCPKT_DATA
 0

	)

101 
	#TIOCPKT_FLUSHREAD
 1

	)

102 
	#TIOCPKT_FLUSHWRITE
 2

	)

103 
	#TIOCPKT_STOP
 4

	)

104 
	#TIOCPKT_START
 8

	)

105 
	#TIOCPKT_NOSTOP
 16

	)

106 
	#TIOCPKT_DOSTOP
 32

	)

108 
	#TIOCSER_TEMT
 0x01

	)

	@/usr/include/asm-generic/types.h

1 #iâdeà
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-g’”ic/št-Î64.h
>

9 #iâdeà
__ASSEMBLY__


11 
	tumode_t
;

	@/usr/include/asm/posix_types.h

1 #ifdeà
__i386__


2 
	~"posix_ty³s_32.h
"

4 
	~"posix_ty³s_64.h
"

	@/usr/include/bits/libc-lock.h

20 #iâdeà
_BITS_LIBC_LOCK_H


21 
	#_BITS_LIBC_LOCK_H
 1

	)

23 
	~<±h»ad.h
>

24 
	#__Ãed_NULL


	)

25 
	~<¡ddef.h
>

34 #ifdeà
_LIBC


35 
	~<lowËv–lock.h
>

36 
	~<s.h
>

37 
	~<±h»ad-funùiÚs.h
>

38 
	~<”ºo.h
>

39 
	~<gnu/İtiÚ-groups.h
>

43 #ià
defšed
 
_LIBC
 || defšed 
_IO_MTSAFE_IO


44 #ià(
defšed
 
NOT_IN_libc
 && !defšed 
IS_IN_lib±h»ad
è|| !defšed 
_LIBC


45 
±h»ad_mu‹x_t
 
	t__libc_lock_t
;

46 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__libc_lock_»cursive_t
;

48 
	t__libc_lock_t
;

49 ¡ruù { 
	mlock
; 
	mút
; *
	mowÃr
; } 
	t__libc_lock_»cursive_t
;

51 ¡ruù { 
±h»ad_mu‹x_t
 
	mmu‹x
; } 
	t__¹ld_lock_»cursive_t
;

52 #ifdeà
__USE_UNIX98


53 
±h»ad_rwlock_t
 
	t__libc_rwlock_t
;

55 
__libc_rwlock_İaque__
 
	t__libc_rwlock_t
;

58 
__libc_lock_İaque__
 
	t__libc_lock_t
;

59 
__libc_lock_»cursive_İaque__
 
	t__libc_lock_»cursive_t
;

60 
__libc_rwlock_İaque__
 
	t__libc_rwlock_t
;

64 
±h»ad_key_t
 
	t__libc_key_t
;

73 
	#__libc_lock_defše
(
CLASS
,
NAME
) \

74 
CLASS
 
__libc_lock_t
 
NAME
;

	)

75 
	#__libc_rwlock_defše
(
CLASS
,
NAME
) \

76 
CLASS
 
__libc_rwlock_t
 
NAME
;

	)

77 
	#__libc_lock_defše_»cursive
(
CLASS
,
NAME
) \

78 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

79 
	#__¹ld_lock_defše_»cursive
(
CLASS
,
NAME
) \

80 
CLASS
 
__¹ld_lock_»cursive_t
 
NAME
;

	)

91 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

92 #ià
LLL_LOCK_INITIALIZER
 == 0

93 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

94 
CLASS
 
__libc_lock_t
 
NAME
;

	)

96 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

97 
CLASS
 
__libc_lock_t
 
NAME
 = 
LLL_LOCK_INITIALIZER
;

	)

100 #ià
__LT_SPINLOCK_INIT
 == 0

101 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

102 
CLASS
 
__libc_lock_t
 
NAME
;

	)

104 
	#__libc_lock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

105 
CLASS
 
__libc_lock_t
 
NAME
 = 
PTHREAD_MUTEX_INITIALIZER
;

	)

109 
	#__libc_rwlock_defše_š™Ÿlized
(
CLASS
,
NAME
) \

110 
CLASS
 
__libc_rwlock_t
 
NAME
 = 
PTHREAD_RWLOCK_INITIALIZER
;

	)

114 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

115 #ià
LLL_LOCK_INITIALIZER
 == 0

116 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

117 
CLASS
 
__libc_lock_»cursive_t
 
NAME
;

	)

119 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

120 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

122 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

123 { 
LLL_LOCK_INITIALIZER
, 0, 
NULL
 }

	)

125 
	#__libc_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

126 
CLASS
 
__libc_lock_»cursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

127 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

128 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

131 
	#__¹ld_lock_defše_š™Ÿlized_»cursive
(
CLASS
,
NAME
) \

132 
CLASS
 
__¹ld_lock_»cursive_t
 
NAME
 = 
_RTLD_LOCK_RECURSIVE_INITIALIZER
;

	)

133 
	#_RTLD_LOCK_RECURSIVE_INITIALIZER
 \

134 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

136 
	#__¹ld_lock_š™Ÿlize
(
NAME
) \

137 (è((
NAME
èğ(
__¹ld_lock_»cursive_t
è
_RTLD_LOCK_RECURSIVE_INITIALIZER
)

	)

144 #ifdeà
__PIC__


145 
	#__libc_maybe_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

146 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of
 (
FUNC
è*
_â
 = (FUNC); \

147 
_â
 !ğ
NULL
 ? (*_âè
ARGS
 : 
ELSE
; }))

	)

149 
	#__libc_maybe_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

150 (
FUNC
 !ğ
NULL
 ? FUNC 
ARGS
 : 
ELSE
)

	)

154 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


155 
	#PTFAVAIL
(
NAME
è
__libc_±h»ad_funùiÚs_š™


	)

156 
	#__libc_±f_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

157 (
__libc_±h»ad_funùiÚs_š™
 ? 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
è: 
ELSE
)

	)

158 
	#__libc_±f_ÿÎ_®ways
(
FUNC
, 
ARGS
) \

159 
	`PTHFCT_CALL
 (
±r_
##
FUNC
, 
ARGS
)

	)

161 
	#PTFAVAIL
(
NAME
è(NAME !ğ
NULL
)

	)

162 
	#__libc_±f_ÿÎ
(
FUNC
, 
ARGS
, 
ELSE
) \

163 
	`__libc_maybe_ÿÎ
 (
FUNC
, 
ARGS
, 
ELSE
)

	)

164 
	#__libc_±f_ÿÎ_®ways
(
FUNC
, 
ARGS
) \

165 
FUNC
 
ARGS


	)

171 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

172 
	#__libc_lock_š™
(
NAME
è((NAMEèğ
LLL_LOCK_INITIALIZER
, 0)

	)

174 
	#__libc_lock_š™
(
NAME
) \

175 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_š™
, (&(
NAME
), 
NULL
), 0)

	)

177 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


180 
	#__libc_rwlock_š™
(
NAME
) \

181 (
	`__butš_mem£t
 (&(
NAME
), '\0',  (NAME)), 0)

	)

183 
	#__libc_rwlock_š™
(
NAME
) \

184 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_š™
, (&(
NAME
), 
NULL
), 0)

	)

188 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

189 
	#__libc_lock_š™_»cursive
(
NAME
) \

190 ((
NAME
èğ(
__libc_lock_»cursive_t
è
_LIBC_LOCK_RECURSIVE_INITIALIZER
, 0)

	)

192 
	#__libc_lock_š™_»cursive
(
NAME
) \

194 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

196 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

197 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

198 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

199 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

200 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

202 } 0)

	)

205 
	#__¹ld_lock_š™_»cursive
(
NAME
) \

207 ià(
__±h»ad_mu‹x_š™
 !ğ
NULL
) \

209 
±h»ad_mu‹x©Œ_t
 
__©Œ
; \

210 
	`__±h»ad_mu‹x©Œ_š™
 (&
__©Œ
); \

211 
	`__±h»ad_mu‹x©Œ_£‰y³
 (&
__©Œ
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

212 
	`__±h»ad_mu‹x_š™
 (&(
NAME
).
mu‹x
, &
__©Œ
); \

213 
	`__±h»ad_mu‹x©Œ_de¡roy
 (&
__©Œ
); \

215 } 0)

	)

220 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

221 
	#__libc_lock_fši
(
NAME
è((è0)

	)

223 
	#__libc_lock_fši
(
NAME
) \

224 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
)), 0)

	)

226 #ià
defšed
 
SHARED
 && !defšed 
NOT_IN_libc


227 
	#__libc_rwlock_fši
(
NAME
è((è0)

	)

229 
	#__libc_rwlock_fši
(
NAME
) \

230 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_de¡roy
, (&(
NAME
)), 0)

	)

234 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

235 
	#__libc_lock_fši_»cursive
(
NAME
è((è0)

	)

237 
	#__libc_lock_fši_»cursive
(
NAME
) \

238 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_de¡roy
, (&(
NAME
)), 0)

	)

242 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

243 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

247 
__libc_lock_lock_â
 (
__libc_lock_t
 *);

248 
libc_hidd’_´Ùo
 (
__libc_lock_lock_â
);

250 #ià
__OPTION_EGLIBC_BIG_MACROS


251 
	#__libc_lock_lock
(
NAME
) \

252 ({ 
	`Îl_lock
 (
NAME
, 
LLL_PRIVATE
); 0; })

	)

254 
	#__libc_lock_lock
(
NAME
) \

255 
	`__libc_lock_lock_â
 (&(
NAME
))

	)

258 
	#__libc_lock_lock
(
NAME
) \

259 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
)), 0)

	)

261 
	#__libc_rwlock_rdlock
(
NAME
) \

262 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_rdlock
, (&(
NAME
)), 0)

	)

263 
	#__libc_rwlock_w¾ock
(
NAME
) \

264 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_w¾ock
, (&(
NAME
)), 0)

	)

267 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

268 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

272 
__libc_lock_lock_»cursive_â
 (
__libc_lock_»cursive_t
 *);

273 
libc_hidd’_´Ùo
 (
__libc_lock_lock_»cursive_â
);

275 #ià
__OPTION_EGLIBC_BIG_MACROS


276 
	#__libc_lock_lock_»cursive
(
NAME
) \

278 *
£lf
 = 
THREAD_SELF
; \

279 ià((
NAME
).
owÃr
 !ğ
£lf
) \

281 
	`Îl_lock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

282 (
NAME
).
owÃr
 = 
£lf
; \

284 ++(
NAME
).
út
; \

285 } 0)

	)

287 
	#__libc_lock_lock_»cursive
(
NAME
) \

288 
	`__libc_lock_lock_»cursive_â
 (&(
NAME
))

	)

291 
	#__libc_lock_lock_»cursive
(
NAME
) \

292 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

296 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

297 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

301 
__libc_lock_Œylock_â
 (
__libc_lock_t
 *);

302 
libc_hidd’_´Ùo
 (
__libc_lock_Œylock_â
);

304 #ià
__OPTION_EGLIBC_BIG_MACROS


305 
	#__libc_lock_Œylock
(
NAME
) \

306 
	`Îl_Œylock
 (
NAME
)

	)

308 
	#__libc_lock_Œylock
(
NAME
) \

309 
	`__libc_lock_Œylock_â
 (&(
NAME
))

	)

312 
	#__libc_lock_Œylock
(
NAME
) \

313 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
)), 0)

	)

315 
	#__libc_rwlock_Œyrdlock
(
NAME
) \

316 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_Œyrdlock
, (&(
NAME
)), 0)

	)

317 
	#__libc_rwlock_Œyw¾ock
(
NAME
) \

318 
	`__libc_maybe_ÿÎ
 (
__±h»ad_rwlock_Œyw¾ock
, (&(
NAME
)), 0)

	)

321 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

322 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

326 
__libc_lock_Œylock_»cursive_â
 (
__libc_lock_»cursive_t
 *);

327 
libc_hidd’_´Ùo
 (
__libc_lock_Œylock_»cursive_â
);

329 #ià
__OPTION_EGLIBC_BIG_MACROS


330 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

332 
»suÉ
 = 0; \

333 *
£lf
 = 
THREAD_SELF
; \

334 ià((
NAME
).
owÃr
 !ğ
£lf
) \

336 ià(
	`Îl_Œylock
 ((
NAME
).
lock
) == 0) \

338 (
NAME
).
owÃr
 = 
£lf
; \

339 (
NAME
).
út
 = 1; \

342 
»suÉ
 = 
EBUSY
; \

345 ++(
NAME
).
út
; \

346 
»suÉ
; \

347 })

	)

349 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

350 
	`__libc_lock_Œylock_»cursive_â
 (&(
NAME
))

	)

353 
	#__libc_lock_Œylock_»cursive
(
NAME
) \

354 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
)), 0)

	)

357 
	#__¹ld_lock_Œylock_»cursive
(
NAME
) \

358 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_Œylock
, (&(
NAME
).
mu‹x
), 0)

	)

361 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

362 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

366 
__libc_lock_uÆock_â
 (
__libc_lock_t
 *);

367 
libc_hidd’_´Ùo
 (
__libc_lock_uÆock_â
);

369 #ià
__OPTION_EGLIBC_BIG_MACROS


370 
	#__libc_lock_uÆock
(
NAME
) \

371 
	`Îl_uÆock
 (
NAME
, 
LLL_PRIVATE
)

	)

373 
	#__libc_lock_uÆock
(
NAME
) \

374 
	`__libc_lock_uÆock_â
 (&(
NAME
))

	)

377 
	#__libc_lock_uÆock
(
NAME
) \

378 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
)), 0)

	)

380 
	#__libc_rwlock_uÆock
(
NAME
) \

381 
	`__libc_±f_ÿÎ
 (
__±h»ad_rwlock_uÆock
, (&(
NAME
)), 0)

	)

384 #ià
defšed
 
_LIBC
 && (!defšed 
NOT_IN_libc
 || defšed 
IS_IN_lib±h»ad
)

385 #ià
__OPTION_EGLIBC_BIG_MACROS
 != 1

389 
__libc_lock_uÆock_»cursive_â
 (
__libc_lock_»cursive_t
 *);

390 
libc_hidd’_´Ùo
 (
__libc_lock_uÆock_»cursive_â
);

392 #ià
__OPTION_EGLIBC_BIG_MACROS


394 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

396 ià(--(
NAME
).
út
 == 0) \

398 (
NAME
).
owÃr
 = 
NULL
; \

399 
	`Îl_uÆock
 ((
NAME
).
lock
, 
LLL_PRIVATE
); \

401 } 0)

	)

403 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

404 
	`__libc_lock_uÆock_»cursive_â
 (&(
NAME
))

	)

407 
	#__libc_lock_uÆock_»cursive
(
NAME
) \

408 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
)), 0)

	)

411 #ià
defšed
 
_LIBC
 && defšed 
SHARED


412 
	#__¹ld_lock_deçuÉ_lock_»cursive
(
lock
) \

413 ++((
±h»ad_mu‹x_t
 *)(
lock
))->
__d©a
.
__couÁ
;

	)

415 
	#__¹ld_lock_deçuÉ_uÆock_»cursive
(
lock
) \

416 --((
±h»ad_mu‹x_t
 *)(
lock
))->
__d©a
.
__couÁ
;

	)

418 
	#__¹ld_lock_lock_»cursive
(
NAME
) \

419 
	`GL
(
dl_¹ld_lock_»cursive
è(&(
NAME
).
mu‹x
)

	)

421 
	#__¹ld_lock_uÆock_»cursive
(
NAME
) \

422 
	`GL
(
dl_¹ld_uÆock_»cursive
è(&(
NAME
).
mu‹x
)

	)

424 
	#__¹ld_lock_lock_»cursive
(
NAME
) \

425 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_lock
, (&(
NAME
).
mu‹x
), 0)

	)

427 
	#__¹ld_lock_uÆock_»cursive
(
NAME
) \

428 
	`__libc_maybe_ÿÎ
 (
__±h»ad_mu‹x_uÆock
, (&(
NAME
).
mu‹x
), 0)

	)

432 #ià
PTHREAD_ONCE_INIT
 == 0

435 
	#__libc_Úû_defše
(
CLASS
, 
NAME
) \

436 
CLASS
 
±h»ad_Úû_t
 
NAME


	)

438 
	#__libc_Úû_defše
(
CLASS
, 
NAME
) \

439 
CLASS
 
±h»ad_Úû_t
 
NAME
 = 
PTHREAD_ONCE_INIT


	)

443 
	#__libc_Úû
(
ONCE_CONTROL
, 
INIT_FUNCTION
) \

445 ià(
	`PTFAVAIL
 (
__±h»ad_Úû
)) \

446 
	`__libc_±f_ÿÎ_®ways
 (
__±h»ad_Úû
, (&(
ONCE_CONTROL
), \

447 
INIT_FUNCTION
)); \

448 ià((
ONCE_CONTROL
è=ğ
PTHREAD_ONCE_INIT
) { \

449 
	`INIT_FUNCTION
 (); \

450 (
ONCE_CONTROL
) |= 2; \

452 } 0)

	)

459 
_±h»ad_ş—nup_push
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

460 (*
routše
è(*), *
¬g
);

461 
	`_±h»ad_ş—nup_pİ
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

462 
execu‹
);

463 
	`_±h»ad_ş—nup_push_deãr
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

464 (*
routše
è(*), *
¬g
);

465 
	`_±h»ad_ş—nup_pİ_»¡Üe
 (
_±h»ad_ş—nup_bufãr
 *
bufãr
,

466 
execu‹
);

469 
	#__libc_ş—nup_»giÚ_¡¬t
(
DOIT
, 
FCT
, 
ARG
) \

470 { 
_±h»ad_ş—nup_bufãr
 
_bufãr
; \

471 
_ava
; \

472 ià(
DOIT
) { \

473 
_ava
 = 
	`PTFAVAIL
 (
_±h»ad_ş—nup_push_deãr
); \

474 ià(
_ava
) { \

475 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_push_deãr
, (&
_bufãr
, 
FCT
, \

476 
ARG
)); \

478 
_bufãr
.
__routše
 = (
FCT
); \

479 
_bufãr
.
__¬g
 = (
ARG
); \

482 
_ava
 = 0; \

483 }

	)

486 
	#__libc_ş—nup_»giÚ_’d
(
DOIT
) \

487 ià(
_ava
) { \

488 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

489 } ià(
DOIT
) \

490 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
); \

491 
	}

	)
}

494 
	#__libc_ş—nup_’d
(
DOIT
) \

495 ià(
_ava
) { \

496 
	`__libc_±f_ÿÎ_®ways
 (
_±h»ad_ş—nup_pİ_»¡Üe
, (&
_bufãr
, 
DOIT
));\

497 } ià(
DOIT
) \

498 
_bufãr
.
	`__routše
 (_bufãr.
__¬g
)

	)

502 
__ex‹º_šlše
 

503 
	$__libc_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
f
)

505 ià(
f
->
__do_™
)

506 
f
->
	`__ÿnûl_routše
 (f->
__ÿnûl_¬g
);

507 
	}
}

509 
	#__libc_ş—nup_push
(
fù
, 
¬g
) \

511 
__±h»ad_ş—nup_äame
 
__şäame
 \

512 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__libc_ş—nup_routše
))) \

513 ğ{ .
__ÿnûl_routše
 = (
fù
), .
__ÿnûl_¬g
 = (
¬g
), \

514 .
__do_™
 = 1 };

	)

516 
	#__libc_ş—nup_pİ
(
execu‹
) \

517 
__şäame
.
__do_™
 = (
execu‹
); \

518 } 0)

	)

522 
	#__libc_key_ü—‹
(
KEY
, 
DESTRUCTOR
) \

523 
	`__libc_±f_ÿÎ
 (
__±h»ad_key_ü—‹
, (
KEY
, 
DESTRUCTOR
), 1)

	)

526 
	#__libc_g‘¥ecific
(
KEY
) \

527 
	`__libc_±f_ÿÎ
 (
__±h»ad_g‘¥ecific
, (
KEY
), 
NULL
)

	)

530 
	#__libc_£t¥ecific
(
KEY
, 
VALUE
) \

531 
	`__libc_±f_ÿÎ
 (
__±h»ad_£t¥ecific
, (
KEY
, 
VALUE
), 0)

	)

537 
	#__libc_©fÜk
(
PREPARE
, 
PARENT
, 
CHILD
) \

538 
	`__»gi¡”_©fÜk
 (
PREPARE
, 
PARENT
, 
CHILD
, 
NULL
)

	)

539 
__»gi¡”_©fÜk
 ((*
__´•¬e
) (),

540 (*
__·»Á
) (),

541 (*
__chd
) (),

542 *
__dso_hªdË
);

547 
	`__±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

548 
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__mu‹x_©Œ
);

550 
	`__±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

552 
	`__±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

554 
	`__±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

556 
	`__±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
);

558 
	`__±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
);

560 
	`__±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
);

562 
	`__±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

563 
__kšd
);

565 #ifdeà
__USE_UNIX98


566 
	`__±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__rwlock
,

567 
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *
__©Œ
);

569 
	`__±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
);

571 
	`__±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
);

573 
	`__±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
);

575 
	`__±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
);

577 
	`__±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
);

579 
	`__±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
);

582 
	`__±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

583 (*
__de¡r_funùiÚ
) (*));

585 
	`__±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

586 
__cÚ¡
 *
__poš‹r
);

588 *
	`__±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
);

590 
	`__±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

591 (*
__š™_routše
) ());

593 
	`__±h»ad_©fÜk
 ((*
__´•¬e
) (),

594 (*
__·»Á
) (),

595 (*
__chd
) ());

601 #iâdeà
__NO_WEAK_PTHREAD_ALIASES


602 #ifdeà
w—k_ex‹º


603 #ià
_LIBC


604 
	~<bp-sym.h
>

606 
	#BP_SYM
(
sym
è
	)
sym

608 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_š™
))

609 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_de¡roy
))

610 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_lock
))

611 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_Œylock
))

612 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x_uÆock
))

613 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_š™
))

614 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_de¡roy
))

615 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_mu‹x©Œ_£‰y³
))

616 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_š™
))

617 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_de¡roy
))

618 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_rdlock
))

619 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_Œyrdlock
))

620 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_w¾ock
))

621 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_Œyw¾ock
))

622 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_rwlock_uÆock
))

623 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_key_ü—‹
))

624 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_£t¥ecific
))

625 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_g‘¥ecific
))

626 
	`w—k_ex‹º
 (
	$BP_SYM
 (
__±h»ad_Úû
))

627 
	$w—k_ex‹º
 (
__±h»ad_š™Ÿlize
)

628 
	$w—k_ex‹º
 (
__±h»ad_©fÜk
)

629 
	`w—k_ex‹º
 (
	$BP_SYM
 (
_±h»ad_ş—nup_push_deãr
))

630 
	`w—k_ex‹º
 (
	$BP_SYM
 (
_±h»ad_ş—nup_pİ_»¡Üe
))

631 
	`w—k_ex‹º
 (
	$BP_SYM
 (
±h»ad_£tÿnûl¡©e
))

633 #´agm¨
w—k
 
__±h»ad_mu‹x_š™


634 #´agm¨
w—k
 
__±h»ad_mu‹x_de¡roy


635 #´agm¨
w—k
 
__±h»ad_mu‹x_lock


636 #´agm¨
w—k
 
__±h»ad_mu‹x_Œylock


637 #´agm¨
w—k
 
__±h»ad_mu‹x_uÆock


638 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_š™


639 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_de¡roy


640 #´agm¨
w—k
 
__±h»ad_mu‹x©Œ_£‰y³


641 #´agm¨
w—k
 
__±h»ad_rwlock_de¡roy


642 #´agm¨
w—k
 
__±h»ad_rwlock_rdlock


643 #´agm¨
w—k
 
__±h»ad_rwlock_Œyrdlock


644 #´agm¨
w—k
 
__±h»ad_rwlock_w¾ock


645 #´agm¨
w—k
 
__±h»ad_rwlock_Œyw¾ock


646 #´agm¨
w—k
 
__±h»ad_rwlock_uÆock


647 #´agm¨
w—k
 
__±h»ad_key_ü—‹


648 #´agm¨
w—k
 
__±h»ad_£t¥ecific


649 #´agm¨
w—k
 
__±h»ad_g‘¥ecific


650 #´agm¨
w—k
 
__±h»ad_Úû


651 #´agm¨
w—k
 
__±h»ad_š™Ÿlize


652 #´agm¨
w—k
 
__±h»ad_©fÜk


653 #´agm¨
w—k
 
_±h»ad_ş—nup_push_deãr


654 #´agm¨
w—k
 
_±h»ad_ş—nup_pİ_»¡Üe


655 #´agm¨
w—k
 
±h»ad_£tÿnûl¡©e


	@/usr/include/gconv.h

23 #iâdeà
_GCONV_H


24 
	#_GCONV_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	#__Ãed_mb¡©e_t


	)

28 
	#__Ãed_wšt_t


	)

29 
	~<wch¬.h
>

30 
	#__Ãed_size_t


	)

31 
	#__Ãed_wch¬_t


	)

32 
	~<¡ddef.h
>

35 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

40 
	m__GCONV_OK
 = 0,

41 
	m__GCONV_NOCONV
,

42 
	m__GCONV_NODB
,

43 
	m__GCONV_NOMEM
,

45 
	m__GCONV_EMPTY_INPUT
,

46 
	m__GCONV_FULL_OUTPUT
,

47 
	m__GCONV_ILLEGAL_INPUT
,

48 
	m__GCONV_INCOMPLETE_INPUT
,

50 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

51 
	m__GCONV_INTERNAL_ERROR


58 
	m__GCONV_IS_LAST
 = 0x0001,

59 
	m__GCONV_IGNORE_ERRORS
 = 0x0002

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

72 
	t__cÚ¡
 **, __const *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

86 
	t__cÚ¡
 *,

87 
	t__cÚ¡
 **,

88 
	t__cÚ¡
 *, **,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
è(*, 
	t__cÚ¡
 *,

93 
	t__cÚ¡
 *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
è(
	t__cÚ¡
 *, __const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 
__cÚ¡
 *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___k”Ãl_co¦


	)

11 
	#__¡ub___k”Ãl_sšl


	)

12 
	#__¡ub___k”Ãl_Æ


	)

13 
	#__¡ub_chæags


	)

14 
	#__¡ub_ç‰ach


	)

15 
	#__¡ub_fchæags


	)

16 
	#__¡ub_fd‘ach


	)

17 
	#__¡ub_g‰y


	)

18 
	#__¡ub_lchmod


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ç‰ach


	)

13 
	#__¡ub_fchæags


	)

14 
	#__¡ub_fd‘ach


	)

15 
	#__¡ub_g‘msg


	)

16 
	#__¡ub_g‰y


	)

17 
	#__¡ub_lchmod


	)

18 
	#__¡ub_putmsg


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/linux/stddef.h

1 #iâdeà
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #undeà
NULL


7 #ià
defšed
(
__ılu¥lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@/usr/include/linux/swab.h

1 #iâdeà
_LINUX_SWAB_H


2 
	#_LINUX_SWAB_H


	)

4 
	~<lšux/ty³s.h
>

6 
	~<asm/swab.h
>

12 
	#___cÚ¡ªt_swab16
(
x
è((
__u16
)( \

13 (((
__u16
)(
x
) & (__u16)0x00ffU) << 8) | \

14 (((
__u16
)(
x
è& (__u16)0xff00Uè>> 8)))

	)

16 
	#___cÚ¡ªt_swab32
(
x
è((
__u32
)( \

17 (((
__u32
)(
x
) & (__u32)0x000000ffUL) << 24) | \

18 (((
__u32
)(
x
) & (__u32)0x0000ff00UL) << 8) | \

19 (((
__u32
)(
x
) & (__u32)0x00ff0000UL) >> 8) | \

20 (((
__u32
)(
x
è& (__u32)0xff000000ULè>> 24)))

	)

22 
	#___cÚ¡ªt_swab64
(
x
è((
__u64
)( \

23 (((
__u64
)(
x
) & (__u64)0x00000000000000ffULL) << 56) | \

24 (((
__u64
)(
x
) & (__u64)0x000000000000ff00ULL) << 40) | \

25 (((
__u64
)(
x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

26 (((
__u64
)(
x
) & (__u64)0x00000000ff000000ULL) << 8) | \

27 (((
__u64
)(
x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

28 (((
__u64
)(
x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

29 (((
__u64
)(
x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

30 (((
__u64
)(
x
è& (__u64)0xff00000000000000ULLè>> 56)))

	)

32 
	#___cÚ¡ªt_swahw32
(
x
è((
__u32
)( \

33 (((
__u32
)(
x
) & (__u32)0x0000ffffUL) << 16) | \

34 (((
__u32
)(
x
è& (__u32)0xffff0000ULè>> 16)))

	)

36 
	#___cÚ¡ªt_swahb32
(
x
è((
__u32
)( \

37 (((
__u32
)(
x
) & (__u32)0x00ff00ffUL) << 8) | \

38 (((
__u32
)(
x
è& (__u32)0xff00ff00ULè>> 8)))

	)

46 
__šlše__
 
__u16
 
	$__fswab16
(
__u16
 
v®
)

48 #ifdeà
__¬ch_swab16


49  
	`__¬ch_swab16
(
v®
);

51  
	`___cÚ¡ªt_swab16
(
v®
);

53 
	}
}

55 
__šlše__
 
__u32
 
	$__fswab32
(
__u32
 
v®
)

57 #ifdeà
__¬ch_swab32


58  
	`__¬ch_swab32
(
v®
);

60  
	`___cÚ¡ªt_swab32
(
v®
);

62 
	}
}

64 
__šlše__
 
__u64
 
	$__fswab64
(
__u64
 
v®
)

66 #ifdeà
__¬ch_swab64


67  
	`__¬ch_swab64
(
v®
);

68 #–ià
	`defšed
(
__SWAB_64_THRU_32__
)

69 
__u32
 
h
 = 
v®
 >> 32;

70 
__u32
 
l
 = 
v®
 & ((1ULL << 32) - 1);

71  (((
__u64
)
	`__fswab32
(
l
)è<< 32è| ((__u64)(__fswab32(
h
)));

73  
	`___cÚ¡ªt_swab64
(
v®
);

75 
	}
}

77 
__šlše__
 
__u32
 
	$__fswahw32
(
__u32
 
v®
)

79 #ifdeà
__¬ch_swahw32


80  
	`__¬ch_swahw32
(
v®
);

82  
	`___cÚ¡ªt_swahw32
(
v®
);

84 
	}
}

86 
__šlše__
 
__u32
 
	$__fswahb32
(
__u32
 
v®
)

88 #ifdeà
__¬ch_swahb32


89  
	`__¬ch_swahb32
(
v®
);

91  
	`___cÚ¡ªt_swahb32
(
v®
);

93 
	}
}

99 
	#__swab16
(
x
) \

100 (
	`__butš_cÚ¡ªt_p
((
__u16
)(
x
)) ? \

101 
	`___cÚ¡ªt_swab16
(
x
) : \

102 
	`__fswab16
(
x
))

	)

108 
	#__swab32
(
x
) \

109 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

110 
	`___cÚ¡ªt_swab32
(
x
) : \

111 
	`__fswab32
(
x
))

	)

117 
	#__swab64
(
x
) \

118 (
	`__butš_cÚ¡ªt_p
((
__u64
)(
x
)) ? \

119 
	`___cÚ¡ªt_swab64
(
x
) : \

120 
	`__fswab64
(
x
))

	)

128 
	#__swahw32
(
x
) \

129 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

130 
	`___cÚ¡ªt_swahw32
(
x
) : \

131 
	`__fswahw32
(
x
))

	)

139 
	#__swahb32
(
x
) \

140 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

141 
	`___cÚ¡ªt_swahb32
(
x
) : \

142 
	`__fswahb32
(
x
))

	)

148 
__šlše__
 
__u16
 
	$__swab16p
(cÚ¡ 
__u16
 *
p
)

150 #ifdeà
__¬ch_swab16p


151  
	`__¬ch_swab16p
(
p
);

153  
	`__swab16
(*
p
);

155 
	}
}

161 
__šlše__
 
__u32
 
	$__swab32p
(cÚ¡ 
__u32
 *
p
)

163 #ifdeà
__¬ch_swab32p


164  
	`__¬ch_swab32p
(
p
);

166  
	`__swab32
(*
p
);

168 
	}
}

174 
__šlše__
 
__u64
 
	$__swab64p
(cÚ¡ 
__u64
 *
p
)

176 #ifdeà
__¬ch_swab64p


177  
	`__¬ch_swab64p
(
p
);

179  
	`__swab64
(*
p
);

181 
	}
}

189 
__šlše__
 
__u32
 
	$__swahw32p
(cÚ¡ 
__u32
 *
p
)

191 #ifdeà
__¬ch_swahw32p


192  
	`__¬ch_swahw32p
(
p
);

194  
	`__swahw32
(*
p
);

196 
	}
}

204 
__šlše__
 
__u32
 
	$__swahb32p
(cÚ¡ 
__u32
 *
p
)

206 #ifdeà
__¬ch_swahb32p


207  
	`__¬ch_swahb32p
(
p
);

209  
	`__swahb32
(*
p
);

211 
	}
}

217 
__šlše__
 
	$__swab16s
(
__u16
 *
p
)

219 #ifdeà
__¬ch_swab16s


220 
	`__¬ch_swab16s
(
p
);

222 *
p
 = 
	`__swab16p
(p);

224 
	}
}

229 
__šlše__
 
	$__swab32s
(
__u32
 *
p
)

231 #ifdeà
__¬ch_swab32s


232 
	`__¬ch_swab32s
(
p
);

234 *
p
 = 
	`__swab32p
(p);

236 
	}
}

242 
__šlše__
 
	$__swab64s
(
__u64
 *
p
)

244 #ifdeà
__¬ch_swab64s


245 
	`__¬ch_swab64s
(
p
);

247 *
p
 = 
	`__swab64p
(p);

249 
	}
}

257 
__šlše__
 
	$__swahw32s
(
__u32
 *
p
)

259 #ifdeà
__¬ch_swahw32s


260 
	`__¬ch_swahw32s
(
p
);

262 *
p
 = 
	`__swahw32p
(p);

264 
	}
}

272 
__šlše__
 
	$__swahb32s
(
__u32
 *
p
)

274 #ifdeà
__¬ch_swahb32s


275 
	`__¬ch_swahb32s
(
p
);

277 *
p
 = 
	`__swahb32p
(p);

279 
	}
}

	@/usr/include/wchar.h

24 #iâdeà
_WCHAR_H


26 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


27 
	#_WCHAR_H
 1

	)

28 
	~<ã©u»s.h
>

31 #ifdeà
_WCHAR_H


33 
	#__Ãed___FILE


	)

34 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


35 
	#__Ãed_FILE


	)

37 
	~<¡dio.h
>

39 
	#__Ãed___va_li¡


	)

40 
	~<¡d¬g.h
>

42 
	~<b™s/wch¬.h
>

45 
	#__Ãed_size_t


	)

46 
	#__Ãed_wch¬_t


	)

47 
	#__Ãed_NULL


	)

49 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


50 #undeà
__Ãed_wšt_t


51 
	#__Ãed_wšt_t


	)

52 
	~<¡ddef.h
>

55 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

56 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

61 #iâdeà
_WINT_T


66 
	#_WINT_T


	)

67 
	twšt_t
;

71 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

72 && 
defšed
 
__WINT_TYPE__


73 
__BEGIN_NAMESPACE_STD


74 
__WINT_TYPE__
 
	twšt_t
;

75 
	g__END_NAMESPACE_STD


80 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
__mb¡©e_t_defšed


81 
	#__mb¡©e_t_defšed
 1

	)

85 
	m__couÁ
;

88 #ifdeà
__WINT_TYPE__


89 
__WINT_TYPE__
 
	m__wch
;

91 
wšt_t
 
	m__wch
;

93 
	m__wchb
[4];

94 } 
	m__v®ue
;

95 } 
	t__mb¡©e_t
;

97 #undeà
__Ãed_mb¡©e_t


102 #ifdeà
_WCHAR_H


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 #ifdeà
__USE_GNU


109 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

112 #iâdeà
WCHAR_MIN


114 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

115 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

118 #iâdeà
WEOF


119 
	#WEOF
 (0xffffffffu)

	)

124 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


125 
	~<wùy³.h
>

129 
__BEGIN_DECLS


131 
__BEGIN_NAMESPACE_STD


134 
tm
;

135 
__END_NAMESPACE_STD


139 
	$__USING_NAMESPACE_STD
(
tm
)

142 
__BEGIN_NAMESPACE_STD


144 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

145 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

147 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

149 
__THROW
;

152 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

153 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

155 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

156 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

157 
__THROW
;

160 
	$wcscmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
)

161 
__THROW
 
__©Œibu‹_pu»__
;

163 
	$wc¢cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

164 
__THROW
 
__©Œibu‹_pu»__
;

165 
__END_NAMESPACE_STD


167 #ifdeà
__USE_XOPEN2K8


169 
	$wcsÿ£cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

172 
	$wc¢ÿ£cmp
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

173 
size_t
 
__n
è
__THROW
;

177 
	~<xloÿË.h
>

179 
	$wcsÿ£cmp_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

180 
__loÿË_t
 
__loc
è
__THROW
;

182 
	$wc¢ÿ£cmp_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

183 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

186 
__BEGIN_NAMESPACE_STD


189 
	$wcscŞl
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

193 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

194 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

195 
__END_NAMESPACE_STD


197 #ifdeà
__USE_XOPEN2K8


203 
	$wcscŞl_l
 (
__cÚ¡
 
wch¬_t
 *
__s1
, __cÚ¡ wch¬_ˆ*
__s2
,

204 
__loÿË_t
 
__loc
è
__THROW
;

209 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
,

210 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

213 
wch¬_t
 *
	$wcsdup
 (
__cÚ¡
 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

216 
__BEGIN_NAMESPACE_STD


218 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


219 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

220 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

221 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wcschr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

222 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

224 
wch¬_t
 *
	$wcschr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

225 
__THROW
 
__©Œibu‹_pu»__
;

228 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


229 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

230 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

231 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wc¤chr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

232 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

234 
wch¬_t
 *
	$wc¤chr
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

235 
__THROW
 
__©Œibu‹_pu»__
;

237 
__END_NAMESPACE_STD


239 #ifdeà
__USE_GNU


242 
wch¬_t
 *
	$wcschºul
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

243 
__THROW
 
__©Œibu‹_pu»__
;

246 
__BEGIN_NAMESPACE_STD


249 
size_t
 
	$wcsc¥n
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__»jeù
)

250 
__THROW
 
__©Œibu‹_pu»__
;

253 
size_t
 
	$wcs¥n
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__acû±
)

254 
__THROW
 
__©Œibu‹_pu»__
;

256 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


257 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, 
__cÚ¡
 wch¬_ˆ*
__acû±
)

258 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

259 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wc¥brk
 (
__cÚ¡
 
wch¬_t
 *
__wcs
,

260 
__cÚ¡
 
wch¬_t
 *
__acû±
)

261 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

263 
wch¬_t
 *
	$wc¥brk
 (
__cÚ¡
 
wch¬_t
 *
__wcs
, __cÚ¡ wch¬_ˆ*
__acû±
)

264 
__THROW
 
__©Œibu‹_pu»__
;

267 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


268 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, 
__cÚ¡
 wch¬_ˆ*
__ÃedË
)

269 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

270 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wcs¡r
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
,

271 
__cÚ¡
 
wch¬_t
 *
__ÃedË
)

272 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

274 
wch¬_t
 *
	$wcs¡r
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
, __cÚ¡ wch¬_ˆ*
__ÃedË
)

275 
__THROW
 
__©Œibu‹_pu»__
;

279 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

280 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__d–im
,

281 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

284 
size_t
 
	$wc¦’
 (
__cÚ¡
 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

285 
__END_NAMESPACE_STD


287 #ifdeà
__USE_XOPEN


289 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


290 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, 
__cÚ¡
 wch¬_ˆ*
__ÃedË
)

291 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

292 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wcswcs
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
,

293 
__cÚ¡
 
wch¬_t
 *
__ÃedË
)

294 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

296 
wch¬_t
 *
	$wcswcs
 (
__cÚ¡
 
wch¬_t
 *
__hay¡ack
, __cÚ¡ wch¬_ˆ*
__ÃedË
)

297 
__THROW
 
__©Œibu‹_pu»__
;

301 #ifdeà
__USE_XOPEN2K8


303 
size_t
 
	$wc¢Ën
 (
__cÚ¡
 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

304 
__THROW
 
__©Œibu‹_pu»__
;

308 
__BEGIN_NAMESPACE_STD


310 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


311 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

312 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

313 "C++" 
__cÚ¡
 
wch¬_t
 *
	$wmemchr
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

314 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

317 
wch¬_t
 *
	$wmemchr
 (
__cÚ¡
 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

318 
__THROW
 
__©Œibu‹_pu»__
;

322 
	$wmemcmp
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s1
,

323 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

324 
__THROW
 
__©Œibu‹_pu»__
;

327 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

328 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

332 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
, 
size_t
 
__n
)

333 
__THROW
;

336 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

337 
__END_NAMESPACE_STD


339 #ifdeà
__USE_GNU


342 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

343 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

344 
__THROW
;

348 
__BEGIN_NAMESPACE_STD


351 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

355 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

359 
	$mbsš™
 (
__cÚ¡
 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

363 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

364 
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

365 
mb¡©e_t
 *
__p
è
__THROW
;

368 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

369 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

372 
size_t
 
	$__mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

373 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

374 
size_t
 
	$mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

375 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
__END_NAMESPACE_STD


378 #ifdeà
__USE_EXTERN_INLINES


384 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

385 
__ex‹º_šlše
 
wšt_t


386 
	`__NTH
 (
	$btowc
 (
__c
))

387 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

388 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

390 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

391 
__ex‹º_šlše
 

392 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

393 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

394 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

396 
__ex‹º_šlše
 
size_t


397 
__NTH
 (
	$mb¾’
 (
__cÚ¡
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

398 
mb¡©e_t
 *
__»¡riù
 
__ps
))

399 {  (
__ps
 !ğ
NULL


400 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

403 
__BEGIN_NAMESPACE_STD


406 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

407 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

408 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

412 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

413 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

414 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

415 
__END_NAMESPACE_STD


418 #ifdef 
__USE_XOPEN2K8


421 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

422 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

423 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

427 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

428 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

429 
size_t
 
__nwc
, size_ˆ
__Ën
,

430 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

435 #ifdeà
__USE_XOPEN


437 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

441 
	$wcswidth
 (
__cÚ¡
 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

445 
__BEGIN_NAMESPACE_STD


448 
	$wc¡od
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

449 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

450 
__END_NAMESPACE_STD


452 #ifdeà
__USE_ISOC99


453 
__BEGIN_NAMESPACE_C99


455 
	$wc¡of
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

456 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

457 
	$wc¡Şd
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

459 
__END_NAMESPACE_C99


463 
__BEGIN_NAMESPACE_STD


466 
	$wc¡Ş
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

467 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

471 
	$wc¡oul
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

472 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

473 
__THROW
;

474 
__END_NAMESPACE_STD


476 #ià
defšed
 
__USE_ISOC99
 || (defšed 
__GNUC__
 && defšed 
__USE_GNU
)

477 
__BEGIN_NAMESPACE_C99


480 
__ex‹nsiÚ__


481 
	$wc¡Şl
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

482 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

483 
__THROW
;

487 
__ex‹nsiÚ__


488 
	$wc¡ouÎ
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

489 
wch¬_t
 **
__»¡riù
 
__’d±r
,

490 
__ba£
è
__THROW
;

491 
__END_NAMESPACE_C99


494 #ià
defšed
 
__GNUC__
 && defšed 
__USE_GNU


497 
__ex‹nsiÚ__


498 
	$wc¡oq
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

499 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

500 
__THROW
;

504 
__ex‹nsiÚ__


505 
	$wc¡ouq
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

506 
wch¬_t
 **
__»¡riù
 
__’d±r
,

507 
__ba£
è
__THROW
;

510 #ifdeà
__USE_GNU


524 
	~<xloÿË.h
>

528 
	$wc¡Ş_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

529 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

530 
__loÿË_t
 
__loc
è
__THROW
;

532 
	$wc¡oul_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

533 
wch¬_t
 **
__»¡riù
 
__’d±r
,

534 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

536 
__ex‹nsiÚ__


537 
	$wc¡Şl_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

538 
wch¬_t
 **
__»¡riù
 
__’d±r
,

539 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

541 
__ex‹nsiÚ__


542 
	$wc¡ouÎ_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

543 
wch¬_t
 **
__»¡riù
 
__’d±r
,

544 
__ba£
, 
__loÿË_t
 
__loc
)

545 
__THROW
;

547 
	$wc¡od_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

548 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

549 
__THROW
;

551 
	$wc¡of_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

552 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

553 
__THROW
;

555 
	$wc¡Şd_l
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

556 
wch¬_t
 **
__»¡riù
 
__’d±r
,

557 
__loÿË_t
 
__loc
è
__THROW
;

561 #ifdef 
__USE_XOPEN2K8


564 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
è
__THROW
;

568 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
)

569 
__THROW
;

575 #ifdef 
__USE_XOPEN2K8


578 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

581 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


582 
__BEGIN_NAMESPACE_STD


585 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

592 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

593 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

599 
	`w´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

602 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

603 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
__THROW
 ;

610 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

611 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

612 
__gnuc_va_li¡
 
__¬g
)

618 
	`vw´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

619 
__gnuc_va_li¡
 
__¬g
)

623 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

624 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

625 
__gnuc_va_li¡
 
__¬g
)

626 
__THROW
 ;

633 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

634 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

640 
	`wsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

643 
	$swsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

644 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
__THROW
 ;

647 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

648 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

649 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

650 #ifdeà
__REDIRECT


654 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

655 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

656 
__isoc99_fwsÿnf
)

658 
	`__REDIRECT
 (
wsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

659 
__isoc99_wsÿnf
)

661 
	`__REDIRECT
 (
swsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

662 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

663 
__isoc99_swsÿnf
)

664 
__THROW
 ;

666 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

667 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

668 
	`__isoc99_wsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

669 
	$__isoc99_swsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

670 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

671 
__THROW
;

672 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

673 
	#wsÿnf
 
__isoc99_wsÿnf


	)

674 
	#swsÿnf
 
__isoc99_swsÿnf


	)

678 
__END_NAMESPACE_STD


681 #ifdeà
__USE_ISOC99


682 
__BEGIN_NAMESPACE_C99


687 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

688 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

689 
__gnuc_va_li¡
 
__¬g
)

695 
	`vwsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

696 
__gnuc_va_li¡
 
__¬g
)

699 
	$vswsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

700 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

701 
__gnuc_va_li¡
 
__¬g
)

702 
__THROW
 ;

704 #ià!
defšed
 
__USE_GNU
 \

705 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

706 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

707 #ifdeà
__REDIRECT


708 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

709 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

710 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

712 
	`__REDIRECT
 (
vwsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

713 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

715 
	`__REDIRECT
 (
vswsÿnf
, (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

716 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

717 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

718 
__THROW
 ;

720 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

721 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

722 
__gnuc_va_li¡
 
__¬g
);

723 
	`__isoc99_vwsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

724 
__gnuc_va_li¡
 
__¬g
);

725 
	$__isoc99_vswsÿnf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s
,

726 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

727 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

728 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

729 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

730 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

734 
__END_NAMESPACE_C99


738 
__BEGIN_NAMESPACE_STD


743 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

744 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

750 
wšt_t
 
	`g‘wch¬
 ();

757 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

758 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

764 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

772 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

773 
__FILE
 *
__»¡riù
 
__¡»am
);

779 
	`åutws
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ws
,

780 
__FILE
 *
__»¡riù
 
__¡»am
);

787 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

788 
__END_NAMESPACE_STD


791 #ifdeà
__USE_GNU


799 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

800 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

808 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

816 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

825 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

826 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

835 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

836 
__FILE
 *
__»¡riù
 
__¡»am
);

844 
	`åutws_uÆocked
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__ws
,

845 
__FILE
 *
__»¡riù
 
__¡»am
);

849 
__BEGIN_NAMESPACE_C99


853 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

854 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

855 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

856 
__END_NAMESPACE_C99


858 #ifdeà
__USE_GNU


859 
	~<xloÿË.h
>

863 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

864 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

865 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

866 
__loÿË_t
 
__loc
è
__THROW
;

875 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


876 
	#__Ãed_iswxxx


	)

877 
	~<wùy³.h
>

881 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


882 
	~<b™s/wch¬2.h
>

885 #ifdeà
__LDBL_COMPAT


886 
	~<b™s/wch¬-ldbl.h
>

889 
__END_DECLS


897 #undeà
__Ãed_mb¡©e_t


898 #undeà
__Ãed_wšt_t


	@/usr/include/asm-generic/int-ll64.h

8 #iâdeà
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/b™¥”lÚg.h
>

13 #iâdeà
__ASSEMBLY__


19 
__sigÃd__
 
	t__s8
;

20 
	t__u8
;

22 
__sigÃd__
 
	t__s16
;

23 
	t__u16
;

25 
__sigÃd__
 
	t__s32
;

26 
	t__u32
;

28 #ifdeà
__GNUC__


29 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

30 
__ex‹nsiÚ__
 
	t__u64
;

32 
__sigÃd__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm/swab.h

1 #iâdeà
_ASM_X86_SWAB_H


2 
	#_ASM_X86_SWAB_H


	)

4 
	~<lšux/ty³s.h
>

7 
__šlše__
 
__u32
 
	$__¬ch_swab32
(
__u32
 
v®
)

9 #ifdeà
__i386__


10 #ifdeà
CONFIG_X86_BSWAP


11 
	`__asm__
("bsw­ %0" : "ô" (
v®
) : "0" (val));

13 
	`__asm__
("xchgb %b0,%h0\n\t"

16 : "=q" (
v®
)

17 : "0" (
v®
));

21 
	`__asm__
("bswapl %0"

22 : "ô" (
v®
)

23 : "0" (
v®
));

25  
v®
;

26 
	}
}

27 
	#__¬ch_swab32
 
__¬ch_swab32


	)

29 
__šlše__
 
__u64
 
	$__¬ch_swab64
(
__u64
 
v®
)

31 #ifdeà
__i386__


34 
__u32
 
a
;

35 
__u32
 
b
;

36 } 
s
;

37 
__u64
 
u
;

38 } 
v
;

39 
v
.
u
 = 
v®
;

40 #ifdeà
CONFIG_X86_BSWAP


41 
	`__asm__
("bswapl %0 ; bswapl %1 ; xchgl %0,%1"

42 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

43 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

45 
v
.
s
.
a
 = 
	`__¬ch_swab32
(v.s.a);

46 
v
.
s
.
b
 = 
	`__¬ch_swab32
(v.s.b);

47 
	`__asm__
("xchgl %0,%1"

48 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

49 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

51  
v
.
u
;

53 
	`__asm__
("bswapq %0"

54 : "ô" (
v®
)

55 : "0" (
v®
));

56  
v®
;

58 
	}
}

59 
	#__¬ch_swab64
 
__¬ch_swab64


	)

	@/usr/include/bits/wchar-ldbl.h

20 #iâdeà
_WCHAR_H


24 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


25 
__BEGIN_NAMESPACE_C99


26 
__LDBL_REDIR_DECL
 (
fw´štf
);

27 
__LDBL_REDIR_DECL
 (
w´štf
);

28 
__LDBL_REDIR_DECL
 (
sw´štf
);

29 
__LDBL_REDIR_DECL
 (
vfw´štf
);

30 
__LDBL_REDIR_DECL
 (
vw´štf
);

31 
__LDBL_REDIR_DECL
 (
vsw´štf
);

32 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

33 && !
defšed
 
	g__REDIRECT
 \

34 && (
defšed
 
	g__STRICT_ANSI__
 || defšed 
	g__USE_XOPEN2K
)

35 
	$__LDBL_REDIR1_DECL
 (
fwsÿnf
, 
__Ædbl___isoc99_fwsÿnf
)

36 
	$__LDBL_REDIR1_DECL
 (
wsÿnf
, 
__Ædbl___isoc99_wsÿnf
)

37 
	$__LDBL_REDIR1_DECL
 (
swsÿnf
, 
__Ædbl___isoc99_swsÿnf
)

39 
	`__LDBL_REDIR_DECL
 (
fwsÿnf
);

40 
	`__LDBL_REDIR_DECL
 (
wsÿnf
);

41 
	`__LDBL_REDIR_DECL
 (
swsÿnf
);

43 
__END_NAMESPACE_C99


46 #ifdeà
__USE_ISOC99


47 
__BEGIN_NAMESPACE_C99


48 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd
, 
wc¡od
);

49 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

50 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

51 
	$__LDBL_REDIR1_DECL
 (
vfwsÿnf
, 
__Ædbl___isoc99_vfwsÿnf
)

52 
	$__LDBL_REDIR1_DECL
 (
vwsÿnf
, 
__Ædbl___isoc99_vwsÿnf
)

53 
	$__LDBL_REDIR1_DECL
 (
vswsÿnf
, 
__Ædbl___isoc99_vswsÿnf
)

55 
	`__LDBL_REDIR_DECL
 (
vfwsÿnf
);

56 
	`__LDBL_REDIR_DECL
 (
vwsÿnf
);

57 
	`__LDBL_REDIR_DECL
 (
vswsÿnf
);

59 
__END_NAMESPACE_C99


62 #ifdeà
__USE_GNU


63 
	`__LDBL_REDIR1_DECL
 (
wc¡Şd_l
, 
wc¡od_l
);

66 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


67 
	$__LDBL_REDIR_DECL
 (
__sw´štf_chk
)

68 
	$__LDBL_REDIR_DECL
 (
__vsw´štf_chk
)

69 #ià
__USE_FORTIFY_LEVEL
 > 1

70 
	$__LDBL_REDIR_DECL
 (
__fw´štf_chk
)

71 
	$__LDBL_REDIR_DECL
 (
__w´štf_chk
)

72 
	$__LDBL_REDIR_DECL
 (
__vfw´štf_chk
)

73 
	$__LDBL_REDIR_DECL
 (
__vw´štf_chk
)

	@/usr/include/bits/wchar2.h

20 #iâdeà
_WCHAR_H


25 
wch¬_t
 *
	$__wmemıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

26 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

27 
size_t
 
__ns1
è
__THROW
;

28 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_®Ÿs
,

29 (
wch¬_t
 *
__»¡riù
 
__s1
,

30 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
),

31 
wmemıy
);

32 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemıy_chk_w¬n
,

33 (
wch¬_t
 *
__»¡riù
 
__s1
,

34 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

35 
size_t
 
__ns1
), 
__wmemıy_chk
)

36 
	`__w¬Ç‰r
 ("wmemcpy called with†ength biggerhan size of destination "

39 
__ex‹º_®ways_šlše
 
wch¬_t
 *

40 
	`__NTH
 (
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

41 
size_t
 
__n
))

43 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

45 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

46  
	`__wmemıy_chk
 (
__s1
, 
__s2
, 
__n
,

47 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

49 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

50  
	`__wmemıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

51 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

53  
	`__wmemıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

54 
	}
}

57 
wch¬_t
 *
	$__wmemmove_chk
 (
wch¬_t
 *
__s1
, 
__cÚ¡
 wch¬_ˆ*
__s2
,

58 
size_t
 
__n
, size_ˆ
__ns1
è
__THROW
;

59 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_®Ÿs
, (wch¬_ˆ*
__s1
,

60 
__cÚ¡
 
wch¬_t
 *
__s2
,

61 
size_t
 
__n
), 
wmemmove
);

62 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¬n
,

63 (
wch¬_t
 *
__»¡riù
 
__s1
,

64 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

65 
size_t
 
__ns1
), 
__wmemmove_chk
)

66 
	`__w¬Ç‰r
 ("wmemmove called with†ength biggerhan size of destination "

69 
__ex‹º_®ways_šlše
 
wch¬_t
 *

70 
	`__NTH
 (
	$wmemmove
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

71 
size_t
 
__n
))

73 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

75 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

76  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

77 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

79 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

80  
	`__wmemmove_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

81 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

83  
	`__wmemmove_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

84 
	}
}

87 #ifdeà
__USE_GNU


88 
wch¬_t
 *
	$__wmempıy_chk
 (
wch¬_t
 *
__»¡riù
 
__s1
,

89 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

90 
size_t
 
__ns1
è
__THROW
;

91 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_®Ÿs
,

92 (
wch¬_t
 *
__»¡riù
 
__s1
,

93 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
,

94 
size_t
 
__n
), 
wmempıy
);

95 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmempıy_chk_w¬n
,

96 (
wch¬_t
 *
__»¡riù
 
__s1
,

97 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
,

98 
size_t
 
__ns1
), 
__wmempıy_chk
)

99 
	`__w¬Ç‰r
 ("wmempcpy called with†ength biggerhan size of destination "

102 
__ex‹º_®ways_šlše
 
wch¬_t
 *

103 
	`__NTH
 (
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
, 
__cÚ¡
 wch¬_ˆ*__»¡riù 
__s2
,

104 
size_t
 
__n
))

106 ià(
	`__bos0
 (
__s1
è!ğ(
size_t
) -1)

108 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

109  
	`__wmempıy_chk
 (
__s1
, 
__s2
, 
__n
,

110 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

112 ià(
__n
 > 
	`__bos0
 (
__s1
è/  (
wch¬_t
))

113  
	`__wmempıy_chk_w¬n
 (
__s1
, 
__s2
, 
__n
,

114 
	`__bos0
 (
__s1
è/  (
wch¬_t
));

116  
	`__wmempıy_®Ÿs
 (
__s1
, 
__s2
, 
__n
);

117 
	}
}

121 
wch¬_t
 *
	$__wmem£t_chk
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

122 
size_t
 
__ns
è
__THROW
;

123 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_®Ÿs
, (wch¬_ˆ*
__s
, wch¬_ˆ
__c
,

124 
size_t
 
__n
), 
wmem£t
);

125 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¬n
,

126 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
,

127 
size_t
 
__ns
), 
__wmem£t_chk
)

128 
	`__w¬Ç‰r
 ("wmemset called with†ength biggerhan size of destination "

131 
__ex‹º_®ways_šlše
 
wch¬_t
 *

132 
	`__NTH
 (
	$wmem£t
 (
wch¬_t
 *
__»¡riù
 
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
))

134 ià(
	`__bos0
 (
__s
è!ğ(
size_t
) -1)

136 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

137  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sè/  (
wch¬_t
));

139 ià(
__n
 > 
	`__bos0
 (
__s
è/  (
wch¬_t
))

140  
	`__wmem£t_chk_w¬n
 (
__s
, 
__c
, 
__n
,

141 
	`__bos0
 (
__s
è/  (
wch¬_t
));

143  
	`__wmem£t_®Ÿs
 (
__s
, 
__c
, 
__n
);

144 
	}
}

147 
wch¬_t
 *
	$__wcsıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

149 
size_t
 
__n
è
__THROW
;

150 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsıy_®Ÿs
,

151 (
wch¬_t
 *
__»¡riù
 
__de¡
,

152 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsıy
);

154 
__ex‹º_®ways_šlše
 
wch¬_t
 *

155 
	`__NTH
 (
	$wcsıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

157 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

158  
	`__wcsıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

159  
	`__wcsıy_®Ÿs
 (
__de¡
, 
__¤c
);

160 
	}
}

163 
wch¬_t
 *
	$__wııy_chk
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
,

164 
size_t
 
__de¡Ën
è
__THROW
;

165 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wııy_®Ÿs
, (wch¬_ˆ*
__de¡
,

166 
__cÚ¡
 
wch¬_t
 *
__¤c
),

167 
wııy
);

169 
__ex‹º_®ways_šlše
 
wch¬_t
 *

170 
	`__NTH
 (
	$wııy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

172 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

173  
	`__wııy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

174  
	`__wııy_®Ÿs
 (
__de¡
, 
__¤c
);

175 
	}
}

178 
wch¬_t
 *
	$__wc¢ıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

179 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

180 
size_t
 
__de¡Ën
è
__THROW
;

181 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_®Ÿs
,

182 (
wch¬_t
 *
__»¡riù
 
__de¡
,

183 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

184 
size_t
 
__n
), 
wc¢ıy
);

185 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ıy_chk_w¬n
,

186 (
wch¬_t
 *
__»¡riù
 
__de¡
,

187 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

188 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wc¢ıy_chk
)

189 
	`__w¬Ç‰r
 ("wcsncpy called with†ength biggerhan size of destination "

192 
__ex‹º_®ways_šlše
 
wch¬_t
 *

193 
	`__NTH
 (
	$wc¢ıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

195 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

197 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

198  
	`__wc¢ıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

199 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

200 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

201  
	`__wc¢ıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

202 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

204  
	`__wc¢ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

205 
	}
}

208 
wch¬_t
 *
	$__wınıy_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

209 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
,

210 
size_t
 
__de¡Ën
è
__THROW
;

211 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_®Ÿs
,

212 (
wch¬_t
 *
__»¡riù
 
__de¡
,

213 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

214 
size_t
 
__n
), 
wınıy
);

215 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wınıy_chk_w¬n
,

216 (
wch¬_t
 *
__»¡riù
 
__de¡
,

217 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

218 
size_t
 
__n
, size_ˆ
__de¡Ën
), 
__wınıy_chk
)

219 
	`__w¬Ç‰r
 ("wcpncpy called with†ength biggerhan size of destination "

222 
__ex‹º_®ways_šlše
 
wch¬_t
 *

223 
	`__NTH
 (
	$wınıy
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

225 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

227 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

228  
	`__wınıy_chk
 (
__de¡
, 
__¤c
, 
__n
,

229 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

230 ià(
__n
 > 
	`__bos
 (
__de¡
è/  (
wch¬_t
))

231  
	`__wınıy_chk_w¬n
 (
__de¡
, 
__¤c
, 
__n
,

232 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

234  
	`__wınıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

235 
	}
}

238 
wch¬_t
 *
	$__wcsÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

239 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

240 
size_t
 
__de¡Ën
è
__THROW
;

241 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wcsÿt_®Ÿs
,

242 (
wch¬_t
 *
__»¡riù
 
__de¡
,

243 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
), 
wcsÿt
);

245 
__ex‹º_®ways_šlše
 
wch¬_t
 *

246 
	`__NTH
 (
	$wcsÿt
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
))

248 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

249  
	`__wcsÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__de¡è/  (
wch¬_t
));

250  
	`__wcsÿt_®Ÿs
 (
__de¡
, 
__¤c
);

251 
	}
}

254 
wch¬_t
 *
	$__wc¢ÿt_chk
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

255 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

256 
size_t
 
__n
, size_ˆ
__de¡Ën
è
__THROW
;

257 
wch¬_t
 *
	`__REDIRECT_NTH
 (
__wc¢ÿt_®Ÿs
,

258 (
wch¬_t
 *
__»¡riù
 
__de¡
,

259 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__¤c
,

260 
size_t
 
__n
), 
wc¢ÿt
);

262 
__ex‹º_®ways_šlše
 
wch¬_t
 *

263 
	`__NTH
 (
	$wc¢ÿt
 (
wch¬_t
 *
__de¡
, 
__cÚ¡
 wch¬_ˆ*
__¤c
, 
size_t
 
__n
))

265 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1)

266  
	`__wc¢ÿt_chk
 (
__de¡
, 
__¤c
, 
__n
,

267 
	`__bos
 (
__de¡
è/  (
wch¬_t
));

268  
	`__wc¢ÿt_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

269 
	}
}

272 
	$__sw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

273 
__æag
, 
size_t
 
__s_Ën
,

274 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

275 
__THROW
 ;

277 
	`__REDIRECT_NTH_LDBL
 (
__sw´štf_®Ÿs
,

278 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

279 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...),

280 
sw´štf
);

282 #ifdeà
__va_¬g_·ck


283 
__ex‹º_®ways_šlše
 

284 
	`__NTH
 (
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

285 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...))

287 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

288  
	`__sw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

289 
	`__bos
 (
__s
è/  (
wch¬_t
),

290 
__fmt
, 
	`__va_¬g_·ck
 ());

291  
	`__sw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¬g_·ck
 ());

292 
	}
}

293 #–ià!
defšed
 
__ılu¥lus


295 
	#sw´štf
(
s
, 
n
, ...) \

296 (
	`__bos
 (
s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

297 ? 
	`__sw´štf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

298 
	`__bos
 (
s
è/  (
wch¬_t
), 
__VA_ARGS__
) \

299 : 
	`sw´štf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

302 
	$__vsw´štf_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

303 
__æag
, 
size_t
 
__s_Ën
,

304 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

305 
__gnuc_va_li¡
 
__¬g
)

306 
__THROW
 ;

308 
	`__REDIRECT_NTH_LDBL
 (
__vsw´štf_®Ÿs
,

309 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

310 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
,

311 
__gnuc_va_li¡
 
__­
), 
vsw´štf
);

313 
__ex‹º_®ways_šlše
 

314 
	`__NTH
 (
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

315 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
))

317 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 || 
__USE_FORTIFY_LEVEL
 > 1)

318  
	`__vsw´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

319 
	`__bos
 (
__s
è/  (
wch¬_t
), 
__fmt
, 
__­
);

320  
	`__vsw´štf_®Ÿs
 (
__s
, 
__n
, 
__fmt
, 
__­
);

321 
	}
}

324 #ià
__USE_FORTIFY_LEVEL
 > 1

326 
__fw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

327 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

328 
__w´štf_chk
 (
__æag
, 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

330 
__vfw´štf_chk
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

331 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

332 
__gnuc_va_li¡
 
__­
);

333 
__vw´štf_chk
 (
__æag
, 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

334 
__gnuc_va_li¡
 
__­
);

336 #ifdeà
__va_¬g_·ck


337 
__ex‹º_®ways_šlše
 

338 
	$w´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, ...)

340  
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

341 
	}
}

343 
__ex‹º_®ways_šlše
 

344 
	$fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
, 
__cÚ¡
 
wch¬_t
 *__»¡riù 
__fmt
, ...)

346  
	`__fw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

347 
	`__va_¬g_·ck
 ());

348 
	}
}

349 #–ià!
defšed
 
__ılu¥lus


350 
	#w´štf
(...) \

351 
	`__w´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

352 
	#fw´štf
(
¡»am
, ...) \

353 
	`__fw´štf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

356 
__ex‹º_®ways_šlše
 

357 
	$vw´štf
 (
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

359  
	`__vw´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

360 
	}
}

362 
__ex‹º_®ways_šlše
 

363 
	$vfw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

364 
__cÚ¡
 
wch¬_t
 *
__»¡riù
 
__fmt
, 
__gnuc_va_li¡
 
__­
)

366  
	`__vfw´štf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

367 
	}
}

371 
wch¬_t
 *
	$__fg‘ws_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

372 
__FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

373 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_®Ÿs
,

374 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

375 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws
è
__wur
;

376 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_chk_w¬n
,

377 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

378 
__FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘ws_chk
)

379 
__wur
 
	`__w¬Ç‰r
 ("fgetws called with bigger sizehan†ength "

382 
__ex‹º_®ways_šlše
 
__wur
 
wch¬_t
 *

383 
	$fg‘ws
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

385 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

387 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

388  
	`__fg‘ws_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

389 
__n
, 
__¡»am
);

391 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

392  
	`__fg‘ws_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

393 
__n
, 
__¡»am
);

395  
	`__fg‘ws_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

396 
	}
}

398 #ifdeà
__USE_GNU


399 
wch¬_t
 *
	$__fg‘ws_uÆocked_chk
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
,

400 
__n
, 
__FILE
 *
__»¡riù
 
__¡»am
)

401 
__wur
;

402 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_®Ÿs
,

403 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
,

404 
__FILE
 *
__»¡riù
 
__¡»am
), 
fg‘ws_uÆocked
)

405 
__wur
;

406 
wch¬_t
 *
	`__REDIRECT
 (
__fg‘ws_uÆocked_chk_w¬n
,

407 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

408 
__FILE
 *
__»¡riù
 
__¡»am
),

409 
__fg‘ws_uÆocked_chk
)

410 
__wur
 
	`__w¬Ç‰r
 ("fgetws_unlocked called with bigger sizehan†ength "

413 
__ex‹º_®ways_šlše
 
__wur
 
wch¬_t
 *

414 
	$fg‘ws_uÆocked
 (
wch¬_t
 *
__»¡riù
 
__s
, 
__n
, 
__FILE
 *__»¡riù 
__¡»am
)

416 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

418 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

419  
	`__fg‘ws_uÆocked_chk
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

420 
__n
, 
__¡»am
);

422 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
è/  (
wch¬_t
))

423  
	`__fg‘ws_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__sè/  (
wch¬_t
),

424 
__n
, 
__¡»am
);

426  
	`__fg‘ws_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

427 
	}
}

431 
size_t
 
	$__wütomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
mb¡©e_t
 *
__p
,

432 
size_t
 
__buæ’
è
__THROW
 
__wur
;

433 
size_t
 
	`__REDIRECT_NTH
 (
__wütomb_®Ÿs
,

434 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wch¬
,

435 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wütomb
è
__wur
;

437 
__ex‹º_®ways_šlše
 
__wur
 
size_t


438 
	`__NTH
 (
	$wütomb
 (*
__s
, 
wch¬_t
 
__wch¬
, 
mb¡©e_t
 *
__ps
))

443 
	#__WCHAR_MB_LEN_MAX
 16

	)

444 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__WCHAR_MB_LEN_MAX


447 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

448  
	`__wütomb_chk
 (
__s
, 
__wch¬
, 
__ps
, 
	`__bos
 (__s));

449  
	`__wütomb_®Ÿs
 (
__s
, 
__wch¬
, 
__ps
);

450 
	}
}

453 
size_t
 
	$__mb¤towcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

454 
__cÚ¡
 **
__»¡riù
 
__¤c
,

455 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

456 
size_t
 
__d¡Ën
è
__THROW
;

457 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_®Ÿs
,

458 (
wch¬_t
 *
__»¡riù
 
__d¡
,

459 
__cÚ¡
 **
__»¡riù
 
__¤c
,

460 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

461 
mb¤towcs
);

462 
size_t
 
	`__REDIRECT_NTH
 (
__mb¤towcs_chk_w¬n
,

463 (
wch¬_t
 *
__»¡riù
 
__d¡
,

464 
__cÚ¡
 **
__»¡riù
 
__¤c
,

465 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

466 
size_t
 
__d¡Ën
), 
__mb¤towcs_chk
)

467 
	`__w¬Ç‰r
 ("mbsrtowcs called with dst buffer smallerhan†en "

470 
__ex‹º_®ways_šlše
 
size_t


471 
	`__NTH
 (
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 **__»¡riù 
__¤c
,

472 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

474 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

476 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

477  
	`__mb¤towcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

478 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

480 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

481  
	`__mb¤towcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
,

482 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

484  
	`__mb¤towcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

485 
	}
}

488 
size_t
 
	$__wc¤tombs_chk
 (*
__»¡riù
 
__d¡
,

489 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

490 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

491 
size_t
 
__d¡Ën
è
__THROW
;

492 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_®Ÿs
,

493 (*
__»¡riù
 
__d¡
,

494 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

495 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

496 
wc¤tombs
);

497 
size_t
 
	`__REDIRECT_NTH
 (
__wc¤tombs_chk_w¬n
,

498 (*
__»¡riù
 
__d¡
,

499 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

500 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

501 
size_t
 
__d¡Ën
), 
__wc¤tombs_chk
)

502 
	`__w¬Ç‰r
 ("wcsrtombs called with dst buffer smallerhan†en");

504 
__ex‹º_®ways_šlše
 
size_t


505 
	`__NTH
 (
	$wc¤tombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 **__»¡riù 
__¤c
,

506 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

508 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

510 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

511  
	`__wc¤tombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

513 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

514  
	`__wc¤tombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
, 
	`__bos
 (__dst));

516  
	`__wc¤tombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
, 
__ps
);

517 
	}
}

520 #ifdeà
__USE_GNU


521 
size_t
 
	$__mb¢¹owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

522 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

523 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

524 
size_t
 
__d¡Ën
è
__THROW
;

525 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_®Ÿs
,

526 (
wch¬_t
 *
__»¡riù
 
__d¡
,

527 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

528 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
),

529 
mb¢¹owcs
);

530 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢¹owcs_chk_w¬n
,

531 (
wch¬_t
 *
__»¡riù
 
__d¡
,

532 
__cÚ¡
 **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

533 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
,

534 
size_t
 
__d¡Ën
), 
__mb¢¹owcs_chk
)

535 
	`__w¬Ç‰r
 ("mbsnrtowcs called with dst buffer smallerhan†en "

538 
__ex‹º_®ways_šlše
 
size_t


539 
	`__NTH
 (
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, 
__cÚ¡
 **__»¡riù 
__¤c
,

540 
size_t
 
__nmc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

542 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

544 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

545  
	`__mb¢¹owcs_chk
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

546 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

548 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

549  
	`__mb¢¹owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
,

550 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

552  
	`__mb¢¹owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nmc
, 
__Ën
, 
__ps
);

553 
	}
}

556 
size_t
 
	$__wc¢¹ombs_chk
 (*
__»¡riù
 
__d¡
,

557 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

558 
size_t
 
__nwc
, size_ˆ
__Ën
,

559 
mb¡©e_t
 *
__»¡riù
 
__ps
, 
size_t
 
__d¡Ën
)

560 
__THROW
;

561 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_®Ÿs
,

562 (*
__»¡riù
 
__d¡
,

563 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

564 
size_t
 
__nwc
, size_ˆ
__Ën
,

565 
mb¡©e_t
 *
__»¡riù
 
__ps
), 
wc¢¹ombs
);

566 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢¹ombs_chk_w¬n
,

567 (*
__»¡riù
 
__d¡
,

568 
__cÚ¡
 
wch¬_t
 **
__»¡riù
 
__¤c
,

569 
size_t
 
__nwc
, size_ˆ
__Ën
,

570 
mb¡©e_t
 *
__»¡riù
 
__ps
,

571 
size_t
 
__d¡Ën
), 
__wc¢¹ombs_chk
)

572 
	`__w¬Ç‰r
 ("wcsnrtombs called with dst buffer smallerhan†en");

574 
__ex‹º_®ways_šlše
 
size_t


575 
	`__NTH
 (
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
, 
__cÚ¡
 
wch¬_t
 **__»¡riù 
__¤c
,

576 
size_t
 
__nwc
, size_ˆ
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
))

578 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

580 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

581  
	`__wc¢¹ombs_chk
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

582 
	`__bos
 (
__d¡
));

584 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

585  
	`__wc¢¹ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
,

586 
	`__bos
 (
__d¡
));

588  
	`__wc¢¹ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__nwc
, 
__Ën
, 
__ps
);

589 
	}
}

	@/usr/include/errno.h

23 #iâdef 
_ERRNO_H


27 #iâdef 
__Ãed_Em©h


28 
	#_ERRNO_H
 1

	)

29 
	~<ã©u»s.h
>

32 
	g__BEGIN_DECLS


36 
	~<b™s/”ºo.h
>

37 #undeà
__Ãed_Em©h


39 #ifdef 
_ERRNO_H


46 #iâdef 
”ºo


47 
”ºo
;

50 #ifdeà
__USE_GNU


55 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

59 
	g__END_DECLS


67 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


68 #iâdeà
__”rÜ_t_defšed


69 
	t”rÜ_t
;

70 
	#__”rÜ_t_defšed
 1

	)

72 #undeà
__Ãed_”rÜ_t


	@/usr/include/gnu/option-groups.h

10 #iâdeà
__GNU_OPTION_GROUPS_H


11 
	#__GNU_OPTION_GROUPS_H


	)

13 
	#__OPTION_EGLIBC_ADVANCED_INET6
 1

	)

14 
	#__OPTION_EGLIBC_BACKTRACE
 1

	)

15 
	#__OPTION_EGLIBC_BIG_MACROS
 1

	)

16 
	#__OPTION_EGLIBC_BSD
 1

	)

17 
	#__OPTION_EGLIBC_CATGETS
 1

	)

18 
	#__OPTION_EGLIBC_CHARSETS
 1

	)

19 
	#__OPTION_EGLIBC_CXX_TESTS
 1

	)

20 
	#__OPTION_EGLIBC_DB_ALIASES
 1

	)

21 
	#__OPTION_EGLIBC_ENVZ
 1

	)

22 
	#__OPTION_EGLIBC_FCVT
 1

	)

23 
	#__OPTION_EGLIBC_FMTMSG
 1

	)

24 
	#__OPTION_EGLIBC_FSTAB
 1

	)

25 
	#__OPTION_EGLIBC_FTRAVERSE
 1

	)

26 
	#__OPTION_EGLIBC_GETLOGIN
 1

	)

27 
	#__OPTION_EGLIBC_INET
 1

	)

28 
	#__OPTION_EGLIBC_LIBM
 1

	)

29 
	#__OPTION_EGLIBC_LOCALES
 1

	)

30 
	#__OPTION_EGLIBC_LOCALE_CODE
 1

	)

31 
	#__OPTION_EGLIBC_MEMUSAGE
 1

	)

32 
	#__OPTION_EGLIBC_NIS
 1

	)

33 
	#__OPTION_EGLIBC_NSSWITCH
 1

	)

34 
	#__OPTION_EGLIBC_RCMD
 1

	)

35 
	#__OPTION_EGLIBC_SPAWN
 1

	)

36 
	#__OPTION_EGLIBC_STREAMS
 1

	)

37 
	#__OPTION_EGLIBC_SUNRPC
 1

	)

38 
	#__OPTION_EGLIBC_UTMP
 1

	)

39 
	#__OPTION_EGLIBC_UTMPX
 1

	)

40 
	#__OPTION_EGLIBC_WORDEXP
 1

	)

41 
	#__OPTION_POSIX_C_LANG_WIDE_CHAR
 1

	)

42 
	#__OPTION_POSIX_REGEXP
 1

	)

43 
	#__OPTION_POSIX_REGEXP_GLIBC
 1

	)

44 
	#__OPTION_POSIX_WIDE_CHAR_DEVICE_IO
 1

	)

	@/usr/include/pthread.h

20 #iâdeà
_PTHREAD_H


21 
	#_PTHREAD_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<’dŸn.h
>

25 
	~<sched.h
>

26 
	~<time.h
>

28 
	#__Ãed_sig£t_t


	)

29 
	~<sigÇl.h
>

30 
	~<b™s/±h»adty³s.h
>

31 
	~<b™s/£tjmp.h
>

32 
	~<b™s/wÜdsize.h
>

38 
	mPTHREAD_CREATE_JOINABLE
,

39 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

40 
	mPTHREAD_CREATE_DETACHED


41 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

48 
	mPTHREAD_MUTEX_TIMED_NP
,

49 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

50 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

51 
	mPTHREAD_MUTEX_ADAPTIVE_NP


52 #ifdeà
__USE_UNIX98


54 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

55 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

56 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

57 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


59 #ifdeà
__USE_GNU


61 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


66 #ifdeà
__USE_XOPEN2K


70 
	mPTHREAD_MUTEX_STALLED
,

71 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

72 
	mPTHREAD_MUTEX_ROBUST
,

73 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


78 #ifdeà
__USE_UNIX98


82 
	mPTHREAD_PRIO_NONE
,

83 
	mPTHREAD_PRIO_INHERIT
,

84 
	mPTHREAD_PRIO_PROTECT


90 #ià
__WORDSIZE
 == 64

91 
	#PTHREAD_MUTEX_INITIALIZER
 \

92 { { 0, 0, 0, 0, 0, 0, { 0, 0 } } }

	)

93 #ifdeà
__USE_GNU


94 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0, 0 } } }

	)

96 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

97 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0, 0 } } }

	)

98 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0, 0 } } }

	)

102 
	#PTHREAD_MUTEX_INITIALIZER
 \

103 { { 0, 0, 0, 0, 0, { 0 } } }

	)

104 #ifdeà
__USE_GNU


105 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 0 } } }

	)

107 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

108 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 0 } } }

	)

109 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

110 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 0 } } }

	)

116 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


119 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

120 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

121 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

122 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


126 
	#PTHREAD_RWLOCK_INITIALIZER
 \

127 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

128 #ifdeà
__USE_GNU


129 #ià
__WORDSIZE
 == 64

130 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

132 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

134 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


135 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

136 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

137 0, 0, 0, 0 } }

	)

139 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

140 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

141 0 } }

	)

151 
	mPTHREAD_INHERIT_SCHED
,

152 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

153 
	mPTHREAD_EXPLICIT_SCHED


154 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

161 
	mPTHREAD_SCOPE_SYSTEM
,

162 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

163 
	mPTHREAD_SCOPE_PROCESS


164 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

171 
	mPTHREAD_PROCESS_PRIVATE
,

172 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

173 
	mPTHREAD_PROCESS_SHARED


174 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

180 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

184 
	s_±h»ad_ş—nup_bufãr


186 (*
	m__routše
) (*);

187 *
	m__¬g
;

188 
	m__ÿnûÉy³
;

189 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

195 
	mPTHREAD_CANCEL_ENABLE
,

196 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

197 
	mPTHREAD_CANCEL_DISABLE


198 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

202 
	mPTHREAD_CANCEL_DEFERRED
,

203 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

204 
	mPTHREAD_CANCEL_ASYNCHRONOUS


205 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

207 
	#PTHREAD_CANCELED
 ((*è-1)

	)

211 
	#PTHREAD_ONCE_INIT
 0

	)

214 #ifdeà
__USE_XOPEN2K


218 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

222 
__BEGIN_DECLS


227 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

228 
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

229 *(*
__¡¬t_routše
) (*),

230 *
__»¡riù
 
__¬g
è
__THROW
 
__nÚnuÎ
 ((1, 3));

236 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

244 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

246 #ifdeà
__USE_GNU


249 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

257 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

258 
__cÚ¡
 
time¥ec
 *
__ab¡ime
);

265 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

269 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

272 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
è
__THROW
;

280 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

283 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

284 
__THROW
 
	`__nÚnuÎ
 ((1));

287 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

288 *
__d‘ach¡©e
)

289 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

292 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

293 
__d‘ach¡©e
)

294 
__THROW
 
	`__nÚnuÎ
 ((1));

298 
	$±h»ad_©Œ_g‘gu¬dsize
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

299 
size_t
 *
__gu¬dsize
)

300 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

303 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

304 
size_t
 
__gu¬dsize
)

305 
__THROW
 
	`__nÚnuÎ
 ((1));

309 
	$±h»ad_©Œ_g‘sched·¿m
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


310 
__©Œ
,

311 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

312 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

315 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

316 
__cÚ¡
 
sched_·¿m
 *
__»¡riù


317 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

320 
	$±h»ad_©Œ_g‘schedpŞicy
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


321 
__©Œ
, *
__»¡riù
 
__pŞicy
)

322 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

325 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

326 
__THROW
 
	`__nÚnuÎ
 ((1));

329 
	$±h»ad_©Œ_g‘šh”™sched
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


330 
__©Œ
, *
__»¡riù
 
__šh”™
)

331 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

334 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

335 
__šh”™
)

336 
__THROW
 
	`__nÚnuÎ
 ((1));

340 
	$±h»ad_©Œ_g‘scİe
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

341 *
__»¡riù
 
__scİe
)

342 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

345 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

346 
__THROW
 
	`__nÚnuÎ
 ((1));

349 
	$±h»ad_©Œ_g‘¡ackaddr
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


350 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

351 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

357 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

358 *
__¡ackaddr
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

362 
	$±h»ad_©Œ_g‘¡acksize
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù


363 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

364 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

369 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

370 
size_t
 
__¡acksize
)

371 
__THROW
 
	`__nÚnuÎ
 ((1));

373 #ifdeà
__USE_XOPEN2K


375 
	$±h»ad_©Œ_g‘¡ack
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

376 **
__»¡riù
 
__¡ackaddr
,

377 
size_t
 *
__»¡riù
 
__¡acksize
)

378 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

383 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

384 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

387 #ifdeà
__USE_GNU


390 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

391 
size_t
 
__ıu£tsize
,

392 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

397 
	$±h»ad_©Œ_g‘affš™y_Å
 (
__cÚ¡
 
±h»ad_©Œ_t
 *
__©Œ
,

398 
size_t
 
__ıu£tsize
,

399 
ıu_£t_t
 *
__ıu£t
)

400 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

406 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

407 
__THROW
 
	`__nÚnuÎ
 ((2));

415 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

416 
__cÚ¡
 
sched_·¿m
 *
__·¿m
)

417 
__THROW
 
	`__nÚnuÎ
 ((3));

420 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

421 *
__»¡riù
 
__pŞicy
,

422 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

423 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

426 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

427 
__THROW
;

430 #ifdeà
__USE_UNIX98


432 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

435 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

438 #ifdeà
__USE_GNU


443 
	$±h»ad_y›ld
 (è
__THROW
;

448 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

449 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
)

450 
__THROW
 
	`__nÚnuÎ
 ((3));

453 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

454 
ıu_£t_t
 *
__ıu£t
)

455 
__THROW
 
	`__nÚnuÎ
 ((3));

468 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

469 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

480 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

484 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

487 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

492 
	`±h»ad_‹¡ÿnûl
 ();

501 
__jmp_buf
 
__ÿnûl_jmp_buf
;

502 
__mask_was_§ved
;

503 } 
__ÿnûl_jmp_buf
[1];

504 *
__·d
[4];

505 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

508 #iâdeà
__ş—nup_fù_©Œibu‹


509 
	#__ş—nup_fù_©Œibu‹


	)

514 
	s__±h»ad_ş—nup_äame


516 (*
__ÿnûl_routše
) (*);

517 *
__ÿnûl_¬g
;

518 
__do_™
;

519 
__ÿnûl_ty³
;

522 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


523 #ifdeà
__ılu¥lus


525 şas 
	c__±h»ad_ş—nup_şass


527 (*
__ÿnûl_routše
) (*);

528 *
__ÿnûl_¬g
;

529 
__do_™
;

530 
__ÿnûl_ty³
;

532 
public
:

533 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

534 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

535 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

536 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

537 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

538 &
__ÿnûl_ty³
); 
	}
}

539 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

549 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

551 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

555 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

556 
__şäame
.
	`__£tdo™
 (
execu‹
); \

557 } 0)

	)

559 #ifdeà
__USE_GNU


563 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

565 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

566 
__şäame
.
	`__deãr
 ()

	)

571 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

572 
__şäame
.
	`__»¡Üe
 (); \

573 
__şäame
.
	`__£tdo™
 (
execu‹
); \

574 } 0)

	)

581 
__ex‹º_šlše
 

582 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

584 ià(
__äame
->
__do_™
)

585 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

586 
	}
}

595 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

597 
__±h»ad_ş—nup_äame
 
__şäame
 \

598 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

599 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

600 .
__do_™
 = 1 };

	)

604 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

605 
__şäame
.
__do_™
 = (
execu‹
); \

606 } 0)

	)

608 #ifdeà
__USE_GNU


612 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

614 
__±h»ad_ş—nup_äame
 
__şäame
 \

615 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

616 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

617 .
__do_™
 = 1 }; \

618 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

619 &
__şäame
.
__ÿnûl_ty³
)

	)

624 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

625 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

626 
__şäame
.
__do_™
 = (
execu‹
); \

627 } 0)

	)

638 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

640 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

641 (*
__ÿnûl_routše
è(*èğ(
routše
); \

642 *
__ÿnûl_¬g
 = (
¬g
); \

643 
nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

644 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

645 ià(
	`__butš_ex³ù
 (
nÙ_fœ¡_ÿÎ
, 0)) \

647 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

648 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

652 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

653 dØ{

	)

654 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

655 
__ş—nup_fù_©Œibu‹
;

659 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

662 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

663 ià(
execu‹
) \

664 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

665 } 0)

	)

666 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

667 
__ş—nup_fù_©Œibu‹
;

669 #ifdeà
__USE_GNU


673 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

675 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

676 (*
__ÿnûl_routše
è(*èğ(
routše
); \

677 *
__ÿnûl_¬g
 = (
¬g
); \

678 
nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

679 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

680 ià(
	`__butš_ex³ù
 (
nÙ_fœ¡_ÿÎ
, 0)) \

682 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

683 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

687 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

688 dØ{

	)

689 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

690 
__ş—nup_fù_©Œibu‹
;

695 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

698 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

699 ià(
execu‹
) \

700 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

701 
	}
} 0)

	)

702 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

703 
__ş—nup_fù_©Œibu‹
;

707 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

708 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

709 #iâdeà
SHARED


710 
	`__©Œibu‹__
 ((
__w—k__
))

716 
__jmp_buf_g
;

717 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROW
;

723 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

724 
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

725 
__THROW
 
	`__nÚnuÎ
 ((1));

728 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

729 
__THROW
 
	`__nÚnuÎ
 ((1));

732 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

733 
__THROW
 
	`__nÚnuÎ
 ((1));

736 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

737 
__THROW
 
	`__nÚnuÎ
 ((1));

739 #ifdeà
__USE_XOPEN2K


741 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

742 
__cÚ¡
 
time¥ec
 *
__»¡riù


743 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

747 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

748 
__THROW
 
	`__nÚnuÎ
 ((1));

751 #ifdeà
__USE_UNIX98


753 
	$±h»ad_mu‹x_g‘´ioûšg
 (
__cÚ¡
 
±h»ad_mu‹x_t
 *

754 
__»¡riù
 
__mu‹x
,

755 *
__»¡riù
 
__´ioûšg
)

756 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

760 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

761 
__´ioûšg
,

762 *
__»¡riù
 
__Şd_ûšg
)

763 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

767 #ifdeà
__USE_XOPEN2K8


769 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

770 
__THROW
 
	`__nÚnuÎ
 ((1));

771 #ifdeà
__USE_GNU


772 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

773 
__THROW
 
	`__nÚnuÎ
 ((1));

782 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

783 
__THROW
 
	`__nÚnuÎ
 ((1));

786 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

787 
__THROW
 
	`__nÚnuÎ
 ((1));

790 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

791 
__»¡riù
 
__©Œ
,

792 *
__»¡riù
 
__psh¬ed
)

793 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

796 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

797 
__psh¬ed
)

798 
__THROW
 
	`__nÚnuÎ
 ((1));

800 #ifdeà
__USE_UNIX98


802 
	$±h»ad_mu‹x©Œ_g‘ty³
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


803 
__©Œ
, *
__»¡riù
 
__kšd
)

804 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

809 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

810 
__THROW
 
	`__nÚnuÎ
 ((1));

813 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

814 
__»¡riù
 
__©Œ
,

815 *
__»¡riù
 
__´ÙocŞ
)

816 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

820 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

821 
__´ÙocŞ
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

825 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *

826 
__»¡riù
 
__©Œ
,

827 *
__»¡riù
 
__´ioûšg
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

831 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

832 
__´ioûšg
)

833 
__THROW
 
	`__nÚnuÎ
 ((1));

836 #ifdeà
__USE_XOPEN2K


838 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

839 *
__robu¡Ãss
)

840 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

841 #ifdeà
__USE_GNU


842 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (
__cÚ¡
 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

843 *
__robu¡Ãss
)

844 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

848 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

849 
__robu¡Ãss
)

850 
__THROW
 
	`__nÚnuÎ
 ((1));

851 #ifdeà
__USE_GNU


852 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

853 
__robu¡Ãss
)

854 
__THROW
 
	`__nÚnuÎ
 ((1));

859 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


864 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

865 
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *
__»¡riù


866 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

869 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

870 
__THROW
 
	`__nÚnuÎ
 ((1));

873 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

874 
__THROW
 
	`__nÚnuÎ
 ((1));

877 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

878 
__THROW
 
	`__nÚnuÎ
 ((1));

880 #ifdeà
__USE_XOPEN2K


882 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

883 
__cÚ¡
 
time¥ec
 *
__»¡riù


884 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

888 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

889 
__THROW
 
	`__nÚnuÎ
 ((1));

892 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

893 
__THROW
 
	`__nÚnuÎ
 ((1));

895 #ifdeà
__USE_XOPEN2K


897 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

898 
__cÚ¡
 
time¥ec
 *
__»¡riù


899 
__ab¡ime
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

903 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

904 
__THROW
 
	`__nÚnuÎ
 ((1));

910 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

911 
__THROW
 
	`__nÚnuÎ
 ((1));

914 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

915 
__THROW
 
	`__nÚnuÎ
 ((1));

918 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *

919 
__»¡riù
 
__©Œ
,

920 *
__»¡riù
 
__psh¬ed
)

921 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

924 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

925 
__psh¬ed
)

926 
__THROW
 
	`__nÚnuÎ
 ((1));

929 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (
__cÚ¡
 
±h»ad_rwlock©Œ_t
 *

930 
__»¡riù
 
__©Œ
,

931 *
__»¡riù
 
__´ef
)

932 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

935 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

936 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

944 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

945 
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *
__»¡riù


946 
__cÚd_©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

949 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

954 
__THROW
 
	`__nÚnuÎ
 ((1));

957 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

958 
__THROW
 
	`__nÚnuÎ
 ((1));

965 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

966 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

967 
	`__nÚnuÎ
 ((1, 2));

976 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

977 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

978 
__cÚ¡
 
time¥ec
 *
__»¡riù


979 
__ab¡ime
è
	`__nÚnuÎ
 ((1, 2, 3));

984 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

985 
__THROW
 
	`__nÚnuÎ
 ((1));

988 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

989 
__THROW
 
	`__nÚnuÎ
 ((1));

992 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *

993 
__»¡riù
 
__©Œ
,

994 *
__»¡riù
 
__psh¬ed
)

995 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

998 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

999 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1001 #ifdeà
__USE_XOPEN2K


1003 
	$±h»ad_cÚd©Œ_g‘şock
 (
__cÚ¡
 
±h»ad_cÚd©Œ_t
 *

1004 
__»¡riù
 
__©Œ
,

1005 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1006 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1009 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1010 
__şockid_t
 
__şock_id
)

1011 
__THROW
 
	`__nÚnuÎ
 ((1));

1015 #ifdeà
__USE_XOPEN2K


1020 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1021 
__THROW
 
	`__nÚnuÎ
 ((1));

1024 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1025 
__THROW
 
	`__nÚnuÎ
 ((1));

1028 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1029 
__THROW
 
	`__nÚnuÎ
 ((1));

1032 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1033 
__THROW
 
	`__nÚnuÎ
 ((1));

1036 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1037 
__THROW
 
	`__nÚnuÎ
 ((1));

1044 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1045 
__cÚ¡
 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1046 
__©Œ
, 
__couÁ
)

1047 
__THROW
 
	`__nÚnuÎ
 ((1));

1050 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1051 
__THROW
 
	`__nÚnuÎ
 ((1));

1054 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1055 
__THROW
 
	`__nÚnuÎ
 ((1));

1059 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1060 
__THROW
 
	`__nÚnuÎ
 ((1));

1063 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1064 
__THROW
 
	`__nÚnuÎ
 ((1));

1067 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (
__cÚ¡
 
±h»ad_b¬r›¿‰r_t
 *

1068 
__»¡riù
 
__©Œ
,

1069 *
__»¡riù
 
__psh¬ed
)

1070 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1073 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1074 
__psh¬ed
)

1075 
__THROW
 
	`__nÚnuÎ
 ((1));

1087 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1088 (*
__de¡r_funùiÚ
) (*))

1089 
__THROW
 
	`__nÚnuÎ
 ((1));

1092 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1095 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1098 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1099 
__cÚ¡
 *
__poš‹r
è
__THROW
 ;

1102 #ifdeà
__USE_XOPEN2K


1104 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1105 
__şockid_t
 *
__şock_id
)

1106 
__THROW
 
	`__nÚnuÎ
 ((2));

1121 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1122 (*
__·»Á
) (),

1123 (*
__chd
è()è
__THROW
;

1126 #ifdeà
__USE_EXTERN_INLINES


1128 
__ex‹º_šlše
 

1129 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1131  
__th»ad1
 =ğ
__th»ad2
;

1132 
	}
}

1135 
	g__END_DECLS


	@/usr/include/wctype.h

24 #iâdeà
_WCTYPE_H


26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

29 #iâdeà
__Ãed_iswxxx


30 
	#_WCTYPE_H
 1

	)

33 
	#__Ãed_wšt_t


	)

34 
	~<¡ddef.h
>

38 #iâdeà
WEOF


39 
	#WEOF
 (0xffffffffu)

	)

42 #undeà
__Ãed_iswxxx


47 #iâdeà
__iswxxx_defšed


48 
	#__iswxxx_defšed
 1

	)

50 
__BEGIN_NAMESPACE_C99


53 
	twùy³_t
;

54 
	g__END_NAMESPACE_C99


56 #iâdeà
_ISwb™


61 
	~<’dŸn.h
>

62 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


63 
	#_ISwb™
(
b™
è(1 << (b™))

	)

65 
	#_ISwb™
(
b™
) \

66 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

67 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

68 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

69 : (è((1UL << (
b™
)è>> 24))))

	)

74 
	m__ISwuµ”
 = 0,

75 
	m__ISwlow”
 = 1,

76 
	m__ISw®pha
 = 2,

77 
	m__ISwdig™
 = 3,

78 
	m__ISwxdig™
 = 4,

79 
	m__ISw¥aû
 = 5,

80 
	m__ISw´št
 = 6,

81 
	m__ISwg¿ph
 = 7,

82 
	m__ISwbÏnk
 = 8,

83 
	m__ISwúŒl
 = 9,

84 
	m__ISwpunù
 = 10,

85 
	m__ISw®num
 = 11,

87 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

88 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

89 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

90 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

91 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

92 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

93 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

94 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

95 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

96 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

97 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

98 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

103 
__BEGIN_DECLS


105 
__BEGIN_NAMESPACE_C99


112 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

118 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

121 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

125 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

129 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

134 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

137 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

142 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

147 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

152 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

157 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

162 #ifdeà
__USE_ISOC99


163 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

172 
wùy³_t
 
	$wùy³
 (
__cÚ¡
 *
__´İ”ty
è
__THROW
;

176 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

177 
__END_NAMESPACE_C99


184 
__BEGIN_NAMESPACE_C99


187 
__cÚ¡
 
	t__št32_t
 *
	twù¿ns_t
;

188 
__END_NAMESPACE_C99


189 #ifdeà
__USE_GNU


190 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

193 
__BEGIN_NAMESPACE_C99


195 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

198 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

199 
__END_NAMESPACE_C99


201 
__END_DECLS


208 #ifdeà
_WCTYPE_H


214 
__BEGIN_DECLS


216 
__BEGIN_NAMESPACE_C99


219 
wù¿ns_t
 
	$wù¿ns
 (
__cÚ¡
 *
__´İ”ty
è
__THROW
;

222 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

223 
__END_NAMESPACE_C99


225 #ifdeà
__USE_XOPEN2K8


227 
	~<xloÿË.h
>

231 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

237 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

240 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

244 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

248 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

253 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

256 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

261 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

266 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

271 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

276 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

281 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

285 
wùy³_t
 
	$wùy³_l
 (
__cÚ¡
 *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

286 
__THROW
;

290 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

291 
__THROW
;

299 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

302 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

306 
wù¿ns_t
 
	$wù¿ns_l
 (
__cÚ¡
 *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

307 
__THROW
;

310 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

311 
__loÿË_t
 
__loÿË
è
__THROW
;

315 
__END_DECLS


	@/usr/include/asm/bitsperlong.h

1 #iâdeà
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ifdeà
__x86_64__


5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-g’”ic/b™¥”lÚg.h
>

	@/usr/include/bits/errno.h

20 #ifdeà
_ERRNO_H


22 #undeà
EDOM


23 #undeà
EILSEQ


24 #undeà
ERANGE


25 
	~<lšux/”ºo.h
>

28 
	#ENOTSUP
 
EOPNOTSUPP


	)

31 #iâdeà
ECANCELED


32 
	#ECANCELED
 125

	)

36 #iâdeà
EOWNERDEAD


37 
	#EOWNERDEAD
 130

	)

38 
	#ENOTRECOVERABLE
 131

	)

41 #iâdeà
__ASSEMBLER__


43 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

45 #ià!
defšed
 
_LIBC
 || defšed 
_LIBC_REENTRANT


47 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

52 #ià!
defšed
 
_ERRNO_H
 && defšed 
__Ãed_Em©h


56 
	#EDOM
 33

	)

57 
	#EILSEQ
 84

	)

58 
	#ERANGE
 34

	)

	@/usr/include/bits/setjmp.h

20 #iâdeà
_BITS_SETJMP_H


21 
	#_BITS_SETJMP_H
 1

	)

23 #ià!
defšed
 
_SETJMP_H
 && !defšed 
_PTHREAD_H


27 
	~<b™s/wÜdsize.h
>

29 #iâdeà
_ASM


31 #ià
__WORDSIZE
 == 64

32 
	t__jmp_buf
[8];

34 
	t__jmp_buf
[6];

	@/usr/include/sched.h

20 #iâdef 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	#__Ãed_size_t


	)

29 
	~<¡ddef.h
>

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

35 
	~<b™s/sched.h
>

37 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

40 
__BEGIN_DECLS


43 
	$sched_£¬am
 (
__pid_t
 
__pid
, 
__cÚ¡
 
sched_·¿m
 *
__·¿m
)

44 
__THROW
;

47 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

50 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

51 
__cÚ¡
 
sched_·¿m
 *
__·¿m
è
__THROW
;

54 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

57 
	$sched_y›ld
 (è
__THROW
;

60 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

63 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

66 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

69 #ifdeà
__USE_GNU


71 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

72 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

73 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

74 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

75 
ıu£
)

	)

76 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

77 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

80 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

81 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

82 
ıu£
)

	)

83 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

84 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

86 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

87 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

88 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

89 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

91 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

92 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

93 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

94 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

95 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

96 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

97 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

104 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

105 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

106 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

110 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

111 
__cÚ¡
 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

114 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

115 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

118 
__END_DECLS


	@/usr/include/asm-generic/bitsperlong.h

1 #iâdeà
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #iâdeà
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/bits/sched.h

22 #iâdeà
__Ãed_sched·¿m


24 #iâdeà
_SCHED_H


30 
	#SCHED_OTHER
 0

	)

31 
	#SCHED_FIFO
 1

	)

32 
	#SCHED_RR
 2

	)

33 #ifdeà
__USE_GNU


34 
	#SCHED_BATCH
 3

	)

37 #ifdeà
__USE_MISC


39 
	#CSIGNAL
 0x000000fà

	)

40 
	#CLONE_VM
 0x00000100

	)

41 
	#CLONE_FS
 0x00000200

	)

42 
	#CLONE_FILES
 0x00000400

	)

43 
	#CLONE_SIGHAND
 0x00000800

	)

44 
	#CLONE_PTRACE
 0x00002000

	)

45 
	#CLONE_VFORK
 0x00004000

	)

47 
	#CLONE_PARENT
 0x00008000

	)

49 
	#CLONE_THREAD
 0x00010000

	)

50 
	#CLONE_NEWNS
 0x00020000

	)

51 
	#CLONE_SYSVSEM
 0x00040000

	)

52 
	#CLONE_SETTLS
 0x00080000

	)

53 
	#CLONE_PARENT_SETTID
 0x00100000

	)

55 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

57 
	#CLONE_DETACHED
 0x00400000

	)

58 
	#CLONE_UNTRACED
 0x00800000

	)

60 
	#CLONE_CHILD_SETTID
 0x01000000

	)

62 
	#CLONE_NEWUTS
 0x04000000

	)

63 
	#CLONE_NEWIPC
 0x08000000

	)

64 
	#CLONE_NEWUSER
 0x10000000

	)

65 
	#CLONE_NEWPID
 0x20000000

	)

66 
	#CLONE_NEWNET
 0x40000000

	)

67 
	#CLONE_IO
 0x80000000

	)

71 
	ssched_·¿m


73 
	m__sched_´iÜ™y
;

76 
	g__BEGIN_DECLS


78 #ifdeà
__USE_MISC


80 
şÚe
 ((*
__â
è(*
__¬g
), *
__chd_¡ack
,

81 
__æags
, *
__¬g
, ...è
__THROW
;

84 
	$unsh¬e
 (
__æags
è
__THROW
;

87 
	$sched_g‘ıu
 (è
__THROW
;

90 
__END_DECLS


94 #ià!
defšed
 
__defšed_sched·¿m
 \

95 && (
defšed
 
__Ãed_sched·¿m
 || defšed 
_SCHED_H
)

96 
	#__defšed_sched·¿m
 1

	)

98 
	s__sched_·¿m


100 
__sched_´iÜ™y
;

102 #undeà
__Ãed_sched·¿m


106 #ià
defšed
 
_SCHED_H
 && !defšed 
__ıu_£t_t_defšed


107 
	#__ıu_£t_t_defšed


	)

109 
	#__CPU_SETSIZE
 1024

	)

110 
	#__NCPUBITS
 (8 *  (
__ıu_mask
))

	)

113 
	t__ıu_mask
;

116 
	#__CPUELT
(
ıu
è((ıuè/ 
__NCPUBITS
)

	)

117 
	#__CPUMASK
(
ıu
è((
__ıu_mask
è1 << ((ıuè% 
__NCPUBITS
))

	)

122 
__ıu_mask
 
__b™s
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

123 } 
	tıu_£t_t
;

126 #ià
	`__GNUC_PREREQ
 (2, 91)

127 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

128 dØ
	`__butš_mem£t
 (
ıu£
, '\0', 
£tsize
); 0)

	)

130 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

132 
size_t
 
__i
; \

133 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

134 
__ıu_mask
 *
__b™s
 = (
ıu£
)->__bits; \

135 
__i
 = 0; __˜< 
__imax
; ++__i) \

136 
__b™s
[
__i
] = 0; \

137 
	}
} 0)

	)

139 
	#__CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
) \

140 (
__ex‹nsiÚ__
 \

141 ({ 
size_t
 
__ıu
 = (
ıu
); \

142 
__ıu
 < 8 * (
£tsize
) \

143 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

144 |ğ
	`__CPUMASK
 (
__ıu
)) \

145 : 0; }))

	)

146 
	#__CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
) \

147 (
__ex‹nsiÚ__
 \

148 ({ 
size_t
 
__ıu
 = (
ıu
); \

149 
__ıu
 < 8 * (
£tsize
) \

150 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

151 &ğ~
	`__CPUMASK
 (
__ıu
)) \

152 : 0; }))

	)

153 
	#__CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
) \

154 (
__ex‹nsiÚ__
 \

155 ({ 
size_t
 
__ıu
 = (
ıu
); \

156 
__ıu
 < 8 * (
£tsize
) \

157 ? ((((
__cÚ¡
 
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

158 & 
	`__CPUMASK
 (
__ıu
))) != 0 \

159 : 0; }))

	)

161 
	#__CPU_COUNT_S
(
£tsize
, 
ıu£
) \

162 
	`__sched_ıucouÁ
 (
£tsize
, 
ıu£
)

	)

164 #ià
__GNUC_PREREQ
 (2, 91)

165 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

166 (
	`__butš_memcmp
 (
ıu£1
, 
ıu£2
, 
£tsize
è=ğ0)

	)

168 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

169 (
__ex‹nsiÚ__
 \

170 ({ 
__cÚ¡
 
__ıu_mask
 *
__¬r1
 = (
ıu£1
)->
__b™s
; \

171 
__cÚ¡
 
__ıu_mask
 *
__¬r2
 = (
ıu£2
)->
__b™s
; \

172 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

173 
size_t
 
__i
; \

174 
__i
 = 0; __˜< 
__imax
; ++__i) \

175 ià(
__b™s
[
__i
] != __bits[__i]) \

177 
__i
 =ğ
__imax
; }))

	)

180 
	#__CPU_OP_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, 
İ
) \

181 (
__ex‹nsiÚ__
 \

182 ({ 
ıu_£t_t
 *
__de¡
 = (
de¡£t
); \

183 
__cÚ¡
 
__ıu_mask
 *
__¬r1
 = (
¤c£t1
)->
__b™s
; \

184 
__cÚ¡
 
__ıu_mask
 *
__¬r2
 = (
¤c£t2
)->
__b™s
; \

185 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

186 
size_t
 
__i
; \

187 
__i
 = 0; __˜< 
__imax
; ++__i) \

188 ((
__ıu_mask
 *è
__de¡
->
__b™s
)[
__i
] = 
__¬r1
[__i] 
İ
 
__¬r2
[__i]; \

189 
__de¡
; }))

	)

191 
	#__CPU_ALLOC_SIZE
(
couÁ
) \

192 ((((
couÁ
è+ 
__NCPUBITS
 - 1è/ __NCPUBITSè*  (
__ıu_mask
))

	)

193 
	#__CPU_ALLOC
(
couÁ
è
	`__sched_ıu®loc
 (couÁ)

	)

194 
	#__CPU_FREE
(
ıu£t
è
	`__sched_ıuä“
 (ıu£t)

	)

196 
__BEGIN_DECLS


198 
	$__sched_ıucouÁ
 (
size_t
 
__£tsize
, cÚ¡ 
ıu_£t_t
 *
__£
)

199 
__THROW
;

200 
ıu_£t_t
 *
	$__sched_ıu®loc
 (
size_t
 
__couÁ
è
__THROW
 
__wur
;

201 
	$__sched_ıuä“
 (
ıu_£t_t
 *
__£t
è
__THROW
;

203 
__END_DECLS


	@/usr/include/linux/errno.h

1 #iâdeà
_LINUX_ERRNO_H


2 
	#_LINUX_ERRNO_H


	)

4 
	~<asm/”ºo.h
>

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm-generic/errno.h

1 #iâdeà
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-g’”ic/”ºo-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

109 
	#ERFKILL
 132

	)

	@/usr/include/asm-generic/errno-base.h

1 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@
1
.
1
/usr/include
396
9122
activity.cc
activity.hh
base.cc
base.hh
base_dyn_inst.hh
base_dyn_inst_impl.hh
checker/cpu.cc
checker/cpu.hh
checker/cpu_impl.hh
checker/thread_context.hh
cpuevent.cc
cpuevent.hh
decode_cache.hh
dummy_checker.cc
dummy_checker.hh
exec_context.hh
exetrace.cc
exetrace.hh
func_unit.cc
func_unit.hh
inorder/comm.hh
inorder/cpu.cc
inorder/cpu.hh
inorder/first_stage.cc
inorder/first_stage.hh
inorder/inorder_cpu_builder.cc
inorder/inorder_dyn_inst.cc
inorder/inorder_dyn_inst.hh
inorder/inorder_trace.cc
inorder/inorder_trace.hh
inorder/pipeline_stage.cc
inorder/pipeline_stage.hh
inorder/pipeline_traits.5stage.cc
inorder/pipeline_traits.5stage.hh
inorder/pipeline_traits.9stage.cc
inorder/pipeline_traits.9stage.hh
inorder/pipeline_traits.9stage.smt2.cc
inorder/pipeline_traits.9stage.smt2.hh
inorder/pipeline_traits.hh
inorder/reg_dep_map.cc
inorder/reg_dep_map.hh
inorder/resource.cc
inorder/resource.hh
inorder/resource_pool.9stage.cc
inorder/resource_pool.cc
inorder/resource_pool.hh
inorder/resource_sked.cc
inorder/resource_sked.hh
inorder/resources/agen_unit.cc
inorder/resources/agen_unit.hh
inorder/resources/branch_predictor.cc
inorder/resources/branch_predictor.hh
inorder/resources/cache_unit.cc
inorder/resources/cache_unit.hh
inorder/resources/decode_unit.cc
inorder/resources/decode_unit.hh
inorder/resources/execution_unit.cc
inorder/resources/execution_unit.hh
inorder/resources/fetch_seq_unit.cc
inorder/resources/fetch_seq_unit.hh
inorder/resources/fetch_unit.cc
inorder/resources/fetch_unit.hh
inorder/resources/graduation_unit.cc
inorder/resources/graduation_unit.hh
inorder/resources/inst_buffer.cc
inorder/resources/inst_buffer.hh
inorder/resources/mem_dep_unit.hh
inorder/resources/mult_div_unit.cc
inorder/resources/mult_div_unit.hh
inorder/resources/resource_list.hh
inorder/resources/tlb_unit.cc
inorder/resources/tlb_unit.hh
inorder/resources/use_def.cc
inorder/resources/use_def.hh
inorder/thread_context.cc
inorder/thread_context.hh
inorder/thread_state.cc
inorder/thread_state.hh
inst_seq.hh
inteltrace.cc
inteltrace.hh
intr_control.cc
intr_control.hh
intr_control_noisa.cc
kvm/arm_cpu.cc
kvm/arm_cpu.hh
kvm/base.cc
kvm/base.hh
kvm/perfevent.cc
kvm/perfevent.hh
kvm/timer.cc
kvm/timer.hh
kvm/vm.cc
kvm/vm.hh
kvm/x86_cpu.cc
kvm/x86_cpu.hh
legiontrace.cc
legiontrace.hh
m5legion_interface.h
nativetrace.cc
nativetrace.hh
o3/base_dyn_inst.cc
o3/checker.cc
o3/checker.hh
o3/comm.hh
o3/commit.cc
o3/commit.hh
o3/commit_impl.hh
o3/cpu.cc
o3/cpu.hh
o3/cpu_policy.hh
o3/decode.cc
o3/decode.hh
o3/decode_impl.hh
o3/dep_graph.hh
o3/deriv.cc
o3/deriv.hh
o3/dyn_inst.cc
o3/dyn_inst.hh
o3/dyn_inst_impl.hh
o3/fetch.cc
o3/fetch.hh
o3/fetch_impl.hh
o3/free_list.cc
o3/free_list.hh
o3/fu_pool.cc
o3/fu_pool.hh
o3/iew.cc
o3/iew.hh
o3/iew_impl.hh
o3/impl.hh
o3/inst_queue.cc
o3/inst_queue.hh
o3/inst_queue_impl.hh
o3/isa_specific.hh
o3/lsq.cc
o3/lsq.hh
o3/lsq_impl.hh
o3/lsq_unit.cc
o3/lsq_unit.hh
o3/lsq_unit_impl.hh
o3/mem_dep_unit.cc
o3/mem_dep_unit.hh
o3/mem_dep_unit_impl.hh
o3/regfile.cc
o3/regfile.hh
o3/rename.cc
o3/rename.hh
o3/rename_impl.hh
o3/rename_map.cc
o3/rename_map.hh
o3/rob.cc
o3/rob.hh
o3/rob_impl.hh
o3/scoreboard.cc
o3/scoreboard.hh
o3/store_set.cc
o3/store_set.hh
o3/thread_context.cc
o3/thread_context.hh
o3/thread_context_impl.hh
o3/thread_state.hh
op_class.hh
ozone/back_end.cc
ozone/back_end.hh
ozone/back_end_impl.hh
ozone/base_dyn_inst.cc
ozone/bpred_unit.cc
ozone/checker_builder.cc
ozone/cpu.cc
ozone/cpu.hh
ozone/cpu_builder.cc
ozone/cpu_impl.hh
ozone/dyn_inst.cc
ozone/dyn_inst.hh
ozone/dyn_inst_impl.hh
ozone/ea_list.cc
ozone/ea_list.hh
ozone/front_end.cc
ozone/front_end.hh
ozone/front_end_impl.hh
ozone/inorder_back_end.cc
ozone/inorder_back_end.hh
ozone/inorder_back_end_impl.hh
ozone/inst_queue.cc
ozone/inst_queue.hh
ozone/inst_queue_impl.hh
ozone/lsq_unit.cc
ozone/lsq_unit.hh
ozone/lsq_unit_impl.hh
ozone/lw_back_end.cc
ozone/lw_back_end.hh
ozone/lw_back_end_impl.hh
ozone/lw_lsq.cc
ozone/lw_lsq.hh
ozone/lw_lsq_impl.hh
ozone/null_predictor.hh
ozone/ozone_base_dyn_inst.cc
ozone/ozone_impl.hh
ozone/rename_table.cc
ozone/rename_table.hh
ozone/rename_table_impl.hh
ozone/simple_base_dyn_inst.cc
ozone/simple_cpu_builder.cc
ozone/simple_impl.hh
ozone/simple_params.hh
ozone/thread_state.hh
pc_event.cc
pc_event.hh
pred/2bit_local.cc
pred/2bit_local.hh
pred/bpred_unit.cc
pred/bpred_unit.hh
pred/bpred_unit_impl.hh
pred/btb.cc
pred/btb.hh
pred/ras.cc
pred/ras.hh
pred/sat_counter.hh
pred/tournament.cc
pred/tournament.hh
profile.cc
profile.hh
quiesce_event.cc
quiesce_event.hh
reg_class.cc
reg_class.hh
simple/atomic.cc
simple/atomic.hh
simple/base.cc
simple/base.hh
simple/timing.cc
simple/timing.hh
simple_thread.cc
simple_thread.hh
smt.hh
static_inst.cc
static_inst.hh
static_inst_fwd.hh
testers/directedtest/DirectedGenerator.cc
testers/directedtest/DirectedGenerator.hh
testers/directedtest/InvalidateGenerator.cc
testers/directedtest/InvalidateGenerator.hh
testers/directedtest/RubyDirectedTester.cc
testers/directedtest/RubyDirectedTester.hh
testers/directedtest/SeriesRequestGenerator.cc
testers/directedtest/SeriesRequestGenerator.hh
testers/memtest/memtest.cc
testers/memtest/memtest.hh
testers/networktest/networktest.cc
testers/networktest/networktest.hh
testers/rubytest/Check.cc
testers/rubytest/Check.hh
testers/rubytest/CheckTable.cc
testers/rubytest/CheckTable.hh
testers/rubytest/RubyTester.cc
testers/rubytest/RubyTester.hh
testers/traffic_gen/generators.cc
testers/traffic_gen/generators.hh
testers/traffic_gen/traffic_gen.cc
testers/traffic_gen/traffic_gen.hh
thread_context.cc
thread_context.hh
thread_state.cc
thread_state.hh
timebuf.hh
timingcgra/CGRAController.cpp
timingcgra/CGRAController.h
timingcgra/CGRADataMemory.cpp
timingcgra/CGRADataMemory.h
timingcgra/CGRADecoder.cpp
timingcgra/CGRADecoder.h
timingcgra/CGRAException.cpp
timingcgra/CGRAException.h
timingcgra/CGRAInstruction.cpp
timingcgra/CGRAInstruction.h
timingcgra/CGRAPE.cpp
timingcgra/CGRAPE.h
timingcgra/CGRARegisterFile.cpp
timingcgra/CGRARegisterFile.h
timingcgra/CGRA_MemoryPort.cpp
timingcgra/CGRA_MemoryPort.h
timingcgra/CGRAdefinitions.h
timingcgra/base.cc
timingcgra/base.hh
timingcgra/timingcgra.cc
timingcgra/timingcgra.hh
translation.hh
/usr/include/fcntl.h
/usr/include/inttypes.h
/usr/include/linux/kvm.h
/usr/include/linux/perf_event.h
/usr/include/signal.h
/usr/include/stdio.h
/usr/include/sys/ioctl.h
/usr/include/sys/ipc.h
/usr/include/sys/mman.h
/usr/include/sys/shm.h
/usr/include/sys/stat.h
/usr/include/sys/syscall.h
/usr/include/sys/types.h
/usr/include/syscall.h
/usr/include/unistd.h
/usr/include/asm/byteorder.h
/usr/include/asm/kvm.h
/usr/include/asm/unistd.h
/usr/include/bits/confname.h
/usr/include/bits/environments.h
/usr/include/bits/fcntl.h
/usr/include/bits/fcntl2.h
/usr/include/bits/ioctl-types.h
/usr/include/bits/ioctls.h
/usr/include/bits/ipc.h
/usr/include/bits/ipctypes.h
/usr/include/bits/mman.h
/usr/include/bits/posix_opt.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/shm.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/siginfo.h
/usr/include/bits/signum.h
/usr/include/bits/sigset.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/bits/stat.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/syscall.h
/usr/include/bits/types.h
/usr/include/bits/unistd.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/linux/ioctl.h
/usr/include/linux/types.h
/usr/include/stdint.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/sys/ttydefaults.h
/usr/include/sys/ucontext.h
/usr/include/time.h
/usr/include/_G_config.h
/usr/include/asm/ioctl.h
/usr/include/asm/ioctls.h
/usr/include/asm/types.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/predefs.h
/usr/include/bits/select.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/time.h
/usr/include/bits/typesizes.h
/usr/include/bits/uio.h
/usr/include/bits/wchar.h
/usr/include/bits/wordsize.h
/usr/include/ctype.h
/usr/include/gnu/stubs.h
/usr/include/linux/byteorder/little_endian.h
/usr/include/linux/posix_types.h
/usr/include/sys/cdefs.h
/usr/include/xlocale.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm-generic/ioctls.h
/usr/include/asm-generic/types.h
/usr/include/asm/posix_types.h
/usr/include/bits/libc-lock.h
/usr/include/gconv.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/linux/stddef.h
/usr/include/linux/swab.h
/usr/include/wchar.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm/swab.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar2.h
/usr/include/errno.h
/usr/include/gnu/option-groups.h
/usr/include/pthread.h
/usr/include/wctype.h
/usr/include/asm/bitsperlong.h
/usr/include/bits/errno.h
/usr/include/bits/setjmp.h
/usr/include/sched.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/bits/sched.h
/usr/include/linux/errno.h
/usr/include/asm/errno.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/errno-base.h
